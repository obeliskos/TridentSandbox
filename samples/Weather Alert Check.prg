{
  "progName": "Weather Alert Check",
  "htmlText": "<h3>Weather Alert Check</h3>\n\n<div id='divNoAlert'>\n<h3>No Alerts Issued</h3>\n</div>\n\n<div id='divAlerts' style='background-color:#F66; display:none;'>\n<br/>\nAlerts have been issued! Go here to read more :\n<br/><br/>\n<a href='http://forecast.weather.gov/MapClick.php?site=ctp&zmx=1&zmy=1&map_x=235.510009765625&map_y=85.70001220703125&x=236&y=86' target='_blank'>weather.gov</a>\n<br/><br/>\n</div>\n<br/>\n<button onclick=\"stopTimer()\">Stop Timer</button>",
  "scriptText": "// This script monitors a particular location's weather.gov webpage and sounds an audible\n// alert if hazardous weather conditions exists\n\nvar sandboxVars = {\n  autoCheck: null\n}\n\nfunction EVT_CleanSandbox() {\n\tclearInterval(sandboxVars.autoCheck);\n}\n\n// 240000 is every 4 mins, 900000 (15mins) is probably better\nsandboxVars.autoCheck =  setInterval(function(){ checkForAlert() }, 240000);\n\ncheckForAlert();\n\nfunction stopTimer()\n{\n\tclearInterval(sandboxVars.autoCheck);\n\talertify.log(\"Timer Stopped\");\n}\n\nfunction checkForAlert() \n{\n\t// this is some random city that had a weather alert during testing\n\t// go to forecast.weather.gov and find a city or your own and enter that location's\n\t// web page here... it will fetch the html and see if it \n\t// contains the text 'Hazardous Weather Conditions'\n\tvar wxurl = \"http://forecast.weather.gov/MapClick.php?site=ctp&zmx=1&zmy=1&map_x=235.510009765625&map_y=85.70001220703125&x=236&y=86\";\n\n\t$.ajax({\n  \t\turl: wxurl,\n  \t\tcache: false,\n  \t\tsuccess: function(data){\n\t\t\tvar currentdate = new Date(); \n\t\t\tvar options = {\n    \t\t\t\tweekday: \"long\", year: \"numeric\", month: \"short\",\n\t\t\t\tday: \"numeric\", hour: \"2-digit\", minute: \"2-digit\"\n\t\t\t};\n\n\t\t\tAPI_LogMessage(\"Last Check : \" + currentdate.toLocaleTimeString(\"en-us\", options));\n\n\t    \t\tif (data.indexOf(\"Hazardous Weather Conditions\") != -1) {\n\t    \t\t\tplaysound();\n\t    \t\t\t\n\t\t\t\tAPI_LogMessage(\"Alert Raised : \" + currentdate.toLocaleTimeString(\"en-us\", options));\n\t    \t\t\t$(\"#divNoAlert\").hide();\n\t    \t\t\t$(\"#divAlerts\").show();\n\t    \t\t}\n  \t\t}\n\t});\t\n};\n\nfunction playsound()\n{\n\t// Use (nonvisible) html5 audio functionality\n\tvar aud = new Audio();\n\taud.src = 'sounds/emergency031.mp3';\n\t\n\t// ran into issue where sound wasn't playing so wait a .5 sec\n\tsetTimeout(function() {\n\t\taud.play();\n\t}, 500);\n}\n"
}