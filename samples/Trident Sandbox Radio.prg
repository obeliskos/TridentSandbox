{
  "progName": "Trident Sandbox Radio",
  "htmlText": "<style>\na.readerLink:link { color: #FFFF99; text-decoration: none; font-size: 20pt; }\na.readerLink:hover { text-decoration: underline; color: #FFFF99; }\na.readerLink:visited { color: #FFFF99; }\n\na.readerLink2:link { color: #FFFF99; text-decoration: none; }\na.readerLink2:hover { text-decoration: underline; color: #FFFF99; }\na.readerLink2:visited { color: #FFFF99; }\n\nfieldset { \n\tpadding: 1em;\n    font:80%/1 sans-serif;\n\tborder:1px solid white; \n}\nlabel.lb4 {\n\tfloat:left;\n    width:25%;\n    margin-right:0.5em;\n    padding-top:0.2em;\n    text-align:right;\n    font-weight:bold;\n}\n\nlegend {\n    padding: 0.2em 0.5em;\n    border:1px solid white;\n    color:white;\n    font-size:90%;\n    text-align:right;\n}\n\n</style> \n<ul class=\"tnavlist\">\n<li class=\"tnavli\"><a class=\"tnava\" onclick=\"showDiv(1);\" href=\"javascript:void(0)\"><i class=\"fa fa-headphones\"></i> Listen</a></li>\n<li class=\"tnavli\"><a class=\"tnava\" onclick=\"showDiv(2);\" href=\"javascript:void(0)\"><i class=\"fa fa-wrench\"></i> Edit Stations</a></li>\n<li class=\"tnavli\"><a class=\"tnava\" onclick=\"showDiv(3);\" href=\"javascript:void(0)\"><i class=\"fa fa-info-circle\"></i> About</a></li>\n</ul>\n\n<div id=\"divHome\" style=\"color:#ddd;\">\n\t<h3 style=\"color:#ddd\">Trident Sandbox Radio</h3>\n\t<table width=\"100%\">\n    <tr>\n\t    <td>\n\t\t\t<ul id=\"mainListView\" class=\"tlist\"></ul><br/>\n\t\t</td>\n\t    <td align='center' style=\"width:420px;\">\n        \t<audio id='player' controls>\n            \t<source id='mp3source' src=\"\" type=\"audio/mp3\">\n                Your browser does not support the audio tag.\n            </audio>\n\t    </td>\n    </tr>\n    </table>\n\n\n</div>\n\n<div id=\"divStations\" style=\"color:#ddd; display:none\">\n<br/>\n\t<div id=\"divRadioWarn\" style=\"color:#ddd; display:none\">\n\t\t<p>Since you are running local filesystem version, the list is hardcoded.  To \n    \t\tmanage the feeds, you should edit the feed list array at the top of the script</p>\n    </div>\n    \n\t<ul id=\"stationListView\" class=\"tlist\"></ul><br/>\n    \n\t<button class=\"shiny-blue\" onclick=\"addStation()\"><i class=\"fa fa-plus\"></i> Add</button>&nbsp;\n\t<button class=\"shiny-blue\" onclick=\"editStation()\"><i class=\"fa fa-pencil-square-o\"></i> Edit</button>&nbsp;\n\t<button class=\"shiny-blue\" onclick=\"deleteStation()\"><i class=\"fa fa-trash-o\"></i> Delete</button>\n\t<button class=\"shiny-blue\" onclick=\"saveStations()\"><i class=\"fa fa-save\"></i> Save to DB</button>\n    <br/><br/>\n    <div id=\"divEditStation\" style=\"display:none; background-color:#555; color:#ddd; padding:20px; font-size:20px;\">\n\t\t<input type=\"hidden\" id=\"hfStationId\"/>\n\t\t<fieldset>\n        <legend>Feed Settings</legend>\n        <label class=\"lb4\" for=\"txtStationName\">Feed Name : </label>\n        <input type=\"text\" id=\"txtStationName\" style=\"width:260px\"/>\n        <br/><br/>\n        <label class=\"lb4\" for=\"txtStationUrl\">Feed Url : </label>\n        <input type=\"text\" id=\"txtStationUrl\" style=\"width:400px\" />\n        <br/><br/><br/>\n        \n        <span style=\"float:right\">\n\t\t<button class=\"shiny-blue\" onclick=\"saveStation()\"><i class=\"fa fa-save\"></i> Save</button>&nbsp;\n\t\t<button class=\"shiny-blue\" onclick=\"$('#divEditStation').hide();\"><i class=\"fa fa-ban\"></i> Cancel</button>\n        </span>\n        </fieldset>\n    </div>\n    \n</div>\n\n<div id=\"divAbout\" style=\"color:#ddd; display:none\">\n\t<h3 style=\"color:#ddd\">Trident Sandbox Radio <i class=\"fa fa-volume-up\"></i> </h3>\n    \n    <p>This application uses the HTML 5 audio control to handle playing the music streams. \n    This HTML audio control (or the servers themselves) are rather particular about ending the \n    stream address with a /; character pattern.  It also (requires?) direct stream links, not playlist \n    redirectors. A good way to add more streams is to go to <a href=\"http://www.shoutcast.com/search\" target=\"_blank\">Shoutcast.com</a> \n    and use their station browser to listen to stations and then click download, pick m3u and save file to disk.  \n    Then open that file with text editor to read direct stream address.</p>\n    \n    <p>This application works best with hosted or appcache version so that feed list \n    \tcan be saved into the TridentDB.  If you are running local filesystem version, \n        you will have to just edit the rssurls array at the top of the script.</p>\n        \n\t<p>For Hosted/AppCache, some stations may require 'Making data request <a class=\"readerLink2\" href=\"docs/HostingAndAppCache.htm\" target=\"_blank\">workaround</a>...' \n    in place.</p>\n</div>",
  "scriptText": "var sbv = {\n\t// This is the default set of sites to show... if you are running local filesystem\n    // you will need to edit this to add/remove sites\n\tstationurls : [\t{ Name: \"KROQ\", Url : \"http://208.80.54.77:80/KROQHD2CMP3\" },\n\t\t\t\t{ Name: \"Greek Radio Thalassa\", Url : \"http://82.197.165.143:80/;\" },\n\t\t\t\t{ Name: \"PHISH Radio\", Url : \"http://209.234.243.40:8002/;\" },\n\t\t\t\t{ Name: \"Fam Friendy Christian\", Url : \"http://66.225.205.47:80/;\" },\n\t\t\t\t{ Name: \"Good Time Oldies\", Url : \"http://69.4.232.112:8166/;\" },\n\t\t\t\t{ Name: \"95.7 XRC (Rock)\", Url : \"http://knight.wavestreamer.com:9631/listen.m3u/;\" },\n\t\t\t\t{ Name: \"Goth and Metal\", Url : \"http://listen.radionomy.com/Goth-N-Metal\" },\n\t\t\t\t{ Name: \"1.FM Movie Soundtrack Hits\", Url : \"http://205.164.62.15:10108/;\" },\n\t\t\t\t{ Name: \"Soma Underground 80s\", Url : \"http://xstream1.somafm.com:8880/;\" },\n\t\t\t\t{ Name: \"Soma FM BAGel\", Url : \"http://uwstream3.somafm.com:9090/;\" },\n\t\t\t\t{ Name: \"Soma FM Groove Salad\", Url : \"http://uwstream1.somafm.com:80/;\" },\n\t\t\t\t{ Name: \"Soma FM Secret Agent\", Url : \"http://xstream1.somafm.com:8002/;\" },\n\t\t\t\t{ Name: \"Soma FM DefCon\", Url : \"http://uwstream3.somafm.com:6200/;\" },\n\t\t\t\t{ Name: \"Soma FM Space Station\", Url : \"http://uwstream3.somafm.com:8000/;\" },\n\t\t\t\t{ Name: \"Soma FM Dubstep\", Url : \"http://uwstream2.somafm.com:8400/;\" },\n\t\t\t\t{ Name: \"Soma FM Earwaves\", Url : \"http://uwstream3.somafm.com:5100/;\" },\n\t\t\t\t{ Name: \"Soma FM Lush\", Url : \"http://uwstream2.somafm.com:8800/;\" },\n\t\t\t\t{ Name: \"Soma FM SouthBySoma\", Url : \"http://uwstream2.somafm.com:5500/;\" },\n\t\t\t\t{ Name: \"BoAB 1\", Url : \"http://stream1.u7radio.org:8000/;\" },\n\t\t\t\t{ Name: \"BoAB 2\", Url : \"http://stream2.u7radio.org:8000/;\" },\n\t\t\t\t{ Name: \"BoAB 3\", Url : \"http://stream3.u7radio.org:8000/;\" }\n                ],\n                \n    mainListView : null,\n    stationListView : null,\n\n\tdb: new loki('StationDb'),\n\tstations: null\n};\n\nfunction EVT_CleanSandbox() {\n\tsbv = null\n    EVT_CleanSandbox = null;\n}\n\nfunction EVT_WindowResize() {\n    switch (sandbox.volatile.env) {\n        case \"IDE\" : $(\".tlist\").height($(window).height() - 400); break;\n        case \"SBL\" : $(\".tlist\").height($(window).height() - 200); break;\n        case \"STANDALONE\" : $(\".tlist\").height($(window).height() - 200); break;\n        default : break;\n    }\n}\n\n// navlist handler to show/hide tabs\nfunction showDiv(id) {\n\t$(\"#divHome\").hide();\n    $(\"#divStations\").hide();\n    $(\"#divAbout\").hide();\n    \n    switch (id) {\n    \tcase 1 : $(\"#divHome\").show(); break;\n        case 2 : $(\"#divStations\").show(); break;\n        case 3 : $(\"#divAbout\").show(); break;\n    }\n}\n\nfunction loadStation(sender, id) {\n    var audio = document.getElementById(\"player\");\n    audio.src = id;\n    audio.load();\n    audio.play();\n}\n\nfunction initTridentDb() {\n\tsbv.stations = sbv.db.addCollection('stations', 'stations');\n\n\tfor (idx = 0; idx < sbv.stationurls.length; idx++) {\n\t\tvar obj = sbv.stationurls[idx];\n\n\t\tsbv.stations.insert(obj);\n\t}\n}\n\nfunction showStationsInDb() {\n\tsbv.mainListView.clearList();\n    sbv.stationListView.clearList();\n    \n\tfor (idx = 0; idx < sbv.stations.data.length; idx++) {\n    \tvar obj = sbv.stations.data[idx];\n        \n        // use url for key on main list, but id for key on stations list\n\t\tsbv.mainListView.addListItem(obj.Url, obj.Name, obj.Url);\n        sbv.stationListView.addListItem(obj.$loki, obj.Name, obj.Url);\n    }\n    \n    EVT_WindowResize();\n}\n\nfunction radioInit() {\n\tAPI_SetBackgroundColor(\"#444\");\n    \n\tsbv.mainListView = new TridentList(\"mainListView\", loadStation);\n\n    if (VAR_TRIDENT_DB) {\n\t\t$(\"#divRadioWarn\").hide();\t// hide warning intended for local filesystem users\n\t\tsbv.stationListView = new TridentList(\"stationListView\", stationDivCallback);\n        \n\t\tAPI_GetIndexedAppKey('TridentRadioApp', 'StationData', function(e) {\n\t\t\tvar res = e.target.result;\n        \n        // if no data then just load up the default hardcoded data\n        if (!res) {\n            initTridentDb();\n            showStationsInDb();\n            return;\n        }\n        \n      \tsbv.db.loadJSON(res.val);\n\n\t\t// we rehydrated loki db object and collections but old collection references still\n  \t\t// point to old db object. \n\t\tsbv.stations = sbv.db.getCollection(\"stations\");\n        \n\t\tshowStationsInDb();\n      });\n      \n    }\n\telse {\n        for (idx = 0; idx < sbv.stationurls.length; idx++) {\n            var obj = sbv.stationurls[idx];\n\n            sbv.mainListView.addListItem(obj.Url, obj.Name, obj.Url);\n        }\n    }\n}\n\nfunction stationDivCallback(sender, id) {\n\t$(\"#divEditFeed\").hide();\n}\n\nfunction addStation() {\n\t$(\"#hfStationId\").val(\"\");\n    $(\"#txtStationName\").val(\"\");\n    $(\"#txtStationUrl\").val(\"\");\n    $(\"#divEditStation\").show();\n}\n\nfunction editStation() {\n\tvar selId = sbv.stationListView.listSettings.selectedId;\n    \n\tif (selId == null) return;\n    \n    var stationObj = sbv.stations.get(selId);\n    \n\t$(\"#hfStationId\").val(sbv.stationListView.listSettings.selectedId);\n    $(\"#txtStationName\").val(stationObj.Name);\n    $(\"#txtStationUrl\").val(stationObj.Url);\n    $(\"#divEditStation\").show();\n}\n\nfunction deleteStation() {\n\n\tvar selId = sbv.stationListView.listSettings.selectedId;\n    \n\tif (selId == null) return;\n\n\talertify.confirm(\"Are you sure you want to delete this station?\", function (e) {\n\t\tif (e) {\n\t\t\tsbv.stations.remove(sbv.stations.get(selId));\n\n\t\t\tshowStationsInDb();\n\t\t} \n\t});\n    \n}\n\nfunction saveStation() {\n\tvar stationId = $(\"#hfStationId\").val();\n    \n    var stationName = $(\"#txtStationName\").val();\n    var stationUrl = $(\"#txtStationUrl\").val();\n    \n    if (stationName == \"\") alertify.error(\"Station Name is required\");\n    if (stationUrl == \"\") alertify.error(\"Station Url is required\");\n    \n    if (stationName == \"\" || stationUrl == \"\") return;\n    \n    if (stationId == \"\") {\n    \t// Adding\n    \tvar obj = { Name : stationName, Url : stationUrl };\n\t\tsbv.stations.insert(obj);\n        \n\t\tshowStationsInDb();\n    \t$(\"#divEditStation\").hide();\n    }\n    else {\n    \t// Updating\n    \tvar stationObj = sbv.stations.get(parseInt(stationId));\n\n\t\tstationObj.Name = stationName;\n        stationObj.Url = stationUrl;\n        \n\t\tshowStationsInDb();\n        \n    \t$(\"#divEditStation\").hide();\n        alertify.log(\"Don't forget to Save to DB when done.\");\n    }\n}\n\nfunction saveStations() {\n\tif(VAR_TRIDENT_DB) {\n      \tAPI_SetIndexedAppKey('TridentRadioApp', 'StationData', JSON.stringify(sbv.db))\n  \t}\n  \telse {\n\t\talertify.log(\"Trident Database is not available.\");\n\t}\n\n}\n\nradioInit();"
}