(function(n){n.jqplot.CategoryAxisRenderer=function(){n.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=!1};n.jqplot.CategoryAxisRenderer.prototype=new n.jqplot.LinearAxisRenderer;n.jqplot.CategoryAxisRenderer.prototype.constructor=n.jqplot.CategoryAxisRenderer;n.jqplot.CategoryAxisRenderer.prototype.init=function(t){var i,f,e,u,r;for(this.groups=1,this.groupLabels=[],this._groupLabels=[],this._grouped=!1,this._barsPerGroup=null,this.reverse=!1,n.extend(!0,this,{tickOptions:{formatString:"%d"}},t),i=this._dataBounds,f=0;f<this._series.length;f++)for(e=this._series[f],e.groups&&(this.groups=e.groups),u=e.data,r=0;r<u.length;r++)this.name=="xaxis"||this.name=="x2axis"?((u[r][0]<i.min||i.min==null)&&(i.min=u[r][0]),(u[r][0]>i.max||i.max==null)&&(i.max=u[r][0])):((u[r][1]<i.min||i.min==null)&&(i.min=u[r][1]),(u[r][1]>i.max||i.max==null)&&(i.max=u[r][1]));this.groupLabels.length&&(this.groups=this.groupLabels.length)};n.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var tt=this._ticks,e=this.ticks,w=this.name,it=this._dataBounds,b,k,v,o,f,r,y,l,t,i;if(e.length){if(this.groups>1&&!this._grouped){var c=e.length,s=parseInt(c/this.groups,10),d=0;for(t=s;t<c;t+=s)e.splice(t+d,0," "),d++;this._grouped=!0}for(this.min=.5,this.max=e.length+.5,l=this.max-this.min,this.numberTicks=2*e.length+1,t=0;t<e.length;t++)o=this.min+2*t*l/(this.numberTicks-1),i=new this.tickRenderer(this.tickOptions),i.showLabel=!1,i.setTick(o,this.name),this._ticks.push(i),i=new this.tickRenderer(this.tickOptions),i.label=e[t],i.showMark=!1,i.showGridline=!1,i.setTick(o+.5,this.name),this._ticks.push(i);i=new this.tickRenderer(this.tickOptions);i.showLabel=!1;i.setTick(o+1,this.name);this._ticks.push(i)}else{b=w=="xaxis"||w=="x2axis"?this._plotDimensions.width:this._plotDimensions.height;this.min!=null&&this.max!=null&&this.numberTicks!=null&&(this.tickInterval=null);this.min!=null&&this.max!=null&&this.tickInterval!=null&&parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval&&(this.tickInterval=null);var u=[],a=0,k=.5,v,h,g=!1;for(t=0;t<this._series.length;t++)for(f=this._series[t],r=0;r<f.data.length;r++)h=this.name=="xaxis"||this.name=="x2axis"?f.data[r][0]:f.data[r][1],n.inArray(h,u)==-1&&(g=!0,a+=1,u.push(h));for(g&&this.sortMergedLabels&&(typeof u[0]=="string"?u.sort():u.sort(function(n,t){return n-t})),this.ticks=u,t=0;t<this._series.length;t++)for(f=this._series[t],r=0;r<f.data.length;r++)h=this.name=="xaxis"||this.name=="x2axis"?f.data[r][0]:f.data[r][1],y=n.inArray(h,u)+1,this.name=="xaxis"||this.name=="x2axis"?f.data[r][0]=y:f.data[r][1]=y;if(this.groups>1&&!this._grouped){var c=u.length,s=parseInt(c/this.groups,10),d=0;for(t=s;t<c;t+=s+1)u[t]=" ";this._grouped=!0}v=a+.5;this.numberTicks==null&&(this.numberTicks=2*a+1);l=v-k;this.min=k;this.max=v;var p=0,nt=parseInt(3+b/10,10),s=parseInt(a/nt,10);for(this.tickInterval==null&&(this.tickInterval=l/(this.numberTicks-1)),t=0;t<this.numberTicks;t++)o=this.min+t*this.tickInterval,i=new this.tickRenderer(this.tickOptions),t/2==parseInt(t/2,10)?(i.showLabel=!1,i.showMark=!0):(s>0&&p<s?(i.showLabel=!1,p+=1):(i.showLabel=!0,p=0),i.label=i.formatter(i.formatString,u[(t-1)/2]),i.showMark=!1,i.showGridline=!1),i.setTick(o,this.name),this._ticks.push(i)}};n.jqplot.CategoryAxisRenderer.prototype.draw=function(t,i){var o,e,f,u,r;if(this.show){for(this.renderer.createTicks.call(this),o=0,this._elem&&this._elem.emptyForce(),this._elem=this._elem||n('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"><\/div>'),this.name=="xaxis"||this.name=="x2axis"?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions),this._label.show&&(r=this._label.draw(t,i),r.appendTo(this._elem)),e=this._ticks,u=0;u<e.length;u++)f=e[u],f.showLabel&&(!f.isMinorTick||this.showMinorTicks)&&(r=f.draw(t,i),r.appendTo(this._elem));for(this._groupLabels=[],u=0;u<this.groupLabels.length;u++)r=n('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"><\/div>'),r.html(this.groupLabels[u]),this._groupLabels.push(r),r.appendTo(this._elem)}return this._elem};n.jqplot.CategoryAxisRenderer.prototype.set=function(){var t=0,u,f=0,o=0,s=this._label==null?!1:this._label.show,h,e,r,i,c;if(this.show){for(h=this._ticks,i=0;i<h.length;i++)e=h[i],e.showLabel&&(!e.isMinorTick||this.showMinorTicks)&&(u=this.name=="xaxis"||this.name=="x2axis"?e._elem.outerHeight(!0):e._elem.outerWidth(!0),u>t&&(t=u));for(r=0,i=0;i<this._groupLabels.length;i++)c=this._groupLabels[i],u=this.name=="xaxis"||this.name=="x2axis"?c.outerHeight(!0):c.outerWidth(!0),u>r&&(r=u);s&&(f=this._label._elem.outerWidth(!0),o=this._label._elem.outerHeight(!0));this.name=="xaxis"?(t+=r+o,this._elem.css({height:t+"px",left:"0px",bottom:"0px"})):this.name=="x2axis"?(t+=r+o,this._elem.css({height:t+"px",left:"0px",top:"0px"})):this.name=="yaxis"?(t+=r+f,this._elem.css({width:t+"px",left:"0px",top:"0px"}),s&&this._label.constructor==n.jqplot.AxisLabelRenderer&&this._label._elem.css("width",f+"px")):(t+=r+f,this._elem.css({width:t+"px",right:"0px",top:"0px"}),s&&this._label.constructor==n.jqplot.AxisLabelRenderer&&this._label._elem.css("width",f+"px"))}};n.jqplot.CategoryAxisRenderer.prototype.pack=function(t,i){var b=this._ticks,a=this.max,l=this.min,g=i.max,v=i.min,nt=this._label==null?!1:this._label.show,u,f,o,tt,s,k,d,h,it,p,c,w,e,r;for(var y in t)this._elem.css(y,t[y]);if(this._offsets=i,f=g-v,o=a-l,this.reverse?(this.u2p=function(n){return v+(a-n)*f/o},this.p2u=function(n){return l+(n-v)*o/f},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(n){return(a-n)*f/o},this.series_p2u=function(n){return n*o/f+a}):(this.series_u2p=function(n){return(l-n)*f/o},this.series_p2u=function(n){return n*o/f+l})):(this.u2p=function(n){return(n-l)*f/o+v},this.p2u=function(n){return(n-v)*o/f+l},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(n){return(n-l)*f/o},this.series_p2u=function(n){return n*o/f+l}):(this.series_u2p=function(n){return(n-a)*f/o},this.series_p2u=function(n){return n*o/f+a})),this.show)if(this.name=="xaxis"||this.name=="x2axis"){for(u=0;u<b.length;u++)if(r=b[u],r.show&&r.showLabel){if(r.constructor==n.jqplot.CanvasAxisTickRenderer&&r.angle){k=this.name=="xaxis"?1:-1;switch(r.labelPosition){case"auto":s=k*r.angle<0?-r.getWidth()+r._textRenderer.height*Math.sin(-r._textRenderer.angle)/2:-r._textRenderer.height*Math.sin(r._textRenderer.angle)/2;break;case"end":s=-r.getWidth()+r._textRenderer.height*Math.sin(-r._textRenderer.angle)/2;break;case"start":s=-r._textRenderer.height*Math.sin(r._textRenderer.angle)/2;break;case"middle":s=-r.getWidth()/2+r._textRenderer.height*Math.sin(-r._textRenderer.angle)/2;break;default:s=-r.getWidth()/2+r._textRenderer.height*Math.sin(-r._textRenderer.angle)/2}}else s=-r.getWidth()/2;d=this.u2p(r.value)+s+"px";r._elem.css("left",d);r.pack()}for(h=["bottom",0],nt&&(tt=this._label._elem.outerWidth(!0),this._label._elem.css("left",v+f/2-tt/2+"px"),this.name=="xaxis"?(this._label._elem.css("bottom","0px"),h=["bottom",this._label._elem.outerHeight(!0)]):(this._label._elem.css("top","0px"),h=["top",this._label._elem.outerHeight(!0)]),this._label.pack()),p=parseInt(this._ticks.length/this.groups,10)+1,u=0;u<this._groupLabels.length;u++){for(c=0,w=0,e=u*p;e<(u+1)*p;e++)e>=this._ticks.length-1||this._ticks[e]._elem&&this._ticks[e].label!=" "&&(r=this._ticks[e]._elem,y=r.position(),c+=y.left+r.outerWidth(!0)/2,w++);c=c/w;this._groupLabels[u].css({left:c-this._groupLabels[u].outerWidth(!0)/2});this._groupLabels[u].css(h[0],h[1])}}else{for(u=0;u<b.length;u++)if(r=b[u],r.show&&r.showLabel){if(r.constructor==n.jqplot.CanvasAxisTickRenderer&&r.angle){k=this.name=="yaxis"?1:-1;switch(r.labelPosition){case"auto":case"end":s=k*r.angle<0?-r._textRenderer.height*Math.cos(-r._textRenderer.angle)/2:-r.getHeight()+r._textRenderer.height*Math.cos(r._textRenderer.angle)/2;break;case"start":s=r.angle>0?-r._textRenderer.height*Math.cos(-r._textRenderer.angle)/2:-r.getHeight()+r._textRenderer.height*Math.cos(r._textRenderer.angle)/2;break;case"middle":s=-r.getHeight()/2;break;default:s=-r.getHeight()/2}}else s=-r.getHeight()/2;d=this.u2p(r.value)+s+"px";r._elem.css("top",d);r.pack()}for(h=["left",0],nt&&(it=this._label._elem.outerHeight(!0),this._label._elem.css("top",g-f/2-it/2+"px"),this.name=="yaxis"?(this._label._elem.css("left","0px"),h=["left",this._label._elem.outerWidth(!0)]):(this._label._elem.css("right","0px"),h=["right",this._label._elem.outerWidth(!0)]),this._label.pack()),p=parseInt(this._ticks.length/this.groups,10)+1,u=0;u<this._groupLabels.length;u++){for(c=0,w=0,e=u*p;e<(u+1)*p;e++)e>=this._ticks.length-1||this._ticks[e]._elem&&this._ticks[e].label!=" "&&(r=this._ticks[e]._elem,y=r.position(),c+=y.top+r.outerHeight()/2,w++);c=c/w;this._groupLabels[u].css({top:c-this._groupLabels[u].outerHeight()/2});this._groupLabels[u].css(h[0],h[1])}}}})(jQuery);