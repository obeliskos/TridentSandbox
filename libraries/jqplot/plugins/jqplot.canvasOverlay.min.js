(function(n){function t(){this.uid=null;this.type=null;this.gridStart=null;this.gridStop=null;this.tooltipWidthFactor=0;this.options={name:null,show:!0,lineWidth:2,lineCap:"round",color:"#666666",shadow:!0,shadowAngle:45,shadowOffset:1,shadowDepth:3,shadowAlpha:"0.07",xaxis:"xaxis",yaxis:"yaxis",showTooltip:!1,showTooltipPrecision:.6,tooltipLocation:"nw",fadeTooltip:!0,tooltipFadeSpeed:"fast",tooltipOffset:4,tooltipFormatString:"%d, %d"}}function u(i){t.call(this);this.type="rectangle";n.extend(!0,this.options,{xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function f(i){t.call(this);this.type="line";n.extend(!0,this.options,{start:[],stop:[]},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function e(i){t.call(this);this.type="horizontalLine";n.extend(!0,this.options,{y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function o(i){t.call(this);this.type="dashedHorizontalLine";n.extend(!0,this.options,{y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null,dashPattern:[8,8]},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function s(i){t.call(this);this.type="verticalLine";n.extend(!0,this.options,{x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function h(i){t.call(this);this.type="dashedVerticalLine";this.start=null;this.stop=null;n.extend(!0,this.options,{x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null,dashPattern:[8,8]},i);this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function i(t,i,r,u){var h=t.plugins.canvasOverlay,f=h._tooltipElem,e=i.options,o,s;f.html(n.jqplot.sprintf(e.tooltipFormatString,u[0],u[1]));switch(e.tooltipLocation){case"nw":o=r[0]+t._gridPadding.left-f.outerWidth(!0)-e.tooltipOffset;s=r[1]+t._gridPadding.top-e.tooltipOffset-f.outerHeight(!0);break;case"n":o=r[0]+t._gridPadding.left-f.outerWidth(!0)/2;s=r[1]+t._gridPadding.top-e.tooltipOffset-f.outerHeight(!0);break;case"ne":o=r[0]+t._gridPadding.left+e.tooltipOffset;s=r[1]+t._gridPadding.top-e.tooltipOffset-f.outerHeight(!0);break;case"e":o=r[0]+t._gridPadding.left+e.tooltipOffset;s=r[1]+t._gridPadding.top-f.outerHeight(!0)/2;break;case"se":o=r[0]+t._gridPadding.left+e.tooltipOffset;s=r[1]+t._gridPadding.top+e.tooltipOffset;break;case"s":o=r[0]+t._gridPadding.left-f.outerWidth(!0)/2;s=r[1]+t._gridPadding.top+e.tooltipOffset;break;case"sw":o=r[0]+t._gridPadding.left-f.outerWidth(!0)-e.tooltipOffset;s=r[1]+t._gridPadding.top+e.tooltipOffset;break;case"w":o=r[0]+t._gridPadding.left-f.outerWidth(!0)-e.tooltipOffset;s=r[1]+t._gridPadding.top-f.outerHeight(!0)/2;break;default:o=r[0]+t._gridPadding.left-f.outerWidth(!0)-e.tooltipOffset;s=r[1]+t._gridPadding.top-e.tooltipOffset-f.outerHeight(!0)}f.css("left",o);f.css("top",s);e.fadeTooltip?f.stop(!0,!0).fadeIn(e.tooltipFadeSpeed):f.show();f=null}function c(n,t,i,r){var s=n[0],h=n[1],u=Math.round(i[0]),f=Math.round(i[1]),e=Math.round(t[0]),o=Math.round(t[1]),c=Math.sqrt(Math.pow(u-e,2)+Math.pow(f-o,2)),l=r*c,a=Math.abs((e-u)*(h-f)-(o-f)*(s-u));return a<l?!0:!1}function l(n,t,i){var s=n[0],h=n[1],r=Math.round(i[0]),u=Math.round(i[1]),f=Math.round(t[0]),e=Math.round(t[1]),o;return r>f&&(o=r,r=f,f=o),u>e&&(o=u,u=e,e=o),s>=r&&s<=f&&h>=u&&h<=e}function a(n,t,r,u,f){for(var v,o=f.plugins.canvasOverlay,y=o.objects,p=y.length,e,a=!1,s,h=0;h<p;h++)if(e=y[h],e.options.showTooltip)if(v=e.type==="rectangle"?l([t.x,t.y],e.gridStart,e.gridStop,e.tooltipWidthFactor):c([t.x,t.y],e.gridStart,e.gridStop,e.tooltipWidthFactor),r=[f.axes[e.options.xaxis].series_p2u(t.x),f.axes[e.options.yaxis].series_p2u(t.y)],v&&o.highlightObjectIndex==null){switch(e.type){case"line":i(f,e,[t.x,t.y],r);break;case"horizontalLine":case"dashedHorizontalLine":i(f,e,[t.x,e.gridStart[1]],[r[0],e.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]]);break;case"rectangle":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]])}o.highlightObjectIndex=h;a=!0;break}else if(v&&o.highlightObjectIndex!==h){s=o._tooltipElem;e.fadeTooltip?s.fadeOut(e.tooltipFadeSpeed):s.hide();switch(e.type){case"line":i(f,e,[t.x,t.y],r);break;case"horizontalLine":case"dashedHorizontalLine":i(f,e,[t.x,e.gridStart[1]],[r[0],e.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]]);break;case"rectangle":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]])}o.highlightObjectIndex=h;a=!0;break}else if(v){switch(e.type){case"line":i(f,e,[t.x,t.y],r);break;case"horizontalLine":case"dashedHorizontalLine":i(f,e,[t.x,e.gridStart[1]],[r[0],e.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]]);break;case"rectangle":i(f,e,[e.gridStart[0],t.y],[e.options.x,r[1]])}a=!0;break}a||o.highlightObjectIndex===null||(s=o._tooltipElem,e=o.getObject(o.highlightObjectIndex),e.fadeTooltip?s.fadeOut(e.tooltipFadeSpeed):s.hide(),o.highlightObjectIndex=null)}var r=0;n.jqplot.CanvasOverlay=function(t){var f=t||{},e,i,u,r;if(this.options={show:n.jqplot.config.enablePlugins,deferDraw:!1},this.objects=[],this.objectNames=[],this.canvas=null,this.markerRenderer=new n.jqplot.MarkerRenderer({style:"line"}),this.markerRenderer.init(),this.highlightObjectIndex=null,f.objects)for(e=f.objects,u=0;u<e.length;u++){i=e[u];for(r in i)switch(r){case"line":this.addLine(i[r]);break;case"horizontalLine":this.addHorizontalLine(i[r]);break;case"dashedHorizontalLine":this.addDashedHorizontalLine(i[r]);break;case"verticalLine":this.addVerticalLine(i[r]);break;case"dashedVerticalLine":this.addDashedVerticalLine(i[r]);break;case"rectangle":this.addRectangle(i[r])}}n.extend(!0,this.options,f)};n.jqplot.CanvasOverlay.postPlotInit=function(t,i,r){var u=r||{};this.plugins.canvasOverlay=new n.jqplot.CanvasOverlay(u.canvasOverlay)};u.prototype=new t;u.prototype.constructor=u;f.prototype=new t;f.prototype.constructor=f;e.prototype=new t;e.prototype.constructor=e;o.prototype=new t;o.prototype.constructor=o;s.prototype=new t;s.prototype.constructor=s;h.prototype=new t;h.prototype.constructor=h;n.jqplot.CanvasOverlay.prototype.addLine=function(n){var t=new f(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.addHorizontalLine=function(n){var t=new e(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.addDashedHorizontalLine=function(n){var t=new o(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.addVerticalLine=function(n){var t=new s(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.addDashedVerticalLine=function(n){var t=new h(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.addRectangle=function(n){var t=new u(n);t.uid=r++;this.objects.push(t);this.objectNames.push(t.options.name)};n.jqplot.CanvasOverlay.prototype.removeObject=function(t){if(n.type(t)=="number")this.objects.splice(t,1),this.objectNames.splice(t,1);else{var i=n.inArray(t,this.objectNames);i!=-1&&(this.objects.splice(i,1),this.objectNames.splice(i,1))}};n.jqplot.CanvasOverlay.prototype.getObject=function(t){if(n.type(t)=="number")return this.objects[t];var i=n.inArray(t,this.objectNames);if(i!=-1)return this.objects[i]};n.jqplot.CanvasOverlay.prototype.get=n.jqplot.CanvasOverlay.prototype.getObject;n.jqplot.CanvasOverlay.prototype.clear=function(){this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight())};n.jqplot.CanvasOverlay.prototype.draw=function(t){var i,et=this.objects,w=this.markerRenderer,ut,ft,it,b,rt,k,tt,h,nt,y,p;if(this.options.show)for(this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight()),it=0;it<et.length;it++)if(i=et[it],b=n.extend(!0,{},i.options),i.options.show){w.shadow=i.options.shadow;i.tooltipWidthFactor=i.options.lineWidth/i.options.showTooltipPrecision;switch(i.type){case"line":w.style="line";b.closePath=!1;ut=[t.axes[i.options.xaxis].series_u2p(i.options.start[0]),t.axes[i.options.yaxis].series_u2p(i.options.start[1])];ft=[t.axes[i.options.xaxis].series_u2p(i.options.stop[0]),t.axes[i.options.yaxis].series_u2p(i.options.stop[1])];i.gridStart=ut;i.gridStop=ft;w.draw(ut,ft,this.canvas._ctx,b);break;case"horizontalLine":if(i.options.y!=null){w.style="line";b.closePath=!1;var r=t.axes[i.options.xaxis],o,s,d=t.axes[i.options.yaxis].series_u2p(i.options.y),c=i.options.xminOffset||i.options.xOffset,l=i.options.xmaxOffset||i.options.xOffset;i.options.xmin!=null?o=r.series_u2p(i.options.xmin):c!=null&&(n.type(c)=="number"?o=r.series_u2p(r.min+c):n.type(c)=="string"&&(o=r.series_u2p(r.min)+parseFloat(c)));i.options.xmax!=null?s=r.series_u2p(i.options.xmax):l!=null&&(n.type(l)=="number"?s=r.series_u2p(r.max-l):n.type(l)=="string"&&(s=r.series_u2p(r.max)-parseFloat(l)));s!=null&&o!=null&&(i.gridStart=[o,d],i.gridStop=[s,d],w.draw([o,d],[s,d],this.canvas._ctx,b))}break;case"dashedHorizontalLine":for(h=i.options.dashPattern,nt=0,y=0;y<h.length;y++)nt+=h[y];if(i.options.y!=null){w.style="line";b.closePath=!1;var r=t.axes[i.options.xaxis],o,s,d=t.axes[i.options.yaxis].series_u2p(i.options.y),c=i.options.xminOffset||i.options.xOffset,l=i.options.xmaxOffset||i.options.xOffset;if(i.options.xmin!=null?o=r.series_u2p(i.options.xmin):c!=null&&(n.type(c)=="number"?o=r.series_u2p(r.min+c):n.type(c)=="string"&&(o=r.series_u2p(r.min)+parseFloat(c))),i.options.xmax!=null?s=r.series_u2p(i.options.xmax):l!=null&&(n.type(l)=="number"?s=r.series_u2p(r.max-l):n.type(l)=="string"&&(s=r.series_u2p(r.max)-parseFloat(l))),s!=null&&o!=null)for(i.gridStart=[o,d],i.gridStop=[s,d],rt=Math.ceil((s-o)/nt),k=o,y=0;y<rt;y++)for(p=0;p<h.length;p+=2)tt=k+h[p],w.draw([k,d],[tt,d],this.canvas._ctx,b),k+=h[p],p<h.length-1&&(k+=h[p+1])}break;case"verticalLine":if(i.options.x!=null){w.style="line";b.closePath=!1;var u=t.axes[i.options.yaxis],e,f,g=t.axes[i.options.xaxis].series_u2p(i.options.x),a=i.options.yminOffset||i.options.yOffset,v=i.options.ymaxOffset||i.options.yOffset;i.options.ymin!=null?e=u.series_u2p(i.options.ymin):a!=null&&(n.type(a)=="number"?e=u.series_u2p(u.min-a):n.type(a)=="string"&&(e=u.series_u2p(u.min)-parseFloat(a)));i.options.ymax!=null?f=u.series_u2p(i.options.ymax):v!=null&&(n.type(v)=="number"?f=u.series_u2p(u.max+v):n.type(v)=="string"&&(f=u.series_u2p(u.max)+parseFloat(v)));f!=null&&e!=null&&(i.gridStart=[g,e],i.gridStop=[g,f],w.draw([g,e],[g,f],this.canvas._ctx,b))}break;case"dashedVerticalLine":for(h=i.options.dashPattern,nt=0,y=0;y<h.length;y++)nt+=h[y];if(i.options.x!=null){w.style="line";b.closePath=!1;var u=t.axes[i.options.yaxis],e,f,g=t.axes[i.options.xaxis].series_u2p(i.options.x),a=i.options.yminOffset||i.options.yOffset,v=i.options.ymaxOffset||i.options.yOffset;if(i.options.ymin!=null?e=u.series_u2p(i.options.ymin):a!=null&&(n.type(a)=="number"?e=u.series_u2p(u.min-a):n.type(a)=="string"&&(e=u.series_u2p(u.min)-parseFloat(a))),i.options.ymax!=null?f=u.series_u2p(i.options.ymax):v!=null&&(n.type(v)=="number"?f=u.series_u2p(u.max+v):n.type(v)=="string"&&(f=u.series_u2p(u.max)+parseFloat(v))),f!=null&&e!=null){i.gridStart=[g,e];i.gridStop=[g,f];var rt=Math.ceil((e-f)/nt),ot=(rt*nt-(e-f))/2,k=e,tt;for(y=0;y<rt;y++)for(p=0;p<h.length;p+=2)tt=k-h[p],tt<f&&(tt=f),k<f&&(k=f),w.draw([g,k],[g,tt],this.canvas._ctx,b),k-=h[p],p<h.length-1&&(k-=h[p+1])}}break;case"rectangle":w.style="line";b.closePath=!0;var r=t.axes[i.options.xaxis],o,s,d=t.axes[i.options.yaxis].series_u2p(i.options.y),c=i.options.xminOffset||i.options.xOffset,l=i.options.xmaxOffset||i.options.xOffset;i.options.xmin!=null?o=r.series_u2p(i.options.xmin):c!=null&&(n.type(c)=="number"?o=r.series_u2p(r.min+c):n.type(c)=="string"&&(o=r.series_u2p(r.min)+parseFloat(c)));i.options.xmax!=null?s=r.series_u2p(i.options.xmax):l!=null&&(n.type(l)=="number"?s=r.series_u2p(r.max-l):n.type(l)=="string"&&(s=r.series_u2p(r.max)-parseFloat(l)));var u=t.axes[i.options.yaxis],e,f,g=t.axes[i.options.xaxis].series_u2p(i.options.x),a=i.options.yminOffset||i.options.yOffset,v=i.options.ymaxOffset||i.options.yOffset;i.options.ymin!=null?e=u.series_u2p(i.options.ymin):a!=null&&(n.type(a)=="number"?e=u.series_u2p(u.min-a):n.type(a)=="string"&&(e=u.series_u2p(u.min)-parseFloat(a)));i.options.ymax!=null?f=u.series_u2p(i.options.ymax):v!=null&&(n.type(v)=="number"?f=u.series_u2p(u.max+v):n.type(v)=="string"&&(f=u.series_u2p(u.max)+parseFloat(v)));s!=null&&o!=null&&f!=null&&e!=null&&(i.gridStart=[o,e],i.gridStop=[s,f],this.canvas._ctx.fillStyle=i.options.color,this.canvas._ctx.fillRect(o,e,s-o,f-e))}}};n.jqplot.CanvasOverlay.postPlotDraw=function(){var t=this.plugins.canvasOverlay,i;t&&t.highlightCanvas&&(t.highlightCanvas.resetCanvas(),t.highlightCanvas=null);t.canvas=new n.jqplot.GenericCanvas;this.eventCanvas._elem.before(t.canvas.createElement(this._gridPadding,"jqplot-overlayCanvas-canvas",this._plotDimensions,this));t.canvas.setContext();t.deferDraw||t.draw(this);i=document.createElement("div");t._tooltipElem=n(i);i=null;t._tooltipElem.addClass("jqplot-canvasOverlay-tooltip");t._tooltipElem.css({position:"absolute",display:"none"});this.eventCanvas._elem.before(t._tooltipElem);this.eventCanvas._elem.bind("mouseleave",{elem:t._tooltipElem},function(n){n.data.elem.hide()});t=null};n.jqplot.postInitHooks.push(n.jqplot.CanvasOverlay.postPlotInit);n.jqplot.postDrawHooks.push(n.jqplot.CanvasOverlay.postPlotDraw);n.jqplot.eventListenerHooks.push(["jqplotMouseMove",a])})(jQuery);