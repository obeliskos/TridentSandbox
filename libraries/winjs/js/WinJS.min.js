/*! Copyright (c) Microsoft Corporation.  All Rights Reserved. Licensed under the MIT License. See License.txt in the project root for license information. */
(function(n){var n=typeof window!="undefined"?window:typeof self!="undefined"?self:typeof global!="undefined"?global:{};(function(t){typeof define=="function"&&define.amd?define([],t):(n.msWriteProfilerMark&&msWriteProfilerMark("WinJS.4.0 4.0.0.winjs.2015.4.28 WinJS.js,StartTM"),t(n.WinJS),n.msWriteProfilerMark&&msWriteProfilerMark("WinJS.4.0 4.0.0.winjs.2015.4.28 WinJS.js,StopTM"))})(function(){var i,t,r;return function(){"use strict";function r(n,t){n=n||"";var i=n.split("/");return i.pop(),t.map(function(n){if(n[0]==="."){var r=n.split("/"),t=i.slice(0);return r.forEach(function(n){n===".."?t.pop():n!=="."&&t.push(n)}),t.join("/")}return n})}function f(t,f,e){return t.map(function(t){if(t==="exports")return e;if(t==="require")return function(n,t){i(r(f,n),t)};var o=n[t];if(!o)throw new Error("Undefined dependency: "+t);return o.resolved||(o.resolved=u(o.dependencies,o.factory,t,o.exports),typeof o.resolved=="undefined"&&(o.resolved=o.exports)),o.resolved})}function u(n,t,i,r){var u=f(n,i,r);return t&&t.apply?t.apply(null,u):t}var n={};t=function(t,i,u){Array.isArray(i)||(u=i,i=[]);var f={dependencies:r(t,i),factory:u};i.indexOf("exports")!==-1&&(f.exports={});n[t]=f};i=function(n,t){Array.isArray(n)||(n=[n]);u(n,t)}}(),t("amd",function(){}),t("WinJS/Core/_WinJS",{}),t("WinJS/Core/_Global",[],function(){"use strict";return typeof window!="undefined"?window:typeof self!="undefined"?self:typeof global!="undefined"?global:{}}),t("WinJS/Core/_BaseCoreUtils",["./_Global"],function(n){"use strict";function i(n){return n.supportedForProcessing=!0,n}var t=!!n.Windows;return{hasWinRT:t,markSupportedForProcessing:i,_setImmediate:n.setImmediate?n.setImmediate.bind(n):function(t){n.setTimeout(t,0)}}}),t("WinJS/Core/_WriteProfilerMark",["./_Global"],function(n){"use strict";return n.msWriteProfilerMark||function(){}}),t("WinJS/Core/_Base",["./_WinJS","./_Global","./_BaseCoreUtils","./_WriteProfilerMark"],function(n,t,i,r){"use strict";function u(n,t,i){for(var s=Object.keys(t),h=Array.isArray(n),u,e=0,c=s.length;e<c;e++){var f=s[e],o=f.charCodeAt(0)!==95,r=t[f];if(r&&typeof r=="object"&&(r.value!==undefined||typeof r.get=="function"||typeof r.set=="function")){r.enumerable===undefined&&(r.enumerable=o);i&&r.setName&&typeof r.setName=="function"&&r.setName(i+"."+f);u=u||{};u[f]=r;continue}if(!o){u=u||{};u[f]={value:r,enumerable:o,configurable:!0,writable:!0};continue}h?n.forEach(function(n){n[f]=r}):n[f]=r}u&&(h?n.forEach(function(n){Object.defineProperties(n,u)}):Object.defineProperties(n,u))}return function(){function e(i,r){var u=i||{},f,e,s,o;if(r)for(f=r.split("."),u===t&&f[0]==="WinJS"&&(u=n,f.splice(0,1)),e=0,s=f.length;e<s;e++)o=f[e],u[o]||Object.defineProperty(u,o,{value:{},writable:!1,enumerable:!0,configurable:!0}),u=u[o];return u}function o(n,t,i){var r=e(n,t);return i&&u(r,i,t||"<ANONYMOUS>"),r}function s(n,i){return o(t,n,i)}function h(n){var f,t=i.uninitialized,u;return{setName:function(n){f=n},get:function(){switch(t){case i.initialized:return u;case i.uninitialized:t=i.working;try{r("WinJS.Namespace._lazy:"+f+",StartTM");u=n()}finally{r("WinJS.Namespace._lazy:"+f+",StopTM");t=i.uninitialized}return n=null,t=i.initialized,u;case i.working:throw"Illegal: reentrancy on initialization";default:throw"Illegal";}},set:function(n){switch(t){case i.working:throw"Illegal: reentrancy on initialization";default:t=i.initialized;u=n}},enumerable:!0,configurable:!0}}function c(n,i,r){var o=[n],f=null;return i&&(f=e(t,i),o.push(f)),u(o,r,i||"<ANONYMOUS>"),f}var f=n,i;f.Namespace||(f.Namespace=Object.create(Object.prototype));i={uninitialized:1,working:2,initialized:3};Object.defineProperties(f.Namespace,{defineWithParent:{value:o,writable:!0,enumerable:!0,configurable:!0},define:{value:s,writable:!0,enumerable:!0,configurable:!0},_lazy:{value:h,writable:!0,enumerable:!0,configurable:!0},_moduleDefine:{value:c,writable:!0,enumerable:!0,configurable:!0}})}(),function(){function t(n,t,r){return n=n||function(){},i.markSupportedForProcessing(n),t&&u(n.prototype,t),r&&u(n,r),n}function r(n,r,f,e){if(n){r=r||function(){};var o=n.prototype;return r.prototype=Object.create(o),i.markSupportedForProcessing(r),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,configurable:!0,enumerable:!0}),f&&u(r.prototype,f),e&&u(r,e),r}return t(r,f,e)}function f(n){n=n||function(){};for(var t=1,i=arguments.length;t<i;t++)u(n.prototype,arguments[t]);return n}n.Namespace.define("WinJS.Class",{define:t,derive:r,mix:f})}(),{Namespace:n.Namespace,Class:n.Class}}),t("WinJS/Core/_ErrorFromName",["./_Base"],function(n){"use strict";var t=n.Class.derive(Error,function(n,t){this.name=n;this.message=t||n},{},{supportedForProcessing:!1});return n.Namespace.define("WinJS",{ErrorFromName:t}),t}),t("WinJS/Core/_WinRT",["exports","./_Global","./_Base",],function(n,t,i){"use strict";n.msGetWeakWinRTProperty=t.msGetWeakWinRTProperty;n.msSetWeakWinRTProperty=t.msSetWeakWinRTProperty;["Windows.ApplicationModel.DesignMode.designModeEnabled","Windows.ApplicationModel.Resources.Core.ResourceContext","Windows.ApplicationModel.Resources.Core.ResourceManager","Windows.ApplicationModel.Search.SearchQueryLinguisticDetails","Windows.Data.Text.SemanticTextQuery","Windows.Foundation.Collections.CollectionChange","Windows.Foundation.Diagnostics","Windows.Foundation.Uri","Windows.Globalization.ApplicationLanguages","Windows.Globalization.Calendar","Windows.Globalization.DateTimeFormatting","Windows.Globalization.Language","Windows.Phone.UI.Input.HardwareButtons","Windows.Storage.ApplicationData","Windows.Storage.CreationCollisionOption","Windows.Storage.BulkAccess.FileInformationFactory","Windows.Storage.FileIO","Windows.Storage.FileProperties.ThumbnailType","Windows.Storage.FileProperties.ThumbnailMode","Windows.Storage.FileProperties.ThumbnailOptions","Windows.Storage.KnownFolders","Windows.Storage.Search.FolderDepth","Windows.Storage.Search.IndexerOption","Windows.Storage.Streams.RandomAccessStreamReference","Windows.UI.ApplicationSettings.SettingsEdgeLocation","Windows.UI.ApplicationSettings.SettingsCommand","Windows.UI.ApplicationSettings.SettingsPane","Windows.UI.Core.AnimationMetrics","Windows.UI.Input.EdgeGesture","Windows.UI.Input.EdgeGestureKind","Windows.UI.Input.PointerPoint","Windows.UI.ViewManagement.HandPreference","Windows.UI.ViewManagement.InputPane","Windows.UI.ViewManagement.UISettings","Windows.UI.WebUI.Core.WebUICommandBar","Windows.UI.WebUI.Core.WebUICommandBarBitmapIcon","Windows.UI.WebUI.Core.WebUICommandBarClosedDisplayMode","Windows.UI.WebUI.Core.WebUICommandBarIconButton","Windows.UI.WebUI.Core.WebUICommandBarSymbolIcon","Windows.UI.WebUI.WebUIApplication",].forEach(function(r){var u=r.split("."),f={};f[u[u.length-1]]={get:function(){return u.reduce(function(n,t){return n?n[t]:null},t)}};i.Namespace.defineWithParent(n,u.slice(0,-1).join("."),f)})}),t("WinJS/Core/_Events",["exports","./_Base"],function(n,t){"use strict";function i(n){var t="_on"+n+"state";return{get:function(){var n=this[t];return n&&n.userHandler},set:function(i){var r=this[t];i?(r||(r={wrapper:function(n){return r.userHandler(n)},userHandler:i},Object.defineProperty(this,t,{value:r,enumerable:!1,writable:!0,configurable:!0}),this.addEventListener(n,r.wrapper,!1)),r.userHandler=i):r&&(this.removeEventListener(n,r.wrapper,!1),this[t]=null)},enumerable:!0}}function r(){for(var t,r={},n=0,u=arguments.length;n<u;n++)t=arguments[n],r["on"+t]=i(t);return r}var u=t.Class.define(function(n,t,i){this.detail=t;this.target=i;this.timeStamp=Date.now();this.type=n},{bubbles:{value:!1,writable:!1},cancelable:{value:!1,writable:!1},currentTarget:{get:function(){return this.target}},defaultPrevented:{get:function(){return this._preventDefaultCalled}},trusted:{value:!1,writable:!1},eventPhase:{value:0,writable:!1},target:null,timeStamp:null,type:null,preventDefault:function(){this._preventDefaultCalled=!0},stopImmediatePropagation:function(){this._stopImmediatePropagationCalled=!0},stopPropagation:function(){}},{supportedForProcessing:!1}),f={_listeners:null,addEventListener:function(n,t,i){var r,u,e,f;for(i=i||!1,this._listeners=this._listeners||{},r=this._listeners[n]=this._listeners[n]||[],u=0,e=r.length;u<e;u++)if(f=r[u],f.useCapture===i&&f.listener===t)return;r.push({listener:t,useCapture:i})},dispatchEvent:function(n,t){var i=this._listeners&&this._listeners[n],r,f,e;if(i){for(r=new u(n,t,this),i=i.slice(0,i.length),f=0,e=i.length;f<e&&!r._stopImmediatePropagationCalled;f++)i[f].listener(r);return r.defaultPrevented||!1}return!1},removeEventListener:function(n,t,i){var r,u,e,f;if(i=i||!1,r=this._listeners&&this._listeners[n],r)for(u=0,e=r.length;u<e;u++)if(f=r[u],f.listener===t&&f.useCapture===i){r.splice(u,1);r.length===0&&delete this._listeners[n];break}}};t.Namespace._moduleDefine(n,"WinJS.Utilities",{_createEventProperty:i,createEventProperties:r,eventMixin:f})}),t("require-json",{load:function(n){throw new Error("Dynamic load not allowed: "+n);}}),t("require-json!en-US/ui.resjson",{appBarAriaLabel:"App Bar",appBarCommandAriaLabel:"App Bar Item",appBarOverflowButtonAriaLabel:"View more",autoSuggestBoxAriaLabel:"Autosuggestbox",autoSuggestBoxAriaLabelInputNoPlaceHolder:"Autosuggestbox, enter to submit query, esc to clear text",autoSuggestBoxAriaLabelInputPlaceHolder:"Autosuggestbox, {0}, enter to submit query, esc to clear text",autoSuggestBoxAriaLabelQuery:"Suggestion: {0}","_autoSuggestBoxAriaLabelQuery.comment":"Suggestion: query text (example: Suggestion: contoso)",autoSuggestBoxAriaLabelSeparator:"Separator: {0}","_autoSuggestBoxAriaLabelSeparator.comment":"Separator: separator text (example: Separator: People or Separator: Apps)",autoSuggestBoxAriaLabelResult:"Result: {0}, {1}","_autoSuggestBoxAriaLabelResult.comment":"Result: text, detailed text (example: Result: contoso, www.contoso.com)",averageRating:"Average Rating",backbuttonarialabel:"Back",chapterSkipBackMediaCommandDisplayText:"Chapter back",chapterSkipForwardMediaCommandDisplayText:"Chapter forward",clearYourRating:"Clear your rating",closedCaptionsLabelNone:"Off",closedCaptionsMediaCommandDisplayText:"Closed captioning",closeOverlay:"Close",commandingSurfaceAriaLabel:"CommandingSurface",commandingSurfaceOverflowButtonAriaLabel:"View more",datePicker:"Date Picker",fastForwardMediaCommandDisplayText:"Fast forward",fastForwardFeedbackDisplayText:" {0}X",fastForwardFeedbackSlowMotionDisplayText:"0.5X",flipViewPanningContainerAriaLabel:"Scrolling Container",flyoutAriaLabel:"Flyout",goToFullScreenButtonLabel:"Go full screen",goToLiveMediaCommandDisplayText:"LIVE",hubViewportAriaLabel:"Scrolling Container",listViewViewportAriaLabel:"Scrolling Container",mediaErrorAborted:"Playback was interrupted. Please try again.",mediaErrorNetwork:"There was a network connection error.",mediaErrorDecode:"The content could not be decoded",mediaErrorSourceNotSupported:"This content type is not supported.",mediaErrorUnknown:"There was an unknown error.",mediaPlayerAudioTracksButtonLabel:"Audio tracks",mediaPlayerCastButtonLabel:"Cast",mediaPlayerChapterSkipBackButtonLabel:"Previous",mediaPlayerChapterSkipForwardButtonLabel:"Next",mediaPlayerClosedCaptionsButtonLabel:"Closed captions",mediaPlayerFastForwardButtonLabel:"Fast forward",mediaPlayerFullscreenButtonLabel:"Fullscreen",mediaPlayerLiveButtonLabel:"LIVE",mediaPlayerNextTrackButtonLabel:"Next",mediaPlayerOverlayActiveOptionIndicator:"(On)",mediaPlayerPauseButtonLabel:"Pause",mediaPlayerPlayButtonLabel:"Play",mediaPlayerPlayFromBeginningButtonLabel:"Replay",mediaPlayerPlayRateButtonLabel:"Playback rate",mediaPlayerPreviousTrackButtonLabel:"Previous",mediaPlayerRewindButtonLabel:"Rewind",mediaPlayerStopButtonLabel:"Stop",mediaPlayerTimeSkipBackButtonLabel:"8 second replay",mediaPlayerTimeSkipForwardButtonLabel:"30 second skip",mediaPlayerToggleSnapButtonLabel:"Snap",mediaPlayerVolumeButtonLabel:"Volume",mediaPlayerZoomButtonLabel:"Zoom",menuCommandAriaLabel:"Menu Item",menuAriaLabel:"Menu",navBarContainerViewportAriaLabel:"Scrolling Container",nextTrackMediaCommandDisplayText:"Next track",off:"Off",on:"On",pauseMediaCommandDisplayText:"Pause",playFromBeginningMediaCommandDisplayText:"Play again",playbackRateHalfSpeedLabel:"0.5x",playbackRateNormalSpeedLabel:"Normal",playbackRateOneAndHalfSpeedLabel:"1.5x",playbackRateDoubleSpeedLabel:"2x",playMediaCommandDisplayText:"Play",pivotAriaLabel:"Pivot",pivotViewportAriaLabel:"Scrolling Container",replayMediaCommandDisplayText:"Play again",rewindMediaCommandDisplayText:"Rewind",rewindFeedbackDisplayText:" {0}X",rewindFeedbackSlowMotionDisplayText:"0.5X",searchBoxAriaLabel:"Searchbox",searchBoxAriaLabelInputNoPlaceHolder:"Searchbox, enter to submit query, esc to clear text",searchBoxAriaLabelInputPlaceHolder:"Searchbox, {0}, enter to submit query, esc to clear text",searchBoxAriaLabelButton:"Click to submit query",seeMore:"See more",selectAMPM:"Select A.M P.M",selectDay:"Select Day",selectHour:"Select Hour",selectMinute:"Select Minute",selectMonth:"Select Month",selectYear:"Select Year",settingsFlyoutAriaLabel:"Settings Flyout",stopMediaCommandDisplayText:"Stop",tentativeRating:"Tentative Rating",timePicker:"Time Picker",timeSeparator:":",timeSkipBackMediaCommandDisplayText:"Skip back",timeSkipForwardMediaCommandDisplayText:"Skip forward",toolbarAriaLabel:"ToolBar",toolbarOverflowButtonAriaLabel:"View more",unrated:"Unrated",userRating:"User Rating",zoomMediaCommandDisplayText:"Zoom","appBarIcons\\previous":"","_appBarIcons\\previous.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\next":"","_appBarIcons\\next.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\play":"","_appBarIcons\\play.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\pause":"","_appBarIcons\\pause.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\edit":"","_appBarIcons\\edit.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\save":"","_appBarIcons\\save.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\clear":"","_appBarIcons\\clear.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\delete":"","_appBarIcons\\delete.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\remove":"","_appBarIcons\\remove.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\add":"","_appBarIcons\\add.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\cancel":"","_appBarIcons\\cancel.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\accept":"","_appBarIcons\\accept.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\more":"","_appBarIcons\\more.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\redo":"","_appBarIcons\\redo.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\undo":"","_appBarIcons\\undo.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\home":"","_appBarIcons\\home.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\up":"","_appBarIcons\\up.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\forward":"","_appBarIcons\\forward.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\right":"","_appBarIcons\\right.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\back":"","_appBarIcons\\back.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\left":"","_appBarIcons\\left.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\favorite":"","_appBarIcons\\favorite.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\camera":"","_appBarIcons\\camera.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\settings":"","_appBarIcons\\settings.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\video":"","_appBarIcons\\video.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\sync":"","_appBarIcons\\sync.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\download":"","_appBarIcons\\download.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mail":"","_appBarIcons\\mail.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\find":"","_appBarIcons\\find.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\help":"","_appBarIcons\\help.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\upload":"","_appBarIcons\\upload.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\emoji":"","_appBarIcons\\emoji.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\twopage":"","_appBarIcons\\twopage.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\leavechat":"","_appBarIcons\\leavechat.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mailforward":"","_appBarIcons\\mailforward.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\clock":"","_appBarIcons\\clock.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\send":"","_appBarIcons\\send.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\crop":"","_appBarIcons\\crop.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\rotatecamera":"","_appBarIcons\\rotatecamera.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\people":"","_appBarIcons\\people.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\closepane":"","_appBarIcons\\closepane.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\openpane":"","_appBarIcons\\openpane.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\world":"","_appBarIcons\\world.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\flag":"","_appBarIcons\\flag.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\previewlink":"","_appBarIcons\\previewlink.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\globe":"","_appBarIcons\\globe.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\trim":"","_appBarIcons\\trim.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\attachcamera":"","_appBarIcons\\attachcamera.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\zoomin":"","_appBarIcons\\zoomin.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\bookmarks":"","_appBarIcons\\bookmarks.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\document":"","_appBarIcons\\document.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\protecteddocument":"","_appBarIcons\\protecteddocument.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\page":"","_appBarIcons\\page.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\bullets":"","_appBarIcons\\bullets.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\comment":"","_appBarIcons\\comment.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mail2":"","_appBarIcons\\mail2.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\contactinfo":"","_appBarIcons\\contactinfo.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\hangup":"","_appBarIcons\\hangup.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\viewall":"","_appBarIcons\\viewall.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mappin":"","_appBarIcons\\mappin.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\phone":"","_appBarIcons\\phone.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\videochat":"","_appBarIcons\\videochat.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\switch":"","_appBarIcons\\switch.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\contact":"","_appBarIcons\\contact.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\rename":"","_appBarIcons\\rename.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\pin":"","_appBarIcons\\pin.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\musicinfo":"","_appBarIcons\\musicinfo.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\go":"","_appBarIcons\\go.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\keyboard":"","_appBarIcons\\keyboard.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\dockleft":"","_appBarIcons\\dockleft.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\dockright":"","_appBarIcons\\dockright.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\dockbottom":"","_appBarIcons\\dockbottom.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\remote":"","_appBarIcons\\remote.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\refresh":"","_appBarIcons\\refresh.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\rotate":"","_appBarIcons\\rotate.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\shuffle":"","_appBarIcons\\shuffle.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\list":"","_appBarIcons\\list.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\shop":"","_appBarIcons\\shop.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\selectall":"","_appBarIcons\\selectall.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\orientation":"","_appBarIcons\\orientation.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\import":"","_appBarIcons\\import.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\importall":"","_appBarIcons\\importall.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\browsephotos":"","_appBarIcons\\browsephotos.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\webcam":"","_appBarIcons\\webcam.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\pictures":"","_appBarIcons\\pictures.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\savelocal":"","_appBarIcons\\savelocal.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\caption":"","_appBarIcons\\caption.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\stop":"","_appBarIcons\\stop.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\showresults":"","_appBarIcons\\showresults.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\volume":"","_appBarIcons\\volume.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\repair":"","_appBarIcons\\repair.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\message":"","_appBarIcons\\message.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\page2":"","_appBarIcons\\page2.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\calendarday":"","_appBarIcons\\calendarday.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\calendarweek":"","_appBarIcons\\calendarweek.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\calendar":"","_appBarIcons\\calendar.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\characters":"","_appBarIcons\\characters.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mailreplyall":"","_appBarIcons\\mailreplyall.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\read":"","_appBarIcons\\read.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\link":"","_appBarIcons\\link.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\accounts":"","_appBarIcons\\accounts.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\showbcc":"","_appBarIcons\\showbcc.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\hidebcc":"","_appBarIcons\\hidebcc.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\cut":"","_appBarIcons\\cut.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\attach":"","_appBarIcons\\attach.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\paste":"","_appBarIcons\\paste.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\filter":"","_appBarIcons\\filter.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\copy":"","_appBarIcons\\copy.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\emoji2":"","_appBarIcons\\emoji2.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\important":"","_appBarIcons\\important.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mailreply":"","_appBarIcons\\mailreply.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\slideshow":"","_appBarIcons\\slideshow.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\sort":"","_appBarIcons\\sort.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\manage":"","_appBarIcons\\manage.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\allapps":"","_appBarIcons\\allapps.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\disconnectdrive":"","_appBarIcons\\disconnectdrive.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mapdrive":"","_appBarIcons\\mapdrive.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\newwindow":"","_appBarIcons\\newwindow.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\openwith":"","_appBarIcons\\openwith.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\contactpresence":"","_appBarIcons\\contactpresence.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\priority":"","_appBarIcons\\priority.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\uploadskydrive":"","_appBarIcons\\uploadskydrive.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\gototoday":"","_appBarIcons\\gototoday.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\font":"","_appBarIcons\\font.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fontcolor":"","_appBarIcons\\fontcolor.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\contact2":"","_appBarIcons\\contact2.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\folder":"","_appBarIcons\\folder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\audio":"","_appBarIcons\\audio.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\placeholder":"","_appBarIcons\\placeholder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\view":"","_appBarIcons\\view.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\setlockscreen":"","_appBarIcons\\setlockscreen.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\settile":"","_appBarIcons\\settile.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\cc":"","_appBarIcons\\cc.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\stopslideshow":"","_appBarIcons\\stopslideshow.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\permissions":"","_appBarIcons\\permissions.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\highlight":"","_appBarIcons\\highlight.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\disableupdates":"","_appBarIcons\\disableupdates.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\unfavorite":"","_appBarIcons\\unfavorite.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\unpin":"","_appBarIcons\\unpin.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\openlocal":"","_appBarIcons\\openlocal.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\mute":"","_appBarIcons\\mute.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\italic":"","_appBarIcons\\italic.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\underline":"","_appBarIcons\\underline.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\bold":"","_appBarIcons\\bold.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\movetofolder":"","_appBarIcons\\movetofolder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\likedislike":"","_appBarIcons\\likedislike.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\dislike":"","_appBarIcons\\dislike.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\like":"","_appBarIcons\\like.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\alignright":"","_appBarIcons\\alignright.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\aligncenter":"","_appBarIcons\\aligncenter.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\alignleft":"","_appBarIcons\\alignleft.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\zoom":"","_appBarIcons\\zoom.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\zoomout":"","_appBarIcons\\zoomout.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\openfile":"","_appBarIcons\\openfile.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\otheruser":"","_appBarIcons\\otheruser.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\admin":"","_appBarIcons\\admin.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\street":"","_appBarIcons\\street.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\map":"","_appBarIcons\\map.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\clearselection":"","_appBarIcons\\clearselection.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fontdecrease":"","_appBarIcons\\fontdecrease.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fontincrease":"","_appBarIcons\\fontincrease.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fontsize":"","_appBarIcons\\fontsize.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\cellphone":"","_appBarIcons\\cellphone.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\reshare":"","_appBarIcons\\reshare.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\tag":"","_appBarIcons\\tag.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\repeatone":"","_appBarIcons\\repeatone.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\repeatall":"","_appBarIcons\\repeatall.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\outlinestar":"","_appBarIcons\\outlinestar.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\solidstar":"","_appBarIcons\\solidstar.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\calculator":"","_appBarIcons\\calculator.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\directions":"","_appBarIcons\\directions.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\target":"","_appBarIcons\\target.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\library":"","_appBarIcons\\library.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\phonebook":"","_appBarIcons\\phonebook.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\memo":"","_appBarIcons\\memo.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\microphone":"","_appBarIcons\\microphone.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\postupdate":"","_appBarIcons\\postupdate.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\backtowindow":"","_appBarIcons\\backtowindow.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fullscreen":"","_appBarIcons\\fullscreen.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\newfolder":"","_appBarIcons\\newfolder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\calendarreply":"","_appBarIcons\\calendarreply.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\unsyncfolder":"","_appBarIcons\\unsyncfolder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\reporthacked":"","_appBarIcons\\reporthacked.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\syncfolder":"","_appBarIcons\\syncfolder.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\blockcontact":"","_appBarIcons\\blockcontact.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\switchapps":"","_appBarIcons\\switchapps.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\addfriend":"","_appBarIcons\\addfriend.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\touchpointer":"","_appBarIcons\\touchpointer.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\gotostart":"","_appBarIcons\\gotostart.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\zerobars":"","_appBarIcons\\zerobars.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\onebar":"","_appBarIcons\\onebar.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\twobars":"","_appBarIcons\\twobars.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\threebars":"","_appBarIcons\\threebars.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\fourbars":"","_appBarIcons\\fourbars.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\scan":"","_appBarIcons\\scan.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\preview":"","_appBarIcons\\preview.comment":"{Locked:qps-ploc,qps-plocm}","appBarIcons\\hamburger":"","_appBarIcons\\hamburger.comment":"{Locked:qps-ploc,qps-plocm}"}),t("WinJS/Core/_Resources",["exports","./_Global","./_WinRT","./_Base","./_Events","require-json!en-US/ui.resjson",],function(n,t,i,r,u,f){"use strict";function y(n){var t=l("ms-resource://"+s+"/"+n);return t.empty&&(t=b(n)),t}function b(n){var i=n.split("/"),t;return i.shift(),t=f[i.join("\\")],typeof t=="string"&&(t={value:t}),t||{value:n,empty:!0}}function a(n){var t=arguments;return t.length>1&&(n=n.replace(/({{)|(}})|{(\d+)}|({)|(})/g,function(n,i,r,u,f,e){if(f||e)throw a(g.malformedFormatStringInput,f||e);return i&&"{"||r&&"}"||t[(u|0)+1]})),n}var s="WinJS.4.0",v="Developer.",w,l;s.indexOf(v)===0&&(s=s.substring(v.length));var e,p=!1,h="contextchanged",c,k=r.Class.mix(r.Class.define(null,{},{supportedForProcessing:!1}),u.eventMixin),o=new k,d=u._createEventProperty,g={get malformedFormatStringInput(){return"Malformed, did you mean to escape your '{0}'?"}};r.Namespace.define("WinJS.Resources",{_getWinJSString:y});r.Namespace._moduleDefine(n,"WinJS.Resources",{addEventListener:function(t,r,u){if(i.Windows.ApplicationModel.Resources.Core.ResourceManager&&!p&&t===h)try{var f=n._getResourceContext();f?f.qualifierValues.addEventListener("mapchanged",function(t){n.dispatchEvent(h,{qualifier:t.key,changed:t.target[t.key]})},!1):i.Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.qualifierValues.addEventListener("mapchanged",function(t){n.dispatchEvent(h,{qualifier:t.key,changed:t.target[t.key]})},!1);p=!0}catch(e){}o.addEventListener(t,r,u)},removeEventListener:o.removeEventListener.bind(o),dispatchEvent:o.dispatchEvent.bind(o),_formatString:a,_getStringWinRT:function(t){var f,r,s,u,o;if(!e){f=i.Windows.ApplicationModel.Resources.Core.ResourceManager.current.mainResourceMap;try{e=f.getSubtree("Resources")}catch(h){}e||(e=f)}try{o=n._getResourceContext();u=o?e.getValue(t,o):e.getValue(t);u&&(r=u.valueAsString,r===undefined&&(r=u.toString()))}catch(h){}if(!r)return n._getStringJS(t);try{s=u.getQualifierValue("Language")}catch(h){return{value:r}}return{value:r,lang:s}},_getStringJS:function(n){var i=t.strings&&t.strings[n];return typeof i=="string"&&(i={value:i}),i||{value:n,empty:!0}},_getResourceContext:function(){if(t.document&&typeof c=="undefined"){var n=i.Windows.ApplicationModel.Resources.Core.ResourceContext;c=n.getForCurrentView?n.getForCurrentView():null}return c},oncontextchanged:d(h)});w=i.Windows.ApplicationModel.Resources.Core.ResourceManager?n._getStringWinRT:n._getStringJS;l=function(n){return w(n)};r.Namespace._moduleDefine(n,null,{_formatString:a,_getWinJSString:y});r.Namespace._moduleDefine(n,"WinJS.Resources",{getString:{get:function(){return l},set:function(n){l=n}}})}),t("WinJS/Core/_Trace",["./_Global"],function(n){"use strict";function t(n){return n}return{_traceAsyncOperationStarting:n.Debug&&n.Debug.msTraceAsyncOperationStarting&&n.Debug.msTraceAsyncOperationStarting.bind(n.Debug)||t,_traceAsyncOperationCompleted:n.Debug&&n.Debug.msTraceAsyncOperationCompleted&&n.Debug.msTraceAsyncOperationCompleted.bind(n.Debug)||t,_traceAsyncCallbackStarting:n.Debug&&n.Debug.msTraceAsyncCallbackStarting&&n.Debug.msTraceAsyncCallbackStarting.bind(n.Debug)||t,_traceAsyncCallbackCompleted:n.Debug&&n.Debug.msTraceAsyncCallbackCompleted&&n.Debug.msTraceAsyncCallbackCompleted.bind(n.Debug)||t}}),t("WinJS/Promise/_StateMachine",["../Core/_Global","../Core/_BaseCoreUtils","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Trace"],function(n,t,i,r,u,f){"use strict";function e(){}function g(n,t){var i;i=t&&typeof t=="object"&&typeof t.then=="function"?p:dt;n._value=t;n._setState(i)}function nt(n,t,i,r,u,f){return{exception:n,error:t,promise:i,handler:f,id:r,parent:u}}function tt(n,t,i,r){var u=i._isException,f=i._errorId;return nt(u?t:null,u?null:t,n,f,i,r)}function gt(n,t,i){var r=i._isException,u=i._errorId;return vt(n,u,r),nt(r?t:null,r?null:t,n,u,i)}function ni(n,t){var i=++ht;return vt(n,i),nt(null,t,n,i)}function ti(n,t){var i=++ht;return vt(n,i,!0),nt(t,null,n,i)}function it(n,t,i,r){var u=f._traceAsyncOperationStarting("WinJS.Promise.done");at(n,{c:t,e:i,p:r,asyncOpID:u})}function rt(n,t,i,r){n._value=t;l(n,t,i,r);n._setState(lt)}function ii(t,i){var l=t._value,u=t._listeners,e,s;if(u)for(t._listeners=null,e=0,s=Array.isArray(u)?u.length:1;e<s;e++){var o=s===1?u:u[e],h=o.c,r=o.promise;if(f._traceAsyncOperationCompleted(o.asyncOpID,n.Debug&&n.Debug.MS_ASYNC_OP_STATUS_SUCCESS),r){f._traceAsyncCallbackStarting(o.asyncOpID);try{r._setCompleteValue(h?h(l):l)}catch(a){r._setExceptionValue(a)}finally{f._traceAsyncCallbackCompleted()}r._state!==p&&r._listeners&&i.push(r)}else c.prototype.done.call(t,h)}}function ri(t,i){var u=t._value,e=t._listeners,s,c,v;if(e)for(t._listeners=null,s=0,c=Array.isArray(e)?e.length:1;s<c;s++){var h=c===1?e:e[s],o=h.e,r=h.promise,w=n.Debug&&(u&&u.name===y?n.Debug.MS_ASYNC_OP_STATUS_CANCELED:n.Debug.MS_ASYNC_OP_STATUS_ERROR);if(f._traceAsyncOperationCompleted(h.asyncOpID,w),r){v=!1;try{o?(f._traceAsyncCallbackStarting(h.asyncOpID),v=!0,o.handlesOnError||l(r,u,tt,t,o),r._setCompleteValue(o(u))):r._setChainedErrorValue(u,t)}catch(b){r._setExceptionValue(b)}finally{v&&f._traceAsyncCallbackCompleted()}r._state!==p&&r._listeners&&i.push(r)}else a.prototype.done.call(t,null,o)}}function l(n,t,i,r,u){if(v._listeners[st]){if(t instanceof Error&&t.message===y)return;v.dispatchEvent(st,i(n,t,r,u))}}function ut(n,t){var r=n._listeners,u,f,i,e;if(r)for(u=0,f=Array.isArray(r)?r.length:1;u<f;u++){if(i=f===1?r:r[u],e=i.p,e)try{e(t)}catch(o){}i.c||i.e||!i.promise||i.promise._progress(t)}}function at(n,t){var i=n._listeners;i?(i=Array.isArray(i)?i:[i],i.push(t)):i=t;n._listeners=i}function vt(n,t,i){n._isException=i||!1;n._errorId=t}function ft(n,t,i,r){n._value=t;l(n,t,i,r);n._setState(k)}function et(n,t){var i;i=t&&typeof t=="object"&&typeof t.then=="function"?p:b;n._value=t;n._setState(i)}function ot(n,t,i,r){var u=new yt(n),e=f._traceAsyncOperationStarting("WinJS.Promise.then");return at(n,{promise:u,c:t,e:i,p:r,asyncOpID:e}),u}function ei(i){var r;return new o(function(u){i?r=n.setTimeout(u,i):t._setImmediate(u)},function(){r&&n.clearTimeout(r)})}function oi(n,t){var r=function(){t.cancel()},i=function(){n.cancel()};return n.then(r),t.then(i,i),t}var pt,v,ht,w,wt,p,bt,kt,ct,dt,b,lt,k,d,fi,o;n.Debug&&(n.Debug.setNonUserCodeExceptions=!0);pt=i.Class.mix(i.Class.define(null,{},{supportedForProcessing:!1}),u.eventMixin);v=new pt;v._listeners={};var st="error",y="Canceled",s=!1,h={promise:1,thenPromise:2,errorPromise:4,exceptionPromise:8,completePromise:16};h.all=h.promise|h.thenPromise|h.errorPromise|h.exceptionPromise|h.completePromise;ht=1;w={name:"created",enter:function(n){n._setState(wt)},cancel:e,done:e,then:e,_completed:e,_error:e,_notify:e,_progress:e,_setCompleteValue:e,_setErrorValue:e};wt={name:"working",enter:e,cancel:function(n){n._setState(kt)},done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};p={name:"waiting",enter:function(n){var t=n._value,i;t instanceof yt&&t._state!==k&&t._state!==b?at(t,{promise:n}):(i=function(r){t._errorId?n._chainedError(r,t):(l(n,r,tt,t,i),n._error(r))},i.handlesOnError=!0,t.then(n._completed.bind(n),i,n._progress.bind(n)))},cancel:function(n){n._setState(bt)},done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};bt={name:"waiting_canceled",enter:function(n){n._setState(ct);var t=n._value;t.cancel&&t.cancel()},cancel:e,done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};kt={name:"canceled",enter:function(n){n._setState(ct);n._cancelAction()},cancel:e,done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};ct={name:"canceling",enter:function(n){var t=new Error(y);t.name=t.message;n._value=t;n._setState(lt)},cancel:e,done:e,then:e,_completed:e,_error:e,_notify:e,_progress:e,_setCompleteValue:e,_setErrorValue:e};dt={name:"complete_notify",enter:function(n){if(n.done=c.prototype.done,n.then=c.prototype.then,n._listeners)for(var t=[n],i;t.length;)i=t.shift(),i._state._notify(i,t);n._setState(b)},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ii,_progress:e,_setCompleteValue:e,_setErrorValue:e};b={name:"success",enter:function(n){n.done=c.prototype.done;n.then=c.prototype.then;n._cleanupAction()},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ii,_progress:e,_setCompleteValue:e,_setErrorValue:e};lt={name:"error_notify",enter:function(n){if(n.done=a.prototype.done,n.then=a.prototype.then,n._listeners)for(var t=[n],i;t.length;)i=t.shift(),i._state._notify(i,t);n._setState(k)},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ri,_progress:e,_setCompleteValue:e,_setErrorValue:e};k={name:"error",enter:function(n){n.done=a.prototype.done;n.then=a.prototype.then;n._cleanupAction()},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ri,_progress:e,_setCompleteValue:e,_setErrorValue:e};d=i.Class.define(null,{_listeners:null,_nextState:null,_state:null,_value:null,cancel:function(){this._state.cancel(this);this._run()},done:function(n,t,i){this._state.done(this,n,t,i)},then:function(n,t,i){return this._state.then(this,n,t,i)},_chainedError:function(n,t){var i=this._state._error(this,n,gt,t);return this._run(),i},_completed:function(n){var t=this._state._completed(this,n);return this._run(),t},_error:function(n){var t=this._state._error(this,n,ni);return this._run(),t},_progress:function(n){this._state._progress(this,n)},_setState:function(n){this._nextState=n},_setCompleteValue:function(n){this._state._setCompleteValue(this,n);this._run()},_setChainedErrorValue:function(n,t){var i=this._state._setErrorValue(this,n,gt,t);return this._run(),i},_setExceptionValue:function(n){var t=this._state._setErrorValue(this,n,ti);return this._run(),t},_run:function(){while(this._nextState)this._state=this._nextState,this._nextState=null,this._state.enter(this)}},{supportedForProcessing:!1});var yt=i.Class.derive(d,function(n){s&&(s===!0||s&h.thenPromise)&&(this._stack=o._getStack());this._creator=n;this._setState(w);this._run()},{_creator:null,_cancelAction:function(){this._creator&&this._creator.cancel()},_cleanupAction:function(){this._creator=null}},{supportedForProcessing:!1}),a=i.Class.define(function(n){s&&(s===!0||s&h.errorPromise)&&(this._stack=o._getStack());this._value=n;l(this,n,ni)},{cancel:function(){},done:function(n,t){var i=this._value,r;if(t)try{t.handlesOnError||l(null,i,tt,this,t);r=t(i);r&&typeof r=="object"&&typeof r.done=="function"&&r.done();return}catch(u){i=u}i instanceof Error&&i.message===y||o._doneHandler(i)},then:function(n,t){if(!t)return this;var i,r=this._value;try{t.handlesOnError||l(null,r,tt,this,t);i=new c(t(r))}catch(u){i=u===r?this:new ui(u)}return i}},{supportedForProcessing:!1}),ui=i.Class.derive(a,function(n){s&&(s===!0||s&h.exceptionPromise)&&(this._stack=o._getStack());this._value=n;l(this,n,ti)},{},{supportedForProcessing:!1}),c=i.Class.define(function(n){if(s&&(s===!0||s&h.completePromise)&&(this._stack=o._getStack()),n&&typeof n=="object"&&typeof n.then=="function"){var t=new yt(null);return t._setCompleteValue(n),t}this._value=n},{cancel:function(){},done:function(n){if(n)try{var t=n(this._value);t&&typeof t=="object"&&typeof t.done=="function"&&t.done()}catch(i){o._doneHandler(i)}},then:function(n){try{var t=n?n(this._value):this._value;return t===this._value?this:new c(t)}catch(i){return new ui(i)}}},{supportedForProcessing:!1});return o=i.Class.derive(d,function(n,t){s&&(s===!0||s&h.promise)&&(this._stack=o._getStack());this._oncancel=t;this._setState(w);this._run();try{var i=this._completed.bind(this),r=this._error.bind(this),u=this._progress.bind(this);n(i,r,u)}catch(f){this._setExceptionValue(f)}},{_oncancel:null,_cancelAction:function(){if(this._oncancel)try{this._oncancel()}catch(n){}},_cleanupAction:function(){this._oncancel=null}},{addEventListener:function(n,t,i){v.addEventListener(n,t,i)},any:function(n){return new o(function(t,i){var r=Object.keys(n),u;r.length===0&&t();u=0;r.forEach(function(f){o.as(n[f]).then(function(){t({key:f,value:n[f]})},function(e){if(e instanceof Error&&e.name===y){++u===r.length&&t(o.cancel);return}i({key:f,value:n[f]})})})},function(){var t=Object.keys(n);t.forEach(function(t){var i=o.as(n[t]);typeof i.cancel=="function"&&i.cancel()})})},as:function(n){return n&&typeof n=="object"&&typeof n.then=="function"?n:new c(n)},cancel:{get:function(){return fi=fi||new a(new r(y))}},dispatchEvent:function(n,t){return v.dispatchEvent(n,t)},is:function(n){return n&&typeof n=="object"&&typeof n.then=="function"},join:function(n){return new o(function(t,i,r){var f=Object.keys(n),u=Array.isArray(n)?[]:{},e=Array.isArray(n)?[]:{},h=0,s=f.length,c=function(n){var h,c;--s==0?(h=Object.keys(u).length,h===0?t(e):(c=0,f.forEach(function(n){var t=u[n];t instanceof Error&&t.name===y&&c++}),c===h?t(o.cancel):i(u))):r({Key:n,Done:!0})};if(f.forEach(function(t){var i=n[t];i===undefined?h++:o.then(i,function(n){e[t]=n;c(t)},function(n){u[t]=n;c(t)})}),s-=h,s===0){t(e);return}},function(){Object.keys(n).forEach(function(t){var i=o.as(n[t]);typeof i.cancel=="function"&&i.cancel()})})},removeEventListener:function(n,t,i){v.removeEventListener(n,t,i)},supportedForProcessing:!1,then:function(n,t,i,r){return o.as(n).then(t,i,r)},thenEach:function(n,t,i,r){var u=Array.isArray(n)?[]:{};return Object.keys(n).forEach(function(f){u[f]=o.as(n[f]).then(t,i,r)}),o.join(u)},timeout:function(n,t){var i=ei(n);return t?oi(i,t):i},wrap:function(n){return new c(n)},wrapError:function(n){return new a(n)},_veryExpensiveTagWithStack:{get:function(){return s},set:function(n){s=n}},_veryExpensiveTagWithStack_tag:h,_getStack:function(){if(n.Debug&&n.Debug.debuggerEnabled)try{throw new Error;}catch(t){return t.stack}},_cancelBlocker:function(n,t){if(!o.is(n))return o.wrap(n);var i,r,u=new o(function(n,t){i=n;r=t},function(){i=null;r=null;t&&t()});return n.then(function(n){i&&i(n)},function(n){r&&r(n)}),u}}),Object.defineProperties(o,u.createEventProperties(st)),o._doneHandler=function(n){t._setImmediate(function(){throw n;})},{PromiseStateMachine:d,Promise:o,state_created:w}}),t("WinJS/Promise",["./Core/_Base","./Promise/_StateMachine"],function(n,t){"use strict";return n.Namespace.define("WinJS",{Promise:t.Promise}),t.Promise}),t("WinJS/Core/_Log",["exports","./_Global","./_Base",],function(n,t,i){"use strict";function o(n,t,i){var u=n;return typeof u=="function"&&(u=u()),(i&&f.test(i)?"":i?i+": ":"")+(t?t.replace(r,":")+": ":"")+u}function s(i,r,u){var e=n.formatLog(i,r,u);t.console&&t.console[u&&f.test(u)?u:"log"](e)}function u(n){return n.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")}var r=/\s+/g,f=/^(error|warn|info|log)$/,e=null;i.Namespace._moduleDefine(n,"WinJS.Utilities",{startLog:function(t){var i;t=t||{};typeof t=="string"&&(t={tags:t});var f=t.type&&new RegExp("^("+u(t.type).replace(r," ").split(" ").join("|")+")$"),e=t.excludeTags&&new RegExp("(^|\\s)("+u(t.excludeTags).replace(r," ").split(" ").join("|")+")(\\s|$)","i"),o=t.tags&&new RegExp("(^|\\s)("+u(t.tags).replace(r," ").split(" ").join("|")+")(\\s|$)","i"),h=t.action||s;if(!f&&!e&&!o&&!n.log){n.log=h;return}i=function(n,t,r){f&&!f.test(r)||e&&e.test(t)||o&&!o.test(t)||h(n,t,r);i.next&&i.next(n,t,r)};i.next=n.log;n.log=i},stopLog:function(){n.log=null},formatLog:o});i.Namespace._moduleDefine(n,"WinJS",{log:{get:function(){return e},set:function(n){e=n}}})}),t("WinJS/Scheduler",["exports","./Core/_Global","./Core/_Base","./Core/_ErrorFromName","./Core/_Log","./Core/_Resources","./Core/_Trace","./Core/_WriteProfilerMark","./Promise"],function(n,t,i,r,u,f,e,o,s){"use strict";function ii(n){var r={},t="_prev"+n,i="_next"+n;return r["_remove"+n]=function(){var n=this[t],r=this[i];r&&(r[t]=n);n&&(n[i]=r);this[t]=null;this[i]=null},r["_insert"+n+"Before"]=function(n){var r=this[t];return r&&(r[i]=n),n[i]=this,n[t]=r,this[t]=n,n},r["_insert"+n+"After"]=function(n){var r=this[i];return this[i]=n,n[i]=r,n[t]=this,r&&(r[t]=n),n},r}function fi(n,t,i){return i!==undefined?"("+n+";"+t+";"+i+")":t!==undefined?"("+n+";"+t+")":n!==undefined?"("+n+")":""}function tt(n,t,i,r){o("WinJS.Scheduler:"+n+fi(i,r)+","+t)}function v(n,t,i,r,u){var f=n.name||r!==undefined||u!==undefined;o("WinJS.Scheduler:"+t+":"+n.id+(f?fi(n.name,r,u):"")+","+i)}function c(){return!1}function ft(n){throw"Illegal call by job("+n.id+") in state: "+this.name;}function g(n){return function(t,i,r){t._setState(n,i,r)}}function wt(n,t){n._setPriority(t)}function lr(n,t){function f(n,t){u.log&&u.log(t+": MARKER: "+n.name,"winjs scheduler","log")}function e(n,t){u.log&&u.log(t+": JOB("+n.id+"): state: "+(n._state?n._state.name:"")+(n.name?", name: "+n.name:""),"winjs scheduler","log")}u.log&&u.log("highWaterMark: "+a,"winjs scheduler","log");var r=0,o=t?bt[bt.length-1]:bt[0],i=o;do i instanceof h&&f(i,r),i instanceof it&&e(i,r),r++,i=t?i["_prev"+n]:i["_next"+n];while(i)}function ar(){function u(t,i){n+="    "+(i?"*":" ")+"id: "+t.id+", priority: "+w(t.priority).name+(t.name?", name: "+t.name:"")+"\n"}var n="",t,r,i,f;for(n+="Jobs:\n",t=w(a),r=0,pt&&(u(pt,!0),r++);t.priority>=p.min;)t instanceof it&&(u(t,!1),r++),t=t._nextJob;for(r===0&&(n+="     None\n"),n+="Drain requests:\n",i=0,f=y.length;i<f;i++)n+="    "+(i===0?"*":" ")+"priority: "+w(y[i].priority).name+", name: "+y[i].name+"\n";return y.length===0&&(n+="     None\n"),n}function vr(){var n=bt[0];do{if(n instanceof it)return!1;n=n._nextJob}while(n);return!0}function rr(){return y.length===0?null:y[0].priority}function si(n){tt("drain","StartTM",n.name,w(n.priority).name)}function ur(n,t){t&&tt("drain-canceled","info",n.name,w(n.priority).name);tt("drain","StopTM",n.name,w(n.priority).name)}function yr(n,t,i){y.push({priority:n,complete:t,name:i});y.length===1&&(si(y[0]),n>a&&(a=n,ct=!0))}function pr(n,t){for(var r=y.length,i=0;i<r;i++)if(y[i].complete===n){i===0&&(ur(y[0],t),y[1]&&si(y[1]));y.splice(i,1);break}}function wr(){var n=y.shift();n&&(ur(n),y[0]&&si(y[0]),n.complete())}function fr(){var t=!1,n;if(!!y.length)for(n=rr();+n===n&&n>a;)kt=n,wr(),t=!0,n=rr();return t}function gt(n){return n>=p.aboveNormal+1?l.HIGH:n>=p.belowNormal?l.NORMAL:l.IDLE}function kr(n,t){return lt[n]>=lt[t]}function dr(n,t){return lt[n]>lt[t]}function er(n){switch(n){case l.HIGH:return!1;case l.NORMAL:return l.isTaskScheduledAtPriorityOrHigher(l.HIGH);case l.IDLE:return l.isTaskScheduledAtPriorityOrHigher(l.NORMAL)}}function gr(n,t){var i=w(t);i.priority>a&&(a=i.priority,ct=!0);i._insertJobAfter(n)}function ci(n,t){var i=w(t);i.priority>a&&(a=i.priority,ct=!0);i._nextMarker._insertJobBefore(n)}function li(n){return n=n|0,n=Math.max(n,cr),Math.min(n,tr)}function w(n){return n=li(n),bt[-1*(n-tr)]}function nu(n){var c,s,e,b;ni=!0;tt("timeslice","StartTM");var r,u=!0,t,i,o=!1,f=!1;ct=!1;try{for(var k=ai(),d=k+ir,h=function(){return(o=!1,ct)?!0:er(gt(a))?!0:!y.length?ai()>d?(o=!0,!0):!1:!1};a>=p.min&&!h()&&!f;){r=!1;t=w(a)._nextJob;do kt=t.priority,t instanceof it?(i!==t.priority&&(+i===i&&tt("priority","StopTM",w(i).name),tt("priority","StartTM",w(t.priority).name),i=t.priority),r=!0,u=!1,pt=t,v(pt,"job-running","StartTM",w(kt).name),t._execute(h),v(pt,"job-running","StopTM",w(kt).name),pt=null,u=!0):(c=gt(a),a=t.priority,r=fr(),s=gt(a),dr(c,s)&&(!dt||l.isTaskScheduledAtPriorityOrHigher(s))&&(f=!0)),t=t._nextJob;while(t&&!r&&!f&&!er(gt(a)));ct=!1}}finally{for(pt=null,u||(v(t,"job-error","info"),v(t,"job-running","StopTM",w(kt).name),t.cancel()),+i===i&&tt("priority","StopTM",w(i).name),e=!1;a>=p.min&&!e;){r=!1;t=w(a)._nextJob;do t instanceof it?e=!0:(a=t.priority,r=fr()),t=t._nextJob;while(t&&!r&&!e)}b=u?o?"timeslice exhausted":a<p.min?"jobs exhausted":f?"reached WWA priority boundary":"WWA host work":"job error";n&&(ui=null);ni=!1;a>=p.min&&pi();tt("yielding","info",b);tt("timeslice","StopTM")}}function pi(n){var t,i,r;(+n!==n&&(n=a),t=gt(n),ni)||ui&&(!dt||kr(ui,t))||(i=++vi,r=function(){yi<i&&(yi=vi,nu(!0))},l.execAsyncAtPriority(r,t),ui=t)}function tu(n,t){var u=hr++,i,r;return t===undefined&&(t="Drain Request "+u),n=+n===n?n:p.min,n=li(n),r=new s(function(r){i=r;yr(n,i,t)},function(){pr(i,!0)}),ni||pi(),r}function iu(n){return l.execAtPriority(n,l.HIGH)}function ru(){return new ki}function or(n,t,i,r){t=t||p.normal;i=i||null;var u=++sr,f=e._traceAsyncOperationStarting("WinJS.Utilities.Scheduler.schedule: "+u+fi(r));return r=r||"",new it(u,n,t,i,r,f)}function uu(){if(ni)return kt;switch(l.getCurrentPriority()){case l.HIGH:return p.high;case l.NORMAL:return p.normal;case l.IDLE:return p.idle}}function ti(n){return function(t,i){var r;return new s(function(u){r=or(function(){u(t)},n,null,i)},function(){r.cancel()})}}var wi,it,h,lt,ai,vi,yi;i.Namespace.define("WinJS.Utilities",{_linkedListMixin:ii});wi={get jobInfoIsNoLongerValid(){return"The job info object can only be used while the job is running"}};it=i.Class.define(function(n,t,i,r,u,f){this._id=n;this._work=t;this._context=r;this._name=u;this._asyncOpID=f;this._setPriority(i);this._setState(di);v(this,"job-scheduled","info")},{completed:{get:function(){return!!this._state.completed}},id:{get:function(){return this._id}},name:{get:function(){return this._name},set:function(n){this._name=n}},owner:{get:function(){return this._owner},set:function(n){this._owner&&this._owner._remove(this);this._owner=n;this._owner&&this._owner._add(this)}},priority:{get:function(){return this._priority},set:function(n){n=li(n);this._state.setPriority(this,n)}},cancel:function(){this._state.cancel(this)},pause:function(){this._state.pause(this)},resume:function(){this._state.resume(this)},_execute:function(n){this._state.execute(this,n)},_executeDone:function(n){return this._state.executeDone(this,n)},_blockedDone:function(n){return this._state.blockedDone(this,n)},_setPriority:function(n){+this._priority===this._priority&&this._priority!==n&&v(this,"job-priority-changed","info",w(this._priority).name,w(n).name);this._priority=n},_setState:function(n,t,i){this._state&&u.log&&u.log("Transitioning job ("+this.id+") from: "+this._state.name+" to: "+n.name,"winjs scheduler","log");this._state=n;this._state.enter(this,t,i)}});i.Class.mix(it,ii("Job"));var k={complete:1,"continue":2,block:3},bi=i.Class.define(function(n,t){this._job=t;this._result=null;this._yieldPolicy=k.complete;this._shouldYield=n},{job:{get:function(){return this._throwIfDisabled(),this._job}},shouldYield:{get:function(){return this._throwIfDisabled(),this._shouldYield()}},setPromise:function(n){this._throwIfDisabled();this._result=n;this._yieldPolicy=k.block},setWork:function(n){this._throwIfDisabled();this._result=n;this._yieldPolicy=k.continue},_disablePublicApi:function(){this._publicApiDisabled=!0},_throwIfDisabled:function(){if(this._publicApiDisabled)throw new r("WinJS.Utilities.Scheduler.JobInfoIsNoLongerValid",wi.jobInfoIsNoLongerValid);}}),ki=i.Class.define(function(){this._jobs={}},{cancelAll:function(){var t=this._jobs,i=Object.keys(t),n,r;for(this._jobs={},n=0,r=i.length;n<r;n++)t[i[n]].cancel()},_add:function(n){this._jobs[n.id]=n},_remove:function(n){delete this._jobs[n.id]}});var b=i.Class.define(function(n){this.name=n;this.enter=ft;this.execute=ft;this.executeDone=ft;this.blockedDone=ft;this.cancel=ft;this.pause=ft;this.resume=ft;this.setPriority=ft}),di=new b("created"),rt=new b("scheduled"),at=new b("paused"),d=new b("canceled"),vt=new b("running"),et=new b("running_paused"),yt=new b("running_resumed"),ut=new b("running_canceled"),gi=new b("running_canceled_blocked"),ri=new b("cooperative_yield"),ei=new b("cooperative_yield_paused"),oi=new b("blocked"),ot=new b("blocked_waiting"),nr=new b("blocked_paused"),st=new b("blocked_paused_waiting"),ht=new b("blocked_canceled"),nt=new b("complete");di.enter=function(n){ci(n,n.priority);n._setState(rt)};rt.enter=function(){pi()};rt.execute=g(vt);rt.cancel=g(d);rt.pause=g(at);rt.resume=c;rt.setPriority=function(n,t){n.priority!==t&&(n._setPriority(t),n.pause(),n.resume())};at.enter=function(n){v(n,"job-paused","info");n._removeJob()};at.cancel=g(d);at.pause=c;at.resume=function(n){v(n,"job-resumed","info");ci(n,n.priority);n._setState(rt)};at.setPriority=wt;d.enter=function(n){v(n,"job-canceled","info");e._traceAsyncOperationCompleted(n._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_CANCELED);n._removeJob();n._work=null;n._context=null;n.owner=null};d.cancel=c;d.pause=c;d.resume=c;d.setPriority=c;vt.enter=function(n,t){var i,f;n._removeJob();var r=n.priority,o=n._work,u=n._context;n._work=null;n._context=null;i=new bi(t,n);e._traceAsyncCallbackStarting(n._asyncOpID);try{l.execAtPriority(function(){o.call(u,i)},gt(r))}finally{e._traceAsyncCallbackCompleted();i._disablePublicApi()}n._context=u;f=n._executeDone(i._yieldPolicy);n._setState(f,i._result,r)};vt.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ri;case k.block:return oi}};vt.cancel=function(n){ct=!0;n._setState(ut)};vt.pause=function(n){ct=!0;n._setState(et)};vt.resume=c;vt.setPriority=wt;et.enter=c;et.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ei;case k.block:return nr}};et.cancel=g(ut);et.pause=c;et.resume=g(yt);et.setPriority=wt;yt.enter=c;yt.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ri;case k.block:return oi}};yt.cancel=g(ut);yt.pause=g(et);yt.resume=c;yt.setPriority=wt;ut.enter=c;ut.executeDone=function(n,t){switch(t){case k.complete:case k.continue:return d;case k.block:return gi}};ut.cancel=c;ut.pause=c;ut.resume=c;ut.setPriority=c;gi.enter=function(n,t){t.cancel();n._setState(d)};ri.enter=function(n,t,i){v(n,"job-yielded","info");i===n.priority?gr(n,n.priority):ci(n,n.priority);n._work=t;n._setState(rt)};ei.enter=function(n,t){v(n,"job-yielded","info");n._work=t;n._setState(at)};oi.enter=function(n,t,i){v(n,"job-blocked","StartTM");n._work=t;n._setState(ot);t.done(function(t){v(n,"job-blocked","StopTM");var r=n._blockedDone(t);n._setState(r,t,i)},function(t){return t&&t.name==="Canceled"||v(n,"job-error","info"),v(n,"job-blocked","StopTM"),n._setState(d),s.wrapError(t)})};ot.enter=c;ot.blockedDone=function(n,t){return typeof t=="function"?ri:nt};ot.cancel=g(ht);ot.pause=g(st);ot.resume=c;ot.setPriority=wt;nr.enter=function(n,t,i){v(n,"job-blocked","StartTM");n._work=t;n._setState(st);t.done(function(t){v(n,"job-blocked","StopTM");var r=n._blockedDone(t);n._setState(r,t,i)},function(t){return t&&t.name==="Canceled"||v(n,"job-error","info"),v(n,"job-blocked","StopTM"),n._setState(d),s.wrapError(t)})};st.enter=c;st.blockedDone=function(n,t){return typeof t=="function"?ei:nt};st.cancel=g(ht);st.pause=c;st.resume=g(ot);st.setPriority=wt;ht.enter=function(n){n._work.cancel();n._work=null};ht.blockedDone=function(){return d};ht.cancel=c;ht.pause=c;ht.resume=c;ht.setPriority=c;nt.completed=!0;nt.enter=function(n){e._traceAsyncOperationCompleted(n._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_SUCCESS);n._work=null;n._context=null;n.owner=null;v(n,"job-completed","info")};nt.cancel=c;nt.pause=c;nt.resume=c;nt.setPriority=c;h=i.Class.define(function(n,t){this.priority=n;this.name=t},{});i.Class.mix(h,ii("Job"),ii("Marker"));var sr=0,hr=0,cr=-15,tr=15,p={max:15,high:13,aboveNormal:9,normal:0,belowNormal:-9,idle:-13,min:-15},bt=[new h(15,"max"),new h(14,"14"),new h(13,"high"),new h(12,"12"),new h(11,"11"),new h(10,"10"),new h(9,"aboveNormal"),new h(8,"8"),new h(7,"7"),new h(6,"6"),new h(5,"5"),new h(4,"4"),new h(3,"3"),new h(2,"2"),new h(1,"1"),new h(0,"normal"),new h(-1,"-1"),new h(-2,"-2"),new h(-3,"-3"),new h(-4,"-4"),new h(-5,"-5"),new h(-6,"-6"),new h(-7,"-7"),new h(-8,"-8"),new h(-9,"belowNormal"),new h(-10,"-10"),new h(-11,"-11"),new h(-12,"-12"),new h(-13,"idle"),new h(-14,"-14"),new h(-15,"min"),new h(-16,"<TAIL>")];var ui=null,ni,kt,pt=null,dt=!!(t.MSApp&&t.MSApp.execAtPriority),y=[],ct,ir=30,a=p.min;bt.reduce(function(n,t){return n&&(n._insertJobAfter(t),n._insertMarkerAfter(t)),t});var br=t.setImmediate?t.setImmediate.bind(t):function(n){t.setTimeout(n,16)},hi={execAsyncAtPriority:function(n,i){i===l.HIGH&&t.setTimeout(n,0);br(n)},execAtPriority:function(n){return n()},getCurrentPriority:function(){return hi.NORMAL},isTaskScheduledAtPriorityOrHigher:function(){return!1},HIGH:"high",NORMAL:"normal",IDLE:"idle"},l=dt?t.MSApp:hi;lt={};lt[l.IDLE]=1;lt[l.NORMAL]=2;lt[l.HIGH]=3;ai=t.performance&&t.performance.now&&t.performance.now.bind(t.performance)||Date.now.bind(Date);vi=0;yi=0;i.Namespace._moduleDefine(n,"WinJS.Utilities.Scheduler",{Priority:p,schedule:or,createOwnerToken:ru,execHigh:iu,requestDrain:tu,currentPriority:{get:uu},schedulePromiseHigh:ti(p.high),schedulePromiseAboveNormal:ti(p.aboveNormal),schedulePromiseNormal:ti(p.normal),schedulePromiseBelowNormal:ti(p.belowNormal),schedulePromiseIdle:ti(p.idle),retrieveState:ar,_JobNode:it,_JobInfo:bi,_OwnerToken:ki,_dumpList:lr,_isEmpty:{get:vr},_usingWwaScheduler:{get:function(){return dt},set:function(n){dt=n;l=dt?t.MSApp:hi}},_MSApp:{get:function(){return l},set:function(n){l=n}},_TIME_SLICE:ir})}),t("WinJS/Core/_BaseUtils",["exports","./_Global","./_Base","./_BaseCoreUtils","./_ErrorFromName","./_Resources","./_Trace","../Promise","../Scheduler"],function(n,t,i,r,u,f,e,o,s){"use strict";function g(n){return n}function p(n,t,i){return n.split(".").reduce(function(n,t){return n?i(n[t]):null},t)}function nt(n,i){return n?p(n,i||t,g):null}function w(n){return n.length>0&&n.indexOf("-moz")!==0&&n.charAt(0)==="-"&&(n=n.slice(1)),n.replace(/\-[a-z]/g,function(n){return n[1].toUpperCase()})}function b(n,t){return n===""?t:n+t.charAt(0).toUpperCase()+t.slice(1)}function a(n,t){return(n!==""?"-"+n.toLowerCase()+"-":"")+t}function tt(){var r,c,n,l,u,v,f,o,y;if(!t.document)return{};var i={},p=t.document.documentElement.style,s=["","webkit","ms","Moz"],h=["animation","transition","transform","animation-name","animation-duration","animation-delay","animation-timing-function","animation-iteration-count","animation-direction","animation-fill-mode","grid-column","grid-columns","grid-column-span","grid-row","grid-rows","grid-row-span","transform-origin","transition-property","transition-duration","transition-delay","transition-timing-function","scroll-snap-points-x","scroll-snap-points-y","scroll-chaining","scroll-limit","scroll-limit-x-max","scroll-limit-x-min","scroll-limit-y-max","scroll-limit-y-min","scroll-snap-type","scroll-snap-x","scroll-snap-y","touch-action","overflow-style","user-select"],e={};for(r=0,c=h.length;r<c;r++)for(n=h[r],l=w(n),u=0,v=s.length;u<v;u++)if(f=s[u],o=b(f,l),o in p){y=a(f,n);i[n]={cssName:y,scriptName:o};e[n]=f;break}return i.animationPrefix=a(e.animation,""),i.keyframes=a(e.animation,"keyframes"),i}function it(){for(var u,f,c,o,n,l,r,i={},s=["","WebKit"],h=[{eventObject:"TransitionEvent",events:["transitionStart","transitionEnd"]},{eventObject:"AnimationEvent",events:["animationStart","animationEnd"]}],e=0,a=h.length;e<a;e++){for(u=h[e],f="",n=0,c=s.length;n<c;n++)if(o=s[n],o+u.eventObject in t){f=o.toLowerCase();break}for(n=0,l=u.events.length;n<l;n++)r=u.events[n],i[r]=b(f,r),f===""&&(i[r]=i[r].toLowerCase())}return i.manipulationStateChanged="MSManipulationEvent"in t?"ManipulationEvent":null,i}function rt(n,t){function e(){return o.timeout(n).then(function(){i=null})}var i=null,f=null,r=null,u=null;return function(){f?(r=this,u=[].slice.call(arguments,0)):i?(r=this,u=[].slice.call(arguments,0),f=i.then(function(){var o=r,n;r=null;n=u;u=null;i=e();f=null;t.apply(o,n)})):(i=e(),t.apply(this,arguments))}}var k={get notSupportedForProcessing(){return"Value is not supported within a declarative processing context, if you want it to be supported mark it using WinJS.Utilities.markSupportedForProcessing. The value was: '{0}'"}},c,d=0,h={},v=!1,l=t.navigator.platform,y=l==="iPhone"||l==="iPad"||l==="iPod";i.Namespace._moduleDefine(n,"WinJS.Utilities",{_setHasWinRT:{value:function(n){r.hasWinRT=n},configurable:!1,writable:!1,enumerable:!1},hasWinRT:{get:function(){return r.hasWinRT},configurable:!1,enumerable:!0},_setIsiOS:{value:function(n){y=n},configurable:!1,writable:!1,enumerable:!1},_isiOS:{get:function(){return y},configurable:!1,enumerable:!0},_getMemberFiltered:p,getMember:nt,_browserStyleEquivalents:tt(),_browserEventEquivalents:it(),_getCamelCasedName:w,ready:function ut(n,i){return new o(function(r,u){function f(){if(n)try{n();r()}catch(t){u(t)}else r()}var e=ut._testReadyState;e||(e=t.document?t.document.readyState:"complete");e==="complete"||t.document&&t.document.body!==null?i?s.schedule(function(){f()},s.Priority.normal,null,"WinJS.Utilities.ready"):f():t.addEventListener("DOMContentLoaded",f,!1)})},strictProcessing:{get:function(){return!0},configurable:!1,enumerable:!0},markSupportedForProcessing:{value:r.markSupportedForProcessing,configurable:!1,writable:!1,enumerable:!0},requireSupportedForProcessing:{value:function(n){var i=!0,r,e;i=i&&n!==t;i=i&&n!==t.location;i=i&&!(n instanceof t.HTMLIFrameElement);i=i&&!(typeof n=="function"&&!n.supportedForProcessing);switch(t.frames.length){case 0:break;case 1:i=i&&n!==t.frames[0];break;default:for(r=0,e=t.frames.length;i&&r<e;r++)i=i&&n!==t.frames[r]}if(i)return n;throw new u("WinJS.Utilities.requireSupportedForProcessing",f._formatString(k.notSupportedForProcessing,n));},configurable:!1,writable:!1,enumerable:!0},_setImmediate:r._setImmediate,_requestAnimationFrame:t.requestAnimationFrame?t.requestAnimationFrame.bind(t):function(n){var i=++d;return h[i]=n,c=c||t.setTimeout(function(){var n=h,t=Date.now();h={};c=null;Object.keys(n).forEach(function(i){n[i](t)})},16),i},_cancelAnimationFrame:t.cancelAnimationFrame?t.cancelAnimationFrame.bind(t):function(n){delete h[n]},_yieldForEvents:t.setImmediate?t.setImmediate.bind(t):function(n){t.setTimeout(n,0)},_yieldForDomModification:t.setImmediate?t.setImmediate.bind(t):function(n){t.setTimeout(n,0)},_throttledFunction:rt,_shallowCopy:function(n){return this._mergeAll([n])},_merge:function(n,t){return this._mergeAll([n,t])},_mergeAll:function(n){var t={};return n.forEach(function(n){Object.keys(n).forEach(function(i){t[i]=n[i]})}),t},_getProfilerMarkIdentifier:function(n){var t="";return n.id&&(t+=" id='"+n.id+"'"),n.className&&(t+=" class='"+n.className+"'"),t},_now:function(){return t.performance&&t.performance.now&&t.performance.now()||Date.now()},_traceAsyncOperationStarting:e._traceAsyncOperationStarting,_traceAsyncOperationCompleted:e._traceAsyncOperationCompleted,_traceAsyncCallbackStarting:e._traceAsyncCallbackStarting,_traceAsyncCallbackCompleted:e._traceAsyncCallbackCompleted,_version:"4.0.0"});i.Namespace._moduleDefine(n,"WinJS",{validation:{get:function(){return v},set:function(n){v=n}}});i.Namespace.define("WinJS",{strictProcessing:{value:function(){},configurable:!1,writable:!1,enumerable:!1}})}),t("WinJS/Core",["./Core/_Base","./Core/_BaseCoreUtils","./Core/_BaseUtils","./Core/_ErrorFromName","./Core/_Events","./Core/_Global","./Core/_Log","./Core/_Resources","./Core/_Trace","./Core/_WinRT","./Core/_WriteProfilerMark"],function(){}),t("WinJS/_Signal",["./Core/_Base","./Promise/_StateMachine"],function(n,t){"use strict";var r=n.Class.derive(t.PromiseStateMachine,function(n){this._oncancel=n;this._setState(t.state_created);this._run()},{_cancelAction:function(){this._oncancel&&this._oncancel()},_cleanupAction:function(){this._oncancel=null}},{supportedForProcessing:!1}),i=n.Class.define(function(n){this._promise=new r(n)},{promise:{get:function(){return this._promise}},cancel:function(){this._promise.cancel()},complete:function(n){this._promise._completed(n)},error:function(n){this._promise._error(n)},progress:function(n){this._promise._progress(n)}},{supportedForProcessing:!1});return n.Namespace.define("WinJS",{_Signal:i}),i}),t("WinJS/Utilities/_Control",["exports","../Core/_Global","../Core/_Base"],function(n,t,i){"use strict";function u(n,t){r(n,t)}function r(n,t,i){var e,u,h,r,f,o,s;if(typeof t=="object")for(e=Object.keys(t),u=0,h=e.length;u<h;u++){if(r=e[u],f=t[r],r.length>2&&(o=r[0],s=r[1],(o==="o"||o==="O")&&(s==="n"||s==="N")&&typeof f=="function"&&n.addEventListener)){n.addEventListener(r.substr(2),f);continue}i||(n[r]=f)}}t.document&&i.Namespace._moduleDefine(n,"WinJS.UI",{DOMEventMixin:i.Namespace._lazy(function(){return{_domElement:null,addEventListener:function(n,t,i){(this.element||this._domElement).addEventListener(n,t,i||!1)},dispatchEvent:function(n,i){var r=t.document.createEvent("Event");return r.initEvent(n,!1,!1),r.detail=i,typeof i=="object"&&Object.keys(i).forEach(function(n){r[n]=i[n]}),(this.element||this._domElement).dispatchEvent(r)},removeEventListener:function(n,t,i){(this.element||this._domElement).removeEventListener(n,t,i||!1)}}}),setOptions:u,_setOptions:r})}),t("WinJS/Utilities/_ElementUtilities",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_WinRT","../Promise","../Scheduler"],function(n,t,i,r,u,f,e){"use strict";function a(n){for(var i=n.length,t=i-1;t>=0;t--)n[t]||(n.splice(t,1),i--);return i}function b(n){var t=n.className||"";return typeof t=="string"?t:t.baseVal||""}function v(n,t){var i=n.className||"";return typeof i=="string"?n.className=t:n.className.baseVal=t,n}function tt(n,t){var h,r,o,s,i;if(n.classList){if(t.indexOf(" ")<0)n.classList.add(t);else for(r=t.split(" "),a(r),i=0,h=r.length;i<h;i++)n.classList.add(r[i]);return n}var c=b(n),f=c.split(" "),e=a(f),u;if(t.indexOf(" ")>=0){for(r=t.split(" "),a(r),i=0;i<e;i++)o=r.indexOf(f[i]),o>=0&&r.splice(o,1);r.length>0&&(u=r.join(" "))}else{for(s=!1,i=0;i<e;i++)if(f[i]===t){s=!0;break}s||(u=t)}return u&&(e>0&&f[0].length>0?v(n,c+" "+u):v(n,u)),n}function it(n,t){var e,f,r,o,s,u,h,i;if(n.classList){if(n.classList.length===0)return n;for(r=t.split(" "),a(r),i=0,e=r.length;i<e;i++)n.classList.remove(r[i]);return n}if(f=b(n),t.indexOf(" ")>=0)r=t.split(" "),o=a(r);else{if(f.indexOf(t)<0)return n;r=[t];o=1}for(u=f.split(" "),h=a(u),i=h-1;i>=0;i--)r.indexOf(u[i])>=0&&(u.splice(i,1),s=!0);return s&&v(n,u.join(" ")),n}function ii(n,t){var r;if(n.classList)return n.classList.toggle(t),n;var u=b(n),i=u.trim().split(" "),f=i.length,e=!1;for(r=0;r<f;r++)i[r]===t&&(e=!0);return e?v(n,i.reduce(function(n,i){return i===t?n:n&&n.length>0?n+" "+i:i},"")):f>0&&i[0].length>0?v(n,u+" "+t):v(n,u+t),n}function ri(n,t,i){n.getAttribute(t)!==""+i&&n.setAttribute(t,i)}function rt(n,t,i,r){var u=Math.max(t,Math.min(i,+n));return u===0?0:u||Math.max(t,Math.min(i,r))}function wt(n,t){if(!yt.test(t)&&pt.test(t)){var i=n.style.left;return n.style.left=t,t=n.style.pixelLeft,n.style.left=i,t}return Math.round(parseFloat(t))||0}function o(n,i){return wt(n,t.getComputedStyle(n,null)[i])}function y(n){return parseFloat(n)||0}function s(n,i){return y(t.getComputedStyle(n,null)[i])}function ui(n){var i=t.getComputedStyle(n);return{top:y(i.marginTop),right:y(i.marginRight),bottom:y(i.marginBottom),left:y(i.marginLeft)}}function bt(n,t,i,r,u){var f=t.toLowerCase();n._eventsMap||(n._eventsMap={});n._eventsMap[f]||(n._eventsMap[f]=[]);n._eventsMap[f].push({listener:i,useCapture:r,data:u})}function ft(n,t,i,r){var o=t.toLowerCase(),f=n._eventsMap&&n._eventsMap[o],u,e;if(f)for(u=f.length-1;u>=0;u--)if(e=f[u],e.listener===i&&!!r==!!e.useCapture)return f.splice(u,1),e;return null}function oi(n,t){var i=t.toLowerCase();return n._eventsMap&&n._eventsMap[i]&&n._eventsMap[i].slice(0)||[]}function k(n,t,i){for(var u,r,f;n;){for(u=oi(n,t),r=0,f=u.length;r<f;r++)u[r].listener.call(n,i);n=n.parentNode}}function et(n){return(n.relatedTarget&&n.relatedTarget.tagName==="IFRAME"||n.target&&n.target.tagName==="IFRAME")&&(n.relatedTarget=null),n}function kt(n,t,i,r){if(r)throw"This custom WinJS event only supports bubbling";bt(n,t,i,r)}function si(n,t){var f=t.changedTouches,u=null,r,e;if(!f)return u;for(r=0,e=f.length;r<e;r++){var i=f[r],o=new d(t,{pointerType:ut.MSPOINTER_TYPE_TOUCH,pointerId:i.identifier,isPrimary:r===0,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,radiusX:i.radiusX,radiusY:i.radiusY,rotationAngle:i.rotationAngle,force:i.force,_currentTouch:i}),s=n(o);u=u||s}return u}function hi(n,t){return t.pointerType=ut.MSPOINTER_TYPE_MOUSE,t.pointerId=-1,t.isPrimary=!0,n(t)}function ci(n,t){return n(t)}function li(n,i,r,u){var e=i.toLowerCase(),s,h,c,f=g[e],o;t.MSPointerEvent?(c=function(n){return n._normalizedType=e,o=!0,ci(r,n)},n.addEventListener(f.mspointer,c,u)):(f.mouse&&(s=function(n){if(n._normalizedType=e,!o)return hi(r,n);o=!1},n.addEventListener(f.mouse,s,u)),f.touch&&(h=function(n){return n._normalizedType=e,o=!0,si(r,n)},n.addEventListener(f.touch,h,u)));bt(n,i,r,u,{mouseWrapper:s,touchWrapper:h,mspointerWrapper:c})}function ai(n,t,i,r){var e=t.toLowerCase(),u=ft(n,t,i,r),f;u&&(f=g[e],u.data.mouseWrapper&&n.removeEventListener(f.mouse,u.data.mouseWrapper,r),u.data.touchWrapper&&n.removeEventListener(f.touch,u.data.touchWrapper,r),u.data.mspointerWrapper&&n.removeEventListener(f.mspointer,u.data.mspointerWrapper,r))}function gt(){var n=t.document.createElement("div"),i;n.style.direction="rtl";n.innerHTML="<div style='width: 100px; height: 100px; overflow: scroll; visibility:hidden'><div style='width: 10000px; height: 100px;'><\/div><\/div>";t.document.body.appendChild(n);i=n.firstChild;i.scrollLeft>0&&(ct=!0);i.scrollLeft+=100;i.scrollLeft===0&&(dt=!0);t.document.body.removeChild(n);ht=!0}function lt(n){var r=t.getComputedStyle(n),i=n.scrollLeft;return r.direction==="rtl"&&(ht||gt(),ct&&(i=n.scrollWidth-n.clientWidth-i),i=Math.abs(i)),{scrollLeft:i,scrollTop:n.scrollTop}}function at(n,i,r){if(i!==undefined){var u=t.getComputedStyle(n);u.direction==="rtl"&&(ht||gt(),dt?i=-i:ct&&(i=n.scrollWidth-n.clientWidth-i));n.scrollLeft=i}r!==undefined&&(n.scrollTop=r)}function ni(n){return lt(n)}function wi(n,t){t=t||{};at(n,t.scrollLeft,t.scrollTop)}function ti(n){return n.uniqueID||n._uniqueID||(n._uniqueID="element__"+ ++di),n.uniqueID||n._uniqueID}function gi(n){n.id||(n.id=ti(n))}function nr(n){var i=t.document.documentElement,r=ni(i);return{left:n.clientX+(t.document.body.dir==="rtl"?-r.scrollLeft:r.scrollLeft),top:n.clientY+i.scrollTop}}function tr(n,t){for(var r,u=[],i=0,f=t.length;i<f;i++)r=n.querySelector("."+t[i]),r&&u.push(r);return u}var p,yt,pt,ot,c,d,g,h,l,vt,w;if(t.document){p=167;yt=/^-?\d+\.?\d*(px)?$/i;pt=/^-?\d+/i;var fi=t.MSGestureEvent||{MSGESTURE_FLAG_BEGIN:1,MSGESTURE_FLAG_CANCEL:4,MSGESTURE_FLAG_END:2,MSGESTURE_FLAG_INERTIA:8,MSGESTURE_FLAG_NONE:0},ei=t.MSManipulationEvent||{MS_MANIPULATION_STATE_ACTIVE:1,MS_MANIPULATION_STATE_CANCELLED:6,MS_MANIPULATION_STATE_COMMITTED:7,MS_MANIPULATION_STATE_DRAGGING:5,MS_MANIPULATION_STATE_INERTIA:2,MS_MANIPULATION_STATE_PRESELECT:3,MS_MANIPULATION_STATE_SELECTING:4,MS_MANIPULATION_STATE_STOPPED:0},ut=t.MSPointerEvent||{MSPOINTER_TYPE_TOUCH:"touch",MSPOINTER_TYPE_PEN:"pen",MSPOINTER_TYPE_MOUSE:"mouse"};ot="onfocusin"in t.document.documentElement;c=null;t.addEventListener(ot?"focusout":"blur",function(n){if(n.target===t){var i=c;i&&k(i,"focusout",et({type:"focusout",target:i,relatedTarget:null}));c=null}});t.document.documentElement.addEventListener(ot?"focusin":"focus",function(n){var t=c;c=n.target;t&&k(t,"focusout",et({type:"focusout",target:t,relatedTarget:c}));c&&k(c,"focusin",et({type:"focusin",target:c,relatedTarget:t}))},!0);d=function(n,t){t=t||{};this.__eventObject=n;var i=this;Object.keys(t).forEach(function(n){Object.defineProperty(i,n,{value:t[n]})})};["altKey","AT_TARGET","bubbles","BUBBLING_PHASE","button","buttons","cancelable","cancelBubble","CAPTURING_PHASE","clientX","clientY","ctrlKey","currentTarget","defaultPrevented","detail","eventPhase","fromElement","getModifierState","height","hwTimestamp","initEvent","initMouseEvent","initPointerEvent","initUIEvent","isPrimary","isTrusted","layerX","layerY","metaKey","offsetX","offsetY","pageX","pageY","pointerId","pointerType","pressure","preventDefault","relatedTarget","rotation","screenX","screenY","shiftKey","srcElement","stopImmediatePropagation","stopPropagation","target","tiltX","tiltY","timeStamp","toElement","type","view","which","width","x","y","_normalizedType","_fakedBySemanticZoom"].forEach(function(n){Object.defineProperty(d.prototype,n,{get:function(){var t=this.__eventObject[n];return typeof t=="function"?t.bind(this.__eventObject):t},configurable:!0})});g={pointerdown:{touch:"touchstart",mspointer:"MSPointerDown",mouse:"mousedown"},pointerup:{touch:"touchend",mspointer:"MSPointerUp",mouse:"mouseup"},pointermove:{touch:"touchmove",mspointer:"MSPointerMove",mouse:"mousemove"},pointerenter:{touch:"touchenter",mspointer:"MSPointerEnter",mouse:"mouseenter"},pointerover:{touch:null,mspointer:"MSPointerOver",mouse:"mouseover"},pointerout:{touch:"touchleave",mspointer:"MSPointerOut",mouse:"mouseout"},pointercancel:{touch:"touchcancel",mspointer:"MSPointerCancel",mouse:null}};h={focusout:{register:kt,unregister:ft},focusin:{register:kt,unregister:ft}};t.PointerEvent||(l={register:li,unregister:ai},h.pointerdown=l,h.pointerup=l,h.pointermove=l,h.pointerenter=l,h.pointerover=l,h.pointerout=l,h.pointercancel=l);var vi=i.Class.define(function(n){this._callback=n;this._toDispose=[];this._attributeFilter=[];this._scheduled=!1;this._pendingChanges=[];this._observerCount=0;this._handleCallback=this._handleCallback.bind(this);this._targetElements=[]},{observe:function(n,t){this._targetElements.indexOf(n)===-1&&this._targetElements.push(n);this._observerCount++;t.attributes&&this._addRemovableListener(n,"DOMAttrModified",this._handleCallback);t.attributeFilter&&(this._attributeFilter=t.attributeFilter)},disconnect:function(){this._observerCount=0;this._targetElements=[];this._toDispose.forEach(function(n){n()})},_addRemovableListener:function(n,t,i){n.addEventListener(t,i);this._toDispose.push(function(){n.removeEventListener(t,i)})},_handleCallback:function(n){var t,i;(n.stopPropagation(),t=n.attrName,this._attributeFilter.length&&this._attributeFilter.indexOf(t)===-1)||this._targetElements.indexOf(n.target)!==-1&&(i=t.indexOf("aria")>=0,t==="tabindex"&&(t="tabIndex"),this._pendingChanges.push({type:"attributes",target:n.target,attributeName:t}),this._observerCount!==1||i?this._scheduled===!1&&(this._scheduled=!0,r._setImmediate(this._dispatchEvent.bind(this))):this._dispatchEvent())},_dispatchEvent:function(){try{this._callback(this._pendingChanges)}finally{this._pendingChanges=[];this._scheduled=!1}}},{_isShim:!0}),yi=t.MutationObserver||vi,st=null,pi=i.Class.define(function(){t.addEventListener("resize",this._handleResize.bind(this))},{subscribe:function(n,t){n.addEventListener(this._resizeEvent,t);tt(n,this._resizeClass)},unsubscribe:function(n,t){it(n,this._resizeClass);n.removeEventListener(this._resizeEvent,t)},_handleResize:function(){for(var i,r=t.document.querySelectorAll("."+this._resizeClass),u=r.length,n=0;n<u;n++)i=t.document.createEvent("Event"),i.initEvent(this._resizeEvent,!1,!0),r[n].dispatchEvent(i)},_resizeClass:{get:function(){return"win-element-resize"}},_resizeEvent:{get:function(){return"WinJSElementResize"}}}),nt=i.Class.define(function(n,t,i){i=i||{};this.registerThruWinJSCustomEvents=!!i.registerThruWinJSCustomEvents;this.objectName=n;this.object=t;this.capture={};this.bubble={}},{addEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f||(f=this._getListener(i,u),f.refCount=0,e[i]=f,this.registerThruWinJSCustomEvents?n._addEventListener(this.object,i,f,u):this.object.addEventListener(i,f,u));f.refCount++;t.addEventListener(this._getEventName(i,u),r);tt(t,this._getClassName(i,u))},removeEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f&&(f.refCount--,f.refCount===0&&(this.registerThruWinJSCustomEvents?n._removeEventListener(this.object,i,f,u):this.object.removeEventListener(i,f,u),delete e[i]));it(t,this._getClassName(i,u));t.removeEventListener(this._getEventName(i,u),r)},_getHandlers:function(n){return n?this.capture:this.bubble},_getClassName:function(n,t){var i=t?"capture":"bubble";return"win-"+this.objectName.toLowerCase()+"-event-"+n+i},_getEventName:function(n,t){var i=t?"capture":"bubble";return"WinJS"+this.objectName+"Event-"+n+i},_getListener:function(n,i){var r=function(r){for(var u,s,o=t.document.querySelectorAll("."+this._getClassName(n,i)),h=o.length,f=!1,e=0;e<h;e++)u=t.document.createEvent("Event"),u.initEvent(this._getEventName(n,i),!1,!0),u.detail={originalEvent:r},s=o[e].dispatchEvent(u),f=f||!s;return f};return r.bind(this)}}),ht=!1,ct=!1,dt=!1;var bi=t.navigator.msManipulationViewsEnabled||t.navigator.userAgent.indexOf("MSAppHost")>=0,ki=!!(t.MSPointerEvent||t.TouchEvent),di=0;vt=".win-selectionborder, .win-selectionbackground, .win-selectioncheckmark, .win-selectioncheckmarkbackground";w="_msDataKey";i.Namespace._moduleDefine(n,"WinJS.Utilities",{_dataKey:w,_supportsSnapPoints:{get:function(){return bi}},_supportsTouchDetection:{get:function(){return ki}},_uniqueID:ti,_ensureId:gi,_clamp:rt,_getCursorPos:nr,_getElementsByClasses:tr,_createGestureRecognizer:function(){if(t.MSGesture)return new t.MSGesture;var n=function(){};return{addEventListener:n,removeEventListener:n,addPointer:n,stop:n}},_MSGestureEvent:fi,_MSManipulationEvent:ei,_elementsFromPoint:function(n,i){if(t.document.msElementsFromPoint)return t.document.msElementsFromPoint(n,i);var r=t.document.elementFromPoint(n,i);return r?[r]:null},_matchesSelector:function(n,t){var i=n.matches||n.msMatchesSelector||n.mozMatchesSelector||n.webkitMatchesSelector;return i.call(n,t)},_selectionPartsSelector:vt,_isSelectionRendered:function(n){return n.querySelectorAll(vt).length>0},_addEventListener:function(n,t,i,u){var o=t&&t.toLowerCase(),f=h[o],e=r._browserEventEquivalents[t];f?f.register(n,t,i,u):e?n.addEventListener(e,i,u):n.addEventListener(t,i,u)},_removeEventListener:function(n,t,i,u){var o=t&&t.toLowerCase(),f=h[o],e=r._browserEventEquivalents[t];f?f.unregister(n,t,i,u):e?n.removeEventListener(e,i,u):n.removeEventListener(t,i,u)},_initEventImpl:function(n,t,i){i=i.toLowerCase();var r=g[i];if(r)switch(n.toLowerCase()){case"pointer":arguments[2]=r.mspointer;break;default:arguments[2]=r[n.toLowerCase()]}t["init"+n+"Event"].apply(t,Array.prototype.slice.call(arguments,2))},_initMouseEvent:function(n){this._initEventImpl.apply(this,["Mouse",n].concat(Array.prototype.slice.call(arguments,1)))},_initPointerEvent:function(n){this._initEventImpl.apply(this,["Pointer",n].concat(Array.prototype.slice.call(arguments,1)))},_PointerEventProxy:d,_bubbleEvent:k,_setPointerCapture:function(n,t){n.setPointerCapture&&n.setPointerCapture(t)},_releasePointerCapture:function(n,t){n.releasePointerCapture&&n.releasePointerCapture(t)},_MSPointerEvent:ut,_zoomToDuration:p,_zoomTo:function(n,i){this._supportsSnapPoints&&n.msZoomTo?n.msZoomTo(i):e.schedule(function(){var u=lt(n),s=typeof n._zoomToDestX=="number"?n._zoomToDestX:u.scrollLeft,h=typeof n._zoomToDestY=="number"?n._zoomToDestY:u.scrollTop,f=t.getComputedStyle(n),l=n.scrollWidth-parseInt(f.width,10)-parseInt(f.paddingLeft,10)-parseInt(f.paddingRight,10),a=n.scrollHeight-parseInt(f.height,10)-parseInt(f.paddingTop,10)-parseInt(f.paddingBottom,10),e,o;if(typeof i.contentX!="number"&&(i.contentX=s),typeof i.contentY!="number"&&(i.contentY=h),e=rt(i.contentX,0,l),o=rt(i.contentY,0,a),e!==s||o!==h){n._zoomToId=n._zoomToId||0;n._zoomToId++;n._zoomToDestX=e;n._zoomToDestY=o;var v=n._zoomToId,y=r._now(),w=(n._zoomToDestX-u.scrollLeft)/p,b=(n._zoomToDestY-u.scrollTop)/p,c=function(){var t=r._now()-y;n._zoomToId===v&&(t>p?(at(n,n._zoomToDestX,n._zoomToDestY),n._zoomToDestX=null,n._zoomToDestY=null):(at(n,u.scrollLeft+t*w,u.scrollTop+t*b),r._requestAnimationFrame(c)))};r._requestAnimationFrame(c)}},e.Priority.high,null,"WinJS.Utilities._zoomTo")},_setActive:function(n,i){var r=!0,u,f;try{t.HTMLElement&&t.HTMLElement.prototype.setActive?n.setActive():(i&&(u=i.scrollLeft,f=i.scrollTop),n.focus(),i&&(i.scrollLeft=u,i.scrollTop=f))}catch(e){r=!1}return r},_MutationObserver:yi,_resizeNotifier:{get:function(){return st||(st=new pi),st}},_GenericListener:nt,_globalListener:new nt("Global",t,{registerThruWinJSCustomEvents:!0}),_documentElementListener:new nt("DocumentElement",t.document.documentElement,{registerThruWinJSCustomEvents:!0}),_inputPaneListener:u.Windows.UI.ViewManagement.InputPane?new nt("InputPane",u.Windows.UI.ViewManagement.InputPane.getForCurrentView()):{addEventListener:function(){},removeEventListener:function(){}},_addInsertedNotifier:function(i){var u=t.document.createElement("div");return u.style[r._browserStyleEquivalents["animation-name"].scriptName]="WinJS-node-inserted",u.style[r._browserStyleEquivalents["animation-duration"].scriptName]="0.01s",u.style.position="absolute",i.appendChild(u),n._addEventListener(u,"animationStart",function(n){if(n.animationName==="WinJS-node-inserted"){var n=t.document.createEvent("Event");n.initEvent("WinJSNodeInserted",!1,!0);i.dispatchEvent(n)}},!1),u},_inDom:function(i){return new f(function(r){if(t.document.body.contains(i))r();else{var u=function(){i.removeEventListener("WinJSNodeInserted",u,!1);r()};n._addInsertedNotifier(i);i.addEventListener("WinJSNodeInserted",u,!1)}})},_setFlexStyle:function(n,t){var i=n.style;typeof t.grow!="undefined"&&(i.msFlexPositive=t.grow,i.webkitFlexGrow=t.grow,i.flexGrow=t.grow);typeof t.shrink!="undefined"&&(i.msFlexNegative=t.shrink,i.webkitFlexShrink=t.shrink,i.flexShrink=t.shrink);typeof t.basis!="undefined"&&(i.msFlexPreferredSize=t.basis,i.webkitFlexBasis=t.basis,i.flexBasis=t.basis)},Key:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,deleteKey:46,num0:48,num1:49,num2:50,num3:51,num4:52,num5:53,num6:54,num7:55,num8:56,num9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindows:91,rightWindows:92,menu:93,numPad0:96,numPad1:97,numPad2:98,numPad3:99,numPad4:100,numPad5:101,numPad6:102,numPad7:103,numPad8:104,numPad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NavigationView:136,NavigationMenu:137,NavigationUp:138,NavigationDown:139,NavigationLeft:140,NavigationRight:141,NavigationAccept:142,NavigationCancel:143,numLock:144,scrollLock:145,browserBack:166,browserForward:167,semicolon:186,equal:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,GamepadA:195,GamepadB:196,GamepadX:197,GamepadY:198,GamepadRightShoulder:199,GamepadLeftShoulder:200,GamepadLeftTrigger:201,GamepadRightTrigger:202,GamepadDPadUp:203,GamepadDPadDown:204,GamepadDPadLeft:205,GamepadDPadRight:206,GamepadMenu:207,GamepadView:208,GamepadLeftThumbstick:209,GamepadRightThumbstick:210,GamepadLeftThumbstickUp:211,GamepadLeftThumbstickDown:212,GamepadLeftThumbstickRight:213,GamepadLeftThumbstickLeft:214,GamepadRightThumbstickUp:215,GamepadRightThumbstickDown:216,GamepadRightThumbstickRight:217,GamepadRightThumbstickLeft:218,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222,IME:229},data:function(n){return n[w]||(n[w]={}),n[w]},hasClass:function(n,t){var i;if(n.classList)return n.classList.contains(t);var u=b(n),r=u.trim().split(" "),f=r.length;for(i=0;i<f;i++)if(r[i]===t)return!0;return!1},addClass:tt,removeClass:it,toggleClass:ii,_setAttribute:ri,getRelativeLeft:function(n,t){if(!n)return 0;for(var r=n.offsetLeft,i=n.parentNode;i;){if(r-=i.offsetLeft,i===t)break;i=i.parentNode}return r},getRelativeTop:function(n,t){if(!n)return 0;for(var r=n.offsetTop,i=n.parentNode;i;){if(r-=i.offsetTop,i===t)break;i=i.parentNode}return r},getScrollPosition:ni,setScrollPosition:wi,empty:function(n){if(n.childNodes&&n.childNodes.length>0)for(var t=n.childNodes.length-1;t>=0;t--)n.removeChild(n.childNodes.item(t));return n},_isDOMElement:function(n){return n&&typeof n=="object"&&typeof n.tagName=="string"},getContentWidth:function(n){var t=o(n,"borderLeftWidth")+o(n,"borderRightWidth"),i=o(n,"paddingLeft")+o(n,"paddingRight");return n.offsetWidth-t-i},_getPreciseContentWidth:function(n){var t=s(n,"borderLeftWidth")+s(n,"borderRightWidth"),i=s(n,"paddingLeft")+s(n,"paddingRight");return n.offsetWidth-t-i},getTotalWidth:function(n){var t=o(n,"marginLeft")+o(n,"marginRight");return n.offsetWidth+t},_getPreciseTotalWidth:function(n){var t=s(n,"marginLeft")+s(n,"marginRight");return n.offsetWidth+t},getContentHeight:function(n){var t=o(n,"borderTopWidth")+o(n,"borderBottomWidth"),i=o(n,"paddingTop")+o(n,"paddingBottom");return n.offsetHeight-t-i},_getPreciseContentHeight:function(n){var t=s(n,"borderTopWidth")+s(n,"borderBottomWidth"),i=s(n,"paddingTop")+s(n,"paddingBottom");return n.offsetHeight-t-i},getTotalHeight:function(n){var t=o(n,"marginTop")+o(n,"marginBottom");return n.offsetHeight+t},_getPreciseTotalHeight:function(n){var t=s(n,"marginTop")+s(n,"marginBottom");return n.offsetHeight+t},getPosition:function(t){return n._getPositionRelativeTo(t,null)},getTabIndex:function(n){var i,t;return n.disabled?-1:(i=n.getAttribute("tabindex"),i===null||i===undefined)?(t=n.tagName,/BUTTON|COMMAND|MENUITEM|OBJECT|SELECT|TEXTAREA/.test(t)||n.href&&(t==="A"||t==="AREA"||t==="LINK")||t==="INPUT"&&n.type!=="hidden"||t==="TH"&&n.sorted)?0:-1:parseInt(i,10)},convertToPixels:wt,_convertToPrecisePixels:y,_getPreciseMargins:ui,eventWithinElement:function(n,t){var i=t.relatedTarget;return i&&i!==n?n.contains(i):!1},_deprecated:function(n){t.console&&t.console.warn(n)},_syncRenderer:function(n,i){if(i=i||"div",typeof n=="function")return function(t,i){return i?(i.appendChild(n(t)),i):n(t)};var r;return typeof n.render=="function"?r=n:n.winControl&&typeof n.winControl.render=="function"&&(r=n.winControl),function(n,u){var e=u||t.document.createElement(i),f,o;return r.render(n,e),u?u:(f=e.firstElementChild,f&&e.dispose&&(o=f.dispose,f.dispose=function(){f.dispose=o;e.appendChild(f);e.dispose()}),f)}},_getPositionRelativeTo:function(n,i){for(var f=n,e=n.offsetParent,r=n.offsetTop,u=n.offsetLeft,o;(n=n.parentNode)&&n!==i&&n!==t.document.body&&n!==t.document.documentElement;)r-=n.scrollTop,o=t.document.defaultView.getComputedStyle(n,null).direction,u-=o!=="rtl"?n.scrollLeft:-lt(n).scrollLeft,n===e&&(r+=n.offsetTop,u+=n.offsetLeft,e=n.offsetParent);return{left:u,top:r,width:f.offsetWidth,height:f.offsetHeight}},_getHighAndLowTabIndices:function(n){for(var u,t,e=n.getElementsByTagName("*"),i=0,r=0,o=!1,f=0,s=e.length;f<s;f++)u=e[f].getAttribute("tabIndex"),u!==null&&u!==undefined&&(t=parseInt(u,10),t>0&&(t<i||i===0)&&(i=t),o||(t===0?(o=!0,r=0):t>r&&(r=t)));return{highest:r,lowest:i}},_getLowestTabIndexInList:function(n){for(var t=0,i,r=0;r<n.length;r++)i=parseInt(n[r].getAttribute("tabIndex"),10),0<i&&(i<t||!t)&&(t=i);return t},_getHighestTabIndexInList:function(n){for(var i=0,t,r=0;r<n.length;r++){if(t=parseInt(n[r].getAttribute("tabIndex"),10),t===0)return t;i<t&&(i=t)}return i},_hasCursorKeysBehaviors:function(n){return n.tagName==="SELECT"||n.tagName==="TEXTAREA"?!0:n.tagName==="INPUT"?n.type===""||n.type==="date"||n.type==="datetime"||n.type==="datetime-local"||n.type==="email"||n.type==="month"||n.type==="number"||n.type==="password"||n.type==="range"||n.type==="search"||n.type==="tel"||n.type==="text"||n.type==="time"||n.type==="url"||n.type==="week":!1},_reparentChildren:function(n,t){for(var i=n.firstChild,r;i;)r=i.nextSibling,t.appendChild(i),i=r},_maintainFocus:function(i){var r=t.document.activeElement;i();n._trySetActive(r)},_trySetActive:function(n,t){return this._tryFocus(n,!0,t)},_tryFocus:function(i,r,u){var f=t.document.activeElement,e;return i===f?!0:(e=n.getTabIndex(i)>=0,!e)?!1:(r?n._setActive(i,u):i.focus(),f!==t.document.activeElement)?!0:!1},_setActiveFirstFocusableElement:function(n,t){return this._focusFirstFocusableElement(n,!0,t)},_focusFirstFocusableElement:function(n,t,i){for(var u=n.getElementsByTagName("*"),e=this._getLowestTabIndexInList(u),f=0,r;e;){for(r=0;r<u.length;r++)if(u[r].tabIndex===e){if(this._tryFocus(u[r],t,i))return!0}else e<u[r].tabIndex&&(u[r].tabIndex<f||f===0)&&(f=u[r].tabIndex);e=f;f=0}for(r=0;r<u.length;r++)if(this._tryFocus(u[r],t,i))return!0;return!1},_setActiveLastFocusableElement:function(n,t){return this._focusLastFocusableElement(n,!0,t)},_focusLastFocusableElement:function(n,t,i){var u=n.getElementsByTagName("*"),e=this._getHighestTabIndexInList(u),f=0,r;if(e===0){for(r=u.length-1;r>=0;r--)if(u[r].tabIndex===e){if(this._tryFocus(u[r],t,i))return!0}else f<u[r].tabIndex&&(f=u[r].tabIndex);e=f;f=0}while(e){for(r=u.length-1;r>=0;r--)if(u[r].tabIndex===e){if(this._tryFocus(u[r],t,i))return!0}else f<u[r].tabIndex&&u[r].tabIndex<e&&(f=u[r].tabIndex);e=f;f=0}for(r=u.length-2;r>0;r--)if(this._tryFocus(u[r],t,i))return!0;return!1}})}}),t("WinJS/Utilities/_Dispose",["exports","../Core/_Base","../Core/_WriteProfilerMark","./_ElementUtilities"],function(n,t,i,r){"use strict";function f(n,t){var i=!1,f;r.addClass(n,"win-disposable");f=n.winControl||n;f.dispose=function(){i||(i=!0,u(n),t&&t())}}function u(n){var t;if(n){i("WinJS.Utilities.disposeSubTree,StartTM");for(var u=n.querySelectorAll(".win-disposable"),r=0,f=u.length;r<f;)t=u[r],t.winControl&&t.winControl.dispose&&t.winControl.dispose(),t.dispose&&t.dispose(),r+=t.querySelectorAll(".win-disposable").length+1;i("WinJS.Utilities.disposeSubTree,StopTM")}}function e(n){if(n){var t=!1;n.winControl&&n.winControl.dispose&&(n.winControl.dispose(),t=!0);n.dispose&&(n.dispose(),t=!0);t||u(n)}}t.Namespace._moduleDefine(n,"WinJS.Utilities",{markDisposable:f,disposeSubTree:u,_disposeElement:e})}),t("WinJS/ControlProcessor/_OptionsLexer",["exports","../Core/_Base"],function(n,t){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_optionsLexer:t.Namespace._lazy(function(){function t(n){return{type:tokenType.reservedWord,value:n,length:n.length,keyword:!0}}function r(i){switch(i.charCodeAt(0)){case 98:switch(i){case"break":return t(i)}break;case 99:switch(i){case"case":case"catch":case"class":case"const":case"continue":return t(i)}break;case 100:switch(i){case"debugger":case"default":case"delete":case"do":return t(i)}break;case 101:switch(i){case"else":case"enum":case"export":case"extends":return t(i)}break;case 102:switch(i){case"false":return n.falseLiteral;case"finally":case"for":case"function":return t(i)}break;case 105:switch(i){case"if":case"import":case"in":case"instanceof":return t(i)}break;case 110:switch(i){case"null":return n.nullLiteral;case"new":return t(i)}break;case 114:switch(i){case"return":return t(i)}break;case 115:switch(i){case"super":case"switch":return t(i)}break;case 116:switch(i){case"true":return n.trueLiteral;case"this":return n.thisKeyword;case"throw":case"try":case"typeof":return t(i)}break;case 118:switch(i){case"var":case"void":return t(i)}break;case 119:switch(i){case"while":case"with":return t(i)}}return}var tokenType={leftBrace:1,rightBrace:2,leftBracket:3,rightBracket:4,separator:5,colon:6,semicolon:7,comma:8,dot:9,nullLiteral:10,trueLiteral:11,falseLiteral:12,numberLiteral:13,stringLiteral:14,identifier:15,reservedWord:16,thisKeyword:17,leftParentheses:18,rightParentheses:19,eof:20,error:21},n={leftBrace:{type:tokenType.leftBrace,length:1},rightBrace:{type:tokenType.rightBrace,length:1},leftBracket:{type:tokenType.leftBracket,length:1},rightBracket:{type:tokenType.rightBracket,length:1},colon:{type:tokenType.colon,length:1},semicolon:{type:tokenType.semicolon,length:1},comma:{type:tokenType.comma,length:1},dot:{type:tokenType.dot,length:1},nullLiteral:{type:tokenType.nullLiteral,length:4,value:null,keyword:!0},trueLiteral:{type:tokenType.trueLiteral,length:4,value:!0,keyword:!0},falseLiteral:{type:tokenType.falseLiteral,length:5,value:!1,keyword:!0},thisKeyword:{type:tokenType.thisKeyword,length:4,value:"this",keyword:!0},leftParentheses:{type:tokenType.leftParentheses,length:1},rightParentheses:{type:tokenType.rightParentheses,length:1},eof:{type:tokenType.eof,length:0}},i=function(){function o(n,i,r,u){switch(n){case n>=97&&n<=122&&n:case n>=65&&n<=90&&n:case 36:case 95:return!0;case e(n)&&n:case isLineTerminator(n)&&n:return!1;case n>127&&n:return!0;case 92:return r+4<u&&i.charCodeAt(r)===117&&t(i.charCodeAt(r+1))&&t(i.charCodeAt(r+2))&&t(i.charCodeAt(r+3))&&t(i.charCodeAt(r+4))?!0:!1;default:return!1}}function s(n,i,r){for(var f=!1,u;i<r;){u=n.charCodeAt(i);switch(u){case u>=97&&u<=122&&u:case u>=65&&u<=90&&u:case 36:case 95:break;case e(u)&&u:case isLineTerminator(u)&&u:return f?-i:i;case u>127&&u:break;case u>=48&&u<=57&&u:break;case 92:if(i+5<r&&n.charCodeAt(i+1)===117&&t(n.charCodeAt(i+2))&&t(n.charCodeAt(i+3))&&t(n.charCodeAt(i+4))&&t(n.charCodeAt(i+5))){i+=5;f=!0;break}return f?-i:i;default:return f?-i:i}i++}return f?-i:i}function h(n,t,i){var f=t,e,u,o;return(t=s(n,t,i),e=!1,t<0&&(t=-t,e=!0),u=n.substr(f,t-f),e&&(u=""+JSON.parse('"'+u+'"')),o=r(u),o)?o:{type:tokenType.identifier,length:t-f,value:u}}function t(n){switch(n){case n>=48&&n<=57&&n:case n>=97&&n<=102&&n:case n>=65&&n<=70&&n:return!0;default:return!1}}function c(n,i,r){while(i<r&&t(n.charCodeAt(i)))i++;return i}function i(n){switch(n){case n>=48&&n<=57&&n:return!0;default:return!1}}function f(n,t,r){while(t<r&&i(n.charCodeAt(t)))t++;return t}function l(n,t,r){var u,e;return t=f(n,t,r),t<r&&n.charCodeAt(t)===46&&t+1<r&&i(n.charCodeAt(t+1))&&(t=f(n,t+2,r)),t<r&&(u=n.charCodeAt(t),(u===101||u===69)&&(e=t+1,e<r&&(u=n.charCodeAt(e),(u===43||u===45)&&e++,t=f(n,e,r)))),t}function u(n,t,i,r){var i=l(n,i,r),u=i-t;return{type:tokenType.numberLiteral,length:u,value:+n.substr(t,u)}}function isLineTerminator(n){switch(n){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}function a(text,offset,limit){var startOffset=offset,quoteCharCode=text.charCodeAt(offset),hasEscape=!1,length,stringValue;for(offset++;offset<limit&&!isLineTerminator(text.charCodeAt(offset));){if(offset+1<limit&&text.charCodeAt(offset)===92){hasEscape=!0;switch(text.charCodeAt(offset+1)){case quoteCharCode:case 92:case 10:case 8232:case 8233:offset+=2;continue;case 13:offset+=offset+2<limit&&text.charCodeAt(offset+2)===10?3:2;continue}}if(offset++,text.charCodeAt(offset-1)===quoteCharCode)break}return length=offset-startOffset,hasEscape=hasEscape||length===1||text.charCodeAt(offset-1)!==quoteCharCode,stringValue=hasEscape?eval(text.substr(startOffset,length)):text.substr(startOffset+1,length-2),{type:tokenType.stringLiteral,length:length,value:stringValue}}function e(n){switch(n){case 9:case 11:case 12:case 32:case 160:case 65279:return!0;case n<5760&&n:return!1;case 5760:case 6158:case n>=8192&&n<=8202&&n:case 8239:case 8287:case 12288:return!0;default:return!1}}function v(n,t,i){while(t<i){var r=n.charCodeAt(t);switch(r){case 9:case 11:case 12:case 32:case 160:case 65279:break;case r<5760&&r:return t;case 5760:case 6158:case r>=8192&&r<=8202&&r:case 8239:case 8287:case 12288:break;default:return t}t++}return t}function y(t,r,f,s){for(var y,p,l,b,w,k,d;f<s;){y=f;p=r.charCodeAt(f++);switch(p){case e(p)&&p:case isLineTerminator(p)&&p:f=v(r,f,s);l={type:tokenType.separator,length:f-y};continue;case 34:case 39:l=a(r,f-1,s);break;case 40:l=n.leftParentheses;break;case 41:l=n.rightParentheses;break;case 43:case 45:if(f<s)if(b=r.charCodeAt(f),b===46){if(w=f+1,w<s&&i(r.charCodeAt(w))){l=u(r,y,w,s);break}}else if(i(b)){l=u(r,y,f,s);break}l={type:tokenType.error,length:f-y,value:r.substring(y,f)};break;case 44:l=n.comma;break;case 46:l=n.dot;f<s&&i(r.charCodeAt(f))&&(l=u(r,y,f,s));break;case 48:k=f<s?r.charCodeAt(f):0;k===120||k===88?(d=c(r,f+1,s),l={type:tokenType.numberLiteral,length:d-y,value:+r.substr(y,d-y)}):l=u(r,y,f,s);break;case p>=49&&p<=57&&p:l=u(r,y,f,s);break;case 58:l=n.colon;break;case 59:l=n.semicolon;break;case 91:l=n.leftBracket;break;case 93:l=n.rightBracket;break;case 123:l=n.leftBrace;break;case 125:l=n.rightBrace;break;default:if(o(p,r,f,s)){l=h(r,f-1,s);break}l={type:tokenType.error,length:f-y,value:r.substring(y,f)}}f+=l.length-1;t.push(l)}}return function(t){var i=[];return y(i,t,0,t.length),i.push(n.eof),i}}();return i.tokenType=tokenType,i})})}),t("WinJS/ControlProcessor/_OptionsParser",["exports","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Resources","./_OptionsLexer"],function(n,t,i,r,u,f){"use strict";function s(){throw"Illegal";}function v(n){for(var i=Object.keys(e.tokenType),t=0,r=i.length;t<r;t++)if(n===e.tokenType[i[t]])return i[t];return"<unknown>"}var c={get invalidOptionsRecord(){return"Invalid options record: '{0}', expected to be in the format of an object literal. {1}"},get unexpectedTokenExpectedToken(){return"Unexpected token: {0}, expected token: {1}, at offset {2}"},get unexpectedTokenExpectedTokens(){return"Unexpected token: {0}, expected one of: {1}, at offset {2}"},get unexpectedTokenGeneric(){return"Unexpected token: {0}, at offset {1}"}},e=t.Namespace.defineWithParent(null,null,{lexer:t.Namespace._lazy(function(){return f._optionsLexer}),tokenType:t.Namespace._lazy(function(){return f._optionsLexer.tokenType})}),a=i.requireSupportedForProcessing,o=t.Namespace.defineWithParent(null,null,{BaseInterpreter:t.Namespace._lazy(function(){return t.Class.define(null,{_error:function(n){throw new r("WinJS.UI.ParseError",n);},_currentOffset:function(){for(var i=this._pos,t=0,n=0;n<i;n++)t+=this._tokens[n].length;return t},_evaluateAccessExpression:function(n){var t,i;switch(this._current.type){case e.tokenType.dot:this._read();switch(this._current.type){case e.tokenType.identifier:case this._current.keyword&&this._current.type:return t=this._current.value,this._read(),n[t];default:this._unexpectedToken(e.tokenType.identifier,e.tokenType.reservedWord)}return;case e.tokenType.leftBracket:return this._read(),i=this._evaluateValue(),this._read(e.tokenType.rightBracket),n[i]}},_evaluateAccessExpressions:function(n){for(;;)switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:n=this._evaluateAccessExpression(n);break;default:return n}},_evaluateIdentifier:function(n,t){var i=this._readIdentifier();return n?t[i]:this._context[i]},_evaluateIdentifierExpression:function(){var n=this._evaluateIdentifier(!1);switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:return this._evaluateAccessExpressions(n);default:return n}},_initialize:function(n,t,i,r){this._originalSource=t;this._tokens=n;this._context=i;this._functionContext=r;this._pos=0;this._current=this._tokens[0]},_read:function(n){n&&this._current.type!==n&&this._unexpectedToken(n);this._current!==e.tokenType.eof&&(this._current=this._tokens[++this._pos])},_peek:function(n){if(!n||this._current.type===n)return this._current!==e.tokenType.eof?this._tokens[this._pos+1]:void 0},_readAccessExpression:function(n){switch(this._current.type){case e.tokenType.dot:this._read();switch(this._current.type){case e.tokenType.identifier:case this._current.keyword&&this._current.type:n.push(this._current.value);this._read();break;default:this._unexpectedToken(e.tokenType.identifier,e.tokenType.reservedWord)}return;case e.tokenType.leftBracket:this._read();n.push(this._evaluateValue());this._read(e.tokenType.rightBracket);return}},_readAccessExpressions:function(n){for(;;)switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:this._readAccessExpression(n);break;default:return}},_readIdentifier:function(){var n=this._current.value;return this._read(e.tokenType.identifier),n},_readIdentifierExpression:function(){var n=[];this._peek(e.tokenType.thisKeyword)&&n.length===0?this._read():n.push(this._readIdentifier());switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:this._readAccessExpressions(n)}return n},_unexpectedToken:function(n){var i=this._current.type===e.tokenType.error?"'"+this._current.value+"'":v(this._current.type),r,t,f;if(n)if(arguments.length===1)n=v(n),this._error(u._formatString(c.unexpectedTokenExpectedToken,i,n,this._currentOffset()));else{for(r=[],t=0,f=arguments.length;t<f;t++)r.push(v(arguments[t]));n=r.join(", ");this._error(u._formatString(c.unexpectedTokenExpectedTokens,i,n,this._currentOffset()))}else this._error(u._formatString(c.unexpectedTokenGeneric,i,this._currentOffset()))}},{supportedForProcessing:!1})}),OptionsInterpreter:t.Namespace._lazy(function(){return t.Class.derive(o.BaseInterpreter,function(n,t,i,r){this._initialize(n,t,i,r)},{_error:function(n){throw new r("WinJS.UI.ParseError",u._formatString(c.invalidOptionsRecord,this._originalSource,n));},_evaluateArrayLiteral:function(){var n=[];return this._read(e.tokenType.leftBracket),this._readArrayElements(n),this._read(e.tokenType.rightBracket),n},_evaluateObjectLiteral:function(){var n={};return this._read(e.tokenType.leftBrace),this._readObjectProperties(n),this._tryReadComma(),this._read(e.tokenType.rightBrace),n},_evaluateOptionsLiteral:function(){var n=this._evaluateValue();return this._current.type!==e.tokenType.eof&&this._unexpectedToken(e.tokenType.eof),n},_peekValue:function(){switch(this._current.type){case e.tokenType.falseLiteral:case e.tokenType.nullLiteral:case e.tokenType.stringLiteral:case e.tokenType.trueLiteral:case e.tokenType.numberLiteral:case e.tokenType.leftBrace:case e.tokenType.leftBracket:case e.tokenType.identifier:return!0;default:return!1}},_evaluateValue:function(){switch(this._current.type){case e.tokenType.falseLiteral:case e.tokenType.nullLiteral:case e.tokenType.stringLiteral:case e.tokenType.trueLiteral:case e.tokenType.numberLiteral:var n=this._current.value;return this._read(),n;case e.tokenType.leftBrace:return this._evaluateObjectLiteral();case e.tokenType.leftBracket:return this._evaluateArrayLiteral();case e.tokenType.identifier:return this._peek(e.tokenType.identifier).type===e.tokenType.leftParentheses?a(this._evaluateObjectQueryExpression()):a(this._evaluateIdentifierExpression());default:this._unexpectedToken(e.tokenType.falseLiteral,e.tokenType.nullLiteral,e.tokenType.stringLiteral,e.tokenType.trueLiteral,e.tokenType.numberLiteral,e.tokenType.leftBrace,e.tokenType.leftBracket,e.tokenType.identifier)}},_tryReadElement:function(n){return this._peekValue()?(n.push(this._evaluateValue()),!0):!1},_tryReadComma:function(){return this._peek(e.tokenType.comma)?(this._read(),!0):!1},_tryReadElision:function(n){for(var t=!1;this._tryReadComma();)n.push(undefined),t=!0;return t},_readArrayElements:function(n){while(!this._peek(e.tokenType.rightBracket)){var i=this._tryReadElision(n),t=this._tryReadElement(n),r=this._peek(e.tokenType.comma);if(t&&r)this._read();else if(t||i)break;else{this._unexpectedToken(e.tokenType.falseLiteral,e.tokenType.nullLiteral,e.tokenType.stringLiteral,e.tokenType.trueLiteral,e.tokenType.numberLiteral,e.tokenType.leftBrace,e.tokenType.leftBracket,e.tokenType.identifier);break}}},_readObjectProperties:function(n){while(!this._peek(e.tokenType.rightBrace)){var t=this._tryReadObjectProperty(n),i=this._peek(e.tokenType.comma);if(t&&i)this._read();else if(t)break;else{this._unexpectedToken(e.tokenType.numberLiteral,e.tokenType.stringLiteral,e.tokenType.identifier);break}}},_tryReadObjectProperty:function(n){switch(this._current.type){case e.tokenType.numberLiteral:case e.tokenType.stringLiteral:case e.tokenType.identifier:case this._current.keyword&&this._current.type:var t=this._current.value;return this._read(),this._read(e.tokenType.colon),n[t]=this._evaluateValue(),!0;default:return!1}},_failReadObjectProperty:function(){this._unexpectedToken(e.tokenType.numberLiteral,e.tokenType.stringLiteral,e.tokenType.identifier,e.tokenType.reservedWord)},_evaluateObjectQueryExpression:function(){var i=this._current.value,t,n;this._read(e.tokenType.identifier);this._read(e.tokenType.leftParentheses);t=this._current.value;this._read(e.tokenType.stringLiteral);this._read(e.tokenType.rightParentheses);n=a(this._functionContext[i])(t);switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:return this._evaluateAccessExpressions(n);default:return n}},run:function(){return this._evaluateOptionsLiteral()}},{supportedForProcessing:!1})}),OptionsParser:t.Namespace._lazy(function(){return t.Class.derive(o.OptionsInterpreter,function(n,t){this._initialize(n,t)},{_evaluateAccessExpression:s,_evaluateAccessExpressions:s,_evaluateIdentifier:s,_evaluateIdentifierExpression:s,_evaluateObjectQueryExpression:s,_evaluateValue:function(){switch(this._current.type){case e.tokenType.falseLiteral:case e.tokenType.nullLiteral:case e.tokenType.stringLiteral:case e.tokenType.trueLiteral:case e.tokenType.numberLiteral:var n=this._current.value;return this._read(),n;case e.tokenType.leftBrace:return this._evaluateObjectLiteral();case e.tokenType.leftBracket:return this._evaluateArrayLiteral();case e.tokenType.identifier:return this._peek(e.tokenType.identifier).type===e.tokenType.leftParentheses?this._readObjectQueryExpression():this._readIdentifierExpression();default:this._unexpectedToken(e.tokenType.falseLiteral,e.tokenType.nullLiteral,e.tokenType.stringLiteral,e.tokenType.trueLiteral,e.tokenType.numberLiteral,e.tokenType.leftBrace,e.tokenType.leftBracket,e.tokenType.identifier)}},_readIdentifierExpression:function(){var n=o.BaseInterpreter.prototype._readIdentifierExpression.call(this);return new h(n)},_readObjectQueryExpression:function(){var r=this._current.value,i,n,t;this._read(e.tokenType.identifier);this._read(e.tokenType.leftParentheses);i=this._current.value;this._read(e.tokenType.stringLiteral);this._read(e.tokenType.rightParentheses);n=new l(r,i);switch(this._current.type){case e.tokenType.dot:case e.tokenType.leftBracket:return t=[n],this._readAccessExpressions(t),new h(t);default:return n}}},{supportedForProcessing:!1})})}),y=function(n,t,i){var r=e.lexer(n),u=new o.OptionsInterpreter(r,n,t||{},i||{});return u.run()},p,l,h;Object.defineProperty(y,"_BaseInterpreter",{get:function(){return o.BaseInterpreter}});p=function(n){var t=e.lexer(n),i=new o.OptionsParser(t,n);return i.run()};l=t.Class.define(function(n,t){this.target=n;this.arg0Value=t});l.supportedForProcessing=!1;h=t.Class.define(function(n){this.parts=n});h.supportedForProcessing=!1;t.Namespace._moduleDefine(n,"WinJS.UI",{optionsParser:y,_optionsParser:p,_CallExpression:l,_IdentifierExpression:h})}),t("WinJS/ControlProcessor",["exports","./Core/_Global","./Core/_Base","./Core/_BaseUtils","./Core/_Log","./Core/_Resources","./Core/_WriteProfilerMark","./ControlProcessor/_OptionsParser","./Promise","./Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s,h){"use strict";function v(n){var i=function(i){for(var r=n,f,u;r;){if(r.msParentSelectorScope&&(u=r.parentNode,u&&(f=h._matchesSelector(u,i)?u:u.querySelector(i),f)))break;r=r.parentNode}return f||t.document.querySelector(i)};return k(i)}function y(n,i){return new s(function(r,e){var y,h,c,s,l;try{h=n.getAttribute("data-win-options");h&&(y=o.optionsParser(h,t,{select:v(n)}));s=1;i.length>2&&s++;l=function(){s--;s===0&&(n.winControl=n.winControl||c,r(c))};c=new i(n,y,l);l()}catch(a){u.log&&u.log(f._formatString(b.errorActivatingControl,a&&a.message),"winjs controls","error");e(a)}})}function p(n,i){return new s(function(r,u){var b,k,p,d,f,h,a,s,tt;e("WinJS.UI:processAll,StartTM");n=n||t.document.body;var v=0,g="[data-win-control]",nt=n.querySelectorAll(g),o=[];for(!i&&c(n)&&o.push(n),f=0,h=nt.length;f<h;f++)o.push(nt[f]);if(o.length===0){e("WinJS.UI:processAll,StopTM");r(n);return}for(b=function(){v=v-1;v<0&&(e("WinJS.UI:processAll,StopTM"),r(n))},k=new Array(o.length),f=0,h=o.length;f<h;f++)s=o[f],d=s.winControl,d?p=d.constructor:k[f]=p=c(s),p&&p.isDeclarativeControlContainer&&(f+=s.querySelectorAll(g).length);for(e("WinJS.UI:processAllActivateControls,StartTM"),f=0,h=o.length;f<h;f++)a=k[f],s=o[f],a&&!s.winControl&&(v++,y(s,a).then(b,function(n){e("WinJS.UI:processAll,StopTM");u(n)}),a.isDeclarativeControlContainer&&typeof a.isDeclarativeControlContainer=="function"&&(tt=l(a.isDeclarativeControlContainer),tt(s.winControl,w)));e("WinJS.UI:processAllActivateControls,StopTM");b()})}function c(n){if(n.getAttribute){var i=n.getAttribute("data-win-control");if(i)return r._getMemberFiltered(i.trim(),t,l)}}function d(n,t){return v(t)(n)}function w(n,t){return a?p(n,t):r.ready().then(function(){return a=!0,p(n,t)})}function g(n){if(n&&n.winControl)return s.as(n.winControl);var t=c(n);return t?y(n,t):s.as()}if(t.document){var b={get errorActivatingControl(){return"Error activating control: {0}"}},k=r.markSupportedForProcessing,l=r.requireSupportedForProcessing,a=!1;i.Namespace._moduleDefine(n,"WinJS.UI",{scopedSelect:d,processAll:w,process:g})}}),t("WinJS/Utilities/_ElementListUtilities",["exports","../Core/_Global","../Core/_Base","../ControlProcessor","../Promise","../Utilities/_Control","../Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e){"use strict";t.document&&i.Namespace._moduleDefine(n,"WinJS.Utilities",{QueryCollection:i.Class.derive(Array,function(n){n&&this.include(n)},{forEach:function(n,t){return Array.prototype.forEach.apply(this,[n,t]),this},get:function(n){return this[n]},setAttribute:function(n,t){return this.forEach(function(i){i.setAttribute(n,t)}),this},getAttribute:function(n){if(this.length>0)return this[0].getAttribute(n)},addClass:function(n){return this.forEach(function(t){e.addClass(t,n)}),this},hasClass:function(n){return this.length>0?e.hasClass(this[0],n):!1},removeClass:function(n){return this.forEach(function(t){e.removeClass(t,n)}),this},toggleClass:function(n){return this.forEach(function(t){e.toggleClass(t,n)}),this},listen:function(n,t,i){return this.forEach(function(r){r.addEventListener(n,t,i)}),this},removeEventListener:function(n,t,i){return this.forEach(function(r){r.removeEventListener(n,t,i)}),this},setStyle:function(n,t){return this.forEach(function(i){i.style[n]=t}),this},clearStyle:function(n){return this.forEach(function(t){t.style[n]=""}),this},query:function(t){var i=new n.QueryCollection;return this.forEach(function(n){i.include(n.querySelectorAll(t))}),i},include:function(n){if(typeof n.length=="number")for(var t=0;t<n.length;t++)this.push(n[t]);else n.DOCUMENT_FRAGMENT_NODE&&n.nodeType===n.DOCUMENT_FRAGMENT_NODE?this.include(n.childNodes):this.push(n)},control:function(n,t){return n&&typeof n=="function"?this.forEach(function(i){i.winControl=new n(i,t)}):(t=n,this.forEach(function(n){r.process(n).done(function(n){n&&f.setOptions(n,t)})})),this},template:function(t,i,r){var e,o,f;return t instanceof n.QueryCollection&&(t=t[0]),e=t.winControl,i!==null&&i!==undefined&&i.forEach||(i=[i]),r=r||function(){},o=this,f=[],i.forEach(function(n){o.forEach(function(t){f.push(e.render(n,t))})}),r(u.join(f)),this}},{supportedForProcessing:!1}),query:function(i,r){return new n.QueryCollection((r||t.document).querySelectorAll(i))},id:function(i){var r=t.document.getElementById(i);return new n.QueryCollection(r?[r]:[])},children:function(t){return new n.QueryCollection(t.children)}})}),t("WinJS/Utilities/_Hoverable",["exports","../Core/_Global"],function(n,t){"use strict";if(t.document&&(t.document.documentElement.classList.add("win-hoverable"),n.isHoverable=!0,!t.MSPointerEvent)){var i=function(){t.document.removeEventListener("touchstart",i);t.document.documentElement.classList.remove("win-hoverable");n.isHoverable=!1};t.document.addEventListener("touchstart",i)}}),t("WinJS/Utilities/_ParallelWorkQueue",["exports","../Core/_Base","../Promise","../Scheduler"],function(n,t,i,r){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_ParallelWorkQueue:t.Namespace._lazy(function(){return t.Class.define(function(n){function o(){f--;e||r.schedule(s,r.Priority.normal,null,"WinJS._ParallelWorkQueue.runNext")}function s(){for(e++;f<n;f++){var i,r;do i=u.shift(),r=i&&t[i];while(i&&!r);if(r){delete t[i];try{r().then(o,o)}catch(s){o()}}else break}e--}function c(n,r,f){var e="w"+h++,o;return new i(function(i,h,c){var l=function(){return o=n().then(i,h,c)};l.data=r;t[e]=l;f?u.unshift(e):u.push(e);s()},function(){delete t[e];o&&o.cancel()})}var h=0,t={},u=[],f,e;n=n||3;f=0;e=0;this.sort=function(n){u.sort(function(i,r){return i=t[i],r=t[r],i===undefined&&r===undefined?0:i===undefined?1:r===undefined?-1:n(i.data,r.data)})};this.queue=c},{},{supportedForProcessing:!1})})})}),t("WinJS/Utilities/_VersionManager",["exports","../Core/_Base","../_Signal"],function(n,t,i){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_VersionManager:t.Namespace._lazy(function(){return t.Class.define(function(){this._unlocked=new i;this._unlocked.complete()},{_cancelCount:0,_notificationCount:0,_updateCount:0,_version:0,locked:{get:function(){return this._notificationCount!==0||this._updateCount!==0}},noOutstandingNotifications:{get:function(){return this._notificationCount===0}},version:{get:function(){return this._version}},unlocked:{get:function(){return this._unlocked.promise}},_dispose:function(){this._unlocked&&(this._unlocked.cancel(),this._unlocked=null)},beginUpdating:function(){this._checkLocked();this._updateCount++},endUpdating:function(){this._updateCount--;this._checkUnlocked()},beginNotifications:function(){this._checkLocked();this._notificationCount++},endNotifications:function(){this._notificationCount--;this._checkUnlocked()},_checkLocked:function(){this.locked||(this._dispose(),this._unlocked=new i)},_checkUnlocked:function(){this.locked||this._unlocked.complete()},receivedNotification:function(){if(this._version++,this._cancel){var n=this._cancel;this._cancel=null;n.forEach(function(n){n&&n.cancel()})}},cancelOnNotification:function(n){return this._cancel||(this._cancel=[],this._cancelCount=0),this._cancel[this._cancelCount++]=n,this._cancelCount-1},clearCancelOnNotification:function(n){this._cancel&&delete this._cancel[n]}},{supportedForProcessing:!1})})})}),t("WinJS/Utilities/_ItemsManager",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../_Signal","../Scheduler","../Utilities/_ElementUtilities","./_ParallelWorkQueue","./_VersionManager"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function d(n){return it(function(t,i){return t.then(function(t){return t?n(t,i):null})})}function ft(n,t){var i=!1,r=!1;return n.isOnScreen().then(function(n){i=n}),t.isOnScreen().then(function(n){r=n}),(i?0:1)-(r?0:1)}function k(n){var i,r,t,u;if(!/^blob:/i.test(n)&&(v[n]=!0,p.push(n),p.length>tt))for(i=p,v={},p=[],r=0,t=i.length-1;t>=0&&r<nt;t--)u=i[t],v[u]||(v[u]=!0,r++)}function ot(n,i,r){var u=et++;return b=b||new l._ParallelWorkQueue(6),b.queue(function(){return new o(function(r,f){h.schedule(function(u){i||(i=t.document.createElement("img"));var e=v[n];e?(k(n),i.src=n,r(i)):u.setPromise(new o(function(u){var e=t.document.createElement("img"),o=function(){e.removeEventListener("load",s,!1);e.removeEventListener("error",h,!1);i.src=n;var t=new Date;t-g>ut&&(g=t,b.sort(ft))},s=function(){u(c)},h=function(){u(l)},c=function(){k(n);o();r(i)},l=function(){o();f(i)};e.addEventListener("load",s,!1);e.addEventListener("error",h,!1);e.src=n}))},h.Priority.normal,null,"WinJS.UI._ImageLoader._image"+u)})},r)}function st(n){return v[n]}function ht(){return t.document.createElement("div")}var it=r.markSupportedForProcessing,y=c._uniqueID,rt=d(function(n){var i,r;return c._isDOMElement(n.data)?n.data:(i=n.data,i===undefined?i="undefined":i===null?i="null":typeof i=="object"&&(i=JSON.stringify(i)),r=t.document.createElement("span"),r.textContent=i.toString(),r)});i.Namespace._moduleDefine(n,"WinJS.UI",{_normalizeRendererReturn:function(n){var t;return n?typeof n=="object"&&n.element?(t=o.as(n.element),t.then(function(t){return{element:t,renderComplete:o.as(n.renderComplete)}})):(t=o.as(n),t.then(function(n){return{element:n,renderComplete:o.as()}})):{element:null,renderComplete:o.as()}},simpleItemRenderer:d,_trivialHtmlRenderer:rt});var w={get listDataSourceIsInvalid(){return"Invalid argument: dataSource must be an object."},get itemRendererIsInvalid(){return"Invalid argument: itemRenderer must be a function."},get itemIsInvalid(){return"Invalid argument: item must be a DOM element that was returned by the Items Manager, and has not been replaced or released."}},b,g=new Date,ut=64;var et=0,v={},p=[],nt=250,tt=1e3;i.Namespace._moduleDefine(n,"WinJS.UI",{_seenUrl:k,_getSeenUrls:function(){return v},_getSeenUrlsMRU:function(){return p},_seenUrlsMaxSize:nt,_seenUrlsMRUMaxSize:tt});i.Namespace._moduleDefine(n,"WinJS.UI",{_createItemsManager:i.Namespace._lazy(function(){var t=i.Class.define(function(n){this._itemsManager=n},{beginNotifications:function(){this._itemsManager._versionManager.beginNotifications();this._itemsManager._beginNotifications()},inserted:function(n,t,i){this._itemsManager._versionManager.receivedNotification();this._itemsManager._inserted(n,t,i)},changed:function(n,t){this._itemsManager._versionManager.receivedNotification();this._itemsManager._changed(n,t)},moved:function(n,t,i){this._itemsManager._versionManager.receivedNotification();this._itemsManager._moved(n,t,i)},removed:function(n,t){this._itemsManager._versionManager.receivedNotification();this._itemsManager._removed(n,t)},countChanged:function(n,t){this._itemsManager._versionManager.receivedNotification();this._itemsManager._countChanged(n,t)},indexChanged:function(n,t,i){this._itemsManager._versionManager.receivedNotification();this._itemsManager._indexChanged(n,t,i)},affectedRange:function(n){this._itemsManager._versionManager.receivedNotification();this._itemsManager._affectedRange(n)},endNotifications:function(){this._itemsManager._versionManager.endNotifications();this._itemsManager._endNotifications()},reload:function(){this._itemsManager._versionManager.receivedNotification();this._itemsManager._reload()}},{supportedForProcessing:!1}),r=i.Class.define(function(n,i,r,f){if(!n)throw new u("WinJS.UI.ItemsManager.ListDataSourceIsInvalid",w.listDataSourceIsInvalid);if(!i)throw new u("WinJS.UI.ItemsManager.ItemRendererIsInvalid",w.itemRendererIsInvalid);this.$pipeline_callbacksMap={};this._listDataSource=n;this.dataSource=this._listDataSource;this._elementNotificationHandler=r;this._listBinding=this._listDataSource.createListBinding(new t(this));f&&(f.ownerElement&&(this._ownerElement=f.ownerElement),this._profilerId=f.profilerId,this._versionManager=f.versionManager||new a._VersionManager);this._indexInView=f&&f.indexInView;this._itemRenderer=i;this._viewCallsReady=f&&f.viewCallsReady;this._elementMap={};this._handleMap={};this._jobOwner=h.createOwnerToken();this._notificationsSent=!1;this._listBinding.last&&(this.lastItem=function(){return this._elementForItem(this._listBinding.last())})},{_itemFromItemPromise:function(n){return this._waitForElement(this._elementForItem(n))},_itemFromItemPromiseThrottled:function(n){return this._waitForElement(this._elementForItem(n,!0))},_itemAtIndex:function(n){var t=this._itemPromiseAtIndex(n);this._itemFromItemPromise(t).then(null,function(n){return t.cancel(),o.wrapError(n)})},_itemPromiseAtIndex:function(n){return this._listBinding.fromIndex(n)},_waitForElement:function(n){var t=this;return new o(function(i){if(n)if(t.isPlaceholder(n)){var r=y(n),u=t.$pipeline_callbacksMap[r];u?u.push(i):t.$pipeline_callbacksMap[r]=[i]}else i(n);else i(n)})},_updateElement:function(n,t){var i=y(t),r=this.$pipeline_callbacksMap[i];r&&(delete this.$pipeline_callbacksMap[i],r.forEach(function(t){t(n)}))},_firstItem:function(){return this._waitForElement(this._elementForItem(this._listBinding.first()))},_lastItem:function(){return this._waitForElement(this._elementForItem(this._listBinding.last()))},_previousItem:function(n){return this._listBinding.jumpToItem(this._itemFromElement(n)),this._waitForElement(this._elementForItem(this._listBinding.previous()))},_nextItem:function(n){return this._listBinding.jumpToItem(this._itemFromElement(n)),this._waitForElement(this._elementForItem(this._listBinding.next()))},_itemFromPromise:function(n){return this._waitForElement(this._elementForItem(n))},isPlaceholder:function(n){return!!this._recordFromElement(n).elementIsPlaceholder},itemObject:function(n){return this._itemFromElement(n)},release:function(){this._listBinding.release();this._elementNotificationHandler=null;this._listBinding=null;this._jobOwner.cancelAll();this._released=!0},releaseItemPromise:function(n){var i=n.handle,t=this._handleMap[i];t?this._releaseRecord(t):n.cancel()},releaseItem:function(n){var t=this._elementMap[y(n)];this._releaseRecord(t)},_releaseRecord:function(n){n&&(n.renderPromise&&n.renderPromise.cancel(),n.itemPromise&&n.itemPromise.cancel(),n.imagePromises&&n.imagePromises.forEach(function(n){n.cancel()}),n.itemReadyPromise&&n.itemReadyPromise.cancel(),n.renderComplete&&n.renderComplete.cancel(),this._removeEntryFromElementMap(n.element),this._removeEntryFromHandleMap(n.itemPromise.handle,n),n.item&&this._listBinding.releaseItem(n.item))},refresh:function(){return this._listDataSource.invalidateAll()},_handlerToNotifyCaresAboutItemAvailable:function(){return!!(this._elementNotificationHandler&&this._elementNotificationHandler.itemAvailable)},_handlerToNotify:function(){return this._notificationsSent||(this._notificationsSent=!0,this._elementNotificationHandler&&this._elementNotificationHandler.beginNotifications&&this._elementNotificationHandler.beginNotifications()),this._elementNotificationHandler},_defineIndexProperty:function(n,t,i){i.indexObserved=!1;Object.defineProperty(n,"index",{get:function(){return i.indexObserved=!0,t.index}})},_renderPlaceholder:function(n){var t=ht({});return n.elementIsPlaceholder=!0,t},_renderItem:function(t,i,r){function w(){t.then(function(n){u._writeProfilerMark(y+",StartTM");e.complete(n);u._writeProfilerMark(y+",StopTM")})}var u=this,k=u._indexInView||function(){return!0},e=new s,c=new s,y="_renderItem("+i.item.index+"):itemPromise",p=!0,l=!1,f,a,v,b;return t.then(function(n){l=!0;p&&e.complete(n)}),p=!1,f=e.promise.then(function(n){if(n){var t=Object.create(n);return u._defineIndexProperty(t,n,i),t.ready=c.promise,t.isOnScreen=function(){return o.wrap(k(n.index))},t.loadImage=function(n,r){var u=ot(n,r,t);return i.imagePromises?i.imagePromises.push(u):i.imagePromises=[u],u},t.isImageCached=st,t}return o.cancel}),l||(r?(i.stage0=t,i.startStage1=function(){i.startStage1=null;w()}):w()),f.handle=t.handle,i.itemPromise=f,i.itemReadyPromise=c.promise,i.readyComplete=!1,a="_renderItem("+i.item.index+(l?"):syncItemPromise":"):placeholder"),v="_renderItem("+i.item.index+"):itemReady",this._writeProfilerMark(a+",StartTM"),b=o.as(u._itemRenderer(f,i.element)).then(n._normalizeRendererReturn).then(function(n){return u._released?o.cancel:(f.then(function(n){if(i.pendingReady=function(){i.pendingReady&&(i.pendingReady=null,i.readyComplete=!0,u._writeProfilerMark(v+",StartTM"),c.complete(n),u._writeProfilerMark(v+",StopTM"))},!u._viewCallsReady){var t=h.schedule(i.pendingReady,h.Priority.normal,i,"WinJS.UI._ItemsManager._pendingReady");t.owner=u._jobOwner}}),n)}),this._writeProfilerMark(a+",StopTM"),b},_replaceElement:function(n,t){this._removeEntryFromElementMap(n.element);n.element=t;this._addEntryToElementMap(t,n)},_changeElement:function(n,t,i){n.renderPromise=null;var r=n.element,u=n.item;n.newItem&&(n.item=n.newItem,n.newItem=null);this._replaceElement(n,t);n.item&&n.elementIsPlaceholder&&!i?(n.elementDelayed=null,n.elementIsPlaceholder=!1,this._updateElement(n.element,r),this._handlerToNotifyCaresAboutItemAvailable()&&this._handlerToNotify().itemAvailable(n.element,r)):this._handlerToNotify().changed(t,r,u)},_elementForItem:function(n,t){var u=n.handle,i=this._recordFromHandle(u,!0),r;if(!u)return null;if(i)r=i.element;else{i={item:n,itemPromise:n};this._addEntryToHandleMap(u,i);var f=this,e=!1,o=!1,s=f._renderItem(n,i,t).then(function(t){var u=t.element;i.renderComplete=t.renderComplete;n.then(function(n){i.item=n;n||(e=!0,r=null)});o=!0;i.renderPromise=null;u&&(r?f._presentElements(i,u):r=u)});e||(o||(i.renderPromise=s),r||(r=this._renderPlaceholder(i)),i.element=r,this._addEntryToElementMap(r,i),n.retain())}return r},_addEntryToElementMap:function(n,t){this._elementMap[y(n)]=t},_removeEntryFromElementMap:function(n){delete this._elementMap[y(n)]},_recordFromElement:function(n){var t=this._elementMap[y(n)];if(!t){this._writeProfilerMark("_recordFromElement:ItemIsInvalidError,info");throw new u("WinJS.UI.ItemsManager.ItemIsInvalid",w.itemIsInvalid);}return t},_addEntryToHandleMap:function(n,t){this._handleMap[n]=t},_removeEntryFromHandleMap:function(n){delete this._handleMap[n]},_handleInHandleMap:function(n){return!!this._handleMap[n]},_recordFromHandle:function(n,t){var i=this._handleMap[n];if(!i&&!t)throw new u("WinJS.UI.ItemsManager.ItemIsInvalid",w.itemIsInvalid);return i},_foreachRecord:function(n){var t=this._handleMap,i,r;for(i in t)r=t[i],n(r)},_itemFromElement:function(n){return this._recordFromElement(n).item},_elementFromHandle:function(n){if(n){var t=this._recordFromHandle(n,!0);if(t&&t.element)return t.element}return null},_inserted:function(n,t,i){this._handlerToNotify().inserted(n,t,i)},_changed:function(n,t){var i,r,u;this._handleInHandleMap(t.handle)&&(i=this._recordFromHandle(t.handle),i.renderPromise&&i.renderPromise.cancel(),i.itemPromise&&i.itemPromise.cancel(),i.imagePromises&&i.imagePromises.forEach(function(n){n.cancel()}),i.itemReadyPromise&&i.itemReadyPromise.cancel(),i.renderComplete&&i.renderComplete.cancel(),i.newItem=n,r=this,u=o.as(n),u.handle=i.itemPromise.handle,i.renderPromise=this._renderItem(u,i).then(function(n){i.renderComplete=n.renderComplete;r._changeElement(i,n.element,!1);r._presentElements(i)}))},_moved:function(n,t,i){var r=this._elementFromHandle(n.handle),u=this._elementFromHandle(t),f=this._elementFromHandle(i);this._handlerToNotify().moved(r,u,f,n);this._presentAllElements()},_removed:function(n,t){if(this._handleInHandleMap(n)){var i=this._elementFromHandle(n);this._handlerToNotify().removed(i,t,n);this.releaseItem(i);this._presentAllElements()}else this._handlerToNotify().removed(null,t,n)},_countChanged:function(n,t){this._elementNotificationHandler&&this._elementNotificationHandler.countChanged&&this._handlerToNotify().countChanged(n,t)},_indexChanged:function(n,t,i){var s,r,u,f,e;this._handleInHandleMap(n)&&(r=this._recordFromHandle(n),r.indexObserved&&(r.elementIsPlaceholder?this._changeElement(r,this._renderPlaceholder(r),!0):r.item.index!==t&&(r.renderPromise&&r.renderPromise.cancel(),r.renderComplete&&r.renderComplete.cancel(),u=r.newItem||r.item,u.index=t,f=o.as(u),f.handle=r.itemPromise.handle,e=this,r.renderPromise=this._renderItem(f,r).then(function(n){r.renderComplete=n.renderComplete;e._changeElement(r,n.element,!1);e._presentElements(r)}))),s=r.element);this._elementNotificationHandler&&this._elementNotificationHandler.indexChanged&&this._handlerToNotify().indexChanged(s,t,i)},_affectedRange:function(n){this._elementNotificationHandler&&this._elementNotificationHandler.updateAffectedRange&&this._handlerToNotify().updateAffectedRange(n)},_beginNotifications:function(){this._externalBegin=!0;this._handlerToNotify()},_endNotifications:function(){this._notificationsSent&&(this._notificationsSent=!1,this._externalBegin=!1,this._elementNotificationHandler&&this._elementNotificationHandler.endNotifications&&this._elementNotificationHandler.endNotifications())},_reload:function(){this._elementNotificationHandler&&this._elementNotificationHandler.reload&&this._elementNotificationHandler.reload()},_postEndNotifications:function(){if(this._notificationsSent&&!this._externalBegin&&!this._endNotificationsPosted){this._endNotificationsPosted=!0;var n=this;h.schedule(function(){n._endNotificationsPosted=!1;n._endNotifications()},h.Priority.high,null,"WinJS.UI._ItemsManager._postEndNotifications")}},_presentElement:function(n){var t=n.element;this._replaceElement(n,n.elementDelayed);n.elementDelayed=null;n.elementIsPlaceholder=!1;this._updateElement(n.element,t);this._handlerToNotifyCaresAboutItemAvailable()&&this._handlerToNotify().itemAvailable(n.element,t)},_presentElements:function(n,t){t&&(n.elementDelayed=t);this._listBinding.jumpToItem(n.item);n.elementDelayed&&this._presentElement(n);this._postEndNotifications()},_presentAllElements:function(){var n=this;this._foreachRecord(function(t){t.elementDelayed&&n._presentElement(t)})},_writeProfilerMark:function(n){var t="WinJS.UI._ItemsManager:"+(this._profilerId?this._profilerId+":":":")+n;e(t)}},{supportedForProcessing:!1});return function(n,t,i,u){return new r(n,t,i,u)}})})}),t("WinJS/Utilities/_TabContainer",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","./_ElementUtilities"],function(n,t,i,r,u){"use strict";function f(n,i,r,u){var f=t.document.createEvent("UIEvent");return f.initUIEvent(i,!1,!!u,t,r?1:0),!n.dispatchEvent(f)}function h(n){var r=t.getComputedStyle(n),i,u;return r.display==="none"||r.visibility==="hidden"?t.NodeFilter.FILTER_REJECT:n._tabContainer?t.NodeFilter.FILTER_ACCEPT:n.parentNode&&n.parentNode._tabContainer?(i=n.parentNode._tabContainer.childFocus,i&&n.contains(i))?e(n)>=0?t.NodeFilter.FILTER_ACCEPT:t.NodeFilter.FILTER_SKIP:t.NodeFilter.FILTER_REJECT:(u=e(n),u>=0)?t.NodeFilter.FILTER_ACCEPT:t.NodeFilter.FILTER_SKIP}function s(n){function u(){if(n.currentNode._tabContainer)t=t.concat(s(n));else if(e(n.currentNode)>=0&&t.push(n.currentNode),n.firstChild()){do u();while(n.nextSibling());n.parentNode()}}var i=n.currentNode,r=i._tabContainer.childFocus,t=[];return r?(n.currentNode=r,u(),n.currentNode=i,t):[]}function c(n,i){function s(){var n=t.document.createElement("DIV");return n.tabIndex=i?i:0,n.setAttribute("aria-hidden",!0),n}var e=n.parentNode,u=s(),r,o;e.insertBefore(u,n);r=s();e.insertBefore(r,n.nextSibling);u.addEventListener("focus",function(){f(n,"onTabEnter",!0)},!0);r.addEventListener("focus",function(){f(n,"onTabEnter",!1)},!0);this._catcherBegin=u;this._catcherEnd=r;o=1;this.addRef=function(){o++};this.release=function(){return--o==0&&(u.parentElement&&e.removeChild(u),r.parentElement&&e.removeChild(r)),o};this.updateTabIndex=function(n){u.tabIndex=n;r.tabIndex=n}}var e,o;t.document&&(e=u.getTabIndex,o={attach:function(n,t){return n["win-trackTabHelperObject"]?n["win-trackTabHelperObject"].addRef():n["win-trackTabHelperObject"]=new c(n,t),n["win-trackTabHelperObject"]},detach:function(n){n["win-trackTabHelperObject"].release()||delete n["win-trackTabHelperObject"]}},i.Namespace._moduleDefine(n,"WinJS.UI",{TrackTabBehavior:o,TabContainer:i.Class.define(function(n){this._element=n;this._tabIndex=0;n._tabContainer=this;n.getAttribute("tabindex")===null&&(n.tabIndex=-1);var t=this;n.addEventListener("onTabEnter",function(i){var r=f(t._element,"onTabEntered",i.detail,!0);r||(t.childFocus?t.childFocus.focus():n.focus())});n.addEventListener("keydown",function(n){var o=n.target,i,a,v,e,c,l;if(n.keyCode===u.Key.tab&&(i=!n.shiftKey,a=t._hasMoreElementsInTabOrder(o,i),!a)){if(v=f(t._element,"onTabExiting",i,!0),v){n.stopPropagation();n.preventDefault();return}var s=t._element.querySelectorAll("a[href],area[href],button,command,input,link,menuitem,object,select,textarea,th[sorted],[tabindex]"),y=s.length,h=[];for(e=0;e<y;e++)c=s[e],h.push(c.tabIndex),c.tabIndex=-1;t._elementTabHelper[i?"_catcherEnd":"_catcherBegin"].tabIndex=-1;l=function(){o.removeEventListener("blur",l,!1);for(var n=0;n<y;n++)h[n]!==-1&&(s[n].tabIndex=h[n]);t._elementTabHelper._catcherBegin.tabIndex=t._tabIndex;t._elementTabHelper._catcherEnd.tabIndex=t._tabIndex};o.addEventListener("blur",l,!1);r._yieldForEvents(function(){f(t._element,"onTabExit",i)})}});this._elementTabHelper=o.attach(n,this._tabIndex);this._elementTabHelper._catcherBegin.tabIndex=0;this._elementTabHelper._catcherEnd.tabIndex=0},{dispose:function(){o.detach(this._element,this._tabIndex)},childFocus:{set:function(n){n!==this._focusElement&&(this._focusElement=n&&n.parentNode?n:null)},get:function(){return this._focusElement}},tabIndex:{set:function(n){this._tabIndex=n;this._elementTabHelper.updateTabIndex(n)},get:function(){return this._tabIndex}},_element:null,_skipper:function(n){n.stopPropagation();n.preventDefault()},_hasMoreElementsInTabOrder:function(n,i){var f,u,r;if(!this.childFocus)return!1;for(f=t.document.createTreeWalker(this._element,t.NodeFilter.SHOW_ELEMENT,h,!1),u=s(f),r=0;r<u.length;r++)if(u[r]===n)return i?r<u.length-1:r>0;return!1},_focusElement:null},{supportedForProcessing:!1})}))}),t("WinJS/Utilities/_KeyboardBehavior",["exports","../Core/_Global","../Core/_Base","./_Control","./_ElementUtilities","./_TabContainer"],function(n,t,i,r,u,f){"use strict";if(t.document){var e={touch:"touch",pen:"pen",mouse:"mouse",keyboard:"keyboard"},o=e.mouse,s={2:e.touch,3:e.pen,4:e.mouse,touch:e.touch,pen:e.pen,mouse:e.mouse};u._addEventListener(t,"pointerdown",function(n){o=s[n.pointerType]||e.mouse},!0);t.addEventListener("keydown",function(){o=e.keyboard},!0);i.Namespace._moduleDefine(n,"WinJS.UI",{_keyboardSeenLast:{get:function(){return o===e.keyboard},set:function(n){o=n?e.keyboard:e.mouse}},_lastInputType:{get:function(){return o},set:function(n){e[n]&&(o=n)}},_InputTypes:e,_WinKeyboard:function(t){u._addEventListener(t,"pointerdown",function(n){u.removeClass(n.target,"win-keyboard")},!0);t.addEventListener("keydown",function(n){u.addClass(n.target,"win-keyboard")},!0);u._addEventListener(t,"focusin",function(t){n._keyboardSeenLast&&u.addClass(t.target,"win-keyboard")},!1);u._addEventListener(t,"focusout",function(n){u.removeClass(n.target,"win-keyboard")},!1)},_KeyboardBehavior:i.Namespace._lazy(function(){var n=u.Key,e=i.Class.define(function(n,i){n=n||t.document.createElement("DIV");i=i||{};n._keyboardBehavior=this;this._element=n;this._fixedDirection=e.FixedDirection.width;this._fixedSize=1;this._currentIndex=0;r.setOptions(this,i);this._tabContainer=new f.TabContainer(this.scroller||this._element);this._tabContainer.tabIndex=0;this._element.children.length>0&&(this._tabContainer.childFocus=this._getFocusInto(this._element.children[0]));this._element.addEventListener("keydown",this._keyDownHandler.bind(this));u._addEventListener(this._element,"pointerdown",this._MSPointerDownHandler.bind(this))},{element:{get:function(){return this._element}},fixedDirection:{get:function(){return this._fixedDirection},set:function(n){this._fixedDirection=n}},fixedSize:{get:function(){return this._fixedSize},set:function(n){+n===n&&(n=Math.max(1,n),this._fixedSize=n)}},currentIndex:{get:function(){return this._element.children.length>0?this._currentIndex:-1},set:function(n){if(+n===n){var t=this._element.children.length;n=Math.max(0,Math.min(t-1,n));this._currentIndex=n;this._tabContainer.childFocus=this._getFocusInto(this._element.children[n])}}},getAdjacent:{get:function(){return this._getAdjacent},set:function(n){this._getAdjacent=n}},scroller:{get:function(){return this._scroller},set:function(n){this._scroller=n}},_keyDownHandler:function(i){var f;if(!i.altKey){if(u._matchesSelector(i.target,".win-interactive, .win-interactive *"))return;var r=this.currentIndex,s=this._element.children.length-1,h=t.getComputedStyle(this._element).direction==="rtl",c=h?n.rightArrow:n.leftArrow,l=h?n.leftArrow:n.rightArrow,o=this.getAdjacent&&this.getAdjacent(r,i.keyCode);+o===o?r=o:(f=r%this.fixedSize,i.keyCode===c?this.fixedDirection===e.FixedDirection.width?f!==0&&r--:r>=this.fixedSize&&(r-=this.fixedSize):i.keyCode===l?this.fixedDirection===e.FixedDirection.width?f!==this.fixedSize-1&&r++:r+this.fixedSize-f<=s&&(r+=this.fixedSize):i.keyCode===n.upArrow?this.fixedDirection===e.FixedDirection.height?f!==0&&r--:r>=this.fixedSize&&(r-=this.fixedSize):i.keyCode===n.downArrow?this.fixedDirection===e.FixedDirection.height?f!==this.fixedSize-1&&r++:r+this.fixedSize-f<=s&&(r+=this.fixedSize):i.keyCode===n.home?r=0:i.keyCode===n.end&&(r=this._element.children.length-1));r=Math.max(0,Math.min(this._element.children.length-1,r));r!==this.currentIndex&&(this._focus(r,i.keyCode),(i.keyCode===c||i.keyCode===l||i.keyCode===n.upArrow||i.keyCode===n.downArrow)&&i.stopPropagation(),i.preventDefault())}},_getFocusInto:function(n,t){return n&&n.winControl&&n.winControl._getFocusInto?n.winControl._getFocusInto(t):n},_focus:function(n,t){n=+n===n?n:this.currentIndex;var i=this._element.children[n];i&&(i=this._getFocusInto(i,t),this.currentIndex=n,u._setActive(i,this.scroller))},_MSPointerDownHandler:function(n){var t=n.target,i;if(t!==this.element){while(t.parentNode!==this.element)t=t.parentNode;for(i=-1;t;)i++,t=t.previousElementSibling;this.currentIndex=i}}},{FixedDirection:{height:"height",width:"width"}});return e})})}}),t("WinJS/Utilities/_SafeHtml",["exports","../Core/_WinJS","../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_Resources"],function(n,t,i,r,u){"use strict";var o,s,h,c,l,a,v={get nonStaticHTML(){return"Unable to add dynamic content. A script attempted to inject dynamic content, or elements previously modified dynamically, that might be unsafe. For example, using the innerHTML property or the document.write method to add a script element will generate this exception. If the content is safe and from a trusted source, use a method to explicitly manipulate elements and attributes, such as createElement, or use setInnerHTMLUnsafe (or other unsafe method)."}},f,e;o=s=function(n,t){n.innerHTML=t};h=c=function(n,t){n.outerHTML=t};l=a=function(n,t,i){n.insertAdjacentHTML(t,i)};f=i.MSApp;f&&f.execUnsafeLocalFunction?(s=function(n,i){f.execUnsafeLocalFunction(function(){try{t._execUnsafe=!0;n.innerHTML=i}finally{t._execUnsafe=!1}})},c=function(n,i){f.execUnsafeLocalFunction(function(){try{t._execUnsafe=!0;n.outerHTML=i}finally{t._execUnsafe=!1}})},a=function(n,i,r){f.execUnsafeLocalFunction(function(){try{t._execUnsafe=!0;n.insertAdjacentHTML(i,r)}finally{t._execUnsafe=!1}})}):i.msIsStaticHTML&&(e=function(n){if(!i.msIsStaticHTML(n))throw new u("WinJS.Utitilies.NonStaticHTML",v.nonStaticHTML);},o=function(n,t){e(t);n.innerHTML=t},h=function(n,t){e(t);n.outerHTML=t},l=function(n,t,i){e(i);n.insertAdjacentHTML(t,i)});r.Namespace._moduleDefine(n,"WinJS.Utilities",{setInnerHTML:o,setInnerHTMLUnsafe:s,setOuterHTML:h,setOuterHTMLUnsafe:c,insertAdjacentHTML:l,insertAdjacentHTMLUnsafe:a})}),t("WinJS/Utilities/_Select",["exports","../Core/_Base","./_SafeHtml"],function(n,t,i){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_Select:t.Namespace._lazy(function(){function e(n){return n.replace(r,function(n){return u[n]||""})}function o(n){return n.replace(f,"")}function s(n){return this[n]}function h(){return this.length}function n(n){return n.getValue||(n.getValue=s),n.getLength||(n.getLength=h),n}var r=/[&<>'"]/g,u={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},f=/[\u200e\u200f]/g;return t.Class.define(function(t,i){this._dataSource=n(i.dataSource);this._index=i.index||0;this._domElement=t;this._domElement.tabIndex=0;i.disabled&&this.setDisabled(i.disabled);var r=this;this._domElement.addEventListener("change",function(){r._index=r._domElement.selectedIndex},!1);this._createSelectElement()},{_index:0,_dataSource:null,dataSource:{get:function(){return this._dataSource},set:function(t){this._dataSource=n(t);this._domElement&&this._createSelectElement()}},setDisabled:function(n){n?this._domElement.setAttribute("disabled","disabled"):this._domElement.removeAttribute("disabled")},_createSelectElement:function(){for(var u=this._dataSource.getLength(),t="",n=0;n<u;n++){var f=""+this._dataSource.getValue(n),r=e(f),s=o(r);t+="<option value='"+s+"'>"+r+"<\/option>"}i.setInnerHTMLUnsafe(this._domElement,t);this._domElement.selectedIndex=this._index},index:{get:function(){return Math.max(0,Math.min(this._index,this._dataSource.getLength()-1))},set:function(n){if(this._index!==n){this._index=n;var t=this._domElement;t&&t.selectedIndex!==n&&(t.selectedIndex=n)}}},value:{get:function(){return this._dataSource.getValue(this.index)}}})})})}),t("WinJS/Utilities/_Telemetry",["exports"],function(n){"use strict";n.send=function(){}}),t("WinJS/Utilities/_UI",["exports","../Core/_BaseCoreUtils","../Core/_Base"],function(n,t,i){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{eventHandler:function(n){return t.markSupportedForProcessing(n)},Orientation:{horizontal:"horizontal",vertical:"vertical"},CountResult:{unknown:"unknown"},CountError:{noResponse:"noResponse"},DataSourceStatus:{ready:"ready",waiting:"waiting",failure:"failure"},FetchError:{noResponse:"noResponse",doesNotExist:"doesNotExist"},EditError:{noResponse:"noResponse",canceled:"canceled",notPermitted:"notPermitted",noLongerMeaningful:"noLongerMeaningful"},ObjectType:{item:"item",groupHeader:"groupHeader",header:"header",footer:"footer"},SelectionMode:{none:"none",single:"single",multi:"multi"},TapBehavior:{directSelect:"directSelect",toggleSelect:"toggleSelect",invokeOnly:"invokeOnly",none:"none"},SwipeBehavior:{select:"select",none:"none"},GroupHeaderTapBehavior:{invoke:"invoke",none:"none"}})}),t("WinJS/Utilities/_Xhr",["../Core/_Global","../Core/_Base","../Promise","../Scheduler"],function(n,t,i,r){"use strict";function u(n,t,i){r.schedule(function(){n(t)},i,null,"WinJS.xhr")}function f(){}function e(t){var e;return new i(function(i,s,h){var l=r.currentPriority,c,a;e=new n.XMLHttpRequest;c=!1;a=o.exec(t.url.toLowerCase());a?a[1]==="file"&&(c=!0):n.location.protocol==="file:"&&(c=!0);e.onreadystatechange=function(){if(e._canceled){e.onreadystatechange=f;return}e.readyState===4?(e.status>=200&&e.status<300||c&&e.status===0?u(i,e,l):u(s,e,l),e.onreadystatechange=f):u(h,e,l)};e.open(t.type||"GET",t.url,!0,t.user,t.password);e.responseType=t.responseType||"";Object.keys(t.headers||{}).forEach(function(n){e.setRequestHeader(n,t.headers[n])});t.customRequestInitializer&&t.customRequestInitializer(e);t.data===undefined?e.send():e.send(t.data)},function(){e.onreadystatechange=f;e._canceled=!0;e.abort()})}var o=/^(\w+)\:\/\//;return t.Namespace.define("WinJS",{xhr:e}),e}),t("WinJS/Utilities",["./Utilities/_Control","./Utilities/_Dispose","./Utilities/_ElementListUtilities","./Utilities/_ElementUtilities","./Utilities/_Hoverable","./Utilities/_ItemsManager","./Utilities/_KeyboardBehavior","./Utilities/_ParallelWorkQueue","./Utilities/_SafeHtml","./Utilities/_Select","./Utilities/_TabContainer","./Utilities/_Telemetry","./Utilities/_UI","./Utilities/_VersionManager","./Utilities/_Xhr"],function(){}),t("WinJS/XYFocus",["require","exports","./Core/_Global","./Core/_Base","./Core/_BaseUtils","./Utilities/_ElementUtilities","./Core/_Events","./ControlProcessor/_OptionsParser"],function(n,t,i,r,u,f,e,o){"use strict";function tt(n,t){var i=ft(n,t);return i?i.target:null}function ut(n,t){var r=tt(n,t),u;if(r&&(u=i.document.activeElement,et(r,-1)))return g.dispatchEvent(b.focusChanged,{previousFocusElement:u,keyCode:-1}),r}function k(n,r,u){function nt(n,t){var i=d();n===v.left||n===v.right?(i.top=Math.max(t.targetRect.top,t.referenceRect.top,c?c.top:Number.MIN_VALUE),i.bottom=Math.min(t.targetRect.bottom,t.referenceRect.bottom,c?c.bottom:Number.MAX_VALUE),i.bottom<=i.top&&(i.top=t.targetRect.top,i.bottom=t.targetRect.bottom),i.height=i.bottom-i.top,i.width=Number.MAX_VALUE,i.left=Number.MIN_VALUE,i.right=Number.MAX_VALUE):(i.left=Math.max(t.targetRect.left,t.referenceRect.left,c?c.left:Number.MIN_VALUE),i.right=Math.min(t.targetRect.right,t.referenceRect.right,c?c.right:Number.MAX_VALUE),i.right<=i.left&&(i.left=t.targetRect.left,i.right=t.targetRect.right),i.width=i.right-i.left,i.height=Number.MAX_VALUE,i.top=Number.MIN_VALUE,i.bottom=Number.MAX_VALUE);c=i}var s,w,e,o;u||i.document.activeElement!==l?(c=null,l=null,y=null):l&&y&&(s=a(l.getBoundingClientRect()),(s.left!==y.left||s.top!==y.top)&&(c=null,l=null,y=null));var k=i.document.activeElement,tt=l,f=ft(n,{focusRoot:t.focusRoot,historyRect:c,referenceElement:l,referenceRect:u});return f&&et(f.target,r)?(nt(n,f),l=f.target,y=f.targetRect,f.target.tagName==="IFRAME"&&(w=p.lastIndexOf(f.target.contentWindow),w>=0&&(e=a({left:f.referenceRect.left-f.targetRect.left,top:f.referenceRect.top-f.targetRect.top,width:f.referenceRect.width,height:f.referenceRect.height}),o={},o[h.messageDataProperty]={type:h.dFocusEnter,direction:n,referenceRect:e},f.target.contentWindow.postMessage(o,"*"))),g.dispatchEvent(b.focusChanged,{previousFocusElement:k,keyCode:r}),!0):top!==window?(e=u,e||(e=i.document.activeElement?a(i.document.activeElement.getBoundingClientRect()):d()),o={},o[h.messageDataProperty]={type:h.dFocusExit,direction:n,referenceRect:e},i.parent.postMessage(o,"*"),!0):!1}function ft(n,r){function s(n,t,i,r){if(n>=r||t<=i)return 0;var u=Math.min(t,r)-Math.max(n,i),f=Math.min(r-i,t-n);return u/f}function st(n,t,i,r,u){var c=0,e,f,o=0,h=0;switch(n){case v.left:if(u.left>=r.left)break;e=s(r.top,r.bottom,u.top,u.bottom);f=r.left-u.right;e>0?h=s(i.top,i.bottom,u.top,u.bottom):o=r.bottom<=u.top?u.top-r.bottom:r.top-u.bottom;break;case v.right:if(u.right<=r.right)break;e=s(r.top,r.bottom,u.top,u.bottom);f=u.left-r.right;e>0?h=s(i.top,i.bottom,u.top,u.bottom):o=r.bottom<=u.top?u.top-r.bottom:r.top-u.bottom;break;case v.up:if(u.top>=r.top)break;e=s(r.left,r.right,u.left,u.right);f=r.top-u.bottom;e>0?h=s(i.left,i.right,u.left,u.right):o=r.right<=u.left?u.left-r.right:r.left-u.right;break;case v.down:if(u.bottom<=r.bottom)break;e=s(r.left,r.right,u.left,u.right);f=u.top-r.bottom;e>0?h=s(i.left,i.right,u.left,u.right):o=r.right<=u.left?u.left-r.right:r.left-u.right}return f>=0&&(f=t-f,o=t-o,f>=0&&o>=0&&(f+=f*e,c=f*nt.primaryAxisDistanceWeight+o*nt.secondaryAxisDistanceWeight+h*nt.percentInHistoryShadowWeight)),c}function ht(n,t){var r,u;return(n||t)&&(!n||n.parentNode)||i.document.activeElement!==i.document.body&&(n=i.document.activeElement),n?(r=n,u=a(r.getBoundingClientRect())):u=t?a(t):d(),{element:r,rect:u}}function ct(n){var t=n.tagName,i;return!n.hasAttribute("tabindex")&&ot.indexOf(t)===-1&&!f.hasClass(n,rt.focusable)?!1:t==="IFRAME"&&p.indexOf(n.contentWindow)===-1?!1:t==="DIV"&&n.winControl&&n.winControl.disabled?!1:(i=getComputedStyle(n),n.getAttribute("tabIndex")==="-1"||i.display==="none"||i.visibility==="hidden"||n.disabled)?!1:!0}var ft,u,b,k,g,h,c,e,tt,w,et,l,y,ut;if(r=r||{},r.focusRoot=r.focusRoot||t.focusRoot||i.document.body,r.historyRect=r.historyRect||d(),ft=Math.max(i.screen.availHeight,i.screen.availWidth),u=ht(r.referenceElement,r.referenceRect),u.element&&(b=u.element.getAttribute(it.focusOverride)||u.element.getAttribute(it.focusOverrideLegacy),b&&(k=o.optionsParser(b),g=k[n]||k[n[0].toUpperCase()+n.substr(1)],g))){for(c=u.element;!h&&c;)h=c.querySelector(g),c=c.parentElement;if(h)return h===i.document.activeElement?null:{target:h,targetRect:a(h.getBoundingClientRect()),referenceRect:u.rect,usedOverride:!0}}for(e={element:null,rect:null,score:0},tt=r.focusRoot.querySelectorAll("*"),w=0,et=tt.length;w<et;w++)(l=tt[w],u.element!==l&&ct(l))&&(y=a(l.getBoundingClientRect()),y.width!==0&&y.height!==0)&&(ut=st(n,ft,r.historyRect,u.rect,y),ut>e.score&&(e.element=l,e.rect=y,e.score=ut));return e.element?{target:e.element,targetRect:e.rect,referenceRect:u.rect,usedOverride:!1}:null}function d(){return{top:-1,bottom:-1,right:-1,left:-1,height:0,width:0}}function a(n){return{top:Math.floor(n.top),bottom:Math.floor(n.top+n.height),right:Math.floor(n.left+n.width),left:Math.floor(n.left),height:Math.floor(n.height),width:Math.floor(n.width)}}function et(n,t){var r=g.dispatchEvent(b.focusChanging,{nextFocusElement:n,keyCode:t});return r||n.focus(),i.document.activeElement===n}function st(n){var r=i.document.querySelectorAll("IFRAME"),t=Array.prototype.filter.call(r,function(t){return t.contentWindow===n});return t.length?t[0]:null}function ht(n){var u,r,f,e;if(!n.defaultPrevented)for(u=Object.keys(t.keyCodeMap),r=0;r<u.length;r++)if(f=u[r],e=t.keyCodeMap[f],e.indexOf(n.keyCode)>=0){e===t.keyCodeMap.accept?i.document.activeElement&&i.document.activeElement.click&&i.document.activeElement.click():k(f,n.keyCode)&&n.preventDefault();return}}var s=f.Key,it={focusOverride:"data-win-xyfocus",focusOverrideLegacy:"data-win-focus"},rt={focusable:"win-focusable",xboxPlatform:"win-xbox"},h={messageDataProperty:"msWinJSXYFocusControlMessage",register:"register",unregister:"unregister",dFocusEnter:"dFocusEnter",dFocusExit:"dFocusExit"},v={left:"left",right:"right",up:"up",down:"down"},b={focusChanging:"focuschanging",focusChanged:"focuschanged"},ot=["A","BUTTON","IFRAME","INPUT","SELECT","TEXTAREA"],nt={primaryAxisDistanceWeight:30,secondaryAxisDistanceWeight:20,percentInHistoryShadowWeight:1e5},l,y,c,p,w,g;t.keyCodeMap={left:[s.GamepadLeftThumbstickLeft,s.GamepadDPadLeft,s.NavigationLeft],right:[s.GamepadLeftThumbstickRight,s.GamepadDPadRight,s.NavigationRight],up:[s.GamepadLeftThumbstickUp,s.GamepadDPadUp,s.NavigationUp],down:[s.GamepadLeftThumbstickDown,s.GamepadDPadDown,s.NavigationDown],accept:[s.GamepadA,s.NavigationAccept]};t.focusRoot;t.findNextFocusElement=tt;t.moveFocus=ut;p=[];i.addEventListener("message",function(n){var t,f,r,u;if(n.data&&n.data[h.messageDataProperty]){t=n.data[h.messageDataProperty];switch(t.type){case h.register:p.push(n.source);break;case h.unregister:f=p.indexOf(n.source);f>=0&&p.splice(f,1);break;case h.dFocusEnter:k(t.direction,-1,t.referenceRect);break;case h.dFocusExit:if(r=st(n.source),i.document.activeElement!==r)break;u=t.referenceRect;u.left+=r.offsetLeft;u.top+=r.offsetTop;k(t.direction,-1,u)}}});u.ready().then(function(){if(f.hasWinRT&&i.Windows&&i.Windows.Xbox&&f.addClass(i.document.body,rt.xboxPlatform),i.document.addEventListener("keydown",ht),i.top!==i.window){var n={};n[h.messageDataProperty]={type:h.register,version:1};i.parent.postMessage(n,"*")}});w={focusRoot:{get:function(){return t.focusRoot},set:function(n){t.focusRoot=n}},findNextFocusElement:tt,keyCodeMap:t.keyCodeMap,moveFocus:ut,onfocuschanged:e._createEventProperty(b.focusChanged),onfocuschanging:e._createEventProperty(b.focusChanging),_xyFocus:k};w=u._merge(w,e.eventMixin);w._listeners={};g=w;r.Namespace.define("WinJS.UI.XYFocus",w)}),t("WinJS/Fragments",["exports","./Core/_Global","./Core/_WinRT","./Core/_Base","./Core/_BaseUtils","./Core/_ErrorFromName","./Core/_Resources","./Core/_WriteProfilerMark","./Promise","./Utilities/_ElementUtilities","./Utilities/_SafeHtml","./Utilities/_Xhr"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function ft(n,i,r,u){var e=n.src,h=!e,o,f,c;return h&&(e=i+"script["+r+"]"),e=e.toLowerCase(),(e in b)?void 0:(o=null,b[e]=!0,f=t.document.createElement("script"),n.language&&f.setAttribute("language","javascript"),f.setAttribute("type",n.type),f.setAttribute("async","false"),n.id&&f.setAttribute("id",n.id),h?(c=n.text,o=u.then(function(){f.text=c}).then(null,function(){})):o=new s(function(t){f.onload=f.onerror=function(){t()};f.setAttribute("src",n.src)}),y.appendChild(f),{promise:o,inline:h})}function et(n,t,i){var r=(t+"script["+i+"]").toLowerCase();r in d||(d[r]=!0,y.appendChild(n.cloneNode(!0)))}function ot(n){var i=n.href.toLowerCase(),t;i in k||(k[i]=!0,t=n.cloneNode(!1),t.href=n.href,y.appendChild(t))}function nt(n,i){var r,u;if(typeof n=="string")return ht(n,i);if(r={docfrag:h.data(n).docFragment},!r.docfrag){for(u=t.document.createDocumentFragment();n.childNodes.length>0;)u.appendChild(n.childNodes[0]);r.docfrag=h.data(n).docFragment=u;n.setAttribute("data-win-hasfragment","")}return i&&rt(n),s.as(r)}function st(n,t){return yt(n,t).then(function(){return n.document?ct(t,n):n}).then(function(){return n.document&&delete n.document,n})}function ht(n,t){var r=n.toLowerCase(),i=v[r],u;return i?(t&&delete v[r],i.promise?i.promise:s.as(i)):(i={},t||(v[r]=i),u=i.promise=st(i,n),i.promise.then(function(){delete i.promise}),u)}function ct(n,i){var r=i.document,u=r.body,h=[],f,e,o;for(a(r.querySelectorAll('link[rel="stylesheet"], link[type="text/css"]'),ot),a(r.getElementsByTagName("style"),function(t,i){et(t,n,i)}),f=s.as(),a(r.getElementsByTagName("script"),function(t,i){var r=ft(t,n,i,f);r&&(r.inline||(f=r.promise),h.push(r.promise))}),a(u.getElementsByTagName("img"),function(n){n.src=n.src}),a(u.getElementsByTagName("a"),function(n){if(n.href!==""){var t=n.getAttribute("href");t&&t[0]!=="#"&&(n.href=n.href)}}),e=u.getElementsByTagName("script");e.length>0;)o=e[0],o.parentNode.removeChild(o);return s.join(h).then(function(){for(var n=t.document.createDocumentFragment(),u=t.document.importNode(r.body,!0);u.childNodes.length>0;)n.appendChild(u.childNodes[0]);return i.docfrag=n,i})}function tt(){g||(g=!0,a(y.querySelectorAll("script"),function(n){b[n.src.toLowerCase()]=!0}),a(y.querySelectorAll('link[rel="stylesheet"], link[type="text/css"]'),function(n){k[n.href.toLowerCase()]=!0}))}function lt(n,t){return it(n,t,!0)}function it(n,i,r){var f=(n instanceof t.HTMLElement?u._getProfilerMarkIdentifier(n):" href='"+n+"'")+"["+ ++ut+"]";return p("WinJS.UI.Fragments:render"+f+",StartTM"),tt(),nt(n,!r).then(function(n){var u=n.docfrag,t,e;for(r&&(u=u.cloneNode(!0)),t=u.firstChild;t;)t.nodeType===1&&(t.msParentSelectorScope=!0),t=t.nextSibling;return i?(i.appendChild(u),e=i):e=u,p("WinJS.UI.Fragments:render"+f+",StopTM"),e})}function at(n,t){return it(n,t,!1)}function vt(n){return tt(),nt(n).then(function(n){return n.docfrag})}function rt(n){n?typeof n=="string"?delete v[n.toLowerCase()]:(delete h.data(n).docFragment,n.removeAttribute("data-win-hasfragment")):v={}}function yt(n,i){var r=t.document.implementation.createHTMLDocument("frag"),u=r.createElement("base"),f;return r.head.appendChild(u),f=r.createElement("a"),r.body.appendChild(f),u.href=t.document.location.href,f.setAttribute("href",i),u.href=f.href,n.document=r,w(i).then(function(n){c.setInnerHTMLUnsafe(r.documentElement,n);r.head.appendChild(u)})}function pt(n){return l({url:n}).then(function(n){return n.responseText})}var p,w;if(t.document){var a=function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i],i)},y=t.document.head||t.document.getElementsByTagName("head")[0],b={},d={},k={},g=!1,v={},ut=1;p=o;w=pt;r.Namespace._moduleDefine(n,"WinJS.UI.Fragments",{renderCopy:lt,render:at,cache:vt,clearCache:rt,_cacheStore:{get:function(){return v}},_getFragmentContents:{get:function(){return w},set:function(n){w=n}},_writeProfilerMark:{get:function(){return p},set:function(n){p=n}}})}}),t("WinJS/Application/_State",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Promise"],function(n,t,i,r,u,f){"use strict";function o(){var t,u,f,e=r.Class.define(function(n){this.folder=n;this._path=n.path;n.tryGetItemAsync&&(this._tryGetItemAsync=n.tryGetItemAsync.bind(n))},{_tryGetItemAsync:function(n){return this.folder.getFileAsync(n).then(null,function(){return!1})},exists:function(n){return this._tryGetItemAsync(n).then(function(n){return n?!0:!1})},remove:function(n){return this._tryGetItemAsync(n).then(function(n){return n?n.deleteAsync():!1}).then(null,function(){return!1})},writeText:function(n,t){var r=i.Windows.Storage,u=this;return u.folder.createFileAsync(n,r.CreationCollisionOption.openIfExists).then(function(n){return r.FileIO.writeTextAsync(n,t)})},readText:function(n,t){var r=i.Windows.Storage;return this._tryGetItemAsync(n).then(function(n){return n?r.FileIO.readTextAsync(n):t}).then(null,function(){return t})}},{supportedForProcessing:!1});r.Namespace._moduleDefine(n,"WinJS.Application",{local:{get:function(){return t||(t=new e(i.Windows.Storage.ApplicationData.current.localFolder)),t}},temp:{get:function(){return u||(u=new e(i.Windows.Storage.ApplicationData.current.temporaryFolder)),u}},roaming:{get:function(){return f||(f=new e(i.Windows.Storage.ApplicationData.current.roamingFolder)),f}}})}function s(){var t=r.Class.define(function(){this.storage={}},{exists:function(n){return f.as(this.storage[n]!==undefined)},remove:function(n){return delete this.storage[n],f.as()},writeText:function(n,t){return this.storage[n]=t,f.as(t.length)},readText:function(n,t){var i=this.storage[n];return f.as(typeof i=="string"?i:t)}},{supportedForProcessing:!1});r.Namespace._moduleDefine(n,"WinJS.Application",{local:new t,temp:new t,roaming:new t})}i.Windows.Storage.FileIO&&i.Windows.Storage.ApplicationData&&i.Windows.Storage.CreationCollisionOption?o():s();var e={};r.Namespace._moduleDefine(n,"WinJS.Application",{sessionState:{get:function(){return e},set:function(n){e=n}},_loadState:function(t){return t.previousExecutionState===3?n.local.readText("_sessionState.json","{}").then(function(t){var i=JSON.parse(t);i&&Object.keys(i).length>0&&(n._sessionStateLoaded=!0);n.sessionState=i}).then(null,function(){n.sessionState={}}):f.as()},_oncheckpoint:function(i,r){var u,f;if((!t.MSApp||!t.MSApp.getViewOpener||!t.MSApp.getViewOpener())&&(u=n.sessionState,u&&Object.keys(u).length>0||n._sessionStateLoaded)){try{f=JSON.stringify(u)}catch(e){f="";r.queueEvent({type:"error",detail:e})}i.setPromise(n.local.writeText("_sessionState.json",f).then(null,function(n){r.queueEvent({type:"error",detail:n})}))}}})}),t("WinJS/Navigation",["exports","./Core/_Base","./Core/_Events","./Core/_WriteProfilerMark","./Promise"],function(n,t,i,r,u){"use strict";var h="navigated",c="navigating",l="beforenavigate",p=t.Class.mix(t.Class.define(null,{},{supportedForProcessing:!1}),i.eventMixin),e=new p,f={backStack:[],current:{location:"",initialPlaceholder:!0},forwardStack:[]},s=i._createEventProperty,a=function(n){return r("WinJS.Navigation:navigation,StartTM"),u.as().then(function(){var t=u.as(),i=e.dispatchEvent(l,{setPromise:function(n){t=t.then(function(){return n})},location:n.location,state:n.state});return t.then(function(n){return i||n})})},v=function(n){return u.as().then(function(){var t=u.as();return e.dispatchEvent(c,{setPromise:function(n){t=t.then(function(){return n})},location:f.current.location,state:f.current.state,delta:n}),t})},o=function(n,t){r("WinJS.Navigation:navigation,StopTM");var i=u.as(),o={value:n,location:f.current.location,state:f.current.state,setPromise:function(n){i=i.then(function(){return n})}};return!n&&t&&(o.error=t),e.dispatchEvent(h,o),i},y=function(n,t,i,r){return(n=Math.min(n,t.length),n>0)?a(t[t.length-n]).then(function(u){if(u)return!1;for(i.push(f.current);n-1>0;)n--,i.push(t.pop());return f.current=t.pop(),v(r).then(o,function(n){o(undefined,n||!0);throw n;}).then(function(){return!0})}):u.wrap(!1)};t.Namespace._moduleDefine(n,"WinJS.Navigation",{canGoForward:{get:function(){return f.forwardStack.length>0}},canGoBack:{get:function(){return f.backStack.length>0}},location:{get:function(){return f.current.location}},state:{get:function(){return f.current.state},set:function(n){f.current.state=n}},history:{get:function(){return f},set:function(n){f=n;f.backStack=f.backStack||[];f.forwardStack=f.forwardStack||[];f.current=f.current||{location:"",initialPlaceholder:!0};f.current.location=f.current.location||""}},forward:function(n){return n=n||1,y(n,f.forwardStack,f.backStack,n)},back:function(n){return n=n||1,y(n,f.backStack,f.forwardStack,-n)},navigate:function(n,t){var i={location:n,state:t};return a(i).then(function(n){return n?!1:(f.current.initialPlaceholder||f.backStack.push(f.current),f.forwardStack=[],f.current=i,v().then(o,function(n){o(undefined,n||!0);throw n;}).then(function(){return!0}))})},addEventListener:function(n,t,i){e.addEventListener(n,t,i)},removeEventListener:function(n,t,i){e.removeEventListener(n,t,i)},onnavigated:s(h),onnavigating:s(c),onbeforenavigate:s(l)})}),t("WinJS/Application",["exports","./Core/_Global","./Core/_WinRT","./Core/_Base","./Core/_Events","./Core/_Log","./Core/_WriteProfilerMark","./Application/_State","./Navigation","./Promise","./_Signal","./Scheduler","./Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function kt(n){var i,r;try{r=[];i=JSON.stringify(n,function(n,i){return i===t?"[window]":i instanceof t.HTMLElement?"[HTMLElement]":typeof i=="function"?"[function]":typeof i=="object"?i===null?i:r.indexOf(i)===-1?(r.push(i),i):"[circular]":i})}catch(u){i=JSON.stringify("[object]")}return i}function dt(n){t.MSApp&&t.MSApp.terminateApp(n)}function gt(n){var t="def"+bi++;return{deferral:nt[t]=n.getDeferral(),id:t}}function ki(n,t){t&&(n=nt[t],delete nt[t]);n&&n.complete()}function ni(){nt&&(Object.keys(nt).forEach(function(n){nt[n].complete()}),nt={})}function b(n){function o(t){return e("WinJS.Application:Event_"+n.type+",StopTM"),n._deferral&&ki(n._deferral,n._deferralID),t}var i,r,u,f,t;e("WinJS.Application:Event_"+n.type+",StartTM");i=h.as();n.setPromise=function(n){i=i.then(function(){return n})};n._stoppedImmediatePropagation=!1;n.stopImmediatePropagation=function(){n._stoppedImmediatePropagation=!0};n.detail=n.detail||{};typeof n.detail=="object"&&(n.detail.setPromise=n.setPromise);try{if(d._listeners&&(r=!1,t=d._listeners[n.type],t))for(u=0,f=t.length;u<f&&!n._stoppedImmediatePropagation;u++)r=t[u].listener(n)||r;t=ii[n.type];t&&t.forEach(function(t){t(n,r)})}catch(s){y({type:tt,detail:s})}return i.then(o,function(n){if(n=o(n),!n||n.name!=="Canceled")return h.wrapError(n)})}function di(){return w||(w=new c,w.promise.done(function(){w=null},function(){w=null})),w}function ti(n){function t(n){y({type:tt,detail:n})}return n.length===0?di().promise:b(n.shift()).then(null,t)}function ct(n){function i(){return ct}var t=n.job._queue;t.length===0&&it.length>0&&(t=n.job._queue=lt());n.setPromise(ti(t).then(i,i))}function gi(){function r(){t=!0}for(var n=[],t=!0,i;t;)n.length===0&&it.length>0&&(n=lt()),t=!1,i=ti(n),i.done(r,r);rt=l.schedule(function(n){function t(){return ct}n.setPromise(i.then(t,t))},l.Priority.high,null,"WinJS.Application._pumpEventQueue");rt._queue=n}function y(n){e("WinJS.Application:Event_"+n.type+" queued,Info");it.push(n);st&&w&&w.complete(ct)}function lt(){var n=it;return it=[],n}function ri(n){var t=gt(n.activatedOperation);o._loadState(n).then(function(){y({type:ot,detail:n,_deferral:t.deferral,_deferralID:t.id})})}function ui(n){var t=gt(n.suspendingOperation);y({type:et,_deferral:t.deferral,_deferralID:t.id})}function nr(){if(y({type:vt}),!(t.document&&i.Windows.UI.WebUI.WebUIApplication)){var n={arguments:"",kind:"Windows.Launch",previousExecutionState:0};o._loadState(n).then(function(){y({type:ot,detail:n})})}}function fi(){ni();y({type:at})}function ei(t){var f={},r,e,u,i;for(r in t)f[r]=t[r];u=!0;i=n._terminateApp;try{n._terminateApp=function(n,t){u=!1;e=n;i!==dt&&i(n,t)};b({type:tt,detail:{error:f,errorLine:t.lineno,errorCharacter:t.colno,errorUrl:t.filename,errorMessage:t.message}})}finally{n._terminateApp=i}return u}function oi(n){var t=n.detail,i=t.id,r,u;if(t.parent){t.handler&&k&&delete k[i];return}t.exception instanceof Error&&(r={stack:t.exception.stack,message:t.exception.message},t.exception=r);u=!k;k=k||[];k[i]=t;u&&l.schedule(function(){var n=k;k=null;n.forEach(function(n){y({type:tt,detail:n})})},l.Priority.high,null,"WinJS.Application._queuePromiseErrors")}function si(n){var t={e:n,applicationcommands:undefined};d.dispatchEvent(pt,t)}function hi(n){var t={type:wt};Object.defineProperty(t,"_winRTBackPressedEvent",{value:n,enumerable:!1});b(t)}function tr(){b({type:vi})}function ci(n){b({type:yi,kind:n.kind})}function li(n){b({type:pi,kind:n.kind})}function ai(n){b({type:wi,kind:n.kind})}function ir(){var r,u,n;ft||(ft=!0,t.addEventListener("beforeunload",fi,!1),t.document&&(t.addEventListener("error",ei,!1),i.Windows.UI.WebUI.WebUIApplication&&(r=i.Windows.UI.WebUI.WebUIApplication,r.addEventListener("activated",ri,!1),r.addEventListener("suspending",ui,!1)),i.Windows.UI.ApplicationSettings.SettingsPane&&(u=i.Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView(),u.addEventListener("commandsrequested",si)),i.Windows.Phone.UI.Input.HardwareButtons&&i.Windows.Phone.UI.Input.HardwareButtons.addEventListener("backpressed",hi),i.Windows.UI.Input.EdgeGesture&&(n=i.Windows.UI.Input.EdgeGesture.getForCurrentView(),n.addEventListener("starting",ci),n.addEventListener("completed",li),n.addEventListener("canceled",ai))),h.addEventListener("error",oi))}function rr(){var r,u,n;ft&&(ft=!1,t.removeEventListener("beforeunload",fi,!1),t.document&&(i.Windows.UI.WebUI.WebUIApplication&&(t.removeEventListener("error",ei,!1),r=i.Windows.UI.WebUI.WebUIApplication,r.removeEventListener("activated",ri,!1),r.removeEventListener("suspending",ui,!1)),i.Windows.UI.ApplicationSettings.SettingsPane&&(u=i.Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView(),u.removeEventListener("commandsrequested",si)),i.Windows.Phone.UI.Input.HardwareButtons&&i.Windows.Phone.UI.Input.HardwareButtons.removeEventListener("backpressed",hi),i.Windows.UI.Input.EdgeGesture&&(n=i.Windows.UI.Input.EdgeGesture.getForCurrentView(),n.removeEventListener("starting",ci),n.removeEventListener("completed",li),n.removeEventListener("canceled",ai))),h.removeEventListener("error",oi))}var ht,ii,p;t.Debug&&(t.Debug.setNonUserCodeExceptions=!0);var et="checkpoint",at="unload",ot="activated",vt="loaded",yt="ready",tt="error",pt="settings",wt="backclick",vi="beforerequestingfocusonkeyboardinput",ut="requestingfocusonkeyboardinput",yi="edgystarting",pi="edgycompleted",wi="edgycanceled",k,it=[],rt=null,w=null,st=!1,ft=!1,bt=r.Class.mix(r.Class.define(null,{},{supportedForProcessing:!1}),u.eventMixin),d=new bt,g=u._createEventProperty,nt={},bi=0,v={_registered:!1,updateRegistration:function(){var n=d._listeners&&d._listeners[ut]||[];!v._registered&&n.length>0&&(v._updateKeydownCaptureListeners(t.top,!0),v._registered=!0);v._registered&&n.length===0&&(v._updateKeydownCaptureListeners(t.top,!1),v._registered=!1)},_keydownCaptureHandler:function(n){v._registered&&v._shouldKeyTriggerTypeToSearch(n)&&tr()},_frameLoadCaptureHandler:function(n){v._registered&&v._updateKeydownCaptureListeners(n.target.contentWindow,!0)},_updateKeydownCaptureListeners:function(n,t){var r,u,i;try{t?n.document.addEventListener("keydown",v._keydownCaptureHandler,!0):n.document.removeEventListener("keydown",v._keydownCaptureHandler,!0)}catch(f){}if(n.frames)for(r=0,u=n.frames.length;r<u;r++){i=n.frames[r];v._updateKeydownCaptureListeners(i,t);try{t?i.frameElement&&i.frameElement.addEventListener("load",v._frameLoadCaptureHandler,!0):i.frameElement&&i.frameElement.removeEventListener("load",v._frameLoadCaptureHandler,!0)}catch(f){}}},_shouldKeyTriggerTypeToSearch:function(n){var t=!1;if(!n.metaKey&&(!n.ctrlKey&&!n.altKey||n.getModifierState&&n.getModifierState("AltGraph")))switch(n.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 186:case 187:case 188:case 189:case 190:case 191:case 192:case 219:case 220:case 221:case 222:case 223:case 226:case 229:case 231:t=!0}return t}};ht=dt;ii={activated:[function(){y({type:yt})}],checkpoint:[function(t){o._oncheckpoint(t,n)}],error:[function(i,r){if(!r&&(f.log&&f.log(kt(i),"winjs","error"),t.document&&n._terminateApp)){var u=i.detail,e=u&&(u.number||u.exception&&(u.exception.number||u.exception.code)||u.error&&u.error.number||u.errorCode||0),o={description:kt(u),stack:u&&(u.stack||u.exception&&(u.exception.stack||u.exception.message)||u.error&&u.error.stack||null),errorNumber:e,number:e};n._terminateApp(o,i)}}],backclick:[function(n,t){t?n._winRTBackPressedEvent.handled=!0:s.canGoBack&&(s.back(),n._winRTBackPressedEvent.handled=!0)}],beforerequestingfocusonkeyboardinput:[function(n,t){t||b({type:ut})}]};t.document&&t.document.addEventListener("DOMContentLoaded",nr,!1);p=r.Namespace._moduleDefine(n,"WinJS.Application",{stop:function(){p.onactivated=null;p.oncheckpoint=null;p.onerror=null;p.onloaded=null;p.onready=null;p.onsettings=null;p.onunload=null;p.onbackclick=null;d=new bt;o.sessionState={};st=!1;lt();rt&&rt.cancel();rt=null;w=null;rr();v.updateRegistration();ni()},addEventListener:function(n,t,i){d.addEventListener(n,t,i);n===ut&&v.updateRegistration()},removeEventListener:function(n,t,i){d.removeEventListener(n,t,i);n===ut&&v.updateRegistration()},checkpoint:function(){y({type:et})},start:function(){ir();st=!0;gi()},queueEvent:y,_dispatchEvent:b,_terminateApp:{get:function(){return ht},set:function(n){ht=n}},_applicationListener:r.Namespace._lazy(function(){return new a._GenericListener("Application",p)}),oncheckpoint:g(et),onunload:g(at),onactivated:g(ot),onloaded:g(vt),onready:g(yt),onsettings:g(pt),onerror:g(tt),onbackclick:g(wt)})}),t("WinJS/Animations/_Constants",["exports","../Core/_Base"],function(n,t){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{PageNavigationAnimation:{turnstile:"turnstile",slide:"slide",enterPage:"enterPage",continuum:"continuum"}})}),t("WinJS/Animations/_TransitionAnimation",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Promise","../Scheduler","../Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o){"use strict";function k(n){return Array.isArray(n)||n instanceof t.NodeList||n instanceof t.HTMLCollection?n:n?[n]:[]}function lt(){return++p,"WinJSUIAnimation"+p}function at(n){return"WinJSUIAnimation"===n.substring(0,16)}function d(n){t.getComputedStyle(n,null).opacity}function g(t,i){return function(r){var f={},e,u;for(e in r)u=r[e],typeof u=="function"&&(u=u(t,i)),f[e]=u;return f.exactTiming||(f.delay+=n._libraryDelay),f}}function yt(n,t){var r=n+"|"+t,i=w[r];i&&i(vt)}function nt(n,t,i){w[n+"|"+t]=i}function tt(n,t){delete w[n+"|"+t]}function rt(n,t,i,r,u){var f=u.styleCaches[t]||new it(t,u,i),e,o;return f.cref+=r.length,r.forEach(function(n){yt(t,n.property)}),(u.isTransition||r.some(function(n){return f.removed[n[u.nameField]]}))&&(d(n),f.removed={}),e=r.map(function(n){return n[u.nameField]+" "+u.props.map(function(t){return(t[1]?n[t[1]]:"")+t[2]}).join(" ")}).join(", "),o=r.map(function(n){return n[u.nameField]}).join(", "),f.names!==""&&(e=f.names+", "+e,o=f.names+", "+o),i[u.shorthandProp]=e,f.names=o,f}function ft(n,t){t?n():e.schedule(function(){n()},e.Priority.normal,null,"WinJS.UI._Animation._completeAnimationPromise")}function pt(n,i,r,e,s){var h,a,y,v;r.length>0&&(h=n.style,a=o._uniqueID(n),l||(l=t.document.createElement("DIV").style),r=r.map(g(i,n)),r.forEach(function(n){var t=u._getCamelCasedName(n.property);n.hasOwnProperty("from")&&(h[t]=n.from);l[t]=n.to;n.to=l[t];n.propertyScriptName=t}),s?(y=rt(n,a,h,r,ut),v=n.disabled?t.document:n,r.forEach(function(i){var r;e.push(new f(function(f){var e,o,s;r=function(r){e&&(v.removeEventListener(u._browserEventEquivalents.transitionEnd,e,!1),tt(a,i.property),y.removeName(h,i.propertyScriptName,r?n:null,i.skipStylesReset),t.clearTimeout(s),e=null);ft(f,r===c)};e=function(t){t.target===n&&t.propertyName===i.property&&r()};nt(a,i.property,r);v.addEventListener(u._browserEventEquivalents.transitionEnd,e,!1);o=0;h[i.propertyScriptName]!==i.to&&(h[i.propertyScriptName]=i.to,o=50);s=t.setTimeout(function(){s=t.setTimeout(r,i.delay+i.duration)},o)},function(){r(c)}))})):r.forEach(function(n){h[n.propertyScriptName]=n.to}))}function wt(n,i,r,e,h){var v,a,l,y,w;if(h&&r.length>0){v=n.style;a=o._uniqueID(n);r=r.map(g(i,n));y=n.disabled?t.document:n;r.forEach(function(n){if(n.keyframe)n.keyframe=s.animationPrefix+n.keyframe;else{l||(l=t.document.createElement("STYLE"),t.document.documentElement.appendChild(l));n.keyframe=lt();var i="@"+s.keyframes+" "+n.keyframe+" { from {"+n.property+":"+n.from+";} to {"+n.property+":"+n.to+";}}";l.sheet.insertRule(i,0)}});var k=rt(n,a,v,r,et),p=[],b=[];r.forEach(function(i){var r;b.push(new f(function(f){var e,o;r=function(n){e&&(y.removeEventListener(u._browserEventEquivalents.animationEnd,e,!1),t.clearTimeout(o),e=null);ft(f,n===c)};e=function(t){t.target===n&&t.animationName===i.keyframe&&r()};nt(a,i.property,r);p.push({id:a,property:i.property,style:v,keyframe:i.keyframe});o=t.setTimeout(function(){o=t.setTimeout(r,i.delay+i.duration)},50);y.addEventListener(u._browserEventEquivalents.animationEnd,e,!1)},function(){r(c)}))});l&&t.setTimeout(function(){var n=l.parentElement;n&&n.removeChild(l)},50);w=function(){for(var n,t=0;t<p.length;t++)n=p[t],tt(n.id,n.property),k.removeName(n.style,n.keyframe)};e.push(f.join(b).then(w,w))}}function bt(){v||(v=i.Windows.UI.ViewManagement.UISettings?new i.Windows.UI.ViewManagement.UISettings:{animationsEnabled:!0})}function ot(t,i,r){var u,h;try{var c=n.isAnimationEnabled(),o=k(t),l=k(i),s=[];for(u=0;u<o.length;u++)if(Array.isArray(o[u]))for(h=0;h<o[u].length;h++)r(o[u][h],u,l,s,c);else r(o[u],u,l,s,c);return s.length?f.join(s):e.schedulePromiseNormal(null,"WinJS.UI._Animation._completeActionPromise").then(null,function(){})}catch(a){return f.wrapError(a)}}function st(n){return Array.isArray(n)?n.map(function(n){return st(n)}):n?(n.delay=y(n.delay),n.duration=y(n.duration),n):void 0}function ht(n){return h===1?n:st(n)}var s,p,it,ut,l,et,a,v,b;if(t.document){s=u._browserStyleEquivalents;p=0;var w=[],vt=1,c=2;it=r.Class.define(function(n,t,i){this.cref=0;this.id=n;this.desc=t;this.removed={};this.prevStyles=t.props.map(function(n){return i[n[0]]});this.prevNames=this.names=i[t.nameProp];t.styleCaches[n]=this},{destroy:function(n,t){var i=this.desc;delete i.styleCaches[this.id];t||(this.prevNames===""&&this.prevStyles.every(function(n){return n===""})?n[i.shorthandProp]="":(i.props.forEach(function(t,i){n[t[0]]=this.prevStyles[i]},this),n[i.nameProp]=this.prevNames))},removeName:function(n,t,i,r){var u=this.names,f=u.split(", "),e=f.lastIndexOf(t);e>=0&&(f.splice(e,1),this.names=u=f.join(", "),u===""&&this.desc.isTransition&&(u="none"));--this.cref?(n[this.desc.nameProp]=u,at(t)||(this.removed[t]=!0)):(i&&u==="none"&&(n[this.desc.nameProp]=u,d(i)),this.destroy(n,r))}});ut={shorthandProp:s.transition.scriptName,nameProp:s["transition-property"].scriptName,nameField:"property",props:[[s["transition-duration"].scriptName,"duration","ms"],[s["transition-timing-function"].scriptName,"timing",""],[s["transition-delay"].scriptName,"delay","ms"]],isTransition:!0,styleCaches:[]};et={shorthandProp:s.animation.scriptName,nameProp:s["animation-name"].scriptName,nameField:"keyframe",props:[[s["animation-duration"].scriptName,"duration","ms"],[s["animation-timing-function"].scriptName,"timing",""],[s["animation-delay"].scriptName,"delay","ms"],[s["animation-iteration-count"].scriptName,"","1"],[s["animation-direction"].scriptName,"","normal"],[s["animation-fill-mode"].scriptName,"","both"]],isTransition:!1,styleCaches:[]};a=0;b=function(){return bt(),a+v.animationsEnabled>0};var y=function(n){return n*h},h=1,ct=0;r.Namespace._moduleDefine(n,"WinJS.UI",{disableAnimations:function(){a--},enableAnimations:function(){a++},isAnimationEnabled:{get:function(){return b},set:function(n){b=n}},_libraryDelay:{get:function(){return ct},set:function(n){ct=n}},executeAnimation:function(n,t){return ot(n,ht(t),wt)},executeTransition:function(n,t){return ot(n,ht(t),pt)},_animationTimeAdjustment:{get:function(){return y},set:function(n){y=n}}});r.Namespace._moduleDefine(n,"WinJS.Utilities",{_fastAnimations:{get:function(){return h===1/20},set:function(n){h=n?1/20:1}},_slowAnimations:{get:function(){return h===3},set:function(n){h=n?3:1}},_animationFactor:{get:function(){return h},set:function(n){h=n}}})}}),t("WinJS/Animations",["exports","./Core/_Global","./Core/_Base","./Core/_BaseUtils","./Core/_WriteProfilerMark","./Animations/_Constants","./Animations/_TransitionAnimation","./Promise"],function(n,t,i,r,u,f,e,o){"use strict";function tt(n,t,i){return n.keyframe?n.keyframe:!i||n.left!==t.left||n.top!==t.top||n.rtlflip&&!t.rtlflip?null:n.rtlflip?it(i):i}function ot(n,t){return!t||!n.rtlflip?t:it(t)}function it(n){var i=n+"-rtl";return function(r,u){return t.getComputedStyle(u).direction==="ltr"?n:i}}function v(n){return Array.isArray(n)||n instanceof t.NodeList||n instanceof t.HTMLCollection?n:n?[n]:[]}function rt(n){for(var r,u,f=[],i=0;i<n.length;i++)r={top:n[i].offsetTop,left:n[i].offsetLeft},u=t.getComputedStyle(n[i],null)[h.scriptName].split(","),u.length===6&&(r.left+=parseFloat(u[4]),r.top+=parseFloat(u[5])),f.push(r);return f}function a(n,t,i,r){return function(u){for(var f=n,e=0;e<u;e++)t*=i,f+=t;return r&&(f=Math.min(f,r)),f}}function ut(n,t){for(var i=0;i<t.length;i++)t[i].top-=n[i].offsetTop,t[i].left-=n[i].offsetLeft}function y(n,t,i){ut(n,t);for(var r=0;r<n.length;r++)(t[r].top!==0||t[r].left!==0)&&(n[r].style[h.scriptName]="translate("+t[r].left+"px, "+t[r].top+"px)");return e.executeTransition(n,i)}function k(n,t,i,r,u,f,o,s){function y(n,t,i){var u,f,r,e;if(n)if(u={left:t+"px",top:"0px"},f={left:i+"px",top:"0px"},+n.length===n.length)for(r=0,e=n.length;r<e;r++)w.push(n[r]),a.push(u),v.push(f);else w.push(n),a.push(u),v.push(f)}var w=[],a=[],v=[],p=200,b=t!==0?t<0?-p:p:0,k=i!==0?i<0?-p:p:0;return y(u,t,i),y(f,b,k),y(o,b*2,k*2),y(s,b*3,k*3),a=new l(a),v=new l(v),e.executeTransition(w,[{property:h.cssName,delay:0,duration:350,timing:n,from:c(a),to:c(v)},{property:"opacity",delay:0,duration:350,timing:r?"steps(1, start)":"steps(1, end)",from:r?0:1,to:r?1:0}])}function p(n,i,u){function h(){st(n)}var f,o,s;for(n=v(n),i=v(i),f=0,o=n.length;f<o;f++)s=t.getComputedStyle(n[f]).direction==="rtl",n[f].style[r._browserStyleEquivalents["transform-origin"].scriptName]=i[Math.min(i.length-1,f)][s?"rtl":"ltr"];return e.executeTransition(n,u).then(h,h)}function st(n){for(var t=0,i=n.length;t<i;t++)n[t].style[r._browserStyleEquivalents["transform-origin"].scriptName]="",n[t].style[h.scriptName]="",n[t].style.opacity=""}function c(n,i){return i=i||"",function(r,u){var e=n.getOffset(r),f=e.left;return e.rtlflip&&t.getComputedStyle(u).direction==="rtl"&&(f=f.toString(),f=f.charAt(0)==="-"?f.substring(1):"-"+f),i+"translate("+f+", "+e.top+")"}}function ft(n,t){return t=t||"",function(i){var r=n[i];return"translate("+r.left+"px, "+r.top+"px) "+t}}function ht(n,t){return function(i){var r=n[i];return r.left===0&&r.top===0?t:null}}function w(n,t,i,r){var f=v(t),u=v(i),e=rt(u);return new n(f,u,e,r)}function d(n){for(var u=[],i=0,e=n.length;i<e;i++){var r=n[i].getBoundingClientRect(),o=-(40+r.left),s=40+(t.innerWidth-r.right),f=t.innerHeight/2-r.top;u.push({ltr:o+"px "+f+"px",rtl:s+"px "+f+"px"})}return u}function s(n){u("WinJS.UI.Animation:"+n)}function b(n,i){var f=i.duration*e._animationFactor,s=r._browserStyleEquivalents.transition.scriptName,u;return n.style[s]=f+"ms "+h.cssName+" "+i.timing,n.style[h.scriptName]=i.to,new o(function(i){var o=function(t){t.target===n&&t.propertyName===h.cssName&&u()},c=!1,e;u=function(){c||(t.clearTimeout(e),n.removeEventListener(r._browserEventEquivalents.transitionEnd,o),n.style[s]="",c=!0);i()};e=t.setTimeout(function(){e=t.setTimeout(u,f)},50);n.addEventListener(r._browserEventEquivalents.transitionEnd,o)},function(){u()})}function g(){return{defaultResizeGrowTransition:{duration:350,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)"},defaultResizeShrinkTransition:{duration:120,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}}}function nt(n,i,u){var c=g()[u.to>u.from?"defaultResizeGrowTransition":"defaultResizeShrinkTransition"],f,e,o,s,l,a;return u=r._merge(u,{duration:u.duration===undefined?c.duration:u.duration,timing:u.timing===undefined?c.timing:u.timing}),f=u.actualSize-u.from,e=u.actualSize-u.to,u.anchorTrailingEdge||(f=-f,e=-e),o=u.dimension==="width"?"translateX":"translateY",s={duration:u.duration,timing:u.timing},n.style[h.scriptName]=o+"("+f+"px)",i.style[h.scriptName]=o+"("+-f+"px)",t.getComputedStyle(n).opacity,t.getComputedStyle(i).opacity,l=r._merge(s,{to:o+"("+e+"px)"}),a=r._merge(s,{to:o+"("+-e+"px)"}),[{element:n,transition:l},{element:i,transition:a}]}var h=r._browserStyleEquivalents.transform,et=[{top:"0px",left:"11px",rtlflip:!0}],l=i.Class.define(function(n,t,i){i=i||et;Array.isArray(n)&&n.length>0?(this.offsetArray=n,n.length===1&&(this.keyframe=tt(n[0],i[0],t))):n&&n.hasOwnProperty("top")&&n.hasOwnProperty("left")?(this.offsetArray=[n],this.keyframe=tt(n,i[0],t)):(this.offsetArray=i,this.keyframe=ot(i[0],t))},{getOffset:function(n){return n>=this.offsetArray.length&&(n=this.offsetArray.length-1),this.offsetArray[n]}},{supportedForProcessing:!1}),ct=i.Class.define(function(n,t,i){this.revealedArray=n;this.affectedArray=t;this.offsetArray=i},{execute:function(){s("expandAnimation,StartTM");var n=e.executeAnimation(this.revealedArray,{keyframe:"WinJS-opacity-in",property:"opacity",delay:this.affectedArray.length>0?200:0,duration:167,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1}),t=y(this.affectedArray,this.offsetArray,{property:h.cssName,delay:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([n,t]).then(function(){s("expandAnimation,StopTM")})}},{supportedForProcessing:!1}),lt=i.Class.define(function(n,t,i){this.hiddenArray=n;this.affectedArray=t;this.offsetArray=i},{execute:function(){s("collapseAnimation,StartTM");var n=e.executeAnimation(this.hiddenArray,{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:167,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:1,to:0}),t=y(this.affectedArray,this.offsetArray,{property:h.cssName,delay:this.hiddenArray.length>0?167:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([n,t]).then(function(){s("collapseAnimation,StopTM")})}},{supportedForProcessing:!1}),at=i.Class.define(function(n,t,i){this.elementArray=t;this.offsetArray=i},{execute:function(){return s("repositionAnimation,StartTM"),y(this.elementArray,this.offsetArray,{property:h.cssName,delay:a(0,33,1,250),duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}).then(function(){s("repositionAnimation,StopTM")})}},{supportedForProcessing:!1}),vt=i.Class.define(function(n,t,i){this.addedArray=n;this.affectedArray=t;this.offsetArray=i},{execute:function(){s("addToListAnimation,StartTM");var n=this.affectedArray.length>0?240:0,t=e.executeAnimation(this.addedArray,[{keyframe:"WinJS-scale-up",property:h.cssName,delay:n,duration:120,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:"scale(0.85)",to:"none"},{keyframe:"WinJS-opacity-in",property:"opacity",delay:n,duration:120,timing:"linear",from:0,to:1}]),i=y(this.affectedArray,this.offsetArray,{property:h.cssName,delay:0,duration:400,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([t,i]).then(function(){s("addToListAnimation,StopTM")})}},{supportedForProcessing:!1}),yt=i.Class.define(function(n,t,i){this.deletedArray=n;this.remainingArray=t;this.offsetArray=i},{execute:function(){s("deleteFromListAnimation,StartTM");var n=e.executeAnimation(this.deletedArray,[{keyframe:"WinJS-scale-down",property:h.cssName,delay:0,duration:120,timing:"cubic-bezier(0.11, 0.5, 0.24, .96)",from:"none",to:"scale(0.85)"},{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:120,timing:"linear",from:1,to:0}]),t=y(this.remainingArray,this.offsetArray,{property:h.cssName,delay:this.deletedArray.length>0?60:0,duration:400,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([n,t]).then(function(){s("deleteFromListAnimation,StopTM")})}},{supportedForProcessing:!1}),pt=i.Class.define(function(n,t,i,r){this.addedArray=n;this.affectedArray=t;this.offsetArray=i;var u=v(r);this.deletedArray=u;this.deletedOffsetArray=rt(u)},{execute:function(){var n,t,i,r;return s("_updateListAnimation,StartTM"),ut(this.deletedArray,this.deletedOffsetArray),n=0,t=e.executeAnimation(this.deletedArray,[{keyframe:ht(this.deletedOffsetArray,"WinJS-scale-down"),property:h.cssName,delay:0,duration:120,timing:"cubic-bezier(0.11, 0.5, 0.24, .96)",from:ft(this.deletedOffsetArray),to:ft(this.deletedOffsetArray,"scale(0.85)")},{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:120,timing:"linear",from:1,to:0}]),this.deletedArray.length>0&&(n+=60),i=y(this.affectedArray,this.offsetArray,{property:h.cssName,delay:n,duration:400,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}),this.affectedArray.length>0?n+=240:n&&(n+=60),r=e.executeAnimation(this.addedArray,[{keyframe:"WinJS-scale-up",property:h.cssName,delay:n,duration:120,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:"scale(0.85)",to:"none"},{keyframe:"WinJS-opacity-in",property:"opacity",delay:n,duration:120,timing:"linear",from:0,to:1}]),o.join([t,i,r]).then(function(){s("_updateListAnimation,StopTM")})}},{supportedForProcessing:!1}),wt=i.Class.define(function(n,t,i){this.addedArray=n;this.affectedArray=t;this.offsetArray=i},{execute:function(){s("addToSearchListAnimation,StartTM");var n=e.executeAnimation(this.addedArray,{keyframe:"WinJS-opacity-in",property:"opacity",delay:this.affectedArray.length>0?240:0,duration:117,timing:"linear",from:0,to:1}),t=y(this.affectedArray,this.offsetArray,{property:h.cssName,delay:0,duration:400,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([n,t]).then(function(){s("addToSearchListAnimation,StopTM")})}},{supportedForProcessing:!1}),bt=i.Class.define(function(n,t,i){this.deletedArray=n;this.remainingArray=t;this.offsetArray=i},{execute:function(){s("deleteFromSearchListAnimation,StartTM");var n=e.executeAnimation(this.deletedArray,{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:93,timing:"linear",from:1,to:0}),t=y(this.remainingArray,this.offsetArray,{property:h.cssName,delay:this.deletedArray.length>0?60:0,duration:400,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([n,t]).then(function(){s("deleteFromSearchListAnimation,StopTM")})}},{supportedForProcessing:!1}),kt=i.Class.define(function(n,t,i){this.elementArray=t;this.offsetArray=i},{execute:function(){return s("peekAnimation,StartTM"),y(this.elementArray,this.offsetArray,{property:h.cssName,delay:0,duration:2e3,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}).then(function(){s("peekAnimation,StopTM")})}},{supportedForProcessing:!1});i.Namespace._moduleDefine(n,"WinJS.UI.Animation",{createExpandAnimation:function(n,t){return w(ct,n,t)},createCollapseAnimation:function(n,t){return w(lt,n,t)},createRepositionAnimation:function(n){return w(at,null,n)},fadeIn:function(n){return s("fadeIn,StartTM"),e.executeTransition(n,{property:"opacity",delay:0,duration:250,timing:"linear",from:0,to:1}).then(function(){s("fadeIn,StopTM")})},fadeOut:function(n){return s("fadeOut,StartTM"),e.executeTransition(n,{property:"opacity",delay:0,duration:167,timing:"linear",to:0}).then(function(){s("fadeOut,StopTM")})},createAddToListAnimation:function(n,t){return w(vt,n,t)},createDeleteFromListAnimation:function(n,t){return w(yt,n,t)},_createUpdateListAnimation:function(n,t,i){return w(pt,n,i,t)},createAddToSearchListAnimation:function(n,t){return w(wt,n,t)},createDeleteFromSearchListAnimation:function(n,t){return w(bt,n,t)},showEdgeUI:function(n,t,i){s("showEdgeUI,StartTM");var u=i&&i.mechanism==="transition",r=new l(t,"WinJS-showEdgeUI",[{top:"-70px",left:"0px"}]);return e[u?"executeTransition":"executeAnimation"](n,{keyframe:r.keyframe,property:h.cssName,delay:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:u?c(r):r.keyframe||c(r),to:"none"}).then(function(){s("showEdgeUI,StopTM")})},showPanel:function(n,t){s("showPanel,StartTM");var i=new l(t,"WinJS-showPanel",[{top:"0px",left:"364px",rtlflip:!0}]);return e.executeAnimation(n,{keyframe:i.keyframe,property:h.cssName,delay:0,duration:550,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:i.keyframe||c(i),to:"none"}).then(function(){s("showPanel,StopTM")})},hideEdgeUI:function(n,t,i){s("hideEdgeUI,StartTM");var u=i&&i.mechanism==="transition",r=new l(t,"WinJS-hideEdgeUI",[{top:"-70px",left:"0px"}]);return e[u?"executeTransition":"executeAnimation"](n,{keyframe:r.keyframe,property:h.cssName,delay:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:"none",to:u?c(r):r.keyframe||c(r)}).then(function(){s("hideEdgeUI,StopTM")})},hidePanel:function(n,t){s("hidePanel,StartTM");var i=new l(t,"WinJS-hidePanel",[{top:"0px",left:"364px",rtlflip:!0}]);return e.executeAnimation(n,{keyframe:i.keyframe,property:h.cssName,delay:0,duration:550,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:"none",to:i.keyframe||c(i)}).then(function(){s("hidePanel,StopTM")})},showPopup:function(n,t){s("showPopup,StartTM");var i=new l(t,"WinJS-showPopup",[{top:"50px",left:"0px"}]);return e.executeAnimation(n,[{keyframe:"WinJS-opacity-in",property:"opacity",delay:83,duration:83,timing:"linear",from:0,to:1},{keyframe:i.keyframe,property:h.cssName,delay:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:i.keyframe||c(i),to:"none"}]).then(function(){s("showPopup,StopTM")})},hidePopup:function(n){return s("hidePopup,StartTM"),e.executeAnimation(n,{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:83,timing:"linear",from:1,to:0}).then(function(){s("hidePopup,StopTM")})},pointerDown:function(n){return s("pointerDown,StartTM"),e.executeTransition(n,{property:h.cssName,delay:0,duration:167,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:"scale(0.975, 0.975)"}).then(function(){s("pointerDown,StopTM")})},pointerUp:function(n){return s("pointerUp,StartTM"),e.executeTransition(n,{property:h.cssName,delay:0,duration:167,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}).then(function(){s("pointerUp,StopTM")})},dragSourceStart:function(n,t){s("dragSourceStart,StartTM");var i=e.executeTransition(n,[{property:h.cssName,delay:0,duration:240,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:"scale(1.05)"},{property:"opacity",delay:0,duration:240,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:.65}]),r=e.executeTransition(t,{property:h.cssName,delay:0,duration:240,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:"scale(0.95)"});return o.join([i,r]).then(function(){s("dragSourceStart,StopTM")})},dragSourceEnd:function(n,t,i){s("dragSourceEnd,StartTM");var r=new l(t,"WinJS-dragSourceEnd"),u=e.executeTransition(n,[{property:h.cssName,delay:0,duration:500,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""},{property:"opacity",delay:0,duration:500,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:1}]),f=e.executeAnimation(n,{keyframe:r.keyframe,property:h.cssName,delay:0,duration:500,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:r.keyframe||c(r,"scale(1.05) "),to:"none"}),a=e.executeTransition(i,{property:h.cssName,delay:0,duration:500,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""});return o.join([u,f,a]).then(function(){s("dragSourceEnd,StopTM")})},enterContent:function(n,t,i){var u,r,f,a;return s("enterContent,StartTM"),r=new l(t,"WinJS-enterContent",[{top:"28px",left:"0px",rtlflip:!1}]),i&&i.mechanism==="transition"?u=e.executeTransition(n,[{property:h.cssName,delay:0,duration:550,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:c(r),to:"none"},{property:"opacity",delay:0,duration:170,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1}]):(f=e.executeAnimation(n,{keyframe:r.keyframe,property:h.cssName,delay:0,duration:550,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:r.keyframe||c(r),to:"none"}),a=e.executeTransition(n,{property:"opacity",delay:0,duration:170,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1}),u=o.join([f,a])),u.then(function(){s("enterContent,StopTM")})},exitContent:function(n,t){s("exitContent,StartTM");var i=new l(t,"WinJS-exit",[{top:"0px",left:"0px"}]),r=e.executeAnimation(n,t&&{keyframe:i.keyframe,property:h.cssName,delay:0,duration:117,timing:"linear",from:"none",to:i.keyframe||c(i)}),u=e.executeTransition(n,{property:"opacity",delay:0,duration:117,timing:"linear",to:0});return o.join([r,u]).then(function(){s("exitContent,StopTM")})},dragBetweenEnter:function(n,t){s("dragBetweenEnter,StartTM");var i=new l(t,null,[{top:"-40px",left:"0px"},{top:"40px",left:"0px"}]);return e.executeTransition(n,{property:h.cssName,delay:0,duration:200,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:c(i,"scale(0.95) ")}).then(function(){s("dragBetweenEnter,StopTM")})},dragBetweenLeave:function(n){return s("dragBetweenLeave,StartTM"),e.executeTransition(n,{property:h.cssName,delay:0,duration:200,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:"scale(0.95)"}).then(function(){s("dragBetweenLeave,StopTM")})},swipeSelect:function(n,t){s("swipeSelect,StartTM");var i=e.executeTransition(n,{property:h.cssName,delay:0,duration:300,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}),r=e.executeAnimation(t,{keyframe:"WinJS-opacity-in",property:"opacity",delay:0,duration:300,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1});return o.join([i,r]).then(function(){s("swipeSelect,StopTM")})},swipeDeselect:function(n,t){s("swipeDeselect,StartTM");var i=e.executeTransition(n,{property:h.cssName,delay:0,duration:300,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}),r=e.executeAnimation(t,{keyframe:"WinJS-opacity-out",property:"opacity",delay:0,duration:300,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:1,to:0});return o.join([i,r]).then(function(){s("swipeDeselect,StopTM")})},swipeReveal:function(n,t){s("swipeReveal,StartTM");var i=new l(t,null,[{top:"25px",left:"0px"}]);return e.executeTransition(n,{property:h.cssName,delay:0,duration:300,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:c(i)}).then(function(){s("swipeReveal,StopTM")})},enterPage:function(n,t){s("enterPage,StartTM");var i=new l(t,"WinJS-enterPage",[{top:"28px",left:"0px",rtlflip:!1}]),r=e.executeAnimation(n,{keyframe:i.keyframe,property:h.cssName,delay:a(0,83,1,333),duration:1e3,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:i.keyframe||c(i),to:"none"}),u=e.executeTransition(n,{property:"opacity",delay:a(0,83,1,333),duration:170,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1});return o.join([r,u]).then(function(){s("enterPage,StopTM")})},exitPage:function(n,t){s("exitPage,StartTM");var i=new l(t,"WinJS-exit",[{top:"0px",left:"0px"}]),r=e.executeAnimation(n,t&&{keyframe:i.keyframe,property:h.cssName,delay:0,duration:117,timing:"linear",from:"none",to:i.keyframe||c(i)}),u=e.executeTransition(n,{property:"opacity",delay:0,duration:117,timing:"linear",to:0});return o.join([r,u]).then(function(){s("exitPage,StopTM")})},crossFade:function(n,t){s("crossFade,StartTM");var i=e.executeTransition(n,{property:"opacity",delay:0,duration:167,timing:"linear",to:1}),r=e.executeTransition(t,{property:"opacity",delay:0,duration:167,timing:"linear",to:0});return o.join([i,r]).then(function(){s("crossFade,StopTM")})},createPeekAnimation:function(n){return w(kt,null,n)},updateBadge:function(n,t){s("updateBadge,StartTM");var i=new l(t,"WinJS-updateBadge",[{top:"24px",left:"0px"}]);return e.executeAnimation(n,[{keyframe:"WinJS-opacity-in",property:"opacity",delay:0,duration:367,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1},{keyframe:i.keyframe,property:h.cssName,delay:0,duration:1333,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:i.keyframe||c(i),to:"none"}]).then(function(){s("updateBadge,StopTM")})},turnstileForwardIn:function(n){s("turnstileForwardIn,StartTM");n=v(n);var t=d(n);return p(n,t,[{property:h.cssName,delay:a(0,50,1,1e3),duration:300,timing:"cubic-bezier(0.01,0.975,0.4775,0.9775)",from:"perspective(600px) rotateY(80deg)",to:"perspective(600px) rotateY(0deg)"},{property:"opacity",delay:a(0,50,1,1e3),duration:300,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]).then(function(){s("turnstileForwardIn,StopTM")})},turnstileForwardOut:function(n){s("turnstileForwardOut,StartTM");n=v(n);var t=d(n);return p(n,t,[{property:h.cssName,delay:a(0,50,1,1e3),duration:128,timing:"cubic-bezier(0.4925,0.01,0.7675,-0.01)",from:"perspective(600px) rotateY(0deg)",to:"perspective(600px) rotateY(-50deg)"},{property:"opacity",delay:a(0,50,1,1e3),duration:128,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}]).then(function(){s("turnstileForwardOut,StopTM")})},turnstileBackwardIn:function(n){s("turnstileBackwardIn,StartTM");n=v(n);var t=d(n);return p(n,t,[{property:h.cssName,delay:a(0,50,1,1e3),duration:300,timing:"cubic-bezier(0.01,0.975,0.4775,0.9775)",from:"perspective(600px) rotateY(-50deg)",to:"perspective(600px) rotateY(0deg)"},{property:"opacity",delay:a(0,50,1,1e3),duration:300,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]).then(function(){s("turnstileBackwardIn,StopTM")})},turnstileBackwardOut:function(n){s("turnstileBackwardOut,StartTM");n=v(n);var t=d(n);return p(n,t,[{property:h.cssName,delay:a(0,50,1,1e3),duration:128,timing:"cubic-bezier(0.4925,0.01,0.7675,-0.01)",from:"perspective(800px) rotateY(0deg)",to:"perspective(800px) rotateY(80deg)"},{property:"opacity",delay:a(0,50,1,1e3),duration:128,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}]).then(function(){s("turnstileBackwardOut,StopTM")})},slideDown:function(n){return s("slideDown,StartTM"),p(n,{ltr:"",rtl:""},[{property:h.cssName,delay:0,duration:250,timing:"cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",from:"translate(0px, 0px)",to:"translate(0px, 200px)"},{property:"opacity",delay:0,duration:250,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}]).then(function(){s("slideDown,StopTM")})},slideUp:function(n){return s("slideUp,StartTM"),p(n,{ltr:"",rtl:""},[{property:h.cssName,delay:0,duration:350,timing:"cubic-bezier(0.17,0.79,0.215,1.0025)",from:"translate(0px, 200px)",to:"translate(0px, 0px)"},{property:"opacity",delay:a(0,34,1,1e3),duration:350,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]).then(function(){s("slideUp,StopTM")})},slideRightIn:function(n,i,r,u){return s("slideRightIn,StartTM"),k("cubic-bezier(0.17,0.79,0.215,1.0025)",-t.innerWidth,0,!0,n,i,r,u).then(function(){s("slideRightIn,StopTM")})},slideRightOut:function(n,i,r,u){return s("slideRightOut,StartTM"),k("cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",0,t.innerWidth,!1,n,i,r,u).then(function(){s("slideRightOut,StopTM")})},slideLeftIn:function(n,i,r,u){return s("slideLeftIn,StartTM"),k("cubic-bezier(0.17,0.79,0.215,1.0025)",t.innerWidth,0,!0,n,i,r,u).then(function(){s("slideLeftIn,StopTM")})},slideLeftOut:function(n,i,r,u){return s("slideLeftOut,StartTM"),k("cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",0,-t.innerWidth,!1,n,i,r,u).then(function(){s("slideLeftOut,StopTM")})},continuumForwardIn:function(n,t,i){return s("continuumForwardIn,StartTM"),o.join([e.executeTransition(n,[{property:h.cssName,delay:0,duration:350,timing:"cubic-bezier(0.33, 0.18, 0.11, 1)",from:"scale(0.5, 0.5)",to:"scale(1.0, 1.0)"},{property:"opacity",delay:0,duration:350,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]),e.executeTransition(t,[{property:h.cssName,delay:0,duration:350,timing:"cubic-bezier(0.24,1.15,0.11,1.1575)",from:"translate(0px, 225px)",to:"translate(0px, 0px)"},{property:"opacity",delay:0,duration:350,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]),p(i,{ltr:"0px 50%",rtl:"100% 50%"},[{property:h.cssName,delay:0,duration:350,timing:"cubic-bezier(0,0.62,0.8225,0.9625)",from:"rotateX(80deg) scale(1.5, 1.5)",to:"rotateX(0deg) scale(1.0, 1.0)"},{property:"opacity",delay:0,duration:350,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}])]).then(function(){s("continuumForwardIn,StopTM")})},continuumForwardOut:function(n,t){return s("continuumForwardOut,StartTM"),o.join([e.executeTransition(n,[{property:h.cssName,delay:0,duration:120,timing:"cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",from:"scale(1.0, 1.0)",to:"scale(1.1, 1.1)"},{property:"opacity",delay:0,duration:120,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}]),p(t,{ltr:"0px 100%",rtl:"100% 100%"},[{property:h.cssName,delay:0,duration:152,timing:"cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",from:"rotateX(0deg) scale(1.0, 1.0) translate(0px, 0px)",to:"rotateX(80deg) scale(1.5, 1.5) translate(0px, 150px)"},{property:"opacity",delay:0,duration:152,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}])]).then(function(){s("continuumForwardOut,StopTM")})},continuumBackwardIn:function(n,t){return s("continuumBackwardIn,StartTM"),o.join([e.executeTransition(n,[{property:h.cssName,delay:0,duration:200,timing:"cubic-bezier(0.33, 0.18, 0.11, 1)",from:"scale(1.25, 1.25)",to:"scale(1.0, 1.0)"},{property:"opacity",delay:0,duration:200,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}]),p(t,{ltr:"0px 50%",rtl:"100% 50%"},[{property:h.cssName,delay:0,duration:250,timing:"cubic-bezier(0.2975, 0.7325, 0.4725, 0.99)",from:"rotateX(80deg) translate(0px, -100px)",to:"rotateX(0deg) translate(0px, 0px)"},{property:"opacity",delay:0,duration:250,timing:"cubic-bezier(0, 2, 0, 2)",from:0,to:1}])]).then(function(){s("continuumBackwardIn,StopTM")})},continuumBackwardOut:function(n){return s("continuumBackwardOut,StartTM"),e.executeTransition(n,[{property:h.cssName,delay:0,duration:167,timing:"cubic-bezier(0.3825,0.0025,0.8775,-0.1075)",from:"scale(1.0, 1.0)",to:"scale(0.5, 0.5)"},{property:"opacity",delay:0,duration:167,timing:"cubic-bezier(1,-0.42,0.995,-0.425)",from:1,to:0}]).then(function(){s("continuumBackwardOut,StopTM")})},drillInIncoming:function(n){return s("drillInIncoming,StartTM"),e.executeTransition(n,[{property:h.cssName,delay:0,duration:500,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:"scale(0.84)",to:"scale(1.0)"},{property:"opacity",delay:0,duration:500,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:0,to:1}]).then(function(){s("drillInIncoming,StopTM")})},drillInOutgoing:function(n){return s("drillInOutgoing,StartTM"),e.executeTransition(n,[{property:h.cssName,delay:0,duration:233,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:"scale(1.0)",to:"scale(1.29)"},{property:"opacity",delay:0,duration:233,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:1,to:0}]).then(function(){s("drillInOutgoing,StopTM")})},drillOutIncoming:function(n){return s("drillOutIncoming,StartTM"),e.executeTransition(n,[{property:h.cssName,delay:0,duration:500,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:"scale(1.29)",to:"scale(1.0)"},{property:"opacity",delay:0,duration:500,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:0,to:1}]).then(function(){s("drillOutIncoming,StopTM")})},drillOutOutgoing:function(n){return s("drillOutOutgoing,StartTM"),e.executeTransition(n,[{property:h.cssName,delay:0,duration:233,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:"scale(1.0)",to:"scale(0.84)"},{property:"opacity",delay:0,duration:233,timing:"cubic-bezier(0.1,0.9,0.2,1)",from:1,to:0}]).then(function(){s("drillOutOutgoing,StopTM")})},createPageNavigationAnimations:function(){function t(){return o.wrap()}return{exit:t,entrance:n.enterPage}},_resizeTransition:function(n,t,i){var u,f,r,e;if(i.to===i.from)return o.as();for(u=nt(n,t,i),f=[],r=0,e=u.length;r<e;r++)f.push(b(u[r].element,u[r].transition));return o.join(f)},_commandingSurfaceOpenAnimation:function(n){var it=n.actionAreaClipper,e=n.actionArea,s=n.overflowAreaClipper,c=n.overflowArea,p=n.oldHeight,l=n.newHeight,w=n.overflowAreaHeight,a=n.menuPositionedAbove,v=l-p,i=[],k=g().defaultResizeGrowTransition,d,u,f,tt,y;for(a?(e.style[h.scriptName]="translateY("+v+"px)",t.getComputedStyle(e).opacity,d=r._merge(k,{to:"translateY(0px)"}),i.push({element:e,transition:d})):i=nt(it,e,{from:p,to:l,actualSize:l,dimension:"height",anchorTrailingEdge:!1}),s.style[h.scriptName]="translateY("+(a?v:-v)+"px)",c.style[h.scriptName]="translateY("+(a?w:-w)+"px)",t.getComputedStyle(s).opacity,t.getComputedStyle(c).opacity,u=[],f=0,tt=i.length;f<tt;f++)u.push(b(i[f].element,i[f].transition));return y=r._merge(k,{to:"translateY(0px)"}),u.push(b(s,y)),u.push(b(c,y)),o.join(u)},_commandingSurfaceCloseAnimation:function(n){var rt=n.actionAreaClipper,e=n.actionArea,s=n.overflowAreaClipper,c=n.overflowArea,l=n.oldHeight,p=n.newHeight,w=n.overflowAreaHeight,a=n.menuPositionedAbove,v=p-l,i=[],y=g().defaultResizeShrinkTransition,k,u,f,d,tt,it;for(a?(e.style[h.scriptName]="translateY(0px)",t.getComputedStyle(e).opacity,k=r._merge(y,{to:"translateY("+-v+"px)"}),i.push({element:e,transition:k})):i=nt(rt,e,{from:l,to:p,actualSize:l,dimension:"height",anchorTrailingEdge:!1}),s.style[h.scriptName]="translateY(0px)",c.style[h.scriptName]="translateY(0px)",t.getComputedStyle(s).opacity,t.getComputedStyle(c).opacity,u=[],f=0,d=i.length;f<d;f++)u.push(b(i[f].element,i[f].transition));return tt=r._merge(y,{to:"translateY("+(a?-v:v)+"px)"}),it=r._merge(y,{to:"translateY("+(a?w:-w)+"px)"}),u.push(b(s,tt)),u.push(b(c,it)),o.join(u)}})}),t("WinJS/Binding/_BindingParser",["exports","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../ControlProcessor/_OptionsLexer","../ControlProcessor/_OptionsParser"],function(n,t,i,r,u,f,e,o,s){"use strict";function v(n,t){e("WinJS.Binding:bindingParser,StartTM");var i=h.lexer(n),r=new c.BindingInterpreter(i,n,t||{}),u=r.run();return e("WinJS.Binding:bindingParser,StopTM"),u}function y(n){e("WinJS.Binding:bindingParser,StartTM");var t=h.lexer(n),i=new c.BindingParser(t,n),r=i.run();return e("WinJS.Binding:bindingParser,StopTM"),r}var l={get invalidBinding(){return"Invalid binding:'{0}'. Expected to be '<destProp>:<sourceProp>;'. {1}"},get bindingInitializerNotFound(){return"Initializer not found:'{0}'"}},h=t.Namespace.defineWithParent(null,null,{lexer:t.Namespace._lazy(function(){return o._optionsLexer}),tokenType:t.Namespace._lazy(function(){return o._optionsLexer.tokenType})}),a=i.requireSupportedForProcessing,c=t.Namespace.defineWithParent(null,null,{BindingInterpreter:t.Namespace._lazy(function(){return t.Class.derive(s.optionsParser._BaseInterpreter,function(n,t,i){this._initialize(n,t,i)},{_error:function(n){throw new r("WinJS.Binding.ParseError",f._formatString(l.invalidBinding,this._originalSource,n));},_evaluateInitializerName:function(){if(this._current.type===h.tokenType.identifier){var n=this._evaluateIdentifierExpression();return u.log&&!n&&u.log(f._formatString(l.bindingInitializerNotFound,this._originalSource),"winjs binding","error"),a(n)}return},_evaluateValue:function(){switch(this._current.type){case h.tokenType.stringLiteral:case h.tokenType.numberLiteral:var n=this._current.value;return this._read(),n;default:this._unexpectedToken(h.tokenType.stringLiteral,h.tokenType.numberLiteral);return}},_readBindDeclarations:function(){for(var n=[];;)switch(this._current.type){case h.tokenType.identifier:case h.tokenType.thisKeyword:n.push(this._readBindDeclaration());break;case h.tokenType.semicolon:this._read();break;case h.tokenType.eof:return n;default:this._unexpectedToken(h.tokenType.identifier,h.tokenType.semicolon,h.tokenType.eof);return}},_readBindDeclaration:function(){var i=this._readDestinationPropertyName(),n,t;return this._read(h.tokenType.colon),n=this._readSourcePropertyName(),t=this._evaluateInitializerName(),{destination:i,source:n,initializer:t}},_readDestinationPropertyName:function(){return this._readIdentifierExpression()},_readSourcePropertyName:function(){return this._readIdentifierExpression()},run:function(){return this._readBindDeclarations()}},{supportedForProcessing:!1})}),BindingParser:t.Namespace._lazy(function(){return t.Class.derive(c.BindingInterpreter,function(n,t){this._initialize(n,t,{})},{_readInitializerName:function(){if(this._current.type===h.tokenType.identifier)return this._readIdentifierExpression()},_readBindDeclaration:function(){var i=this._readDestinationPropertyName(),n,t;return this._read(h.tokenType.colon),n=this._readSourcePropertyName(),t=this._readInitializerName(),{destination:i,source:n,initializer:t}}},{supportedForProcessing:!1})})});t.Namespace._moduleDefine(n,"WinJS.Binding",{_bindingParser:v,_bindingParser2:y})}),t("WinJS/Binding/_DomWeakRefTable",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Scheduler"],function(n,t,i,r,u,f){"use strict";function v(){var t,r,n,u,i;for(s===0&&(o=0),t=Object.keys(e),r=Date.now()-l,n=0,u=t.length;n<u;n++)i=t[n],e[i].time<r&&delete e[i];y()}function p(){t.Debug&&t.Debug.debuggerEnabled&&h||o||(s===0?(f.schedule(v,f.Priority.idle,null,"WinJS.Utilities._DOMWeakRefTable.cleanup"),o=1):o=t.setInterval(v,s))}function y(){t.Debug&&t.Debug.debuggerEnabled&&h||(s===0?o||Object.keys(e).length!==0&&(f.schedule(v,f.Priority.idle,null,"WinJS.Utilities._DOMWeakRefTable.cleanup"),o=1):o&&Object.keys(e).length===0&&(t.clearInterval(o),o=0))}function w(n,t){return e[t]={element:n,time:Date.now()},p(),t}function b(n){var r,i;return a?(i=e[n],i?i.element:t.document.getElementById(n)):(r=t.document.getElementById(n),r?(delete e[n],y()):(i=e[n],i&&(i.time=Date.now(),r=i.element)),r)}var c;if(i.Windows.Foundation.Uri&&i.msSetWeakWinRTProperty&&i.msGetWeakWinRTProperty){c=new i.Windows.Foundation.Uri("about://blank");r.Namespace._moduleDefine(n,"WinJS.Utilities",{_createWeakRef:function(n,t){return i.msSetWeakWinRTProperty(c,t,n),t},_getWeakRefElement:function(n){return i.msGetWeakWinRTProperty(c,n)}});return}var s=500,l=1e3,e={},o,h=!0,a=!1;r.Namespace._moduleDefine(n,"WinJS.Utilities",{_DOMWeakRefTable_noTimeoutUnderDebugger:{get:function(){return h},set:function(n){h=n}},_DOMWeakRefTable_sweepPeriod:{get:function(){return s},set:function(n){s=n}},_DOMWeakRefTable_timeout:{get:function(){return l},set:function(n){l=n}},_DOMWeakRefTable_tableSize:{get:function(){return Object.keys(e).length}},_DOMWeakRefTable_fastLoadPath:{get:function(){return a},set:function(n){a=n}},_createWeakRef:w,_getWeakRefElement:b})}),t("WinJS/Binding/_Data",["exports","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Log","../Core/_Resources","../Promise","../Scheduler","./_DomWeakRefTable"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var a={get exceptionFromBindingInitializer(){return"Exception thrown from binding initializer: {0}"},get propertyIsUndefined(){return"{0} is undefined"},get unsupportedDataTypeForBinding(){return"Unsupported data type"}},v={_listeners:null,_pendingNotifications:null,_notifyId:0,_getObservable:function(){return this},_cancel:function(n){var r=this._pendingNotifications,f=!1,u,t,i;if(r)for(u=Object.keys(r),t=u.length-1;t>=0;t--)i=r[u[t]],i.target===n&&(i.promise&&(i.promise.cancel(),i.promise=null),delete r[u[t]],f=!0);return f},notify:function(n,t,i){var u=this._listeners&&this._listeners[n],r;if(u){r=this;r._cancel(n);r._pendingNotifications=r._pendingNotifications||{};var c=r._notifyId++,h=r._pendingNotifications[c]={target:n},l=function(){delete r._pendingNotifications[c]};return h.promise=s.schedulePromiseNormal(null,"WinJS.Binding.observableMixin.notify").then(function(){for(var n=0,r=u.length;n<r&&h.promise;n++)try{u[n](t,i)}catch(o){f.log&&f.log(e._formatString(a.exceptionFromBindingInitializer,o.toString()),"winjs binding","error")}return l(),t}),h.promise}return o.as()},bind:function(n,t){var i,u,r,f;for(this._listeners=this._listeners||{},i=this._listeners[n]=this._listeners[n]||[],u=!1,r=0,f=i.length;r<f;r++)if(i[r]===t){u=!0;break}return u||(i.push(t),t(p(this[n]))),this},unbind:function(n,t){var i,f,r,o,u,e;if(this._listeners=this._listeners||{},n&&t){if(i=this._listeners[n],i){for(r=0,o=i.length;r<o;r++)i[r]!==t&&(f=f||[]).push(i[r]);this._listeners[n]=f}}else n?(this._cancel(n),delete this._listeners[n]):(u=this,u._pendingNotifications&&(e=u._pendingNotifications,u._pendingNotifications={},Object.keys(e).forEach(function(n){var t=e[n];t.promise&&t.promise.cancel()})),this._listeners={});return this}},c={_backingData:null,_initObservable:function(n){this._backingData=n||{}},getProperty:function(n){var t=this._backingData[n];return f.log&&t===undefined&&f.log(e._formatString(a.propertyIsUndefined,n),"winjs binding","warn"),l(t)},setProperty:function(n,t){return this.updateProperty(n,t),this},addProperty:function(n,t){return this[n]||Object.defineProperty(this,n,{get:function(){return this.getProperty(n)},set:function(t){this.setProperty(n,t)},enumerable:!0,configurable:!0}),this.setProperty(n,t)},updateProperty:function(n,t){var r=this._backingData[n],i=p(t);return r!==i&&(this._backingData[n]=i,this._backingData[n]===i)?this.notify(n,i,r):o.as()},removeProperty:function(n){var t=this._backingData[n],i;try{delete this._backingData[n]}catch(r){}try{delete this[n]}catch(r){}return this.notify(n,i,t),this}};Object.keys(v).forEach(function(n){c[n]=v[n]});var d=function(n,t){return k(n,t)},g=0,w=function(){return"bindHandler"+g++},b=function(n,i){if(!t.msGetWeakWinRTProperty)return n;var r=w();return h._getWeakRefElement(i)[r]=n,function(n,t){var u=h._getWeakRefElement(i);u&&u[r](n,t)}},k=function(n,t,i){function o(){r&&r.forEach(function(n){n.source.unbind(n.prop,n.listener)});r=null}function e(n){u[n]&&(u[n].complexBind.cancel(),delete u[n])}var f,u,r;return(n=l(n),!n)?{cancel:function(){},empty:!0}:(i||(i=w(),f={},h._createWeakRef(f,i)),u={},r=null,Object.keys(t).forEach(function(o){var s=t[o],h;s instanceof Function?(s=b(s,i),s.bindState=f,r=r||[],r.push({source:n,prop:o,listener:s}),n.bind(o,s)):(h=function(n){var t,r;e(o);t=k(l(n),s,i);t.empty&&(r=function(n){Object.keys(n).forEach(function(t){var i=n[t];i instanceof Function?i(undefined,undefined):r(i)})},r(s));u[o]={source:n,complexBind:t}},h=b(h,i),h.bindState=f,r=r||[],r.push({source:n,prop:o,listener:h}),n.bind(o,h))}),{cancel:function(){o();Object.keys(u).forEach(function(n){e(n)})}})},nt=i.Class.mix(function(n){this._initObservable(n);Object.defineProperties(this,y(n))},c),y=function(n){function i(n){t[n]={get:function(){return this.getProperty(n)},set:function(t){this.setProperty(n,t)},enumerable:!0,configurable:!0}}for(var t={};n&&n!==Object.prototype;)Object.keys(n).forEach(i),n=Object.getPrototypeOf(n);return t},tt=function(n){if(!n||typeof n!="object"||n instanceof Date||Array.isArray(n))if(r.validation)throw new u("WinJS.Binding.UnsupportedDataType",e._formatString(a.unsupportedDataTypeForBinding));else return;return i.Class.mix(function(t){this._initObservable(t||Object.create(n))},c,y(n))},l=function(n){var i,t;return n?(i=typeof n,i!=="object"||n instanceof Date||Array.isArray(n)?n:n._getObservable?n._getObservable():(t=new nt(n),t.backingData=n,Object.defineProperty(n,"_getObservable",{value:function(){return t},enumerable:!1,writable:!1}),t)):n},p=function(n){return n&&n.backingData?n.backingData:n};i.Namespace._moduleDefine(n,"WinJS.Binding",{mixin:{value:c,enumerable:!1,writable:!0,configurable:!0},dynamicObservableMixin:{value:c,enumerable:!0,writable:!0,configurable:!0},observableMixin:{value:v,enumerable:!0,writable:!0,configurable:!0},expandProperties:y,define:tt,as:l,unwrap:p,bind:d})}),t("WinJS/Binding/_Declarative",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../Utilities/_ElementUtilities","./_BindingParser","./_Data","./_DomWeakRefTable"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function ht(n,t){var i=n._autoDispose;i&&i.push(t)}function ct(n){n._autoDispose=(n._autoDispose||[]).filter(function(n){return n()})}function g(n,t){if(n){if(n.winBindingToken===t)return n;e.log&&e.log(o._formatString(y.duplicateBindingDetected,n.id),"winjs binding","error")}else return n}function nt(n){if(n.winBindingToken)return n.winBindingToken;var t="_win_bind"+st++;return Object.defineProperty(n,"winBindingToken",{configurable:!1,writable:!1,enumerable:!1,value:t}),t}function lt(n,t,i,r,u,f,e){var o=n.initializer,s;if(o&&(o=o.winControl||o["data-win-control"]||o),o instanceof Function)return s=o(r,n.source,u,n.destination),e&&(s&&s.cancel?e.bindings.push(function(){s.cancel()}):e.nocache=!0),s;o&&o.render&&(f.count++,e&&(e.nocache=!0),p(o.render).call(o,w(r,n.source),u).then(function(){f.checkComplete()}))}function at(n,t,i,r,u,f){var c=!0,s,l=!1,h,a,p;return ct(r),h=function(){if(!l){var i=g(v._getWeakRefElement(n),t);return i||(e.log&&e.log(o._formatString(y.elementNotFound,n),"winjs binding","info"),s&&s.cancel()),i}},a=function(n){var t=h();t&&k(t,u.destination,n);c&&(i.checkComplete(),c=!1)},ht(r,h),s=it(r,u.source,a),s&&(p=s.cancel,s.cancel=function(){return l=!0,p.call(s)},f&&f.bindings.push(function(){s.cancel()})),s}function vt(n,i,r,u,f,e,o){var s;if(u!==t&&(u=a.as(u)),u._getObservable&&(s=u._getObservable()),s)return e.count++,at(i,r,e,s,n,o);k(f,n.destination,w(u,n.source))}function ut(n,t){for(var s,r,i=n.length-1;i>=0;i--)if(s=n[i],r=s.destination,r.length===1&&r[0]==="id"){if(u.validation)throw new f("WinJS.Binding.IdBindingNotSupported",o._formatString(y.idBindingNotSupported,t));e.log&&e.log(o._formatString(y.idBindingNotSupported,t),"winjs binding","error");n.splice(i,1)}return n}function yt(n,i){if(i){var u=i.expressions[n],r;return u||(r=ut(l._bindingParser(n,t),n),i.expressions[n]=r),r||(r=u),r}return ut(l._bindingParser(n,t),n)}function pt(n,i,r,u,f,e){var pt,tt,a,wt,o,b,bt,h,it,kt,k,rt,l,g,ut,et,dt,ht,ot;s("WinJS.Binding:processAll,StartTM");var y={count:0,checkComplete:function(){this.count--;this.count===0&&(s("WinJS.Binding:processAll,StopTM"),e())}},w=n||t.document.body,ct="[data-win-bind],[data-win-control]",at=w.querySelectorAll(ct),st;!r&&(w.getAttribute("data-win-bind")||w.winControl)&&(st=w);y.count++;pt=i||t;v._DOMWeakRefTable_fastLoadPath=!0;try{for(tt=c.data(w),tt.winBindings=tt.winBindings||[],a=st?-1:0,wt=at.length;a<wt;a++)if(o=a<0?st:at[a],o.winControl&&o.winControl.constructor&&o.winControl.constructor.isDeclarativeControlContainer&&(a+=o.querySelectorAll(ct).length,b=o.winControl.constructor.isDeclarativeControlContainer,typeof b=="function"&&(b=p(b),b(o.winControl,function(n){return ft(n,i,!1,u,f)}))),o.hasAttribute("data-win-bind")){if(bt=o.getAttribute("data-win-bind"),h=yt(bt,u),!h.implemented){for(it=0,kt=h.length;it<kt;it++)k=h[it],k.initializer=k.initializer||f,k.implementation=k.initializer?lt:vt;h.implemented=!0}for(y.count++,rt=nt(o),l=d?rt:o.id,l||(o.id=l=rt),v._createWeakRef(o,l),g=c.data(o),g.winBindings=null,u&&u.elements&&(ut=u.elements[l],ut||(u.elements[l]=ut={bindings:[]})),et=0,dt=h.length;et<dt;et++)ht=h[et],ot=ht.implementation(ht,l,rt,pt,o,y,ut),ot&&(g.winBindings=g.winBindings||[],g.winBindings.push(ot),tt.winBindings.push(ot));y.count--}}finally{v._DOMWeakRefTable_fastLoadPath=!1}y.checkComplete()}function ft(n,t,i,r,u){return new h(function(f,e,o){pt(n,t,i,r,u,f,e,o)}).then(null,function(n){return e.log&&e.log(o._formatString(y.errorInitializingBindings,n&&n.message),"winjs binding","error"),h.wrapError(n)})}function et(n){var i=function(i,r,u,f,s){var l=nt(u),h=d?l:u.id,tt,rt,c,b;if(h||(u.id=h=l),v._createWeakRef(u,h),i!==t&&(i=a.as(i)),i._getObservable&&(tt=i._getObservable()),tt)return rt=0,c=it(a.as(i),r,function(t){if(++rt!=1||t!==s){var i=g(v._getWeakRefElement(h),l);i?k(i,f,n(p(t))):c&&(e.log&&e.log(o._formatString(y.elementNotFound,h),"winjs binding","info"),c.cancel())}}),c;b=w(i,r);b!==s&&k(u,f,n(b))};return rt(i)}function w(n,i){if(n!==t&&(n=p(n)),i)for(var r=0,u=i.length;r<u&&n!==null&&n!==undefined;r++)n=p(n[i[r]]);return n}function k(n,i,r){var u,s,f;for(p(r),n=p(n),u=0,s=i.length-1;u<s;u++)if(n=p(n[i[u]]),n){if(n instanceof t.Node){e.log&&e.log(o._formatString(y.nestedDOMElementBindingNotSupported,i[u],i.join(".")),"winjs binding","error");return}}else{e.log&&e.log(o._formatString(y.propertyDoesNotExist,i[u],i.join(".")),"winjs binding","error");return}if(i.length===0){e.log&&e.log(y.cannotBindToThis,"winjs binding","error");return}f=i[i.length-1];e.log&&n[f]===undefined&&e.log(o._formatString(y.creatingNewProperty,f,i.join(".")),"winjs binding","warn");n[f]=r}function tt(n,t,i){if(n=p(n),!t||t.length!==1||!t[0]){e.log&&e.log(y.attributeBindingSingleProperty,"winjs binding","error");return}n.setAttribute(t[0],i)}function wt(n,i,r,u,f){var c=nt(r),s=d?c:r.id,l,k,h,b;if(s||(r.id=s=c),v._createWeakRef(r,s),n!==t&&(n=a.as(n)),n._getObservable&&(l=n._getObservable()),l)return k=0,h=it(l,i,function(n){if(++k!=1||n!==f){var t=g(v._getWeakRefElement(s),c);t?tt(t,u,p(n)):h&&(e.log&&e.log(o._formatString(y.elementNotFound,s),"winjs binding","info"),h.cancel())}}),h;b=w(n,i);b!==f&&tt(r,u,b)}function bt(n,t,i,r){return tt(i,r,w(n,t))}function kt(n,t,i){i=p(i);var r=w(n,t);Array.isArray(r)?r.forEach(function(n){c.addClass(i,n)}):r&&c.addClass(i,r)}function gt(n,t,i,r,u){return dt(n,t,i,r,u)}function it(n,t,i){var f,r,u,e;if(t.length>1){for(f={},r=f,u=0,e=t.length-1;u<e;u++)r=r[t[u]]={};return r[t[t.length-1]]=i,a.bind(n,f,!0)}if(t.length===1)return n.bind(t[0],i,!0),{cancel:function(){n.unbind(t[0],i);this.cancel=ot}};i(n)}function ot(){}function ni(n,t,i,r){return k(i,r,w(n,t)),{cancel:ot}}function b(n){return rt(n)}var st=Math.random()*1e3>>0,d=i.msSetWeakWinRTProperty&&i.msGetWeakWinRTProperty,y={get attributeBindingSingleProperty(){return'Attribute binding requires a single destination attribute name, often in the form "this[\'aria-label\']" or "width".'},get cannotBindToThis(){return"Can't bind to 'this'."},get creatingNewProperty(){return"Creating new property {0}. Full path:{1}"},get duplicateBindingDetected(){return"Binding against element with id {0} failed because a duplicate id was detected."},get elementNotFound(){return"Element not found:{0}"},get errorInitializingBindings(){return"Error initializing bindings: {0}"},get propertyDoesNotExist(){return"{0} doesn't exist. Full path:{1}"},get idBindingNotSupported(){return"Declarative binding to ID field is not supported. Initializer: {0}"},get nestedDOMElementBindingNotSupported(){return"Binding through a property {0} of type HTMLElement is not supported, Full path:{1}."}},rt=u.markSupportedForProcessing,p=u.requireSupportedForProcessing,dt=et(function(n){return n});r.Namespace._moduleDefine(n,"WinJS.Binding",{processAll:ft,oneTime:b(ni),defaultBind:b(gt),converter:et,initializer:b,getValue:w,setAttribute:b(wt),setAttributeOneTime:b(bt),addClassOneTime:b(kt)})}),t("WinJS/Binding",["./Binding/_BindingParser","./Binding/_Data","./Binding/_Declarative","./Binding/_DomWeakRefTable"],function(){}),t("WinJS/BindingTemplate/_DataTemplateCompiler",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Binding/_BindingParser","../Binding/_Declarative","../ControlProcessor","../ControlProcessor/_OptionsParser","../Fragments","../Promise","../_Signal","../Utilities/_Dispose","../Utilities/_SafeHtml","../Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";if(t.document){var k={get attributeBindingSingleProperty(){return'Attribute binding requires a single destination attribute name, often in the form "this[\'aria-label\']" or "width".'},get cannotBindToThis(){return"Can't bind to 'this'."},get idBindingNotSupported(){return"Declarative binding to ID field is not supported. Initializer: {0}"}};i.Namespace._moduleDefine(n,"WinJS.Binding",{_TemplateCompiler:i.Namespace._lazy(function(){function or(n,t,i){var r=b.data(n).bindTokens;r&&r.forEach(function(n){n&&n.cancel&&n.cancel()});t&&t.cancel();i&&i.cancel()}function sr(n,t){return function(i){return h.processAll(i,n,!1,null,t)}}function hr(n){return n=it(n),n instanceof t.Node?null:n}function ot(n,t){var i=n.indexOf("\n")!==-1,r=arguments;return n.replace(ar,function(f,e,o,s,h,c,l){var v,y,a;if(h||c)throw new u("Format:MalformedInputString","Did you forget to escape a: "+(h||c)+" at: "+l);if(e)return"{";if(o)return"}";if(y=+s,v=y===+y?r[y+1]:t[s],v===undefined)throw new u("Format:MissingPart","Missing part '"+s+"'");if(i){for(a=l;a>0&&n[--a]===" ";);a>=0&&n[a]==="\n"&&(v=tt(l-a-1,v))}return v})}function tt(n,t){for(var i="",r=0;r<n;r++)i+=" ";return t.split("\n").map(function(n,t){return t?i+n:n}).join("\n")}function rt(n){return n.trim()}function et(n){return n.join(";\n")}function ri(n){return n.join(", ")||"empty"}function st(t){return t.map(function(t){return t.match(bt)?"."+t:+t===t?ot("[{0}]",t):ot("[{0}]",n(t))}).join("")}function ui(t,i,r,u){var i=i.map(function(t){return t.match(bt)?"."+t:(+t===t&&(t=+t),pr(n(t)))}).map(function(n){return ot("{filter}({temp} = {temp}{part})",{filter:u,temp:r,part:n})});return i.unshift(fi(dt(r,t))),i.push(r),fi(i.join(" && "))}function n(n){return JSON.stringify(n)}function kt(n){return n?"new Array("+ +n+")":"[]"}function dt(n,t){return""+n+" = "+t}function fi(n){return"("+n+")"}function pr(n){return"["+n+"]"}function wr(t){return t.match(bt)?t:+t===t?+t:n(t)}function br(n){return n=""+n,n.replace(cr,function(n){return lr[n]||" "})}function ei(n,t,i){return i?new String(""+n+t+"_"+i):new String(""+n+t)}function oi(n){return n.replace(/\\n/g,"\\n\\\n")}function kr(n){return Object.keys(n)}function si(n){return Object.keys(n).map(function(t){return n[t]})}function hi(n,t){return ci([n,t])}function ci(n){for(var r,u,t,o,f,e={},i=0,s=n.length;i<s;i++)for(r=n[i],u=Object.keys(r),t=0,o=u.length;t<o;t++)f=u[t],e[f]=r[f];return e}function dr(n){return n.reduce(function(n,t){return n?it(n[t]):null},t)}function ht(n,t,i,r){var u=n.children,f,e,s,o,h;if(u){for(f=Object.keys(u),t&&i&&i(n,t,f.length),e=0,s=f.length;e<s;e++)o=f[e],h=u[o],ht(h,o,i,r);t&&r&&r(n,t,Object.keys(u).length)}else t&&i&&i(n,t,0),t&&r&&r(n,t,0)}function ft(n){return n.replace(/^\s*$/gm,"").replace(/^(.*[^\s])( *)$/gm,function(n,t){return t})}var bi=v._cancelBlocker,ni=h.defaultBind,at=h.oneTime,ki=h.setAttribute,vt=h.setAttributeOneTime,ti=h.addClassOneTime,di=v.as,it=r.requireSupportedForProcessing,gi=w.insertAdjacentHTMLUnsafe,nr=b.data,tr=p.markDisposable,ir=c.processAll,rr=h.processAll,ur=l._optionsParser,yt=l._CallExpression,pt=l._IdentifierExpression,fr=s._bindingParser2,er=c.scopedSelect,wt=o,bt=/^[A-Za-z]\w*$/,ii=/[^A-Za-z\w$]/g,cr=/[&<>'"]/g,lr={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},ar=/({{)|(}})|{(\w+)}|({)|(})/g,vr=/^\s*;\s*$/,yr=/[A-Z]/g,ct=i.Class.define(function(n,t,i,r,u){var f=this;this.compiler=n;this.kind=i;this.base=new String(t);this.tree={children:{},parent:this.base,reference:function(){return f.base}};this.accessExpression=r;this.filter=u||""},{createPathExpression:function(n,t){if(n.length){var r=this,i=n.reduce(function(n,t){return n.children=n.children||{},n.children[t]=n.children[t]||{parent:n},n.children[t]},this.tree);return i.name=i.name||r.compiler.defineInstance(r.kind,t||"",function(){return r.accessExpression(i.parent.name?i.parent.name:i.parent.reference(),n.slice(-1)[0],i.parent.parent===r.base,r.filter,!0)}),i.name}return this.base},lower:function(){var n=this,t=[],i=function(t,i,r){return n.accessExpression(t.parent.name?t.parent.name:t.parent.reference(),i,t.parent.parent===n.base,n.filter,r)};ht(this.tree,"",function(r,u,f){t.push(u);f>1?(r.name=r.name||n.compiler.defineInstance(n.kind,t.join("_"),i.bind(null,r,u,!0)),r.reference=function(){return r.name}):f===1&&(r.reference=i.bind(null,r,u))},function(){t.pop()})},deadNodeElimination:function(){ht(this.tree,"",null,function(n,t,i){(!n.name||n.name.dead)&&i===0&&n.parent&&n.parent.children&&delete n.parent.children[t]})},definitions:function(){var n=[];return ht(this.tree,"",function(t){t.name&&n.push(t)}),n.map(function(n){return n.name.definition()})}}),ut={capture:"capture",temporary:"temporary",variable:"variable",data:"data",global:"global"},gr={capture:"c",temporary:"t",variable:"iv",data:"d",global:"g"},gt={imported:"import",variable:"variable"},nu={imported:"i",variable:"sv"},g={tree:"tree",text:"text",initializer:"initializer",template:"template",error:"error"},d={attribute:"attribute",booleanAttribute:"booleanAttribute",inlineStyle:"inlineStyle",textContent:"textContent"},li="imports",nt={initial:0,analyze:1,optimze:2,lower:3,compile:4,link:5,done:6},ai=i.Class.define(function(n,i){if(this._stage=nt.initial,this._staticVariables={},this._staticVariablesCount=0,this._instanceVariables={},this._instanceVariablesCount={},this._debugBreak=i.debugBreakOnRender,this._defaultInitializer=it(i.defaultInitializer||ni),this._optimizeTextBindings=!i.disableTextBindingOptimization,this._templateElement=n,this._templateContent=t.document.createElement(n.tagName),this._extractChild=i.extractChild||!1,this._controls=null,this._bindings=null,this._bindTokens=null,this._textBindingPrefix=null,this._textBindingId=0,this._suffix=[],this._htmlProcessors=[],this._profilerMarkIdentifier=i.profilerMarkIdentifier,this._captureCSE=new ct(this,"container",ut.capture,this.generateElementCaptureAccess.bind(this)),this._dataCSE=new ct(this,"data",ut.data,this.generateNormalAccess.bind(this),this.importFunctionSafe("dataSecurityCheck",it)),this._globalCSE=new ct(this,this.importFunctionSafe("global",t),ut.global,this.generateNormalAccess.bind(this),this.importFunctionSafe("globalSecurityCheck",it)),a.renderCopy(this._templateElement,this._templateContent),this._extractChild)while(this._templateContent.childElementCount>1)this._templateContent.removeChild(this._templateContent.lastElementChild)},{addClassOneTimeTextBinding:function(n){var t=this,i=this.createTextBindingHole(n.elementCapture.element.tagName,"class",++this._textBindingId);n.textBindingId=i;n.kind=g.text;n.elementCapture.element.classList.add(i);n.elementCapture.refCount--;n.definition=function(){return t.formatCode("{htmlEscape}({value})",{htmlEscape:t._staticVariables.htmlEscape,value:n.value()})}},addClassOneTimeTreeBinding:function(n){var t=this;n.pathExpression=this.bindingExpression(n);n.value=function(){return n.pathExpression};n.kind=g.tree;n.definition=function(){return t.formatCode("{element}.classList.add({value})",{element:n.elementCapture,value:n.value()})}},analyze:function(){if(this._stage>nt.analyze)throw"Illegal: once we have moved past analyze we cannot revist it";this._stage=nt.analyze;this._controls=this.gatherControls();this._bindings=this.gatherBindings();this._children=this.gatherChildren();this.cleanControlAndBindingAttributes();this.async&&this.createAsyncParts();this.nullableIdentifierAccessTemporary=this.defineInstance(ut.temporary);var t=this._templateContent.innerHTML;this._html=function(){return oi(n(t))};this._html.text=t},bindingExpression:function(n){return this._dataCSE.createPathExpression(n.source,n.source.join("_"))},capture:function(n){var t=n._capture,u,o,e;if(t)return t.refCount++,t;for(var r=[n],i=n.parentNode,f=n.tagName;i!==this._templateContent;)f=i.tagName+"_"+f,r.unshift(i),i=i.parentNode;for(u=0,o=r.length;u<o;u++)e=r[u],r[u]=Array.prototype.indexOf.call(i.children,e),i=e;return t=this._captureCSE.createPathExpression(r,f.toLowerCase()),t.element=n,t.element._capture=t,t.refCount=1,t},cleanControlAndBindingAttributes:function(){for(var n,i=this._templateContent.querySelectorAll("[data-win-bind],[data-win-control]"),t=0,r=i.length;t<r;t++)n=i[t],n.isDeclarativeControlContainer&&(t+=n.querySelectorAll("[data-win-bind],[data-win-control]").length),n.removeAttribute("data-win-bind"),n.removeAttribute("data-win-control"),n.removeAttribute("data-win-options")},compile:function(t,i,r){var u,s,f,o,e,l;if(this._stage>nt.compile)throw"Illegal: once we have moved past compile we cannot revist it";this._stage=nt.compile;u=this;this._returnedElement=this._extractChild?"container.firstElementChild":"container";s=this._controls.map(function(t){var f,r,i;return f=t.async?"{target}.winControl = {target}.winControl || new {SafeConstructor}({target}, {options}, controlDone)":"{target}.winControl = {target}.winControl || new {SafeConstructor}({target}, {options})",r=u.formatCode(f,{target:t.elementCapture,SafeConstructor:t.SafeConstructor,options:u.generateOptionsLiteral(t.optionsParsed,t.elementCapture)}),t.isDeclarativeControlContainer&&typeof t.isDeclarativeControlContainer.imported=="function"?(i=[r],i.push(u.formatCode("{isDeclarativeControlContainer}({target}.winControl, {delayedControlProcessing})",{target:t.elementCapture,isDeclarativeControlContainer:t.isDeclarativeControlContainer,delayedControlProcessing:u._staticVariables.ui_processAll})),i.push(u.formatCode("{isDeclarativeControlContainer}({target}.winControl, {delayedBindingProcessing}(data, {templateDefaultInitializer}))",{target:t.elementCapture,isDeclarativeControlContainer:t.isDeclarativeControlContainer,delayedBindingProcessing:u._staticVariables.delayedBindingProcessing,templateDefaultInitializer:u._staticVariables.templateDefaultInitializer||n(null)})),i.join(";\n")):r});f=this._bindings.map(function(t){switch(t.kind){case g.template:return u.formatCode("({nestedTemplates}[{nestedTemplate}] = {template}.render({path}, {dest}))",{nestedTemplates:u._nestedTemplates,nestedTemplate:n(t.nestedTemplate),template:t.template,path:t.pathExpression,dest:t.elementCapture});case g.initializer:var i;return i=t.initialValue?"({bindTokens}[{bindToken}] = {initializer}(data, {sourceProperties}, {dest}, {destProperties}, {initialValue}))":"({bindTokens}[{bindToken}] = {initializer}(data, {sourceProperties}, {dest}, {destProperties}))",u.formatCode(i,{bindTokens:u._bindTokens,bindToken:n(t.bindToken),initializer:t.initializer,sourceProperties:n(t.source),destProperties:n(t.destination),dest:t.elementCapture,initialValue:t.initialValue});case g.tree:return t.definition();case g.text:break;case g.error:break;default:throw"NYI";}});r?(o=f.filter(function(n,t){return!u._bindings[t].delayable}),e=f.filter(function(n,t){return u._bindings[t].delayable})):(o=f,e=[]);var h=si(this._instanceVariables),a=h.filter(function(n){return n.kind===ut.variable}).map(function(n){return n.definition()}),v=this._captureCSE.definitions(),y=this._globalCSE.definitions(),p=this._dataCSE.definitions(),w=this._children.map(function(n){return u.formatCodeN("{0}.msParentSelectorScope = true",n)}),b=this._suffix.map(function(n){return n()}),c="";return r&&e.length&&(c=u.formatCode(uu,{delayed_binding_processing:et(e)})),l=u.formatCode(t,ci([this._staticVariables,i||{},{profilerMarkIdentifierStart:n("WinJS.Binding.Template:render"+this._profilerMarkIdentifier+",StartTM"),profilerMarkIdentifierStop:n("WinJS.Binding.Template:render"+this._profilerMarkIdentifier+",StopTM"),html:this._html(),tagName:n(this._templateElement.tagName),instance_variable_declarations:ri(h),global_definitions:et(y),data_definitions:et(p),instance_variable_definitions:et(a),capture_definitions:et(v),set_msParentSelectorScope:et(w),debug_break:this.generateDebugBreak(),control_processing:et(s),control_counter:this._controlCounter,binding_processing:et(o),renderComplete:c,suffix_statements:et(b),nestedTemplates:this._nestedTemplates,returnedElement:this._returnedElement},])),this.prettify(l)},createAsyncParts:function(){this._nestedTemplates=this._nestedTemplates||this.defineInstance(ut.variable,"nestedTemplates",function(){return kt(0)});this._controlCounter=this._controlCounter||this.defineInstance(ut.variable,"controlCounter",function(){return n(1)})},createTextBindingHole:function(n,t,i){var r,u;if(!this._textBindingPrefix){for(r="";this._html.text.indexOf("textbinding"+r)!==-1;)r=r||0,r++;this._textBindingPrefix="textbinding"+r;this._textBindingRegex=new RegExp("(#?"+this._textBindingPrefix+"_\\d+)")}return u=this._textBindingPrefix+"_"+i,n==="IMG"&&t==="src"&&(u="#"+u),u},deadCodeElimination:function(){var n=this;Object.keys(this._instanceVariables).forEach(function(t){var i=n._instanceVariables[t];i.kind===ut.capture&&(n._templateContent.contains(i.element)||(i.dead=!0),i.refCount===0&&(i.dead=!0),i.dead&&(i.definition=function(){},i.name=null,delete n._instanceVariables[t]))});this._controls=this._controls.filter(function(n){return!n.elementCapture.dead});this._bindings=this._bindings.filter(function(n){return!n.elementCapture.dead});this._captureCSE.deadNodeElimination()},defineInstance:function(n,t,i){if(this._stage>=nt.compile)throw"Illegal: define instance variable after compilation stage has started";var u=this._instanceVariablesCount[n]||0,f=t?t.replace(ii,"_"):"",r=ei(gr[n],u,f);return r.definition=function(){return dt(r,i())},r.kind=n,this._instanceVariables[r]=r,this._instanceVariablesCount[n]=u+1,r},defineStatic:function(n,t,i){var u,f,r;if(this._stage>=nt.link)throw"Illegal: define static variable after link stage has started";return t&&(u=this._staticVariables[t],u)?u:(f=t?t.replace(ii,"_"):"",r=ei(nu[n],this._staticVariablesCount,f),r.definition=function(){return dt(r,i())},r.kind=n,this._staticVariables[t||r]=r,this._staticVariablesCount++,r)},done:function(){if(this._stage>nt.done)throw"Illegal: once we have moved past done we cannot revist it";this._stage=nt.done},emitScopedSelect:function(t,i){return this.formatCode("{scopedSelect}({selector}, {element})",{scopedSelect:this._staticVariables.scopedSelect,selector:n(t),element:i})},emitOptionsNode:function(t,i,r){var o=this,u,e,f;if(t)switch(typeof t){case"object":if(Array.isArray(t)){for(i.push("["),u=0,e=t.length;u<e;u++)this.emitOptionsNode(t[u],i,r),i.push(",");i.push("]")}else t instanceof yt?i.push(t.target==="select"?this.emitScopedSelect(t.arg0Value,r):n(null)):t instanceof pt&&t.parts[0]instanceof yt?(f=t.parts[0],i.push(ui(f.target==="select"?this.emitScopedSelect(f.arg0Value,r):n(null),t.parts.slice(1),this.nullableIdentifierAccessTemporary,this.importFunctionSafe("requireSupportedForProcessing",it)))):t instanceof pt?i.push(t.pathExpression):(i.push("{"),Object.keys(t).forEach(function(n){i.push(wr(n));i.push(":");o.emitOptionsNode(t[n],i,r);i.push(",")}),i.push("}"));break;default:i.push(n(t))}else i.push(n(null))},findGlobalIdentifierExpressions:function(n,t){t=t||[];var i=this;return Object.keys(n).forEach(function(r){var u=n[r];typeof u=="object"&&(u instanceof pt?u.parts[0]instanceof yt||t.push(u):i.findGlobalIdentifierExpressions(u,t))}),t},formatCodeN:function(){if(this._stage<nt.compile)throw"Illegal: format code at before compilation stage has started";return ot.apply(null,arguments)},formatCode:function(n,t){if(this._stage<nt.compile)throw"Illegal: format code at before compilation stage has started";return ot(n,t)},gatherBindings:function(){for(var i,o,s,h,c,u=-1,n=this,f=-1,e=[],l="[data-win-bind],[data-win-control]",a=this._templateContent.querySelectorAll(l),r=0,v=a.length;r<v;r++)(i=a[r],i.isDeclarativeControlContainer&&(r+=i.querySelectorAll(l).length),i.hasAttribute("data-win-bind"))&&(o=i.getAttribute("data-win-bind"),s=fr(o,t),s.forEach(function(t){if(t.initializer){var e=t.initializer.join("."),r=dr(t.initializer);r.render?(it(r.render),t.template=n.importFunctionSafe(e,r),t.pathExpression=n.bindingExpression(t),t.nestedTemplate=++f,t.kind=g.template):r.winControl&&r.winControl.render?(it(r.winControl.render),t.template=n.importFunctionSafe(e,r.winControl),t.pathExpression=n.bindingExpression(t),t.nestedTemplate=++f,t.kind=g.template):(t.initializer=n.importFunction(e,r),t.bindToken=++u,t.kind=g.initializer)}else t.initializer=n.importFunctionSafe("templateDefaultInitializer",n._defaultInitializer),t.bindToken=++u,t.kind=g.initializer;t.elementCapture=n.capture(i);t.bindingText=o}),e.push.apply(e,s));return h=f+1,h>0&&(this.async=!0,this._nestedTemplates=this.defineInstance(ut.variable,"nestedTemplates",function(){return kt(h)})),c=u+1,c>0&&(this._bindTokens=this.defineInstance(ut.variable,"bindTokens",function(){return kt(c)}),this._suffix.push(function(){return n.formatCode("{utilities_data}(returnedElement).bindTokens = {bindTokens}",{utilities_data:n._staticVariables.utilities_data,bindTokens:n._bindTokens})})),e},gatherChildren:function(){var n=this;return Array.prototype.map.call(this._templateContent.children,function(t){return n.capture(t)})},gatherControls:function(){for(var h,c,i,l,p,w=this,s=0,a=[],v="[data-win-control]",y=this._templateContent.querySelectorAll(v),f=0,b=y.length;f<b;f++){var u=y[f],e=u.getAttribute("data-win-control"),o=r._getMemberFiltered(e.trim(),t,it);o&&(h=u.getAttribute("data-win-options")||n({}),c=o.length>2,c&&(s++,this.async=!0),i=o.isDeclarativeControlContainer,i&&(typeof i=="function"&&(i=this.importFunction(e+"_isDeclarativeControlContainer",i)),u.isDeclarativeControlContainer=i,f+=u.querySelectorAll(v).length),l={elementCapture:this.capture(u),name:e,SafeConstructor:this.importFunctionSafe(e,o),async:c,optionsText:n(h),optionsParsed:ur(h),isDeclarativeControlContainer:i},a.push(l),p=this.findGlobalIdentifierExpressions(l.optionsParsed),p.forEach(function(n){n.pathExpression=w.globalExpression(n.parts)}))}return s>0&&(this._controlCounter=this.defineInstance(ut.variable,"controlCounter",function(){return n(s+1)})),a},generateElementCaptureAccess:function(n,t,i){if(i){var r=""+t=="0"?"":" + "+t;return this.formatCodeN("{0}.children[startIndex{1}]",n,r)}return this.formatCodeN("{0}.children[{1}]",n,t)},generateNormalAccess:function(n,t,i,r,u){var f;return n.indexOf(this.nullableIdentifierAccessTemporary)>=0?(f=u?"{left} && {filter}({temp}{right})":"{left} && ({temp} = {filter}({temp}{right}))",this.formatCode(f,{temp:this.nullableIdentifierAccessTemporary,left:n,right:st([t]),filter:r})):(f=u?"({temp} = {left}) && {filter}({temp}{right})":"({temp} = {left}) && ({temp} = {filter}({temp}{right}))",this.formatCode(f,{temp:this.nullableIdentifierAccessTemporary,left:n,right:st([t]),filter:r}))},generateOptionsLiteral:function(n,t){var i=[];return this.emitOptionsNode(n,i,t),i.join(" ")},generateDebugBreak:function(){if(this._debugBreak){var t=this.defineStatic(gt.variable,"debugCounter",function(){return n(0)});return this.formatCodeN("if (++{0} === 1) {{ debugger; }}",t)}return""},globalExpression:function(n){return this._globalCSE.createPathExpression(n,n.join("_"))},importFunction:function(n,t){return this.importFunctionSafe(n,it(t))},importFunctionSafe:function(n,t){var r=this,i=this.defineStatic(gt.imported,n,function(){return r.formatCodeN("({0}{1})",li,st([n]))});if(i.imported&&i.imported!==t)throw"Duplicate import: '"+n+"'";return i.imported=t,i},importAll:function(n){return Object.keys(n).forEach(function(t){it(n[t])}),this.importAllSafe(n)},importAllSafe:function(n){var t=this;return Object.keys(n).reduce(function(i,r){return i[r]=t.importFunctionSafe(r,n[r]),i},{})},link:function(n){if(this._stage>nt.link)throw"Illegal: once we have moved past link we cannot revist it";this._stage=nt.link;var t=this,r=kr(this._staticVariables).filter(function(n){return t._staticVariables[n].kind===gt.imported}).reduce(function(n,i){return n[i]=t._staticVariables[i].imported,n},{}),i=si(this._staticVariables);return new Function(li,this.formatCode(eu,{static_variable_declarations:ri(i),static_variable_definitions:et(i.map(function(n){return n.definition()})),body:n.trim()}))(r)},lower:function(){if(this._stage>nt.lower)throw"Illegal: once we have moved past lower we cannot revist it";this._stage=nt.lower;this._captureCSE.lower();this._dataCSE.lower();this._globalCSE.lower()},markBindingAsError:function(n){n&&(n.kind=g.error,this.markBindingAsError(n.original))},oneTimeTextBinding:function(t){var e=this,u=this.oneTimeTextBindingAnalyze(t),f,r,i,o;if(u){t.original&&(f=t.original.initialValue);r=this.createTextBindingHole(t.elementCapture.element.tagName,u.attribute,++this._textBindingId);t.textBindingId=r;t.kind=g.text;t.elementCapture.refCount--;t.definition=function(){var n;return n=f?"{htmlEscape}({initialValue})":"{htmlEscape}({getter})",e.formatCode(n,{htmlEscape:e._staticVariables.htmlEscape,getter:t.value(),initialValue:f})};switch(u.kind){case d.attribute:t.elementCapture.element.setAttribute(u.attribute,r);break;case d.booleanAttribute:t.elementCapture.element.setAttribute(u.attribute,r);t.definition=function(){var i;return i=f?'({initialValue} ? {attribute} : "")':'({value} ? {attribute} : "")',e.formatCode(i,{value:t.value(),attribute:n(u.attribute),initialValue:f})};this._htmlProcessors.push(function(n){return n.replace(new RegExp(u.attribute+'="'+r+'"',"i"),r)});break;case d.textContent:t.elementCapture.element.textContent=r;break;case d.inlineStyle:i=t.elementCapture.element;i.msReplaceStyle||(i.msReplaceStyle=i.getAttribute("style")||"",i.msReplaceStyle!==""&&i.msReplaceStyle[i.msReplaceStyle.length-1]!==";"&&(i.msReplaceStyle=i.msReplaceStyle+";"),i.setAttribute("style","msReplaceStyle:'"+r+"'"),o=i.getAttribute("style"),this._htmlProcessors.push(function(n){return n.replace(o,i.msReplaceStyle)}));i.msReplaceStyle=i.msReplaceStyle+u.property+":"+r+";";break;default:throw"NYI";}}},oneTimeTextBindingAnalyze:function(n){var r=n.elementCapture.element,f=r.tagName,t=n.destination[0],i,u;switch(f){case"A":switch(t){case"href":return{kind:d.attribute,attribute:t}}break;case"IMG":switch(t){case"alt":case"src":case"width":case"height":return{kind:d.attribute,attribute:t}}break;case"SELECT":switch(t){case"disabled":case"multiple":case"required":return{kind:d.booleanAttribute,attribute:t};case"size":return{kind:d.attribute,attribute:t}}break;case"OPTION":switch(t){case"label":case"value":return{kind:d.attribute,attribute:t};case"disabled":case"selected":return{kind:d.booleanAttribute,attribute:t}}break;case"INPUT":switch(t){case"checked":switch(r.type){case"checkbox":case"radio":return{kind:d.booleanAttribute,attribute:t}}break;case"disabled":return{kind:d.booleanAttribute,attribute:t};case"max":case"maxLength":case"min":case"step":case"value":return{kind:d.attribute,attribute:t};case"size":switch(r.type){case"text":case"search":case"tel":case"url":case"email":case"password":return{kind:d.attribute,attribute:t}}break;case"readOnly":switch(r.type){case"hidden":case"range":case"color":case"checkbox":case"radio":case"file":case"button":break;default:return{kind:d.booleanAttribute,attribute:t}}}break;case"BUTTON":switch(t){case"disabled":return{kind:d.booleanAttribute,attribute:t};case"value":return{kind:d.attribute,attribute:t}}break;case"TEXTAREA":switch(t){case"disabled":case"readOnly":case"required":return{kind:d.booleanAttribute,attribute:t};case"cols":case"maxLength":case"placeholder":case"rows":case"wrap":return{kind:d.attribute,attribute:t}}}switch(t){case"className":return{kind:d.attribute,attribute:"class"};case"dir":case"lang":case"name":case"title":case"tabIndex":return{kind:d.attribute,attribute:t};case"style":if(n.destination.length>1){if(i=n.destination[1],i==="cssText")return;if(u=typeof r.style[i]=="string",u)return(i[0]==="m"&&i[1]==="s"||i.substring(0,6)==="webkit")&&(i="-"+i),i=i.replace(yr,function(n){return"-"+n.toLowerCase()}),{kind:d.inlineStyle,property:i,attribute:"style"}}break;case"innerText":case"textContent":return{kind:d.textContent,attribute:"textContent"}}},oneTimeTreeBinding:function(n){if(n.destination.length===1&&n.destination[0]==="id"){if(r.validation)throw new u("WinJS.Binding.IdBindingNotSupported",e._formatString(k.idBindingNotSupported,n.bindingText));f.log&&f.log(e._formatString(k.idBindingNotSupported,n.bindingText),"winjs binding","error");this.markBindingAsError(n);return}if(n.destination.length===0){f.log&&f.log(k.cannotBindToThis,"winjs binding","error");this.markBindingAsError(n);return}var i=this,t;n.pathExpression=this.bindingExpression(n);n.value=function(){return n.pathExpression};n.original&&(t=n.pathExpression,n.original.initialValue=t);n.kind=g.tree;n.definition=function(){var r;return r=t?"({targetPath} || {{}}){prop} = {initialValue}":"({targetPath} || {{}}){prop} = {sourcePath}",i.formatCode(r,{targetPath:ui(n.elementCapture,n.destination.slice(0,-1),i.nullableIdentifierAccessTemporary,i.importFunctionSafe("targetSecurityCheck",hr)),prop:st(n.destination.slice(-1)),sourcePath:n.value(),initialValue:t})}},optimize:function(){var r,f,e,u,i,t;if(this._stage>nt.optimze)throw"Illegal: once we have moved past link we cannot revist it";for(this._stage=nt.optimze,i=0;i<this._bindings.length;i++)if(t=this._bindings[i],!t.template)switch(t.initializer.imported){case ni:r=hi(t,{kind:g.tree,initializer:this.importFunctionSafe("init_oneTime",at),original:t});r.elementCapture.refCount++;this.oneTimeTreeBinding(r);this._bindings.splice(i,0,r);t.delayable=!0;i++;break;case ki:r=hi(t,{kind:g.tree,initializer:this.importFunctionSafe("init_setAttributeOneTime",vt),original:t});r.elementCapture.refCount++;this.setAttributeOneTimeTreeBinding(r);this._bindings.splice(i,0,r);t.delayable=!0;i++;break;case at:this.oneTimeTreeBinding(t);break;case vt:this.setAttributeOneTimeTreeBinding(t);break;case ti:this.addClassOneTimeTreeBinding(t);break;default:t.initializer&&(t.delayable=!!t.initializer.imported.delayable)}if(this._optimizeTextBindings){for(f={},i=0;i<this._bindings.length;i++)if((t=this._bindings[i],!t.template)&&t.kind!==g.error){switch(t.initializer.imported){case at:this.oneTimeTextBinding(t);break;case vt:this.setAttributeOneTimeTextBinding(t);break;case ti:this.addClassOneTimeTextBinding(t)}t.textBindingId&&(f[t.textBindingId]=t)}if(Object.keys(f).length){for(e=this._templateContent.innerHTML,e=this._htmlProcessors.reduce(function(n,t){return t(n)},e),u=e.split(this._textBindingRegex),i=1;i<u.length;i+=2)t=f[u[i]],u[i]=t.definition;this._html=function(){var t=u.map(function(t){return typeof t=="string"?n(t):t()}).join(" + ");return oi(t)}}}},prettify:function(n){var t=n.split("\n");return t.filter(function(n){return!vr.test(n)}).join("\n")},setAttributeOneTimeTextBinding:function(n){var i=this,r=n.destination[0],u=this.createTextBindingHole(n.elementCapture.element.tagName,r,++this._textBindingId),t;n.original&&(t=n.original.initialValue);n.textBindingId=u;n.kind=g.text;n.elementCapture.element.setAttribute(r,u);n.elementCapture.refCount--;n.definition=function(){var r;return r=t?"{htmlEscape}({initialValue})":"{htmlEscape}({value})",i.formatCode(r,{htmlEscape:i._staticVariables.htmlEscape,initialValue:t,value:n.value()})}},setAttributeOneTimeTreeBinding:function(t){if(t.destination.length===1&&t.destination[0]==="id"){if(r.validation)throw new u("WinJS.Binding.IdBindingNotSupported",e._formatString(k.idBindingNotSupported,t.bindingText));f.log&&f.log(e._formatString(k.idBindingNotSupported,t.bindingText),"winjs binding","error");this.markBindingAsError(t);return}if(t.destination.length!==1||!t.destination[0]){f.log&&f.log(k.attributeBindingSingleProperty,"winjs binding","error");this.markBindingAsError(t);return}var o=this,i;t.pathExpression=this.bindingExpression(t);t.value=function(){return t.pathExpression};t.original&&(i=this.defineInstance(ut.variable,"",t.value),t.original.initialValue=i);t.kind=g.tree;t.definition=function(){var r;return r=i?'{element}.setAttribute({attribute}, "" + {initialValue})':'{element}.setAttribute({attribute}, "" + {value})',o.formatCode(r,{element:t.elementCapture,attribute:n(t.destination[0]),initialValue:i,value:t.value()})}}},{_TreeCSE:ct,compile:function(n,i,r){var u,o,f,e,s,h;if(!(i instanceof t.HTMLElement))throw"Illegal";wt("WinJS.Binding.Template:compile"+r.profilerMarkIdentifier+",StartTM");u=new ai(i,r);u.analyze();o=u.importAllSafe({Signal:y,global:t,document:t.document,cancelBlocker:bi,promise_as:di,disposeInstance:or,markDisposable:tr,ui_processAll:ir,binding_processAll:rr,insertAdjacentHTMLUnsafe:gi,promise:v,utilities_data:nr,requireSupportedForProcessing:it,htmlEscape:br,scopedSelect:er,delayedBindingProcessing:sr,writeProfilerMark:wt});u.optimize();u.deadCodeElimination();u.lower();switch(r.target){case"render":f=u.async?iu:tu;e=!1;break;case"renderItem":f=u.async?fu:ru;e=!0}return s=u.compile(f,o,e),h=u.link(s),u.done(),wt("WinJS.Binding.Template:compile"+r.profilerMarkIdentifier+",StopTM"),h}}),lt=ft('container.classList.add("win-template");                                                              \nvar html = {html};                                                                                      \n{insertAdjacentHTMLUnsafe}(container, "beforeend", html);                                             \nreturnedElement = {returnedElement};                                                                    \n                                                                                                        \n// Capture Definitions                                                                                  \n{capture_definitions};                                                                                  \n{set_msParentSelectorScope};                                                                            \n                                                                                                        \n'),vi=ft("// Control Processing                                                                                   \n{control_processing};                                                                                   \n                                                                                                        \n// Binding Processing                                                                                   \n{binding_processing};                                                                                   \n                                                                                                        \nvar result = {promise_as}(returnedElement);                                                             \n"),yi=ft('var controlSignal = new {Signal}();                                                                     \nvar controlDone = function () {{ if (--{control_counter} === 0) {{ controlSignal.complete(); }} }};     \ncontrolDone();                                                                                          \n                                                                                                        \n// Control Processing                                                                                   \n{control_processing};                                                                                   \n                                                                                                        \nvar result = controlSignal.promise.then(function () {{                                                  \n    // Binding Processing                                                                               \n    {binding_processing};                                                                               \n    return {promise}.join({nestedTemplates});                                                           \n}}).then(function () {{                                                                                 \n    return returnedElement;                                                                             \n}}).then(null, function (e) {{                                                                          \n    if (typeof e === "object" && e.name === "Canceled") {{ returnedElement.dispose(); }}            \n    return {promise}.wrapError(e);                                                                      \n}});                                                                                                    \n'),pi=ft("{markDisposable}(returnedElement, function () {{ {disposeInstance}(returnedElement, result); }});       \n{suffix_statements};                                                                                    \n"),tu=ft('function render(data, container) {{                                                                     \n    {debug_break}                                                                                       \n    if (typeof data === "object" && typeof data.then === "function") {{                             \n        // async data + a container falls back to interpreted path                                      \n        if (container) {{                                                                               \n            var result = this._renderInterpreted(data, container);                                      \n            return result.element.then(function () {{ return result.renderComplete; }});                \n        }}                                                                                              \n        return {cancelBlocker}(data).then(function(data) {{ return render(data); }});                   \n    }}                                                                                                  \n                                                                                                        \n    {writeProfilerMark}({profilerMarkIdentifierStart});                                                 \n                                                                                                        \n    // Declarations                                                                                     \n    var {instance_variable_declarations};                                                               \n    var returnedElement;                                                                                \n                                                                                                        \n    // Global Definitions                                                                               \n    {global_definitions};                                                                               \n                                                                                                        \n    // Data Definitions                                                                                 \n    data = (data === {global} ? data : {requireSupportedForProcessing}(data));                          \n    {data_definitions};                                                                                 \n                                                                                                        \n    // Instance Variable Definitions                                                                    \n    {instance_variable_definitions};                                                                    \n                                                                                                        \n    // HTML Processing                                                                                  \n    container = container || {document}.createElement({tagName});                                       \n    var startIndex = container.childElementCount;                                                       \n    '+rt(tt(4,lt))+"                                           \n                                                                                                        \n    "+rt(tt(4,vi))+"                                      \n    "+rt(tt(4,pi))+"                                           \n                                                                                                        \n    {writeProfilerMark}({profilerMarkIdentifierStop});                                                  \n                                                                                                        \n    return result;                                                                                      \n}}                                                                                                      \n"),iu=ft('function render(data, container) {{                                                                     \n    {debug_break}                                                                                       \n    if (typeof data === "object" && typeof data.then === "function") {{                             \n        // async data + a container falls back to interpreted path                                      \n        if (container) {{                                                                               \n            var result = this._renderInterpreted(data, container);                                      \n            return result.element.then(function () {{ return result.renderComplete; }});                \n        }}                                                                                              \n        return {cancelBlocker}(data).then(function(data) {{ return render(data, container); }});        \n    }}                                                                                                  \n                                                                                                        \n    {writeProfilerMark}({profilerMarkIdentifierStart});                                                 \n                                                                                                        \n    // Declarations                                                                                     \n    var {instance_variable_declarations};                                                               \n    var returnedElement;                                                                                \n                                                                                                        \n    // Global Definitions                                                                               \n    {global_definitions};                                                                               \n                                                                                                        \n    // Data Definitions                                                                                 \n    data = (data === {global} ? data : {requireSupportedForProcessing}(data));                          \n    {data_definitions};                                                                                 \n                                                                                                        \n    // Instance Variable Definitions                                                                    \n    {instance_variable_definitions};                                                                    \n                                                                                                        \n    // HTML Processing                                                                                  \n    container = container || {document}.createElement({tagName});                                       \n    var startIndex = container.childElementCount;                                                       \n    '+rt(tt(4,lt))+"                                           \n                                                                                                        \n    "+rt(tt(4,yi))+"                                 \n    "+rt(tt(4,pi))+"                                           \n                                                                                                        \n    {writeProfilerMark}({profilerMarkIdentifierStop});                                                  \n                                                                                                        \n    return result;                                                                                      \n}}                                                                                                      \n"),wi=ft("{markDisposable}(returnedElement, function () {{ {disposeInstance}(returnedElement, result, renderComplete); }});\n{suffix_statements};                                                                                    \n"),ru=ft('function renderItem(itemPromise) {{                                                                     \n    {debug_break}                                                                                       \n    // Declarations                                                                                     \n    var {instance_variable_declarations};                                                               \n    var element, renderComplete, data, returnedElement;                                                 \n                                                                                                        \n    element = itemPromise.then(function renderItem(item) {{                                             \n        if (typeof item.data === "object" && typeof item.data.then === "function") {{               \n            return {cancelBlocker}(item.data).then(function (data) {{ return renderItem({{ data: data }}); }});\n        }}                                                                                              \n                                                                                                        \n        {writeProfilerMark}({profilerMarkIdentifierStart});                                             \n                                                                                                        \n        // Global Definitions                                                                           \n        {global_definitions};                                                                           \n                                                                                                        \n        // Data Definitions                                                                             \n        data = item.data;                                                                               \n        data = (data === {global} ? data : {requireSupportedForProcessing}(data));                      \n        {data_definitions};                                                                             \n                                                                                                        \n        // Instance Variable Definitions                                                                \n        {instance_variable_definitions};                                                                \n                                                                                                        \n        // HTML Processing                                                                              \n        var container = {document}.createElement({tagName});                                            \n        var startIndex = 0;                                                                             \n        '+rt(tt(8,lt))+"                                       \n                                                                                                        \n        "+rt(tt(8,vi))+"                                  \n        "+rt(tt(8,wi))+"                                   \n                                                                                                        \n        {writeProfilerMark}({profilerMarkIdentifierStop});                                              \n                                                                                                        \n        return result;                                                                                  \n    }});                                                                                                \n    {renderComplete};                                                                                   \n    return {{                                                                                           \n        element: element,                                                                               \n        renderComplete: renderComplete || element,                                                      \n    }};                                                                                                 \n}}                                                                                                      \n"),uu=ft("renderComplete = element.then(function () {{                                                            \n    return itemPromise;                                                                                 \n}}).then(function (item) {{                                                                             \n    return item.ready || item;                                                                          \n}}).then(function (item) {{                                                                             \n    {delayed_binding_processing};                                                                       \n    return element;                                                                                     \n}});                                                                                                    \n"),fu=ft('function renderItem(itemPromise) {{                                                                     \n    {debug_break}                                                                                       \n    // Declarations                                                                                     \n    var {instance_variable_declarations};                                                               \n    var element, renderComplete, data, returnedElement;                                                 \n                                                                                                        \n    element = itemPromise.then(function renderItem(item) {{                                             \n        if (typeof item.data === "object" && typeof item.data.then === "function") {{               \n            return {cancelBlocker}(item.data).then(function (data) {{ return renderItem({{ data: data }}); }});\n        }}                                                                                              \n                                                                                                        \n        {writeProfilerMark}({profilerMarkIdentifierStart});                                             \n                                                                                                        \n        // Global Definitions                                                                           \n        {global_definitions};                                                                           \n                                                                                                        \n        // Data Definitions                                                                             \n        data = item.data;                                                                               \n        data = (data === {global} ? data : {requireSupportedForProcessing}(data));                      \n        {data_definitions};                                                                             \n                                                                                                        \n        // Instance Variable Definitions                                                                \n        {instance_variable_definitions};                                                                \n                                                                                                        \n        // HTML Processing                                                                              \n        var container = {document}.createElement({tagName});                                            \n        var startIndex = 0;                                                                             \n        '+rt(tt(8,lt))+"                                       \n                                                                                                        \n        "+rt(tt(8,yi))+"                             \n        "+rt(tt(8,wi))+"                                   \n                                                                                                        \n        {writeProfilerMark}({profilerMarkIdentifierStop});                                              \n                                                                                                        \n        return result;                                                                                  \n    }});                                                                                                \n    {renderComplete};                                                                                   \n    return {{                                                                                           \n        element: element,                                                                               \n        renderComplete: renderComplete || element,                                                      \n    }};                                                                                                 \n}}                                                                                                      \n"),eu=ft('"use strict";                                                                                         \n                                                                                                        \n// statics                                                                                              \nvar {static_variable_declarations};                                                                     \n{static_variable_definitions};                                                                          \n                                                                                                        \n// generated template rendering function                                                                \nreturn {body};                                                                                          \n');return ai})})}}),t("WinJS/BindingTemplate",["exports","./Core/_Global","./Core/_WinRT","./Core/_Base","./Core/_BaseUtils","./Core/_Log","./Core/_WriteProfilerMark","./Binding/_Declarative","./BindingTemplate/_DataTemplateCompiler","./ControlProcessor","./Fragments","./Promise","./Utilities/_Dispose","./Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";if(t.document){var y=l._cancelBlocker;r.Namespace._moduleDefine(n,"WinJS.Binding",{Template:r.Namespace._lazy(function(){function p(i,r,u){function g(){return v.removeClass(f,"win-loading"),e("WinJS.Binding:templateRender"+i._profilerMarkIdentifier+",StopTM"),b||f}var p,f,s,w,k,b,d,nt;return e("WinJS.Binding:templateRender"+i._profilerMarkIdentifier+",StartTM"),++i._counter==1&&(i.debugBreakOnRender||n._debugBreakOnRender),p=l.wrap(),f=u||t.document.createElement(i.element.tagName),v.addClass(f,"win-template"),v.addClass(f,"win-loading"),s=i,w=f.children.length,d=function(){var n=v.data(f).winBindings;n&&n.forEach(function(n){n.cancel()});p.cancel()},i.extractChild?k=c.renderCopy(s.href||s.element,t.document.createElement(s.element.tagName)).then(function(n){var t=n.firstElementChild;return b=t,a.markDisposable(t,d),f.appendChild(t),t}):(a.markDisposable(f,d),k=c.renderCopy(s.href||s.element,f)),nt=k.then(function(){function v(){return n(h.processAll).then(function(){return y(r)}).then(function(t){return n(o.processAll,t,!b&&!w,s.bindingCache)}).then(null,function(n){return typeof n=="object"&&n.name==="Canceled"&&(b||f).dispose(),l.wrapError(n)})}var n,t,c,e,a,i,u;if(w===0)n=function(n,t,i,r){return n(b||f,t,i,r)};else if(t=f.children,t.length===w+1)n=function(n,i,r,u){return n(t[w],i,r,u)};else{for(c=[],e=w,a=t.length;e<a;e++)c.push(t[e]);n=function(n,t,i,r){var u=[];return c.forEach(function(f){u.push(n(f,t,i,r))}),l.join(u)}}for(i=f.firstElementChild;i;)i.msParentSelectorScope=!0,i=i.nextElementSibling;return u=s.processTimeout,u?(u<0&&(u=0),l.timeout(u).then(function(){return p=v()})):p=v()}).then(g,function(n){return g(),l.wrapError(n)}),{element:k,renderComplete:nt}}var n=r.Class.define(function(n,i){this._element=n||t.document.createElement("div");this._element.winControl=this;this._profilerMarkIdentifier=u._getProfilerMarkIdentifier(this._element);e("WinJS.Binding:newTemplate"+this._profilerMarkIdentifier+",StartTM");var r=this;this._element.renderItem=function(n,t){return r._renderItemImpl(n,t)};i=i||{};this.href=i.href;this.enableRecycling=!!i.enableRecycling;this.processTimeout=i.processTimeout||0;this.bindingInitializer=i.bindingInitializer;this.debugBreakOnRender=i.debugBreakOnRender;this.disableOptimizedProcessing=i.disableOptimizedProcessing;this.extractChild=i.extractChild;this._counter=0;this._compile=!!i._compile;this.href||(this.element.style.display="none");this.bindingCache={expressions:{}};e("WinJS.Binding:newTemplate"+this._profilerMarkIdentifier+",StopTM")},{_shouldCompile:{get:function(){var i=!0;return i=i&&!n._interpretAll,i=i&&!this.disableOptimizedProcessing,i&&(i=i&&this.processTimeout===0,i=i&&(!this.href||this.href instanceof t.HTMLElement),i||f.log&&f.log("Cannot compile templates which use processTimeout or href properties","winjs binding","warn")),i}},bindingInitializer:{get:function(){return this._bindingInitializer},set:function(n){this._bindingInitializer=n;this._reset()}},debugBreakOnRender:{get:function(){return this._debugBreakOnRender},set:function(n){this._debugBreakOnRender=!!n;this._reset()}},disableOptimizedProcessing:{get:function(){return this._disableOptimizedProcessing},set:function(n){this._disableOptimizedProcessing=!!n;this._reset()}},element:{get:function(){return this._element}},extractChild:{get:function(){return this._extractChild},set:function(n){this._extractChild=!!n;this._reset()}},processTimeout:{get:function(){return this._processTimeout||0},set:function(n){this._processTimeout=n;this._reset()}},render:u.markSupportedForProcessing(function(n,t){return this._renderImpl(n,t)}),_renderImpl:function(n,t){if(this._shouldCompile)try{return this._renderImpl=this._compileTemplate({target:"render"}),this._renderImpl(n,t)}catch(r){return l.wrapError(r)}var i=p(this,n,t);return i.element.then(function(){return i.renderComplete})},_renderInterpreted:function(n,t){return p(this,n,t)},renderItem:function(n,t){return this._renderItemImpl(n,t)},_renderItemImpl:function(n,t){var u,i,f,r;if(this._shouldCompile)try{return this._renderItemImpl=this._compileTemplate({target:"renderItem"}),this._renderItemImpl(n)}catch(e){return{element:l.wrapError(e),renderComplete:l.wrapError(e)}}return(u=this,this.enableRecycling&&!this.bindingCache.elements&&(this.bindingCache.elements={}),this.enableRecycling&&t&&t.msOriginalTemplate===this&&(i=this.bindingCache.elements[t.id],f=!0,i&&(i.bindings.forEach(function(n){n()}),i.bindings=[],f=!i.nocache),f))?{element:t,renderComplete:n.then(function(n){return o.processAll(t,n.data,!0,u.bindingCache)})}:(r=p(this,n.then(function(n){return n.data})),r.element=r.element.then(function(n){return n.msOriginalTemplate=u,n}),r)},_compileTemplate:function(t){var u=this,f=s._TemplateCompiler.compile(this,this.href||this.element,{debugBreakOnRender:this.debugBreakOnRender||n._debugBreakOnRender,defaultInitializer:this.bindingInitializer||t.defaultInitializer,disableTextBindingOptimization:t.disableTextBindingOptimization||!1,target:t.target,extractChild:this.extractChild,profilerMarkIdentifier:this._profilerMarkIdentifier}),e=t.resetOnFragmentChange||i.Windows.ApplicationModel.DesignMode.designModeEnabled,r;return e&&(r=new v._MutationObserver(function(){u._reset();r.disconnect()}),r.observe(v.data(this.element).docFragment,{childList:!0,attributes:!0,characterData:!0,subtree:!0})),f},_reset:function(){delete this._renderImpl;delete this._renderItemImpl}},{isDeclarativeControlContainer:{value:!0,writable:!1,configurable:!1},render:{value:function(t,i,r){return new n(null,{href:t}).render(i,r)}}});return n})})}}),t("WinJS/BindingList/_BindingListDataSource",["exports","../Core/_WinRT","../Core/_Base","../Core/_ErrorFromName","../Binding/_DomWeakRefTable","../Promise","../Scheduler","../Utilities/_UI"],function(n,t,i,r,u,f,e,o){"use strict";i.Namespace._moduleDefine(n,"WinJS.Binding",{_BindingListDataSource:i.Namespace._lazy(function(){function c(n,t){for(var r=n.length,i;t<r-1;)if(i=n.getItem(++t),i)return i.key;return null}function l(n,t){while(t>0){var i=n.getItem(--t);if(i)return i.key}return null}function y(n,t){Object.keys(t).forEach(function(i){n.addEventListener(i,t[i])})}function p(n,t){Object.keys(t).forEach(function(i){n.removeEventListener(i,t[i])})}function h(n,t){return t?new w(n,t):new v}function k(n,t,i){return t?new b(n,t,i):new v}function s(n,t,i){return t&&n._annotateWithIndex(t,i)}function g(n,t){return this._list.unshift(t),this.itemFromIndex(0)}function nt(t,i,r){var u=this._list.indexOfKey(r);return u===-1?n.noLongerMeaningful:(this._list.splice(u,0,i),this.itemFromIndex(u))}function tt(t,i,r){var u=this._list.indexOfKey(r);return u===-1?n.noLongerMeaningful:(u+=1,this._list.splice(u,0,i),this.itemFromIndex(u))}function it(n,t){return this._list.push(t),this.itemFromIndex(this._list.length-1)}function rt(t,i){var r=this._list.indexOfKey(t);return r===-1?n.noLongerMeaningful:(this._list.setAt(r,i),this.itemFromIndex(r))}function ut(t){var r=this._list.indexOfKey(t),i;return r===-1?n.noLongerMeaningful:(i=0,this._list.move(r,i),this.itemFromIndex(i))}function ft(t,i){var u=this._list.indexOfKey(t),r=this._list.indexOfKey(i);return u===-1||r===-1?n.noLongerMeaningful:(r=u<r?r-1:r,this._list.move(u,r),this.itemFromIndex(r))}function et(t,i){var u=this._list.indexOfKey(t),r=this._list.indexOfKey(i);return u===-1||r===-1?n.noLongerMeaningful:(r=u<=r?r:r+1,this._list.move(u,r),this.itemFromIndex(r))}function ot(t){var r=this._list.indexOfKey(t),i;return r===-1?n.noLongerMeaningful:(i=this._list.length-1,this._list.move(r,i),this.itemFromIndex(i))}function st(t){var i=this._list.indexOfKey(t);return i===-1?n.noLongerMeaningful:(this._list.splice(i,1),f.wrap())}var n={get noLongerMeaningful(){return f.wrapError(new r(o.EditError.noLongerMeaningful))}},a=f.wrap().constructor,v=i.Class.derive(a,function(){this._value=null},{release:function(){},retain:function(){return this}},{supportedForProcessing:!1}),w=i.Class.derive(a,function(n,t){this._value=t;this._listBinding=n},{handle:{get:function(){return this._value.key}},index:{get:function(){return this._value.index}},release:function(){this._listBinding._release(this._value,this._listBinding._list.indexOfKey(this._value.key))},retain:function(){return this._listBinding._addRef(this._value,this._listBinding._list.indexOfKey(this._value.key)),this}},{supportedForProcessing:!1}),b=i.Class.derive(f,function(n,t,i){var r=this;this._item=t;this._listBinding=n;f.call(this,function(u){e.schedule(function(){if(n._released){r.cancel();return}u(t)},e.Priority.normal,null,"WinJS.Binding.List."+i)})},{handle:{get:function(){return this._item.key}},index:{get:function(){return this._item.index}},release:function(){this._listBinding._release(this._item,this._listBinding._list.indexOfKey(this._item.key))},retain:function(){return this._listBinding._addRef(this._item,this._listBinding._list.indexOfKey(this._item.key)),this}},{supportedForProcessing:!1}),d=i.Class.define(function(n,i,r,f){var s,e;this._dataSource=n;this._list=i;this._editsCount=0;this._notificationHandler=r;this._pos=-1;this._retained=[];this._retained.length=i.length;this._retainedKeys={};this._affectedRange=null;s=null;t.msSetWeakWinRTProperty&&t.msGetWeakWinRTProperty||(s=this);r&&(e=function(n,t){var i=u._getWeakRefElement(f)||s;return i?(i["_"+n](t),!0):!1},this._handlers={itemchanged:function o(n){e("itemchanged",n)||i.removeEventListener("itemchanged",o)},iteminserted:function o(n){e("iteminserted",n)||i.removeEventListener("iteminserted",o)},itemmoved:function o(n){e("itemmoved",n)||i.removeEventListener("itemmoved",o)},itemremoved:function o(n){e("itemremoved",n)||i.removeEventListener("itemremoved",o)},reload:function o(){e("reload")||i.removeEventListener("reload",o)}},y(this._list,this._handlers))},{_itemchanged:function(n){var e=n.detail.key,i=n.detail.index,t,r,u,f;this._updateAffectedRange(i,"changed");t=n.detail.newItem;r=this._retained[i];r?(u=this._notificationHandler,r.index!==i&&(f=r.index,r.index=i,u&&u.indexChanged&&u.indexChanged(t.key,i,f)),t=s(this._list,t,i),t._retainedCount=r._retainedCount,this._retained[i]=t,this._retainedKeys[e]=t,this._beginEdits(this._list.length),u&&u.changed&&u.changed(t,r),this._endEdits()):(this._beginEdits(this._list.length),this._endEdits())},_iteminserted:function(n){var t=n.detail.index,r,i;this._updateAffectedRange(t,"inserted");this._beginEdits(this._list.length-1);t<=this._pos&&(this._pos=Math.min(this._pos+1,this._list.length));r=this._retained;r.splice(t,0,0);delete r[t];(this._shouldNotify(t)||this._list.length===1)&&(i=this._notificationHandler,i&&i.inserted&&i.inserted(h(this,s(this._list,this._list.getItem(t),t)),l(this._list,t),c(this._list,t)));this._endEdits()},_itemmoved:function(n){var r=n.detail.oldIndex,t=n.detail.newIndex,u,i;this._updateAffectedRange(r,"moved");this._updateAffectedRange(t,"moved");this._beginEdits(this._list.length);(r<this._pos||t<=this._pos)&&(t>this._pos?this._pos=Math.max(-1,this._pos-1):r>this._pos&&(this._pos=Math.min(this._pos+1,this._list.length)));u=this._retained;i=u.splice(r,1)[0];u.splice(t,0,i);i||(delete u[t],i=s(this._list,this._list.getItem(t),t));i._moved=!0;this._addRef(i,t);this._endEdits()},_itemremoved:function(n){var r=n.detail.key,t=n.detail.index,i;this._updateAffectedRange(t,"removed");this._beginEdits(this._list.length+1);t<this._pos&&(this._pos=Math.max(-1,this._pos-1));var u=this._retained,f=this._retainedKeys,e=t in u;u.splice(t,1);delete f[r];i=this._notificationHandler;e&&i&&i.removed&&i.removed(r,!1);this._endEdits()},_reload:function(){this._retained=[];this._retainedKeys={};var n=this._notificationHandler;n&&n.reload&&n.reload()},_addRef:function(n,t){t in this._retained?this._retained[t]._retainedCount++:(this._retained[t]=n,this._retainedKeys[n.key]=n,n._retainedCount=1)},_release:function(n,t){var i=this._retained[t];i&&(i._retainedCount===1?(delete this._retained[t],delete this._retainedKeys[i.key]):i._retainedCount--)},_shouldNotify:function(n){var t=this._retained;return n in t||n+1 in t||n-1 in t},_updateAffectedRange:function(n,t){if(this._notificationHandler.affectedRange){var i=n,r=t!=="removed"?n+1:n;if(this._affectedRange){switch(t){case"inserted":n<=this._affectedRange.end&&++this._affectedRange.end;break;case"removed":n<this._affectedRange.end&&--this._affectedRange.end}this._affectedRange.start=Math.min(this._affectedRange.start,i);this._affectedRange.end=Math.max(this._affectedRange.end,r)}else this._affectedRange={start:i,end:r}}},_notifyAffectedRange:function(){this._affectedRange&&(this._notificationHandler&&this._notificationHandler.affectedRange&&this._notificationHandler.affectedRange(this._affectedRange),this._affectedRange=null)},_notifyCountChanged:function(){var t=this._countAtBeginEdits,i=this._list.length,n;t!==i&&(n=this._notificationHandler,n&&n.countChanged&&n.countChanged(i,t))},_notifyIndicesChanged:function(){for(var n,r,f,i,u=this._retained,t=0,e=u.length;t<e;t++)n=u[t],n&&n.index!==t&&(r=t,f=n.index,n.index=r,i=this._notificationHandler,i&&i.indexChanged&&i.indexChanged(n.key,r,f))},_notifyMoved:function(){for(var t,i,r=this._retained,n=0,u=r.length;n<u;n++)t=r[n],t&&t._moved&&(t._moved=!1,this._release(t,n),this._shouldNotify(n)&&(i=this._notificationHandler,i&&i.moved&&i.moved(h(this,t),l(this._list,n),c(this._list,n))))},_beginEdits:function(n,t){var i,r;this._editsCount++;i=this._notificationHandler;this._editsCount===1&&i&&(t||(this._editsCount++,r=this,e.schedule(function(){r._endEdits()},e.Priority.high,null,"WinJS.Binding.List._endEdits")),i.beginNotifications&&i.beginNotifications(),this._countAtBeginEdits=n)},_endEdits:function(){this._editsCount--;var n=this._notificationHandler;this._editsCount===0&&n&&(this._notifyIndicesChanged(),this._notifyMoved(),this._notifyCountChanged(),this._notifyAffectedRange(),n.endNotifications&&n.endNotifications())},jumpToItem:function(n){var t=this._list.indexOfKey(n.handle);return t===-1?f.wrap(null):(this._pos=t,this.current())},current:function(){return this.fromIndex(this._pos)},previous:function(){return this._pos=Math.max(-1,this._pos-1),this._fromIndex(this._pos,!0,"previous")},next:function(){return this._pos=Math.min(this._pos+1,this._list.length),this._fromIndex(this._pos,!0,"next")},releaseItem:function(n){n.release?n.release():this._release(n,this._list.indexOfKey(n.key))},release:function(){this._notificationHandler&&p(this._list,this._handlers);this._notificationHandler=null;this._dataSource._releaseBinding(this);this._released=!0},first:function(){return this.fromIndex(0)},last:function(){return this.fromIndex(this._list.length-1)},fromKey:function(n){var t=this._retainedKeys,i;return i=n in t?t[n]:s(this._list,this._list.getItemFromKey(n),this._list.indexOfKey(n)),h(this,i)},fromIndex:function(n){return this._fromIndex(n,!1,"fromIndex")},_fromIndex:function(n,t,i){var u=this._retained,r;return r=n in u?u[n]:s(this._list,this._list.getItem(n),n),t?k(this,r,i):h(this,r)}},{supportedForProcessing:!1}),ht=0;return i.Class.define(function(n){this._usingWeakRef=t.msSetWeakWinRTProperty&&t.msGetWeakWinRTProperty;this._bindings={};this._list=n;n.unshift&&(this.insertAtStart=g);n.push&&(this.insertAtEnd=it);n.setAt&&(this.change=rt);n.splice&&(this.insertAfter=tt,this.insertBefore=nt,this.remove=st);n.move&&(this.moveAfter=et,this.moveBefore=ft,this.moveToEnd=ot,this.moveToStart=ut)},{_releaseBinding:function(n){delete this._bindings[n._id]},addEventListener:function(){},removeEventListener:function(){},createListBinding:function(n){var t="ds_"+ ++ht,i=new d(this,this._list,n,t);return i._id=t,this._usingWeakRef?(u._createWeakRef(i,t),this._bindings[t]=t):this._bindings[t]=i,i},getCount:function(){return f.wrap(this._list.length)},itemFromKey:function(n){var t=this._list,i=s(t,t.getItemFromKey(n),-1);return Object.defineProperty(i,"index",{get:function(){return t.indexOfKey(n)},enumerable:!1,configurable:!0}),f.wrap(i)},itemFromIndex:function(n){return f.wrap(s(this._list,this._list.getItem(n),n))},list:{get:function(){return this._list}},beginEdits:function(){var n=this._list.length;this._forEachBinding(function(t){t._beginEdits(n,!0)})},endEdits:function(){this._forEachBinding(function(n){n._endEdits()})},_forEachBinding:function(n){var t,i,r,f;if(this._usingWeakRef)for(t=[],Object.keys(this._bindings).forEach(function(i){var r=u._getWeakRefElement(i);r?n(r):t.push(i)}),i=0,r=t.length;i<r;i++)delete this._bindings[t[i]];else f=this,Object.keys(this._bindings).forEach(function(t){n(f._bindings[t])})},invalidateAll:function(){return f.wrap()},moveAfter:undefined,moveBefore:undefined,moveToEnd:undefined,moveToStart:undefined},{supportedForProcessing:!1})})})}),t("WinJS/BindingList",["exports","./Core/_Base","./Core/_BaseUtils","./Core/_ErrorFromName","./Core/_Events","./Core/_Resources","./Binding/_Data","./BindingList/_BindingListDataSource"],function(n,t,i,r,u,f,e,o){"use strict";function l(n){return Array.prototype.slice.call(n,0)}function c(n){return{handle:n.handle,key:n.key,data:n.data,groupKey:n.groupKey,groupSize:n.groupSize,firstItemKey:n.firstItemKey,firstItemIndexHint:n.firstItemIndexHint}}function s(n){return n===undefined?undefined:+n}function p(n,t){function u(t,r){for(;t<r;t++)n[t]=i[t]}function r(n,t){if(!(t-n<2)){var i=Math.floor((t+n)/2);r(n,i);r(i,t);f(n,i,t);u(n,t)}}function f(r,u,f){for(var e=r,o=u,s=r;s<f;s++)e<u&&(o>=f||t(n[e],n[o])<=0)?(i[s]=n[e],e++):(i[s]=n[o],o++)}var i=new Array(n.length);return r(0,n.length),n}var v={get sparseArrayNotSupported(){return"Sparse arrays are not supported with proxy: true"},get illegalListLength(){return"List length must be assigned a finite positive number"}},a=u._createEventProperty,y={},h=t.Namespace.defineWithParent(null,null,{ListBase:t.Namespace._lazy(function(){var n=t.Class.define(null,{_annotateWithIndex:function(n,t){var i=c(n);return i.index=t,i},onitemchanged:a("itemchanged"),oniteminserted:a("iteminserted"),onitemmoved:a("itemmoved"),onitemmutated:a("itemmutated"),onitemremoved:a("itemremoved"),onreload:a("reload"),_notifyItemChanged:function(n,t,i,r,u,f){this._listeners&&this._listeners.itemchanged&&this.dispatchEvent("itemchanged",{key:n,index:t,oldValue:i,newValue:r,oldItem:u,newItem:f})},_notifyItemInserted:function(n,t,i){this._listeners&&this._listeners.iteminserted&&this.dispatchEvent("iteminserted",{key:n,index:t,value:i});var r=this.length;r!==this._lastNotifyLength&&(this.notify("length",r,this._lastNotifyLength),this._lastNotifyLength=r)},_notifyItemMoved:function(n,t,i,r){this._listeners&&this._listeners.itemmoved&&this.dispatchEvent("itemmoved",{key:n,oldIndex:t,newIndex:i,value:r})},_notifyItemMutated:function(n,t,i){this._listeners&&this._listeners.itemmutated&&this.dispatchEvent("itemmutated",{key:n,value:t,item:i})},_notifyItemRemoved:function(n,t,i,r){this._listeners&&this._listeners.itemremoved&&this.dispatchEvent("itemremoved",{key:n,index:t,value:i,item:r});var u=this.length;u!==this._lastNotifyLength&&(this.notify("length",u,this._lastNotifyLength),this._lastNotifyLength=u)},_notifyReload:function(){if(this._listeners&&this._listeners.reload&&this.dispatchEvent("reload"),n!==this._lastNotifyLength){var n=this.length;this.notify("length",n,this._lastNotifyLength);this._lastNotifyLength=n}},_normalizeIndex:function(n){return n=s(n),n<0?this.length+n:n},_notifyMutatedFromKey:function(n){var t=this.getItemFromKey(n);this._notifyItemMutated(n,t.data,t)},notifyReload:function(){this._notifyReload()},getAt:function(n){n=s(n);var t=this.getItem(n);return t&&t.data},_getArray:function(){for(var t,i=new Array(this.length),n=0,r=this.length;n<r;n++)t=this.getItem(n),t&&(i[n]=t.data);return i},_getFromKey:function(n){var t=this.getItemFromKey(n);return t&&t.data},_getKey:function(n){n=s(n);var t=this.getItem(n);return t&&t.key},concat:function(){var n=this._getArray();return n.concat.apply(n,arguments)},join:function(n){return this._getArray().join(n||",")},slice:function(n,t){return this._getArray().slice(n,t)},indexOf:function(n,t){var i,u,r;for(t=s(t),t=Math.max(0,this._normalizeIndex(t)||0),i=t,u=this.length;i<u;i++)if(r=this.getItem(i),r&&r.data===n)return i;return-1},lastIndexOf:function(n,t){var r,i,u;for(t=s(t),r=this.length,t=Math.min(this._normalizeIndex(t!==undefined?t:r),r-1),i=t;i>=0;i--)if(u=this.getItem(i),u&&u.data===n)return i;return-1},every:function(n,t){return this._getArray().every(n,t)},filter:function(n,t){return this._getArray().filter(n,t)},forEach:function(n,t){this._getArray().forEach(n,t)},map:function(n,t){return this._getArray().map(n,t)},some:function(n,t){return this._getArray().some(n,t)},reduce:function(n,t){return arguments.length>1?this._getArray().reduce(n,t):this._getArray().reduce(n)},reduceRight:function(n,t){return arguments.length>1?this._getArray().reduceRight(n,t):this._getArray().reduceRight(n)},createFiltered:function(n){return new h.FilteredListProjection(this,n)},createGrouped:function(n,t,i){return new h.GroupedSortedListProjection(this,n,t,i)},createSorted:function(n){return new h.SortedListProjection(this,n)},dataSource:{get:function(){return this._dataSource=this._dataSource||new o._BindingListDataSource(this)}}},{supportedForProcessing:!1});return t.Class.mix(n,e.observableMixin),t.Class.mix(n,u.eventMixin),n}),ListBaseWithMutators:t.Namespace._lazy(function(){return t.Class.derive(h.ListBase,null,{pop:function(){return this.splice(-1,1)[0]},push:function(n){if(arguments.length===1)return this.splice(this.length,0,n),this.length;var t=l(arguments);return t.splice(0,0,this.length,0),this.splice.apply(this,t),this.length},shift:function(){return this.splice(0,1)[0]},unshift:function(n){if(arguments.length===1)this.splice(0,0,n);else{var t=l(arguments);t.splice(0,0,0,0);this.splice.apply(this,t)}return this.length}},{supportedForProcessing:!1})}),ListProjection:t.Namespace._lazy(function(){return t.Class.derive(h.ListBaseWithMutators,null,{_list:null,_myListeners:null,_addListListener:function(n,t){var i={name:n,handler:t.bind(this)};this._myListeners=this._myListeners||[];this._myListeners.push(i);this._list.addEventListener(n,i.handler)},dispose:function(){var f=this._list,r=this._myListeners,t,u,i;for(this._myListeners=[],t=0,u=r.length;t<u;t++)i=r[t],f.removeEventListener(i.name,i.handler);this._list=new n.List;this._listReload()},getItemFromKey:function(n){return this._list.getItemFromKey(n)},move:function(n,t){(n=s(n),t=s(t),n===t||n<0||t<0||n>=this.length||t>=this.length)||(n=this._list.indexOfKey(this._getKey(n)),t=this._list.indexOfKey(this._getKey(t)),this._list.move(n,t))},_notifyMutatedFromKey:function(n){this._list._notifyMutatedFromKey(n)},splice:function(n){n=s(n);n=Math.max(0,this._normalizeIndex(n));var t=l(arguments);return n===this.length?(t[0]=this._list.length,this._list.splice.apply(this._list,t)):(t[0]=this._getKey(n),this._spliceFromKey.apply(this,t))},_setAtKey:function(n,t){this._list._setAtKey(n,t)}},{supportedForProcessing:!1})}),FilteredListProjection:t.Namespace._lazy(function(){return t.Class.derive(h.ListProjection,function(n,t){this._list=n;this._addListListener("itemchanged",this._listItemChanged);this._addListListener("iteminserted",this._listItemInserted);this._addListListener("itemmutated",this._listItemMutated);this._addListListener("itemmoved",this._listItemMoved);this._addListListener("itemremoved",this._listItemRemoved);this._addListListener("reload",this._listReload);this._filter=t;this._initFilteredKeys()},{_filter:null,_filteredKeys:null,_initFilteredKeys:function(){for(var n,u=this._filter,i=this._list,r=[],t=0,f=i.length;t<f;t++)n=i.getItem(t),n&&u(n.data)&&r.push(n.key);this._filteredKeys=r},_findInsertionPosition:function(n,t){for(var e=this._filter,r,i,u,f;--t>=0;)if(i=this._list.getItem(t),i&&e(i.data)){r=i.key;break}return u=this._filteredKeys,f=r?u.indexOf(r)+1:0,f},_listItemChanged:function(n){var t=n.detail.key,e=n.detail.index,i=n.detail.oldValue,r=n.detail.newValue,o=n.detail.oldItem,l=n.detail.newItem,s=this._filter,u=s(i),f=s(r),h,c;u&&f?(h=this._filteredKeys,c=h.indexOf(t),this._notifyItemChanged(t,c,i,r,o,l)):u&&!f?this._listItemRemoved({detail:{key:t,index:e,value:i,item:o}}):!u&&f&&this._listItemInserted({detail:{key:t,index:e,value:r}})},_listItemInserted:function(n){var t=n.detail.key,f=n.detail.index,r=n.detail.value,e=this._filter,i,u;e(r)&&(i=this._findInsertionPosition(t,f),u=this._filteredKeys,u.splice(i,0,t),this._notifyItemInserted(t,i,r))},_listItemMoved:function(n){var t=n.detail.key,f=n.detail.newIndex,e=n.detail.value,i=this._filteredKeys,r=i.indexOf(t),u;r!==-1&&(i.splice(r,1),u=this._findInsertionPosition(t,f),i.splice(u,0,t),this._notifyItemMoved(t,r,u,e))},_listItemMutated:function(n){var t=n.detail.key,i=n.detail.value,e=n.detail.item,s=this._filter,o=this._filteredKeys,r=o.indexOf(t),u=r!==-1,f=s(i);u&&f?this._notifyItemMutated(t,i,e):u&&!f?(o.splice(r,1),this._notifyItemRemoved(t,r,i,e)):!u&&f&&this._listItemInserted({detail:{key:t,index:this._list.indexOfKey(t),value:i}})},_listItemRemoved:function(n){var i=n.detail.key,u=n.detail.value,f=n.detail.item,r=this._filteredKeys,t=r.indexOf(i);t!==-1&&(r.splice(t,1),this._notifyItemRemoved(i,t,u,f))},_listReload:function(){this._initFilteredKeys();this._notifyReload()},length:{get:function(){return this._filteredKeys.length},set:function(n){if(typeof n=="number"&&n>=0){var t=this.length;t>n&&this.splice(n,t-n)}else throw new r("WinJS.Binding.List.IllegalLength",v.illegalListLength);}},getItem:function(n){return n=s(n),this.getItemFromKey(this._filteredKeys[n])},indexOfKey:function(n){return this._filteredKeys.indexOf(n)},notifyMutated:function(n){return n=s(n),this._notifyMutatedFromKey(this._filteredKeys[n])},setAt:function(n,t){n=s(n);this._setAtKey(this._filteredKeys[n],t)},_spliceFromKey:function(n,t){var r,u,i,s,n,h;if(arguments.length>2&&(r=l(arguments),r[1]=0,this._list._spliceFromKey.apply(this._list,r)),u=[],t){var e=[],f=this._filteredKeys,o=f.indexOf(n);for(i=o,s=f.length;i<s&&i-o<t;i++)n=f[i],e.push(n);h=this;e.forEach(function(n){u.push(h._list._spliceFromKey(n,1)[0])})}return u}},{supportedForProcessing:!1})}),SortedListProjection:t.Namespace._lazy(function(){return t.Class.derive(h.ListProjection,function(n,t){this._list=n;this._addListListener("itemchanged",this._listItemChanged);this._addListListener("iteminserted",this._listItemInserted);this._addListListener("itemmoved",this._listItemMoved);this._addListListener("itemmutated",this._listItemMutated);this._addListListener("itemremoved",this._listItemRemoved);this._addListListener("reload",this._listReload);this._sortFunction=t;this._initSortedKeys()},{_sortFunction:null,_sortedKeys:null,_initSortedKeys:function(){for(var i,u,f,n=this._list,r=[],t=0,e=n.length;t<e;t++)i=n.getItem(t),i&&(r[t]=i.key);u=this._sortFunction;f=p(r,function(t,i){return t=n.getItemFromKey(t).data,i=n.getItemFromKey(i).data,u(t,i)});this._sortedKeys=f},_findInsertionPos:function(n,t,i,r,u){for(var a=this._sortFunction,c=this._sortedKeys,f=Math.max(0,r||-1),o=Math.min(c.length,u||Number.MAX_VALUE),e=f,s,l,h;f<=o;){if(e=(f+o)/2>>>0,s=c[e],!s)break;if(l=this.getItemFromKey(s),h=a(l.data,i),h<0)f=e+1;else{if(h===0)return this._findStableInsertionPos(n,t,f,o,e,i);o=e-1}}return f},_findBeginningOfGroup:function(n,t,i,r,u){for(var f=0,e=n;f<=e;){n=(f+e)/2>>>0;var o=r[n],s=i.getItemFromKey(o),h=t(s.data,u);h<0?f=n+1:e=n-1}return f},_findEndOfGroup:function(n,t,i,r,u){for(var f=n,e=r.length,o,s,h;f<=e;){if(n=(f+e)/2>>>0,o=r[n],!o)return r.length;s=i.getItemFromKey(o);h=t(s.data,u);h<=0?f=n+1:e=n-1}return f},_findStableInsertionPos:function(n,t,i,r,u,f){var h=this._list,c=h.length,l=this._sortFunction,s=this._sortedKeys,e,o;if(t<c/2){for(e=t-1;e>=0;e--)if(o=h.getItem(e),l(o.data,f)===0)return c-i>r?s.indexOf(o.key,i)+1:s.lastIndexOf(o.key,r)+1;return this._findBeginningOfGroup(u,l,h,s,f)}for(e=t+1;e<c;e++)if(o=h.getItem(e),l(o.data,f)===0)return c-i>r?s.indexOf(o.key,i):s.lastIndexOf(o.key,r);return this._findEndOfGroup(u,l,h,s,f)},_listItemChanged:function(n){var t=n.detail.key,i=n.detail.newValue,r=n.detail.oldValue,f=this._sortFunction,u;f(r,i)===0?(u=this.indexOfKey(t),this._notifyItemChanged(t,u,r,i,n.detail.oldItem,n.detail.newItem)):(this._listItemRemoved({detail:{key:t,index:n.detail.index,value:n.detail.oldValue,item:n.detail.oldItem}}),this._listItemInserted({detail:{key:t,index:n.detail.index,value:n.detail.newValue}}))},_listItemInserted:function(n,t,i){var r=n.detail.key,e=n.detail.index,u=n.detail.value,f=this._findInsertionPos(r,e,u,t,i);this._sortedKeys.splice(f,0,r);this._notifyItemInserted(r,f,u)},_listItemMoved:function(n,t,i){var r=n.detail.key,s=n.detail.newIndex,o=n.detail.value,f=this._sortedKeys,e=f.indexOf(r,t),u;f.splice(e,1);u=this._findInsertionPos(r,s,o,t,i);f.splice(u,0,r);u!==e&&this._notifyItemMoved(r,e,u,o)},_listItemMutated:function(n){var t=n.detail.key,i=n.detail.value,f=n.detail.item,r=this._list.indexOfKey(t),u=this._sortedKeys.indexOf(t),e;if(this._sortedKeys.splice(u,1),e=this._findInsertionPos(t,r,i),this._sortedKeys.splice(u,0,t),u===e){this._notifyItemMutated(t,i,f);return}this._listItemRemoved({detail:{key:t,index:r,value:i,item:f}});this._listItemInserted({detail:{key:t,index:r,value:i}})},_listItemRemoved:function(n,t){var i=n.detail.key,f=n.detail.value,e=n.detail.item,r=this._sortedKeys,u=r.indexOf(i,t);r.splice(u,1);this._notifyItemRemoved(i,u,f,e)},_listReload:function(){this._initSortedKeys();this._notifyReload()},length:{get:function(){return this._sortedKeys.length},set:function(n){if(typeof n=="number"&&n>=0){var t=this.length;t>n&&this.splice(n,t-n)}else throw new r("WinJS.Binding.List.IllegalLength",v.illegalListLength);}},getItem:function(n){return n=s(n),this.getItemFromKey(this._sortedKeys[n])},indexOfKey:function(n){return this._sortedKeys.indexOf(n)},notifyMutated:function(n){n=s(n);this._notifyMutatedFromKey(this._sortedKeys[n])},setAt:function(n,t){n=s(n);this._setAtKey(this._sortedKeys[n],t)},_spliceFromKey:function(n,t){var r,u,i,s,h;if(arguments.length>2&&(r=l(arguments),r[1]=0,this._list._spliceFromKey.apply(this._list,r)),u=[],t){var e=[],f=this._sortedKeys,o=f.indexOf(n);for(i=o,s=f.length;i<s&&i-o<t;i++)e.push(f[i]);h=this;e.forEach(function(n){u.push(h._list._spliceFromKey(n,1)[0])})}return u}},{supportedForProcessing:!1})}),GroupedSortedListProjection:t.Namespace._lazy(function(){return t.Class.derive(h.SortedListProjection,function(n,t,i,r){this._list=n;this._addListListener("itemchanged",this._listGroupedItemChanged);this._addListListener("iteminserted",this._listGroupedItemInserted);this._addListListener("itemmoved",this._listGroupedItemMoved);this._addListListener("itemmutated",this._listGroupedItemMutated);this._addListListener("itemremoved",this._listGroupedItemRemoved);this._addListListener("reload",this._listReload);this._sortFunction=function(n,i){return n=t(n),i=t(i),r?r(n,i):n<i?-1:n===i?0:1};this._groupKeyOf=t;this._groupDataOf=i;this._initSortedKeys();this._initGroupedItems()},{_groupKeyOf:null,_groupDataOf:null,_groupedItems:null,_initGroupedItems:function(){for(var n,i={},r=this._list,u=this._groupKeyOf,t=0,f=r.length;t<f;t++)n=c(r.getItem(t)),n.groupKey=u(n.data),i[n.key]=n;this._groupedItems=i},_groupsProjection:null,_listGroupedItemChanged:function(n){var i=n.detail.key,e=n.detail.oldValue,r=n.detail.newValue,o=this._groupedItems,u=o[i],t=c(u),f;t.data=r;t.groupKey=this._groupKeyOf(r);o[i]=t;u.groupKey===t.groupKey?(f=this.indexOfKey(i),this._notifyItemChanged(i,f,e,r,u,t)):(f=n.detail.index,this._listItemChanged({detail:{key:i,index:f,oldValue:e,newValue:r,oldItem:u,newItem:t}}))},_listGroupedItemInserted:function(n){var i=n.detail.key,u=n.detail.value,f=this._groupKeyOf(u),r,e,t;this._groupedItems[i]={handle:i,key:i,data:u,groupKey:f};this._groupsProjection&&(t=this._groupsProjection._groupItems[f],t&&(r=t.firstItemIndexHint,e=r+t.groupSize));this._listItemInserted(n,r,e)},_listGroupedItemMoved:function(n){var t,r,u=this._groupedItems[n.detail.key].groupKey,i;this._groupsProjection&&(i=this._groupsProjection._groupItems[u],t=i.firstItemIndexHint,r=t+i.groupSize);this._listItemMoved(n,t,r)},_listGroupedItemMutated:function(n){var t=n.detail.key,i=n.detail.value,e=this._groupedItems,r=e[t],o=this._groupKeyOf(i),u,f;r.groupKey===o?this._notifyItemMutated(t,i,r):(u=c(r),u.groupKey=o,e[t]=u,f=this._list.indexOfKey(t),this._listItemRemoved({detail:{key:t,index:f,value:i,item:r}}),this._listItemInserted({detail:{key:t,index:f,value:i}}))},_listGroupedItemRemoved:function(n){var t=n.detail.key,o=n.detail.index,s=n.detail.value,u=this._groupedItems,f=u[t],i,e,r;delete u[t];this._groupsProjection&&(r=this._groupsProjection._groupItems[f.groupKey],i=r.firstItemIndexHint,e=i+r.groupSize);this._listItemRemoved({detail:{key:t,index:o,value:s,item:f}},i,e)},_listReload:function(){this._initGroupedItems();h.SortedListProjection.prototype._listReload.call(this)},groups:{get:function(){return this._groupsProjection===null&&(this._groupsProjection=new h.GroupsListProjection(this,this._groupKeyOf,this._groupDataOf)),this._groupsProjection}},getItemFromKey:function(n){return this._groupedItems[n]}},{supportedForProcessing:!1})}),GroupsListProjection:t.Namespace._lazy(function(){return t.Class.derive(h.ListBase,function(n,t,i){this._list=n;this._addListListener("itemchanged",this._listItemChanged);this._addListListener("iteminserted",this._listItemInserted);this._addListListener("itemmoved",this._listItemMoved);this._addListListener("itemremoved",this._listItemRemoved);this._addListListener("reload",this._listReload);this._groupKeyOf=t;this._groupDataOf=i;this._initGroupKeysAndItems()},{_list:null,_addListListener:function(n,t){this._list.addEventListener(n,t.bind(this))},_groupDataOf:null,_groupKeyOf:null,_groupOf:function(n){return this.getItemFromKey(this._groupKeyOf(n.data))},_groupKeys:null,_groupItems:null,_initGroupKeysAndItems:function(){for(var u,n,h=this._groupDataOf,f=this._list,e={},o=[],s=null,t=null,i,r=0,c=f.length;r<c;r++)u=f.getItem(r),n=u.groupKey,n!==s?(t&&(t.groupSize=i),i=1,s=n,t={handle:n,key:n,data:h(u.data),firstItemKey:u.key,firstItemIndexHint:r},e[n]=t,o.push(n)):i++;t&&(t.groupSize=i);this._groupKeys=o;this._groupItems=e},_listItemChanged:function(n){var u=n.detail.key,e=n.detail.index,o=n.detail.newValue,s=this._list,i=s.getItemFromKey(u).groupKey,f=this._groupItems,r=f[i],t;r.firstItemIndexHint===e&&(t=c(r),t.data=this._groupDataOf(o),t.firstItemKey=u,f[i]=t,this._notifyItemChanged(i,this._groupKeys.indexOf(i),r.data,t.data,r,t))},_listItemInserted:function(n){var a=n.detail.key,h=n.detail.index,v=n.detail.value,y=this._list,r=y.getItemFromKey(a).groupKey,e=this._groupItems,o=this._groupKeys,f=e[r],s,u,t,i,l;if(f)u=f,t=c(u),t.groupSize++,u.firstItemIndexHint===h&&(t.groupData=this._groupDataOf(v),t.firstItemKey=a,t.firstItemIndexHint=h),e[r]=t,s=o.indexOf(r),this._notifyItemChanged(r,s,u.data,t.data,u,t);else{for(i=0,l=o.length;i<l;i++)if(f=e[o[i]],f.firstItemIndexHint>=h)break;s=i;f={handle:r,key:r,data:this._groupDataOf(v),groupSize:1,firstItemKey:a,firstItemIndexHint:h};o.splice(s,0,r);e[r]=f;this._notifyItemInserted(r,s,f.data)}for(i=s+1,l=o.length;i<l;i++)u=e[o[i]],t=c(u),t.firstItemIndexHint++,e[t.key]=t,this._notifyItemChanged(t.key,i,u.data,t.data,u,t)},_listItemMoved:function(n){var o=n.detail.key,s=n.detail.oldIndex,h=n.detail.newIndex,f=this._list,r=f.getItemFromKey(o).groupKey,e=this._groupItems,t=e[r],u,i;(t.firstItemIndexHint===h||t.firstItemIndexHint===s)&&(u=f.getItem(t.firstItemIndexHint),i=c(t),i.data=this._groupDataOf(u.data),i.firstItemKey=u.key,e[r]=i,this._notifyItemChanged(r,this._groupKeys.indexOf(r),t.data,i.data,t,i))},_listItemRemoved:function(n){var l=n.detail.index,v=n.detail.item,u=this._groupItems,o=this._groupKeys,r=v.groupKey,s=u[r],f=o.indexOf(r),i,t,h,e,a;for(s.groupSize===1?(o.splice(f,1),delete u[r],this._notifyItemRemoved(r,f,s.data,s),f--):(i=s,t=c(i),t.groupSize--,i.firstItemIndexHint===l&&(h=this._list.getItem(l),t.data=this._groupDataOf(h.data),t.firstItemKey=h.key),u[r]=t,this._notifyItemChanged(r,f,i.data,t.data,i,t)),e=f+1,a=o.length;e<a;e++)i=u[o[e]],t=c(i),t.firstItemIndexHint--,u[t.key]=t,this._notifyItemChanged(t.key,e,i.data,t.data,i,t)},_listReload:function(){this._initGroupKeysAndItems();this._notifyReload()},length:{get:function(){return this._groupKeys.length}},getItem:function(n){return n=s(n),this._groupItems[this._groupKeys[n]]},getItemFromKey:function(n){return this._groupItems[n]},indexOfKey:function(n){return this._groupKeys.indexOf(n)}},{supportedForProcessing:!1})})});t.Namespace._moduleDefine(n,"WinJS.Binding",{List:t.Namespace._lazy(function(){return t.Class.derive(h.ListBaseWithMutators,function(n,t){var s,f,o;if(this._currentKey=0,this._keys=null,this._keyMap={},t=t||y,this._proxy=t.proxy,this._binding=t.binding,this._proxy){if(Object.keys(n).length!==n.length)throw new r("WinJS.Binding.List.NotSupported",v.sparseArrayNotSupported);this._data=n;this._currentKey=n.length}else if(n){var h=this._keyMap,u=0,i=0;for(s=n.length;i<s;i++)i in n&&(f=n[i],this._binding&&(f=e.as(f)),o=u.toString(),u++,h[o]={handle:o,key:o,data:f});u!==i&&this._initializeKeys();this._currentKey=u}},{_currentKey:0,_keys:null,_keyMap:null,_modifyingData:0,_initializeKeys:function(){var i,f,r,n,o,t,u;if(!this._keys){if(i=[],this._data)for(f=this._keyMap,r=this._data,n=0,o=r.length;n<o;n++)n in r&&(t=n.toString(),i[n]=t,t in f||(u=r[n],this._binding&&(u=e.as(u)),f[t]={handle:t,key:t,data:u}));else Object.keys(this._keyMap).forEach(function(n){i[n>>>0]=n});this._keys=i}},_lazyPopulateEntry:function(n){var t,r,i;if(this._data&&n in this._data)return t=this._data[n],this._binding&&(t=e.as(t)),r=n.toString(),i={handle:r,key:r,data:t},this._keyMap[i.key]=i,i},_assignKey:function(){return(++this._currentKey).toString()},length:{get:function(){return this._data?this._data.length:this._keys?this._keys.length:this._currentKey},set:function(n){if(typeof n=="number"&&n>=0){this._initializeKeys();var t=this.length;if(t>n?this.splice(n,t-n):n=t,this._data){this._modifyingData++;try{this._data.length=n}finally{this._modifyingData--}}this._keys&&(this._keys.length=n)}else throw new r("WinJS.Binding.List.IllegalLength",v.illegalListLength);}},getItem:function(n){var i,t;return n=s(n),this._keys?(t=this._keys[n],i=t&&this._keyMap[t]):(t=n.toString(),i=this._keyMap[t]||this._lazyPopulateEntry(n)),i},getItemFromKey:function(n){return this._keys||!this._data?this._keyMap[n]:this.getItem(n>>>0)},indexOfKey:function(n){var t=-1,i;return this._keys?t=this._keys.indexOf(n):(i=n>>>0,i<this._currentKey&&(t=i)),t},move:function(n,t){var r,i;if(n=s(n),t=s(t),this._initializeKeys(),n!==t&&!(n<0)&&!(t<0)&&!(n>=this.length)&&!(t>=this.length)){if(this._data){this._modifyingData++;try{r=this._data.splice(n,1)[0];this._data.splice(t,0,r)}finally{this._modifyingData--}}i=this._keys.splice(n,1)[0];this._keys.splice(t,0,i);this._notifyItemMoved(i,n,t,this.getItemFromKey(i).data)}},notifyMutated:function(n){n=s(n);var t=this._keys?this._keys[n]:n.toString();this._notifyMutatedFromKey(t)},setAt:function(n,t){var i;if(n=s(n),this._initializeKeys(),i=this.length,n===i)this.push(t);else if(n<i){if(this._data){this._modifyingData++;try{this._data[n]=t}finally{this._modifyingData--}}if(this._binding&&(t=e.as(t)),n in this._keys){var r=this._keys[n],u=this._keyMap[r],f=c(u);f.data=t;this._keyMap[r]=f;this._notifyItemChanged(r,n,u.data,t,u,f)}}},_setAtKey:function(n,t){this.setAt(this.indexOfKey(n),t)},reverse:function(){if(this._initializeKeys(),this._data){this._modifyingData++;try{this._data.reverse()}finally{this._modifyingData--}}return this._keys.reverse(),this._notifyReload(),this},sort:function(n){if(this._initializeKeys(),this._data){this._modifyingData++;try{this._data.sort(n)}finally{this._modifyingData--}}var t=this;return this._keys.sort(function(i,r){return(i=t._keyMap[i],r=t._keyMap[r],n)?n(i.data,r.data):(i=(i&&i.data||"").toString(),r=(i&&r.data||"").toString(),i<r?-1:i===r?0:1)}),this._notifyReload(),this},pop:function(){if(this.length!==0){this._initializeKeys();var n=this._keys.pop(),t=this._keyMap[n],i=t&&t.data;if(this._data){this._modifyingData++;try{this._data.pop()}finally{this._modifyingData--}}return delete this._keyMap[n],this._notifyItemRemoved(n,this._keys.length,i,t),i}},push:function(){var r,t,i,n;for(this._initializeKeys(),r=arguments.length,t=0;t<r;t++){if(i=arguments[t],this._binding&&(i=e.as(i)),n=this._assignKey(),this._keys.push(n),this._data){this._modifyingData++;try{this._data.push(arguments[t])}finally{this._modifyingData--}}this._keyMap[n]={handle:n,key:n,data:i};this._notifyItemInserted(n,this._keys.length-1,i)}return this.length},shift:function(){if(this.length!==0){this._initializeKeys();var n=this._keys.shift(),t=this._keyMap[n],i=t&&t.data;if(this._data){this._modifyingData++;try{this._data.shift()}finally{this._modifyingData--}}return delete this._keyMap[n],this._notifyItemRemoved(n,0,i,t),i}},unshift:function(){var r,t,i,n;for(this._initializeKeys(),r=arguments.length,t=r-1;t>=0;t--){if(i=arguments[t],this._binding&&(i=e.as(i)),n=this._assignKey(),this._keys.unshift(n),this._data){this._modifyingData++;try{this._data.unshift(arguments[t])}finally{this._modifyingData--}}this._keyMap[n]={handle:n,key:n,data:i};this._notifyItemInserted(n,0,i)}return this.length},splice:function(n,t){var o,i,a,u,f,r;for(n=s(n),this._initializeKeys(),n=Math.max(0,this._normalizeIndex(n)),t=Math.max(0,Math.min(t||0,this.length-n)),o=[];t;){var h=this._keys[n],c=this._keyMap[h],l=c&&c.data;if(o.push(l),this._keys.splice(n,1),this._data){this._modifyingData++;try{this._data.splice(n,1)}finally{this._modifyingData--}}delete this._keyMap[h];this._notifyItemRemoved(h,n,l,c);--t}if(arguments.length>2)for(i=2,a=arguments.length;i<a;i++){if(u=arguments[i],this._binding&&(u=e.as(u)),f=Math.min(n+i-2,this.length),r=this._assignKey(),this._keys.splice(f,0,r),this._data){this._modifyingData++;try{this._data.splice(f,0,arguments[i])}finally{this._modifyingData--}}this._keyMap[r]={handle:r,key:r,data:u};this._notifyItemInserted(r,f,u)}return o},_spliceFromKey:function(n){this._initializeKeys();var t=l(arguments);return t[0]=this._keys.indexOf(n),this.splice.apply(this,t)}},{supportedForProcessing:!1})})})}),t("WinJS/Res",["exports","./Core/_Global","./Core/_Base","./Core/_BaseUtils","./Core/_ErrorFromName","./Core/_Resources","./ControlProcessor/_OptionsParser","./Promise"],function(n,t,i,r,u,f,e,o){"use strict";function s(n,i){var i,p,w,y,s,b,f,c,a;if(n=n||t.document.body,i=i||0,i<4){if(i===0&&n.getAttribute&&(p=n.getAttribute("data-win-res"),p&&(a=e.optionsParser(p),h(n,n,a,i))),w="[data-win-res],[data-win-control]",y=n.querySelectorAll(w),y.length===0)return o.as(n);for(s=0,b=y.length;s<b;s++)(f=y[s],f.winControl&&f.winControl.constructor&&f.winControl.constructor.isDeclarativeControlContainer&&(c=f.winControl.constructor.isDeclarativeControlContainer,typeof c=="function"&&(c=l(c),c(f.winControl,v),s+=f.querySelectorAll(w).length)),f.hasAttribute("data-win-res"))&&(a=e.optionsParser(f.getAttribute("data-win-res")),h(f,f,a,i))}else if(r.validation)throw new u("WinJS.Res.NestingExceeded","NestingExceeded");return o.as(n)}function y(n,t){for(var e=Object.keys(t),u=0,h=e.length;u<h;u++){var o=e[u],s=t[o],i=f.getString(s);i&&i.empty?r.validation&&a(s):(n.setAttribute(o,i.value),i.lang!==undefined&&n.lang!==undefined&&n.lang!==i.lang&&(n.lang=i.lang))}}function a(n){throw new u("WinJS.Res.NotFound",f._formatString("NotFound: {0}",n));}function h(n,t,i,u){var p=Object.keys(i),v,w,o,c,e;for(t=l(t),v=0,w=p.length;v<w;v++)o=p[v],c=i[o],typeof c=="string"?(e=f.getString(c),e&&e.empty?r.validation&&a(c):(t[o]=e.value,e.lang!==undefined&&n.lang!==undefined&&n.lang!==e.lang&&(n.lang=e.lang),o==="innerHTML"&&s(t,u+1))):n===t&&o==="attributes"?y(n,c):h(n,t[o],c,u)}function v(n){if(c)try{return s(n)}catch(t){return o.wrapError(t)}else return r.ready().then(function(){return c=!0,s(n)})}var c=!1,l=r.requireSupportedForProcessing;i.Namespace._moduleDefine(n,"WinJS.Resources",{processAll:v})}),t("WinJS/Pages/_BasePage",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_WriteProfilerMark","../Promise","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s){"use strict";function c(n){var i=t.document.createElement("a");return i.href=n,i.href}function l(n){return t.document.location.href.toLowerCase()===n.toLowerCase()}function y(n,o){var y=v(n);return n=c(n),y||(y=i.Class.define(function(i,e,o,h){var c=this,a,p,v,y;this._disposed=!1;this.element=i=i||t.document.createElement("div");s.addClass(i,"win-disposable");i.msSourceLocation=n;this.uri=n;this.selfhost=l(n);i.winControl=this;s.addClass(i,"pagecontrol");a=" uri='"+n+"'"+r._getProfilerMarkIdentifier(this.element);u("WinJS.UI.Pages:createPage"+a+",StartTM");p=f.wrap().then(function(){return c.load(n)});v=p.then(function(n){return f.join({loadResult:n,initResult:c.init(i,e)})}).then(function(n){return c.render(i,e,n.loadResult)});this.elementReady=v.then(function(){return i});this.renderComplete=v.then(function(){return c.process(i,e)}).then(function(){return c.processed(i,e)}).then(function(){return c});y=function(){o&&o(c);u("WinJS.UI.Pages:createPage"+a+",StopTM")};this.renderComplete.then(y,y);this.readyComplete=this.renderComplete.then(function(){return h}).then(function(){return c.ready(i,e),c}).then(null,function(n){return c.error(n)})},a),y=i.Class.mix(y,e.DOMEventMixin),h[n.toLowerCase()]=y),o&&(y=i.Class.mix(y,o)),y.selfhost=l(n),y}function v(n){return n=c(n),h[n.toLowerCase()]}function p(n){n=c(n);delete h[n.toLowerCase()]}var h,a;t.document&&(h={},a={dispose:function(){this._disposed||(this._disposed=!0,o.disposeSubTree(this.element),this.element=null)},load:function(){},init:function(){},process:function(){},processed:function(){},render:function(){},ready:function(){},error:function(n){return f.wrapError(n)}},i.Namespace._moduleDefine(n,null,{abs:c,define:y,get:v,remove:p,viewMap:h}))}),t("WinJS/Pages",["exports","./Core/_Global","./Core/_Base","./Core/_BaseUtils","./ControlProcessor","./Fragments","./Pages/_BasePage","./Promise",],function(n,t,i,r,u,f,e,o){"use strict";function s(n,u){var f=e.get(n);return f||(f=e.define(n,l)),u&&(f=i.Class.mix(f,u)),f.selfhost&&r.ready(function(){c(e.abs(n),t.document.body)},!0),f}function h(n){var t=e.get(n);return t||(t=s(n)),t}function a(n){f.clearCache(e.abs(n));e.remove(n)}function c(n,t,i,r){var f=h(n),u=new f(t,i,null,r);return u.renderComplete.then(null,function(n){return o.wrapError({error:n,page:u})})}if(t.document){var l={load:function(n){if(!this.selfhost)return f.renderCopy(e.abs(n))},process:function(n){return u.processAll(n)},render:function(n,t,i){return this.selfhost||n.appendChild(i),n}};i.Namespace._moduleDefine(n,"WinJS.UI.Pages",{define:s,get:h,_remove:a,render:c,_viewMap:e.viewMap})}}),t("WinJS/Controls/HtmlControl",["exports","../Core/_Global","../Core/_Base","../Pages"],function(n,t,i,r){"use strict";t.document&&i.Namespace._moduleDefine(n,"WinJS.UI",{HtmlControl:i.Class.define(function(n,t,i){r.render(t.uri,n,t).then(i,function(){i()})})})}),t("WinJS/VirtualizedDataSource/_VirtualizedDataSourceImpl",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../Scheduler","../_Signal","../Utilities/_UI"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{VirtualizedDataSource:i.Namespace._lazy(function(){function g(i,f){function li(n){var t="WinJS.UI.VirtualizedDataSource:"+se+":"+n+",StartTM";s(t);e.log&&e.log(t,"winjs vds","perf")}function ui(n){var t="WinJS.UI.VirtualizedDataSource:"+se+":"+n+",StopTM";s(t);e.log&&e.log(t,"winjs vds","perf")}function dt(n){return typeof n=="number"&&n>=0}function he(n){return dt(n)&&n===Math.floor(n)}function ce(t){if(t===null)t=undefined;else if(t!==undefined&&!he(t))throw new u("WinJS.UI.ListDataSource.InvalidIndexReturned",n.invalidIndexReturned);return t}function le(t){if(t===null)t=undefined;else if(t!==undefined&&!he(t)&&t!==y.unknown)throw new u("WinJS.UI.ListDataSource.InvalidCountReturned",n.invalidCountReturned);return t}function rs(){var n=(ne++).toString(),t={handle:n,item:null,itemNew:null,fetchListeners:null,cursorCount:0,bindingMap:null};return ti[n]=t,t}function ae(){return rs()}function us(n,t){n.prev=t.prev;n.next=t;n.prev.next=n;t.prev=n}function fs(n){n.lastInSequence&&(delete n.lastInSequence,n.prev.lastInSequence=!0);n.firstInSequence&&(delete n.firstInSequence,n.next.firstInSequence=!0);n.prev.next=n.next;n.next.prev=n.prev}function uf(n){while(!n.firstInSequence)n=n.prev;return n}function es(n){while(!n.lastInSequence)n=n.next;return n}function ff(n,t,i){return t.prev.next=i.next,i.next.prev=t.prev,t.prev=n.prev,i.next=n,t.prev.next=t,n.prev=i,!0}function yr(n,t,i){return t.prev.next=i.next,i.next.prev=t.prev,t.prev=n,i.next=n.next,n.next=t,i.next.prev=i,!0}function vt(n){delete n.lastInSequence;delete n.next.firstInSequence}function bi(n){var t=n.next;n.lastInSequence=!0;t.firstInSequence=!0;t===w&&di(w,undefined)}function ef(n,t,i,r){us(n,t);var u=n.prev;u.lastInSequence&&(i?delete u.lastInSequence:n.firstInSequence=!0,r?delete t.firstInSequence:n.lastInSequence=!0)}function ou(n,t){n.key=t;rt[n.key]=n}function ei(n,t,i){+t===t&&(n.index=t,i[t]=n,tr||(n.firstInSequence&&n.prev&&n.prev.index===t-1&&vt(n.prev),n.lastInSequence&&n.next&&n.next.index===t+1&&vt(n)))}function ve(n,t){var i=t===tt?ae():rs();return us(i,n),i}function os(n,t,i){var r=ve(n,i);return r.firstInSequence=!0,r.lastInSequence=!0,ei(r,t,i),r}function ye(n,t){return os(n,t,tt)}function su(n,t){var i=ve(n,t);return delete n.firstInSequence,i.prev.index===i.index-1?delete i.prev.lastInSequence:i.firstInSequence=!0,ei(i,n.index-1,t),i}function fr(n,t){var i=ve(n.next,t);return delete n.lastInSequence,i.next.index===i.index+1?delete i.next.firstInSequence:i.lastInSequence=!0,ei(i,n.index+1,t),i}function fc(n,t,i,r){ef(n,t,i,r);rt[n.key]=n;n.index!==undefined&&(tt[n.index]=n)}function pe(n){var i,r,t;fs(n);n.key&&delete rt[n.key];n.index!==undefined&&tt[n.index]===n&&delete tt[n.index];i=n.bindingMap;for(r in i)t=i[r].handle,t&&ti[t]===n&&delete ti[t];ti[n.handle]===n&&delete ti[n.handle]}function we(n){return!ti[n.handle]}function be(n,t,i,r,u){var f=u?null:t[n-1],e;if(f&&(f.next!==r||r.firstInSequence))f=f.next;else if(f=t[n+1],!f){for(f=i.next;;){if(f.firstInSequence&&(e=f),!(n>=f.index)||f===r)break;f=f.next}f!==r||r.firstInSequence||(f=e&&e.index===undefined?e:undefined)}return f}function of(n){return!n.item&&!n.itemNew&&n!==w}function ke(n,t){Object.defineProperty(n,"handle",{value:t,writable:!1,enumerable:!1,configurable:!0})}function de(n,t,i){ke(n,i);Object.defineProperty(n,"index",{get:function(){while(t.slotMergedWith)t=t.slotMergedWith;return t.index},enumerable:!1,configurable:!0})}function ec(t){if(t===undefined)return t;var i=JSON.stringify(t);if(i===undefined)throw new u("WinJS.UI.ListDataSource.ObjectIsNotValidJson",n.objectIsNotValidJson);return i}function ss(n){return i.itemSignature?i.itemSignature(n.data):ec(n.data)}function hu(n){var t=n.itemNew;n.itemNew=null;t&&(t=Object.create(t),de(t,n,n.handle),i.compareByIdentity||(n.signature=ss(t)));n.item=t;delete n.indexRequested;delete n.keyRequested}function ge(n){return n.bindingMap||n.cursorCount>0}function no(n){return ge(n)||n.fetchListeners||n.directFetchListeners}function to(n){return no(n)||!n.firstInSequence&&ge(n.prev)||!n.lastInSequence&&ge(n.next)||!pt&&(!n.firstInSequence&&n.prev!==g&&!(n.prev.item||n.prev.itemNew))|(!n.lastInSequence&&n.next!==w&&!(n.next.item||n.next.itemNew))}function io(n){bi(n);pe(n)}function oc(){var i,r;if(!kt){(!pi||we(pi))&&(pi=w.prev);for(var n=pi.prev,t=pi.next,u=0,f=function(n){n===w||to(n)||(u<=pu?u++:io(n))};n||t;)n&&(i=n,n=i.prev,i!==g&&f(i)),t&&(r=t,t=r.next,r!==ft&&f(r));eu=0}}function cu(n){no(n)||(eu++,kt||ri||(pi=n,eu>pu&&!ku&&(ku=!0,c.schedule(function(){ku=!1;oc()},c.Priority.idle,null,"WinJS.UI.VirtualizedDataSource.releaseSlotIfUnrequested"))))}function pr(n){for(var t in ni)n(ni[t])}function ro(n,t){for(var i in n.bindingMap)t(n.bindingMap[i].bindingRecord,i)}function er(n){return n.notificationsSent||(n.notificationsSent=!0,n.notificationHandler.beginNotifications&&n.notificationHandler.beginNotifications()),n.notificationHandler}function ki(){hi||fu||pr(function(n){n.notificationsSent&&(n.notificationsSent=!1,n.notificationHandler.endNotifications&&n.notificationHandler.endNotifications())})}function oi(n,t){var u=n.bindingMap,i,r;return u&&(i=u[t],i&&(r=i.handle,r))?r:n.handle}function uo(n,t){return n&&n.handle!==t&&(n=Object.create(n),ke(n,t)),n}function sf(n){var t=ht;ht=n;pr(function(n){n.notificationHandler&&n.notificationHandler.countChanged&&er(n).countChanged(ht,t)})}function hs(n,t){ro(n,function(i,r){i.notificationHandler.indexChanged&&er(i).indexChanged(oi(n,r),n.index,t)})}function di(n,t){var i=n.index;if(i!==undefined&&tt[i]===n&&delete tt[i],+t===t)ei(n,t,tt);else if(+i===i)delete n.index;else return;hs(n,i)}function cs(n,t,i,r,u){var e={},f;if((r||!t.lastInSequence)&&(u||!i.firstInSequence))if(t===g)if(i===w)for(f in ni)e[f]=ni[f];else for(f in i.bindingMap)e[f]=ni[f];else if(i===w||i.bindingMap)for(f in t.bindingMap)(i===w||i.bindingMap[f])&&(e[f]=ni[f]);for(f in n.bindingMap)e[f]=ni[f];return e}function fo(n){var t=n.prev,i=n.next,f=cs(n,t,i),r,u;for(r in f)u=f[r],u.notificationHandler&&er(u).inserted(u.itemPromiseFromKnownSlot(n),t.lastInSequence||t===g?null:oi(t,r),i.firstInSequence||i===w?null:oi(i,r))}function lu(n){var t=n.item;hu(n);ro(n,function(i,r){var u=oi(n,r);er(i).changed(uo(n.item,u),uo(t,u))})}function wr(n,t,i,r,u){var f=t.prev,e,o,s;if(t===n){if(!n.firstInSequence||!i)return;t=n.next}else if(f===n){if(!n.lastInSequence||!r)return;f=n.prev}if(!u){o=cs(n,f,t,i,r);for(e in o)s=o[e],er(s).moved(s.itemPromiseFromKnownSlot(n),(f.lastInSequence||f===n.prev)&&!i||f===g?null:oi(f,e),(t.firstInSequence||t===n.next)&&!r||t===w?null:oi(t,e));pr(function(t){t.adjustCurrentSlot(n)})}fs(n);ef(n,t,i,r)}function bt(n,t){au(n,!0);ro(n,function(i,r){er(i).removed(oi(n,r),t)});pr(function(t){t.adjustCurrentSlot(n)});pe(n)}function ls(n){for(var t,i;!n.firstInSequence;)n=n.prev;do t=n.lastInSequence,i=n.next,bt(n,!0),n=i;while(!t)}function si(n){var i,t;if(!n)return i;for(t=0;!n.firstInSequence;)t++,n=n.prev;return typeof n.indexNew=="number"?n.indexNew+t:typeof n.index=="number"?n.index+t:i}function as(n,t){for(n=n.next;n;n=n.next)if(n.firstInSequence){var i=n.indexNew!==undefined?n.indexNew:n.index;i!==undefined&&(n.indexNew=i+t)}hr+=t;tr=!0;ri?nt():st++}function gt(n,t){var i,r;n.firstInSequence&&(t<0?(i=n.indexNew,i!==undefined?delete n.indexNew:i=n.index,n.lastInSequence||(n=n.next,i!==undefined&&(n.indexNew=i))):n.lastInSequence||(r=n.next,i=r.indexNew,i!==undefined?delete r.indexNew:i=r.index,i!==undefined&&(n.indexNew=i)));as(n,t)}function br(n,t){for(var r,i=g;i!==w;i=i.next)if(r=i.indexNew,r!==undefined&&n<=r){as(i,t);break}}function eo(){for(var u,r,t,i,n=g;;n=n.next){if(n.firstInSequence){if(u=n,n.indexNew!==undefined){if(r=n.indexNew,delete n.indexNew,isNaN(r))break}else r=n.index;n!==g&&n.prev.index===r-1&&vt(n.prev)}if(n.lastInSequence)for(t=r,i=u;i!==n.next;i=i.next)t!==i.index&&di(i,t),+t===t&&t++;if(n===w)break}for(;n!==ft;n=n.next)n.index!==undefined&&n!==w&&di(n,undefined);tr=!1;hr&&+ht===ht&&(ot?ot.reset():sf(ht+hr),hr=0)}function vs(n,t,i,r,u){if(n.item)return new h(function(t){u?u(t,n.item):t(n.item)});var f={listBindingID:r,retained:!1};return n[t]||(n[t]={}),n[t][i]=f,f.promise=new h(function(n,t){f.complete=u?function(t){u(n,t)}:n;f.error=t},function(){while(n.slotMergedWith)n=n.slotMergedWith;var r=n[t];if(r){if(delete r[i],Object.keys(r).length>0)return;delete n[t]}cu(n)}),f.promise}function hf(n,t){for(var i in t)t[i].complete(n)}function au(n,t){var i=n.fetchListeners,r=n.directFetchListeners,u,f;(i||r)&&(hu(n),u=n.item,f=function(n){t?hf(u,n):lr.push(function(){hf(u,n)})},r&&(n.directFetchListeners=null,f(r)),i&&(n.fetchListeners=null,f(i)),cu(n))}function cf(){var t=lr,n,i;for(lr=[],n=0,i=t.length;n<i;n++)t[n]()}function sc(n,t){var i=n.directFetchListeners,r;if(i){n.directFetchListeners=null;for(r in i)i[r].error(t);cu(n)}}function or(n){return n.firstInSequence&&su(n,tt),n.lastInSequence&&fr(n,tt),n.itemNew&&hu(n),dr(),n}function ys(n){if(!n.firstInSequence){var t=n.prev;return t===g?null:or(t)}return or(su(n,tt))}function ps(n){if(!n.lastInSequence){var t=n.next;return t===w?null:or(t)}return or(fr(n,tt))}function oo(n){return n?vs(n,"directFetchListeners",(te++).toString()):h.wrap(null)}function lf(t){if(typeof t!="string"||!t)throw new u("WinJS.UI.ListDataSource.KeyIsInvalid",n.keyIsInvalid);}function ws(n){var t=ye(ft);return ou(t,n),t.keyRequested=!0,t}function bs(n,t){lf(n);var i=rt[n];return i||(i=ws(n),i.hints=t),or(i)}function ks(t){var r,i;if(typeof t!="number"||t<0)throw new u("WinJS.UI.ListDataSource.IndexIsInvalid",n.indexIsInvalid);if(w.index<=t)return null;if(r=tt[t],!r){if(i=be(t,tt,g,w),!i)return null;i===w&&t>=w&&di(w,undefined);r=i.prev.index===t-1?fr(i.prev,tt):i.index===t+1?su(i,tt):ye(i,t)}return r.item||(r.indexRequested=!0),or(r)}function ds(n){var t=ye(ft);return t.description=n,or(t)}function gi(n){if(tu=n,nu!==tu){var i=function(){wu=!1;nu!==tu&&(nu=tu,gs.dispatchEvent(d,nu))};tu===o.failure?i():wu||(wu=!0,t.setTimeout(i,40))}}function hc(n){var t=n.fetchID;return t&&cr[t]}function so(n,t){n.fetchID=t}function af(){var n=ue;return ue++,cr[n]=!0,n}function ai(n,t,i){var f=af(),r,u;for(so(n,f),r=n;!r.firstInSequence&&t>0;)r=r.prev,t--,so(r,f);for(u=n;!u.lastInSequence&&i>0;)u=u.next,i--,so(u,f);return f}function ho(n){var t=n.items,r=n.offset,u=n.totalCount,i=n.absoluteIndex,f=n.atStart,e=n.atEnd,o;dt(i)&&(dt(u)&&(o=t.length,i-r+o===u&&(e=!0)),r===i&&(f=!0));f&&(t.unshift(ar),n.offset++);e&&t.push(ir)}function vf(n,t,i){return(delete cr[i],t!==st||we(n))?(dr(),!1):!0}function kr(n,t,i,r){var f=st;i.then(function(i){if(i.items&&i.items.length){var e="itemsFetched id="+t+" count="+i.items.length;li(e);vf(n,f,t)&&(+r===r&&(i.absoluteIndex=r),ho(i),wo(n,i.items,i.offset,i.totalCount,i.absoluteIndex));ui(e)}else return h.wrapError(new u(v.doesNotExist))}).then(null,function(i){vf(n,f,t)&&wf(n,i)})}function yf(n,t,i,r){var f=st;r.then(function(r){if(r.items&&r.items.length){var e="itemsFetched id="+i+" count="+r.items.length;li(e);vf(t,f,i)&&(r.absoluteIndex=n,ho(r),pc(n,t,r.items,r.offset,r.totalCount,r.absoluteIndex));ui(e)}else return h.wrapError(new u(v.doesNotExist))}).then(null,function(){vf(t,f,i)&&wc(n,t,f)})}function cc(n,t){var i=ai(n,0,t-1);fi?kr(n,i,fi(i,t),0):kr(n,i,pt(i,0,0,t-1),0)}function lc(n,t){var i=ai(n,t-1,0);kr(n,i,tf(i,t))}function vu(n,t,i){var r=ai(n,t,i);kr(n,r,at(r,n.key,t,i,n.hints))}function co(n,t,i){var u=n.index,f,s,r,o,e;if(t>u&&(t=u),pt)e=ai(n,t,i),kr(n,e,pt(e,u,t,i),u);else if(n.key)vu(n,t,i);else{for(f=g,s=u+1,r=n.prev;r!==g;r=r.prev)if(r.index!==undefined&&r.key){o=u-r.index;s>o&&(s=o,f=r);break}for(r=n.next;r!==w;r=r.next)if(r.index!==undefined&&r.key){o=r.index-u;s>o&&(s=o,f=r);break}if(f===g)e=ai(n,0,u+1),yf(0,n,e,fi(e,u+1));else{var h=Math.max(f.index-u,0),c=Math.max(u-f.index,0),e=ai(f,h,c);yf(f.index,n,e,at(e,f.key,h,c,n.hints))}}}function ac(n,t,i){var r=ai(n,t,i);kr(n,r,rf(r,n.description,t,i))}function vc(){var i,t,e,h,u,c,s,l,f,a,n,r;if(!ri){for(e=!1,h=!1,n=g.next;n!==ft;){if(r=n.next,n!==w&&of(n)&&(h=!0,i?t++:(i=n,t=1),hc(n)&&(e=!0),n.keyRequested&&!u&&(u=n,c=t-1),n.description===undefined||s||(s=n,l=t-1),n.indexRequested&&!f&&(f=n,a=t-1),n.lastInSequence||r===ft||!of(r))){if(e)e=!1;else{if(ie=!1,!i.firstInSequence&&i.prev.key&&at?vu(i.prev,0,t):!n.lastInSequence&&r.key&&at?vu(r,t,0):i.prev===g&&!i.firstInSequence&&(fi||pt)?cc(i,t):r===w&&!n.lastInSequence&&tf?lc(n,t):u?vu(u,c,t-1-c):s?ac(s,l,t-1-l):f?co(f,a,t-1-a):typeof i.index=="number"?co(i,t-1,0):ls(i),ie){dr();return}if(ri)return}i=f=u=null}n=r}gi(h?o.waiting:o.ready)}}function dr(){bu||(bu=!0,c.schedule(function(){bu=!1;vc();ki()},c.Priority.max,null,"WinJS.UI.ListDataSource._fetch"))}function yc(n){var t=n.itemNew,r,u;if(!t)return!1;r=n.item;for(u in r)switch(u){case"data":break;default:if(r[u]!==t[u])return!0}return i.compareByIdentity?r.data!==t.data:n.signature!==ss(t)}function nh(n){no(n)?yc(n)?lu(n):n.itemNew=null:n.item=null}function lo(n){n.item?nh(n):au(n)}function th(n,t){n.key||ou(n,t.key);n.itemNew=t;lo(n)}function nr(n,t,i){var e=t.bindingMap,r,u,o,f,s;if(e)for(r in i)if(e[r]){u=t.fetchListeners;for(o in u)f=u[o],f.listBindingID===r&&f.retained&&(delete u[o],f.complete(null));s=e[r].bindingRecord;er(s).removed(oi(t,r),!0,oi(n,r));t.bindingMap&&delete t.bindingMap[r]}}function yu(n,t){var o,f,e,u,i,r;n.index!==t.index&&(o=t.index,t.index=n.index,hs(t,o));t.slotMergedWith=n;f=t.bindingMap;for(e in f)n.bindingMap||(n.bindingMap={}),u=f[e],u.handle||(u.handle=t.handle),ti[u.handle]=n,n.bindingMap[e]=u;if(pr(function(i){i.adjustCurrentSlot(t,n)}),i=t.itemNew||t.item,i&&(i=Object.create(i),de(i,n,n.handle),th(n,i)),n.item)t.directFetchListeners&&lr.push(function(){hf(n.item,t.directFetchListeners)}),t.fetchListeners&&lr.push(function(){hf(n.item,t.fetchListeners)});else{for(r in t.directFetchListeners)n.directFetchListeners||(n.directFetchListeners={}),n.directFetchListeners[r]=t.directFetchListeners[r];for(r in t.fetchListeners)n.fetchListeners||(n.fetchListeners={}),n.fetchListeners[r]=t.fetchListeners[r]}n.itemNew&&au(n);t.handle=(ne++).toString();bi(t);pe(t)}function pf(n,t,i){t&&t.key&&(i||(i=t.itemNew||t.item),delete t.key,delete rt[i.key],t.itemNew=null,t.item=null);i&&th(n,i);t&&yu(n,t)}function ao(t){if(typeof t!="object")throw new u("WinJS.UI.ListDataSource.InvalidItemReturned",n.invalidItemReturned);else{if(t===ar)return g;if(t===ir)return w;if(t.key)return r.validation&&lf(t.key),rt[t.key];throw new u("WinJS.UI.ListDataSource.InvalidKeyReturned",n.invalidKeyReturned);}}function vo(n,t){var i=ao(t);i===n&&(i=null);i&&nr(n,i,n.bindingMap);pf(n,i,t)}function yo(n,t,i,r){var u,f;if(t&&n.key&&n.key!==t.key)return nt(),!1;if(u=tt[i],u)if(u===n)u=null;else{if(u.key&&(n.key||t&&u.key!==t.key))return nt(),!1;if(!n.key&&u.bindingMap)return!1}if(t)if(f=rt[t.key],f===n)f=null;else if(f&&f.bindingMap)return!1;return u?(nr(n,u,n.bindingMap),delete tt[i],di(n,i),n.prev.index===i-1&&vt(n.prev),n.next.index===i+1&&vt(n),r.slotNext=u.slotNext,t||(t=u.itemNew||u.item,t&&(f=rt[t.key]))):di(n,i),f&&u!==f&&nr(n,f,n.bindingMap),pf(n,f,t),u&&u!==f&&yu(n,u),!0}function ih(n,t,i){if(t.key&&n.key&&t.key!==n.key)return nt(),!1;for(var r in n.bindingMap)i[r]=!0;return nr(n,t,i),pf(n,t),!0}function rh(n,t){for(var r={},i;n;){if(i=n.firstInSequence?null:n.prev,t.firstInSequence||t.prev!==g){if(t=t.firstInSequence?su(t,tt):t.prev,!ih(t,n,r))return}else bt(n,!0);n=i}}function uh(n,t){for(var r={},i;n;){if(i=n.lastInSequence?null:n.next,t.lastInSequence||t.next!==w){if(t=t.lastInSequence?fr(t,tt):t.next,!ih(t,n,r))return}else bt(n,!0);n=i}}function fh(n){for(var t,i=0;i<n.length;i++)t=n[i],rh(t.slotBeforeSequence,t.slotFirstInSequence),uh(t.slotAfterSequence,t.slotLastInSequence)}function po(n,t){function u(t){for(var u,i=w.prev;!(i.index<n)&&i!==t;)u=i.prev,i.index!==undefined&&bt(i,!0),i=u;r=0}for(var f,r=0,i=w.prev;!(i.index<n)||r>0;){if(f=i.prev,i===g){u(g);break}else if(i.key){if(i.index>=n)return nt(),!1;if(i.index>=t)u(i);else return at?vu(i,0,r):co(i,0,r),!1}else i.indexRequested||i.firstInSequence?u(f):r++;i=f}return!0}function wo(n,t,i,r,u){var f="WinJS.UI.ListDataSource.processResults";if(li(f),u=ce(u),r=le(r),kt){ui(f);return}if(tr&&eo(),(dt(r)||r===y.unknown)&&r!==ht&&!w.firstInSequence){nt();ui(f);return}ie=!0,function(){var e,o,v=t.length,f,c,l,y,d,rt,a,b,ut,k,h,s,p,ft,it,et;if(typeof u!="number")for(e=0;e<v;e++)if(f=ao(t[e]),f&&f.index!==undefined){u=f.index+i-e;break}for(typeof u=="number"&&t[v-1]===ir?r=u-i+v-1:dt(r)&&(u===undefined||u===null)&&(u=r-(v-1)+i),dt(r)&&!po(r,u-i)&&(r=undefined),l=new Array(v),e=0;e<v;e++){if(y=null,f=ao(t[e]),f){if(e>0&&!f.firstInSequence&&f.prev.key&&f.prev.key!==t[e-1].key||typeof u=="number"&&f.index!==undefined&&f.index!==u-i+e){nt();return}(f===g||f===w||f.bindingMap)&&(y=f)}if(typeof u=="number"&&(f=tt[u-i+e],f)){if(f.key&&f.key!==t[e].key){nt();return}!y&&f.bindingMap&&(y=f)}if(e===i){if(n.key&&n.key!==t[e].key||typeof n.index=="number"&&typeof u=="number"&&n.index!==u){nt();return}y||(y=n)}l[e]=y}for(e=0;e<v;e++)f=l[e],f&&f.index!==undefined&&f!==g&&f!==w&&vo(f,t[e]);for(d=[],rt=!0,e=0;e<v;e++)if(f=l[e],f&&f!==w){if(ut=e,f.index===undefined){for(k={},yo(f,t[e],u-i+e,k),h=f,s=f,o=e-1;!h.firstInSequence;o--){if(p=t[o],p===ar)break;if(ft=u-i+o,ft<0)break;if(yo(h.prev,p,ft,k))h=h.prev,o>=0&&(l[o]=h);else break}for(o=e+1;!s.lastInSequence;o++){if(p=t[o],(p===ir||o===r)&&s.next!==w)break;if(s.next===w||yo(s.next,p,u-i+o,k)){if(s=s.next,o<v&&(l[o]=s),ut=o,s===w)break}else break}if(a=h.firstInSequence?null:h.prev,b=s.lastInSequence?null:s.next,a&&bi(a),b&&bi(s),typeof u=="number"?(s===w?a&&yr(w,uf(a),a):(it=k.slotNext,it||(it=be(s.index,tt,g,w,!0)),ff(it,h,s)),h.prev.index===h.index-1&&vt(h.prev),s.next.index===s.index+1&&vt(s)):rt||(c=l[e-1],c&&(h.prev!==c&&(s===w?(a&&yr(w,uf(a),a),ff(h,uf(c),c)):yr(c,h,s)),vt(c))),rt=!1,ii)return;d.push({slotBeforeSequence:a,slotFirstInSequence:h,slotLastInSequence:s,slotAfterSequence:b})}e!==i||f===n||we(n)||(a=n.firstInSequence?null:n.prev,b=n.lastInSequence?null:n.next,nr(f,n,f.bindingMap),yu(f,n),d.push({slotBeforeSequence:a,slotFirstInSequence:f,slotLastInSequence:f,slotAfterSequence:b}));e=ut}for(dt(r)&&w.index!==r&&di(w,r),fh(d),e=0;e<v;e++)if(f=l[e],f){for(o=e-1;o>=0;o--)et=l[o+1],vo(l[o]=et.firstInSequence?su(l[o+1],tt):et.prev,t[o]);for(o=e+1;o<v;o++)c=l[o-1],f=l[o],f?f.firstInSequence&&(f.prev!==c&&yr(c,f,es(f)),vt(c)):vo(l[o]=c.lastInSequence?fr(c,tt):c.next,t[o]);break}delete n.description}();ii||(r!==undefined&&r!==ht&&sf(r),dr());ki();cf();ui(f)}function wf(n,t){switch(t.name){case v.noResponse:gi(o.failure);sc(n,t);break;case v.doesNotExist:n.indexRequested?po(n.index):(n.keyRequested||n.description)&&ls(n);ki();nt()}}function pc(n,t,i,r,f,e){var o,h,c,s;e=ce(e);f=le(f);o=n-r;h=i.length;t.index>=o&&t.index<o+h?wo(t,i,t.index-o,f,t.index):r===h-1&&n<t.index||dt(f)&&f<=t.index?wf(t,new u(v.doesNotExist)):t.index<o?(s=ai(t,0,o-t.index),yf(o,t,s,at(s,i[0].key,o-t.index,0))):(c=o+h-1,s=ai(t,t.index-c,0),yf(c,t,s,at(s,i[h-1].key,0,t.index-c)))}function wc(n,t,i){switch(i.name){case v.doesNotExist:n===g.index?(po(0),wf(t,i)):nt();break;default:wf(t,i)}}function bc(){for(var t=0,i,u,f,r;t<et.length;t++)if(et[t].kind==="beginRefresh")break;for(i=t;i<et.length;i++)if(et[i].kind==="beginRefresh")break;if(i>t&&i+(i-t)<et.length){for(u=!0,f=i-t,r=0;r<f;r++)if(et[t+r].kind!==et[i+r].kind){u=!1;break}if(u&&e.log)for(e.log(n.refreshCycleIdentified,"winjs vds","error"),r=t;r<i;r++)e.log(""+(r-t)+": "+JSON.stringify(et[r]),"winjs vds","error");return u}}function eh(){if(++is>b&&bc()){gi(o.failure);return}et[++ur%et.length]={kind:"beginRefresh"};wt={firstInSequence:!0,lastInSequence:!0,index:-1};lt={firstInSequence:!0,lastInSequence:!0};wt.next=lt;lt.prev=wt;fe=!1;yt=undefined;du={};wi={};ct={};ct[-1]=wt;vr={}}function nt(){if(!ii){if(ii=!0,gi(o.waiting),uu){uu=!1;bo();return}if(!kt){var n=++st;ri=!0;rr=0;c.schedule(function(){var t,i;if(st===n){for(ii=!1,eh(),t=g.next;t!==ft;)i=t.next,to(t)||t===w||io(t),t=i;lh()}},c.Priority.high,null,"WinJS.VirtualizedDataSource.beginRefresh")}}}function oh(){return ci=ci||new l,nt(),ci.promise}function sh(n,t){return(delete cr[t],n!==st)?!1:(rr--,!0)}function sr(n,t,i,r,f){var e=st;rr++;r.then(function(t){if(t.items&&t.items.length){var r="itemsFetched id="+i+" count="+t.items.length;li(r);sh(e,i)&&(ho(t),nl(n,t.items,t.offset,t.totalCount,typeof f=="number"?f:t.absoluteIndex));ui(r)}else return h.wrapError(new u(v.doesNotExist))}).then(null,function(r){sh(e,i)&&tl(n,t,r)})}function kc(n,t,i,r){if(at)sr(n.key,!1,t,at(t,n.key,i,r,n.hints));else{var f=10,u=n.index;ct[u]&&ct[u].firstInSequence?sr(n.key,!1,t,pt(t,u-1,Math.min(i+f,u)-1,r+1+f),u-1):ct[u]&&ct[u].lastInSequence?sr(n.key,!1,t,pt(t,u+1,Math.min(i+f,u)+1,r-1+f),u+1):sr(n.key,!1,t,pt(t,u,Math.min(i+f,u),r+f),u)}}function dc(n){fi?sr(null,!0,n,fi(n,1),0):pt&&sr(null,!0,n,pt(n,0,0,0),0)}function hh(n){return cr[du[n]]}function ch(n,t){for(var f,s,h=3,c=st,u,e,o=0,r,i=n;i!==ft;i=i.next)if(u||!i.key||vr[i.key]||hh(i.key)||(f=wi[i.key],(!f||f.firstInSequence||f.lastInSequence)&&(u=i,e=f,r=af())),u){if(s=hh(i.key),vr[i.key]||wi[i.key]||s||(i.key&&(du[i.key]=r),o++),i.lastInSequence||i.next===w||s){if(kc(u,r,!e||e.firstInSequence?h:0,o-1+h),!t)break;u=null;o=0}}else i.key&&of(i)&&!vr[i.key]&&(wi[i.key]||(r=af(),sr(i.key,!1,r,at(r,i.key,1,1,i.hints))));rr!==0||fe||st!==c||dc(af())}function lh(){var n=st;do ee=!1,oe=!0,ch(g.next,!0),oe=!1;while(rr===0&&ee&&st===n&&ri);rr===0&&st===n&&gh()}function ah(n){var i=st,t;if(n){t=rt[n];t||(t=g.next);do gu=!1,nf=!0,ch(t,!1),nf=!1;while(gu&&st===i&&ri)}oe?ee=!0:rr===0&&st===i&&lh()}function vh(t){if(typeof t=="object"&&t){if(t===ar)return wt;if(t===ir)return lt;if(t.key)return wi[t.key];throw new u("WinJS.UI.ListDataSource.InvalidKeyReturned",n.invalidKeyReturned);}else throw new u("WinJS.UI.ListDataSource.InvalidItemReturned",n.invalidItemReturned);}function yh(n,t){while(n.index===undefined){if(ei(n,t,ct),n.firstInSequence)return!0;n=n.prev;t--}return n.index!==t?(nt(),!1):!0}function ph(n,t){n.key=t.key;wi[n.key]=n;n.item=t}function gc(){for(var n=lt;!n.firstInSequence;)if(n=n.prev,n===wt)return null;return n}function nl(n,t,i,r,u){var h,o,s,f,l,a,b,c,e,v,p,w;if(u=ce(u),r=le(r),h=!1,fe=!0,o=u-i,s=t[0],s.key===n&&(h=!0),f=vh(s),f){if(+o===o&&!yh(f,o))return}else{if(ct[o]){nt();return}if(u!==undefined&&(l=ct[o-1])){if(!l.lastInSequence){nt();return}f=fr(l,ct)}else{if(a=+o===o?be(o,ct,wt,lt):gc(wt,lt),!a){nt();return}f=os(a,o,ct)}ph(f,t[0])}for(b=t.length,c=1;c<b;c++){if(s=t[c],s.key===n&&(h=!0),e=vh(s),e){if(f.index!==undefined&&!yh(e,f.index+1))return;if(e!==f.next){if(!f.lastInSequence||!e.firstInSequence){nt();return}if(v=es(e),v!==lt)yr(f,e,v);else if(p=uf(f),p!==wt)ff(e,p,f);else{nt();return}vt(f)}else f.lastInSequence&&vt(f)}else{if(!f.lastInSequence){nt();return}e=fr(f,ct);ph(e,s)}f=e}if(h||(vr[n]=!0),dt(r)||lt.firstInSequence||(w=lt.prev.index,w!==undefined&&(r=w+1)),dt(r)||r===y.unknown){if(dt(yt)){if(r!==yt){nt();return}}else yt=r;dt(yt)&&!ct[yt]&&ei(lt,yt,ct)}nf?gu=!0:ah(n)}function tl(n,t,i){switch(i.name){case v.noResponse:gi(o.failure);break;case v.doesNotExist:t?(ei(lt,0,ct),yt=0,gh()):(vr[n]=!0,nf?gu=!0:ah(n))}}function ut(n){return n===wt?g:n===lt?w:rt[n.key]}function vi(n){return n===g?wt:n===w?lt:wi[n.key]}function wh(n){vt(n);n.next.mergedForRefresh=!0}function bh(n,t){ou(t,n.key);t.itemNew=n.item}function il(n,t,i){var r=ae(),u;return bh(n,r),ef(r,t,i,!i),u=n.index,+u!==u&&(u=i?r.prev.index+1:t.next.index-1),ei(r,u,tt),r}function kh(n,t,i){n?(nr(n,t,n.bindingMap),pf(n,t,i.item)):(bh(i,t),t.indexRequested&&lo(t))}function bf(n,t,i){return t.key?!1:(n?(i.mergeWithPrev=!t.firstInSequence,i.mergeWithNext=!t.lastInSequence):i.stationary=!0,kh(n,t,i),!0)}function dh(n){var t,i;return n.indexRequested?t=n.index:(i=vi(n),i&&(t=i.index)),t}function gh(){var i,st,n,c,b,p,t,k,it,o,r,fi,ai,v,l,u,e,d,lr,yi,tu,gi,vr,at,ei,ku,iu,uu,fu,h,pr,nf,oi,gt,ni,br,kr,ti,rr,si,a,hi,li,ii,fr,su,er,or,ot,ui,cu,lu,au,vu,s,tf,kt,pu,wu,f,bu,y,sr,nu,hr,rf,cr,uf;for(is=0,et=new Array(100),ur=-1,tr=!0,du={},o=[],l=[],v=0,t=wt;t;t=t.next)t.sequenceNumber=v,t.firstInSequence&&(h=t),t.lastInSequence&&(l[v]={first:h,last:t,matchingItems:0},v++);for(pi=null,eu=0,n=g.next;n!==ft;)t=wi[n.key],f=n.next,n!==w&&(to(n)?n.key&&!t?bt(n,!1):yt===0||n.indexRequested&&n.index>=yt?bt(n,!0):n.item||n.keyRequested?n.itemNew=t.item:n.key&&(n.keyRequested||(delete rt[n.key],delete n.key),n.itemNew=null):io(n)),n=f;for(n=g.next;n!==w;)f=n.next,n.indexRequested&&(t=ct[n.index],t&&kh(ut(t),n,t)),n=f;for(tu=0,gi=[],it=0,n=g;n!==ft;n=n.next){if(n.firstInSequence)for(h=n,vr=null,i=0;i<v;i++)gi[i]=0;if(n.indexRequested&&(vr=n),t=vi(n),t&&gi[t.sequenceNumber]++,n.lastInSequence){for(yi=0,i=tu;i<v;i++)yi<gi[i]&&(yi=gi[i],lr=i);r={first:h,last:n,sequenceNew:yi>0?l[lr]:undefined,matchingItems:yi};vr&&(r.indexRequested=!0,r.stationarySlot=vr);o[it]=r;n===w&&(at=it,ei=r);it++;l[lr].first.index!==undefined&&(tu=lr)}}for(o[0].sequenceNew!==l[0]&&(bi(g),o[0].first=g.next,o.unshift({first:g,last:g,sequenceNew:l[0],matchingItems:1}),at++,it++),ku=!w.firstInSequence,ei.sequenceNew!==l[v-1]&&(bi(w.prev),ei.last=w.prev,at++,o.splice(at,0,{first:w,last:w,sequenceNew:l[v-1],matchingItems:1}),it++,ei=o[at]),i=0;i<it;i++)u=o[i].sequenceNew,u&&u.matchingItems<o[i].matchingItems&&(u.matchingItems=o[i].matchingItems,u.sequenceOld=o[i]);for(l[v-1].sequenceOld=ei,ei.stationarySlot=w,l[0].sequenceOld=o[0],o[0].stationarySlot=g,i=0;i<=at;i++)r=o[i],r.sequenceNew&&(ai=r.sequenceNew.sequenceOld)===fi&&fi.last!==w?(wh(ai.last),ai.last=r.last,delete o[i]):fi=r;for(fi=null,i=at;i>=0;i--)r=o[i],r&&(r.sequenceNew&&(ai=r.sequenceNew.sequenceOld)===fi&&r.last!==w?(wh(r.last),ai.first=r.first,delete o[i]):fi=r);for(ku&&delete w.mergedForRefresh,iu=[],i=at+1;i<it;i++)if(r=o[i],r&&(!r.sequenceNew||r.sequenceNew.sequenceOld!==r)){var gu=!0,nt=null,dt=null,ru=0;for(t=vi(r.first),t&&(nt=dt=t,ru=1),n=r.first;n!==r.last;n=n.next){if(ot=vi(n.next),t&&ot&&(t.lastInSequence||t.next!==ot)){gu=!1;break}t&&!nt&&(nt=dt=t);ot&&nt&&(dt=ot,ru++);t=ot}if(gu&&nt&&nt.index!==undefined&&(nt.firstInSequence||(b=ut(nt.prev),b&&(uu=b.index)),dt.lastInSequence||(p=ut(dt.next),p&&(fu=p.index)),(!p||p.lastInSequence||p.mergedForRefresh)&&(uu===undefined||fu===undefined||fu-uu-1>=ru))){for(r.locationJustDetermined=!0,t=nt;;t=t.next)if(t.locationJustDetermined=!0,t===dt)break;h=ut(nt);pr=ut(dt);iu.push({slotBeforeSequence:h.firstInSequence?null:h.prev,slotFirstInSequence:h,slotLastInSequence:pr,slotAfterSequence:pr.lastInSequence?null:pr.next})}}for(i=0;i<it;i++)if(r=o[i],r&&!r.indexRequested&&!r.locationJustDetermined&&(!r.sequenceNew||r.sequenceNew.sequenceOld!==r)){r.sequenceNew=null;n=r.first;do{if(nf=n===r.last,f=n.next,n!==g&&n!==w&&n!==ft&&!n.item&&!n.keyRequested)if(bt(n,!0),r.first===n)if(r.last===n){delete o[i];break}else r.first=n.next;else r.last===n&&(r.last=n.prev);n=f}while(!nf)}for(i=0;i<v;i++){for(u=l[i],t=u.first;!ut(t)&&!t.lastInSequence;t=t.next);if(t.lastInSequence&&!ut(t))u.firstInner=u.lastInner=null;else{for(u.firstInner=t,t=u.last;!ut(t);t=t.prev);u.lastInner=t}}for(i=0;i<v;i++)if(u=l[i],u&&u.firstInner&&(r=u.sequenceOld,r)){for(oi=0,n=r.first;;n=n.next,oi++)if(t=vi(n),t&&t.sequenceNumber===u.firstInner.sequenceNumber&&(t.ordinal=oi),n.lastInSequence)break;for(gt=[],t=u.firstInner;;t=t.next){if(oi=t.ordinal,oi!==undefined){for(ni=0,br=gt.length-1;ni<=br;)kr=Math.floor(.5*(ni+br)),gt[kr].ordinal<oi?ni=kr+1:br=kr-1;gt[ni]=t;ni>0&&(t.predecessor=gt[ni-1])}if(t===u.lastInner)break}for(ti=[],rr=gt.length,t=gt[rr-1],st=rr;st--;)t.stationary=!0,ti[st]=t,t=t.predecessor;for(r.stationarySlot=ut(ti[0]),t=ti[0],n=ut(t),c=n.prev,si=n.firstInSequence;!t.firstInSequence;)if(t=t.prev,k=ut(t),!k||t.locationJustDetermined)while(!si&&c!==g)if(n=c,c=n.prev,si=n.firstInSequence,bf(k,n,t))break;for(st=0;st<rr-1;st++){t=ti[st];n=ut(t);var ou=ti[st+1],gr=null,pt=ut(ou),k;for(f=n.next,t=t.next;t!==ou&&!gr&&n!==pt;t=t.next)if(k=ut(t),!k||t.locationJustDetermined)while(f!==pt){if(f.mergedForRefresh){gr=t.prev;break}if(n=f,f=n.next,bf(k,n,t))break}if(gr)for(c=pt.prev,t=ou.prev;t!==gr&&pt!==n;t=t.prev)if(k=ut(t),!k||t.locationJustDetermined)while(c!==n)if(pt=c,c=pt.prev,bf(k,pt,t))break;while(f!==pt)n=f,f=n.next,n!==g&&of(n)&&!n.keyRequested&&bt(n)}for(t=ti[rr-1],n=ut(t),f=n.next,si=n.lastInSequence;!t.lastInSequence;)if(t=t.next,k=ut(t),!k||t.locationJustDetermined)while(!si&&f!==w)if(n=f,f=n.next,si=n.lastInSequence,bf(k,n,t))break}for(i=0;i<v;i++)if(u=l[i],u.firstInner)for(c=null,t=u.firstInner;;t=t.next){if(n=ut(t),n){if(!t.stationary){if(hi=!1,li=!1,c)a=c.next,hi=!0;else{for(ii=u.firstInner;!ii.stationary&&ii!==u.lastInner;ii=ii.next);if(ii.stationary)a=ut(ii),li=!0;else if(e=t.index,e===0)a=g.next,hi=!0;else if(e===undefined)a=ft;else{for(a=g.next,fr=null;;){if(a.firstInSequence&&(fr=a),e<a.index&&fr||a===w)break;a=a.next}!a.firstInSequence&&fr&&(a=fr)}}n.mergedForRefresh&&(delete n.mergedForRefresh,n.lastInSequence||(n.next.mergedForRefresh=!0));hi=hi||t.mergeWithPrev;li=li||t.mergeWithNext;su=t.locationJustDetermined;wr(n,a,hi,li,su);su&&li&&(a.mergedForRefresh=!0)}c=n}if(t===u.lastInner)break}for(i=0;i<v;i++)if(u=l[i],u.firstInner)for(c=null,t=u.firstInner;;t=t.next){if(n=ut(t),!n){if(c)er=c.next;else{for(or=u.firstInner;!ut(or);or=or.next);er=ut(or)}n=il(t,er,!!c);ot=vi(er);er.mergedForRefresh||ot&&ot.locationJustDetermined||(hu(n),fo(n))}if(c=n,t===u.lastInner)break}for(tt=[],ui=-1,n=g,d=0;n!==ft;d++){if(f=n.next,n.firstInSequence&&(h=n,d=0),ui===undefined&&(cu=dh(n),cu!==undefined&&(ui=cu-d)),ui!==undefined&&!n.lastInSequence&&(lu=dh(n.next),lu!==undefined&&lu!==ui+d+1))for(bi(n),au=!0,y=n.next,vu=!1;!vu&&y!==w;)sr=y.next,vu=y.lastInSequence,wr(y,sr,!au,!1),au=!1,y=sr;if(n.lastInSequence){for(e=ui,s=h;s!==f;)tf=s.next,e>=yt&&s!==w?bt(s,!0):(kt=tt[e],e!==s.index?(delete tt[e],di(s,e)):+e===e&&tt[e]!==s&&(tt[e]=s),s.itemNew&&lo(s),kt&&(s.key?(nr(s,kt,s.bindingMap),yu(s,kt),+e===e&&(tt[e]=s)):(nr(kt,s,kt.bindingMap),yu(kt,s),+e===e&&(tt[e]=kt))),+e===e&&e++),s=tf;ui=undefined}n=f}for(pu=-2,n=g,d=0;n!==ft;d++){if(f=n.next,n.firstInSequence&&(h=n,d=0),delete n.mergedForRefresh,n.lastInSequence)if(h.index===undefined)b=h.prev,b&&(bu=vi(b))&&!bu.lastInSequence&&(t=vi(n))&&t.prev===bu?(yr(b,h,n),vt(b)):n===w||wu||ff(ft,h,n);else{if(pu<n.index&&!wu)pu=n.index;else{for(p=g.next;p.index<n.index;p=p.next);for(y=h;y!==f;)sr=y.next,t=vi(y),wr(y,p,p.prev.index===y.index-1,p.index===y.index+1,t&&t.locationJustDetermined),y=sr}b=h.prev;b&&b.index===h.index-1&&vt(b)}n===w&&(wu=!0);n=f}for(tr=!1,fh(iu),yt!==undefined&&yt!==ht&&sf(yt),ki(),nu=[],i=0;i<v;i++){for(u=l[i],hr=[],n=null,d=0,t=u.first;;t=t.next,d++)if(t===wt?hr.push(ar):t===lt?hr.push(ir):(hr.push(t.item),n||(n=ut(t),rf=d)),t.lastInSequence)break;n&&nu.push({slot:n,results:hr,offset:rf})}for(eh(),ri=!1,cf(),i=0;i<nu.length;i++)cr=nu[i],wo(cr.slot,cr.results,cr.offset,ht,cr.slot.index);ci&&(uf=ci,ci=null,uf.complete());dr()}function kf(n,t,i,r,u,f,e){var s=it.prev,o={prev:s,next:it,applyEdit:n,editType:t,complete:i,error:r,keyUpdate:u};s.next=o;it.prev=o;kt=!0;(ii||ri)&&(st++,ri=!1,ii=!0);it.next===o&&bo();o.failed||(f(),o.undo=e);hi||ko()}function nc(){ru=!1;var n=it.next.next;it.next=n;n.prev=it}function rl(){while(it.prev!==it){var n=it.prev;n.error&&n.error(new u(p.canceled));n.undo&&!ii&&n.undo();it.prev=n.prev}it.next=it;hi=!1;ko()}function ul(n){function u(){uu||(r?re=!0:bo())}function f(i){var f,e,o;i&&(t&&t.key!==i.key?(e=i.key,n.undo?(f=t.slot,f&&(o=f.key,o&&delete rt[o],ou(f,e),f.itemNew=i,f.item?(lu(f),ki()):au(f))):t.key=e):n.editType===gr.change&&(f.itemNew=i,r||nh(f)));nc();n.complete&&n.complete(i);u()}function e(t){switch(t.Name){case p.noResponse:gi(o.failure);uu=!0;ru=!1;return;case p.noLongerMeaningful:nt()}n.failed=!0;nc();rl();n.error&&n.error(t);u()}var r,t;ru||(r=!0,t=n.keyUpdate,i.beginEdits&&!iu&&(iu=!0,i.beginEdits()),ru=!0,n.applyEdit().then(f,e),r=!1)}function bo(){while(it.next!==it)if(re=!1,ul(it.next),!re)return;tc()}function ko(){eo();ki();cf();it.next===it&&tc()}function tc(){kt=!1;i.endEdits&&iu&&!hi&&(iu=!1,i.endEdits());ii?(ii=!1,nt()):dr()}function yi(n){return lf(n),rt[n]||ws(n)}function go(n,t,i,r,u){var f=ae();return ef(f,i,r,u),n&&ou(f,n),f.itemNew=t,gt(f,1),hi||fu||(f.firstInSequence||typeof f.prev.index!="number"?f.lastInSequence||typeof f.next.index!="number"||ei(f,f.next.index-1,tt):ei(f,f.prev.index+1,tt)),hu(f),fo(f),f}function df(n,t,i,r,u){var f={key:n};return new h(function(n,e){kf(u,gr.insert,n,e,f,function(){if(i){var n={key:f.key,data:t};f.slot=go(f.key,n,i,r,!r)}},function(){var n=f.slot;n&&(gt(n,-1),bt(n,!1))})})}function gf(n,t,i,r){return new h(function(u,f){var h,e,o,s;kf(r,gr.move,u,f,null,function(){e=n.next;o=n.firstInSequence;s=n.lastInSequence;var r=n.prev;h=typeof n.index!="number"&&(o||!r.item)&&(s||!e.item);gt(n,-1);wr(n,t,i,!i);gt(n,1);h&&(bi(r),o||rh(r,n),s||uh(e,n))},function(){h?nt():(gt(n,-1),wr(n,e,!o,!s),gt(n,1))})})}function fl(){function n(){fu||(eo(),ki(),cf())}this.invalidateAll=function(){return ht===0?(this.reload(),h.wrap()):oh()};this.reload=function(){var n,i,r,t;for(ot&&ot.cancel(),ci&&ci.cancel(),n=g.next;n!==ft;n=n.next){i=n.fetchListeners;for(t in i)i[t].promise.cancel();r=n.directFetchListeners;for(t in r)r[t].promise.cancel()}ic();pr(function(n){n.notificationHandler&&n.notificationHandler.reload()})};this.beginNotifications=function(){fu=!0};this.inserted=function(t,i,r,u){if(kt)nt();else{var o=t.key,e=rt[i],f=rt[r],s=typeof i=="string",h=typeof r=="string";if(s?f&&!f.firstInSequence&&(e=f.prev):h&&e&&!e.lastInSequence&&(f=e.next),(s||h)&&!(e||f)&&g.next===w){nt();return}if(rt[o]){nt();return}if(e&&f&&(e.next!==f||e.lastInSequence||f.firstInSequence)){nt();return}if(e&&(e.keyRequested||e.indexRequested)||f&&(f.keyRequested||f.indexRequested)){nt();return}if(e||f)go(o,t,f?f:e.next,!!e,!!f);else if(g.next===w)go(o,t,g.next,!0,!0);else if(u!==undefined)br(u,1);else{nt();return}n()}};this.changed=function(t){if(kt)nt();else{var r=t.key,i=rt[r];i&&(i.keyRequested?nt():(i.itemNew=t,i.item&&(lu(i),n())))}};this.moved=function(t,i,r,u,f){if(kt)nt();else{var h=t.key,s=rt[h],o=rt[i],e=rt[r];s&&s.keyRequested||o&&o.keyRequested||e&&e.keyRequested?nt():s?o&&e&&(o.next!==e||o.lastInSequence||e.firstInSequence)?nt():o||e?(gt(s,-1),wr(s,e?e:o.next,!!o,!!e),gt(s,1),n()):(gt(s,-1),bt(s,!1),u!==undefined&&(u<f&&f--,br(f,1)),n()):o||e?(u!==undefined&&(br(u,-1),u<f&&f--),this.inserted(t,i,r,f)):u!==undefined&&(br(u,-1),u<f&&f--,br(f,1),n())}};this.removed=function(t,i){if(kt)nt();else{var r;r=typeof t=="string"?rt[t]:tt[i];r?r.keyRequested?nt():(gt(r,-1),bt(r,!1),n()):i!==undefined&&(br(i,-1),n())}};this.endNotifications=function(){fu=!1;n()}}function ic(){gi(o.ready);ot=null;iu=!1;hi=!1;ru=!1;it={};it.next=it;it.prev=it;kt=!1;uu=!1;hr=0;tr=!1;uc=0;cr={};lr=[];ht=y.unknown;g={firstInSequence:!0,lastInSequence:!0,index:-1};w={firstInSequence:!0,lastInSequence:!0};ft={firstInSequence:!0,lastInSequence:!0};g.next=w;w.prev=g;w.next=ft;ft.prev=w;ti={};rt={};tt={};tt[-1]=g;eu=0;pi=null;ku=!1;ii=!1;ri=!1;ci=null}var ns,pu,nu,tu,wu,ni,ts,ne,te,ot,ie,iu,hi,ru,it,kt,re,uu,fu,hr,tr,uc,st,bu,ue,cr,lr,ar,ir,ht,g,w,ft,ti,rt,tt,eu,pi,ku,ii,ri,ci,rr,fe,yt,wt,lt,du,wi,ct,vr,ee,oe,gu,nf,is=0,et=new Array(100),ur=-1,at,pt,fi,tf,rf,se,gs,gr,rc;if(i.itemsFromKey&&(at=function(n,t,r,u,f){var e="fetchItemsFromKey id="+n+" key="+t+" countBefore="+r+" countAfter="+u,o;return li(e),et[++ur%et.length]={kind:"itemsFromKey",key:t,countBefore:r,countAfter:u},o=i.itemsFromKey(t,r,u,f),ui(e),o}),i.itemsFromIndex&&(pt=function(n,t,r,u){var f="fetchItemsFromIndex id="+n+" index="+t+" countBefore="+r+" countAfter="+u,e;return li(f),et[++ur%et.length]={kind:"itemsFromIndex",index:t,countBefore:r,countAfter:u},e=i.itemsFromIndex(t,r,u),ui(f),e}),i.itemsFromStart&&(fi=function(n,t){var r="fetchItemsFromStart id="+n+" count="+t,u;return li(r),et[++ur%et.length]={kind:"itemsFromStart",count:t},u=i.itemsFromStart(t),ui(r),u}),i.itemsFromEnd&&(tf=function(n,t){var r="fetchItemsFromEnd id="+n+" count="+t,u;return li(r),et[++ur%et.length]={kind:"itemsFromEnd",count:t},u=i.itemsFromEnd(t),ui(r),u}),i.itemsFromDescription&&(rf=function(n,t,r,u){var f="fetchItemsFromDescription id="+n+" desc="+t+" countBefore="+r+" countAfter="+u,e;return li(f),et[++ur%et.length]={kind:"itemsFromDescription",description:t,countBefore:r,countAfter:u},e=i.itemsFromDescription(t,r,u),ui(f),e}),se=++k,gs=this,gr={insert:"insert",change:"change",move:"move",remove:"remove"},!i)throw new u("WinJS.UI.ListDataSource.ListDataAdapterIsInvalid",n.listDataAdapterIsInvalid);pu=i.compareByIdentity?0:200;f&&typeof f.cacheSize=="number"&&(pu=f.cacheSize);i.setNotificationHandler&&(ns=new fl,i.setNotificationHandler(ns));nu=o.ready;wu=!1;ni={};ts=0;ne=1;te=0;st=0;bu=!1;ue=1;ar={};ir={};ic();this.createListBinding=function(n){function l(n){n&&n.cursorCount++}function e(n){n&&--n.cursorCount==0&&cu(n)}function o(n){l(n);e(t);t=n}function a(n,i){n===t&&(i||(i=!t||t.lastInSequence||t.next===w?null:t.next),o(i))}function s(n){var r=n.bindingMap,t=r[i].handle,u,f,e;delete n.bindingMap[i];u=!0;f=!0;for(e in r)if(u=!1,t&&r[e].handle===t){f=!1;break}t&&f&&delete ti[t];u&&(n.bindingMap=null,cu(n))}function v(n,t){var r,u;n.bindingMap||(n.bindingMap={});r=n.bindingMap[i];r?r.count++:n.bindingMap[i]={bindingRecord:ni[i],count:1};n.fetchListeners&&(u=n.fetchListeners[t],u&&(u.retained=!0))}function y(n){var t=ti[n],f,r,e,u;if(t&&(f=t.bindingMap[i],--f.count==0)){r=t.fetchListeners;for(e in r)u=r[e],u.listBindingID===i&&(u.retained=!1);s(t)}}function c(t){var f=oi(t,i),e=(te++).toString(),r=vs(t,"fetchListeners",e,i,function(n,t){n(uo(t,f))});return de(r,t,f),n&&(r.retain=function(){return u._retainItem(t,e),r},r.release=function(){u._releaseItem(f)}),r}function r(t){var i;return!f&&t?i=c(t):(f?(i=new h(function(){}),i.cancel()):i=h.wrap(null),ke(i,null),n&&(i.retain=function(){return i},i.release=function(){})),o(t),i}var i=(ts++).toString(),t=null,f=!1,u;return ni[i]={notificationHandler:n,notificationsSent:!1,adjustCurrentSlot:a,itemPromiseFromKnownSlot:c},u={_retainItem:function(n,t){v(n,t)},_releaseItem:function(n){y(n)},jumpToItem:function(n){return r(n?ti[n.handle]:null)},current:function(){return r(t)},previous:function(){return r(t?ys(t):null)},next:function(){return r(t?ps(t):null)},releaseItem:function(n){this._releaseItem(n.handle)},release:function(){var n,h,r,u,o;for(f=!0,e(t),t=null,n=g.next;n!==ft;){h=n.next;r=n.fetchListeners;for(u in r)o=r[u],o.listBindingID===i&&(o.promise.cancel(),delete r[u]);n.bindingMap&&n.bindingMap[i]&&s(n);n=h}delete ni[i]}},(fi||pt)&&(u.first=function(){return r(ps(g))}),tf&&(u.last=function(){return r(ys(w))}),at&&(u.fromKey=function(n,t){return r(bs(n,t))}),(pt||fi&&at)&&(u.fromIndex=function(n){return r(ks(n))}),rf&&(u.fromDescription=function(n){return r(ds(n))}),u};this.invalidateAll=function(){return oh()};rc=function(n,t){var i=new l;n.then(function(n){i.complete(n)},function(n){i.error(n)});var e=i.promise.then(null,function(i){return i.name==="WinJS.UI.VirtualizedDataSource.resetCount"?(ot=null,n=t.getCount()):h.wrapError(i)}),f=0,r={get:function(){return f++,new h(function(n,t){e.then(n,t)},function(){--f==0&&(i.promise.cancel(),n.cancel(),r===ot&&(ot=null))})},reset:function(){i.error(new u("WinJS.UI.VirtualizedDataSource.resetCount"))},cancel:function(){i.promise.cancel();n.cancel();r===ot&&(ot=null)}};return r};this.getCount=function(){if(i.getCount){var t=this;return h.wrap().then(function(){var n,r,u;return hi||kt?ht:(ot||(n=i.getCount(),n.then(function(){ot===r&&(ot=null);u=!0},function(){ot===r&&(ot=null);u=!0}),hr=0,u||(r=ot=rc(n,t))),ot?ot.get():n)}).then(function(t){if(!he(t)&&t!==undefined)throw new u("WinJS.UI.ListDataSource.InvalidRequestedCountReturned",n.invalidRequestedCountReturned);return t!==ht&&(ht===y.unknown?ht=t:(sf(t),ki())),t===0&&(g.next!==w||w.next!==ft?nt():g.lastInSequence&&(vt(g),w.index=0)),t}).then(null,function(n){return n.name===a.CountError.noResponse?(gi(o.failure),ht):h.wrapError(n)})}return h.wrap(ht)};at&&(this.itemFromKey=function(n,t){return oo(bs(n,t))});(pt||fi&&at)&&(this.itemFromIndex=function(n){return oo(ks(n))});rf&&(this.itemFromDescription=function(n){return oo(ds(n))});this.beginEdits=function(){hi=!0};i.insertAtStart&&(this.insertAtStart=function(n,t){return df(n,t,g.lastInSequence?null:g.next,!0,function(){return i.insertAtStart(n,t)})});i.insertBefore&&(this.insertBefore=function(n,t,r){var u=yi(r);return df(n,t,u,!1,function(){return i.insertBefore(n,t,r,si(u))})});i.insertAfter&&(this.insertAfter=function(n,t,r){var u=yi(r);return df(n,t,u?u.next:null,!0,function(){return i.insertAfter(n,t,r,si(u))})});i.insertAtEnd&&(this.insertAtEnd=function(n,t){return df(n,t,w.firstInSequence?null:w,!1,function(){return i.insertAtEnd(n,t)})});i.change&&(this.change=function(n,t){var r=yi(n);return new h(function(u,f){var e;kf(function(){return i.change(n,t,si(r))},gr.change,u,f,null,function(){e=r.item;r.itemNew={key:n,data:t};e?lu(r):au(r)},function(){e?(r.itemNew=e,lu(r)):nt()})})});i.moveToStart&&(this.moveToStart=function(n){var t=yi(n);return gf(t,g.next,!0,function(){return i.moveToStart(n,si(t))})});i.moveBefore&&(this.moveBefore=function(n,t){var r=yi(n),u=yi(t);return gf(r,u,!1,function(){return i.moveBefore(n,t,si(r),si(u))})});i.moveAfter&&(this.moveAfter=function(n,t){var r=yi(n),u=yi(t);return gf(r,u.next,!0,function(){return i.moveAfter(n,t,si(r),si(u))})});i.moveToEnd&&(this.moveToEnd=function(n){var t=yi(n);return gf(t,w,!1,function(){return i.moveToEnd(n,si(t))})});i.remove&&(this.remove=function(n){lf(n);var t=rt[n];return new h(function(r,u){var f,e,o;kf(function(){return i.remove(n,si(t))},gr.remove,r,u,null,function(){t&&(f=t.next,e=t.firstInSequence,o=t.lastInSequence,gt(t,-1),bt(t,!1))},function(){t&&(fc(t,f,!e,!o),gt(t,1),fo(t))})})});this.endEdits=function(){hi=!1;ko()}}var b=100,k=1,o=a.DataSourceStatus,y=a.CountResult,v=a.FetchError,p=a.EditError,n={get listDataAdapterIsInvalid(){return"Invalid argument: listDataAdapter must be an object or an array."},get indexIsInvalid(){return"Invalid argument: index must be a non-negative integer."},get keyIsInvalid(){return"Invalid argument: key must be a string."},get invalidItemReturned(){return"Error: data adapter returned item that is not an object."},get invalidKeyReturned(){return"Error: data adapter returned item with undefined or null key."},get invalidIndexReturned(){return"Error: data adapter should return undefined, null or a non-negative integer for the index."},get invalidCountReturned(){return"Error: data adapter should return undefined, null, CountResult.unknown, or a non-negative integer for the count."},get invalidRequestedCountReturned(){return"Error: data adapter should return CountResult.unknown, CountResult.failure, or a non-negative integer for the count."},get refreshCycleIdentified(){return"refresh cycle found, likely data inconsistency"}},d="statuschanged",w=i.Class.define(function(){},{_baseDataSourceConstructor:g,_isVirtualizedDataSource:!0},{supportedForProcessing:!1});return i.Class.mix(w,f.eventMixin),w})})}),t("WinJS/VirtualizedDataSource/_GroupDataSource",["exports","../Core/_Base","../Core/_ErrorFromName","../Promise","../Scheduler","../Utilities/_UI","./_VirtualizedDataSourceImpl"],function(n,t,i,r,u,f,e){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_GroupDataSource:t.Namespace._lazy(function(){function o(){return new i(f.FetchError.doesNotExist)}function n(n){return n&&n.firstReached&&n.lastReached}var s=101,h=t.Class.define(function(n){this._groupDataAdapter=n},{beginNotifications:function(){},inserted:function(n,t,i){this._groupDataAdapter._inserted(n,t,i)},changed:function(n,t){this._groupDataAdapter._changed(n,t)},moved:function(n,t,i){this._groupDataAdapter._moved(n,t,i)},removed:function(n,t){this._groupDataAdapter._removed(n,t)},countChanged:function(n,t){n===0&&t!==0&&this._groupDataAdapter.invalidateGroups()},indexChanged:function(n,t,i){this._groupDataAdapter._indexChanged(n,t,i)},endNotifications:function(){this._groupDataAdapter._endNotifications()},reload:function(){this._groupDataAdapter._reload()}},{supportedForProcessing:!1}),c=t.Class.define(function(n,t,i,r){this._listBinding=n.createListBinding(new h(this));this._groupKey=t;this._groupData=i;this._initializeState();this._batchSize=s;this._count=null;r&&(typeof r.groupCountEstimate=="number"&&(this._count=r.groupCountEstimate<0?null:Math.max(r.groupCountEstimate,1)),typeof r.batchSize=="number"&&(this._batchSize=r.batchSize+1));this._listBinding.last&&(this.itemsFromEnd=function(n){var t=this;return this._fetchItems(function(){return t._lastGroup},function(n){if(n)return!1;var i=t._count;return+i!==i?!0:i>0?!0:void 0},function(){t._fetchBatch(t._listBinding.last(),t._batchSize-1,0)},n-1,0)})},{setNotificationHandler:function(n){this._listDataNotificationHandler=n},compareByIdentity:!0,itemsFromKey:function(n,t,i,r){var u=this;return this._fetchItems(function(){return u._keyMap[n]},function(){var n=u._lastGroup;return n?+n.index!==n.index?!0:void 0:!0},function(){r=r||{};var t=typeof r.groupMemberKey=="string"&&u._listBinding.fromKey?u._listBinding.fromKey(r.groupMemberKey):typeof r.groupMemberIndex=="number"&&u._listBinding.fromIndex?u._listBinding.fromIndex(r.groupMemberIndex):r.groupMemberDescription!==undefined&&u._listBinding.fromDescription?u._listBinding.fromDescription(r.groupMemberDescription):u._listBinding.first(),n=Math.floor(.5*(u._batchSize-1));u._fetchBatch(t,n,u._batchSize-1-n)},t,i)},itemsFromIndex:function(n,t,i){var r=this;return this._fetchItems(function(){return r._indexMap[n]},function(){var t=r._lastGroup;return t?+t.index!==t.index?!0:n<=t.index?!0:void 0:!0},function(){r._fetchNextIndex()},t,i)},getCount:function(){if(this._lastGroup&&typeof this._lastGroup.index=="number")return r.wrap(this._count);var n=this,t=new r(function(t){var i={initialBatch:function(){n._fetchNextIndex()},getGroup:function(){return null},countBefore:0,countAfter:0,complete:function(i){i&&(n._count=0);var r=n._count;return typeof r=="number"?(t(r),!0):!1}};n._fetchQueue.push(i);n._itemBatch||n._continueFetch(i)});return typeof this._count=="number"?r.wrap(this._count):t},invalidateGroups:function(){this._beginRefresh();this._initializeState()},_initializeState:function(){this._count=null;this._indexMax=null;this._keyMap={};this._indexMap={};this._lastGroup=null;this._handleMap={};this._fetchQueue=[];this._itemBatch=null;this._itemsToFetch=0;this._indicesChanged=!1},_releaseItem:function(n){delete this._handleMap[n.handle];this._listBinding.releaseItem(n)},_processBatch:function(){for(var t,o,r,i,f,e,v,l=null,n=null,h=null,c=0,a=!0,s=0;s<this._batchSize;s++){if(t=this._itemBatch[s],o=t?this._groupKey(t):null,t&&(a=!1),n&&o!==null&&o===n.key)c++,n.lastItem===l?(n.lastItem.handle!==n.firstItem.handle&&this._releaseItem(n.lastItem),n.lastItem=t,this._handleMap[t.handle]=n,n.size++):n.firstItem===t&&(n.firstItem.handle!==n.lastItem.handle&&this._releaseItem(n.firstItem),n.firstItem=h,this._handleMap[h.handle]=n,n.size+=c);else if(r=null,n&&(n.lastReached=!0,typeof n.index=="number"&&(r=n.index+1)),t){if(i=this._keyMap[o],i||(i={key:o,data:this._groupData(t),firstItem:t,lastItem:t,size:1},this._keyMap[i.key]=i,this._handleMap[t.handle]=i),s>0&&(i.firstReached=!0,n||(r=0)),typeof i.index!="number"&&typeof r=="number"){for(f=i;f;f=this._nextGroup(f))f.index=r,this._indexMap[r]=f,r++;this._indexMax=r;typeof this._count=="number"&&!this._lastGroup&&this._count<=this._indexMax&&(this._count=this._indexMax+1)}h=t;c=0;n=i}else n&&(this._lastGroup=n,typeof n.index=="number"&&(this._count=n.index+1),this._listDataNotificationHandler.invalidateAll(),n=null);l=t}for(e=this._fetchQueue[0];e&&e.complete(a);e=this._fetchQueue[0])this._fetchQueue.splice(0,1);e?(v=this,u.schedule(function(){v._continueFetch(e)},u.Priority.normal,null,"WinJS.UI._GroupDataSource._continueFetch")):this._itemBatch=null},_processPromise:function(n,t){n.retain();this._itemBatch[t]=n;var i=this;n.then(function(n){i._itemBatch[t]=n;--i._itemsToFetch==0&&i._processBatch()})},_fetchBatch:function(n,t){this._itemBatch=new Array(this._batchSize);this._itemsToFetch=this._batchSize;this._processPromise(n,t);var i;for(this._listBinding.jumpToItem(n),i=t-1;i>=0;i--)this._processPromise(this._listBinding.previous(),i);for(this._listBinding.jumpToItem(n),i=t+1;i<this._batchSize;i++)this._processPromise(this._listBinding.next(),i)},_fetchAdjacent:function(n,t){this._fetchBatch(this._listBinding.fromKey?this._listBinding.fromKey(n.key):this._listBinding.fromIndex(n.index),t?0:this._batchSize-1,t?this._batchSize-1:0)},_fetchNextIndex:function(){var n=this._indexMap[this._indexMax-1];n?this._fetchAdjacent(n.lastItem,!0):this._fetchBatch(this._listBinding.first(),1,this._batchSize-2)},_continueFetch:function(t){var i,r,u;t.initialBatch?(t.initialBatch(),t.initialBatch=null):(i=t.getGroup(),i?i.firstReached?i.lastReached?t.countBefore>0&&i.index!==0&&!n(r=this._previousGroup(i))?this._fetchAdjacent(r&&r.lastReached?r.firstItem:i.firstItem,!1):(u=this._nextGroup(i),this._fetchAdjacent(u&&u.firstReached?u.lastItem:i.lastItem,!0)):this._fetchAdjacent(i.lastItem,!0):this._fetchAdjacent(i.firstItem,!1):this._fetchNextIndex())},_fetchComplete:function(t,i,r,u,e){var s,h,c,o,a,v,p,w,y,b,k,l;if(n(t)&&(s=this._previousGroup(t),(u||n(s)||t.index===0||i===0)&&(h=this._nextGroup(t),u||n(h)||this._lastGroup===t||r===0))){for(c=0,o=t;c<i;){if(s=this._previousGroup(o),!n(s))break;o=s;c++}for(a=0,v=t;a<r;){if(h=this._nextGroup(v),!n(h))break;v=h;a++}for(p=c+1+a,w=new Array(p),y=0;y<p;y++)b={key:o.key,data:o.data,firstItemKey:o.firstItem.key,groupSize:o.size},k=o.firstItem.index,typeof k=="number"&&(b.firstItemIndexHint=k),w[y]=b,o=this._nextGroup(o);return l={items:w,offset:c},l.totalCount=typeof this._count=="number"?this._count:f.CountResult.unknown,typeof t.index=="number"&&(l.absoluteIndex=t.index),v===this._lastGroup&&(l.atEnd=!0),e(l),!0}return!1},_fetchItems:function(n,t,i,u,f){var e=this;return new r(function(r,s){function a(i){var l=n();return l?e._fetchComplete(l,u,f,h,r,s):h&&!t(i)?(s(o()),!0):c>2?(s(o()),!0):(i?c++:c=0,!1)}var v=n(),h=!v,c=0,l;a()||(l={initialBatch:h?i:null,getGroup:n,countBefore:u,countAfter:f,complete:a},e._fetchQueue.push(l),e._itemBatch||e._continueFetch(l))})},_previousGroup:function(n){return n&&n.firstReached?(this._listBinding.jumpToItem(n.firstItem),this._handleMap[this._listBinding.previous().handle]):null},_nextGroup:function(n){return n&&n.lastReached?(this._listBinding.jumpToItem(n.lastItem),this._handleMap[this._listBinding.next().handle]):null},_invalidateIndices:function(n){this._count=null;this._lastGroup=null;typeof n.index=="number"&&(this._indexMax=n.index>0?n.index:null);for(var t=n;t&&typeof t.index=="number";t=this._nextGroup(t))delete this._indexMap[t.index],t.index=null},_releaseGroup:function(n){this._invalidateIndices(n);delete this._keyMap[n.key];this._lastGroup===n&&(this._lastGroup=null);n.firstItem!==n.lastItem&&this._releaseItem(n.firstItem);this._releaseItem(n.lastItem)},_beginRefresh:function(){var t,n;if(this._fetchQueue=[],this._itemBatch){for(t=0;t<this._batchSize;t++)n=this._itemBatch[t],n&&(n.cancel&&n.cancel(),this._listBinding.releaseItem(n));this._itemBatch=null}this._itemsToFetch=0;this._listDataNotificationHandler.invalidateAll()},_processInsertion:function(n,t,i){var r=this._handleMap[t],u=this._handleMap[i],f=null;r&&(r.lastReached&&t===r.lastItem.handle&&(f=this._groupKey(n))!==r.key?this._lastGroup===r&&(this._lastGroup=null,this._count=null):this._releaseGroup(r),this._beginRefresh());u&&u!==r&&(this._invalidateIndices(u),u.firstReached&&i===u.firstItem.handle&&(f!==null?f:this._groupKey(n))!==u.key||this._releaseGroup(u),this._beginRefresh())},_processRemoval:function(n){var t=this._handleMap[n],i,r;if(t&&(n===t.firstItem.handle||n===t.lastItem.handle))this._releaseGroup(t),this._beginRefresh();else if(this._itemBatch)for(i=0;i<this._batchSize;i++)if(r=this._itemBatch[i],r&&r.handle===n){this._beginRefresh();break}},_inserted:function(n,t,i){var r=this;n.then(function(n){r._processInsertion(n,t,i)})},_changed:function(n,t){var i=this._handleMap[n.handle],r,u;i&&n.handle===i.firstItem.handle&&(this._releaseGroup(i),this._beginRefresh());this._groupKey(n)!==this._groupKey(t)&&(this._listBinding.jumpToItem(n),r=this._listBinding.previous().handle,this._listBinding.jumpToItem(n),u=this._listBinding.next().handle,this._processRemoval(n.handle),this._processInsertion(n,r,u))},_moved:function(n,t,i){this._processRemoval(n.handle);var r=this;n.then(function(n){r._processInsertion(n,t,i)})},_removed:function(n,t){t||this._processRemoval(n)},_indexChanged:function(n,t,i){typeof i=="number"&&(this._indicesChanged=!0)},_endNotifications:function(){var i,n,t;if(this._indicesChanged){this._indicesChanged=!1;for(i in this._keyMap)n=this._keyMap[i],n.firstReached&&n.lastReached&&(t=n.lastItem.index+1-n.firstItem.index,isNaN(t)||(n.size=t));this._beginRefresh()}},_reload:function(){this._initializeState();this._listDataNotificationHandler.reload()}},{supportedForProcessing:!1});return t.Class.derive(e.VirtualizedDataSource,function(n,t,i,r){var u=new c(n,t,i,r);this._baseDataSourceConstructor(u);this.extensions={invalidateGroups:function(){u.invalidateGroups()}}},{},{supportedForProcessing:!1})})})}),t("WinJS/VirtualizedDataSource/_GroupedItemDataSource",["../Core/_Base","./_GroupDataSource"],function(n,t){"use strict";n.Namespace.define("WinJS.UI",{computeDataSourceGroups:function(n,i,r,u){function h(n){if(n){var t=Object.create(n);return t.groupKey=i(n),r&&(t.groupData=r(n)),t}return null}function f(n){var t=Object.create(n);return t.then=function(t,i,r){return n.then(function(n){return t(h(n))},i,r)},t}var e=Object.create(n),c,o,l,s;for(e.createListBinding=function(t){var r,e,s;t?(r=Object.create(t),r.inserted=function(n,i,r){return t.inserted(f(n),i,r)},r.changed=function(n,i){return t.changed(h(n),h(i))},r.moved=function(n,i,r){return t.moved(f(n),i,r)}):r=null;var i=n.createListBinding(r),u=Object.create(i),o=["first","last","fromDescription","jumpToItem","current"];for(e=0,s=o.length;e<s;e++)(function(n){i[n]&&(u[n]=function(){return f(i[n].apply(i,arguments))})})(o[e]);return i.fromKey&&(u.fromKey=function(n){return f(i.fromKey(n))}),i.fromIndex&&(u.fromIndex=function(n){return f(i.fromIndex(n))}),u.prev=function(){return f(i.prev())},u.next=function(){return f(i.next())},u},c=["itemFromKey","itemFromIndex","itemFromDescription","insertAtStart","insertBefore","insertAfter","insertAtEnd","change","moveToStart","moveBefore","moveAfter","moveToEnd"],o=0,l=c.length;o<l;o++)(function(t){n[t]&&(e[t]=function(){return f(n[t].apply(n,arguments))})})(c[o]);return["addEventListener","removeEventListener","dispatchEvent"].forEach(function(t){n[t]&&(e[t]=function(){return n[t].apply(n,arguments)})}),s=null,Object.defineProperty(e,"groups",{get:function(){return s||(s=new t._GroupDataSource(n,i,r,u)),s},enumerable:!0,configurable:!0}),e}})}),t("WinJS/VirtualizedDataSource/_StorageDataSource",["exports","../Core/_WinRT","../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_WriteProfilerMark","../Animations","../Promise","../Utilities/_UI","./_VirtualizedDataSourceImpl"],function(n,t,i,r,u,f,e,o,s,h){"use strict";r.Namespace._moduleDefine(n,"WinJS.UI",{StorageDataSource:r.Namespace._lazy(function(){var n=r.Class.define(function(n,i){var o;f("WinJS.UI.StorageDataSource:constructor,StartTM");var u=t.Windows.Storage.FileProperties.ThumbnailMode.singleItem,r=256,s=t.Windows.Storage.FileProperties.ThumbnailOptions.useCurrentScale,h=!0,e;if(n==="Pictures"?(u=t.Windows.Storage.FileProperties.ThumbnailMode.picturesView,e=t.Windows.Storage.KnownFolders.picturesLibrary,r=190):n==="Music"?(u=t.Windows.Storage.FileProperties.ThumbnailMode.musicView,e=t.Windows.Storage.KnownFolders.musicLibrary,r=256):n==="Documents"?(u=t.Windows.Storage.FileProperties.ThumbnailMode.documentsView,e=t.Windows.Storage.KnownFolders.documentsLibrary,r=40):n==="Videos"&&(u=t.Windows.Storage.FileProperties.ThumbnailMode.videosView,e=t.Windows.Storage.KnownFolders.videosLibrary,r=190),e?(o=new t.Windows.Storage.Search.QueryOptions,o.folderDepth=t.Windows.Storage.Search.FolderDepth.deep,o.indexerOption=t.Windows.Storage.Search.IndexerOption.useIndexerWhenAvailable,this._query=e.createFileQueryWithOptions(o)):this._query=n,i){if(typeof i.mode=="number"&&(u=i.mode),typeof i.requestedThumbnailSize=="number")r=Math.max(1,Math.min(i.requestedThumbnailSize,1024));else switch(u){case t.Windows.Storage.FileProperties.ThumbnailMode.picturesView:case t.Windows.Storage.FileProperties.ThumbnailMode.videosView:r=190;break;case t.Windows.Storage.FileProperties.ThumbnailMode.documentsView:case t.Windows.Storage.FileProperties.ThumbnailMode.listView:r=40;break;case t.Windows.Storage.FileProperties.ThumbnailMode.musicView:case t.Windows.Storage.FileProperties.ThumbnailMode.singleItem:r=256}typeof i.thumbnailOptions=="number"&&(s=i.thumbnailOptions);typeof i.waitForFileLoad=="boolean"&&(h=!i.waitForFileLoad)}this._loader=new t.Windows.Storage.BulkAccess.FileInformationFactory(this._query,u,r,s,h);this.compareByIdentity=!1;this.firstDataRequest=!0;f("WinJS.UI.StorageDataSource:constructor,StopTM")},{setNotificationHandler:function(n){this._notificationHandler=n;this._query.addEventListener("contentschanged",function(){n.invalidateAll()});this._query.addEventListener("optionschanged",function(){n.invalidateAll()})},itemsFromEnd:function(n){var t=this;return f("WinJS.UI.StorageDataSource:itemsFromEnd,info"),this.getCount().then(function(i){return i===0?o.wrapError(new u(s.FetchError.doesNotExist)):t.itemsFromIndex(i-1,Math.min(i-1,n-1),1)})},itemsFromIndex:function(n,t,i){function l(n){e._notificationHandler.changed(e._item(n.target))}var c;t+i>64&&(t=Math.min(t,32),i=64-(t+1));var h=n-t,r=t+1+i,e=this;return e.firstDataRequest&&(e.firstDataRequest=!1,r=Math.max(r,32)),c="WinJS.UI.StorageDataSource:itemsFromIndex("+h+"-"+(h+r-1)+")",f(c+",StartTM"),this._loader.getItemsAsync(h,r).then(function(i){var a=i.size,p,y,v,w;if(a<=t)return o.wrapError(new u(s.FetchError.doesNotExist));for(p=new Array(a),y=new Array(a),i.getMany(0,y),v=0;v<a;v++)p[v]=e._item(y[v]),y[v].addEventListener("propertiesupdated",l);return w={items:p,offset:t,absoluteIndex:n},a<r&&(w.totalCount=h+a),f(c+",StopTM"),w})},itemsFromDescription:function(n,t,i){var r=this;return f("WinJS.UI.StorageDataSource:itemsFromDescription,info"),this._query.findStartIndexAsync(n).then(function(n){return r.itemsFromIndex(n,t,i)})},getCount:function(){return f("WinJS.UI.StorageDataSource:getCount,info"),this._query.getItemCountAsync()},itemSignature:function(n){return n.folderRelativeId},_item:function(n){return{key:n.path||n.folderRelativeId,data:n}}},{supportedForProcessing:!1});return r.Class.derive(h.VirtualizedDataSource,function(t,i){this._baseDataSourceConstructor(new n(t,i))},{},{loadThumbnail:function(n,r){var s,u,h=!1;return new o(function(c){var a=r?!0:!1,l=function(l){if(l){var v=i.URL.createObjectURL(l,{oneTimeOnly:!0});u=u?u.then(function(t){return n.loadImage(v,t)}):n.loadImage(v,r).then(function(t){return n.isOnScreen().then(function(n){var i;return n&&a?i=e.fadeIn(t).then(function(){return t}):(t.style.opacity=1,i=o.wrap(t)),i})});l.type===t.Windows.Storage.FileProperties.ThumbnailType.icon||l.returnedSmallerCachedSize||(f("WinJS.UI.StorageDataSource:loadThumbnail complete,info"),n.data.removeEventListener("thumbnailupdated",s),h=!1,u=u.then(function(n){s=null;u=null;c(n)}))}};s=function(n){h&&l(n.target.thumbnail)};n.data.addEventListener("thumbnailupdated",s);h=!0;l(n.data.thumbnail)},function(){n.data.removeEventListener("thumbnailupdated",s);h=!1;s=null;u&&(u.cancel(),u=null)})},supportedForProcessing:!1})})})}),t("WinJS/VirtualizedDataSource",["./VirtualizedDataSource/_VirtualizedDataSourceImpl","./VirtualizedDataSource/_GroupDataSource","./VirtualizedDataSource/_GroupedItemDataSource","./VirtualizedDataSource/_StorageDataSource"],function(){}),t("require-style",{load:function(n){throw new Error("Dynamic load not allowed: "+n);}}),t("require-style!less/styles-intrinsic",[],function(){}),t("require-style!less/colors-intrinsic",[],function(){}),t("WinJS/Controls/IntrinsicControls",["../Utilities/_Hoverable","require-style!less/styles-intrinsic","require-style!less/colors-intrinsic"],function(){}),t("WinJS/Controls/ItemContainer/_Constants",["exports","../../Core/_Base"],function(n,t){"use strict";var i={},r,u;i._listViewClass="win-listview";i._viewportClass="win-viewport";i._rtlListViewClass="win-rtl";i._horizontalClass="win-horizontal";i._verticalClass="win-vertical";i._scrollableClass="win-surface";i._itemsContainerClass="win-itemscontainer";i._listHeaderContainerClass="win-headercontainer";i._listFooterContainerClass="win-footercontainer";i._padderClass="win-itemscontainer-padder";i._proxyClass="_win-proxy";i._itemClass="win-item";i._itemBoxClass="win-itembox";i._itemsBlockClass="win-itemsblock";i._containerClass="win-container";i._containerEvenClass="win-container-even";i._containerOddClass="win-container-odd";i._backdropClass="win-backdrop";i._footprintClass="win-footprint";i._groupsClass="win-groups";i._selectedClass="win-selected";i._selectionBorderClass="win-selectionborder";i._selectionBackgroundClass="win-selectionbackground";i._selectionCheckmarkClass="win-selectioncheckmark";i._selectionCheckmarkBackgroundClass="win-selectioncheckmarkbackground";i._pressedClass="win-pressed";i._headerClass="win-groupheader";i._headerContainerClass="win-groupheadercontainer";i._groupLeaderClass="win-groupleader";i._progressClass="win-progress";i._revealedClass="win-revealed";i._itemFocusClass="win-focused";i._itemFocusOutlineClass="win-focusedoutline";i._zoomingXClass="win-zooming-x";i._zoomingYClass="win-zooming-y";i._listLayoutClass="win-listlayout";i._gridLayoutClass="win-gridlayout";i._headerPositionTopClass="win-headerpositiontop";i._headerPositionLeftClass="win-headerpositionleft";i._structuralNodesClass="win-structuralnodes";i._singleItemsBlockClass="win-single-itemsblock";i._uniformGridLayoutClass="win-uniformgridlayout";i._uniformListLayoutClass="win-uniformlistlayout";i._cellSpanningGridLayoutClass="win-cellspanninggridlayout";i._laidOutClass="win-laidout";i._nonDraggableClass="win-nondraggable";i._nonSelectableClass="win-nonselectable";i._dragOverClass="win-dragover";i._dragSourceClass="win-dragsource";i._clipClass="win-clip";i._selectionModeClass="win-selectionmode";i._noCSSGrid="win-nocssgrid";i._hidingSelectionMode="win-hidingselectionmode";i._hidingSelectionModeAnimationTimeout=250;i._INVALID_INDEX=-1;i._UNINITIALIZED=-1;i._LEFT_MSPOINTER_BUTTON=0;i._RIGHT_MSPOINTER_BUTTON=2;i._TAP_END_THRESHOLD=10;i._DEFAULT_PAGES_TO_LOAD=5;i._DEFAULT_PAGE_LOAD_THRESHOLD=2;i._MIN_AUTOSCROLL_RATE=150;i._MAX_AUTOSCROLL_RATE=1500;i._AUTOSCROLL_THRESHOLD=100;i._AUTOSCROLL_DELAY=50;i._DEFERRED_ACTION=250;i._DEFERRED_SCROLL_END=250;i._SELECTION_CHECKMARK="";i._LISTVIEW_PROGRESS_DELAY=2e3;r={uninitialized:0,low:1,medium:2,high:3};u={rebuild:0,remeasure:1,relayout:2,realize:3};i._ScrollToPriority=r;i._ViewChange=u;t.Namespace._moduleDefine(n,"WinJS.UI",i)}),t("WinJS/Controls/ItemContainer/_ItemEventsHandler",["exports","../../Core/_Global","../../Core/_WinRT","../../Core/_Base","../../Core/_BaseUtils","../../Core/_WriteProfilerMark","../../Animations","../../Animations/_TransitionAnimation","../../Promise","../../Utilities/_ElementUtilities","../../Utilities/_UI","./_Constants"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function v(n,t,i){var r=44,u=750,f=9,e=13,o=u-r,s=i.width/2,c=i.height/2,v=h._clamp(i.width,r,u),y=h._clamp(i.height,r,u),p=f-(y-r)/o*(f-2),w=e-(v-r)/o*(e-2.11),l=(n-i.left-s)/s,a=(t-i.top-c)/c,b=p*a,k=w*l,d=.97+.03*(Math.abs(l)+Math.abs(a))/2;return"perspective(800px) scale("+d+") rotateX("+-b+"deg) rotateY("+k+"deg)"}var a=u._browserStyleEquivalents.transform;r.Namespace._moduleDefine(n,"WinJS.UI",{_tiltTransform:v,_ItemEventsHandler:r.Namespace._lazy(function(){function e(n,i){var r=t.document.createElement("div");return r.className=n,i||r.setAttribute("aria-hidden",!0),r}var y=h._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",n=r.Class.define(function(n){this._site=n;this._work=[];this._animations={}},{dispose:function(){this._disposed||(this._disposed=!0,h._removeEventListener(t,"pointerup",this._resetPointerDownStateBound),h._removeEventListener(t,"pointercancel",this._resetPointerDownStateBound))},onPointerDown:function(n){var r,e,a,s,p,o,v;f("WinJS.UI._ItemEventsHandler:MSPointerDown,StartTM");r=this._site;e=n.pointerType===y;r.pressedElement=n.target;i.Windows.UI.Input.PointerPoint?(p=this._getCurrentPoint(n),o=p.properties,e||o.isInverted||o.isEraser||o.isMiddleButtonPressed?a=s=!1:(s=o.isRightButtonPressed,a=!s&&o.isLeftButtonPressed)):(a=n.button===l._LEFT_MSPOINTER_BUTTON,s=n.button===l._RIGHT_MSPOINTER_BUTTON);this._DragStartBound=this._DragStartBound||this.onDragStart.bind(this);this._PointerEnterBound=this._PointerEnterBound||this.onPointerEnter.bind(this);this._PointerLeaveBound=this._PointerLeaveBound||this.onPointerLeave.bind(this);var w=this._isInteractive(n.target),b=r.indexForItemElement(n.target),k=r.indexForHeaderElement(n.target),d=!w&&b!==l._INVALID_INDEX;if((e||a)&&this._site.pressedEntity.index===l._INVALID_INDEX&&!w&&(this._site.pressedEntity=k===l._INVALID_INDEX?{type:c.ObjectType.item,index:b}:{type:c.ObjectType.groupHeader,index:k},this._site.pressedEntity.index!==l._INVALID_INDEX&&(this._site.pressedPosition=h._getCursorPos(n),v=r.verifySelectionAllowed(this._site.pressedEntity),this._canSelect=v.canSelect,this._canTapSelect=v.canTapSelect,this._site.pressedEntity.type===c.ObjectType.item?(this._site.pressedItemBox=r.itemBoxAtIndex(this._site.pressedEntity.index),this._site.pressedContainer=r.containerAtIndex(this._site.pressedEntity.index),this._site.animatedElement=this._site.pressedContainer,this._site.pressedHeader=null,this._togglePressed(!0,!1,n),this._site.pressedContainer.addEventListener("dragstart",this._DragStartBound),e||(h._addEventListener(this._site.pressedContainer,"pointerenter",this._PointerEnterBound,!1),h._addEventListener(this._site.pressedContainer,"pointerleave",this._PointerLeaveBound,!1))):(this._site.pressedHeader=this._site.headerFromElement(n.target),u.isPhone?(this._site.animatedElement=this._site.pressedHeader,this._togglePressed(!0,!1,n)):(this._site.pressedItemBox=null,this._site.pressedContainer=null,this._site.animatedElement=null)),this._resetPointerDownStateBound||(this._resetPointerDownStateBound=this._resetPointerDownStateForPointerId.bind(this)),e||(h._addEventListener(t,"pointerup",this._resetPointerDownStateBound,!1),h._addEventListener(t,"pointercancel",this._resetPointerDownStateBound,!1)),this._pointerId=n.pointerId,this._pointerRightButton=s)),d&&e)try{h._setPointerCapture(r.canvasProxy,n.pointerId)}catch(g){f("WinJS.UI._ItemEventsHandler:MSPointerDown,StopTM");return}this._site.pressedEntity.type===c.ObjectType.item&&this._selectionAllowed()&&this._multiSelection()&&this._site.pressedEntity.index!==l._INVALID_INDEX&&r.selection._getFocused().index!==l._INVALID_INDEX&&r.selection._pivot===l._INVALID_INDEX&&(r.selection._pivot=r.selection._getFocused().index);f("WinJS.UI._ItemEventsHandler:MSPointerDown,StopTM")},onPointerEnter:function(n){this._site.pressedContainer&&this._pointerId===n.pointerId&&this._togglePressed(!0,!1,n)},onPointerLeave:function(n){this._site.pressedContainer&&this._pointerId===n.pointerId&&this._togglePressed(!1,!0,n)},onDragStart:function(){this._resetPressedContainer()},_resetPressedContainer:function(){(this._site.pressedContainer||this._site.pressedHeader)&&this._site.animatedElement&&(this._togglePressed(!1),this._site.pressedContainer&&(this._site.pressedContainer.style[a.scriptName]="",this._site.pressedContainer.removeEventListener("dragstart",this._DragStartBound),h._removeEventListener(this._site.pressedContainer,"pointerenter",this._PointerEnterBound,!1),h._removeEventListener(this._site.pressedContainer,"pointerleave",this._PointerLeaveBound,!1)))},onClick:function(n){var t,i;this._skipClick||(t={type:c.ObjectType.item,index:this._site.indexForItemElement(n.target)},t.index===l._INVALID_INDEX&&(t.index=this._site.indexForHeaderElement(n.target),t.index!==l._INVALID_INDEX&&(t.type=c.ObjectType.groupHeader)),t.index!==l._INVALID_INDEX&&(h.hasClass(n.target,this._site.accessibleItemClass)||h.hasClass(n.target,l._headerClass))&&(i=this._site.verifySelectionAllowed(t),i.canTapSelect&&this.handleTap(t),this._site.fireInvokeEvent(t,n.target)))},onPointerUp:function(n){var t,o,i,e,v;f("WinJS.UI._ItemEventsHandler:MSPointerUp,StartTM");t=this._site;this._skipClick=!0;o=this;u._yieldForEvents(function(){o._skipClick=!1});try{h._releasePointerCapture(t.canvasProxy,n.pointerId)}catch(d){}var s=n.pointerType===y,r=this._releasedElement(n),p=t.indexForItemElement(r),a=r&&h.hasClass(r,l._headerContainerClass)?t.indexForHeaderElement(t.pressedHeader):t.indexForHeaderElement(r);if(this._pointerId===n.pointerId){if(i=a===l._INVALID_INDEX?{type:c.ObjectType.item,index:p}:{type:c.ObjectType.groupHeader,index:a},this._resetPressedContainer(),this._site.pressedEntity.type===c.ObjectType.item&&i.type===c.ObjectType.item&&this._site.pressedContainer&&this._site.pressedEntity.index===i.index)if(n.shiftKey||(t.selection._pivot=l._INVALID_INDEX),n.shiftKey){if(this._selectionAllowed()&&this._multiSelection()&&t.selection._pivot!==l._INVALID_INDEX){var w=Math.min(this._site.pressedEntity.index,t.selection._pivot),b=Math.max(this._site.pressedEntity.index,t.selection._pivot),k=this._pointerRightButton||n.ctrlKey||t.tapBehavior===c.TapBehavior.toggleSelect;t.selectRange(w,b,k)}}else n.ctrlKey&&this.toggleSelectionIfAllowed(this._site.pressedEntity.index);(this._site.pressedHeader||this._site.pressedContainer)&&(e=h._getCursorPos(n),v=Math.abs(e.left-this._site.pressedPosition.left)<=l._TAP_END_THRESHOLD&&Math.abs(e.top-this._site.pressedPosition.top)<=l._TAP_END_THRESHOLD,this._pointerRightButton||n.ctrlKey||n.shiftKey||(!s||!v)&&(s||this._site.pressedEntity.index!==i.index||this._site.pressedEntity.type!==i.type)||(i.type===c.ObjectType.groupHeader?(this._site.pressedHeader=t.headerAtIndex(i.index),this._site.pressedItemBox=null,this._site.pressedContainer=null):(this._site.pressedItemBox=t.itemBoxAtIndex(i.index),this._site.pressedContainer=t.containerAtIndex(i.index),this._site.pressedHeader=null),this._canTapSelect&&this.handleTap(this._site.pressedEntity),this._site.fireInvokeEvent(this._site.pressedEntity,this._site.pressedItemBox||this._site.pressedHeader)));this._site.pressedEntity.index!==l._INVALID_INDEX&&t.changeFocus(this._site.pressedEntity,!0,!1,!0);this.resetPointerDownState()}f("WinJS.UI._ItemEventsHandler:MSPointerUp,StopTM")},onPointerCancel:function(n){this._pointerId===n.pointerId&&(f("WinJS.UI._ItemEventsHandler:MSPointerCancel,info"),this.resetPointerDownState())},onLostPointerCapture:function(n){this._pointerId===n.pointerId&&(f("WinJS.UI._ItemEventsHandler:MSLostPointerCapture,info"),this.resetPointerDownState())},onContextMenu:function(n){var t=this._site.containerFromElement(n.target);this._selectionAllowed()&&t&&!this._isInteractive(n.target)&&n.preventDefault()},onMSHoldVisual:function(n){this._isInteractive(n.target)||n.preventDefault()},onDataChanged:function(){this.resetPointerDownState()},toggleSelectionIfAllowed:function(n){this._selectionAllowed(n)&&this._toggleItemSelection(n)},handleTap:function(n){if(n.type!==c.ObjectType.groupHeader){var t=this._site,i=t.selection;this._selectionAllowed(n.index)&&this._selectOnTap()&&(t.tapBehavior===c.TapBehavior.toggleSelect?this._toggleItemSelection(n.index):t.selectionMode!==c.SelectionMode.multi&&i._isIncluded(n.index)||i.set(n.index))}},_toggleItemSelection:function(n){var i=this._site,t=i.selection,r=t._isIncluded(n);i.selectionMode===c.SelectionMode.single?r?t.clear():t.set(n):r?t.remove(n):t.add(n)},_getCurrentPoint:function(n){return i.Windows.UI.Input.PointerPoint.getCurrentPoint(n.pointerId)},_containedInElementWithClass:function(n,t){var r,i,u;if(n.parentNode)for(r=n.parentNode.querySelectorAll("."+t+", ."+t+" *"),i=0,u=r.length;i<u;i++)if(r[i]===n)return!0;return!1},_isSelected:function(n){return this._site.selection._isIncluded(n)},_isInteractive:function(n){return this._containedInElementWithClass(n,"win-interactive")},_togglePressed:function(n,t,i){function d(n){r._site.animatedElement.style[a.scriptName]===""?(r._site.animatedElement.style[a.scriptName]=n,r._site.animatedElementScaleTransform=r._site.animatedElement.style[a.scriptName]):r._site.animatedElementScaleTransform=""}function k(n,t){f("WinJS.UI._ItemEventsHandler:removePressedUI,info");h.removeClass(n,l._pressedClass);r._containsTransform(n,t)&&o.executeTransition(n,{property:a.cssName,delay:150,duration:350,timing:"cubic-bezier(0.17,0.17,0.2,1)",to:n.style[a.scriptName].replace(t,"")})}var r=this,y=this._site.pressedEntity.type===c.ObjectType.groupHeader,w,b,e,p;(this._site.animatedDownPromise&&this._site.animatedDownPromise.cancel(),y||!h.hasClass(this._site.pressedItemBox,l._nonSelectableClass))&&(this._staticMode(y)||(n?h.hasClass(this._site.animatedElement,l._pressedClass)||(f("WinJS.UI._ItemEventsHandler:applyPressedUI,info"),h.addClass(this._site.animatedElement,l._pressedClass),w=y?r._site.pressedHeader:r._site.pressedContainer,b=v(i.clientX,i.clientY,w.getBoundingClientRect()),this._site.animatedDownPromise=s.timeout(50).then(function(){d(b)})):h.hasClass(this._site.animatedElement,l._pressedClass)&&(e=this._site.animatedElement,p=this._site.animatedElementScaleTransform,t?k(e,p):u._setImmediate(function(){h.hasClass(e,l._pressedClass)&&k(e,p)}))))},_containsTransform:function(n,t){return t&&n.style[a.scriptName].indexOf(t)!==-1},_resetPointerDownStateForPointerId:function(n){this._pointerId===n.pointerId&&this.resetPointerDownState()},resetPointerDownState:function(){this._site.pressedElement=null;h._removeEventListener(t,"pointerup",this._resetPointerDownStateBound);h._removeEventListener(t,"pointercancel",this._resetPointerDownStateBound);this._resetPressedContainer();this._site.pressedContainer=null;this._site.animatedElement=null;this._site.pressedHeader=null;this._site.pressedItemBox=null;this._site.pressedEntity={type:c.ObjectType.item,index:l._INVALID_INDEX};this._pointerId=null},_releasedElement:function(n){return t.document.elementFromPoint(n.clientX,n.clientY)},_applyUIInBatches:function(n){function i(){t._work.length>0?(t._flushUIBatches(),t._paintedThisFrame=u._requestAnimationFrame(i.bind(t))):t._paintedThisFrame=null}var t=this;this._work.push(n);this._paintedThisFrame||i()},_flushUIBatches:function(){var t,n;if(this._work.length>0)for(t=this._work,this._work=[],n=0;n<t.length;n++)t[n]()},_selectionAllowed:function(n){var t=n!==undefined?this._site.itemAtIndex(n):null,i=!(t&&h.hasClass(t,l._nonSelectableClass));return i&&this._site.selectionMode!==c.SelectionMode.none},_multiSelection:function(){return this._site.selectionMode===c.SelectionMode.multi},_selectOnTap:function(){return this._site.tapBehavior===c.TapBehavior.toggleSelect||this._site.tapBehavior===c.TapBehavior.directSelect},_staticMode:function(n){return n?this._site.headerTapBehavior===c.GroupHeaderTapBehavior.none:this._site.tapBehavior===c.TapBehavior.none&&this._site.selectionMode===c.SelectionMode.none}},{setAriaSelected:function(n,t){var i=n.getAttribute("aria-selected")==="true";t!==i&&n.setAttribute("aria-selected",t)},renderSelection:function(t,i,r,u,f){var c,a,o,s;if(n._selectionTemplate||(n._selectionTemplate=[],n._selectionTemplate.push(e(l._selectionBackgroundClass)),n._selectionTemplate.push(e(l._selectionBorderClass)),n._selectionTemplate.push(e(l._selectionCheckmarkBackgroundClass)),c=e(l._selectionCheckmarkClass),c.textContent=l._SELECTION_CHECKMARK,n._selectionTemplate.push(c)),r!==h._isSelectionRendered(t)){if(r)for(t.insertBefore(n._selectionTemplate[0].cloneNode(!0),t.firstElementChild),o=1,s=n._selectionTemplate.length;o<s;o++)t.appendChild(n._selectionTemplate[o].cloneNode(!0));else for(a=t.querySelectorAll(h._selectionPartsSelector),o=0,s=a.length;o<s;o++)t.removeChild(a[o]);h[r?"addClass":"removeClass"](t,l._selectedClass);f&&h[r?"addClass":"removeClass"](f,l._selectedClass)}u&&n.setAriaSelected(i,r)}});return n})})}),t("WinJS/Controls/ListView/_SelectionManager",["exports","../../Core/_Global","../../Core/_Base","../../Promise","../../_Signal","../../Utilities/_UI","../ItemContainer/_Constants"],function(n,t,i,r,u,f,e){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{_ItemSet:i.Namespace._lazy(function(){var t=i.Class.define(function(n,t,i){this._listView=n;this._ranges=t;this._itemsCount=i});return t.prototype={getRanges:function(){for(var n,i=[],t=0,r=this._ranges.length;t<r;t++)n=this._ranges[t],i.push({firstIndex:n.firstIndex,lastIndex:n.lastIndex,firstKey:n.firstKey,lastKey:n.lastKey});return i},getItems:function(){return n.getItemsFromRanges(this._listView._itemsManager.dataSource,this._ranges)},isEverything:function(){return this.count()===this._itemsCount},count:function(){for(var t,i=0,n=0,r=this._ranges.length;n<r;n++)t=this._ranges[n],i+=t.lastIndex-t.firstIndex+1;return i},getIndices:function(){for(var i,n,r=[],t=0,u=this._ranges.length;t<u;t++)for(i=this._ranges[t],n=i.firstIndex;n<=i.lastIndex;n++)r.push(n);return r}},t}),getItemsFromRanges:function(n,t){function f(){for(var u,n,f=[],i=0,e=t.length;i<e;i++)for(u=t[i],n=u.firstIndex;n<=u.lastIndex;n++)f.push(n);return r.wrap(f)}var i=n.createListBinding(),u=[];return f().then(function(n){for(var t=0;t<n.length;t++)u.push(i.fromIndex(n[t]));return r.join(u).then(function(n){return i.release(),n})})},_Selection:i.Namespace._lazy(function(){function t(n){return n&&n.firstIndex===0&&n.lastIndex===Number.MAX_VALUE}return i.Class.derive(n._ItemSet,function(n,t){this._listView=n;this._itemsCount=-1;this._ranges=[];t&&this.set(t)},{clear:function(){return this._releaseRanges(this._ranges),this._ranges=[],r.wrap()},set:function(n){if(t(n))return this.selectAll();this._releaseRanges(this._ranges);this._ranges=[];var i=this;return this._execute("_set",n).then(function(){return i._ranges.sort(function(n,t){return n.firstIndex-t.firstIndex}),i._ensureKeys()}).then(function(){return i._ensureCount()})},add:function(n){if(t(n))return this.selectAll();var i=this;return this._execute("_add",n).then(function(){return i._ensureKeys()}).then(function(){return i._ensureCount()})},remove:function(n){var t=this;return this._execute("_remove",n).then(function(){return t._ensureKeys()})},selectAll:function(){var n=this;return n._ensureCount().then(function(){if(n._itemsCount){var t={firstIndex:0,lastIndex:n._itemsCount-1};return n._retainRange(t),n._releaseRanges(n._ranges),n._ranges=[t],n._ensureKeys()}})},_execute:function(n,t){function u(n,t,i){var r={};return r["first"+n]=t,r["last"+n]=i,r}function c(t){var i=f._getListBinding(),u=r.join([i.fromKey(t.firstKey),i.fromKey(t.lastKey)]).then(function(i){return i[0]&&i[1]&&(t.firstIndex=i[0].index,t.lastIndex=i[1].index,f[n](t)),t});h.push(u)}for(var i,f=this,o=!!f._getListBinding().fromKey,s=Array.isArray(t)?t:[t],h=[r.wrap()],e=0,l=s.length;e<l;e++)i=s[e],typeof i=="number"?this[n](u("Index",i,i)):i&&(o&&i.key!==undefined?c(u("Key",i.key,i.key)):o&&i.firstKey!==undefined&&i.lastKey!==undefined?c(u("Key",i.firstKey,i.lastKey)):i.index!==undefined&&typeof i.index=="number"?this[n](u("Index",i.index,i.index)):i.firstIndex!==undefined&&i.lastIndex!==undefined&&typeof i.firstIndex=="number"&&typeof i.lastIndex=="number"&&this[n](u("Index",i.firstIndex,i.lastIndex)));return r.join(h)},_set:function(n){this._retainRange(n);this._ranges.push(n)},_add:function(n){for(var s,h,c=this,u=null,r,t,f=function(n,t){t.lastIndex>n.lastIndex&&(n.lastIndex=t.lastIndex,n.lastKey=t.lastKey,n.lastPromise&&n.lastPromise.release(),n.lastPromise=c._getListBinding().fromIndex(n.lastIndex).retain())},o,i=0,e=this._ranges.length;i<e;i++){if(r=this._ranges[i],n.firstIndex<r.firstIndex){o=u&&n.firstIndex<u.lastIndex+1;o?(t=i-1,f(u,n)):(this._insertRange(i,n),t=i);break}else if(n.firstIndex===r.firstIndex){f(r,n);t=i;break}u=r}if(t===undefined)s=this._ranges.length?this._ranges[this._ranges.length-1]:null,h=s&&n.firstIndex<s.lastIndex+1,h?f(s,n):(this._retainRange(n),this._ranges.push(n));else{for(u=null,i=t+1,e=this._ranges.length;i<e;i++){if(r=this._ranges[i],n.lastIndex<r.firstIndex){o=u&&u.lastIndex>n.lastIndex;o&&f(this._ranges[t],u);this._removeRanges(t+1,i-t-1);break}else if(n.lastIndex===r.firstIndex){f(this._ranges[t],r);this._removeRanges(t+1,i-t);break}u=r}i>=e&&(f(this._ranges[t],this._ranges[e-1]),this._removeRanges(t+1,e-t-1))}},_remove:function(n){function r(n){return f._getListBinding().fromIndex(n).retain()}for(var t,f=this,i=[],u=0,e=this._ranges.length;u<e;u++)t=this._ranges[u],t.lastIndex<n.firstIndex||t.firstIndex>n.lastIndex?i.push(t):t.firstIndex<n.firstIndex&&t.lastIndex>=n.firstIndex&&t.lastIndex<=n.lastIndex?(i.push({firstIndex:t.firstIndex,firstKey:t.firstKey,firstPromise:t.firstPromise,lastIndex:n.firstIndex-1,lastPromise:r(n.firstIndex-1)}),t.lastPromise.release()):t.lastIndex>n.lastIndex&&t.firstIndex>=n.firstIndex&&t.firstIndex<=n.lastIndex?(i.push({firstIndex:n.lastIndex+1,firstPromise:r(n.lastIndex+1),lastIndex:t.lastIndex,lastKey:t.lastKey,lastPromise:t.lastPromise}),t.firstPromise.release()):t.firstIndex<n.firstIndex&&t.lastIndex>n.lastIndex?(i.push({firstIndex:t.firstIndex,firstKey:t.firstKey,firstPromise:t.firstPromise,lastIndex:n.firstIndex-1,lastPromise:r(n.firstIndex-1)}),i.push({firstIndex:n.lastIndex+1,firstPromise:r(n.lastIndex+1),lastIndex:t.lastIndex,lastKey:t.lastKey,lastPromise:t.lastPromise})):(t.firstPromise.release(),t.lastPromise.release());this._ranges=i},_ensureKeys:function(){for(var i,n=[r.wrap()],u=this,f=function(n,t){var u=n+"Key",i;return t[u]?r.wrap():(i=t[n+"Promise"],i.then(function(n){n&&(t[u]=n.key)}),i)},t=0,e=this._ranges.length;t<e;t++)i=this._ranges[t],n.push(f("first",i)),n.push(f("last",i));return r.join(n).then(function(){u._ranges=u._ranges.filter(function(n){return n.firstKey&&n.lastKey})}),r.join(n)},_mergeRanges:function(n,t){n.lastIndex=t.lastIndex;n.lastKey=t.lastKey},_isIncluded:function(n){var t,r,i;if(this.isEverything())return!0;for(t=0,r=this._ranges.length;t<r;t++)if(i=this._ranges[t],i.firstIndex<=n&&n<=i.lastIndex)return!0;return!1},_ensureCount:function(){var n=this;return this._listView._itemsCount().then(function(t){n._itemsCount=t})},_insertRange:function(n,t){this._retainRange(t);this._ranges.splice(n,0,t)},_removeRanges:function(n,t){for(var i=0;i<t;i++)this._releaseRange(this._ranges[n+i]);this._ranges.splice(n,t)},_retainRange:function(n){n.firstPromise||(n.firstPromise=this._getListBinding().fromIndex(n.firstIndex).retain());n.lastPromise||(n.lastPromise=this._getListBinding().fromIndex(n.lastIndex).retain())},_retainRanges:function(){for(var n=0,t=this._ranges.length;n<t;n++)this._retainRange(this._ranges[n])},_releaseRange:function(n){n.firstPromise.release();n.lastPromise.release()},_releaseRanges:function(n){for(var t=0,i=n.length;t<i;++t)this._releaseRange(n[t])},_getListBinding:function(){return this._listView._itemsManager._listBinding}},{supportedForProcessing:!1})}),_SelectionManager:i.Namespace._lazy(function(){var i=function(t){this._listView=t;this._selected=new n._Selection(this._listView);this._pivot=e._INVALID_INDEX;this._focused={type:f.ObjectType.item,index:0};this._pendingChange=r.wrap()};return i.prototype={count:function(){return this._selected.count()},getIndices:function(){return this._selected.getIndices()},getItems:function(){return this._selected.getItems()},getRanges:function(){return this._selected.getRanges()},isEverything:function(){return this._selected.isEverything()},set:function(t){var f=this,i=new u;return this._synchronize(i).then(function(){var u=new n._Selection(f._listView);return u.set(t).then(function(){f._set(u);i.complete()},function(n){return u.clear(),i.complete(),r.wrapError(n)})})},clear:function(){var i=this,t=new u;return this._synchronize(t).then(function(){var u=new n._Selection(i._listView);return u.clear().then(function(){i._set(u);t.complete()},function(n){return u.clear(),t.complete(),r.wrapError(n)})})},add:function(n){var i=this,t=new u;return this._synchronize(t).then(function(){var u=i._cloneSelection();return u.add(n).then(function(){i._set(u);t.complete()},function(n){return u.clear(),t.complete(),r.wrapError(n)})})},remove:function(n){var i=this,t=new u;return this._synchronize(t).then(function(){var u=i._cloneSelection();return u.remove(n).then(function(){i._set(u);t.complete()},function(n){return u.clear(),t.complete(),r.wrapError(n)})})},selectAll:function(){var i=this,t=new u;return this._synchronize(t).then(function(){var u=new n._Selection(i._listView);return u.selectAll().then(function(){i._set(u);t.complete()},function(n){return u.clear(),t.complete(),r.wrapError(n)})})},_synchronize:function(n){var t=this;return this._listView._versionManager.unlocked.then(function(){var i=t._pendingChange;return t._pendingChange=r.join([i,n.promise]).then(function(){}),i})},_reset:function(){this._pivot=e._INVALID_INDEX;this._setFocused({type:f.ObjectType.item,index:0},this._keyboardFocused());this._pendingChange.cancel();this._pendingChange=r.wrap();this._selected.clear();this._selected=new n._Selection(this._listView)},_dispose:function(){this._selected.clear();this._selected=null;this._listView=null},_set:function(n){var t=this;return this._fireSelectionChanging(n).then(function(i){return i?(t._selected.clear(),t._selected=n,t._listView._updateSelection(),t._fireSelectionChanged()):n.clear(),i})},_fireSelectionChanging:function(n){var i=t.document.createEvent("CustomEvent"),u=r.wrap(),f;return i.initCustomEvent("selectionchanging",!0,!0,{newSelection:n,preventTapBehavior:function(){},setPromise:function(n){u=n}}),f=this._listView._element.dispatchEvent(i),u.then(function(){return f})},_fireSelectionChanged:function(){var n=t.document.createEvent("CustomEvent");n.initCustomEvent("selectionchanged",!0,!1,null);this._listView._element.dispatchEvent(n)},_getFocused:function(){return{type:this._focused.type,index:this._focused.index}},_setFocused:function(n,t){this._focused={type:n.type,index:n.index};this._focusedByKeyboard=t},_keyboardFocused:function(){return this._focusedByKeyboard},_updateCount:function(n){this._selected._itemsCount=n},_isIncluded:function(n){return this._selected._isIncluded(n)},_cloneSelection:function(){var t=new n._Selection(this._listView);return t._ranges=this._selected.getRanges(),t._itemsCount=this._selected._itemsCount,t._retainRanges(),t}},i.supportedForProcessing=!1,i})})}),t("WinJS/Controls/ListView/_BrowseMode",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Animations","../../Promise","../../Utilities/_ElementUtilities","../../Utilities/_UI","../ItemContainer/_Constants","../ItemContainer/_ItemEventsHandler","./_SelectionManager"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l=r._browserStyleEquivalents.transform.scriptName;i.Namespace._moduleDefine(n,"WinJS.UI",{_SelectionMode:i.Namespace._lazy(function(){function u(n,t,i){return Math.max(n,Math.min(t,i))}function n(n,i,r){var u=t.document.createEvent("CustomEvent");return u.initCustomEvent("keyboardnavigating",!0,!0,{oldFocus:i.index,oldFocusType:i.type,newFocus:r.index,newFocusType:r.type}),n.dispatchEvent(u)}return i.Class.define(function(n){this.inboundFocusHandled=!1;this._pressedContainer=null;this._pressedItemBox=null;this._pressedHeader=null;this._pressedEntity={type:o.ObjectType.item,index:s._INVALID_INDEX};this._pressedPosition=null;this.initialize(n)},{_dispose:function(){this._itemEventsHandler&&this._itemEventsHandler.dispose();this._setNewFocusItemOffsetPromise&&this._setNewFocusItemOffsetPromise.cancel()},initialize:function(n){function u(t,i){var r=function(i){return n._view.getAdjacent(i,t)};return r.clampToBounds=i,r}var t,i,r;this.site=n;this._keyboardNavigationHandlers={};this._keyboardAcceleratorHandlers={};t=this.site;i=this;this._itemEventsHandler=new h._ItemEventsHandler(Object.create({containerFromElement:function(n){return t._view.items.containerFrom(n)},indexForItemElement:function(n){return t._view.items.index(n)},indexForHeaderElement:function(n){return t._groups.index(n)},itemBoxAtIndex:function(n){return t._view.items.itemBoxAt(n)},itemAtIndex:function(n){return t._view.items.itemAt(n)},headerAtIndex:function(n){return t._groups.group(n).header},headerFromElement:function(n){return t._groups.headerFrom(n)},containerAtIndex:function(n){return t._view.items.containerAt(n)},isZombie:function(){return t._isZombie()},getItemPosition:function(n){return t._getItemPosition(n)},rtl:function(){return t._rtl()},fireInvokeEvent:function(n,t){return i._fireInvokeEvent(n,t)},verifySelectionAllowed:function(n){return i._verifySelectionAllowed(n)},changeFocus:function(n,i,r,u,f){return t._changeFocus(n,i,r,u,f)},selectRange:function(n,t,r){return i._selectRange(n,t,r)}},{pressedEntity:{enumerable:!0,get:function(){return i._pressedEntity},set:function(n){i._pressedEntity=n}},pressedContainerScaleTransform:{enumerable:!0,get:function(){return i._pressedContainerScaleTransform},set:function(n){i._pressedContainerScaleTransform=n}},pressedContainer:{enumerable:!0,get:function(){return i._pressedContainer},set:function(n){i._pressedContainer=n}},pressedItemBox:{enumerable:!0,get:function(){return i._pressedItemBox},set:function(n){i._pressedItemBox=n}},pressedHeader:{enumerable:!0,get:function(){return i._pressedHeader},set:function(n){return i._pressedHeader=n}},pressedPosition:{enumerable:!0,get:function(){return i._pressedPosition},set:function(n){i._pressedPosition=n}},pressedElement:{enumerable:!0,set:function(n){i._pressedElement=n}},eventHandlerRoot:{enumerable:!0,get:function(){return t._viewport}},selectionMode:{enumerable:!0,get:function(){return t._selectionMode}},accessibleItemClass:{enumerable:!0,get:function(){return s._itemClass}},canvasProxy:{enumerable:!0,get:function(){return t._canvasProxy}},tapBehavior:{enumerable:!0,get:function(){return t._tap}},headerTapBehavior:{enumerable:!0,get:function(){return t._groupHeaderTap}},draggable:{enumerable:!0,get:function(){return t.itemsDraggable||t.itemsReorderable}},selection:{enumerable:!0,get:function(){return t._selection}},customFootprintParent:{enumerable:!0,get:function(){return null}}}));r=e.Key;this._keyboardNavigationHandlers[r.upArrow]=u(r.upArrow);this._keyboardNavigationHandlers[r.downArrow]=u(r.downArrow);this._keyboardNavigationHandlers[r.leftArrow]=u(r.leftArrow);this._keyboardNavigationHandlers[r.rightArrow]=u(r.rightArrow);this._keyboardNavigationHandlers[r.pageUp]=u(r.pageUp,!0);this._keyboardNavigationHandlers[r.pageDown]=u(r.pageDown,!0);this._keyboardNavigationHandlers[r.home]=function(n){return i.site._header&&(n.type===o.ObjectType.groupHeader||n.type===o.ObjectType.footer)?f.wrap({type:o.ObjectType.header,index:0}):f.wrap({type:n.type!==o.ObjectType.footer?n.type:o.ObjectType.groupHeader,index:0})};this._keyboardNavigationHandlers[r.end]=function(n){if(i.site._footer&&(n.type===o.ObjectType.groupHeader||n.type===o.ObjectType.header))return f.wrap({type:o.ObjectType.footer,index:0});if(n.type===o.ObjectType.groupHeader||n.type===o.ObjectType.header)return f.wrap({type:o.ObjectType.groupHeader,index:t._groups.length()-1});var r=i.site._view.lastItemIndex();return r>=0?f.wrap({type:n.type,index:r}):f.cancel};this._keyboardAcceleratorHandlers[r.a]=function(){i.site._multiSelection()&&i._selectAll()}},staticMode:function(){return this.site._tap===o.TapBehavior.none&&this.site._selectionMode===o.SelectionMode.none},itemUnrealized:function(n,t){if(this._pressedEntity.type!==o.ObjectType.groupHeader&&(this._pressedEntity.index===n&&this._resetPointerDownState(),this._itemBeingDragged(n)))for(var i=this._draggedItemBoxes.length-1;i>=0;i--)this._draggedItemBoxes[i]===t&&(e.removeClass(t,s._dragSourceClass),this._draggedItemBoxes.splice(i,1))},_fireInvokeEvent:function(n,i){function r(r,f){var s=r.createListBinding(),e=s.fromIndex(n.index),h=f?"groupheaderinvoked":"iteminvoked",o;e.done(function(){s.release()});o=t.document.createEvent("CustomEvent");o.initCustomEvent(h,!0,!0,f?{groupHeaderPromise:e,groupHeaderIndex:n.index}:{itemPromise:e,itemIndex:n.index});i.dispatchEvent(o)&&u.site._defaultInvoke(n)}if(i){var u=this;n.type===o.ObjectType.groupHeader?this.site._groupHeaderTap===o.GroupHeaderTapBehavior.invoke&&n.index!==s._INVALID_INDEX&&r(this.site.groupDataSource,!0):this.site._tap!==o.TapBehavior.none&&n.index!==s._INVALID_INDEX&&r(this.site.itemDataSource,!1)}},_verifySelectionAllowed:function(n){var k,h;if(n.type===o.ObjectType.groupHeader)return{canSelect:!1,canTapSelect:!1};var r=n.index,u=this.site,c=this.site._view.items.itemAt(r);if(!u._selectionAllowed()||!u._selectOnTap()||c&&e.hasClass(c,s._nonSelectableClass))return{canSelect:!1,canTapSelect:!1};var l=u._selection._isIncluded(r),a=!u._multiSelection(),i=u._selection._cloneSelection();l?a?i.clear():i.remove(r):a?i.set(r):i.add(r);var v=t.document.createEvent("CustomEvent"),y=f.wrap(),p=!1,w=!1,b;return v.initCustomEvent("selectionchanging",!0,!0,{newSelection:i,preventTapBehavior:function(){w=!0},setPromise:function(n){y=n}}),k=u._element.dispatchEvent(v),y.then(function(){p=!0;b=i._isIncluded(r);i.clear()}),h=k&&p&&(l||b),{canSelect:h,canTapSelect:h&&!w}},_containedInElementWithClass:function(n,t){var r,i,u;if(n.parentNode)for(r=n.parentNode.querySelectorAll("."+t+", ."+t+" *"),i=0,u=r.length;i<u;i++)if(r[i]===n)return!0;return!1},_isDraggable:function(n){return!this._containedInElementWithClass(n,s._nonDraggableClass)},_isInteractive:function(n){return this._containedInElementWithClass(n,"win-interactive")},_resetPointerDownState:function(){this._itemEventsHandler.resetPointerDownState()},onPointerDown:function(n){this._itemEventsHandler.onPointerDown(n)},onclick:function(n){this._itemEventsHandler.onClick(n)},onPointerUp:function(n){this._itemEventsHandler.onPointerUp(n)},onPointerCancel:function(n){this._itemEventsHandler.onPointerCancel(n)},onLostPointerCapture:function(n){this._itemEventsHandler.onLostPointerCapture(n)},onContextMenu:function(n){this._itemEventsHandler.onContextMenu(n)},onMSHoldVisual:function(n){this._itemEventsHandler.onMSHoldVisual(n)},onDataChanged:function(n){this._itemEventsHandler.onDataChanged(n)},_removeTransform:function(n,t){t&&n.style[l].indexOf(t)!==-1&&(n.style[l]=n.style[l].replace(t,""))},_selectAll:function(){var n=[];this.site._view.items.each(function(t,i){i&&e.hasClass(i,s._nonSelectableClass)&&n.push(t)});this.site._selection.selectAll();n.length>0&&this.site._selection.remove(n)},_selectRange:function(n,t,i){for(var o,f=[],r=-1,u=n;u<=t;u++)o=this.site._view.items.itemAt(u),o&&e.hasClass(o,s._nonSelectableClass)?r!==-1&&(f.push({firstIndex:r,lastIndex:u-1}),r=-1):r===-1&&(r=u);r!==-1&&f.push({firstIndex:r,lastIndex:t});f.length>0&&this.site._selection[i?"add":"set"](f)},onDragStart:function(n){var f,h,u,l,i,a;this._pressedEntity={type:o.ObjectType.item,index:this.site._view.items.index(n.target)};this.site._selection._pivot=s._INVALID_INDEX;this._pressedEntity.index===s._INVALID_INDEX||!(this.site.itemsDraggable||this.site.itemsReorderable)||this.site._view.animating||!this._isDraggable(n.target)||this._pressedElement&&this._isInteractive(this._pressedElement)?n.preventDefault():(this._dragging=!0,this._dragDataTransfer=n.dataTransfer,this._pressedPosition=e._getCursorPos(n),this._dragInfo=null,this._lastEnteredElement=n.target,this.site._selection._isIncluded(this._pressedEntity.index)?this._dragInfo=this.site.selection:(this._draggingUnselectedItem=!0,this._dragInfo=new c._Selection(this.site,[{firstIndex:this._pressedEntity.index,lastIndex:this._pressedEntity.index}])),f=this.site.itemsReorderable,h=t.document.createEvent("CustomEvent"),h.initCustomEvent("itemdragstart",!0,!1,{dataTransfer:n.dataTransfer,dragInfo:this._dragInfo}),n.dataTransfer.setData("text",""),n.dataTransfer.setDragImage&&(u=this.site._view.items.itemDataAt(this._pressedEntity.index),u&&u.container&&(l=u.container.getBoundingClientRect(),n.dataTransfer.setDragImage(u.container,n.clientX-l.left,n.clientY-l.top))),this.site.element.dispatchEvent(h),this.site.itemsDraggable&&!this.site.itemsReorderable&&(this._firedDragEnter||this._fireDragEnterEvent(n.dataTransfer)&&(f=!0,this._dragUnderstood=!0)),f&&(this._addedDragOverClass=!0,e.addClass(this.site._element,s._dragOverClass)),this._draggedItemBoxes=[],i=this,a=n.target,a.addEventListener("dragend",function v(n){a.removeEventListener("dragend",v);i.onDragEnd(n)}),r._yieldForDomModification(function(){var r,n,u,t;if(i._dragging)for(r=i._dragInfo.getIndices(),n=0,u=r.length;n<u;n++)t=i.site._view.items.itemDataAt(r[n]),t&&t.itemBox&&i._addDragSourceClass(t.itemBox)}))},onDragEnter:function(n){var i=this._dragUnderstood;this._lastEnteredElement=n.target;this._exitEventTimer&&(t.clearTimeout(this._exitEventTimer),this._exitEventTimer=0);this._firedDragEnter||this._fireDragEnterEvent(n.dataTransfer)&&(i=!0);(i||this._dragging&&this.site.itemsReorderable)&&(n.preventDefault(),this._dragUnderstood=!0,this._addedDragOverClass||(this._addedDragOverClass=!0,e.addClass(this.site._element,s._dragOverClass)));this._pointerLeftRegion=!1},onDragLeave:function(n){n.target===this._lastEnteredElement&&(this._pointerLeftRegion=!0,this._handleExitEvent())},fireDragUpdateEvent:function(){var n=t.document.createEvent("CustomEvent");n.initCustomEvent("itemdragchanged",!0,!1,{dataTransfer:this._dragDataTransfer,dragInfo:this._dragInfo});this.site.element.dispatchEvent(n)},_fireDragEnterEvent:function(n){var i=t.document.createEvent("CustomEvent"),r;return i.initCustomEvent("itemdragenter",!0,!0,{dataTransfer:n}),r=!this.site.element.dispatchEvent(i),this._firedDragEnter=!0,r},_fireDragBetweenEvent:function(n,i,r){var u=t.document.createEvent("CustomEvent");return u.initCustomEvent("itemdragbetween",!0,!0,{index:n,insertAfterIndex:i,dataTransfer:r}),this.site.element.dispatchEvent(u)},_fireDropEvent:function(n,i,r){var u=t.document.createEvent("CustomEvent");return u.initCustomEvent("itemdragdrop",!0,!0,{index:n,insertAfterIndex:i,dataTransfer:r}),this.site.element.dispatchEvent(u)},_handleExitEvent:function(){this._exitEventTimer&&(t.clearTimeout(this._exitEventTimer),this._exitEventTimer=0);var n=this;this._exitEventTimer=t.setTimeout(function(){if(!n.site._disposed&&n._pointerLeftRegion){if(n.site._layout.dragLeave&&n.site._layout.dragLeave(),n._pointerLeftRegion=!1,n._dragUnderstood=!1,n._lastEnteredElement=null,n._lastInsertPoint=null,n._dragBetweenDisabled=!1,n._firedDragEnter){var i=t.document.createEvent("CustomEvent");i.initCustomEvent("itemdragleave",!0,!1,{});n.site.element.dispatchEvent(i);n._firedDragEnter=!1}n._addedDragOverClass&&(n._addedDragOverClass=!1,e.removeClass(n.site._element,s._dragOverClass));n._exitEventTimer=0;n._stopAutoScroll()}},40)},_getEventPositionInElementSpace:function(n,i){var r={left:0,top:0};try{r=n.getBoundingClientRect()}catch(a){}var u=t.getComputedStyle(n,null),s=parseInt(u.paddingLeft),h=parseInt(u.paddingTop),c=parseInt(u.borderLeftWidth),l=parseInt(u.borderTopWidth),f=i.clientX,e=i.clientY,o={x:+f===f?f-r.left-s-c:0,y:+e===e?e-r.top-h-l:0};return this.site._rtl()&&(o.x=r.right-r.left-o.x),o},_getPositionInCanvasSpace:function(n){var i=this.site._horizontal()?this.site.scrollPosition:0,r=this.site._horizontal()?0:this.site.scrollPosition,t=this._getEventPositionInElementSpace(this.site.element,n);return{x:t.x+i,y:t.y+r}},_itemBeingDragged:function(n){return this._dragging?this._draggingUnselectedItem&&this._dragInfo._isIncluded(n)||!this._draggingUnselectedItem&&this.site._isSelected(n):!1},_addDragSourceClass:function(n){this._draggedItemBoxes.push(n);e.addClass(n,s._dragSourceClass);n.parentNode&&e.addClass(n.parentNode,s._footprintClass)},renderDragSourceOnRealizedItem:function(n,t){this._itemBeingDragged(n)&&this._addDragSourceClass(t)},onDragOver:function(n){var i,r,t;this._dragUnderstood&&(this._pointerLeftRegion=!1,n.preventDefault(),i=this._getPositionInCanvasSpace(n),r=this._getEventPositionInElementSpace(this.site.element,n),this._checkAutoScroll(r.x,r.y),this.site._layout.hitTest&&(this._autoScrollFrame?this._lastInsertPoint&&(this.site._layout.dragLeave(),this._lastInsertPoint=null):(t=this.site._view.hitTest(i.x,i.y),t.insertAfterIndex=u(-1,this.site._cachedCount-1,t.insertAfterIndex),this._lastInsertPoint&&this._lastInsertPoint.insertAfterIndex===t.insertAfterIndex&&this._lastInsertPoint.index===t.index||(this._dragBetweenDisabled=!this._fireDragBetweenEvent(t.index,t.insertAfterIndex,n.dataTransfer),this._dragBetweenDisabled?this.site._layout.dragLeave():this.site._layout.dragOver(i.x,i.y,this._dragInfo)),this._lastInsertPoint=t)))},_clearDragProperties:function(){if(this._addedDragOverClass&&(this._addedDragOverClass=!1,e.removeClass(this.site._element,s._dragOverClass)),this._draggedItemBoxes){for(var n=0,t=this._draggedItemBoxes.length;n<t;n++)e.removeClass(this._draggedItemBoxes[n],s._dragSourceClass),this._draggedItemBoxes[n].parentNode&&e.removeClass(this._draggedItemBoxes[n].parentNode,s._footprintClass);this._draggedItemBoxes=[]}this.site._layout.dragLeave();this._dragging=!1;this._dragInfo=null;this._draggingUnselectedItem=!1;this._dragDataTransfer=null;this._lastInsertPoint=null;this._resetPointerDownState();this._lastEnteredElement=null;this._dragBetweenDisabled=!1;this._firedDragEnter=!1;this._dragUnderstood=!1;this._stopAutoScroll()},onDragEnd:function(){var n=t.document.createEvent("CustomEvent");n.initCustomEvent("itemdragend",!0,!1,{});this.site.element.dispatchEvent(n);this._clearDragProperties()},_findFirstAvailableInsertPoint:function(n,t,i){for(var e=n.getIndices(),r=-1,o=this.site._cachedCount,s=e.length,h=-1,u=t,f=0;f<s;f++)if(e[f]===u){r=f;h=f;break}while(r>=0&&u>=0)i?(u++,r<s&&e[r+1]===u&&u<o?r++:u>=o?(i=!1,u=t,r=h):r=-1):(u--,r>0&&e[r-1]===u?r--:r=-1);return u},_reorderItems:function(n,t,i,r,u){var f=this.site,e=function(n){i?f._selection.remove({key:n[0].key}):f._selection.set({firstKey:n[0].key,lastKey:n[n.length-1].key});u&&f.ensureVisible(f._selection._getFocused())};t.getItems().then(function(t){var i=f.itemDataSource,u,o;if(n===-1){for(i.beginEdits(),u=t.length-1;u>=0;u--)i.moveToStart(t[u].key);i.endEdits();e(t)}else o=i.createListBinding(),o.fromIndex(n).then(function(n){var f,u;if(o.release(),i.beginEdits(),r)for(u=0,f=t.length;u<f;u++)i.moveBefore(t[u].key,n.key);else for(u=t.length-1;u>=0;u--)i.moveAfter(t[u].key,n.key);i.endEdits();e(t)})})},onDrop:function(n){var i,f;if(this._draggedItemBoxes)for(i=0,f=this._draggedItemBoxes.length;i<f;i++)this._draggedItemBoxes[i].parentNode&&e.removeClass(this._draggedItemBoxes[i].parentNode,s._footprintClass);if(!this._dragBetweenDisabled){var o=this._getPositionInCanvasSpace(n),r=this.site._view.hitTest(o.x,o.y),t=u(-1,this.site._cachedCount-1,r.insertAfterIndex),h=!0;if(this._lastInsertPoint&&this._lastInsertPoint.insertAfterIndex===t&&this._lastInsertPoint.index===r.index||(h=this._fireDragBetweenEvent(r.index,t,n.dataTransfer)),h&&(this._lastInsertPoint=null,this.site._layout.dragLeave(),this._fireDropEvent(r.index,t,n.dataTransfer)&&this._dragging&&this.site.itemsReorderable)){if(this._dragInfo.isEverything()||this.site._groupsEnabled())return;t=this._findFirstAvailableInsertPoint(this._dragInfo,t,!1);this._reorderItems(t,this._dragInfo,this._draggingUnselectedItem)}}this._clearDragProperties();n.preventDefault()},_checkAutoScroll:function(n,i){var h=this.site._getViewportLength(),c=this.site._horizontal(),o=c?n:i,a=this.site._viewport[c?"scrollWidth":"scrollHeight"],l=Math.floor(this.site.scrollPosition),f=0,u;o<s._AUTOSCROLL_THRESHOLD?f=o-s._AUTOSCROLL_THRESHOLD:o>h-s._AUTOSCROLL_THRESHOLD&&(f=o-(h-s._AUTOSCROLL_THRESHOLD));f=Math.round(f/s._AUTOSCROLL_THRESHOLD*(s._MAX_AUTOSCROLL_RATE-s._MIN_AUTOSCROLL_RATE));(l===0&&f<0||l>=a-h&&f>0)&&(f=0);f===0?this._autoScrollDelay&&(t.clearTimeout(this._autoScrollDelay),this._autoScrollDelay=0):this._autoScrollDelay||this._autoScrollFrame||(u=this,this._autoScrollDelay=t.setTimeout(function(){if(u._autoScrollRate){u._lastDragTimeout=r._now();var n=function(){var i,t,f;!u._autoScrollRate&&u._autoScrollFrame||u.site._disposed?u._stopAutoScroll():(i=r._now(),t=u._autoScrollRate*((i-u._lastDragTimeout)/1e3),t=t<0?Math.min(-1,t):Math.max(1,t),f={},f[u.site._scrollProperty]=u.site._viewportScrollPosition+t,e.setScrollPosition(u.site._viewport,f),u._lastDragTimeout=i,u._autoScrollFrame=r._requestAnimationFrame(n))};u._autoScrollFrame=r._requestAnimationFrame(n)}},s._AUTOSCROLL_DELAY));this._autoScrollRate=f},_stopAutoScroll:function(){this._autoScrollDelay&&(t.clearTimeout(this._autoScrollDelay),this._autoScrollDelay=0);this._autoScrollRate=0;this._autoScrollFrame=0},onKeyDown:function(t){function rt(t,u,e){function h(h){var l=!0,c=!1,v;return e?t.index=Math.max(0,Math.min(h,t.index)):(t.index<0||t.index>h)&&(c=!0),c||r.index===t.index&&r.type===t.type||(v=n(i._element,r,t),v&&(l=!1,a._setNewFocusItemOffsetPromise&&a._setNewFocusItemOffsetPromise.cancel(),i._batchViewUpdates(s._ViewChange.realize,s._ScrollToPriority.high,function(){return a._setNewFocusItemOffsetPromise=i._getItemOffset(r,!0).then(function(n){n=i._convertFromCanvasCoordinates(n);var e=n.end<=i.scrollPosition||n.begin>=i.scrollPosition+i._getViewportLength()-1;return a._setNewFocusItemOffsetPromise=i._getItemOffset(t).then(function(n){a._setNewFocusItemOffsetPromise=null;var o={position:i.scrollPosition,direction:"right"};return e&&(i._selection._setFocused(t,!0),n=i._convertFromCanvasCoordinates(n),t.index>r.index?(o.direction="right",o.position=n.end-i._getViewportLength()):(o.direction="left",o.position=n.begin)),i._changeFocus(t,u,d,e,!0),e?o:f.cancel},function(n){return i._changeFocus(t,u,d,!0,!0),f.wrapError(n)}),a._setNewFocusItemOffsetPromise},function(n){return i._changeFocus(t,u,d,!0,!0),f.wrapError(n)}),a._setNewFocusItemOffsetPromise},!0))),l&&(i._selection._setFocused(r,!0),i.ensureVisible(r)),c?{type:o.ObjectType.item,index:s._INVALID_INDEX}:t}return t.type===o.ObjectType.item?f.wrap(ct.lastItemIndex()).then(h):t.type===o.ObjectType.groupHeader?f.wrap(i._groups.length()-1).then(h):f.wrap(0).then(h)}var a=this,i=this.site,ct=i._view,r=i._selection._getFocused(),p=!0,d=t.ctrlKey,l=e.Key,h=t.keyCode,ut=i._rtl(),tt,u,y,it,b,nt,k,ht;if(!this._isInteractive(t.target)){if(t.ctrlKey&&!t.altKey&&!t.shiftKey&&this._keyboardAcceleratorHandlers[h]&&this._keyboardAcceleratorHandlers[h](),i.itemsReorderable&&!t.ctrlKey&&t.altKey&&t.shiftKey&&r.type===o.ObjectType.item&&(h===l.leftArrow||h===l.rightArrow||h===l.upArrow||h===l.downArrow)){var w=i._selection,v=r.index,ft=!1,et=!0;if(!w.isEverything()&&(w._isIncluded(v)||(tt=i._view.items.itemAt(v),tt&&e.hasClass(tt,s._nonDraggableClass)?et=!1:(ft=!0,w=new c._Selection(this.site,[{firstIndex:v,lastIndex:v}]))),et)){u=v;h===l.rightArrow?u+=ut?-1:1:h===l.leftArrow?u+=ut?1:-1:h===l.upArrow?u--:u++;y=u>v;it=y;y&&u>=this.site._cachedCount&&(it=!1,u=this.site._cachedCount-1);u=this._findFirstAvailableInsertPoint(w,u,it);u=Math.min(Math.max(-1,u),this.site._cachedCount-1);var g=u-(y||u===-1?0:1),ot=u,st=this.site._groupsEnabled();if(st&&(b=this.site._groups,nt=u>-1?b.groupFromItem(u):0,y?b.group(nt).startIndex===u&&g--:nt<b.length()-1&&u===b.group(nt+1).startIndex-1&&g++),this._fireDragBetweenEvent(ot,g,null)&&this._fireDropEvent(ot,g,null)){if(st)return;this._reorderItems(u,w,ft,!y,!0)}}}else t.altKey?p=!1:this._keyboardNavigationHandlers[h]?this._keyboardNavigationHandlers[h](r).then(function(n){if(n.index!==r.index||n.type!==r.type){var u=a._keyboardNavigationHandlers[h].clampToBounds;n.type!==o.ObjectType.groupHeader&&t.shiftKey&&i._selectionAllowed()&&i._multiSelection()?(i._selection._pivot===s._INVALID_INDEX&&(i._selection._pivot=r.index),rt(n,!0,u).then(function(n){if(n.index!==s._INVALID_INDEX){var r=Math.min(n.index,i._selection._pivot),u=Math.max(n.index,i._selection._pivot),f=t.ctrlKey||i._tap===o.TapBehavior.toggleSelect;a._selectRange(r,u,f)}})):(i._selection._pivot=s._INVALID_INDEX,rt(n,!1,u))}else p=!1}):t.ctrlKey||h!==l.enter?r.type!==o.ObjectType.groupHeader&&(t.ctrlKey&&h===l.enter||h===l.space)?(this._itemEventsHandler.toggleSelectionIfAllowed(r.index),i._changeFocus(r,!0,d,!1,!0)):h===l.escape&&i._selection.count()>0?(i._selection._pivot=s._INVALID_INDEX,i._selection.clear()):p=!1:(k=r.type===o.ObjectType.groupHeader?i._groups.group(r.index).header:i._view.items.itemBoxAt(r.index),k&&(r.type===o.ObjectType.groupHeader?(this._pressedHeader=k,this._pressedItemBox=null,this._pressedContainer=null):(this._pressedItemBox=k,this._pressedContainer=i._view.items.containerAt(r.index),this._pressedHeader=null),ht=this._verifySelectionAllowed(r),ht.canTapSelect&&this._itemEventsHandler.handleTap(r),this._fireInvokeEvent(r,k)));this._keyDownHandled=p;p&&(t.stopPropagation(),t.preventDefault())}h===l.tab&&(this.site._keyboardFocusInbound=!0)},onKeyUp:function(n){this._keyDownHandled&&(n.stopPropagation(),n.preventDefault())},onTabEntered:function(t){var r;if(this.site._groups.length()!==0||this.site._hasHeaderOrFooter){var i=this.site,u=i._selection._getFocused(),f=t.detail,e=!i._hasKeyboardFocus||t.target===i._viewport;e&&(this.inboundFocusHandled=!0,u.index=u.index===s._INVALID_INDEX?0:u.index,!f&&(this.site._supportsGroupHeaderKeyboarding||this.site._hasHeaderOrFooter)?(r={type:o.ObjectType.groupHeader},this.site._hasHeaderOrFooter?this.site._lastFocusedElementInGroupTrack.type===o.ObjectType.groupHeader&&this.site._supportsGroupHeaderKeyboarding?(r.index=i._groups.groupFromItem(u.index),n(i._element,u,r)?i._changeFocus(r,!0,!1,!1,!0):i._changeFocus(u,!0,!1,!1,!0)):(r.type=this.site._lastFocusedElementInGroupTrack.type,r.index=0,i._changeFocus(r,!0,!1,!1,!0)):u.type!==o.ObjectType.groupHeader&&this.site._supportsGroupHeaderKeyboarding?(r.index=i._groups.groupFromItem(u.index),n(i._element,u,r)?i._changeFocus(r,!0,!1,!1,!0):i._changeFocus(u,!0,!1,!1,!0)):(r.index=u.index,i._changeFocus(r,!0,!1,!1,!0)),t.preventDefault()):(r={type:o.ObjectType.item},u.type===o.ObjectType.groupHeader?(r.index=i._groupFocusCache.getIndexForGroup(u.index),n(i._element,u,r)?i._changeFocus(r,!0,!1,!1,!0):i._changeFocus(u,!0,!1,!1,!0)):(r.index=u.type!==o.ObjectType.item?i._groupFocusCache.getLastFocusedItemIndex():u.index,i._changeFocus(r,!0,!1,!1,!0)),t.preventDefault()))}},onTabExiting:function(t){var f,e,u;if(this.site._hasHeaderOrFooter||this.site._supportsGroupHeaderKeyboarding&&this.site._groups.length()!==0){var i=this.site,r=i._selection._getFocused(),s=t.detail;s?(u=null,r.type===o.ObjectType.item&&(f=this.site._lastFocusedElementInGroupTrack.type,u=f!==o.ObjectType.header&&f!==o.ObjectType.footer&&this.site._supportsGroupHeaderKeyboarding?{type:o.ObjectType.groupHeader,index:i._groups.groupFromItem(r.index)}:{type:f===o.ObjectType.item?o.ObjectType.header:f,index:0}),u&&n(i._element,r,u)&&(i._changeFocus(u,!0,!1,!1,!0),t.preventDefault())):s||r.type===o.ObjectType.item||(e=0,e=r.type===o.ObjectType.groupHeader?i._groupFocusCache.getIndexForGroup(r.index):r.type===o.ObjectType.header?0:i._view.lastItemIndex(),u={type:o.ObjectType.item,index:e},n(i._element,r,u)&&(i._changeFocus(u,!0,!1,!1,!0),t.preventDefault()))}}})})})}),t("WinJS/Controls/ListView/_ErrorMessages",["exports","../../Core/_Base","../../Core/_Resources"],function(n,t){"use strict";t.Namespace._moduleDefine(n,null,{modeIsInvalid:{get:function(){return"Invalid argument: mode must be one of following values: 'none', 'single' or 'multi'."}},loadingBehaviorIsDeprecated:{get:function(){return"Invalid configuration: loadingBehavior is deprecated. The control will default this property to 'randomAccess'. Please refer to the 'ListView loading behaviors' SDK Sample for guidance on how to implement incremental load behavior."}},pagesToLoadIsDeprecated:{get:function(){return"Invalid configuration: pagesToLoad is deprecated. The control will not use this property. Please refer to the 'ListView loading behaviors' SDK Sample for guidance on how to implement incremental load behavior."}},pagesToLoadThresholdIsDeprecated:{get:function(){return"Invalid configuration: pagesToLoadThreshold is deprecated.  The control will not use this property. Please refer to the 'ListView loading behaviors' SDK Sample for guidance on how to implement incremental load behavior."}},automaticallyLoadPagesIsDeprecated:{get:function(){return"Invalid configuration: automaticallyLoadPages is deprecated. The control will default this property to false. Please refer to the 'ListView loading behaviors' SDK Sample for guidance on how to implement incremental load behavior."}},invalidTemplate:{get:function(){return"Invalid template: Templates must be created before being passed to the ListView, and must contain a valid tree of elements."}},loadMorePagesIsDeprecated:{get:function(){return"loadMorePages is deprecated. Invoking this function will not have any effect. Please refer to the 'ListView loading behaviors' SDK Sample for guidance on how to implement incremental load behavior."}},disableBackdropIsDeprecated:{get:function(){return"Invalid configuration: disableBackdrop is deprecated. Style: .win-listview .win-container.win-backdrop { background-color:transparent; } instead."}},backdropColorIsDeprecated:{get:function(){return"Invalid configuration: backdropColor is deprecated. Style: .win-listview .win-container.win-backdrop { rgba(155,155,155,0.23); } instead."}},itemInfoIsDeprecated:{get:function(){return"GridLayout.itemInfo may be altered or unavailable in future versions. Instead, use CellSpanningLayout."}},groupInfoIsDeprecated:{get:function(){return"GridLayout.groupInfo may be altered or unavailable in future versions. Instead, use CellSpanningLayout."}},resetItemIsDeprecated:{get:function(){return"resetItem may be altered or unavailable in future versions. Instead, mark the element as disposable using WinJS.Utilities.markDisposable."}},resetGroupHeaderIsDeprecated:{get:function(){return"resetGroupHeader may be altered or unavailable in future versions. Instead, mark the header element as disposable using WinJS.Utilities.markDisposable."}},maxRowsIsDeprecated:{get:function(){return"GridLayout.maxRows may be altered or unavailable in future versions. Instead, use the maximumRowsOrColumns property."}},swipeOrientationDeprecated:{get:function(){return"Invalid configuration: swipeOrientation is deprecated. The control will default this property to 'none'"}},swipeBehaviorDeprecated:{get:function(){return"Invalid configuration: swipeBehavior is deprecated. The control will default this property to 'none'"}}})}),t("WinJS/Controls/ListView/_GroupFocusCache",["exports","../../Core/_Base"],function(n,t){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_GroupFocusCache:t.Namespace._lazy(function(){return t.Class.define(function(n){this._listView=n;this.clear()},{updateCache:function(n,t,i){this._lastFocusedItemKey=t;this._lastFocusedItemIndex=i;i=""+i;this._itemToIndex[t]=i;this._groupToItem[n]=t},deleteItem:function(n){var i,r,t,f,u;if(n===this._lastFocusedItemKey&&(this._lastFocusedItemKey=null,this._lastFocusedItemIndex=0),this._itemToIndex[n])for(i=this,r=Object.keys(this._groupToItem),t=0,f=r.length;t<f;t++)if(u=r[t],i._groupToItem[u]===n){i.deleteGroup(u);break}},deleteGroup:function(n){var t=this._groupToItem[n];t&&delete this._itemToIndex[t];delete this._groupToItem[n]},updateItemIndex:function(n,t){(n===this._lastFocusedItemKey&&(this._lastFocusedItemIndex=t),this._itemToIndex[n])&&(this._itemToIndex[n]=""+t)},getIndexForGroup:function(n){var i=this._listView._groups.group(n).key,t=this._groupToItem[i];return t&&this._itemToIndex[t]?+this._itemToIndex[t]:this._listView._groups.fromKey(i).group.startIndex},clear:function(){this._groupToItem={};this._itemToIndex={};this._lastFocusedItemIndex=0;this._lastFocusedItemKey=null},getLastFocusedItemIndex:function(){return this._lastFocusedItemIndex}})}),_UnsupportedGroupFocusCache:t.Namespace._lazy(function(){return t.Class.define(null,{updateCache:function(n,t,i){this._lastFocusedItemKey=t;this._lastFocusedItemIndex=i},deleteItem:function(n){n===this._lastFocusedItemKey&&(this._lastFocusedItemKey=null,this._lastFocusedItemIndex=0)},deleteGroup:function(){},updateItemIndex:function(n,t){n===this._lastFocusedItemKey&&(this._lastFocusedItemIndex=t)},getIndexForGroup:function(){return 0},clear:function(){this._lastFocusedItemIndex=0;this._lastFocusedItemKey=null},getLastFocusedItemIndex:function(){return this._lastFocusedItemIndex}})})})}),t("WinJS/Controls/ListView/_GroupsContainer",["exports","../../Core/_Base","../../Promise","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Utilities/_ItemsManager","../../Utilities/_UI","../ItemContainer/_Constants"],function(n,t,i,r,u,f,e,o){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_GroupsContainerBase:t.Namespace._lazy(function(){return t.Class.define(function(){},{index:function(n){var i=this.headerFrom(n),t,r;if(i)for(t=0,r=this.groups.length;t<r;t++)if(i===this.groups[t].header)return t;return o._INVALID_INDEX},headerFrom:function(n){while(n&&!u.hasClass(n,o._headerClass))n=n.parentNode;return n},requestHeader:function(n){this._waitingHeaderRequests=this._waitingHeaderRequests||{};this._waitingHeaderRequests[n]||(this._waitingHeaderRequests[n]=[]);var t=this;return new i(function(i){var r=t.groups[n];r&&r.header?i(r.header):t._waitingHeaderRequests[n].push(i)})},notify:function(n,t){var r,i,u;if(this._waitingHeaderRequests&&this._waitingHeaderRequests[n]){for(r=this._waitingHeaderRequests[n],i=0,u=r.length;i<u;i++)r[i](t);this._waitingHeaderRequests[n]=[]}},groupFromImpl:function(n,t,i){if(t<n)return null;var r=n+Math.floor((t-n)/2),u=this.groups[r];return i(u,r)?this.groupFromImpl(n,r-1,i):r<t&&!i(this.groups[r+1],r+1)?this.groupFromImpl(r+1,t,i):r},groupFrom:function(n){if(this.groups.length>0){var t=this.groups.length-1,i=this.groups[t];return n(i,t)?this.groupFromImpl(0,this.groups.length-1,n):t}return null},groupFromItem:function(n){return this.groupFrom(function(t){return n<t.startIndex})},groupFromOffset:function(n){return this.groupFrom(function(t){return n<t.offset})},group:function(n){return this.groups[n]},length:function(){return this.groups.length},cleanUp:function(){var n,i,t;if(this.listBinding){for(n=0,i=this.groups.length;n<i;n++)t=this.groups[n],t.userData&&this.listBinding.releaseItem(t.userData);this.listBinding.release()}},_dispose:function(){this.cleanUp()},synchronizeGroups:function(){var n=this;return this.pendingChanges=[],this.ignoreChanges=!0,this.groupDataSource.invalidateAll().then(function(){return i.join(n.pendingChanges)}).then(function(){if(n._listView._ifZombieDispose())return i.cancel}).then(function(){n.ignoreChanges=!1},function(t){return n.ignoreChanges=!1,i.wrapError(t)})},fromKey:function(n){for(var i,t=0,r=this.groups.length;t<r;t++)if(i=this.groups[t],i.key===n)return{group:i,index:t};return null},fromHandle:function(n){for(var i,t=0,r=this.groups.length;t<r;t++)if(i=this.groups[t],i.handle===n)return{group:i,index:t};return null}})}),_UnvirtualizedGroupsContainer:t.Namespace._lazy(function(){return t.Class.derive(n._GroupsContainerBase,function(n,t){this._listView=n;this.groupDataSource=t;this.groups=[];this.pendingChanges=[];this.dirty=!0;var i=this,f={beginNotifications:function(){i._listView._versionManager.beginNotifications()},endNotifications:function(){(i._listView._versionManager.endNotifications(),i._listView._ifZombieDispose())||!i.ignoreChanges&&i._listView._groupsChanged&&i._listView._scheduleUpdate()},indexChanged:function(){(i._listView._versionManager.receivedNotification(),i._listView._ifZombieDispose())||this.scheduleUpdate()},itemAvailable:function(){},countChanged:function(n){(i._listView._versionManager.receivedNotification(),i._listView._writeProfilerMark("groupCountChanged("+n+"),info"),i._listView._ifZombieDispose())||this.scheduleUpdate()},changed:function(n){if(i._listView._versionManager.receivedNotification(),!i._listView._ifZombieDispose()){var t=i.fromKey(n.key);t&&(i._listView._writeProfilerMark("groupChanged("+t.index+"),info"),t.group.userData=n,t.group.startIndex=n.firstItemIndexHint,this.markToRemove(t.group));this.scheduleUpdate()}},removed:function(n){var t,r;(i._listView._versionManager.receivedNotification(),i._listView._groupRemoved(n),i._listView._ifZombieDispose())||(t=i.fromHandle(n),t&&(i._listView._writeProfilerMark("groupRemoved("+t.index+"),info"),i.groups.splice(t.index,1),r=i.groups.indexOf(t.group,t.index),r>-1&&i.groups.splice(r,1),this.markToRemove(t.group)),this.scheduleUpdate())},inserted:function(n,t,r){if(i._listView._versionManager.receivedNotification(),!i._listView._ifZombieDispose()){i._listView._writeProfilerMark("groupInserted,info");var u=this;n.retain().then(function(f){var e,o;e=t||r||i.groups.length?u.findIndex(t,r):0;e!==-1&&(o={key:f.key,startIndex:f.firstItemIndexHint,userData:f,handle:n.handle},i.groups.splice(e,0,o));u.scheduleUpdate()});i.pendingChanges.push(n)}},moved:function(n,t,r){if(i._listView._versionManager.receivedNotification(),!i._listView._ifZombieDispose()){i._listView._writeProfilerMark("groupMoved,info");var u=this;n.then(function(f){var o=u.findIndex(t,r),e=i.fromKey(f.key),s;e?(i.groups.splice(e.index,1),o!==-1&&(e.index<o&&o--,e.group.key=f.key,e.group.userData=f,e.group.startIndex=f.firstItemIndexHint,i.groups.splice(o,0,e.group))):o!==-1&&(s={key:f.key,startIndex:f.firstItemIndexHint,userData:f,handle:n.handle},i.groups.splice(o,0,s),n.retain());u.scheduleUpdate()});i.pendingChanges.push(n)}},reload:function(){(i._listView._versionManager.receivedNotification(),i._listView._ifZombieDispose())||i._listView._processReload()},markToRemove:function(n){if(n.header){var t=n.header;n.header=null;n.left=-1;n.width=-1;n.decorator=null;n.tabIndex=-1;t.tabIndex=-1;i._listView._groupsToRemove[u._uniqueID(t)]={group:n,header:t}}},scheduleUpdate:function(){i.dirty=!0;i.ignoreChanges||(i._listView._groupsChanged=!0)},findIndex:function(n,t){var u=-1,r;return n&&(r=i.fromHandle(n),r&&(u=r.index+1)),u===-1&&t&&(r=i.fromHandle(t),r&&(u=r.index)),u},removeElements:function(n){if(n.header){var t=n.header.parentNode;t&&(r.disposeSubTree(n.header),t.removeChild(n.header));n.header=null;n.left=-1;n.width=-1}}};this.listBinding=this.groupDataSource.createListBinding(f)},{initialize:function(){this.initializePromise&&this.initializePromise.cancel();this._listView._writeProfilerMark("GroupsContainer_initialize,StartTM");var n=this;return this.initializePromise=this.groupDataSource.getCount().then(function(t){for(var u=[],r=0;r<t;r++)u.push(n.listBinding.fromIndex(r).retain());return i.join(u)}).then(function(t){var r,u,i;for(n.groups=[],r=0,u=t.length;r<u;r++)i=t[r],n.groups.push({key:i.key,startIndex:i.firstItemIndexHint,handle:i.handle,userData:i});n._listView._writeProfilerMark("GroupsContainer_initialize groups("+t.length+"),info");n._listView._writeProfilerMark("GroupsContainer_initialize,StopTM")},function(t){return n._listView._writeProfilerMark("GroupsContainer_initialize,StopTM"),i.wrapError(t)}),this.initializePromise},renderGroup:function(n){if(this._listView.groupHeaderTemplate){var t=this.groups[n];return i.wrap(this._listView._groupHeaderRenderer(i.wrap(t.userData))).then(f._normalizeRendererReturn)}return i.wrap(null)},setDomElement:function(n,t){this.groups[n].header=t;this.notify(n,t)},removeElements:function(){for(var f,o=this._listView._groupsToRemove||{},s=Object.keys(o),t=!1,i=this._listView._selection._getFocused(),u=0,c=s.length;u<c;u++){var h=o[s[u]],n=h.header,l=h.group;t||i.type!==e.ObjectType.groupHeader||l.userData.index!==i.index||(this._listView._unsetFocusOnItem(),t=!0);n&&(f=n.parentNode,f&&(r._disposeElement(n),f.removeChild(n)))}t&&this._listView._setFocusOnItem(i);this._listView._groupsToRemove={}},resetGroups:function(){for(var t,i=this.groups.slice(0),n=0,r=i.length;n<r;n++)t=i[n],this.listBinding&&t.userData&&this.listBinding.releaseItem(t.userData);this.groups.length=0;this.dirty=!0}})}),_NoGroups:t.Namespace._lazy(function(){return t.Class.derive(n._GroupsContainerBase,function(n){this._listView=n;this.groups=[{startIndex:0}];this.dirty=!0},{synchronizeGroups:function(){return i.wrap()},addItem:function(){return i.wrap(this.groups[0])},resetGroups:function(){this.groups=[{startIndex:0}];delete this.pinnedItem;delete this.pinnedOffset;this.dirty=!0},renderGroup:function(){return i.wrap(null)},ensureFirstGroup:function(){return i.wrap(this.groups[0])},groupOf:function(){return i.wrap(this.groups[0])},removeElements:function(){}})})})}),t("WinJS/Controls/ListView/_Helpers",["exports","../../Core/_Base","../ItemContainer/_Constants"],function(n,t,i){"use strict";function u(n){return Array.prototype.slice.call(n)}function r(n,t){if(typeof n=="string")return r([n],t);var i=new Array(Math.floor(t/n.length)+1).join(n.join(""));return i+n.slice(0,t%n.length).join("")}function f(n,t){var u=i._containerEvenClass,f=i._containerOddClass,e=t%2==0?[u,f]:[f,u],o=["<div class='win-container "+e[0]+" win-backdrop'><\/div>","<div class='win-container "+e[1]+" win-backdrop'><\/div>"];return r(o,n)}t.Namespace._moduleDefine(n,"WinJS.UI",{_nodeListToArray:u,_repeat:r,_stripedContainers:f})}),t("WinJS/Controls/ListView/_ItemsContainer",["exports","../../Core/_Base","../../Promise","../../Utilities/_ElementUtilities","../ItemContainer/_Constants"],function(n,t,i,r,u){"use strict";t.Namespace._moduleDefine(n,"WinJS.UI",{_ItemsContainer:t.Namespace._lazy(function(){var n=function(n){this.site=n;this._itemData={};this.waitingItemRequests={}};return n.prototype={requestItem:function(n){this.waitingItemRequests[n]||(this.waitingItemRequests[n]=[]);var t=this;return new i(function(i){var r=t._itemData[n];r&&!r.detached&&r.element?i(r.element):t.waitingItemRequests[n].push(i)})},removeItem:function(n){delete this._itemData[n]},removeItems:function(){this._itemData={};this.waitingItemRequests={}},setItemAt:function(n,t){this._itemData[n]=t;t.detached||this.notify(n,t)},notify:function(n,t){var r,i;if(this.waitingItemRequests[n]){for(r=this.waitingItemRequests[n],i=0;i<r.length;i++)r[i](t.element);this.waitingItemRequests[n]=[]}},elementAvailable:function(n){var t=this._itemData[n];t.detached=!1;this.notify(n,t)},itemAt:function(n){var t=this._itemData[n];return t?t.element:null},itemDataAt:function(n){return this._itemData[n]},containerAt:function(n){var t=this._itemData[n];return t?t.container:null},itemBoxAt:function(n){var t=this._itemData[n];return t?t.itemBox:null},itemBoxFrom:function(n){while(n&&!r.hasClass(n,u._itemBoxClass))n=n.parentNode;return n},containerFrom:function(n){while(n&&!r.hasClass(n,u._containerClass))n=n.parentNode;return n},index:function(n){var i=this.containerFrom(n),t;if(i)for(t in this._itemData)if(this._itemData[t].container===i)return parseInt(t,10);return u._INVALID_INDEX},each:function(n){var t,i;for(t in this._itemData)this._itemData.hasOwnProperty(t)&&(i=this._itemData[t],n(parseInt(t,10),i.element,i))},eachIndex:function(n){for(var t in this._itemData)if(n(parseInt(t,10)))break},count:function(){return Object.keys(this._itemData).length}},n})})}),t("WinJS/Controls/ListView/_Layouts",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Resources","../../Core/_WriteProfilerMark","../../Animations/_TransitionAnimation","../../Promise","../../Scheduler","../../_Signal","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Utilities/_SafeHtml","../../Utilities/_UI","../ItemContainer/_Constants","./_ErrorMessages"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function wt(n){return"_win-dynamic-"+n+"-"+gt++}function ii(){for(var i=ht.sheet.cssRules,u=ft.length,n,r,t=0;t<u;t++)for(r="."+ft[t]+" ",n=i.length-1;n>=0;n--)i[n].selectorText.indexOf(r)!==-1&&ht.sheet.deleteRule(n);ft=[]}function kt(n,t,i,r){ii();var f="."+p._listViewClass+" ."+n+" "+i+" { "+r+"}",u="_addDynamicCssRule:"+n+",info";t?t._writeProfilerMark(u):e("WinJS.UI.ListView:Layout"+u);ht.sheet.insertRule(f,0)}function et(n){ft.push(n)}function it(n,t,i){return Math.max(n,Math.min(t,i))}function rt(n,i){return a.convertToPixels(n,t.getComputedStyle(n,null)[i])}function ut(n,t){return rt(t,"margin"+n)+rt(t,"border"+n+"Width")+rt(t,"padding"+n)}function ot(n){return ut("Top",n)+ut("Bottom",n)}function st(n){return ut("Left",n)+ut("Right",n)}function lt(n,t){var u,e,f,i,r;if(n.items)for(i=0,r=n.items.length;i<r;i++)t(n.items[i],i);else for(u=0,e=0;u<n.itemsBlocks.length;u++)for(f=n.itemsBlocks[u],i=0,r=f.items.length;i<r;i++)t(f.items[i],e++)}function ni(n,t){if(t<0)return null;if(n.items)return t<n.items.length?n.items[t]:null;var r=n.itemsBlocks[0].items.length,i=Math.floor(t/r),u=t%r;return i<n.itemsBlocks.length&&u<n.itemsBlocks[i].items.length?n.itemsBlocks[i].items[u]:null}function ri(n,t){for(var r,i=0,u=t.length;i<u;i++)if(t[i].itemsContainer.element===n){r=t[i].itemsContainer;break}return r}function at(n){var t,i;return n.itemsBlocks?(t=n.itemsBlocks.length,i=t>0?n.itemsBlocks[0].items.length*(t-1)+n.itemsBlocks[t-1].items.length:0):i=n.items.length,i}function ui(n){var i,r,f,u;return vt||(i=t.document.createElement("div"),i.style.width="500px",i.style.visibility="hidden",r=t.document.createElement("div"),r.style.cssText+="width: 500px; height: 200px; display: -webkit-flex; display: flex",v.setInnerHTMLUnsafe(r,"<div style='height: 100%; display: -webkit-flex; display: flex; flex-flow: column wrap; align-content: flex-start; -webkit-flex-flow: column wrap; -webkit-align-content: flex-start'><div style='width: 100px; height: 100px'><\/div><div style='width: 100px; height: 100px'><\/div><div style='width: 100px; height: 100px'><\/div><\/div>"),i.appendChild(r),n.viewport.insertBefore(i,n.viewport.firstChild),f=i.offsetWidth>0,u=200,f&&(vt={supportsCSSGrid:!!("-ms-grid-row"in t.document.documentElement.style),nestedFlexTooLarge:r.firstElementChild.offsetWidth>u,nestedFlexTooSmall:r.firstElementChild.offsetWidth<u}),n.readyToMeasure(),n.viewport.removeChild(i)),vt}function dt(n){return s.is(n)?{realizedRangeComplete:n,layoutComplete:n}:typeof n=="object"&&n&&n.layoutComplete?n:{realizedRangeComplete:s.wrap(),layoutComplete:s.wrap()}}function yt(n){return{left:rt(n,"marginLeft"),right:rt(n,"marginRight"),top:rt(n,"marginTop"),bottom:rt(n,"marginBottom")}}var b=a.Key,nt=a._uniqueID,pt={get itemInfoIsInvalid(){return"Invalid argument: An itemInfo function must be provided which returns an object with numeric width and height properties."},get groupInfoResultIsInvalid(){return"Invalid result: groupInfo result for cell spanning groups must include the following numeric properties: cellWidth and cellHeight."}},ht=t.document.createElement("style"),gt,ft,vt,g,k;t.document.head.appendChild(ht);gt=0;ft=[];var ti=r._browserStyleEquivalents,d=ti.transform,tt=r._browserStyleEquivalents.transition.scriptName,ct=d.cssName+" cubic-bezier(0.1, 0.9, 0.2, 1) 167ms",bt=12;vt=null;i.Namespace._moduleDefine(n,"WinJS.UI",{Layout:i.Class.define(function(){}),_LayoutCommon:i.Namespace._lazy(function(){return i.Class.derive(n.Layout,null,{groupHeaderPosition:{enumerable:!0,get:function(){return this._groupHeaderPosition},set:function(n){this._groupHeaderPosition=n;this._invalidateLayout()}},initialize:function(n,t){n._writeProfilerMark("Layout:initialize,info");this._inListMode||a.addClass(n.surface,p._gridLayoutClass);this._backdropColorClassName&&a.addClass(n.surface,this._backdropColorClassName);this._disableBackdropClassName&&a.addClass(n.surface,this._disableBackdropClassName);this._groups=[];this._groupMap={};this._oldGroupHeaderPosition=null;this._usingStructuralNodes=!1;this._site=n;this._groupsEnabled=t;this._resetAnimationCaches(!0)},orientation:{enumerable:!0,get:function(){return this._orientation},set:function(n){this._orientation=n;this._horizontal=n==="horizontal";this._invalidateLayout()}},uninitialize:function(){function t(n){for(var i=n.length,t=0;t<i;t++)n[t].cleanUp(!0)}var n="Layout:uninitialize,info";this._elementsToMeasure={};this._site?(this._site._writeProfilerMark(n),a.removeClass(this._site.surface,p._gridLayoutClass),a.removeClass(this._site.surface,p._headerPositionTopClass),a.removeClass(this._site.surface,p._headerPositionLeftClass),a.removeClass(this._site.surface,p._structuralNodesClass),a.removeClass(this._site.surface,p._singleItemsBlockClass),this._site.surface.style.cssText="",this._groups&&(t(this._groups),this._groups=null,this._groupMap=null),this._layoutPromise&&(this._layoutPromise.cancel(),this._layoutPromise=null),this._resetMeasurements(),this._oldGroupHeaderPosition=null,this._usingStructuralNodes=null,this._backdropColorClassName&&(a.removeClass(this._site.surface,this._backdropColorClassName),et(this._backdropColorClassName),this._backdropColorClassName=null),this._disableBackdropClassName&&(a.removeClass(this._site.surface,this._disableBackdropClassName),et(this._disableBackdropClassName),this._disableBackdropClassName=null),this._site=null,this._groupsEnabled=null,this._animationsRunning&&this._animationsRunning.cancel(),this._animatingItemsBlocks={}):e("WinJS.UI.ListView:"+n)},numberOfItemsPerItemsBlock:{get:function(){function i(){for(var i=t._site.groupCount,n=0;n<i;n++)if(t._isCellSpanning(n))return!1;return!0}var t=this;return t._measureItem(0).then(function(){return t._sizes.viewportContentSize!==t._getViewportCrossSize()&&t._viewportSizeChanged(t._getViewportCrossSize()),i()?t._envInfo.nestedFlexTooLarge||t._envInfo.nestedFlexTooSmall?(t._usingStructuralNodes=!0,Number.MAX_VALUE):(t._usingStructuralNodes=n._LayoutCommon._barsPerItemsBlock>0,n._LayoutCommon._barsPerItemsBlock*t._itemsPerBar):(t._usingStructuralNodes=!1,null)})}},layout:function(n,t,i,r){function l(n){function t(n){if(u._usingStructuralNodes){var t=[];return n.itemsBlocks.forEach(function(n){t=t.concat(n.items.slice(0))}),t}return n.items.slice(0)}return{element:n.element,items:t(n)}}function v(){function d(n,t){var i=n.enableCellSpanning?g.CellSpanningGroup:g.UniformGroup;return new i(u,t)}for(var nt=u._groups.length>0?u._getRealizationRange():null,o=[],p=[],w={},b={},c=0,tt=n.length,y,e,r,k,i=0;i<tt;i++){var a=null,h=u._getGroupInfo(i),v=u._site.groupFromIndex(i).key,f=u._groupMap[v],it=f instanceof g.CellSpanningGroup,rt=h.enableCellSpanning;f&&(it!==rt?w[v]=!0:(y=Math.max(0,t.firstIndex-f.startIndex),e=u._rangeForGroup(f,nt),e&&y<=e.lastIndex&&(a={firstIndex:Math.max(y,e.firstIndex),lastIndex:e.lastIndex})));r=d(h,n[i].itemsContainer.element);k=r.prepareLayoutWithCopyOfTree?r.prepareLayoutWithCopyOfTree(l(n[i].itemsContainer),a,f,{groupInfo:h,startIndex:c}):r.prepareLayout(at(n[i].itemsContainer),a,f,{groupInfo:h,startIndex:c});p.push(k);c+=r.count;o.push(r);b[v]=r}return s.join(p).then(function(){for(var t,i=0,n=0,r=o.length;n<r;n++)t=o[n],t.offset=i,i+=u._getGroupSize(t);Object.keys(u._groupMap).forEach(function(n){var t=!w[n];u._groupMap[n].cleanUp(t)});u._groups=o;u._groupMap=b})}function c(n,i,r){var f=u._groups[n],o=Math.max(0,t.firstIndex-f.startIndex),e=u._rangeForGroup(f,i),s;if(r)f.layoutRealizedRange(o,e);else return e||(s=f.startIndex+f.count-1<i.firstIndex),f.layoutUnrealizedRange(o,e,s)}function y(){if(u._groups.length!==0)for(var r=u._getRealizationRange(),e=n.length,o=f.groupIndexFromItemIndex(t.firstIndex),i=o;i<e;i++)c(i,r,!0),u._layoutGroup(i)}function w(){if(u._groups.length===0)return s.wrap();for(var i=u._getRealizationRange(),l=f.groupIndexFromItemIndex(i.firstIndex-1),a=f.groupIndexFromItemIndex(i.lastIndex+1),h=f.groupIndexFromItemIndex(t.firstIndex),o=[],v=u._groups.length,r=!1,e=l,n=Math.max(h,a),n=Math.max(e+1,n);!r;)r=!0,e>=h&&(o.push(c(e,i,!1)),r=!1,e--),n<v&&(o.push(c(n,i,!1)),r=!1,n++);return s.join(o)}var u=this,f=u._site,e="Layout.layout",o=e+":realizedRange",h;return u._site._writeProfilerMark(e+",StartTM"),u._site._writeProfilerMark(o+",StartTM"),h=u._measureItem(0).then(function(){return a[u._usingStructuralNodes?"addClass":"removeClass"](u._site.surface,p._structuralNodesClass),a[u._envInfo.nestedFlexTooLarge||u._envInfo.nestedFlexTooSmall?"addClass":"removeClass"](u._site.surface,p._singleItemsBlockClass),u._sizes.viewportContentSize!==u._getViewportCrossSize()&&u._viewportSizeChanged(u._getViewportCrossSize()),u._cacheRemovedElements(i,u._cachedItemRecords,u._cachedInsertedItemRecords,u._cachedRemovedItems,!1),u._cacheRemovedElements(r,u._cachedHeaderRecords,u._cachedInsertedHeaderRecords,u._cachedRemovedHeaders,!0),v()}).then(function(){var t,e;u._syncDomWithGroupHeaderPosition(n);t=0;u._groups.length>0&&(e=u._groups[u._groups.length-1],t=e.offset+u._getGroupSize(e));u._horizontal?(u._groupsEnabled&&u._groupHeaderPosition===k.left?f.surface.style.cssText+=";height:"+u._sizes.surfaceContentSize+"px;-ms-grid-columns: ("+u._sizes.headerContainerWidth+"px auto)["+n.length+"]":f.surface.style.height=u._sizes.surfaceContentSize+"px",(u._envInfo.nestedFlexTooLarge||u._envInfo.nestedFlexTooSmall)&&(f.surface.style.width=t+"px")):(u._groupsEnabled&&u._groupHeaderPosition===k.top?f.surface.style.cssText+=";width:"+u._sizes.surfaceContentSize+"px;-ms-grid-rows: ("+u._sizes.headerContainerHeight+"px auto)["+n.length+"]":f.surface.style.width=u._sizes.surfaceContentSize+"px",(u._envInfo.nestedFlexTooLarge||u._envInfo.nestedFlexTooSmall)&&(f.surface.style.height=t+"px"));y();u._layoutAnimations(i,r);u._site._writeProfilerMark(o+":complete,info");u._site._writeProfilerMark(o+",StopTM")},function(n){return u._site._writeProfilerMark(o+":canceled,info"),u._site._writeProfilerMark(o+",StopTM"),s.wrapError(n)}),u._layoutPromise=h.then(function(){return w().then(function(){u._site._writeProfilerMark(e+":complete,info");u._site._writeProfilerMark(e+",StopTM")},function(n){return u._site._writeProfilerMark(e+":canceled,info"),u._site._writeProfilerMark(e+",StopTM"),s.wrapError(n)})}),{realizedRangeComplete:h,layoutComplete:u._layoutPromise}},itemsFromRange:function(n,t){return this._rangeContainsItems(n,t)?{firstIndex:this._firstItemFromRange(n),lastIndex:this._lastItemFromRange(t)}:{firstIndex:0,lastIndex:-1}},getAdjacent:function(t,i){function h(){var s={type:t.type,index:t.index-f.startIndex},h=f.getAdjacent(s,e),n,c;if(h==="boundary"){var i=r._groups[o-1],u=r._groups[o+1],l=r._groups.length-1;if(e===b.leftArrow){if(o===0)return t;if(i instanceof g.UniformGroup&&f instanceof g.UniformGroup){var n=r._indexToCoordinate(s.index),c=r._horizontal?n.row:n.column,a=Math.floor((i.count-1)/r._itemsPerBar),v=a*r._itemsPerBar;return{type:y.ObjectType.item,index:i.startIndex+Math.min(i.count-1,v+c)}}return{type:y.ObjectType.item,index:f.startIndex-1}}return e===b.rightArrow?o===l?t:f instanceof g.UniformGroup&&u instanceof g.UniformGroup?(n=r._indexToCoordinate(s.index),c=r._horizontal?n.row:n.column,{type:y.ObjectType.item,index:u.startIndex+Math.min(u.count-1,c)}):{type:y.ObjectType.item,index:u.startIndex}:t}return h.index+=f.startIndex,h}var r=this,o=r._site.groupIndexFromItemIndex(t.index),f=r._groups[o],e=r._adjustedKeyForOrientationAndBars(r._adjustedKeyForRTL(i),f instanceof g.CellSpanningGroup),s,u;if(t.type||(t.type=y.ObjectType.item),t.type!==y.ObjectType.item&&(i===b.pageUp||i===b.pageDown))s=0,s=t.type===y.ObjectType.groupHeader?r._groups[t.index].startIndex:t.type===y.ObjectType.header?0:r._groups[r._groups.length-1].count-1,t={type:y.ObjectType.item,index:s};else{if(t.type===y.ObjectType.header&&e===b.rightArrow)return{type:r._groupsEnabled?y.ObjectType.groupHeader:y.ObjectType.footer,index:0};if(t.type===y.ObjectType.footer&&e===b.leftArrow)return{type:r._groupsEnabled?y.ObjectType.groupHeader:y.ObjectType.header,index:0};if(t.type===y.ObjectType.groupHeader)return e===b.leftArrow?(u=t.index-1,u=r._site.header?u:Math.max(0,u),{type:u>-1?y.ObjectType.groupHeader:y.ObjectType.header,index:u>-1?u:0}):e===b.rightArrow?(u=t.index+1,u=r._site.header?u:Math.min(r._groups.length-1,t.index+1),{type:u>=r._groups.length?y.ObjectType.header:y.ObjectType.groupHeader,index:u>=r._groups.length?0:u}):t}switch(r._adjustedKeyForRTL(i)){case b.upArrow:case b.leftArrow:case b.downArrow:case b.rightArrow:return h();default:return n._LayoutCommon.prototype._getAdjacentForPageKeys.call(r,t,i)}},hitTest:function(n,t){var r=this._sizes,u,f,i;return n-=r.layoutOriginX,t-=r.layoutOriginY,f=this._groupFromOffset(this._horizontal?n:t),i=this._groups[f],this._horizontal?n-=i.offset:t-=i.offset,this._groupsEnabled&&(this._groupHeaderPosition===k.left?n-=r.headerContainerWidth:t-=r.headerContainerHeight),u=i.hitTest(n,t),u.index+=i.startIndex,u.insertAfterIndex+=i.startIndex,u},setupAnimations:function(){var n,c,e,r;if(this._groups.length===0){this._resetAnimationCaches();return}if(!Object.keys(this._cachedItemRecords).length){this._site._writeProfilerMark("Animation:setupAnimations,StartTM");var s=this._getRealizationRange(),h=this._site.tree,t=0,u=this.orientation==="horizontal";for(n=0,c=h.length;n<c;n++){var i=h[n],l=!1,o=this._groups[n],a=o instanceof g.CellSpanningGroup,f=o?o.offset:0;lt(i.itemsContainer,function(i,r){if(s.firstIndex<=t&&s.lastIndex>=t&&(l=!0,!this._cachedItemRecords[t])){var u=this._getItemPositionForAnimations(t,n,r),f=u.row,e=u.column,o=u.left,h=u.top;this._cachedItemRecords[t]={oldRow:f,oldColumn:e,oldLeft:o,oldTop:h,width:u.width,height:u.height,element:i,inCellSpanningGroup:a}}t++}.bind(this));l&&(e=n,this._cachedHeaderRecords[e]||(r=this._getHeaderPositionForAnimations(e),this._cachedHeaderRecords[e]={oldLeft:r.left,oldTop:r.top,width:r.width,height:r.height,element:i.header}),this._cachedGroupRecords[nt(i.itemsContainer.element)]||(this._cachedGroupRecords[nt(i.itemsContainer.element)]={oldLeft:u?f:0,left:u?f:0,oldTop:u?0:f,top:u?0:f,element:i.itemsContainer.element}))}this._site._writeProfilerMark("Animation:setupAnimations,StopTM")}},_layoutAnimations:function(n,t){var u,et,b,i,f,o,k,it,l,st,ht,rt,v,ct;if(Object.keys(this._cachedItemRecords).length||Object.keys(this._cachedGroupRecords).length||Object.keys(this._cachedHeaderRecords).length){this._site._writeProfilerMark("Animation:layoutAnimation,StartTM");this._updateAnimationCache(n,t);var ut=this._getRealizationRange(),ft=this._site.tree,e=0,y=this.orientation==="horizontal";for(u=0,et=ft.length;u<et;u++){var ot=ft[u],w=this._groups[u],at=w instanceof g.CellSpanningGroup,s=w?w.offset:0,h=0,c=0,r=this._cachedGroupRecords[nt(ot.itemsContainer.element)];r&&(y?h=r.oldLeft-s:c=r.oldTop-s);lt(ot.itemsContainer,function(n,t){var i,r,o,l,s;if(ut.firstIndex<=e&&ut.lastIndex>=e)if(i=this._cachedItemRecords[e],i){var f=this._getItemPositionForAnimations(e,u,t),v=f.row,y=f.column,w=f.left,b=f.top;i.inCellSpanningGroup=i.inCellSpanningGroup||at;(i.oldRow!==v||i.oldColumn!==y||i.oldTop!==b||i.oldLeft!==w)&&(i.row=v,i.column=y,i.left=w,i.top=b,r=i.oldLeft-i.left-h,o=i.oldTop-i.top-c,r=(this._site.rtl?-1:1)*r,i.xOffset=r,i.yOffset=o,(r!==0||o!==0)&&(l=i.element,i.needsToResetTransform=!0,l.style[tt]="",l.style[d.scriptName]="translate("+r+"px,"+o+"px)"),s=n.parentNode,a.hasClass(s,p._itemsBlockClass)&&(this._animatingItemsBlocks[nt(s)]=s))}else this._cachedInsertedItemRecords[e]=n,n.style[tt]="",n.style.opacity=0;e++}.bind(this));b=u;i=this._cachedHeaderRecords[b];i&&(f=this._getHeaderPositionForAnimations(b),i.height=f.height,i.width=f.width,(i.oldLeft!==f.left||i.oldTop!==f.top)&&(i.left=f.left,i.top=f.top,o=i.oldLeft-i.left,k=i.oldTop-i.top,o=(this._site.rtl?-1:1)*o,(o!==0||k!==0)&&(i.needsToResetTransform=!0,it=i.element,it.style[tt]="",it.style[d.scriptName]="translate("+o+"px,"+k+"px)")));r&&(y&&r.left!==s||!y&&r.top!==s)&&(l=r.element,h===0&&c===0?r.needsToResetTransform&&(r.needsToResetTransform=!1,l.style[d.scriptName]=""):(st=(this._site.rtl?-1:1)*h,ht=c,r.needsToResetTransform=!0,l.style[tt]="",l.style[d.scriptName]="translate("+st+"px, "+ht+"px)"))}if(this._inListMode||this._itemsPerBar===1)for(rt=Object.keys(this._animatingItemsBlocks),v=0,ct=rt.length;v<ct;v++)this._animatingItemsBlocks[rt[v]].style.overflow="visible";this._site._writeProfilerMark("Animation:layoutAnimation,StopTM")}},executeAnimations:function(){function fi(){var e,r,o,n;if(si(),gt)hi();else{if(f._itemsPerBar>1)for(e=f._itemsPerBar*f._sizes.containerCrossSize+f._getHeaderSizeContentAdjustment()+f._sizes.containerMargins[t?"top":i.rtl?"right":"left"]+(t?f._sizes.layoutOriginY:f._sizes.layoutOriginX),r=0,o=u.length;r<o;r++)n=u[r],n[it]>n[rt]?(ut=Math.max(ut,n[ni]+n[t?"height":"width"]),et=Math.max(et,e-n[ti]),wt=!0,y.push(n)):n[it]<n[rt]&&(ft=Math.max(ft,e-n[ni]),ot=Math.max(ot,n[ti]+n[t?"height":"width"]),y.push(n),wt=!0);i.rtl&&!t&&(ut*=-1,et*=-1,ft*=-1,ot*=-1);wt?li(f._itemsPerBar):kt()}}function bt(t){ct=s.join(v);ct.done(function(){v=[];h&&(n.Layout._debugAnimations?r._requestAnimationFrame(function(){t()}):t())})}function si(){if(b.length){i._writeProfilerMark("Animation:setupRemoveAnimation,StartTM");ht+=60;k+=60;var n=120;w&&(n*=10);v.push(o.executeTransition(b,[{property:"opacity",delay:dt,duration:n,timing:"linear",to:0,skipStylesReset:!0}]));i._writeProfilerMark("Animation:setupRemoveAnimation,StopTM")}}function hi(){var t,n,r,f,s,h;for(i._writeProfilerMark("Animation:cellSpanningFadeOutMove,StartTM"),t=[],n=0,r=u.length;n<r;n++)f=u[n],s=f.element,t.push(s);for(n=0,r=e.length;n<r;n++)f=e[n],s=f.element,t.push(s);h=120;w&&(h*=10);v.push(o.executeTransition(t,{property:"opacity",delay:dt,duration:h,timing:"linear",to:0}));bt(ci);i._writeProfilerMark("Animation:cellSpanningFadeOutMove,StopTM")}function ci(){var r,n,f,s,t,h;for(i._writeProfilerMark("Animation:cellSpanningFadeInMove,StartTM"),k=0,r=[],n=0,f=u.length;n<f;n++)s=u[n],t=s.element,t.style[d.scriptName]="",r.push(t);for(n=0,f=e.length;n<f;n++)s=e[n],t=s.element,t.style[d.scriptName]="",r.push(t);h=120;w&&(h*=10);v.push(o.executeTransition(r,{property:"opacity",delay:k,duration:h,timing:"linear",to:1}));i._writeProfilerMark("Animation:cellSpanningFadeInMove,StopTM");oi()}function li(n){var b,k,u,l,st,tt,et,c,ot,r,e;for(i._writeProfilerMark("Animation:setupReflowAnimation,StartTM"),b={},r=0,e=y.length;r<e;r++){var f=y[r],s=f.xOffset,h=f.yOffset;f[it]>f[rt]?t?h-=ut:s-=ut:f[it]<f[rt]&&(t?h+=ft:s+=ft);k=f.element;lt=Math.min(lt,t?s:h);vt=Math.max(vt,t?s:h);u=k.parentNode;a.hasClass(u,"win-itemscontainer")||(u=u.parentNode);l=b[nt(u)];l||(st=at(ri(u,i.tree)),b[nt(u)]=l=Math.ceil(st/n)-1);y[r][t?"column":"row"]===l&&(g[nt(u)]=u);tt=80;w&&(tt*=10);v.push(o.executeTransition(k,{property:d.cssName,delay:ht,duration:tt,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:"translate("+s+"px,"+h+"px)"}))}for(et=Object.keys(g),r=0,e=et.length;r<e;r++)c=g[et[r]],i.rtl&&t?(c.style.paddingLeft=-1*lt+"px",c.style.marginLeft=lt+"px"):(c.style[t?"paddingRight":"paddingBottom"]=vt+"px",c.style[t?"marginRight":"marginBottom"]="-"+vt+"px");for(ot=Object.keys(yt),r=0,e=ot.length;r<e;r++)yt[ot[r]].classList.add(p._clipClass);bt(ai);i._writeProfilerMark("Animation:setupReflowAnimation,StopTM")}function ei(){for(var r,f,e,o=Object.keys(g),n=0,u=o.length;n<u;n++)r=g[o[n]],i.rtl&&t?(r.style.paddingLeft="",r.style.marginLeft=""):(r.style[t?"paddingRight":"paddingBottom"]="",r.style[t?"marginRight":"marginBottom"]="");for(g={},f=Object.keys(yt),n=0,u=f.length;n<u;n++)e=yt[f[n]],e.style.overflow="",e.classList.remove(p._clipClass)}function ai(){var f,s;for(i._writeProfilerMark("Animation:prepareReflowedItems,StartTM"),f=0,s=y.length;f<s;f++){var u=y[f],e=0,o=0;u[it]>u[rt]?t?o=et:e=et:u[it]<u[rt]&&(t?o=-1*ot:e=-1*ot);u.element.style[tt]="";u.element.style[d.scriptName]="translate("+e+"px,"+o+"px)"}i._writeProfilerMark("Animation:prepareReflowedItems,StopTM");n.Layout._debugAnimations?r._requestAnimationFrame(function(){kt(!0)}):kt(!0)}function kt(n){var h=200,r,t,f,s;if(n&&(h=150,ht=0,k=0),w&&(h*=10),u.length>0||e.length>0){for(i._writeProfilerMark("Animation:setupMoveAnimation,StartTM"),r=[],t=0,f=e.length;t<f;t++)s=e[t].element,r.push(s);for(t=0,f=u.length;t<f;t++)s=u[t].element,r.push(s);v.push(o.executeTransition(r,{property:d.cssName,delay:ht,duration:h,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",to:""}));k+=80;i._writeProfilerMark("Animation:setupMoveAnimation,StopTM")}oi()}function oi(){if(st.length>0){i._writeProfilerMark("Animation:setupInsertAnimation,StartTM");var n=120;w&&(n*=10);v.push(o.executeTransition(st,[{property:"opacity",delay:k,duration:n,timing:"linear",to:1}]));i._writeProfilerMark("Animation:setupInsertAnimation,StopTM")}bt(vi)}function vi(){var t,r,n;for(i._writeProfilerMark("Animation:cleanupAnimations,StartTM"),ei(),t=0,r=b.length;t<r;t++)n=b[t],n.parentNode&&(l._disposeElement(n),n.parentNode.removeChild(n));i._writeProfilerMark("Animation:cleanupAnimations,StopTM");f._animationsRunning=null;h.complete()}var h=new c,pt,ii,ui,f;if(this._filterInsertedElements(),this._filterMovedElements(),this._filterRemovedElements(),this._insertedElements.length===0&&this._removedElements.length===0&&this._itemMoveRecords.length===0&&this._moveRecords.length===0)return this._resetAnimationCaches(!0),h.complete(),h.promise;this._animationsRunning=h.promise;var w=n.Layout._debugAnimations||n.Layout._slowAnimations,i=this._site,st=this._insertedElements,b=this._removedElements,u=this._itemMoveRecords,e=this._moveRecords,dt=0,ht=0,k=0,ct=null,v=[],gt=!1,wt=!1,lt=0,vt=0,g={},ut=0,ft=0,et=0,ot=0,y=[],t=this.orientation==="horizontal",it=t?"oldColumn":"oldRow",rt=t?"column":"row",ni=t?"oldTop":"oldLeft",ti=t?"top":"left",yt=this._animatingItemsBlocks;for(pt=0,ii=u.length;pt<ii;pt++)if(ui=u[pt],ui.inCellSpanningGroup){gt=!0;break}return f=this,n.Layout._debugAnimations?r._requestAnimationFrame(function(){fi()}):fi(),this._resetAnimationCaches(!0),h.promise.then(null,function(){var n,i,t;for(ei(),n=0,i=e.length;n<i;n++)t=e[n].element,t.style[d.scriptName]="",t.style.opacity=1;for(n=0,i=u.length;n<i;n++)t=u[n].element,t.style[d.scriptName]="",t.style.opacity=1;for(n=0,i=st.length;n<i;n++)st[n].style.opacity=1;for(n=0,i=b.length;n<i;n++)t=b[n],t.parentNode&&(l._disposeElement(t),t.parentNode.removeChild(t));this._animationsRunning=null;h=null;ct&&ct.cancel()}.bind(this)),h.promise},dragOver:function(n,t,i){var c=this.hitTest(n,t),l=this._groups?this._site.groupIndexFromItemIndex(c.index):0,b=this._site.tree[l].itemsContainer,a=at(b),f=this._groups?this._groups[l].startIndex:0,u=this._getVisibleRange(),e,o,s,h,r,nt,v,k,y,p,w;if(c.index-=f,c.insertAfterIndex-=f,u.firstIndex=Math.max(u.firstIndex-f-1,0),u.lastIndex=Math.min(u.lastIndex-f+1,a),e=Math.max(Math.min(a-1,c.insertAfterIndex),-1),o=Math.min(e+1,a),i){for(r=e;r>=u.firstIndex;r--)if(i._isIncluded(r+f))r===u.firstIndex&&(e=-1);else{e=r;break}for(r=o;r<u.lastIndex;r++)if(i._isIncluded(r+f))r===u.lastIndex-1&&(o=a);else{o=r;break}}if(s=ni(b,o),h=ni(b,e),this._animatedDragItems)for(r=0,nt=this._animatedDragItems.length;r<nt;r++)v=this._animatedDragItems[r],v&&(v.style[tt]=this._site.animationsDisabled?"":ct,v.style[d.scriptName]="");this._animatedDragItems=[];k=this.orientation==="horizontal";y=this._inListMode||this._itemsPerBar===1;this._groups&&this._groups[l]instanceof g.CellSpanningGroup&&(y=this._groups[l]._slotsPerColumn===1);p=0;w=0;!k&&!y||k&&y?p=this._site.rtl?-bt:bt:w=bt;s&&(s.style[tt]=this._site.animationsDisabled?"":ct,s.style[d.scriptName]="translate("+p+"px, "+w+"px)",this._animatedDragItems.push(s));h&&(h.style[tt]=this._site.animationsDisabled?"":ct,h.style[d.scriptName]="translate("+-p+"px, -"+w+"px)",this._animatedDragItems.push(h))},dragLeave:function(){if(this._animatedDragItems)for(var n=0,t=this._animatedDragItems.length;n<t;n++)this._animatedDragItems[n].style[tt]=this._site.animationsDisabled?"":ct,this._animatedDragItems[n].style[d.scriptName]="";this._animatedDragItems=[]},_setMaxRowsOrColumns:function(n){n===this._maxRowsOrColumns||this._inListMode||(this._sizes&&this._sizes.containerSizeLoaded&&(this._itemsPerBar=Math.floor(this._sizes.maxItemsContainerContentSize/this._sizes.containerCrossSize),n&&(this._itemsPerBar=Math.min(this._itemsPerBar,n)),this._itemsPerBar=Math.max(1,this._itemsPerBar)),this._maxRowsOrColumns=n,this._invalidateLayout())},_getItemPosition:function(n){if(this._groupsEnabled){var t=Math.min(this._groups.length-1,this._site.groupIndexFromItemIndex(n)),i=this._groups[t],r=n-i.startIndex;return this._getItemPositionForAnimations(n,t,r)}return this._getItemPositionForAnimations(n,0,n)},_getRealizationRange:function(){var n=this._site.realizedRange;return{firstIndex:this._firstItemFromRange(n.firstPixel),lastIndex:this._lastItemFromRange(n.lastPixel)}},_getVisibleRange:function(){var n=this._site.visibleRange;return{firstIndex:this._firstItemFromRange(n.firstPixel),lastIndex:this._lastItemFromRange(n.lastPixel)}},_resetAnimationCaches:function(n){var i,t,u,r;if(!n)for(this._resetStylesForRecords(this._cachedGroupRecords),this._resetStylesForRecords(this._cachedItemRecords),this._resetStylesForRecords(this._cachedHeaderRecords),this._resetStylesForInsertedRecords(this._cachedInsertedItemRecords),this._resetStylesForInsertedRecords(this._cachedInsertedHeaderRecords),this._resetStylesForRemovedRecords(this._cachedRemovedItems),this._resetStylesForRemovedRecords(this._cachedRemovedHeaders),i=Object.keys(this._animatingItemsBlocks),t=0,u=i.length;t<u;t++)r=this._animatingItemsBlocks[i[t]],r.style.overflow="",r.classList.remove(p._clipClass);this._cachedGroupRecords={};this._cachedItemRecords={};this._cachedHeaderRecords={};this._cachedInsertedItemRecords={};this._cachedInsertedHeaderRecords={};this._cachedRemovedItems=[];this._cachedRemovedHeaders=[];this._animatingItemsBlocks={}},_cacheRemovedElements:function(n,t,i,r,u){var h="left",c,l,s,a,o,f,e;for(this._site.rtl&&(h="right"),u?(c=this._sizes.headerContainerOuterX,l=this._sizes.headerContainerOuterY):(c=this._sizes.containerMargins[h],l=this._sizes.containerMargins.top),s=0,a=n.length;s<a;s++)o=n[s],o.newIndex===-1&&(f=o.element,e=t[o.oldIndex],e&&(e.element=f,delete t[o.oldIndex],f.style.position="absolute",f.style[tt]="",f.style.top=e.oldTop-l+"px",f.style[h]=e.oldLeft-c+"px",f.style.width=e.width+"px",f.style.height=e.height+"px",f.style[d.scriptName]="",this._site.surface.appendChild(f),r.push(e)),i[o.oldIndex]&&delete i[o.oldIndex])},_cacheInsertedElements:function(n,t,i){for(var r,h,c,f,e,o={},u=0,s=n.length;u<s;u++)r=n[u],h=t[r.oldIndex],h&&delete t[r.oldIndex],(h||r.oldIndex===-1||r.moved)&&(c=i[r.newIndex],c&&delete i[r.newIndex],f=r.element,o[r.newIndex]=f,f.style[tt]="",f.style[d.scriptName]="",f.style.opacity=0);for(e=Object.keys(t),u=0,s=e.length;u<s;u++)o[e[u]]=t[e[u]];return o},_resetStylesForRecords:function(n){for(var t,r=Object.keys(n),i=0,u=r.length;i<u;i++)t=n[r[i]],t.needsToResetTransform&&(t.element.style[d.scriptName]="",t.needsToResetTransform=!1)},_resetStylesForInsertedRecords:function(n){for(var r,i=Object.keys(n),t=0,u=i.length;t<u;t++)r=n[i[t]],r.style.opacity=1},_resetStylesForRemovedRecords:function(n){for(var t,i=0,r=n.length;i<r;i++)t=n[i].element,t.parentNode&&(l._disposeElement(t),t.parentNode.removeChild(t))},_updateAnimationCache:function(n,t){function o(n,t){for(var r,f,h,c,e,o={},i=0,s=n.length;i<s;i++)r=n[i],f=t[r.oldIndex],f&&(o[r.newIndex]=f,f.element=r.element,delete t[r.oldIndex]);for(h=Object.keys(t),i=0,s=h.length;i<s;i++)c=h[i],e=t[c],(!e.element||u[nt(e.element)])&&(o[c]=e);return o}this._resetStylesForRecords(this._cachedItemRecords);this._resetStylesForRecords(this._cachedHeaderRecords);this._resetStylesForInsertedRecords(this._cachedInsertedItemRecords);this._resetStylesForInsertedRecords(this._cachedInsertedHeaderRecords);for(var u={},f=this._getRealizationRange(),e=this._site.tree,i=0,r=0,s=e.length;i<s;i++)lt(e[i].itemsContainer,function(n){f.firstIndex<=r&&f.lastIndex>=r&&(u[nt(n)]=!0);r++});this._cachedItemRecords=o(n,this._cachedItemRecords);this._cachedHeaderRecords=o(t,this._cachedHeaderRecords);this._cachedInsertedItemRecords=this._cacheInsertedElements(n,this._cachedInsertedItemRecords,this._cachedItemRecords);this._cachedInsertedHeaderRecords=this._cacheInsertedElements(t,this._cachedInsertedHeaderRecords,this._cachedHeaderRecords)},_filterRemovedElements:function(){function r(r,e){for(var s,o,h=0,c=r.length;h<c;h++)s=r[h],o=s.element,s[n]+s[t]-1<i||s[n]>f||!u._site.viewport.contains(o)?o.parentNode&&(l._disposeElement(o),o.parentNode.removeChild(o)):e.push(o)}if(this._removedElements=[],this._site.animationsDisabled){this._resetStylesForRemovedRecords(this._cachedRemovedItems);this._resetStylesForRemovedRecords(this._cachedRemovedHeaders);return}var u=this,n=this.orientation==="horizontal"?"oldLeft":"oldTop",t=this.orientation==="horizontal"?"width":"height",i=this._site.scrollbarPos,f=i+this._site.viewportSize[t]-1;r(this._cachedRemovedItems,this._removedElements);r(this._cachedRemovedHeaders,this._removedElements)},_filterInsertedElements:function(){function t(t,r){for(var u,f,o=Object.keys(t),e=0,s=o.length;e<s;e++)u=o[e],f=t[u],u<n.firstIndex||u>n.lastIndex||i._site.viewport.contains(f.element)?f.style.opacity=1:r.push(f)}if(this._insertedElements=[],this._site.animationsDisabled){this._resetStylesForInsertedRecords(this._cachedInsertedItemRecords);this._resetStylesForInsertedRecords(this._cachedInsertedHeaderRecords);return}var i=this,n=this._getVisibleRange();t(this._cachedInsertedItemRecords,this._insertedElements);t(this._cachedInsertedHeaderRecords,this._insertedElements)},_filterMovedElements:function(){var p=this,c=this.orientation==="horizontal"?"oldLeft":"oldTop",l=this.orientation==="horizontal"?"left":"top",e=this.orientation==="horizontal"?"width":"height",a=this._getRealizationRange(),o=this._site.scrollbarPos,v=o+this._site.viewportSize[e]-1,s,n,t,y,i,r,h,u,f;if(this._itemMoveRecords=[],this._moveRecords=[],!this._site.animationsDisabled)for(s=this._site.tree,n=0,t=0,y=s.length;t<y;t++)i=s[t],r=!1,lt(i.itemsContainer,function(){var t,i;a.firstIndex<=n&&a.lastIndex>=n&&(t=this._cachedItemRecords[n],t&&(i=(t[c]+t[e]-1>=o&&t[c]<=v||t[l]+t[e]-1>=o&&t[l]<=v)&&p._site.viewport.contains(t.element),i&&(r=!0,t.needsToResetTransform&&(this._itemMoveRecords.push(t),delete this._cachedItemRecords[n]))));n++}.bind(this)),h=t,u=this._cachedHeaderRecords[h],u&&r&&u.needsToResetTransform&&(this._moveRecords.push(u),delete this._cachedHeaderRecords[h]),f=this._cachedGroupRecords[nt(i.itemsContainer.element)],f&&r&&f.needsToResetTransform&&(this._moveRecords.push(f),delete this._cachedGroupRecords[nt(i.itemsContainer.element)]);this._resetStylesForRecords(this._cachedGroupRecords);this._resetStylesForRecords(this._cachedItemRecords);this._resetStylesForRecords(this._cachedHeaderRecords)},_getItemPositionForAnimations:function(n,t,i){var u=this._groups[t],r=u.getItemPositionForAnimations(i),f=this._groups[t]?this._groups[t].offset:0,e=this._groupsEnabled&&this._groupHeaderPosition===k.left?this._sizes.headerContainerWidth:0,o=this._groupsEnabled&&this._groupHeaderPosition===k.top?this._sizes.headerContainerHeight:0;return r.left+=this._sizes.layoutOriginX+e+this._sizes.itemsContainerOuterX,r.top+=this._sizes.layoutOriginY+o+this._sizes.itemsContainerOuterY,r[this._horizontal?"left":"top"]+=f,r},_getHeaderPositionForAnimations:function(n){var t,i,r,u,f;return this._groupsEnabled?(i=this._sizes.headerContainerWidth-this._sizes.headerContainerOuterWidth,r=this._sizes.headerContainerHeight-this._sizes.headerContainerOuterHeight,this._groupHeaderPosition!==k.left||this._horizontal?this._groupHeaderPosition===k.top&&this._horizontal&&(i=this._groups[n].getItemsContainerSize()-this._sizes.headerContainerOuterWidth):r=this._groups[n].getItemsContainerSize()-this._sizes.headerContainerOuterHeight,u=this._horizontal?this._groups[n].offset:0,f=this._horizontal?0:this._groups[n].offset,t={top:this._sizes.layoutOriginY+f+this._sizes.headerContainerOuterY,left:this._sizes.layoutOriginX+u+this._sizes.headerContainerOuterX,height:r,width:i}):t={top:0,left:0,height:0,width:0},t},_rangeContainsItems:function(n,t){if(this._groups.length===0)return!1;var i=this._groups[this._groups.length-1],r=this._sizes.layoutOrigin+i.offset+this._getGroupSize(i)-1;return t>=0&&n<=r},_itemFromOffset:function(n,t){function f(n){if(!t.wholeItem){var r=i._horizontal?i._site.rtl?"right":"left":"top",u=i._horizontal?i._site.rtl?"left":"right":"bottom";return t.last?n-i._sizes.containerMargins[r]:n+i._sizes.containerMargins[u]}return n}function e(n){return t.last?n-i._getHeaderSizeGroupAdjustment()-i._sizes.itemsContainerOuterStart:n}var i=this,u,r;return this._groups.length===0?0:(t=t||{},n-=this._sizes.layoutOrigin,n=f(n),u=this._groupFromOffset(e(n)),r=this._groups[u],n-=r.offset,n-=this._getHeaderSizeGroupAdjustment(),r.startIndex+r.itemFromOffset(n,t))},_firstItemFromRange:function(n,t){return t=t||{},t.last=0,this._itemFromOffset(n,t)},_lastItemFromRange:function(n,t){return t=t||{},t.last=1,this._itemFromOffset(n,t)},_adjustedKeyForRTL:function(n){return this._site.rtl&&(n===b.leftArrow?n=b.rightArrow:n===b.rightArrow&&(n=b.leftArrow)),n},_adjustedKeyForOrientationAndBars:function(n,t){var i=n;if(t)return n;if(!this._horizontal)switch(i){case b.leftArrow:i=b.upArrow;break;case b.rightArrow:i=b.downArrow;break;case b.upArrow:i=b.leftArrow;break;case b.downArrow:i=b.rightArrow}return this._itemsPerBar===1&&(i===b.upArrow?i=b.leftArrow:i===b.downArrow&&(i=b.rightArrow)),i},_getAdjacentForPageKeys:function(n,t){var i=this._sizes.containerMargins,u=this.orientation==="horizontal"?i.left+i.right:i.top+i.bottom,e=this._site.viewportSize[this.orientation==="horizontal"?"width":"height"],f=this._site.scrollbarPos,h=f+e-1-i[this.orientation==="horizontal"?"right":"bottom"],c,o=this._firstItemFromRange(f,{wholeItem:!0}),s=this._lastItemFromRange(h,{wholeItem:!1}),r=this._getItemPosition(n.index),l=!1,p,a,w,v;if((n.index<o||n.index>s)&&(l=!0,f=this.orientation==="horizontal"?r.left-u:r.top-u,h=f+e-1,o=this._firstItemFromRange(f,{wholeItem:!0}),s=this._lastItemFromRange(h,{wholeItem:!1})),t===b.pageUp){if(!l&&o!==n.index)return{type:y.ObjectType.item,index:o};p=this.orientation==="horizontal"?r.left+r.width+u+i.left:r.top+r.height+u+i.bottom;a=this._firstItemFromRange(p-e,{wholeItem:!0});c=n.index===a?Math.max(0,n.index-this._itemsPerBar):a}else{if(!l&&s!==n.index)return{type:y.ObjectType.item,index:s};w=this.orientation==="horizontal"?r.left-u-i.right:r.top-u-i.bottom;v=Math.max(0,this._lastItemFromRange(w+e-1,{wholeItem:!0}));c=n.index===v?n.index+this._itemsPerBar:v}return{type:y.ObjectType.item,index:c}},_isCellSpanning:function(n){var i=this._site.groupFromIndex(n),t=this._groupInfo;return t?!!(typeof t=="function"?t(i):t).enableCellSpanning:!1},_getGroupInfo:function(n){var f=this._site.groupFromIndex(n),t=this._groupInfo,i=this._sizes.containerMargins,r={enableCellSpanning:!1};if(t=typeof t=="function"?t(f):t,t){if(t.enableCellSpanning&&(+t.cellWidth!==t.cellWidth||+t.cellHeight!==t.cellHeight))throw new u("WinJS.UI.GridLayout.GroupInfoResultIsInvalid",pt.groupInfoResultIsInvalid);r={enableCellSpanning:!!t.enableCellSpanning,cellWidth:t.cellWidth+i.left+i.right,cellHeight:t.cellHeight+i.top+i.bottom}}return r},_getItemInfo:function(n){var t;if(this._itemInfo&&typeof this._itemInfo=="function")t=this._itemInfo(n);else if(this._useDefaultItemInfo)t=this._defaultItemInfo(n);else throw new u("WinJS.UI.GridLayout.ItemInfoIsInvalid",pt.itemInfoIsInvalid);return s.as(t).then(function(n){if(!n||+n.width!==n.width||+n.height!==n.height)throw new u("WinJS.UI.GridLayout.ItemInfoIsInvalid",pt.itemInfoIsInvalid);return n})},_defaultItemInfo:function(n){var t=this;return this._site.renderItem(this._site.itemFromIndex(n)).then(function(i){return t._elementsToMeasure[n]={element:i},t._measureElements()}).then(function(){var i=t._elementsToMeasure[n],r={width:i.width,height:i.height};return delete t._elementsToMeasure[n],r},function(i){return delete t._elementsToMeasure[n],s.wrapError(i)})},_getGroupSize:function(n){var t=0;return this._groupsEnabled&&(this._horizontal&&this._groupHeaderPosition===k.top?t=this._sizes.headerContainerMinWidth:this._horizontal||this._groupHeaderPosition!==k.left||(t=this._sizes.headerContainerMinHeight)),Math.max(t,n.getItemsContainerSize()+this._getHeaderSizeGroupAdjustment())},_groupFromOffset:function(n){return n<this._groups[0].offset?0:this._groupFrom(function(t){return n<t.offset})},_groupFromImpl:function(n,t,i){if(t<n)return null;var r=n+Math.floor((t-n)/2),u=this._groups[r];return i(u,r)?this._groupFromImpl(n,r-1,i):r<t&&!i(this._groups[r+1],r+1)?this._groupFromImpl(r+1,t,i):r},_groupFrom:function(n){if(this._groups.length>0){var t=this._groups.length-1,i=this._groups[t];return n(i,t)?this._groupFromImpl(0,this._groups.length-1,n):t}return null},_invalidateLayout:function(){this._site&&this._site.invalidateLayout()},_resetMeasurements:function(){this._measuringPromise&&(this._measuringPromise.cancel(),this._measuringPromise=null);this._containerSizeClassName&&(a.removeClass(this._site.surface,this._containerSizeClassName),et(this._containerSizeClassName),this._containerSizeClassName=null);this._sizes=null;this._resetAnimationCaches()},_measureElements:function(){if(!this._measuringElements){var n=this;n._measuringElements=h.schedulePromiseHigh(null,"WinJS.UI.GridLayout._measuringElements").then(function(){var u,e,i,o,s,l;n._site._writeProfilerMark("_measureElements,StartTM");var r=n._createMeasuringSurface(),f=t.document.createElement("div"),h=n._site,v=n._measuringElements,c=n._elementsToMeasure,y=!1;for(f.className=p._itemsContainerClass+" "+p._laidOutClass,f.style.cssText+=";display: -ms-grid;-ms-grid-column: 1;-ms-grid-row: 1",u=Object.keys(c),i=0,e=u.length;i<e;i++)o=c[u[i]].element,o.style["-ms-grid-column"]=i+1,o.style["-ms-grid-row"]=i+1,f.appendChild(o);for(r.appendChild(f),h.viewport.insertBefore(r,h.viewport.firstChild),v.then(null,function(){y=!0}),i=0,e=u.length;i<e&&!y;i++)s=c[u[i]],l=s.element.querySelector("."+p._itemClass),s.width=a.getTotalWidth(l),s.height=a.getTotalHeight(l);r.parentNode&&r.parentNode.removeChild(r);v===n._measuringElements&&(n._measuringElements=null);h._writeProfilerMark("_measureElements,StopTM")},function(t){return n._measuringElements=null,s.wrapError(t)})}return this._measuringElements},_ensureEnvInfo:function(){return this._envInfo||(this._envInfo=ui(this._site),this._envInfo&&!this._envInfo.supportsCSSGrid&&a.addClass(this._site.surface,p._noCSSGrid)),!!this._envInfo},_createMeasuringSurface:function(){var n=t.document.createElement("div");return n.style.cssText="visibility: hidden;-ms-grid-columns: auto;-ms-grid-rows: auto;-ms-flex-align: start;-webkit-align-items: flex-start;align-items: flex-start",n.className=p._scrollableClass+" "+(this._inListMode?p._listLayoutClass:p._gridLayoutClass),this._envInfo.supportsCSSGrid||a.addClass(n,p._noCSSGrid),this._groupsEnabled&&(this._groupHeaderPosition===k.top?a.addClass(n,p._headerPositionTopClass):a.addClass(n,p._headerPositionLeftClass)),n},_measureItem:function(n){function o(n,u){var h=!!u,e={},u,c=r.rtl?"right":"left";return r.itemCount.then(function(t){return!t||i._groupsEnabled&&!r.groupCount?s.cancel:(u=u||r.itemFromIndex(n),e.container=r.renderItem(u),i._groupsEnabled&&(e.headerContainer=r.renderHeader(i._site.groupFromIndex(r.groupIndexFromItemIndex(n)))),s.join(e))}).then(function(e){function at(){var u=i._horizontal,h=i._groupsEnabled,o=!1,t;f.then(null,function(){o=!0});var s=yt(b),l=r.rtl?r.viewport.offsetWidth-(b.offsetLeft+b.offsetWidth):b.offsetLeft,v=b.offsetTop,n={viewportContentSize:0,surfaceContentSize:0,maxItemsContainerContentSize:0,surfaceOuterHeight:ot(w),surfaceOuterWidth:st(w),layoutOriginX:l-s[c],layoutOriginY:v-s.top,itemsContainerOuterHeight:ot(y),itemsContainerOuterWidth:st(y),itemsContainerOuterX:ut(r.rtl?"Right":"Left",y),itemsContainerOuterY:ut("Top",y),itemsContainerMargins:yt(y),itemBoxOuterHeight:ot(et),itemBoxOuterWidth:st(et),containerOuterHeight:ot(e.container),containerOuterWidth:st(e.container),emptyContainerContentHeight:a.getContentHeight(g),emptyContainerContentWidth:a.getContentWidth(g),containerMargins:yt(e.container),containerWidth:0,containerHeight:0,containerSizeLoaded:!1};return r.header&&(n[u?"layoutOriginX":"layoutOriginY"]+=a[u?"getTotalWidth":"getTotalHeight"](r.header)),h&&(n.headerContainerOuterX=ut(r.rtl?"Right":"Left",e.headerContainer),n.headerContainerOuterY=ut("Top",e.headerContainer),n.headerContainerOuterWidth=st(e.headerContainer),n.headerContainerOuterHeight=ot(e.headerContainer),n.headerContainerWidth=a.getTotalWidth(e.headerContainer),n.headerContainerHeight=a.getTotalHeight(e.headerContainer),n.headerContainerMinWidth=rt(e.headerContainer,"minWidth")+n.headerContainerOuterWidth,n.headerContainerMinHeight=rt(e.headerContainer,"minHeight")+n.headerContainerOuterHeight),t={sizes:n,viewportContentWidth:a.getContentWidth(r.viewport),viewportContentHeight:a.getContentHeight(r.viewport),containerContentWidth:a.getContentWidth(e.container),containerContentHeight:a.getContentHeight(e.container),containerWidth:a.getTotalWidth(e.container),containerHeight:a.getTotalHeight(e.container)},t.viewportCrossSize=t[u?"viewportContentHeight":"viewportContentWidth"],r.readyToMeasure(),o?null:t}function d(){w.parentNode&&w.parentNode.removeChild(w)}var w=i._createMeasuringSurface(),y=t.document.createElement("div"),g=t.document.createElement("div"),et=e.container.querySelector("."+p._itemBoxClass),ht=r.groupIndexFromItemIndex(n),v,l,ft;g.className=p._containerClass;y.className=p._itemsContainerClass+" "+p._laidOutClass;var ct=1,lt=1,tt=2,it=2,b=y,nt=!1;if(i._inListMode&&i._groupsEnabled&&(i._horizontal&&i._groupHeaderPosition===k.top?(ct=2,it=1,tt=1,b=e.headerContainer,nt=!0):i._horizontal||i._groupHeaderPosition!==k.left||(lt=2,it=1,tt=1,b=e.headerContainer,nt=!0)),y.style.cssText+=";display: "+(i._inListMode?(i._horizontal?"flex":"block")+"; overflow: hidden":"inline-block")+";vertical-align:top;-ms-grid-column: "+lt+";-ms-grid-row: "+ct,i._inListMode||(e.container.style.display="inline-block"),i._groupsEnabled&&(e.headerContainer.style.cssText+=";display: inline-block;-ms-grid-column: "+it+";-ms-grid-row: "+tt,a.addClass(e.headerContainer,p._laidOutClass+" "+p._groupLeaderClass),(i._groupHeaderPosition===k.top&&i._horizontal||i._groupHeaderPosition===k.left&&!i._horizontal)&&a.addClass(y,p._groupLeaderClass)),nt&&w.appendChild(e.headerContainer),y.appendChild(e.container),y.appendChild(g),w.appendChild(y),!nt&&i._groupsEnabled&&w.appendChild(e.headerContainer),r.viewport.insertBefore(w,r.viewport.firstChild),v=at(),v){if(i._horizontal&&v.viewportContentHeight===0||!i._horizontal&&v.viewportContentWidth===0)return d(),s.cancel;if(h||i._isCellSpanning(ht)||v.containerContentWidth!==0&&v.containerContentHeight!==0)l=i._sizes=v.sizes,Object.defineProperties(l,{surfaceOuterCrossSize:{get:function(){return i._horizontal?l.surfaceOuterHeight:l.surfaceOuterWidth},enumerable:!0},layoutOrigin:{get:function(){return i._horizontal?l.layoutOriginX:l.layoutOriginY},enumerable:!0},itemsContainerOuterSize:{get:function(){return i._horizontal?l.itemsContainerOuterWidth:l.itemsContainerOuterHeight},enumerable:!0},itemsContainerOuterCrossSize:{get:function(){return i._horizontal?l.itemsContainerOuterHeight:l.itemsContainerOuterWidth},enumerable:!0},itemsContainerOuterStart:{get:function(){return i._horizontal?l.itemsContainerOuterX:l.itemsContainerOuterY},enumerable:!0},itemsContainerOuterCrossStart:{get:function(){return i._horizontal?l.itemsContainerOuterY:l.itemsContainerOuterX},enumerable:!0},containerCrossSize:{get:function(){return i._horizontal?l.containerHeight:l.containerWidth},enumerable:!0},containerSize:{get:function(){return i._horizontal?l.containerWidth:l.containerHeight},enumerable:!0}}),i._isCellSpanning(ht)||(i._inListMode?(ft=v.viewportCrossSize-l.surfaceOuterCrossSize-i._getHeaderSizeContentAdjustment()-l.itemsContainerOuterCrossSize,i._horizontal?(l.containerHeight=ft,l.containerWidth=v.containerWidth):(l.containerHeight=v.containerHeight,l.containerWidth=ft)):(l.containerWidth=v.containerWidth,l.containerHeight=v.containerHeight),l.containerSizeLoaded=!0),i._createContainerStyleRule(),i._viewportSizeChanged(v.viewportCrossSize),d();else return d(),u.then(function(){return o(n,u)})}else return d(),s.cancel})}var i=this,u="Layout:measureItem",r=i._site,f=i._measuringPromise,e;return f||(r._writeProfilerMark(u+",StartTM"),e=new c,i._measuringPromise=f=e.promise.then(function(){return i._ensureEnvInfo()?o(n):s.cancel}).then(function(){r._writeProfilerMark(u+":complete,info");r._writeProfilerMark(u+",StopTM")},function(n){return i._measuringPromise=null,r._writeProfilerMark(u+":canceled,info"),r._writeProfilerMark(u+",StopTM"),s.wrapError(n)}),e.complete()),f},_getHeaderSizeGroupAdjustment:function(){if(this._groupsEnabled){if(this._horizontal&&this._groupHeaderPosition===k.left)return this._sizes.headerContainerWidth;if(!this._horizontal&&this._groupHeaderPosition===k.top)return this._sizes.headerContainerHeight}return 0},_getHeaderSizeContentAdjustment:function(){if(this._groupsEnabled){if(this._horizontal&&this._groupHeaderPosition===k.top)return this._sizes.headerContainerHeight;if(!this._horizontal&&this._groupHeaderPosition===k.left)return this._sizes.headerContainerWidth}return 0},_getViewportCrossSize:function(){return this._site.viewportSize[this._horizontal?"height":"width"]},_viewportSizeChanged:function(n){var t=this._sizes;t.viewportContentSize=n;t.surfaceContentSize=n-t.surfaceOuterCrossSize;t.maxItemsContainerContentSize=t.surfaceContentSize-t.itemsContainerOuterCrossSize-this._getHeaderSizeContentAdjustment();t.containerSizeLoaded&&!this._inListMode?(this._itemsPerBar=Math.floor(t.maxItemsContainerContentSize/t.containerCrossSize),this.maximumRowsOrColumns&&(this._itemsPerBar=Math.min(this._itemsPerBar,this.maximumRowsOrColumns)),this._itemsPerBar=Math.max(1,this._itemsPerBar)):(this._inListMode&&(t[this._horizontal?"containerHeight":"containerWidth"]=t.maxItemsContainerContentSize),this._itemsPerBar=1);this._resetAnimationCaches()},_createContainerStyleRule:function(){var n=this._sizes,t,i,r,u;!this._containerSizeClassName&&n.containerSizeLoaded&&(n.emptyContainerContentHeight===0||n.emptyContainerContentWidth===0)&&(t=n.containerWidth-n.containerOuterWidth+"px",i=n.containerHeight-n.containerOuterHeight+"px",this._inListMode&&(this._horizontal?i="calc(100% - "+(n.containerMargins.top+n.containerMargins.bottom)+"px)":t="auto"),this._containerSizeClassName||(this._containerSizeClassName=wt("containersize"),a.addClass(this._site.surface,this._containerSizeClassName)),r="."+p._containerClass,u="width:"+t+";height:"+i+";",kt(this._containerSizeClassName,this._site,r,u))},_ensureContainerSize:function(n){var i=this._sizes,r,u,t;return i.containerSizeLoaded||this._ensuringContainerSize?this._ensuringContainerSize?this._ensuringContainerSize:s.wrap():((!this._itemInfo||typeof this._itemInfo!="function")&&this._useDefaultItemInfo?(u=i.containerMargins,r=s.wrap({width:n.groupInfo.cellWidth-u.left-u.right,height:n.groupInfo.cellHeight-u.top-u.bottom})):r=this._getItemInfo(),t=this,this._ensuringContainerSize=r.then(function(n){i.containerSizeLoaded=!0;i.containerWidth=n.width+i.itemBoxOuterWidth+i.containerOuterWidth;i.containerHeight=n.height+i.itemBoxOuterHeight+i.containerOuterHeight;t._inListMode?t._itemsPerBar=1:(t._itemsPerBar=Math.floor(i.maxItemsContainerContentSize/i.containerCrossSize),t.maximumRowsOrColumns&&(t._itemsPerBar=Math.min(t._itemsPerBar,t.maximumRowsOrColumns)),t._itemsPerBar=Math.max(1,t._itemsPerBar));t._createContainerStyleRule()}),r.done(function(){t._ensuringContainerSize=null},function(){t._ensuringContainerSize=null}),r)},_indexToCoordinate:function(n,t){t=t||this._itemsPerBar;var i=Math.floor(n/t);return this._horizontal?{column:i,row:n-i*t}:{row:i,column:n-i*t}},_rangeForGroup:function(n,t){var i=n.startIndex,r=i+n.count-1;return!t||t.firstIndex>r||t.lastIndex<i?null:{firstIndex:Math.max(0,t.firstIndex-i),lastIndex:Math.min(n.count-1,t.lastIndex-i)}},_syncDomWithGroupHeaderPosition:function(n){if(this._groupsEnabled&&this._oldGroupHeaderPosition!==this._groupHeaderPosition){var i=n.length,t;if(this._oldGroupHeaderPosition===k.top)if(a.removeClass(this._site.surface,p._headerPositionTopClass),this._horizontal)for(t=0;t<i;t++)n[t].header.style.maxWidth="",a.removeClass(n[t].itemsContainer.element,p._groupLeaderClass);else this._site.surface.style.msGridRows="";else if(this._oldGroupHeaderPosition===k.left){if(a.removeClass(this._site.surface,p._headerPositionLeftClass),!this._horizontal)for(t=0;t<i;t++)n[t].header.style.maxHeight="",a.removeClass(n[t].itemsContainer.element,p._groupLeaderClass);this._site.surface.style.msGridColumns=""}if(this._groupHeaderPosition===k.top){if(a.addClass(this._site.surface,p._headerPositionTopClass),this._horizontal)for(t=0;t<i;t++)a.addClass(n[t].itemsContainer.element,p._groupLeaderClass)}else if(a.addClass(this._site.surface,p._headerPositionLeftClass),!this._horizontal)for(t=0;t<i;t++)a.addClass(n[t].itemsContainer.element,p._groupLeaderClass);this._oldGroupHeaderPosition=this._groupHeaderPosition}},_layoutGroup:function(n){var f=this._groups[n],e=this._site.tree[n],i=e.header,r=e.itemsContainer.element,t=this._sizes,u=f.getItemsContainerCrossSize(),o,s,h,c;this._groupsEnabled&&(this._horizontal?this._groupHeaderPosition===k.top?(o=t.headerContainerMinWidth-t.headerContainerOuterWidth,s=f.getItemsContainerSize()-t.headerContainerOuterWidth,i.style.maxWidth=Math.max(o,s)+"px",this._envInfo.supportsCSSGrid?(i.style.msGridColumn=n+1,r.style.msGridColumn=n+1):(i.style.height=t.headerContainerHeight-t.headerContainerOuterHeight+"px",r.style.height=u-t.itemsContainerOuterHeight+"px",r.style.marginBottom=t.itemsContainerMargins.bottom+(t.maxItemsContainerContentSize-u+t.itemsContainerOuterHeight)+"px"),a.addClass(r,p._groupLeaderClass)):this._envInfo.supportsCSSGrid?(i.style.msGridColumn=n*2+1,r.style.msGridColumn=n*2+2):(i.style.width=t.headerContainerWidth-t.headerContainerOuterWidth+"px",i.style.height=u-t.headerContainerOuterHeight+"px",r.style.height=u-t.itemsContainerOuterHeight+"px"):this._groupHeaderPosition===k.left?(h=t.headerContainerMinHeight-t.headerContainerOuterHeight,c=f.getItemsContainerSize()-t.headerContainerOuterHeight,i.style.maxHeight=Math.max(h,c)+"px",this._envInfo.supportsCSSGrid?(i.style.msGridRow=n+1,r.style.msGridRow=n+1):(i.style.width=t.headerContainerWidth-t.headerContainerOuterWidth+"px",r.style.width=u-t.itemsContainerOuterWidth+"px",r.style["margin"+(this._site.rtl?"Left":"Right")]=t.itemsContainerMargins[this._site.rtl?"left":"right"]+(t.maxItemsContainerContentSize-u+t.itemsContainerOuterWidth)+"px"),a.addClass(r,p._groupLeaderClass)):(i.style.msGridRow=n*2+1,this._inListMode?i.style.height=t.headerContainerHeight-t.headerContainerOuterHeight+"px":this._envInfo.supportsCSSGrid?r.style.msGridRow=n*2+2:(i.style.height=t.headerContainerHeight-t.headerContainerOuterHeight+"px",i.style.width=u-t.headerContainerOuterWidth+"px",r.style.width=u-t.itemsContainerOuterWidth+"px")),a.addClass(i,p._laidOutClass+" "+p._groupLeaderClass));a.addClass(r,p._laidOutClass)}},{_barsPerItemsBlock:4})}),_LegacyLayout:i.Namespace._lazy(function(){return i.Class.derive(n._LayoutCommon,null,{disableBackdrop:{get:function(){return this._backdropDisabled||!1},set:function(n){if(a._deprecated(w.disableBackdropIsDeprecated),n=!!n,this._backdropDisabled!==n&&(this._backdropDisabled=n,this._disableBackdropClassName&&(et(this._disableBackdropClassName),this._site&&a.removeClass(this._site.surface,this._disableBackdropClassName),this._disableBackdropClassName=null),this._disableBackdropClassName=wt("disablebackdrop"),this._site&&a.addClass(this._site.surface,this._disableBackdropClassName),n))kt(this._disableBackdropClassName,this._site,".win-container.win-backdrop","background-color:transparent;")}},backdropColor:{get:function(){return this._backdropColor||"rgba(155,155,155,0.23)"},set:function(n){if(a._deprecated(w.backdropColorIsDeprecated),n&&this._backdropColor!==n){this._backdropColor=n;this._backdropColorClassName&&(et(this._backdropColorClassName),this._site&&a.removeClass(this._site.surface,this._backdropColorClassName),this._backdropColorClassName=null);this._backdropColorClassName=wt("backdropcolor");this._site&&a.addClass(this._site.surface,this._backdropColorClassName);var t="background-color:"+n+";";kt(this._backdropColorClassName,this._site,".win-container.win-backdrop",t)}}}})}),GridLayout:i.Namespace._lazy(function(){return i.Class.derive(n._LegacyLayout,function(n){n=n||{};this.itemInfo=n.itemInfo;this.groupInfo=n.groupInfo;this._maxRowsOrColumns=0;this._useDefaultItemInfo=!0;this._elementsToMeasure={};this._groupHeaderPosition=n.groupHeaderPosition||k.top;this.orientation=n.orientation||"horizontal";n.maxRows&&(this.maxRows=+n.maxRows);n.maximumRowsOrColumns&&(this.maximumRowsOrColumns=+n.maximumRowsOrColumns)},{maximumRowsOrColumns:{get:function(){return this._maxRowsOrColumns},set:function(n){this._setMaxRowsOrColumns(n)}},maxRows:{get:function(){return this.maximumRowsOrColumns},set:function(n){a._deprecated(w.maxRowsIsDeprecated);this.maximumRowsOrColumns=n}},itemInfo:{enumerable:!0,get:function(){return this._itemInfo},set:function(n){n&&a._deprecated(w.itemInfoIsDeprecated);this._itemInfo=n;this._invalidateLayout()}},groupInfo:{enumerable:!0,get:function(){return this._groupInfo},set:function(n){n&&a._deprecated(w.groupInfoIsDeprecated);this._groupInfo=n;this._invalidateLayout()}}})})});g=i.Namespace.defineWithParent(null,null,{UniformGroupBase:i.Namespace._lazy(function(){return i.Class.define(null,{cleanUp:function(){},itemFromOffset:function(n,t){var i;t=t||{};i=this._layout._sizes;n-=i.itemsContainerOuterStart;t.wholeItem&&(n+=(t.last?-1:1)*(i.containerSize-1));var r=this.count-1,u=Math.floor(r/this._layout._itemsPerBar),f=it(0,u,Math.floor(n/i.containerSize)),e=(f+t.last)*this._layout._itemsPerBar-t.last;return it(0,this.count-1,e)},hitTest:function(n,t){var f=this._layout._horizontal,u=this._layout._itemsPerBar,e=this._layout._inListMode||u===1,h=f?n:t,c=f?t:n,r=this._layout._sizes,l;h-=r.itemsContainerOuterStart;c-=r.itemsContainerOuterCrossStart;var o=Math.floor(h/r.containerSize),a=it(0,u-1,Math.floor(c/r.containerCrossSize)),s=Math.max(-1,o*u+a),i;return(i=!f&&e||f&&!e?(t-r.containerHeight/2)/r.containerHeight:(n-r.containerWidth/2)/r.containerWidth,e)?(i=Math.floor(i),{index:s,insertAfterIndex:i>=0&&s>=0?i:-1}):(i=it(-1,u-1,i),l=i<0?o*u-1:o*u+Math.floor(i),{index:it(-1,this.count-1,s),insertAfterIndex:it(-1,this.count-1,l)})},getAdjacent:function(n,t){var i=n.index,u=Math.floor(i/this._layout._itemsPerBar),f=i%this._layout._itemsPerBar,r,e,o,s,h;switch(t){case b.upArrow:r=f===0?"boundary":i-1;break;case b.downArrow:e=i===this.count-1;o=this._layout._itemsPerBar>1&&f===this._layout._itemsPerBar-1;r=e||o?"boundary":i+1;break;case b.leftArrow:r=u===0&&this._layout._itemsPerBar>1?"boundary":i-this._layout._itemsPerBar;break;case b.rightArrow:s=this.count-1;h=Math.floor(s/this._layout._itemsPerBar);r=u===h?"boundary":Math.min(i+this._layout._itemsPerBar,this.count-1)}return r==="boundary"?r:{type:y.ObjectType.item,index:r}},getItemsContainerSize:function(){var n=this._layout._sizes,t=Math.ceil(this.count/this._layout._itemsPerBar);return t*n.containerSize+n.itemsContainerOuterSize},getItemsContainerCrossSize:function(){var n=this._layout._sizes;return this._layout._itemsPerBar*n.containerCrossSize+n.itemsContainerOuterCrossSize},getItemPositionForAnimations:function(n){var t=this._layout._sizes,u=this._layout._site.rtl?"right":"left",r=this._layout._sizes.containerMargins,i=this._layout._indexToCoordinate(n);return{row:i.row,column:i.column,top:r.top+i.row*t.containerHeight,left:r[u]+i.column*t.containerWidth,height:t.containerHeight-t.containerMargins.top-t.containerMargins.bottom,width:t.containerWidth-t.containerMargins.left-t.containerMargins.right}}})}),UniformGroup:i.Namespace._lazy(function(){return i.Class.derive(g.UniformGroupBase,function(n,t){this._layout=n;this._itemsContainer=t;a.addClass(this._itemsContainer,n._inListMode?p._uniformListLayoutClass:p._uniformGridLayoutClass)},{cleanUp:function(n){n||(a.removeClass(this._itemsContainer,p._uniformGridLayoutClass),a.removeClass(this._itemsContainer,p._uniformListLayoutClass),this._itemsContainer.style.height=this._itemsContainer.style.width="");this._itemsContainer=null;this._layout=null;this.groupInfo=null;this.startIndex=null;this.offset=null;this.count=null},prepareLayout:function(n,t,i,r){return this.groupInfo=r.groupInfo,this.startIndex=r.startIndex,this.count=n,this._layout._ensureContainerSize(this)},layoutRealizedRange:function(){var n=this._layout._sizes;this._itemsContainer.style[this._layout._horizontal?"width":"height"]=this.getItemsContainerSize()-n.itemsContainerOuterSize+"px";this._itemsContainer.style[this._layout._horizontal?"height":"width"]=this._layout._inListMode?n.maxItemsContainerContentSize+"px":this._layout._itemsPerBar*n.containerCrossSize+"px"},layoutUnrealizedRange:function(){return s.wrap()}})}),UniformFlowGroup:i.Namespace._lazy(function(){return i.Class.derive(g.UniformGroupBase,function(n,t){this._layout=n;this._itemsContainer=t.element;a.addClass(this._itemsContainer,n._inListMode?p._uniformListLayoutClass:p._uniformGridLayoutClass)},{cleanUp:function(n){n||(a.removeClass(this._itemsContainer,p._uniformListLayoutClass),a.removeClass(this._itemsContainer,p._uniformGridLayoutClass),this._itemsContainer.style.height="")},layout:function(){this._layout._site._writeProfilerMark("Layout:_UniformFlowGroup:setItemsContainerHeight,info");this._itemsContainer.style.height=this.count*this._layout._sizes.containerHeight+"px"}})}),CellSpanningGroup:i.Namespace._lazy(function(){return i.Class.define(function(n,t){this._layout=n;this._itemsContainer=t;a.addClass(this._itemsContainer,p._cellSpanningGridLayoutClass);this.resetMap()},{cleanUp:function(n){n||(this._cleanContainers(),a.removeClass(this._itemsContainer,p._cellSpanningGridLayoutClass),this._itemsContainer.style.cssText="");this._itemsContainer=null;this._layoutPromise&&(this._layoutPromise.cancel(),this._layoutPromise=null);this.resetMap();this._slotsPerColumn=null;this._offScreenSlotsPerColumn=null;this._items=null;this._layout=null;this._containersToHide=null;this.groupInfo=null;this.startIndex=null;this.offset=null;this.count=null},prepareLayoutWithCopyOfTree:function(n,t,i,r){var e=this,u,f;if(this._containersToHide={},t)for(u=t.firstIndex;u<=t.lastIndex;u++)this._containersToHide[nt(i._items[u])]=i._items[u];for(this.groupInfo=r.groupInfo,this.startIndex=r.startIndex,this.count=n.items.length,this._items=n.items,this._slotsPerColumn=Math.floor(this._layout._sizes.maxItemsContainerContentSize/this.groupInfo.cellHeight),this._layout.maximumRowsOrColumns&&(this._slotsPerColumn=Math.min(this._slotsPerColumn,this._layout.maximumRowsOrColumns)),this._slotsPerColumn=Math.max(this._slotsPerColumn,1),this.resetMap(),f=new Array(this.count),u=0;u<this.count;u++)f[u]=this._layout._getItemInfo(this.startIndex+u);return s.join(f).then(function(n){n.forEach(function(n,t){e.addItemToMap(t,n)})})},layoutRealizedRange:function(n,t){if(t)for(var r=Math.max(n,t.firstIndex),i=r;i<=t.lastIndex;i++)this._layoutItem(i),delete this._containersToHide[nt(this._items[i])];Object.keys(this._containersToHide).forEach(function(n){a.removeClass(this._containersToHide[n],p._laidOutClass)}.bind(this));this._containersToHide={};this._itemsContainer.style.cssText+=";width:"+(this.getItemsContainerSize()-this._layout._sizes.itemsContainerOuterSize)+"px;height:"+this._layout._sizes.maxItemsContainerContentSize+"px;-ms-grid-columns: ("+this.groupInfo.cellWidth+"px)["+this.getColumnCount()+"];-ms-grid-rows: ("+this.groupInfo.cellHeight+"px)["+(this._slotsPerColumn+this._offScreenSlotsPerColumn)+"]"},layoutUnrealizedRange:function(n,t,i){var r=this,u;return r._layoutPromise=new s(function(f){function l(){u=null;f()}function a(n){return h.schedule(n,h.Priority.normal,null,"WinJS.UI.GridLayout.CellSpanningGroup.LayoutUnrealizedRange")}var e;if(t){var s=!1,c=t.firstIndex-1,o=Math.max(n,t.lastIndex+1);o=Math.max(c+1,o);u=a(function v(t){while(!s){if(t.shouldYield){t.setWork(v);return}s=!0;c>=n&&(r._layoutItem(c),c--,s=!1);o<r.count&&(r._layoutItem(o),o++,s=!1)}l()})}else i?(e=r.count-1,u=a(function y(t){for(;e>=n;e--){if(t.shouldYield){t.setWork(y);return}r._layoutItem(e)}l()})):(e=n,u=a(function p(n){for(;e<r.count;e++){if(n.shouldYield){n.setWork(p);return}r._layoutItem(e)}l()}))},function(){u&&u.cancel();u=null}),r._layoutPromise},itemFromOffset:function(n,t){var i,r,u;return t=t||{},i=this._layout._sizes,r=i.containerMargins,n-=i.itemsContainerOuterX,n-=(t.last?1:-1)*r[t.last?"left":"right"],u=this.indexFromOffset(n,t.wholeItem,t.last).item,it(0,this.count-1,u)},getAdjacent:function(n,t){var u,e,r,f,i;u=e=n.index;i=this.lastAdjacent===u?this.lastInMapIndex:this.findItem(u);do{var o=Math.floor(i/this._slotsPerColumn),s=i-o*this._slotsPerColumn,h=Math.floor((this.occupancyMap.length-1)/this._slotsPerColumn);switch(t){case b.upArrow:if(s>0)i--;else return{type:y.ObjectType.item,index:e};break;case b.downArrow:if(s+1<this._slotsPerColumn)i++;else return{type:y.ObjectType.item,index:e};break;case b.leftArrow:i=o>0?i-this._slotsPerColumn:-1;break;case b.rightArrow:i=o<h?i+this._slotsPerColumn:this.occupancyMap.length}f=i>=0&&i<this.occupancyMap.length;f&&(r=this.occupancyMap[i]?this.occupancyMap[i].index:undefined)}while(f&&(u===r||r===undefined));return this.lastAdjacent=r,this.lastInMapIndex=i,f?{type:y.ObjectType.item,index:r}:"boundary"},hitTest:function(n,t){var e=this._layout._sizes,i=0;if(n-=e.itemsContainerOuterX,t-=e.itemsContainerOuterY,this.occupancyMap.length>0){for(var h=this.indexFromOffset(n,!1,0),c=Math.min(this._slotsPerColumn-1,Math.floor(t/this.groupInfo.cellHeight)),r=h.index,u=r;c-->0;)r++,this.occupancyMap[r]&&(u=r);this.occupancyMap[u]||u--;i=this.occupancyMap[u].index}var f=this.getItemSize(i),l=f.column*this.groupInfo.cellWidth,a=f.row*this.groupInfo.cellHeight,o=this._slotsPerColumn===1,s=i;return(o&&n<l+f.contentWidth/2||!o&&t<a+f.contentHeight/2)&&s--,{type:y.ObjectType.item,index:it(0,this.count-1,i),insertAfterIndex:it(-1,this.count-1,s)}},getItemsContainerSize:function(){var n=this._layout._sizes;return this.getColumnCount()*this.groupInfo.cellWidth+n.itemsContainerOuterSize},getItemsContainerCrossSize:function(){var n=this._layout._sizes;return n.maxItemsContainerContentSize+n.itemsContainerOuterCrossSize},getItemPositionForAnimations:function(n){var u=this._layout._site.rtl?"right":"left",i=this._layout._sizes.containerMargins,t=this.getItemSize(n),r=this.groupInfo;return{row:t.row,column:t.column,top:i.top+t.row*r.cellHeight,left:i[u]+t.column*r.cellWidth,height:t.contentHeight,width:t.contentWidth}},_layoutItem:function(n){var t=this.getItemSize(n);return this._items[n].style.cssText+=";-ms-grid-row:"+(t.row+1)+";-ms-grid-column:"+(t.column+1)+";-ms-grid-row-span:"+t.rows+";-ms-grid-column-span:"+t.columns+";height:"+t.contentHeight+"px;width:"+t.contentWidth+"px",a.addClass(this._items[n],p._laidOutClass),this._items[n]},_cleanContainers:function(){for(var t=this._items,i=t.length,n=0;n<i;n++)t[n].style.cssText="",a.removeClass(t[n],p._laidOutClass)},getColumnCount:function(){return Math.ceil(this.occupancyMap.length/this._slotsPerColumn)},getOccupancyMapItemCount:function(){var n=-1;return this.occupancyMap.forEach(function(t){t.index>n&&(n=t.index)}),n+1},coordinateToIndex:function(n,t){return n*this._slotsPerColumn+t},markSlotAsFull:function(n,t){for(var u,e,i=this._layout._indexToCoordinate(n,this._slotsPerColumn),f=i.row+t.rows,r=i.row;r<f&&r<this._slotsPerColumn;r++)for(u=i.column,e=i.column+t.columns;u<e;u++)this.occupancyMap[this.coordinateToIndex(u,r)]=t;this._offScreenSlotsPerColumn=Math.max(this._offScreenSlotsPerColumn,f-this._slotsPerColumn)},isSlotEmpty:function(n,t,i){for(var u,e,r=t,f=t+n.rows;r<f;r++)for(u=i,e=i+n.columns;u<e;u++)if(r>=this._slotsPerColumn||this.occupancyMap[this.coordinateToIndex(u,r)]!==undefined)return!1;return!0},findEmptySlot:function(n,t,i){var f=this._layout._indexToCoordinate(n,this._slotsPerColumn),o=f.row,e=Math.floor((this.occupancyMap.length-1)/this._slotsPerColumn),r,u;if(i){for(r=f.column+1;r<=e;r++)if(this.isSlotEmpty(t,0,r))return this.coordinateToIndex(r,0)}else for(r=f.column;r<=e;r++){for(u=o;u<this._slotsPerColumn;u++)if(this.isSlotEmpty(t,u,r))return this.coordinateToIndex(r,u);o=0}return(e+1)*this._slotsPerColumn},findItem:function(n){for(var i,t=n,r=this.occupancyMap.length;t<r;t++)if(i=this.occupancyMap[t],i&&i.index===n)return t;return t},getItemSize:function(n){var i=this.findItem(n),t=this.occupancyMap[i],r=this._layout._indexToCoordinate(i,this._slotsPerColumn);return n===t.index?{row:r.row,column:r.column,contentWidth:t.contentWidth,contentHeight:t.contentHeight,columns:t.columns,rows:t.rows}:null},resetMap:function(){this.occupancyMap=[];this.lastAdded=0;this._offScreenSlotsPerColumn=0},addItemToMap:function(n,t){function f(n,t){var r=i.findEmptySlot(i.lastAdded,n,t);i.lastAdded=r;i.markSlotAsFull(r,n)}var i=this,u=i.groupInfo,r=i._layout._sizes.containerMargins,e={index:n,contentWidth:t.width,contentHeight:t.height,columns:Math.max(1,Math.ceil((t.width+r.left+r.right)/u.cellWidth)),rows:Math.max(1,Math.ceil((t.height+r.top+r.bottom)/u.cellHeight))};f(e,t.newColumn)},indexFromOffset:function(n,t,i){var u=0,e=0,f=this.groupInfo,r=0,o;if(this.occupancyMap.length>0){if(e=this.getOccupancyMapItemCount()-1,u=Math.ceil((this.occupancyMap.length-1)/this._slotsPerColumn)*f.cellWidth,n<u){for(o=this._slotsPerColumn,r=(Math.max(0,Math.floor(n/f.cellWidth))+i)*this._slotsPerColumn-i;!this.occupancyMap[r]&&o-->0;)r+=i>0?-1:1;return{index:r,item:this.occupancyMap[r].index}}r=this.occupancyMap.length-1}return{index:r,item:e+(Math.max(0,Math.floor((n-u)/f.cellWidth))+i)*this._slotsPerColumn-i}}})})});i.Namespace._moduleDefine(n,"WinJS.UI",{ListLayout:i.Namespace._lazy(function(){return i.Class.derive(n._LegacyLayout,function(n){n=n||{};this._itemInfo={};this._groupInfo={};this._groupHeaderPosition=n.groupHeaderPosition||k.top;this._inListMode=!0;this.orientation=n.orientation||"vertical"},{initialize:function(t,i){a.addClass(t.surface,p._listLayoutClass);n._LegacyLayout.prototype.initialize.call(this,t,i)},uninitialize:function(){this._site&&a.removeClass(this._site.surface,p._listLayoutClass);n._LegacyLayout.prototype.uninitialize.call(this)},layout:function(t,i,r,u){return this._groupsEnabled||this._horizontal?n._LegacyLayout.prototype.layout.call(this,t,i,r,u):this._layoutNonGroupedVerticalList(t,i,r,u)},_layoutNonGroupedVerticalList:function(n,t,i,r){var u=this,f="Layout:_layoutNonGroupedVerticalList";return u._site._writeProfilerMark(f+",StartTM"),this._layoutPromise=u._measureItem(0).then(function(){a[u._usingStructuralNodes?"addClass":"removeClass"](u._site.surface,p._structuralNodesClass);a[u._envInfo.nestedFlexTooLarge||u._envInfo.nestedFlexTooSmall?"addClass":"removeClass"](u._site.surface,p._singleItemsBlockClass);u._sizes.viewportContentSize!==u._getViewportCrossSize()&&u._viewportSizeChanged(u._getViewportCrossSize());u._cacheRemovedElements(i,u._cachedItemRecords,u._cachedInsertedItemRecords,u._cachedRemovedItems,!1);u._cacheRemovedElements(r,u._cachedHeaderRecords,u._cachedInsertedHeaderRecords,u._cachedRemovedHeaders,!0);var e=n[0].itemsContainer,t=new g.UniformFlowGroup(u,e);u._groups=[t];t.groupInfo={enableCellSpanning:!1};t.startIndex=0;t.count=at(e);t.offset=0;t.layout();u._site._writeProfilerMark(f+":setSurfaceWidth,info");u._site.surface.style.width=u._sizes.surfaceContentSize+"px";u._layoutAnimations(i,r);u._site._writeProfilerMark(f+":complete,info");u._site._writeProfilerMark(f+",StopTM")},function(n){return u._site._writeProfilerMark(f+":canceled,info"),u._site._writeProfilerMark(f+",StopTM"),s.wrapError(n)}),{realizedRangeComplete:this._layoutPromise,layoutComplete:this._layoutPromise}},numberOfItemsPerItemsBlock:{get:function(){var t=this;return this._measureItem(0).then(function(){return t._envInfo.nestedFlexTooLarge||t._envInfo.nestedFlexTooSmall?(t._usingStructuralNodes=!0,Number.MAX_VALUE):(t._usingStructuralNodes=n.ListLayout._numberOfItemsPerItemsBlock>0,n.ListLayout._numberOfItemsPerItemsBlock)})}}},{_numberOfItemsPerItemsBlock:10})}),CellSpanningLayout:i.Namespace._lazy(function(){return i.Class.derive(n._LayoutCommon,function(n){n=n||{};this._itemInfo=n.itemInfo;this._groupInfo=n.groupInfo;this._groupHeaderPosition=n.groupHeaderPosition||k.top;this._horizontal=!0;this._cellSpanning=!0},{maximumRowsOrColumns:{get:function(){return this._maxRowsOrColumns},set:function(n){this._setMaxRowsOrColumns(n)}},itemInfo:{enumerable:!0,get:function(){return this._itemInfo},set:function(n){this._itemInfo=n;this._invalidateLayout()}},groupInfo:{enumerable:!0,get:function(){return this._groupInfo},set:function(n){this._groupInfo=n;this._invalidateLayout()}},orientation:{enumerable:!0,get:function(){return"horizontal"}}})}),_LayoutWrapper:i.Namespace._lazy(function(){return i.Class.define(function(n){var t,i;this.defaultAnimations=!0;this.initialize=function(t,i){n.initialize(t,i)};this.hitTest=function(t,i){return n.hitTest(t,i)};n.uninitialize&&(this.uninitialize=function(){n.uninitialize()});"numberOfItemsPerItemsBlock"in n&&Object.defineProperty(this,"numberOfItemsPerItemsBlock",{get:function(){return n.numberOfItemsPerItemsBlock}});n._getItemPosition&&(this._getItemPosition=function(t){return n._getItemPosition(t)});n.itemsFromRange&&(this.itemsFromRange=function(t,i){return n.itemsFromRange(t,i)});n.getAdjacent&&(this.getAdjacent=function(t,i){return n.getAdjacent(t,i)});n.dragOver&&(this.dragOver=function(t,i,r){return n.dragOver(t,i,r)});n.dragLeave&&(this.dragLeave=function(){return n.dragLeave()});t={enumerable:!0,get:function(){return"vertical"}};n.orientation!==undefined&&(t.get=function(){return n.orientation},t.set=function(t){n.orientation=t});Object.defineProperty(this,"orientation",t);(n.setupAnimations||n.executeAnimations)&&(this.defaultAnimations=!1,this.setupAnimations=function(){return n.setupAnimations()},this.executeAnimations=function(){return n.executeAnimations()});n.layout&&(this.defaultAnimations?(i=this,this.layout=function(t,r,u,f){var e=dt(n.layout(t,r,[],[])),o;return e.realizedRangeComplete.then(function(){o=!0}),o&&i._layoutAnimations(u,f),e}):this.layout=function(t,i,r,u){return dt(n.layout(t,i,r,u))})},{uninitialize:function(){},numberOfItemsPerItemsBlock:{get:function(){}},layout:function(n,t,i,r){return this.defaultAnimations&&this._layoutAnimations(i,r),dt()},itemsFromRange:function(){return{firstIndex:0,lastIndex:Number.MAX_VALUE}},getAdjacent:function(n,t){switch(t){case b.pageUp:case b.upArrow:case b.leftArrow:return{type:n.type,index:n.index-1};case b.downArrow:case b.rightArrow:case b.pageDown:return{type:n.type,index:n.index+1}}},dragOver:function(){},dragLeave:function(){},setupAnimations:function(){},executeAnimations:function(){},_getItemPosition:function(){},_layoutAnimations:function(){}})})});k={left:"left",top:"top"};i.Namespace._moduleDefine(n,"WinJS.UI",{HeaderPosition:k,_getMargins:yt})}),t("WinJS/Controls/ListView/_VirtualizeContentsView",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Promise","../../_Signal","../../Scheduler","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Utilities/_SafeHtml","../../Utilities/_UI","../ItemContainer/_Constants","../ItemContainer/_ItemEventsHandler","./_Helpers","./_ItemsContainer"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function p(n,t){s._setAttribute(n,"aria-flowto",t.id);s._setAttribute(t,"x-ms-aria-flowfrom",n.id)}i.Namespace._moduleDefine(n,"WinJS.UI",{_VirtualizeContentsView:i.Namespace._lazy(function(){function et(n){for(var t=n.job._workItems,i;t.length&&!n.shouldYield;)i=t.shift(),i();n.setWork(et);t.length||n.job.pause()}function rt(n,t){var i=e.schedule(et,n,null,t);return i._workItems=[],i.addWork=function(n,t){t?this._workItems.unshift(n):this._workItems.push(n);this.resume()},i.clearWork=function(){this._workItems.length=0},i.dispose=function(){this.cancel();this._workItems.length=0},i}function nt(n){return n._zooming||n._pinching}function d(t,i){return t._isZombie()?u.wrap():nt(t)?(+i!==i&&(i=n._waitForSeZoTimeoutDuration),u.timeout(n._waitForSeZoIntervalDuration).then(function(){return(i-=n._waitForSeZoIntervalDuration,i<=0)?!0:d(t,i)})):u.wrap()}function it(n){if(typeof n=="number"){var t=n;n=function(){return{position:t,direction:"right"}}}return n}function w(){}var n=i.Class.define(function(t){this._listView=t;this._forceRelayout=!1;this.maxLeadingPages=r._isiOS?n._iOSMaxLeadingPages:n._defaultPagesToPrefetch;this.maxTrailingPages=r._isiOS?n._iOSMaxTrailingPages:n._defaultPagesToPrefetch;this.items=new y._ItemsContainer(t);this.firstIndexDisplayed=-1;this.lastIndexDisplayed=-1;this.begin=0;this.end=0;this._realizePass=1;this._firstLayoutPass=!0;this._runningAnimations=null;this._renderCompletePromise=u.wrap();this._state=new tt(this);this._createLayoutSignal();this._createTreeBuildingSignal();this._layoutWork=null;this._onscreenJob=rt(e.Priority.aboveNormal,"on-screen items");this._frontOffscreenJob=rt(e.Priority.normal,"front off-screen items");this._backOffscreenJob=rt(e.Priority.belowNormal,"back off-screen items");this._scrollbarPos=0;this._direction="right";this._scrollToFunctor=it(0)},{_dispose:function(){this.cleanUp();this.items=null;this._renderCompletePromise&&this._renderCompletePromise.cancel();this._renderCompletePromise=null;this._onscreenJob.dispose();this._frontOffscreenJob.dispose();this._backOffscreenJob.dispose()},_createItem:function(n,t,i,r){this._listView._writeProfilerMark("createItem("+n+") "+this._getBoundingRectString(n)+",info");var f=this;f._listView._itemsManager._itemFromItemPromiseThrottled(t).done(function(t){t?i(n,t,f._listView._itemsManager._recordFromElement(t)):r(n)},function(t){return r(n),u.wrapError(t)})},_addItem:function(n,t,i,r){if(this._realizePass===r){var u=this._listView._itemsManager._recordFromElement(i);delete this._pendingItemPromises[u.itemPromise.handle];this.items.setItemAt(t,{itemBox:null,container:null,element:i,detached:!0,itemsManagerRecord:u})}},lastItemIndex:function(){return this.containers?this.containers.length-1:-1},_setSkipRealizationForChange:function(t){t?this._realizationLevel!==n._realizationLevel.realize&&(this._realizationLevel=n._realizationLevel.skip):this._realizationLevel=n._realizationLevel.realize},_realizeItems:function(n,t,i,r,o,h,c,v,y,p){function wt(n,t){pt.push(u._cancelBlocker(t.renderComplete));bt(n)}function ot(n,t){function p(n,t){!n.updatedDraggableAttribute&&(w._listView.itemsDraggable||w._listView.itemsReorderable)&&n.itemsManagerRecord.renderComplete.done(function(){w._realizePass===o&&(s.hasClass(t,l._nonDraggableClass)||(n.itemBox.draggable=!0),n.updatedDraggableAttribute=!0)})}var u,f,r,e;if(w._listView._writeProfilerMark("_realizeItems_appendedItemsToDom,StartTM"),!w._listView._isZombie()){for(var h=0,v=-1,y=-1,i=n;i<=t;i++)u=w.items.itemDataAt(i),u&&(f=u.element,r=u.itemBox,r||(r=w._listView._itemBoxTemplate.cloneNode(!0),u.itemBox=r,r.appendChild(f),s.addClass(f,l._itemClass),w._listView._setupAriaSelectionObserver(f),w._listView._isSelected(i)&&a._ItemEventsHandler.renderSelection(r,f,!0,!0),w._listView._currentMode().renderDragSourceOnRealizedItem(i,r)),p(u,f),e=w.getContainer(i),r.parentNode!==e&&(u.container=e,w._appendAndRestoreFocus(e,r),h++,v<0&&(v=i),y=i,w._listView._isSelected(i)&&s.addClass(e,l._selectedClass),s.removeClass(e,l._backdropClass),w.items.elementAvailable(i)));w._listView._writeProfilerMark("_realizeItems_appendedItemsToDom,StopTM");h>0&&(w._listView._writeProfilerMark("_realizeItems_appendedItemsToDom:"+h+" ("+v+"-"+y+"),info"),w._reportElementsLevel(c))}}function ui(n,t,i,r){function f(n,t){var r=w.items.itemDataAt(n),i;return r?(i=r.itemBox,i&&i.parentNode?t?(s.addClass(i.parentNode,l._backdropClass),i.parentNode.removeChild(i),!0):!1:!0):!0}if(!p){for(var u=!1;n>=i;)u=f(n,u),n--;for(u=!1;t<=r;)u=f(t,u),t++}}function it(n,t,i,r,f){function c(n){var r=w.items.itemDataAt(n),t;r&&(t=r.itemsManagerRecord,t.readyComplete||w._realizePass!==o||i.addWork(function(){w._listView._isZombie()||t.pendingReady&&w._realizePass===o&&(w._listView._writeProfilerMark("pendingReady("+n+"),info"),t.pendingReady())},f))}for(var s,h=[],e=n;e<=t;e++)s=w.items.itemDataAt(e),s&&h.push(s.itemsManagerRecord.itemPromise);u.join(h).then(function(){var i;if(r==="right")for(i=n;i<=t;i++)c(i);else for(i=t;i>=n;i--)c(i)})}function bt(n){if(w._realizePass===o){if(n>=v&&n<=y){if(--yt==0){if(ot(v,y),ui(v,y,t,i),w._firstLayoutPass){it(v,y,w._frontOffscreenJob,c==="right"?"left":"right",!0);var r=e.schedulePromiseHigh(null,"WinJS.UI.ListView.entranceAnimation").then(function(){if(!w._listView._isZombie()){w._listView._writeProfilerMark("entranceAnimation,StartTM");var n=w._listView._animateListEntrance(!w._firstEntranceAnimated);return w._firstEntranceAnimated=!0,n}});w._runningAnimations=u.join([w._runningAnimations,r]);w._runningAnimations.done(function(){w._listView._writeProfilerMark("entranceAnimation,StopTM");w._realizePass===o&&(w._runningAnimations=null,g.complete())});w._firstLayoutPass=!1;w._listView._isCurrentZoomView&&e.requestDrain(w._onscreenJob.priority)}else it(v,y,w._frontOffscreenJob,c),g.complete();w._updateHeaders(w._listView._canvas,v,y+1).done(function(){nt.complete()})}}else n<v?(--et,et%ut==0&&ot(t,v-1),et||(w._updateHeaders(w._listView._canvas,t,v).done(function(){c!=="right"&&tt.complete()}),it(t,v-1,c!=="right"?w._frontOffscreenJob:w._backOffscreenJob,"left"))):n>y&&(--ft,ft%ut==0&&ot(y+1,i-1),ft||(w._updateHeaders(w._listView._canvas,y+1,i).then(function(){c==="right"&&tt.complete()}),it(y+1,i-1,c==="right"?w._frontOffscreenJob:w._backOffscreenJob,"right")));rt--;rt===0&&(w._renderCompletePromise=u.join(pt).then(null,function(n){var t=Array.isArray(n)&&n.some(function(n){return n&&!(n instanceof Error&&n.name==="Canceled")});if(t)return u.wrapError(n)}),(w._headerRenderPromises||u.wrap()).done(function(){e.schedule(function(){w._listView._isZombie()?b.cancel():b.complete()},Math.min(w._onscreenJob.priority,w._backOffscreenJob.priority),null,"WinJS.UI.ListView._allItemsRealized")}))}}function fi(t,i,r){if(w._realizePass===o){var i=r.element;w._addItem(n,t,i,o);wt(t,r)}}var k="_realizeItems("+t+"-"+(i-1)+") visible("+v+"-"+y+")",kt,at,ii,ri;this._listView._writeProfilerMark(k+",StartTM");c=c||"right";var rt=i-t,ut=y-v+1,yt=ut,ft=i-y-1,et=v-t,pt=[],g=new f,nt=new f,tt=new f,w=this;if(rt>0){var st=0,ht=0,ei=0;w.firstIndexDisplayed=v;w.lastIndexDisplayed=y;kt=w._listView._isCurrentZoomView;w._highPriorityRealize&&(w._firstLayoutPass||w._hasAnimationInViewportPending)?(w._highPriorityRealize=!1,w._onscreenJob.priority=e.Priority.high,w._frontOffscreenJob.priority=e.Priority.normal,w._backOffscreenJob.priority=e.Priority.belowNormal):w._highPriorityRealize?(w._highPriorityRealize=!1,w._onscreenJob.priority=e.Priority.high,w._frontOffscreenJob.priority=e.Priority.high-1,w._backOffscreenJob.priority=e.Priority.high-1):kt?(w._onscreenJob.priority=e.Priority.aboveNormal,w._frontOffscreenJob.priority=e.Priority.normal,w._backOffscreenJob.priority=e.Priority.belowNormal):(w._onscreenJob.priority=e.Priority.belowNormal,w._frontOffscreenJob.priority=e.Priority.idle,w._backOffscreenJob.priority=e.Priority.idle);var b=new f,dt=w._listView._versionManager.cancelOnNotification(b.promise),gt=function(n,t){t.startStage1&&t.stage0.then(function(){w._realizePass===o&&t.startStage1&&n.addWork(t.startStage1)})},ni=function(n,t){var r=w.items.itemDataAt(t),i;r||(i=w._listView._itemsManager._itemPromiseAtIndex(t),w._pendingItemPromises[i.handle]=i,delete w._previousRealizationPendingItemPromises[i.handle],n.addWork(function(){if(!w._listView._isZombie()&&(st++,w._createItem(t,i,fi,bt),!w._listView._isZombie()&&w._realizePass===o)&&i.handle){var r=w._listView._itemsManager._recordFromHandle(i.handle);gt(n,r)}}))},ct=function(n,t,i){for(var r=t;r<=i;r++)ni(n,r)},lt=function(n,t,i){for(var r=i;r>=t;r--)ni(n,r)},d=function(n,t,i){for(var u,f,r=t;r<=i;r++)u=w.items.itemDataAt(r),u&&(f=u.itemsManagerRecord,wt(r,f),ht++,gt(n,f))};this._previousRealizationPendingItemPromises=this._pendingItemPromises||{};this._pendingItemPromises={};c==="left"?(lt(w._onscreenJob,v,y),lt(w._frontOffscreenJob,t,v-1),at=t>v-1):(ct(w._onscreenJob,v,y),ct(w._frontOffscreenJob,y+1,i-1),at=y+1>i-1);for(var vt=0,ti=Object.keys(this._previousRealizationPendingItemPromises),oi=ti.length;vt<oi;vt++)ii=ti[vt],w._listView._itemsManager.releaseItemPromise(this._previousRealizationPendingItemPromises[ii]);return this._previousRealizationPendingItemPromises={},d(w._onscreenJob,v,y),c==="left"?d(w._frontOffscreenJob,t,v-1):d(w._frontOffscreenJob,y+1,i-1),ri=yt===y-v+1,w._firstLayoutPass?w._listView._canvas.style.opacity=0:ri?w._listView._showProgressBar(w._listView._element,"50%","50%"):w._listView._hideProgressBar(),w._frontOffscreenJob.pause(),w._backOffscreenJob.pause(),nt.promise.done(function(){w._frontOffscreenJob.resume();at&&tt.complete()},function(){b.cancel()}),tt.promise.done(function(){w._listView._writeProfilerMark("frontItemsRealized,info");c==="left"?(ct(w._backOffscreenJob,y+1,i-1),d(w._backOffscreenJob,y+1,i-1)):(lt(w._backOffscreenJob,t,v-1),d(w._backOffscreenJob,t,v-1));w._backOffscreenJob.resume()}),b.promise.done(function(){w._listView._versionManager.clearCancelOnNotification(dt);w._listView._writeProfilerMark(k+" complete(created:"+st+" updated:"+ht+"),info")},function(n){return w._listView._versionManager.clearCancelOnNotification(dt),w._onscreenJob.clearWork(),w._frontOffscreenJob.clearWork(),w._backOffscreenJob.clearWork(),g.cancel(),nt.cancel(),w._listView._writeProfilerMark(k+" canceled(created:"+st+" updated:"+ht+" clean:"+ei+"),info"),u.wrapError(n)}),w._listView._writeProfilerMark(k+",StopTM"),{viewportItemsRealized:nt.promise,allItemsRealized:b.promise,loadingCompleted:u.join([b.promise,g.promise]).then(function(){for(var r,f=[],n=t;n<i;n++)r=w.items.itemDataAt(n),r&&f.push(r.itemsManagerRecord.itemReadyPromise);return u._cancelBlocker(u.join(f))})}}return w._listView._writeProfilerMark(k+",StopTM"),{viewportItemsRealized:u.wrap(),allItemsRealized:u.wrap(),loadingCompleted:u.wrap()}},_setAnimationInViewportState:function(n){var u,r,i,f,t;if(this._hasAnimationInViewportPending=!1,n&&n.length>0)for(u=this._listView._getViewportLength(),r=this._listView._layout.itemsFromRange(this._scrollbarPos,this._scrollbarPos+u-1),i=0,f=n.length;i<f;i++)if(t=n[i],t.newIndex>=r.firstIndex&&t.newIndex<=r.lastIndex&&t.newIndex!==t.oldIndex){this._hasAnimationInViewportPending=!0;break}},_addHeader:function(n,t){var i=this;return this._listView._groups.renderGroup(t).then(function(n){if(n){n.element.tabIndex=0;var r=i._getHeaderContainer(t);n.element.parentNode!==r&&(r.appendChild(n.element),s.addClass(n.element,l._headerClass));i._listView._groups.setDomElement(t,n.element)}})},_updateHeaders:function(n,t,i){function s(t){var i=f._listView._groups.group(t),r;return i&&!i.header?(r=i.headerPromise,r||(r=i.headerPromise=f._addHeader(n,t),r.done(function(){i.headerPromise=null},function(){i.headerPromise=null})),r):u.wrap()}function o(){f._headerRenderPromises=null}var f=this;this._listView._groups.removeElements();var h=this._listView._groups.groupFromItem(t),r=h,c=this._listView._groups.groupFromItem(i-1),e=[];if(r!==null)for(;r<=c;r++)e.push(s(r));return this._headerRenderPromises=u.join(e,this._headerRenderPromises).then(o,o),this._headerRenderPromises||u.wrap()},_unrealizeItem:function(n){var i=this._listView,f,u;this._listView._writeProfilerMark("_unrealizeItem("+n+"),info");u=i._selection._getFocused();u.type===c.ObjectType.item&&u.index===n&&(i._unsetFocusOnItem(),f=!0);var r=this.items.itemDataAt(n),e=r.element,t=r.itemBox;t&&t.parentNode&&(s.removeClass(t.parentNode,l._selectedClass),s.removeClass(t.parentNode,l._footprintClass),s.addClass(t.parentNode,l._backdropClass),t.parentNode.removeChild(t));r.container=null;i._currentMode().itemUnrealized&&i._currentMode().itemUnrealized(n,t);this.items.removeItem(n);r.removed||i._itemsManager.releaseItem(e);o._disposeElement(e);f&&i._setFocusOnItem(i._selection._getFocused())},_unrealizeGroup:function(n){var t=n.header,i,r=this._listView._selection._getFocused();r.type===c.ObjectType.groupHeader&&this._listView._groups.group(r.index)===n&&(this._listView._unsetFocusOnItem(),i=!0);t.parentNode&&t.parentNode.removeChild(t);o._disposeElement(t);n.header=null;n.left=-1;n.top=-1;i&&this._listView._setFocusOnItem(this._listView._selection._getFocused())},_unrealizeItems:function(n){var r=this,s=0,i,u,e,t,o,f;if(this.items.eachIndex(function(t){if(t<r.begin||t>=r.end)return r._unrealizeItem(t),n&&++s>=n}),i=this._listView._groups,u=i.groupFromItem(this.begin),u!==null)for(e=i.groupFromItem(this.end-1),t=0,o=i.length();t<o;t++)f=i.group(t),(t<u||t>e)&&f.header&&this._unrealizeGroup(f)},_unrealizeExcessiveItems:function(){var n=this.items.count(),i=this.end-this.begin,t=i+this._listView._maxDeferredItemCleanup;this._listView._writeProfilerMark("_unrealizeExcessiveItems realized("+n+") approved("+t+"),info");n>t&&this._unrealizeItems(n-t)},_lazilyUnrealizeItems:function(){this._listView._writeProfilerMark("_lazilyUnrealizeItems,StartTM");var n=this;return d(this._listView).then(function(){function o(){n._listView._writeProfilerMark("_lazilyUnrealizeItems,StopTM")}var t,c,i,l,s,a,v;if(n._listView._isZombie()){o();return}t=[];n.items.eachIndex(function(i){(i<n.begin||i>=n.end)&&t.push(i)});n._listView._writeProfilerMark("_lazilyUnrealizeItems itemsToUnrealize("+t.length+"),info");var r=[],f=n._listView._groups,h=f.groupFromItem(n.begin);if(h!==null)for(c=f.groupFromItem(n.end-1),i=0,l=f.length();i<l;i++)s=f.group(i),(i<h||i>c)&&s.header&&r.push(s);return t.length||r.length?(v=new u(function(i){function u(f){var e;if(!n._listView._isZombie()){for(var o=-1,h=-1,c=0,s=nt(n._listView);t.length&&!s&&!f.shouldYield;)e=t.shift(),n._unrealizeItem(e),c++,o<0&&(o=e),h=e;for(n._listView._writeProfilerMark("unrealizeWorker removeItems:"+c+" ("+o+"-"+h+"),info");r.length&&!s&&!f.shouldYield;)n._unrealizeGroup(r.shift());t.length||r.length?s?f.setPromise(d(n._listView).then(function(){return u})):f.setWork(u):i()}}a=e.schedule(u,e.Priority.belowNormal,null,"WinJS.UI.ListView._lazilyUnrealizeItems")}),v.then(o,function(t){return a.cancel(),n._listView._writeProfilerMark("_lazilyUnrealizeItems canceled,info"),n._listView._writeProfilerMark("_lazilyUnrealizeItems,StopTM"),u.wrapError(t)})):(o(),u.wrap())})},_getBoundingRectString:function(n){var i,t;return n>=0&&n<this.containers.length&&(t=this._listView._layout._getItemPosition(n),t&&(i="["+t.left+"; "+t.top+"; "+t.width+"; "+t.height+" ]")),i||""},_clearDeferTimeout:function(){this.deferTimeout&&(this.deferTimeout.cancel(),this.deferTimeout=null);this.deferredActionCancelToken!==-1&&(this._listView._versionManager.clearCancelOnNotification(this.deferredActionCancelToken),this.deferredActionCancelToken=-1)},_setupAria:function(n){function i(){t._listView._writeProfilerMark("aria work,StopTM")}function r(n){var r=t._listView._groups,i=r.group(n+1);return i?Math.min(i.startIndex-1,t.end-1):t.end-1}if(!this._listView._isZombie()){var t=this;return this._listView._createAriaMarkers(),this._listView._itemsCount().then(function(f){if(f>0&&t.firstIndexDisplayed!==-1&&t.lastIndexDisplayed!==-1){t._listView._writeProfilerMark("aria work,StartTM");var y=t._listView._ariaStartMarker,w=t._listView._ariaEndMarker,h=t.begin,o=t.items.itemAt(t.begin),b,a,k,c,l,v;if(o)return s._ensureId(o),t._listView._groupsEnabled()?(a=t._listView._groups,k=c=a.groupFromItem(t.begin),l=a.group(c),v=r(c),s._ensureId(l.header),s._setAttribute(l.header,"role",t._listView._headerRole),s._setAttribute(l.header,"x-ms-aria-flowfrom",y.id),p(l.header,o),s._setAttribute(l.header,"tabindex",t._listView._tabIndex)):s._setAttribute(o,"x-ms-aria-flowfrom",y.id),new u(function(u){var y=n;b=e.schedule(function g(n){var e,b;if(t._listView._isZombie()){i();return}for(;h<t.end;h++){if(!y&&nt(t._listView)){n.setPromise(d(t._listView).then(function(n){return y=n,g}));return}if(n.shouldYield){n.setWork(g);return}if(o=t.items.itemAt(h),e=t.items.itemAt(h+1),e&&s._ensureId(e),s._setAttribute(o,"role",t._listView._itemRole),s._setAttribute(o,"aria-setsize",f),s._setAttribute(o,"aria-posinset",h+1),s._setAttribute(o,"tabindex",t._listView._tabIndex),t._listView._groupsEnabled()?h!==v&&e?p(o,e):(b=a.group(c+1),b&&b.header&&e?(s._setAttribute(b.header,"tabindex",t._listView._tabIndex),s._setAttribute(b.header,"role",t._listView._headerRole),s._ensureId(b.header),p(o,b.header),p(b.header,e)):s._setAttribute(o,"aria-flowto",w.id),c++,l=b,v=r(c)):e?p(o,e):s._setAttribute(o,"aria-flowto",w.id),!e)break}t._listView._fireAccessibilityAnnotationCompleteEvent(t.begin,h,k,c-1);i();u()},e.Priority.belowNormal,null,"WinJS.UI.ListView._setupAria")},function(){b.cancel();i()});i()}else return u.wrap()})}},_setupDeferredActions:function(){function t(){n._listView._isZombie()||(n.deferTimeout=null,n._listView._versionManager.clearCancelOnNotification(n.deferredActionCancelToken),n.deferredActionCancelToken=-1)}this._listView._writeProfilerMark("_setupDeferredActions,StartTM");var n=this;this._clearDeferTimeout();this.deferTimeout=this._lazilyRemoveRedundantItemsBlocks().then(function(){return u.timeout(l._DEFERRED_ACTION)}).then(function(){return d(n._listView)}).then(function(t){return n._setupAria(t)}).then(t,function(n){return t(),u.wrapError(n)});this.deferredActionCancelToken=this._listView._versionManager.cancelOnNotification(this.deferTimeout);this._listView._writeProfilerMark("_setupDeferredActions,StopTM")},_updateAriaMarkers:function(n,t,i){function l(){return o.items.itemAt(t)}function a(){for(var n=i;n>=t;n--)if(o.items.itemAt(n))return o.items.itemAt(n);return null}var o=this,r,h,u,e,c,f;this._listView._isZombie()||(this._listView._createAriaMarkers(),r=this._listView._ariaStartMarker,h=this._listView._ariaEndMarker,t!==-1&&i!==-1&&t<=i&&(u=l(),e=a()),!n&&u&&e?(s._ensureId(u),s._ensureId(e),this._listView._groupsEnabled()?(c=this._listView._groups,f=c.group(c.groupFromItem(t)),f.header&&(s._ensureId(f.header),t===f.startIndex?s._setAttribute(r,"aria-flowto",f.header.id):s._setAttribute(r,"aria-flowto",u.id))):s._setAttribute(r,"aria-flowto",u.id),s._setAttribute(h,"x-ms-aria-flowfrom",e.id)):(p(r,h),this._listView._fireAccessibilityAnnotationCompleteEvent(-1,-1)))},updateAriaForAnnouncement:function(n,t){if(n!==this._listView.header&&n!==this._listView.footer){var i=-1,r=c.ObjectType.item;s.hasClass(n,l._headerClass)?(i=this._listView._groups.index(n),r=c.ObjectType.groupHeader,s._setAttribute(n,"role",this._listView._headerRole),s._setAttribute(n,"tabindex",this._listView._tabIndex)):(i=this.items.index(n),s._setAttribute(n,"aria-setsize",t),s._setAttribute(n,"aria-posinset",i+1),s._setAttribute(n,"role",this._listView._itemRole),s._setAttribute(n,"tabindex",this._listView._tabIndex));r===c.ObjectType.groupHeader?this._listView._fireAccessibilityAnnotationCompleteEvent(-1,-1,i,i):this._listView._fireAccessibilityAnnotationCompleteEvent(i,i,-1,-1)}},_reportElementsLevel:function(n){function t(n,t){for(var u,f=0,i=n;i<=t;i++)u=r.itemDataAt(i),u&&u.container&&f++;return f}var r=this.items,i;i=n==="right"?Math.floor(100*t(this.firstIndexDisplayed,this.end-1)/(this.end-this.firstIndexDisplayed)):Math.floor(100*t(this.begin,this.lastIndexDisplayed)/(this.lastIndexDisplayed-this.begin+1));this._listView._writeProfilerMark("elementsLevel level("+i+"),info")},_createHeaderContainer:function(n){return this._createSurfaceChild(l._headerContainerClass,n)},_createItemsContainer:function(n){var i=this._createSurfaceChild(l._itemsContainerClass,n),r=t.document.createElement("div");return r.className=l._padderClass,i.appendChild(r),i},_ensureContainerInDOM:function(n){var t=this.containers[n];return t&&!this._listView._canvas.contains(t)?(this._forceItemsBlocksInDOM(n,n+1),!0):!1},_ensureItemsBlocksInDOM:function(n,t){if(this._expandedRange){var i=this._expandedRange.first.index,r=this._expandedRange.last.index+1;n<=i&&t>i?t=Math.max(t,r):n<r&&t>=r&&(n=Math.min(n,i))}this._forceItemsBlocksInDOM(n,t)},_removeRedundantItemsBlocks:function(){this.begin!==-1&&this.end!==-1&&this._forceItemsBlocksInDOM(this.begin,this.end)},_lazilyRemoveRedundantItemsBlocks:function(){this._listView._writeProfilerMark("_lazilyRemoveRedundantItemsBlocks,StartTM");var t=this;return d(this._listView).then(function(){function i(){t._listView._writeProfilerMark("_lazilyRemoveRedundantItemsBlocks,StopTM")}if(t._listView._isZombie()){i();return}if(t._expandedRange&&t.begin!==-1&&t.end!==-1&&(t._expandedRange.first.index<t.begin||t._expandedRange.last.index+1>t.end)){var r,f=new u(function(i){function u(r){var f,e,o;if(!t._listView._isZombie()){for(f=nt(t._listView);t._expandedRange.first.index<t.begin&&!f&&!r.shouldYield;)e=Math.min(t.begin,t._expandedRange.first.index+t._blockSize*n._blocksToRelease),t._forceItemsBlocksInDOM(e,t.end);while(t._expandedRange.last.index+1>t.end&&!f&&!r.shouldYield)o=Math.max(t.end,t._expandedRange.last.index-t._blockSize*n._blocksToRelease),t._forceItemsBlocksInDOM(t.begin,o);t._expandedRange.first.index<t.begin||t._expandedRange.last.index+1>t.end?f?r.setPromise(d(t._listView).then(function(){return u})):r.setWork(u):i()}}r=e.schedule(u,e.Priority.belowNormal,null,"WinJS.UI.ListView._lazilyRemoveRedundantItemsBlocks")});return f.then(i,function(n){return r.cancel(),t._listView._writeProfilerMark("_lazilyRemoveRedundantItemsBlocks canceled,info"),t._listView._writeProfilerMark("_lazilyRemoveRedundantItemsBlocks,StopTM"),u.wrapError(n)})}return i(),u.wrap()})},_forceItemsBlocksInDOM:function(n,t){function a(n,t){var i=n.element.firstElementChild;i.style[rt]=t}function w(n){for(var r,u,f,t=0;t<i.tree.length;t++)for(r=i.tree[t].itemsContainer,u=0,f=r.itemsBlocks.length;u<f;u++)if(n(r,r.itemsBlocks[u]))return}function b(n){i._listView._writeProfilerMark("_itemsBlockExtent,StartTM");i._listView._itemsBlockExtent=s[i._listView._horizontal()?"getTotalWidth":"getTotalHeight"](n.element);i._listView._writeProfilerMark("_itemsBlockExtent("+i._listView._itemsBlockExtent+"),info");i._listView._writeProfilerMark("_itemsBlockExtent,StopTM")}function ut(){return i._listView._itemsBlockExtent===-1&&w(function(n,t){return t.items.length===i._blockSize&&t.element.parentNode===n.element?(b(t),!0):!1}),i._listView._itemsBlockExtent===-1&&w(function(n,t){return t.items.length===i._blockSize?(n.element.appendChild(t.element),b(t),n.element.removeChild(t.element),!0):!1}),i._listView._itemsBlockExtent}function c(n,t,i){function u(t){var i=n.itemsBlocks[t];i&&i.element.parentNode===n.element&&(n.element.removeChild(i.element),it++)}if(Array.isArray(t))t.forEach(u);else for(var r=t;r<i;r++)u(r)}function v(n,t,i){for(var r,e=n.element.firstElementChild,f=e,u=t;u<i;u++)r=n.itemsBlocks[u],r&&(r.element.parentNode!==n.element&&(n.element.insertBefore(r.element,f.nextElementSibling),tt++),f=r.element)}function ft(n){if(n<i.tree.length){i._listView._writeProfilerMark("collapseGroup("+n+"),info");var t=i.tree[n].itemsContainer;c(t,0,t.itemsBlocks.length);a(t,"")}}function et(n){if(n<i.tree.length){i._listView._writeProfilerMark("expandGroup("+n+"),info");var t=i.tree[n].itemsContainer;v(t,0,t.itemsBlocks.length);a(t,"")}}function k(n,t){function u(n,t){for(var r=[],i=n;i<=t;i++)r.push(i);return r}var f=t[0],e=t[1],i=n[0],r=n[1];return e<i||f>r?u(i,r):f>i&&e<r?u(i,f-1).concat(u(e+1,r)):i<f?u(i,f-1):r>e?u(e+1,r):null}var p,nt,h,y;if(this._blockSize){p="_forceItemsBlocksInDOM begin("+n+") end("+t+"),";this._listView._writeProfilerMark(p+"StartTM");var i=this,tt=0,it=0,rt="padding"+(this._listView._horizontal()?"Left":"Top");var r=this._listView._groups.groupFromItem(n),u=this._listView._groups.groupFromItem(t-1),d=this._listView._groups.group(r),e=i.tree[r].itemsContainer,f=Math.floor((n-d.startIndex)/this._blockSize),g=this._listView._groups.group(u),l=i.tree[u].itemsContainer,o=Math.floor((t-1-g.startIndex)/this._blockSize);for(f&&i._listView._itemsBlockExtent===-1&&w(function(n,t){return t.items.length===i._blockSize&&t.element.parentNode===n.element?(b(t),!0):!1}),nt=this._expandedRange?k([this._expandedRange.first.groupIndex,this._expandedRange.last.groupIndex],[r,u]):null,nt&&nt.forEach(ft),this._expandedRange&&this._expandedRange.first.groupKey===d.key?(h=k([this._expandedRange.first.block,Number.MAX_VALUE],[f,Number.MAX_VALUE]),h&&c(e,h)):this._expandedRange&&r>=this._expandedRange.first.groupIndex&&r<=this._expandedRange.last.groupIndex&&c(e,0,f),r!==u?(v(e,f,e.itemsBlocks.length),v(l,0,o+1)):v(e,f,o+1),this._expandedRange&&this._expandedRange.last.groupKey===g.key?(h=k([0,this._expandedRange.last.block],[0,o]),h&&c(l,h)):this._expandedRange&&u>=this._expandedRange.first.groupIndex&&u<=this._expandedRange.last.groupIndex&&c(l,o+1,l.itemsBlocks.length),a(e,f?f*ut()+"px":""),r!==u&&a(l,""),y=r+1;y<u;y++)et(y);this._expandedRange={first:{index:n,groupIndex:r,groupKey:d.key,block:f},last:{index:t-1,groupIndex:u,groupKey:g.key,block:o}};this._listView._writeProfilerMark("_forceItemsBlocksInDOM groups("+r+"-"+u+") blocks("+f+"-"+o+") added("+tt+") removed("+it+"),info");this._listView._writeProfilerMark(p+"StopTM")}},_realizePageImpl:function(){var t=this,i="realizePage(scrollPosition:"+this._scrollbarPos+" forceLayout:"+this._forceRelayout+")";return(this._listView._writeProfilerMark(i+",StartTM"),this._listView._versionManager.locked)?(this._listView._versionManager.unlocked.done(function(){t._listView._isZombie()||t._listView._batchViewUpdates(l._ViewChange.realize,l._ScrollToPriority.low,t._listView.scrollPosition)}),this._listView._writeProfilerMark(i+",StopTM"),u.cancel):new u(function(r){function k(){r();nt.complete()}function tt(){t._listView._hideProgressBar();t._state.setLoadingState(t._listView._LoadingState.viewPortLoaded);t._executeAnimations&&t._setState(at,nt.promise)}function it(n){t._updateAriaMarkers(n===0,t.firstIndexDisplayed,t.lastIndexDisplayed);t._state.setLoadingState&&t._state.setLoadingState(t._listView._LoadingState.itemsLoaded)}function y(n){t._listView._clearInsertedItems();t._listView._groups.removeElements();tt();it(n);k()}var nt=new f,e,ut,b,o,st;if(t._state.setLoadingState(t._listView._LoadingState.itemsLoading),t._firstLayoutPass&&t._listView._showProgressBar(t._listView._element,"50%","50%"),e=t.containers.length,e){var d=t.maxLeadingPages,rt=t.maxTrailingPages,p=t._listView._getViewportLength(),l,w;t._listView._zooming?l=w=0:n._disableCustomPagesPrefetch?l=w=n._defaultPagesToPrefetch:(l=t._direction==="left"?d:rt,ut=Math.max(0,l-t._scrollbarPos/p),w=Math.min(d,ut+(t._direction==="right"?d:rt)));var ft=Math.max(0,t._scrollbarPos-l*p),et=t._scrollbarPos+(1+w)*p,h=t._listView._layout.itemsFromRange(ft,et-1);if((h.firstIndex<0||h.firstIndex>=e)&&(h.lastIndex<0||h.lastIndex>=e))t.begin=-1,t.end=-1,t.firstIndexDisplayed=-1,t.lastIndexDisplayed=-1,y(e);else{var a=s._clamp(h.firstIndex,0,e-1),g=s._clamp(h.lastIndex+1,0,e),ot=t._listView._layout.itemsFromRange(t._scrollbarPos,t._scrollbarPos+p-1),c=s._clamp(ot.firstIndex,0,e-1),v=s._clamp(ot.lastIndex,0,e-1);t._realizationLevel!==n._realizationLevel.skip||t.lastRealizePass||c!==t.firstIndexDisplayed||v!==t.lastIndexDisplayed?(t._forceRelayout||a!==t.begin||g!==t.end||c!==t.firstIndexDisplayed||v!==t.lastIndexDisplayed)&&a<g&&ft<et?(t._listView._writeProfilerMark("realizePage currentInView("+c+"-"+v+") previousInView("+t.firstIndexDisplayed+"-"+t.lastIndexDisplayed+") change("+(c-t.firstIndexDisplayed)+"),info"),t._cancelRealize(),b=t._realizePass,t.begin=a,t.end=g,t.firstIndexDisplayed=c,t.lastIndexDisplayed=v,t.deletesWithoutRealize=0,t._ensureItemsBlocksInDOM(t.begin,t.end),o=t._realizeItems(t._listView._itemCanvas,t.begin,t.end,e,b,t._scrollbarPos,t._direction,c,v,t._forceRelayout),t._forceRelayout=!1,st=o.viewportItemsRealized.then(function(){return tt(),o.allItemsRealized}).then(function(){if(t._realizePass===b)return t._updateHeaders(t._listView._canvas,t.begin,t.end).then(function(){it(e)})}).then(function(){return o.loadingCompleted}).then(function(){t._unrealizeExcessiveItems();t.lastRealizePass=null;k()},function(n){return t._realizePass===b&&(t.lastRealizePass=null,t.begin=-1,t.end=-1),u.wrapError(n)}),t.lastRealizePass=u.join([o.viewportItemsRealized,o.allItemsRealized,o.loadingCompleted,st]),t._unrealizeExcessiveItems()):t.lastRealizePass?t.lastRealizePass.then(k):y(e):(t.begin=a,t.end=a+Object.keys(t.items._itemData).length,t._updateHeaders(t._listView._canvas,t.begin,t.end).done(function(){t.lastRealizePass=null;y(e)}))}}else t.begin=-1,t.end=-1,t.firstIndexDisplayed=-1,t.lastIndexDisplayed=-1,y(e);t._reportElementsLevel(t._direction);t._listView._writeProfilerMark(i+",StopTM")})},realizePage:function(n,t,i,r){this._scrollToFunctor=it(n);this._forceRelayout=this._forceRelayout||t;this._scrollEndPromise=i;this._listView._writeProfilerMark(this._state.name+"_realizePage,info");this._state.realizePage(r||ut)},onScroll:function(n,t){this.realizePage(n,!1,t,ct)},reload:function(n,t){this._listView._isZombie()||(this._scrollToFunctor=it(n),this._forceRelayout=!0,this._highPriorityRealize=!!t,this.stopWork(!0),this._listView._writeProfilerMark(this._state.name+"_rebuildTree,info"),this._state.rebuildTree())},refresh:function(n){this._listView._isZombie()||(this._scrollToFunctor=it(n),this._forceRelayout=!0,this._highPriorityRealize=!0,this.stopWork(),this._listView._writeProfilerMark(this._state.name+"_relayout,info"),this._state.relayout())},waitForValidScrollPosition:function(n){var t=this,i=this._listView._viewport[this._listView._scrollLength]-this._listView._getViewportLength();return n>i?t._listView._itemsCount().then(function(i){return t.containers.length<i?u._cancelBlocker(t._creatingContainersWork&&t._creatingContainersWork.promise).then(function(){return t._getLayoutCompleted()}).then(function(){return n}):n}):u.wrap(n)},waitForEntityPosition:function(n){var t=this;return n.type===c.ObjectType.header||n.type===c.ObjectType.footer?u.wrap():(this._listView._writeProfilerMark(this._state.name+"_waitForEntityPosition("+n.type+": "+n.index+"),info"),u._cancelBlocker(this._state.waitForEntityPosition(n).then(function(){if(n.type!==c.ObjectType.groupHeader&&n.index>=t.containers.length||n.type===c.ObjectType.groupHeader&&t._listView._groups.group(n.index).startIndex>=t.containers.length)return t._creatingContainersWork&&t._creatingContainersWork.promise}).then(function(){return t._getLayoutCompleted()})))},stopWork:function(n){this._listView._writeProfilerMark(this._state.name+"_stop,info");this._state.stop(n);this._layoutWork&&this._layoutWork.cancel();n&&this._creatingContainersWork&&this._creatingContainersWork.cancel();n&&(this._state=new tt(this))},_cancelRealize:function(){this._listView._writeProfilerMark("_cancelRealize,StartTM");(this.lastRealizePass||this.deferTimeout)&&(this._forceRelayout=!0);this._clearDeferTimeout();this._realizePass++;this._headerRenderPromises&&(this._headerRenderPromises.cancel(),this._headerRenderPromises=null);var n=this.lastRealizePass;n&&(this.lastRealizePass=null,this.begin=-1,this.end=-1,n.cancel());this._listView._writeProfilerMark("_cancelRealize,StopTM")},resetItems:function(n){if(!this._listView._isZombie()){this.firstIndexDisplayed=-1;this.lastIndexDisplayed=-1;this._runningAnimations=null;this._executeAnimations=!1;var t=this._listView;this._firstLayoutPass=!0;t._unsetFocusOnItem();t._currentMode().onDataChanged&&t._currentMode().onDataChanged();this.items.each(function(i,r){n&&r.parentNode&&r.parentNode.parentNode&&r.parentNode.parentNode.removeChild(r.parentNode);t._itemsManager.releaseItem(r);o._disposeElement(r)});this.items.removeItems();this._deferredReparenting=[];n&&t._groups.removeElements();t._clearInsertedItems()}},reset:function(){if(this.stopWork(!0),this._state=new tt(this),this.resetItems(),!this._listView._isZombie()){var n=this._listView;n._groups.resetGroups();n._resetCanvas();this.tree=null;this.keyToGroupIndex=null;this.containers=null;this._expandedRange=null}},cleanUp:function(){this.stopWork(!0);this._runningAnimations&&this._runningAnimations.cancel();var n=this._listView._itemsManager;this.items.each(function(t,i){n.releaseItem(i);o._disposeElement(i)});this._listView._unsetFocusOnItem();this.items.removeItems();this._deferredReparenting=[];this._listView._groups.resetGroups();this._listView._resetCanvas();this.tree=null;this.keyToGroupIndex=null;this.containers=null;this._expandedRange=null;this.destroyed=!0},getContainer:function(n){return this.containers[n]},_getHeaderContainer:function(n){return this.tree[n].header},_getGroups:function(n){var i,r,t,u,f,e;if(this._listView._groupDataSource){if(i=this._listView._groups.groups,r=[],n)for(t=0,u=i.length;t<u;t++)f=i[t],e=t+1<u?i[t+1].startIndex:n,r.push({key:f.key,size:e-f.startIndex});return r}return[{key:"-1",size:n}]},_createChunk:function(n,t,i){function e(n,t){var e=n.element.children,s=e.length,o=Math.min(t-n.items.length,i),u,f;for(h.insertAdjacentHTMLUnsafe(n.element,"beforeend",v._repeat("<div class='win-container win-backdrop'><\/div>",o)),u=0;u<o;u++)f=e[s+u],n.items.push(f),r.containers.push(f)}function o(n){var t={header:r._listView._groupDataSource?r._createHeaderContainer():null,itemsContainer:{element:r._createItemsContainer(),items:[]}};r.tree.push(t);r.keyToGroupIndex[n.key]=r.tree.length-1;e(t.itemsContainer,n.size)}var r=this,u,f;if(this._listView._writeProfilerMark("createChunk,StartTM"),this.tree.length&&this.tree.length<=n.length&&(u=this.tree[this.tree.length-1],f=n[this.tree.length-1].size,u.itemsContainer.items.length<f)){e(u.itemsContainer,f);this._listView._writeProfilerMark("createChunk,StopTM");return}this.tree.length<n.length&&o(n[this.tree.length]);this._listView._writeProfilerMark("createChunk,StopTM")},_createChunkWithBlocks:function(n,i,r,u){function s(n,i){var e,o=n.itemsBlocks.length?n.itemsBlocks[n.itemsBlocks.length-1]:null,c,k,it,l,g,a,y,nt,p,w;if(i=Math.min(i,u),o&&o.items.length<r){var b=Math.min(i,r-o.items.length),tt=o.items.length,e=(n.itemsBlocks.length-1)*r+tt,rt=v._stripedContainers(b,e);for(h.insertAdjacentHTMLUnsafe(o.element,"beforeend",rt),a=o.element.children,c=0;c<b;c++)k=a[tt+c],o.items.push(k),f.containers.push(k);i-=b}e=n.itemsBlocks.length*r;var s=Math.floor(i/r),d="",ut=e,ft=e+r;for(s>0&&(it=["<div class='win-itemsblock'>"+v._stripedContainers(r,ut)+"<\/div>","<div class='win-itemsblock'>"+v._stripedContainers(r,ft)+"<\/div>"],d=v._repeat(it,s),e+=s*r),l=i%r,l>0&&(d+="<div class='win-itemsblock'>"+v._stripedContainers(l,e)+"<\/div>",e+=l,s++),g=t.document.createElement("div"),h.setInnerHTMLUnsafe(g,d),a=g.children,y=0;y<s;y++)for(nt=a[y],p={element:nt,items:v._nodeListToArray(nt.children)},n.itemsBlocks.push(p),w=0;w<p.items.length;w++)f.containers.push(p.items[w])}function l(n){var t={header:f._listView._groupDataSource?f._createHeaderContainer():null,itemsContainer:{element:f._createItemsContainer(),itemsBlocks:[]}};f.tree.push(t);f.keyToGroupIndex[n.key]=f.tree.length-1;s(t.itemsContainer,n.size)}var f=this;if(this._listView._writeProfilerMark("createChunk,StartTM"),this.tree.length&&this.tree.length<=n.length){var e=this.tree[this.tree.length-1].itemsContainer,c=n[this.tree.length-1].size,o=0;if(e.itemsBlocks.length&&(o=(e.itemsBlocks.length-1)*r+e.itemsBlocks[e.itemsBlocks.length-1].items.length),o<c){s(e,c-o);this._listView._writeProfilerMark("createChunk,StopTM");return}}this.tree.length<n.length&&l(n[this.tree.length]);this._listView._writeProfilerMark("createChunk,StopTM")},_generateCreateContainersWorker:function(){var t=this,f=0,i=!1;return function u(e){t._listView._versionManager.locked?e.setPromise(t._listView._versionManager.unlocked.then(function(){return u})):t._listView._itemsCount().then(function(o){var c=!i&&nt(t._listView);if(c)e.setPromise(d(t._listView).then(function(n){return i=n,u}));else{if(t._listView._isZombie())return;i=!1;var l=r._now()+n._createContainersJobTimeslice,s=t._getGroups(o),a=t.containers.length,v=t.end===t.containers.length,h=n._chunkSize;do t._blockSize?t._createChunkWithBlocks(s,o,t._blockSize,h):t._createChunk(s,o,h),f++;while(t.containers.length<o&&r._now()<l);t._listView._writeProfilerMark("createContainers yields containers("+t.containers.length+"),info");t._listView._affectedRange.add({start:a,end:t.containers.length},o);v?(t.stopWork(),t._listView._writeProfilerMark(t._state.name+"_relayout,info"),t._state.relayout()):(t._listView._writeProfilerMark(t._state.name+"_layoutNewContainers,info"),t._state.layoutNewContainers());t.containers.length<o?e.setWork(u):(t._listView._writeProfilerMark("createContainers completed steps("+f+"),info"),t._creatingContainersWork.complete())}})}},_scheduleLazyTreeCreation:function(){return e.schedule(this._generateCreateContainersWorker(),e.Priority.idle,this,"WinJS.UI.ListView.LazyTreeCreation")},_createContainers:function(){this.tree=null;this.keyToGroupIndex=null;this.containers=null;this._expandedRange=null;var t=this,i;return this._listView._itemsCount().then(function(n){return n===0&&t._listView._hideProgressBar(),i=n,t._listView._writeProfilerMark("createContainers("+i+"),StartTM"),t._listView._groupDataSource?t._listView._groups.initialize():void 0}).then(function(){return t._listView._writeProfilerMark("numberOfItemsPerItemsBlock,StartTM"),i&&t._listView._groups.length()?t._listView._layout.numberOfItemsPerItemsBlock:null}).then(function(u){var s;t._listView._writeProfilerMark("numberOfItemsPerItemsBlock("+u+"),info");t._listView._writeProfilerMark("numberOfItemsPerItemsBlock,StopTM");t._listView._resetCanvas();t.tree=[];t.keyToGroupIndex={};t.containers=[];t._blockSize=u;var f=t._getGroups(i),h=r._now()+n._maxTimePerCreateContainers,e=Math.min(n._startupChunkSize,n._chunkSize),o;do o=u?t._createChunkWithBlocks(f,i,u,e):t._createChunk(f,i,e);while(r._now()<h&&t.containers.length<i&&!o);t._listView._writeProfilerMark("createContainers created("+t.containers.length+"),info");t._listView._affectedRange.add({start:0,end:t.containers.length},i);t.containers.length<i?(s=t._scheduleLazyTreeCreation(),t._creatingContainersWork.promise.done(null,function(){s.cancel()})):(t._listView._writeProfilerMark("createContainers completed synchronously,info"),t._creatingContainersWork.complete());t._listView._writeProfilerMark("createContainers("+i+"),StopTM")})},_updateItemsBlocks:function(n){function u(){var n=t.document.createElement("div");return n.className=l._itemsBlockClass,n}function o(t,r){function l(){var n,u;for(t.itemsBlocks=null,t.items=[],n=0;n<s;n++)u=i.containers[r+n],t.element.appendChild(u),t.items.push(u)}function a(){var f,e,c,h;for(t.itemsBlocks=[{element:o.length?o.shift():u(),items:[]}],f=t.itemsBlocks[0],e=0;e<s;e++)f.items.length===n&&(c=o.length?o.shift():u(),t.itemsBlocks.push({element:c,items:[]}),f=t.itemsBlocks[t.itemsBlocks.length-1]),h=i.containers[r+e],f.element.appendChild(h),f.items.push(h);t.items=null}var o=[],s=0,h=t.itemsBlocks,f,c;if(h)for(f=0;f<h.length;f++)s+=h[f].items.length,o.push(h[f].element);else s=t.items.length;for(e?a():l(),f=0;f<o.length;f++)c=o[f],c.parentNode===t.element&&t.element.removeChild(c);return s}for(var i=this,e=!!n,r=0,f=0;r<this.tree.length;r++)f+=o(this.tree[r].itemsContainer,f);i._blockSize=n},_layoutItems:function(){var n=this;return this._listView._itemsCount().then(function(){return u.as(n._listView._layout.numberOfItemsPerItemsBlock).then(function(t){n._listView._writeProfilerMark("numberOfItemsPerItemsBlock("+t+"),info");t!==n._blockSize&&(n._updateItemsBlocks(t),n._listView._itemsBlockExtent=-1);var i=n._listView._affectedRange.get(),r;return i&&(r={firstIndex:Math.max(i.start-1,0),lastIndex:Math.min(n.containers.length-1,i.end)},r.firstIndex<n.containers.length||n.containers.length===0)?n._listView._layout.layout(n.tree,r,n._modifiedElements||[],n._modifiedGroups||[]):(n._listView._affectedRange.clear(),{realizedRangeComplete:u.wrap(),layoutComplete:u.wrap()})})})},updateTree:function(n,t,i){return this._listView._writeProfilerMark(this._state.name+"_updateTree,info"),this._state.updateTree(n,t,i)},_updateTreeImpl:function(n,i,r,u){function y(n){for(var i,t=0,r=n.length;t<r;t++)i=n[t],i.parentNode.removeChild(i)}var e,c,f,h,o,v;if(this._executeAnimations=!0,this._modifiedElements=r,!r.handled){for(r.handled=!0,this._listView._writeProfilerMark("_updateTreeImpl,StartTM"),e=this,u||this._unrealizeItems(),f=0,h=r.length;f<h;f++)r[f]._itemBox&&r[f]._itemBox.parentNode&&s.removeClass(r[f]._itemBox.parentNode,l._selectedClass);for(this.items.each(function(n,t,i){i.container&&s.removeClass(i.container,l._selectedClass);i.container&&s.addClass(i.container,l._backdropClass)}),c=this._listView._updateContainers(this._getGroups(n),n,i,r),y(c.removedHeaders),y(c.removedItemsContainers),f=0,h=r.length;f<h;f++)if(o=r[f],o.newIndex!==-1){if(o.element=this.getContainer(o.newIndex),!o.element)throw"Container missing after updateContainers.";}else s.removeClass(o.element,l._backdropClass);v=t.document.activeElement;this._listView._canvas.contains(v)&&(this._requireFocusRestore=v);this._deferredReparenting=[];this.items.each(function(n,t,i){var r=e.getContainer(n),u=i.itemBox;u&&r&&(i.container=r,u.parentNode!==r&&(n>=e.firstIndexDisplayed&&n<=e.lastIndexDisplayed?e._appendAndRestoreFocus(r,u):e._deferredReparenting.push({itemBox:u,container:r})),s.removeClass(r,l._backdropClass),s[e._listView.selection._isIncluded(n)?"addClass":"removeClass"](r,l._selectedClass),!e._listView.selection._isIncluded(n)&&s.hasClass(u,l._selectedClass)&&a._ItemEventsHandler.renderSelection(u,i.element,!1,!0))});this._listView._writeProfilerMark("_updateTreeImpl,StopTM")}},_completeUpdateTree:function(){var n,i,r,t;if(this._deferredReparenting&&(n=this._deferredReparenting.length,n>0)){for(i="_completeReparenting("+n+")",this._listView._writeProfilerMark(i+",StartTM"),t=0;t<n;t++)r=this._deferredReparenting[t],this._appendAndRestoreFocus(r.container,r.itemBox);this._deferredReparenting=[];this._listView._writeProfilerMark(i+",StopTM")}this._requireFocusRestore=null},_appendAndRestoreFocus:function(n,i){var r,u;i.parentNode!==n&&(this._requireFocusRestore&&(r=t.document.activeElement),this._requireFocusRestore&&this._requireFocusRestore===r&&(n.contains(r)||i.contains(r))&&(this._listView._unsetFocusOnItem(),r=t.document.activeElement),s.empty(n),n.appendChild(i),this._requireFocusRestore&&r===this._listView._keyboardEventsHelper&&(u=this._listView._selection._getFocused(),u.type===c.ObjectType.item&&this.items.itemBoxAt(u.index)===i&&(s._setActive(this._requireFocusRestore),this._requireFocusRestore=null)))},_startAnimations:function(){var n;return this._listView._writeProfilerMark("startAnimations,StartTM"),n=this,this._hasAnimationInViewportPending=!1,u.as(this._listView._layout.executeAnimations()).then(function(){n._listView._writeProfilerMark("startAnimations,StopTM")})},_setState:function(n,t){if(!this._listView._isZombie()){var i=this._state.name;this._state=new n(this,t);this._listView._writeProfilerMark(this._state.name+"_enter from("+i+"),info");this._state.enter()}},getAdjacent:function(n,t){var i=this;return this.waitForEntityPosition(n).then(function(){return i._listView._layout.getAdjacent(n,t)})},hitTest:function(n,t){if(this._realizedRangeLaidOut)return{index:-1,insertAfterIndex:-1};var i=this._listView._layout.hitTest(n,t);return i.index=s._clamp(i.index,-1,this._listView._cachedCount-1,0),i.insertAfterIndex=s._clamp(i.insertAfterIndex,-1,this._listView._cachedCount-1,0),i},_createTreeBuildingSignal:function(){if(!this._creatingContainersWork){this._creatingContainersWork=new f;var n=this;this._creatingContainersWork.promise.done(function(){n._creatingContainersWork=null},function(){n._creatingContainersWork=null})}},_createLayoutSignal:function(){var n=this;this._layoutCompleted||(this._layoutCompleted=new f,this._layoutCompleted.promise.done(function(){n._layoutCompleted=null},function(){n._layoutCompleted=null}));this._realizedRangeLaidOut||(this._realizedRangeLaidOut=new f,this._realizedRangeLaidOut.promise.done(function(){n._realizedRangeLaidOut=null},function(){n._realizedRangeLaidOut=null}))},_getLayoutCompleted:function(){return this._layoutCompleted?u._cancelBlocker(this._layoutCompleted.promise):u.wrap()},_createSurfaceChild:function(n,i){var r=t.document.createElement("div");return r.className=n,this._listView._canvas.insertBefore(r,i?i.nextElementSibling:null),r},_executeScrollToFunctor:function(){var n=this;return u.as(this._scrollToFunctor?this._scrollToFunctor():null).then(function(t){n._scrollToFunctor=null;t=t||{};+t.position===t.position&&(n._scrollbarPos=t.position);n._direction=t.direction||"right"})}},{_defaultPagesToPrefetch:2,_iOSMaxLeadingPages:6,_iOSMaxTrailingPages:2,_disableCustomPagesPrefetch:!1,_waitForSeZoIntervalDuration:100,_waitForSeZoTimeoutDuration:500,_chunkSize:500,_startupChunkSize:100,_maxTimePerCreateContainers:5,_createContainersJobTimeslice:15,_blocksToRelease:10,_realizationLevel:{skip:"skip",realize:"realize",normal:"normal"}}),tt=i.Class.define(function(n){this.view=n;this.view._createTreeBuildingSignal();this.view._createLayoutSignal()},{name:"CreatedState",enter:function(){this.view._createTreeBuildingSignal();this.view._createLayoutSignal()},stop:w,realizePage:w,rebuildTree:function(){this.view._setState(k)},relayout:function(){this.view._setState(k)},layoutNewContainers:w,waitForEntityPosition:function(){return this.view._setState(k),this.view._getLayoutCompleted()},updateTree:w}),k=i.Class.define(function(n){this.view=n},{name:"BuildingState",enter:function(){this.canceling=!1;this.view._createTreeBuildingSignal();this.view._createLayoutSignal();var n=this,t=new f;this.promise=t.promise.then(function(){return n.view._createContainers()}).then(function(){n.view._setState(g)},function(t){return n.canceling||(n.view._setState(tt),n.view._listView._raiseViewComplete()),u.wrapError(t)});t.complete()},stop:function(){this.canceling=!0;this.promise.cancel();this.view._setState(tt)},realizePage:w,rebuildTree:function(){this.canceling=!0;this.promise.cancel();this.enter()},relayout:w,layoutNewContainers:w,waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:w}),g=i.Class.define(function(n,t){this.view=n;this.nextStateType=t||ut},{name:"LayingoutState",enter:function(){var n=this,t;this.canceling=!1;this.view._createLayoutSignal();this.view._listView._writeProfilerMark(this.name+"_enter_layoutItems,StartTM");t=new f;this.promise=t.promise.then(function(){return n.view._layoutItems()}).then(function(t){return n.view._layoutWork=t.layoutComplete,t.realizedRangeComplete}).then(function(){n.view._listView._writeProfilerMark(n.name+"_enter_layoutItems,StopTM");n.view._listView._clearInsertedItems();n.view._setAnimationInViewportState(n.view._modifiedElements);n.view._modifiedElements=[];n.view._modifiedGroups=[];n.view._realizedRangeLaidOut.complete();n.view._layoutWork.then(function(){n.view._listView._writeProfilerMark(n.name+"_enter_layoutCompleted,info");n.view._listView._affectedRange.clear();n.view._layoutCompleted.complete()});n.canceling||n.view._setState(n.nextStateType)},function(t){return n.view._listView._writeProfilerMark(n.name+"_enter_layoutCanceled,info"),n.canceling||(n.view.firstIndexDisplayed=n.view.lastIndexDisplayed=-1,n.view._updateAriaMarkers(!0,n.view.firstIndexDisplayed,n.view.lastIndexDisplayed),n.view._setState(ot)),u.wrapError(t)});t.complete();this.canceling&&this.promise.cancel()},cancelLayout:function(n){this.view._listView._writeProfilerMark(this.name+"_cancelLayout,info");this.canceling=!0;this.promise&&this.promise.cancel();n&&this.view._setState(ht)},stop:function(){this.cancelLayout(!0)},realizePage:w,rebuildTree:function(){this.cancelLayout(!1);this.view._setState(k)},relayout:function(){this.cancelLayout(!1);this.enter()},layoutNewContainers:function(){this.relayout()},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i)}}),ht=i.Class.define(function(n){this.view=n},{name:"LayoutCanceledState",enter:w,stop:w,realizePage:function(){this.relayout()},rebuildTree:function(){this.view._setState(k)},relayout:function(){this.view._setState(g)},layoutNewContainers:function(){this.relayout()},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i)}}),ut=i.Class.define(function(n){this.view=n;this.nextState=ft;this.relayoutNewContainers=!0},{name:"RealizingState",enter:function(){var n=this,t=new f;this.promise=t.promise.then(function(){return n.view._executeScrollToFunctor()}).then(function(){return n.relayoutNewContainers=!1,u._cancelBlocker(n.view._realizePageImpl())}).then(function(){n.view._state===n&&(n.view._completeUpdateTree(),n.view._listView._writeProfilerMark("RealizingState_to_UnrealizingState"),n.view._setState(n.nextState))},function(t){return n.view._state!==n||n.canceling||(n.view._listView._writeProfilerMark("RealizingState_to_CanceledState"),n.view._setState(b)),u.wrapError(t)});t.complete()},stop:function(){this.canceling=!0;this.promise.cancel();this.view._cancelRealize();this.view._setState(b)},realizePage:function(){this.canceling=!0;this.promise.cancel();this.enter()},rebuildTree:function(){this.stop();this.view._setState(k)},relayout:function(){this.stop();this.view._setState(g)},layoutNewContainers:function(){this.relayoutNewContainers?this.relayout():(this.view._createLayoutSignal(),this.view._relayoutInComplete=!0)},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i)},setLoadingState:function(n){this.view._listView._setViewState(n)}}),b=i.Class.define(function(n){this.view=n},{name:"CanceledState",enter:w,stop:function(){this.view._cancelRealize()},realizePage:function(n){this.stop();this.view._setState(n)},rebuildTree:function(){this.stop();this.view._setState(k)},relayout:function(n){this.stop();this.view._setState(g,n)},layoutNewContainers:function(){this.relayout(b)},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i)}}),ct=i.Class.derive(ut,function(n){this.view=n;this.nextState=lt;this.relayoutNewContainers=!0},{name:"ScrollingState",setLoadingState:function(){}}),lt=i.Class.derive(b,function(n){this.view=n},{name:"ScrollingPausedState",enter:function(){var n=this;this.promise=u._cancelBlocker(this.view._scrollEndPromise).then(function(){n.view._setState(ft)})},stop:function(){this.promise.cancel();this.view._cancelRealize()}}),ft=i.Class.define(function(n){this.view=n},{name:"UnrealizingState",enter:function(){var n=this;this.promise=this.view._lazilyUnrealizeItems().then(function(){return n.view._listView._writeProfilerMark("_renderCompletePromise wait starts,info"),n.view._renderCompletePromise}).then(function(){n.view._setState(ot)})},stop:function(){this.view._cancelRealize();this.promise.cancel();this.view._setState(b)},realizePage:function(n){this.promise.cancel();this.view._setState(n)},rebuildTree:function(){this.view._setState(k)},relayout:function(){this.view._setState(g)},layoutNewContainers:function(){this.view._createLayoutSignal();this.view._relayoutInComplete=!0},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i)}}),at=i.Class.define(function(n,t){this.view=n;this.realizePromise=t;this.realizeId=1},{name:"RealizingAnimatingState",enter:function(){var n=this;this.animating=!0;this.animatePromise=this.view._startAnimations();this.animateSignal=new f;this.view._executeAnimations=!1;this.animatePromise.done(function(){n.animating=!1;n.modifiedElements?(n.view._updateTreeImpl(n.count,n.delta,n.modifiedElements),n.modifiedElements=null,n.view._setState(b)):n.animateSignal.complete()},function(t){return n.animating=!1,u.wrapError(t)});this._waitForRealize()},_waitForRealize:function(){var n=this,t;this.realizing=!0;this.realizePromise.done(function(){n.realizing=!1});t=++this.realizeId;u.join([this.realizePromise,this.animateSignal.promise]).done(function(){t===n.realizeId&&(n.view._completeUpdateTree(),n.view._listView._writeProfilerMark("RealizingAnimatingState_to_UnrealizingState"),n.view._setState(ft))})},stop:function(n){this.realizePromise.cancel();this.view._cancelRealize();n&&(this.animatePromise.cancel(),this.view._setState(b))},realizePage:function(){if(!this.modifiedElements){var n=this;this.realizePromise=this.view._executeScrollToFunctor().then(function(){return u._cancelBlocker(n.view._realizePageImpl())});this._waitForRealize()}},rebuildTree:function(){this.stop(!0);this.view._setState(k)},relayout:function(){this.stop(!0);this.modifiedElements&&(this.view._updateTreeImpl(this.count,this.delta,this.modifiedElements),this.modifiedElements=null);this.view._setState(g)},layoutNewContainers:function(){this.view._createLayoutSignal();this.view._relayoutInComplete=!0},waitForEntityPosition:function(){return this.view._getLayoutCompleted()},updateTree:function(n,t,i){if(this.animating){var r=this.modifiedElements;return this.count=n,this.delta=t,this.modifiedElements=i,r?u.cancel:this.animatePromise}return this.view._updateTreeImpl(n,t,i)},setLoadingState:function(n){this.view._listView._setViewState(n)}}),ot=i.Class.derive(b,function(n){this.view=n},{name:"CompletedState",enter:function(){this._stopped=!1;this.view._setupDeferredActions();this.view._realizationLevel=n._realizationLevel.normal;this.view._listView._raiseViewComplete();this.view._state===this&&this.view._relayoutInComplete&&!this._stopped&&this.view._setState(st)},stop:function(){this._stopped=!0;b.prototype.stop.call(this)},layoutNewContainers:function(){this.view._createLayoutSignal();this.view._setState(st)},updateTree:function(n,t,i){return this.view._updateTreeImpl(n,t,i,!0)}}),st=i.Class.derive(b,function(n){this.view=n},{name:"LayingoutNewContainersState",enter:function(){var n=this;this.promise=u.join([this.view.deferTimeout,this.view._layoutWork]);this.promise.then(function(){n.view._relayoutInComplete=!1;n.relayout(b)})},stop:function(){this.promise.cancel();this.view._cancelRealize()},realizePage:function(n){this.stop();this.view._setState(g,n)},layoutNewContainers:function(){this.view._createLayoutSignal()}});return n})})}),t("require-style!less/styles-listview",[],function(){}),t("require-style!less/colors-listview",[],function(){}),t("WinJS/Controls/ListView",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Animations/_TransitionAnimation","../BindingList","../Promise","../Scheduler","../_Signal","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_ItemsManager","../Utilities/_SafeHtml","../Utilities/_TabContainer","../Utilities/_UI","../Utilities/_VersionManager","./ItemContainer/_Constants","./ItemContainer/_ItemEventsHandler","./ListView/_BrowseMode","./ListView/_ErrorMessages","./ListView/_GroupFocusCache","./ListView/_GroupsContainer","./ListView/_Helpers","./ListView/_ItemsContainer","./ListView/_Layouts","./ListView/_SelectionManager","./ListView/_VirtualizeContentsView","require-style!less/styles-listview","require-style!less/colors-listview"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){"use strict";function dt(){var n=yt;yt=[];n=n.filter(function(n){return n._isZombie()?(n._dispose(),!1):!0});yt=yt.concat(n)}function gt(n){yt.push(n);bt&&bt.cancel();bt=l.timeout(ti).then(dt)}function ni(n){return n.offsetParent?n.offsetParent.offsetWidth-n.offsetLeft-n.offsetWidth:0}var pt=i._browserStyleEquivalents.transform,ti=1e3,yt=[],bt,vt=w._uniqueID,kt={get notCompatibleWithSemanticZoom(){return"ListView can only be used with SemanticZoom if randomAccess loading behavior is specified."},get listViewInvalidItem(){return"Item must provide index, key or description of corresponding item."},get listViewViewportAriaLabel(){return e._getWinJSString("ui/listViewViewportAriaLabel").value}},ii=i.requireSupportedForProcessing,wt={entrance:"entrance",contentTransition:"contentTransition"};t.Namespace.define("WinJS.UI",{ListViewAnimationType:wt,ListView:t.Namespace._lazy(function(){var b=t.Class.define(function(){this.clear()},{add:function(n,t){if(n._lastKnownSizeOfData=t,this._range){this._range.start=Math.min(this._range.start,n.start);var i=this._range._lastKnownSizeOfData-this._range.end,r=n._lastKnownSizeOfData-n.end,u=Math.min(i,r);this._range._lastKnownSizeOfData=n._lastKnownSizeOfData;this._range.end=this._range._lastKnownSizeOfData-u}else this._range=n},addAll:function(){this.add({start:0,end:Number.MAX_VALUE},Number.MAX_VALUE)},clear:function(){this._range=null},get:function(){return this._range}}),ht=t.Class.define(function(n){this._listView=n},{getPanAxis:function(){return this._listView._getPanAxis()},configureForZoom:function(n,t,i,r){this._listView._configureForZoom(n,t,i,r)},setCurrentItem:function(n,t){this._listView._setCurrentItem(n,t)},getCurrentItem:function(){return this._listView._getCurrentItem()},beginZoom:function(){return this._listView._beginZoom()},positionItem:function(n,t){return this._listView._positionItem(n,t)},endZoom:function(n){this._listView._endZoom(n)},pinching:{get:function(){return this._listView._pinching},set:function(n){this._listView._pinching=n}}}),e=t.Class.define(function(t,i){if(t=t||n.document.createElement("div"),this._id=t.id||"",this._writeProfilerMark("constructor,StartTM"),i=i||{},t.winControl=this,w.addClass(t,"win-disposable"),this._affectedRange=new b,this._mutationObserver=new w._MutationObserver(this._itemPropertyChange.bind(this)),this._versionManager=null,this._insertedItems={},this._element=t,this._startProperty=null,this._scrollProperty=null,this._scrollLength=null,this._scrolling=!1,this._zooming=!1,this._pinching=!1,this._itemsManager=null,this._canvas=null,this._cachedCount=it._UNINITIALIZED,this._loadingState=this._LoadingState.complete,this._firstTimeDisplayed=!0,this._currentScrollPosition=0,this._lastScrollPosition=0,this._notificationHandlers=[],this._itemsBlockExtent=-1,this._lastFocusedElementInGroupTrack={type:nt.ObjectType.item,index:-1},this._headerFooterVisibilityStatus={headerVisible:!1,footerVisible:!1},this._viewportWidth=it._UNINITIALIZED,this._viewportHeight=it._UNINITIALIZED,this._manipulationState=w._MSManipulationEvent.MS_MANIPULATION_STATE_STOPPED,this._maxDeferredItemCleanup=Number.MAX_VALUE,this._groupsToRemove={},this._setupInternalTree(),this._isCurrentZoomView=!0,this._dragSource=!1,this._reorderable=!1,this._groupFocusCache=new et._UnsupportedGroupFocusCache,this._viewChange=it._ViewChange.rebuild,this._scrollToFunctor=null,this._setScrollbarPosition=!1,this._view=new at._VirtualizeContentsView(this),this._selection=new lt._SelectionManager(this),this._createTemplates(),this._groupHeaderRenderer=k._trivialHtmlRenderer,this._itemRenderer=k._trivialHtmlRenderer,this._groupHeaderRelease=null,this._itemRelease=null,i.itemDataSource)this._dataSource=i.itemDataSource;else{var r=new c.List;this._dataSource=r.dataSource}this._selectionMode=nt.SelectionMode.multi;this._tap=nt.TapBehavior.invokeOnly;this._groupHeaderTap=nt.GroupHeaderTapBehavior.invoke;this._mode=new ut._SelectionMode(this);this._groups=new ot._NoGroups(this);this._updateItemsAriaRoles();this._updateGroupHeadersAriaRoles();this._element.setAttribute("aria-multiselectable",this._multiSelection());this._element.tabIndex=-1;this._tabManager.tabIndex=this._tabIndex;this._element.style.position!=="absolute"&&this._element.style.position!=="relative"&&(this._element.style.position="relative");this._updateItemsManager();i.layout||this._updateLayout(new ct.GridLayout);this._attachEvents();this._runningInit=!0;y.setOptions(this,i);this._runningInit=!1;this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0);this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},layout:{get:function(){return this._layoutImpl},set:function(n){this._updateLayout(n);this._runningInit||(this._view.reset(),this._updateItemsManager(),this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0,!0))}},maxLeadingPages:{get:function(){return this._view.maxLeadingPages},set:function(n){this._view.maxLeadingPages=Math.max(0,Math.floor(n))}},maxTrailingPages:{get:function(){return this._view.maxTrailingPages},set:function(n){this._view.maxTrailingPages=Math.max(0,Math.floor(n))}},pagesToLoad:{get:function(){return at._VirtualizeContentsView._defaultPagesToPrefetch*2+1},set:function(){w._deprecated(ft.pagesToLoadIsDeprecated)}},pagesToLoadThreshold:{get:function(){return 0},set:function(){w._deprecated(ft.pagesToLoadThresholdIsDeprecated)}},groupDataSource:{get:function(){return this._groupDataSource},set:function(n){function i(n){n.detail===nt.DataSourceStatus.failure&&(t.itemDataSource=null,t.groupDataSource=null)}this._writeProfilerMark("set_groupDataSource,info");var t=this;this._groupDataSource&&this._groupDataSource.removeEventListener&&this._groupDataSource.removeEventListener("statuschanged",i,!1);this._groupDataSource=n;this._groupFocusCache=n&&this._supportsGroupHeaderKeyboarding?new et._GroupFocusCache(this):new et._UnsupportedGroupFocusCache;this._groupDataSource&&this._groupDataSource.addEventListener&&this._groupDataSource.addEventListener("statuschanged",i,!1);this._createGroupsContainer();this._runningInit?(this._updateGroupWork(),this._resetLayout()):(this._view.reset(),this._pendingLayoutReset=!0,this._pendingGroupWork=!0,this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0,!0))}},_updateGroupWork:function(){this._pendingGroupWork=!1;this._groupDataSource?w.addClass(this._element,it._groupsClass):w.removeClass(this._element,it._groupsClass);this._resetLayout()},automaticallyLoadPages:{get:function(){return!1},set:function(){w._deprecated(ft.automaticallyLoadPagesIsDeprecated)}},loadingBehavior:{get:function(){return"randomAccess"},set:function(){w._deprecated(ft.loadingBehaviorIsDeprecated)}},selectionMode:{get:function(){return this._selectionMode},set:function(n){if(typeof n=="string"&&n.match(/^(none|single|multi)$/)){if(i.isPhone&&n===nt.SelectionMode.single)return;this._selectionMode=n;this._element.setAttribute("aria-multiselectable",this._multiSelection());this._updateItemsAriaRoles();this._configureSelectionMode();return}throw new r("WinJS.UI.ListView.ModeIsInvalid",ft.modeIsInvalid);}},tapBehavior:{get:function(){return this._tap},set:function(n){i.isPhone&&n===nt.TapBehavior.directSelect||(this._tap=n,this._updateItemsAriaRoles(),this._configureSelectionMode())}},groupHeaderTapBehavior:{get:function(){return this._groupHeaderTap},set:function(n){this._groupHeaderTap=n;this._updateGroupHeadersAriaRoles()}},swipeBehavior:{get:function(){return"none"},set:function(){w._deprecated(ft.swipeBehaviorDeprecated)}},itemDataSource:{get:function(){return this._itemsManager.dataSource},set:function(n){this._writeProfilerMark("set_itemDataSource,info");this._dataSource=n||(new c.List).dataSource;this._groupFocusCache.clear();this._runningInit||(this._selection._reset(),this._cancelAsyncViewWork(!0),this._updateItemsManager(),this._pendingLayoutReset=!0,this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0,!0))}},itemTemplate:{get:function(){return this._itemRenderer},set:function(n){this._setRenderer(n,!1);this._runningInit||(this._cancelAsyncViewWork(!0),this._updateItemsManager(),this._pendingLayoutReset=!0,this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0,!0))}},resetItem:{get:function(){return this._itemRelease},set:function(n){w._deprecated(ft.resetItemIsDeprecated);this._itemRelease=n}},groupHeaderTemplate:{get:function(){return this._groupHeaderRenderer},set:function(n){this._setRenderer(n,!0);this._runningInit||(this._cancelAsyncViewWork(!0),this._pendingLayoutReset=!0,this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.medium,0,!0))}},resetGroupHeader:{get:function(){return this._groupHeaderRelease},set:function(n){w._deprecated(ft.resetGroupHeaderIsDeprecated);this._groupHeaderRelease=n}},header:{get:function(){return this._header},set:function(n){var i,t;w.empty(this._headerContainer);this._header=n;n&&(this._header.tabIndex=this._tabIndex,this._headerContainer.appendChild(n));i=this._selection._getFocused();i.type===nt.ObjectType.header&&(t=i,n||(t={type:nt.ObjectType.item,index:0}),this._hasKeyboardFocus?this._changeFocus(t,!0,!1,!0):this._changeFocusPassively(t));this.recalculateItemPosition();this._raiseHeaderFooterVisibilityEvent()}},footer:{get:function(){return this._footer},set:function(n){var i,t;w.empty(this._footerContainer);this._footer=n;n&&(this._footer.tabIndex=this._tabIndex,this._footerContainer.appendChild(n));i=this._selection._getFocused();i.type===nt.ObjectType.footer&&(t=i,n||(t={type:nt.ObjectType.item,index:0}),this._hasKeyboardFocus?this._changeFocus(t,!0,!1,!0):this._changeFocusPassively(t));this.recalculateItemPosition();this._raiseHeaderFooterVisibilityEvent()}},loadingState:{get:function(){return this._loadingState}},selection:{get:function(){return this._selection}},indexOfFirstVisible:{get:function(){return this._view.firstIndexDisplayed},set:function(n){if(!(n<0)){this._writeProfilerMark("set_indexOfFirstVisible("+n+"),info");this._raiseViewLoading(!0);var t=this;this._batchViewUpdates(it._ViewChange.realize,it._ScrollToPriority.high,function(){var i;return t._entityInRange({type:nt.ObjectType.item,index:n}).then(function(n){return n.inRange?t._getItemOffset({type:nt.ObjectType.item,index:n.index}).then(function(n){return i=n,t._ensureFirstColumnRange(nt.ObjectType.item)}).then(function(){return i=t._correctRangeInFirstColumn(i,nt.ObjectType.item),i=t._convertFromCanvasCoordinates(i),t._view.waitForValidScrollPosition(i.begin)}).then(function(n){var i=n<t._lastScrollPosition?"left":"right",r=t._viewport[t._scrollLength]-t._getViewportLength();return n=w._clamp(n,0,r),{position:n,direction:i}}):{position:0,direction:"left"}})},!0)}}},indexOfLastVisible:{get:function(){return this._view.lastIndexDisplayed}},currentItem:{get:function(){var n=this._selection._getFocused(),t={index:n.index,type:n.type,key:null,hasFocus:!!this._hasKeyboardFocus,showFocus:!1},i,r,u;return n.type===nt.ObjectType.groupHeader?(i=this._groups.group(n.index),i&&(t.key=i.key,t.showFocus=!!(i.header&&w.hasClass(i.header,it._itemFocusClass)))):n.type===nt.ObjectType.item&&(r=this._view.items.itemAt(n.index),r&&(u=this._itemsManager._recordFromElement(r),t.key=u.item&&u.item.key,t.showFocus=!!r.parentNode.querySelector("."+it._itemFocusOutlineClass))),t},set:function(n){function r(i,r,u){var f=!!n.showFocus&&t._hasKeyboardFocus;t._unsetFocusOnItem(r);t._selection._setFocused(u,f);t._hasKeyboardFocus?(t._keyboardFocusInbound=f,t._setFocusOnItem(u)):t._tabManager.childFocus=r?i:null;u.type!==nt.ObjectType.groupHeader&&(t._updateFocusCache(u.index),t._updater&&(t._updater.newSelectionPivot=u.index,t._updater.oldSelectionPivot=-1),t._selection._pivot=u.index)}var t,f,i,u;this._hasKeyboardFocus=n.hasFocus||this._hasKeyboardFocus;n.type||(n.type=nt.ObjectType.item);t=this;n.key&&(n.type===nt.ObjectType.item&&this._dataSource.itemFromKey||n.type===nt.ObjectType.groupHeader&&this._groupDataSource&&this._groupDataSource.itemFromKey)?(this.oldCurrentItemKeyFetch&&this.oldCurrentItemKeyFetch.cancel(),f=n.type===nt.ObjectType.groupHeader?this._groupDataSource:this._dataSource,this.oldCurrentItemKeyFetch=f.itemFromKey(n.key).then(function(i){if(t.oldCurrentItemKeyFetch=null,i){var u=n.type===nt.ObjectType.groupHeader?t._groups.group(i.index).header:t._view.items.itemAt(i.index);r(u,!!u,{type:n.type,index:i.index})}})):n.type===nt.ObjectType.header||n.type===nt.ObjectType.footer?(i=n.type===nt.ObjectType.header?this._header:this._footer,r(i,!!i,{type:n.type,index:n.index})):n.index!==undefined&&(n.type===nt.ObjectType.groupHeader?(u=t._groups.group(n.index),i=u&&u.header):i=t._view.items.itemAt(n.index),r(i,!!i,{type:n.type,index:n.index}))}},zoomableView:{get:function(){return this._zoomableView||(this._zoomableView=new ht(this)),this._zoomableView}},itemsDraggable:{get:function(){return this._dragSource},set:function(n){i.isPhone||this._dragSource!==n&&(this._dragSource=n,this._setDraggable())}},itemsReorderable:{get:function(){return this._reorderable},set:function(n){i.isPhone||this._reorderable!==n&&(this._reorderable=n,this._setDraggable())}},maxDeferredItemCleanup:{get:function(){return this._maxDeferredItemCleanup},set:function(n){this._maxDeferredItemCleanup=Math.max(0,+n||0)}},dispose:function(){this._dispose()},elementFromIndex:function(n){return this._view.items.itemAt(n)},indexOfElement:function(n){return this._view.items.index(n)},ensureVisible:function(n){var i=nt.ObjectType.item,r=n,t;(+n!==n&&(i=n.type,r=n.index),this._writeProfilerMark("ensureVisible("+i+": "+r+"),info"),r<0)||(this._raiseViewLoading(!0),t=this,this._batchViewUpdates(it._ViewChange.realize,it._ScrollToPriority.high,function(){var n;return t._entityInRange({type:i,index:r}).then(function(r){return r.inRange?t._getItemOffset({type:i,index:r.index}).then(function(r){return n=r,t._ensureFirstColumnRange(i)}).then(function(){var c,u,l,e,a,v,y,p;n=t._correctRangeInFirstColumn(n,i);var s=t._getViewportLength(),o=t._viewportScrollPosition,h=o+s,f=t._viewportScrollPosition,b=n.end-n.begin;return n=t._convertFromCanvasCoordinates(n),c=!1,i===nt.ObjectType.groupHeader&&o<=n.begin&&(u=t._groups.group(r.index).header,u&&(e=ct._getMargins(u),t._horizontalLayout?(a=t._rtl(),v=a?ni(u)-e.right:u.offsetLeft-e.left,l=v+u.offsetWidth+(a?e.left:e.right)):l=u.offsetTop+u.offsetHeight+e.top,c=l<=h)),c||(b>=h-o?f=n.begin:n.begin<o?f=n.begin:n.end>h&&(f=n.end-s)),y=f<t._lastScrollPosition?"left":"right",p=t._viewport[t._scrollLength]-s,f=w._clamp(f,0,p),{position:f,direction:y}}):{position:0,direction:"left"}})},!0))},loadMorePages:function(){w._deprecated(ft.loadMorePagesIsDeprecated)},recalculateItemPosition:function(){this._writeProfilerMark("recalculateItemPosition,info");this._forceLayoutImpl(it._ViewChange.relayout)},forceLayout:function(){this._writeProfilerMark("forceLayout,info");this._forceLayoutImpl(it._ViewChange.remeasure)},_entityInRange:function(n){if(n.type===nt.ObjectType.item)return this._itemsCount().then(function(t){var i=w._clamp(n.index,0,t-1);return{inRange:i>=0&&i<t,index:i}});if(n.type===nt.ObjectType.groupHeader){var t=w._clamp(n.index,0,this._groups.length()-1);return l.wrap({inRange:t>=0&&t<this._groups.length(),index:t})}return l.wrap({inRange:!0,index:0})},_forceLayoutImpl:function(n){var t=this;this._versionManager.unlocked.then(function(){t._writeProfilerMark("_forceLayoutImpl viewChange("+n+"),info");t._cancelAsyncViewWork();t._pendingLayoutReset=!0;t._resizeViewport();t._batchViewUpdates(n,it._ScrollToPriority.low,function(){return{position:t._lastScrollPosition,direction:"right"}},!0,!0)})},_configureSelectionMode:function(){var t=it._selectionModeClass,i=it._hidingSelectionMode,r;this.tapBehavior===nt.TapBehavior.toggleSelect&&this.selectionMode===nt.SelectionMode.multi?(w.addClass(this._canvas,t),w.removeClass(this._canvas,i)):(w.hasClass(this._canvas,t)&&(r=this,n.setTimeout(function(){n.setTimeout(function(){w.removeClass(r._canvas,i)},it._hidingSelectionModeAnimationTimeout)},50),w.addClass(this._canvas,i)),w.removeClass(this._canvas,t))},_lastScrollPosition:{get:function(){return this._lastScrollPositionValue},set:function(n){if(n===0)this._lastDirection="right",this._direction="right",this._lastScrollPositionValue=0;else{var t=n<this._lastScrollPositionValue?"left":"right";this._direction=this._scrollDirection(n);this._lastDirection=t;this._lastScrollPositionValue=n}}},_hasHeaderOrFooter:{get:function(){return!!(this._header||this._footer)}},_getHeaderOrFooterFromElement:function(n){return this._header&&this._header.contains(n)?this._header:this._footer&&this._footer.contains(n)?this._footer:null},_supportsGroupHeaderKeyboarding:{get:function(){return this._groupDataSource}},_viewportScrollPosition:{get:function(){return this._currentScrollPosition=w.getScrollPosition(this._viewport)[this._scrollProperty],this._currentScrollPosition},set:function(n){var t={};t[this._scrollProperty]=n;w.setScrollPosition(this._viewport,t);this._currentScrollPosition=n}},_canvasStart:{get:function(){return this._canvasStartValue||0},set:function(n){var t=this._horizontal()?this._rtl()?-n:n:0,i=this._horizontal()?0:n;this._canvas.style[pt.scriptName]=n!==0?"translate( "+t+"px, "+i+"px)":"";this._canvasStartValue=n}},scrollPosition:{get:function(){return this._viewportScrollPosition},set:function(n){var t=this;this._batchViewUpdates(it._ViewChange.realize,it._ScrollToPriority.high,function(){return t._view.waitForValidScrollPosition(n).then(function(){var r=t._viewport[t._scrollLength]-t._getViewportLength(),i;return n=w._clamp(n,0,r),i=n<t._lastScrollPosition?"left":"right",{position:n,direction:i}})},!0)}},_setRenderer:function(n,t){var u;if(n){if(typeof n=="function")u=n;else if(typeof n=="object"){if(i.validation&&!n.renderItem)throw new r("WinJS.UI.ListView.invalidTemplate",ft.invalidTemplate);u=n.renderItem}}else{if(i.validation)throw new r("WinJS.UI.ListView.invalidTemplate",ft.invalidTemplate);u=k.trivialHtmlRenderer}u&&(t?this._groupHeaderRenderer=u:this._itemRenderer=u)},_renderWithoutReuse:function(n,t){var i,r;return t&&p._disposeElement(t),i=this._itemRenderer(n),i.then?i.then(function(n){return n.tabIndex=0,n}):(r=i.element||i,r.tabIndex=0,i)},_isInsertedItem:function(n){return!!this._insertedItems[n.handle]},_clearInsertedItems:function(){for(var t=Object.keys(this._insertedItems),n=0,i=t.length;n<i;n++)this._insertedItems[t[n]].release();this._insertedItems={};this._modifiedElements=[];this._countDifference=0},_cancelAsyncViewWork:function(n){this._view.stopWork(n)},_updateView:function(){function r(){n._itemsBlockExtent=-1;n._firstItemRange=null;n._firstHeaderRange=null;n._itemMargins=null;n._headerMargins=null;n._canvasMargins=null;n._cachedRTL=null;n._rtl()}function i(){var t,i;return n._scrollToPriority=it._ScrollToPriority.uninitialized,t=n._setScrollbarPosition,n._setScrollbarPosition=!1,i=typeof n._scrollToFunctor=="number"?{position:n._scrollToFunctor}:n._scrollToFunctor(),l.as(i).then(function(i){return i=i||{},t&&+i.position===i.position&&(n._lastScrollPosition=i.position,n._viewportScrollPosition=i.position),i},function(i){return n._setScrollbarPosition|=t,l.wrapError(i)})}var n,t;if(!this._isZombie())if(n=this,t=this._viewChange,this._viewChange=it._ViewChange.realize,t===it._ViewChange.rebuild)this._pendingGroupWork&&this._updateGroupWork(),this._pendingLayoutReset&&this._resetLayout(),r(),this._firstTimeDisplayed||this._view.reset(),this._view.reload(i,!0),this._setFocusOnItem(this._selection._getFocused()),this._headerFooterVisibilityStatus={headerVisible:!1,footerVisible:!1};else if(t===it._ViewChange.remeasure)this._view.resetItems(!0),this._resetLayout(),r(),this._view.refresh(i),this._setFocusOnItem(this._selection._getFocused()),this._headerFooterVisibilityStatus={headerVisible:!1,footerVisible:!1};else if(t===it._ViewChange.relayout)this._pendingLayoutReset&&(this._resetLayout(),r()),this._view.refresh(i);else{this._view.onScroll(i);this._raiseHeaderFooterVisibilityEvent()}},_batchViewUpdates:function(n,t,i,r,u){if(this._viewChange=Math.min(this._viewChange,n),(this._scrollToFunctor===null||t>=this._scrollToPriority)&&(this._scrollToPriority=t,this._scrollToFunctor=i),this._setScrollbarPosition|=!!r,!this._batchingViewUpdates){this._raiseViewLoading();var f=this;this._batchingViewUpdatesSignal=new v;this._batchingViewUpdates=l.any([this._batchingViewUpdatesSignal.promise,a.schedulePromiseHigh(null,"WinJS.UI.ListView._updateView")]).then(function(){if(!f._isZombie())return f._viewChange===it._ViewChange.rebuild&&!f._firstTimeDisplayed&&Object.keys(f._view.items._itemData).length!==0&&!u?f._fadeOutViewport():void 0}).then(function(){f._batchingViewUpdates=null;f._batchingViewUpdatesSignal=null;f._updateView();f._firstTimeDisplayed=!1},function(){f._batchingViewUpdates=null;f._batchingViewUpdatesSignal=null})}return this._batchingViewUpdatesSignal},_resetCanvas:function(){if(!this._disposed){var t=n.document.createElement("div");t.className=this._canvas.className;this._viewport.replaceChild(t,this._canvas);this._canvas=t;this._groupsToRemove={};this._canvas.appendChild(this._canvasProxy)}},_setupInternalTree:function(){w.addClass(this._element,it._listViewClass);w[this._rtl()?"addClass":"removeClass"](this._element,it._rtlListViewClass);this._element.innerHTML='<div tabIndex="-1" role="group" class="'+it._viewportClass+" "+it._horizontalClass+'"><div><\/div><div class="'+it._scrollableClass+'"><div class="'+it._proxyClass+'"><\/div><\/div><div><\/div><div><\/div><\/div><div aria-hidden="true" style="position:absolute;left:50%;top:50%;width:0px;height:0px;" tabindex="-1"><\/div>';this._viewport=this._element.firstElementChild;this._headerContainer=this._viewport.firstElementChild;w.addClass(this._headerContainer,it._listHeaderContainerClass);this._canvas=this._headerContainer.nextElementSibling;this._footerContainer=this._canvas.nextElementSibling;w.addClass(this._footerContainer,it._listFooterContainerClass);this._canvasProxy=this._canvas.firstElementChild;this._deleteWrapper=this._canvas.nextElementSibling;this._keyboardEventsHelper=this._viewport.nextElementSibling;this._tabIndex=w.getTabIndex(this._element);this._tabIndex<0&&(this._tabIndex=0);this._tabManager=new g.TabContainer(this._viewport);this._tabManager.tabIndex=this._tabIndex;this._progressBar=n.document.createElement("progress");w.addClass(this._progressBar,it._progressClass);this._progressBar.style.position="absolute";this._progressBar.max=100},_unsetFocusOnItem:function(t){(this._tabManager.childFocus&&this._clearFocusRectangle(this._tabManager.childFocus),this._isZombie())||(t||(this._tabManager.childFocus&&(this._tabManager.childFocus=null),this._keyboardEventsHelper._shouldHaveFocus=!1,n.document.activeElement!==this._viewport&&this._hasKeyboardFocus&&(this._keyboardEventsHelper._shouldHaveFocus=!0,w._setActive(this._keyboardEventsHelper))),this._itemFocused=!1)},_setFocusOnItem:function(n){if(this._writeProfilerMark("_setFocusOnItem,info"),this._focusRequest&&this._focusRequest.cancel(),!this._isZombie()){var t=this,i=function(i){t._isZombie()||(t._tabManager.childFocus!==i&&(t._tabManager.childFocus=i),t._focusRequest=null,t._hasKeyboardFocus&&!t._itemFocused&&(t._selection._keyboardFocused()&&t._drawFocusRectangle(i),(n.type===nt.ObjectType.groupHeader||n.type===nt.ObjectType.item)&&t._view.updateAriaForAnnouncement(i,n.type===nt.ObjectType.groupHeader?t._groups.length():t._cachedCount),t._itemFocused=!0,w._setActive(i)))};this._focusRequest=n.type===nt.ObjectType.item?this._view.items.requestItem(n.index):n.type===nt.ObjectType.groupHeader?this._groups.requestHeader(n.index):l.wrap(n.type===nt.ObjectType.header?this._header:this._footer);this._focusRequest.then(i)}},_attachEvents:function(){function r(n,t,r){return{name:t?n:n.toLowerCase(),handler:function(t){i["_on"+n](t)},capture:r}}function t(n,t,r){return{capture:r,name:t?n:n.toLowerCase(),handler:function(t){var r=i._mode,u="on"+n;!i._disposed&&r[u]&&r[u](t)}}}function s(n,t){return{handler:function(t){i["_on"+n](t)},filter:t}}var i=this,h=[s("PropertyChange",["dir","style","tabindex"])],f,e,u,o;this._cachedStyleDir=this._element.style.direction;h.forEach(function(n){new w._MutationObserver(n.handler).observe(i._element,{attributes:!0,attributeFilter:n.filter})});f=[t("PointerDown"),t("click",!1),t("PointerUp"),t("LostPointerCapture"),t("MSHoldVisual",!0),t("PointerCancel",!0),t("DragStart"),t("DragOver"),t("DragEnter"),t("DragLeave"),t("Drop"),t("ContextMenu")];f.forEach(function(n){w._addEventListener(i._viewport,n.name,n.handler,!!n.capture)});e=[r("FocusIn",!1,!1),r("FocusOut",!1,!1),t("KeyDown"),t("KeyUp"),r("MSElementResize",!1,!1)];e.forEach(function(n){w._addEventListener(i._element,n.name,n.handler,!!n.capture)});this._onMSElementResizeBound=this._onMSElementResize.bind(this);w._resizeNotifier.subscribe(this._element,this._onMSElementResizeBound);u=n.document.body.contains(this._element);w._addInsertedNotifier(this._element);this._element.addEventListener("WinJSNodeInserted",function(n){if(u){u=!1;return}i._onMSElementResizeBound(n)},!1);o=[r("MSManipulationStateChanged",!0),r("Scroll")];o.forEach(function(n){i._viewport.addEventListener(n.name,n.handler,!1)});this._viewport.addEventListener("onTabEnter",this._onTabEnter.bind(this));this._viewport.addEventListener("onTabExit",this._onTabExit.bind(this));this._viewport.addEventListener("onTabEntered",function(n){i._mode.onTabEntered(n)});this._viewport.addEventListener("onTabExiting",function(n){i._mode.onTabExiting(n)})},_updateItemsManager:function(){function t(t){t.detail===nt.DataSourceStatus.failure&&(n.itemDataSource=null,n.groupDataSource=null)}var n=this,r={beginNotifications:function(){},changed:function(t,i){var r,u,e,f,o;if(!n._ifZombieDispose()){for(n._createUpdater(),r=n._updater.elements[vt(i)],r&&(u=n.selection._isIncluded(r.index),u&&(n._updater.updateDrag=!0),i!==t?((n._tabManager.childFocus===i||n._updater.newFocusedItem===i)&&(n._updater.newFocusedItem=t,n._tabManager.childFocus=null),r.itemBox&&(w.addClass(t,it._itemClass),n._setupAriaSelectionObserver(t),e=i.nextElementSibling,r.itemBox.removeChild(i),r.itemBox.insertBefore(t,e)),n._setAriaSelected(t,u),n._view.items.setItemAt(r.newIndex,{element:t,itemBox:r.itemBox,container:r.container,itemsManagerRecord:r.itemsManagerRecord}),delete n._updater.elements[vt(i)],p._disposeElement(i),n._updater.elements[vt(t)]={item:t,container:r.container,itemBox:r.itemBox,index:r.index,newIndex:r.newIndex,itemsManagerRecord:r.itemsManagerRecord}):r.itemBox&&r.container&&(rt._ItemEventsHandler.renderSelection(r.itemBox,t,u,!0),w[u?"addClass":"removeClass"](r.container,it._selectedClass)),n._updater.changed=!0),f=0,o=n._notificationHandlers.length;f<o;f++)n._notificationHandlers[f].changed(t,i);n._writeProfilerMark("changed,info")}},removed:function(t,i,r){function o(t){n._updater.updateDrag=!0;n._currentMode()._dragging&&n._currentMode()._draggingUnselectedItem&&n._currentMode()._dragInfo._isIncluded(t)&&(n._updater.newDragInfo=new lt._Selection(n,[]));var r=n._updater.selectionFirst[t],u=n._updater.selectionLast[t],i=r||u;i&&(delete n._updater.selectionFirst[i.oldFirstIndex],delete n._updater.selectionLast[i.oldLastIndex],n._updater.selectionChanged=!0)}var s,u,f,e,l;if(!n._ifZombieDispose()){if(n._createUpdater(),s=n._insertedItems[r],s&&delete n._insertedItems[r],t){if(f=n._updater.elements[vt(t)],e=n._itemsManager.itemObject(t),e&&n._groupFocusCache.deleteItem(e.key),f){if(u=f.index,f.itemBox){var h=f.itemBox,a=it._containerOddClass,c=it._containerEvenClass,v=w.hasClass(h.parentElement,c)?c:a;n._updater.removed.push({index:u,itemBox:h,containerStripe:v})}n._updater.deletesCount++;l=n._view.items.itemDataAt(u);l.removed=!0;delete n._updater.elements[vt(t)]}else u=e&&e.index;n._updater.oldFocus.type!==nt.ObjectType.groupHeader&&n._updater.oldFocus.index===u&&(n._updater.newFocus.index=u,n._updater.focusedItemRemoved=!0);o(u)}else u=n._updater.selectionHandles[r],u===+u&&o(u);n._writeProfilerMark("removed("+u+"),info");n._updater.changed=!0}},updateAffectedRange:function(t){n._itemsCount().then(function(i){var r=n._view.containers?n._view.containers.length:0;t.start=Math.min(t.start,r);n._affectedRange.add(t,i)});n._createUpdater();n._updater.changed=!0},indexChanged:function(t,i,r){var f,e,u;n._ifZombieDispose()||(n._createUpdater(),t&&(f=n._itemsManager.itemObject(t),f&&n._groupFocusCache.updateItemIndex(f.key,i),e=n._updater.elements[vt(t)],e&&(e.newIndex=i,n._updater.changed=!0),n._updater.itemsMoved=!0),n._currentMode()._dragging&&n._currentMode()._draggingUnselectedItem&&n._currentMode()._dragInfo._isIncluded(r)&&(n._updater.newDragInfo=new lt._Selection(n,[{firstIndex:i,lastIndex:i}]),n._updater.updateDrag=!0),n._updater.oldFocus.type!==nt.ObjectType.groupHeader&&n._updater.oldFocus.index===r&&(n._updater.newFocus.index=i,n._updater.changed=!0),n._updater.oldSelectionPivot===r&&(n._updater.newSelectionPivot=i,n._updater.changed=!0),u=n._updater.selectionFirst[r],u&&(u.newFirstIndex=i,n._updater.changed=!0,n._updater.updateDrag=!0),u=n._updater.selectionLast[r],u&&(u.newLastIndex=i,n._updater.changed=!0,n._updater.updateDrag=!0))},endNotifications:function(){n._update()},inserted:function(t){n._ifZombieDispose()||(n._writeProfilerMark("inserted,info"),n._createUpdater(),n._updater.changed=!0,t.retain(),n._updater.insertsCount++,n._insertedItems[t.handle]=t)},moved:function(t,i,r,u){var o,f;if(!n._ifZombieDispose()){if(n._createUpdater(),n._updater.movesCount++,t&&(n._updater.itemsMoved=!0,o=n._updater.elements[vt(t)],o&&(o.moved=!0)),f=n._updater.selectionHandles[u.handle],f===+f){n._updater.updateDrag=!0;var s=n._updater.selectionFirst[f],h=n._updater.selectionLast[f],e=s||h;e&&e.oldFirstIndex!==e.oldLastIndex&&(delete n._updater.selectionFirst[e.oldFirstIndex],delete n._updater.selectionLast[e.oldLastIndex],n._updater.selectionChanged=!0,n._updater.changed=!0)}n._writeProfilerMark("moved("+f+"),info")}},countChanged:function(t,i){n._ifZombieDispose()||(n._writeProfilerMark("countChanged("+t+"),info"),n._cachedCount=t,n._createUpdater(),n._view.lastIndexDisplayed+1===i&&(n._updater.changed=!0),n._updater.countDifference+=t-i)},reload:function(){n._ifZombieDispose()||(n._writeProfilerMark("reload,info"),n._processReload())}},i;this._versionManager&&this._versionManager._dispose();this._versionManager=new tt._VersionManager;this._updater=null;i=this._selection.getRanges();this._selection._selected.clear();this._itemsManager&&(this._itemsManager.dataSource&&this._itemsManager.dataSource.removeEventListener&&this._itemsManager.dataSource.removeEventListener("statuschanged",t,!1),this._clearInsertedItems(),this._itemsManager.release());this._itemsCountPromise&&(this._itemsCountPromise.cancel(),this._itemsCountPromise=null);this._cachedCount=it._UNINITIALIZED;this._itemsManager=k._createItemsManager(this._dataSource,this._renderWithoutReuse.bind(this),r,{ownerElement:this._element,versionManager:this._versionManager,indexInView:function(t){return t>=n.indexOfFirstVisible&&t<=n.indexOfLastVisible},viewCallsReady:!0,profilerId:this._id});this._dataSource.addEventListener&&this._dataSource.addEventListener("statuschanged",t,!1);this._selection._selected.set(i)},_processReload:function(){this._affectedRange.addAll();this._cancelAsyncViewWork(!0);this._currentMode()._dragging&&this._currentMode()._clearDragProperties();this._groupFocusCache.clear();this._selection._reset();this._updateItemsManager();this._pendingLayoutReset=!0;this._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.low,this.scrollPosition)},_createUpdater:function(){var n,i,t,f,u,r;if(!this._updater){for(this.itemDataSource._isVirtualizedDataSource&&this._affectedRange.addAll(),this._versionManager.beginUpdating(),this._cancelAsyncViewWork(),n={changed:!1,elements:{},selectionFirst:{},selectionLast:{},selectionHandles:{},oldSelectionPivot:{type:nt.ObjectType.item,index:it._INVALID_INDEX},newSelectionPivot:{type:nt.ObjectType.item,index:it._INVALID_INDEX},removed:[],selectionChanged:!1,oldFocus:{type:nt.ObjectType.item,index:it._INVALID_INDEX},newFocus:{type:nt.ObjectType.item,index:it._INVALID_INDEX},hadKeyboardFocus:this._hasKeyboardFocus,itemsMoved:!1,lastVisible:this.indexOfLastVisible,updateDrag:!1,movesCount:0,insertsCount:0,deletesCount:0,countDifference:0},this._view.items.each(function(t,i,r){n.elements[vt(i)]={item:i,container:r.container,itemBox:r.itemBox,index:t,newIndex:t,itemsManagerRecord:r.itemsManagerRecord,detached:r.detached}}),i=this._selection._selected._ranges,t=0,f=i.length;t<f;t++)u=i[t],r={newFirstIndex:i[t].firstIndex,oldFirstIndex:i[t].firstIndex,newLastIndex:i[t].lastIndex,oldLastIndex:i[t].lastIndex},n.selectionFirst[r.oldFirstIndex]=r,n.selectionLast[r.oldLastIndex]=r,n.selectionHandles[u.firstPromise.handle]=r.oldFirstIndex,n.selectionHandles[u.lastPromise.handle]=r.oldLastIndex;n.oldSelectionPivot=this._selection._pivot;n.newSelectionPivot=n.oldSelectionPivot;n.oldFocus=this._selection._getFocused();n.newFocus=this._selection._getFocused();this._updater=n}},_synchronize:function(){var n=this._updater,s,t,f,h,c,e,o,l,a,u,v,y,i,r;if(this._updater=null,this._groupsChanged=!1,this._countDifference=this._countDifference||0,n&&n.changed){n.itemsMoved&&this._layout.itemsMoved&&this._layout.itemsMoved();n.removed.length&&this._layout.itemsRemoved&&this._layout.itemsRemoved(n.removed.map(function(n){return n.itemBox}));(n.itemsMoved||n.removed.length||Object.keys(this._insertedItems).length)&&this._layout.setupAnimations&&this._layout.setupAnimations();this._currentMode().onDataChanged&&this._currentMode().onDataChanged();s=[];for(t in n.selectionFirst)n.selectionFirst.hasOwnProperty(t)&&(f=n.selectionFirst[t],n.selectionChanged=n.selectionChanged||f.newLastIndex-f.newFirstIndex!=f.oldLastIndex-f.oldFirstIndex,f.newFirstIndex<=f.newLastIndex&&s.push({firstIndex:f.newFirstIndex,lastIndex:f.newLastIndex}));for(n.selectionChanged?(h=new lt._Selection(this,s),this._selection._fireSelectionChanging(h),this._selection._selected.set(s),this._selection._fireSelectionChanged(),h.clear()):this._selection._selected.set(s),this._selection._updateCount(this._cachedCount),n.newSelectionPivot=Math.min(this._cachedCount-1,n.newSelectionPivot),this._selection._pivot=n.newSelectionPivot>=0?n.newSelectionPivot:it._INVALID_INDEX,n.newFocus.type!==nt.ObjectType.groupHeader&&(n.newFocus.index=Math.max(0,Math.min(this._cachedCount-1,n.newFocus.index))),this._selection._setFocused(n.newFocus,this._selection._keyboardFocused()),c=this._modifiedElements||[],e={},this._modifiedElements=[],this._countDifference+=n.countDifference,t=0;t<c.length;t++)i=c[t],i.newIndex===-1?this._modifiedElements.push(i):e[i.newIndex]=i;for(t=0;t<n.removed.length;t++)o=n.removed[t],i=e[o.index],i?delete e[o.index]:i={oldIndex:o.index},i.newIndex=-1,i._removalHandled||(i._itemBox=o.itemBox,i._containerStripe=o.containerStripe),this._modifiedElements.push(i);for(l=Object.keys(this._insertedItems),t=0;t<l.length;t++)this._modifiedElements.push({oldIndex:-1,newIndex:this._insertedItems[l[t]].index});this._writeProfilerMark("_synchronize:update_modifiedElements,StartTM");a={};for(t in n.elements)n.elements.hasOwnProperty(t)&&(u=n.elements[t],a[u.newIndex]={element:u.item,container:u.container,itemBox:u.itemBox,itemsManagerRecord:u.itemsManagerRecord,detached:u.detached},i=e[u.index],i?(delete e[u.index],i.newIndex=u.newIndex):i={oldIndex:u.index,newIndex:u.newIndex},i.moved=u.moved,this._modifiedElements.push(i));for(this._writeProfilerMark("_synchronize:update_modifiedElements,StopTM"),v=Object.keys(e),t=0;t<v.length;t++)y=v[t],i=e[y],i.oldIndex!==-1&&this._modifiedElements.push(i);return this._view.items._itemData=a,n.updateDrag&&this._currentMode()._dragging&&(this._currentMode()._draggingUnselectedItem?n.newDragInfo&&(this._currentMode()._dragInfo=n.newDragInfo):this._currentMode()._dragInfo=this._selection,this._currentMode().fireDragUpdateEvent()),n.focusedItemRemoved||this._focusRequest&&n.oldFocus.index!==n.newFocus.index||n.oldFocus.type!==n.newFocus.type?(this._itemFocused=!1,this._setFocusOnItem(this._selection._getFocused())):n.newFocusedItem&&(this._hasKeyboardFocus=n.hadKeyboardFocus,this._itemFocused=!1,this._setFocusOnItem(this._selection._getFocused())),r=this,this._groups.synchronizeGroups().then(function(){return n.newFocus.type===nt.ObjectType.groupHeader&&(n.newFocus.index=Math.min(r._groups.length()-1,n.newFocus.index),n.newFocus.index<0&&(n.newFocus={type:nt.ObjectType.item,index:0}),r._selection._setFocused(n.newFocus,r._selection._keyboardFocused())),r._versionManager.endUpdating(),n.deletesCount>0&&r._updateDeleteWrapperSize(),r._view.updateTree(r._cachedCount,r._countDifference,r._modifiedElements)}).then(function(){return r._lastScrollPosition})}return this._countDifference+=n?n.countDifference:0,r=this,this._groups.synchronizeGroups().then(function(){return n&&r._versionManager.endUpdating(),r._view.updateTree(r._cachedCount,r._countDifference,r._modifiedElements)}).then(function(){return r.scrollPosition})},_updateDeleteWrapperSize:function(n){var t=this._horizontal()?"width":"height";this._deleteWrapper.style["min-"+t]=(n?0:this.scrollPosition+this._getViewportSize()[t])+"px"},_verifyRealizationNeededForChange:function(){var f=!1,e=(this._view.lastIndexDisplayed||0)-(this._view.firstIndexDisplayed||0),t=this._updater&&this._updater.movesCount===0&&this._updater.insertsCount===0&&this._updater.deletesCount>0&&this._updater.deletesCount===Math.abs(this._updater.countDifference),i,n,o,r,u;if(t&&this._updater.elements)for(i=Object.keys(this._updater.elements),n=0,o=i.length;n<o;n++)if(r=this._updater.elements[i[n]],u=r.index-r.newIndex,u<0||u>this._updater.deletesCount){t=!1;break}this._view.deletesWithoutRealize=this._view.deletesWithoutRealize||0;t&&this._view.lastIndexDisplayed<this._view.end-e&&this._updater.deletesCount+this._view.deletesWithoutRealize<e?(f=!0,this._view.deletesWithoutRealize+=Math.abs(this._updater.countDifference),this._writeProfilerMark("skipping realization on delete,info")):this._view.deletesWithoutRealize=0;this._view._setSkipRealizationForChange(f)},_update:function(){if(this._writeProfilerMark("update,StartTM"),!this._ifZombieDispose()){this._updateJob=null;var n=this;this._versionManager.noOutstandingNotifications&&(this._updater||this._groupsChanged?(this._cancelAsyncViewWork(),this._verifyRealizationNeededForChange(),this._synchronize().then(function(t){n._writeProfilerMark("update,StopTM");n._batchViewUpdates(it._ViewChange.relayout,it._ScrollToPriority.low,t).complete()})):this._batchViewUpdates(it._ViewChange.relayout,it._ScrollToPriority.low,this._lastScrollPosition).complete())}},_scheduleUpdate:function(){if(!this._updateJob){var n=this;this._updateJob=a.schedulePromiseHigh(null,"WinJS.UI.ListView._update").then(function(){n._updateJob&&n._update()});this._raiseViewLoading()}},_createGroupsContainer:function(){this._groups&&this._groups.cleanUp();this._groups=this._groupDataSource?new ot._UnvirtualizedGroupsContainer(this,this._groupDataSource):new ot._NoGroups(this)},_createLayoutSite:function(){var t=this;return Object.create({invalidateLayout:function(){t._pendingLayoutReset=!0;var n=t._layout.orientation==="horizontal"!==t._horizontalLayout;t._affectedRange.addAll();t._batchViewUpdates(it._ViewChange.rebuild,it._ScrollToPriority.low,n?0:t.scrollPosition,!1,!0)},itemFromIndex:function(n){return t._itemsManager._itemPromiseAtIndex(n)},groupFromIndex:function(n){return t._groupsEnabled()?n<t._groups.length()?t._groups.group(n).userData:null:{key:"-1"}},groupIndexFromItemIndex:function(n){return n=Math.max(0,n),t._groups.groupFromItem(n)},renderItem:function(i){return l._cancelBlocker(t._itemsManager._itemFromItemPromise(i)).then(function(i){var f,r,u;return i?(f=t._itemsManager._recordFromElement(i),f.pendingReady&&f.pendingReady(),i=i.cloneNode(!0),w.addClass(i,it._itemClass),r=n.document.createElement("div"),w.addClass(r,it._itemBoxClass),r.appendChild(i),u=n.document.createElement("div"),w.addClass(u,it._containerClass),u.appendChild(r),u):l.cancel})},renderHeader:function(i){var r=k._normalizeRendererReturn(t.groupHeaderTemplate(l.wrap(i)));return r.then(function(t){w.addClass(t.element,it._headerClass);var i=n.document.createElement("div");return w.addClass(i,it._headerContainerClass),i.appendChild(t.element),i})},readyToMeasure:function(){t._getViewportLength();t._getCanvasMargins()},_isZombie:function(){return t._isZombie()},_writeProfilerMark:function(n){t._writeProfilerMark(n)}},{_itemsManager:{enumerable:!0,get:function(){return t._itemsManager}},rtl:{enumerable:!0,get:function(){return t._rtl()}},surface:{enumerable:!0,get:function(){return t._canvas}},viewport:{enumerable:!0,get:function(){return t._viewport}},scrollbarPos:{enumerable:!0,get:function(){return t.scrollPosition}},viewportSize:{enumerable:!0,get:function(){return t._getViewportSize()}},loadingBehavior:{enumerable:!0,get:function(){return t.loadingBehavior}},animationsDisabled:{enumerable:!0,get:function(){return t._animationsDisabled()}},tree:{enumerable:!0,get:function(){return t._view.tree}},realizedRange:{enumerable:!0,get:function(){return{firstPixel:Math.max(0,t.scrollPosition-2*t._getViewportLength()),lastPixel:t.scrollPosition+3*t._getViewportLength()-1}}},visibleRange:{enumerable:!0,get:function(){return{firstPixel:t.scrollPosition,lastPixel:t.scrollPosition+t._getViewportLength()-1}}},itemCount:{enumerable:!0,get:function(){return t._itemsCount()}},groupCount:{enumerable:!0,get:function(){return t._groups.length()}},header:{enumerable:!0,get:function(){return t.header}},footer:{enumerable:!0,get:function(){return t.footer}}})},_initializeLayout:function(){this._affectedRange.addAll();var n=this._createLayoutSite();return this._layout.initialize(n,this._groupsEnabled()),this._layout.orientation==="horizontal"},_resetLayoutOrientation:function(n){this._horizontalLayout?(this._startProperty="left",this._scrollProperty="scrollLeft",this._scrollLength="scrollWidth",this._deleteWrapper.style.minHeight="",w.addClass(this._viewport,it._horizontalClass),w.removeClass(this._viewport,it._verticalClass),n&&(this._viewport.scrollTop=0)):(this._startProperty="top",this._scrollProperty="scrollTop",this._scrollLength="scrollHeight",this._deleteWrapper.style.minWidth="",w.addClass(this._viewport,it._verticalClass),w.removeClass(this._viewport,it._horizontalClass),n&&w.setScrollPosition(this._viewport,{scrollLeft:0}))},_resetLayout:function(){this._pendingLayoutReset=!1;this._affectedRange.addAll();this._layout&&(this._layout.uninitialize(),this._horizontalLayout=this._initializeLayout(),this._resetLayoutOrientation())},_updateLayout:function(n){var t=!1,i,r;this._layout&&(this._cancelAsyncViewWork(!0),this._layout.uninitialize(),t=!0);n&&typeof n.type=="function"?(r=ii(n.type),i=new r(n)):i=n&&n.initialize?n:new ct.GridLayout(n);t&&this._resetCanvas();this._layoutImpl=i;this._layout=new ct._LayoutWrapper(i);t&&this._unsetFocusOnItem();this._setFocusOnItem({type:nt.ObjectType.item,index:0});this._selection._setFocused({type:nt.ObjectType.item,index:0});this._lastFocusedElementInGroupTrack={type:nt.ObjectType.item,index:-1};this._headerContainer.style.opacity=0;this._footerContainer.style.opacity=0;this._horizontalLayout=this._initializeLayout();this._resetLayoutOrientation(t);t&&(this._canvas.style.width=this._canvas.style.height="")},_currentMode:function(){return this._mode},_setDraggable:function(){var n=this.itemsDraggable||this.itemsReorderable;this._view.items.each(function(t,i,r){r.itemBox&&(r.itemBox.draggable=n&&!w.hasClass(i,it._nonDraggableClass))})},_resizeViewport:function(){this._viewportWidth=it._UNINITIALIZED;this._viewportHeight=it._UNINITIALIZED},_onMSElementResize:function(){this._writeProfilerMark("_onMSElementResize,info");a.schedule(function(){var n,t,i;this._isZombie()||this._viewportWidth!==it._UNINITIALIZED&&this._viewportHeight!==it._UNINITIALIZED&&(n=this._element.offsetWidth,t=this._element.offsetHeight,(this._previousWidth!==n||this._previousHeight!==t)&&(this._writeProfilerMark("resize ("+this._previousWidth+"x"+this._previousHeight+") => ("+n+"x"+t+"),info"),this._previousWidth=n,this._previousHeight=t,this._resizeViewport(),i=this,this._affectedRange.addAll(),this._batchViewUpdates(it._ViewChange.relayout,it._ScrollToPriority.low,function(){return{position:i.scrollPosition,direction:"right"}})))},a.Priority.max,this,"WinJS.UI.ListView._onMSElementResize")},_onFocusIn:function(n){function o(n){r._changeFocus(r._selection._getFocused(),!0,!1,!1,n)}var r,f,e;if(this._hasKeyboardFocus=!0,r=this,n.target===this._keyboardEventsHelper)!this._keyboardEventsHelper._shouldHaveFocus&&this._keyboardFocusInbound?o(!0):this._keyboardEventsHelper._shouldHaveFocus=!1;else if(n.target===this._element)o();else{if(this._mode.inboundFocusHandled){this._mode.inboundFocusHandled=!1;return}var u=this._view.items,t={},i=this._getHeaderOrFooterFromElement(n.target),s=null;i?(t.index=0,t.type=i===this._header?nt.ObjectType.header:nt.ObjectType.footer,this._lastFocusedElementInGroupTrack=t):(i=this._groups.headerFrom(n.target),i?(t.type=nt.ObjectType.groupHeader,t.index=this._groups.index(i),this._lastFocusedElementInGroupTrack=t):(t.index=u.index(n.target),t.type=nt.ObjectType.item,i=u.itemBoxAt(t.index),s=u.itemAt(t.index)));t.index!==it._INVALID_INDEX&&((this._keyboardFocusInbound||this._selection._keyboardFocused())&&(t.type===nt.ObjectType.groupHeader&&n.target===i||t.type===nt.ObjectType.item&&n.target.parentNode===i)&&this._drawFocusRectangle(i),this._tabManager.childFocus!==i&&this._tabManager.childFocus!==s&&(this._selection._setFocused(t,this._keyboardFocusInbound||this._selection._keyboardFocused()),this._keyboardFocusInbound=!1,t.type===nt.ObjectType.item&&(i=u.itemAt(t.index)),this._tabManager.childFocus=i,r._updater&&(f=r._updater.elements[vt(i)],e=t.index,f&&f.newIndex&&(e=f.newIndex),r._updater.oldFocus={type:t.type,index:e},r._updater.newFocus={type:t.type,index:e})))}},_onFocusOut:function(n){if(!this._disposed){this._hasKeyboardFocus=!1;this._itemFocused=!1;var t=this._view.items.itemBoxFrom(n.target)||this._groups.headerFrom(n.target);t&&this._clearFocusRectangle(t)}},_onMSManipulationStateChanged:function(n){function i(){t._manipulationEndSignal=null}var t=this;this._manipulationState=n.currentState;t._writeProfilerMark("_onMSManipulationStateChanged state("+n.currentState+"),info");this._manipulationState===w._MSManipulationEvent.MS_MANIPULATION_STATE_STOPPED||this._manipulationEndSignal||(this._manipulationEndSignal=new v,this._manipulationEndSignal.promise.done(i,i));this._manipulationState===w._MSManipulationEvent.MS_MANIPULATION_STATE_STOPPED&&this._manipulationEndSignal.complete()},_pendingScroll:!1,_onScroll:function(){this._zooming||this._pendingScroll||this._checkScroller()},_checkScroller:function(){var n,t,r;if(!this._isZombie())if(n=this._viewportScrollPosition,n!==this._lastScrollPosition){this._pendingScroll=i._requestAnimationFrame(this._checkScroller.bind(this));n=Math.max(0,n);t=this._scrollDirection(n);this._lastScrollPosition=n;this._raiseViewLoading(!0);this._raiseHeaderFooterVisibilityEvent();r=this;this._view.onScroll(function(){return{position:r._lastScrollPosition,direction:t}},this._manipulationEndSignal?this._manipulationEndSignal.promise:l.timeout(it._DEFERRED_SCROLL_END))}else this._pendingScroll=null},_scrollDirection:function(n){var t=n<this._lastScrollPosition?"left":"right";return t===this._lastDirection?t:this._direction},_onTabEnter:function(){this._keyboardFocusInbound=!0},_onTabExit:function(){this._keyboardFocusInbound=!1},_onPropertyChange:function(n){var t=this;n.forEach(function(n){var r=!1,i;n.attributeName==="dir"?r=!0:n.attributeName==="style"&&(r=t._cachedStyleDir!==n.target.style.direction);r&&(t._cachedStyleDir=n.target.style.direction,t._cachedRTL=null,w[t._rtl()?"addClass":"removeClass"](t._element,it._rtlListViewClass),t._lastScrollPosition=0,t._viewportScrollPosition=0,t.forceLayout());n.attributeName==="tabIndex"&&(i=t._element.tabIndex,i>=0&&(t._view.items.each(function(n,t){t.tabIndex=i}),t._header&&(t._header.tabIndex=i),t._footer&&(t._footer.tabIndex=i),t._tabIndex=i,t._tabManager.tabIndex=i,t._element.tabIndex=-1))})},_getCanvasMargins:function(){return this._canvasMargins||(this._canvasMargins=ct._getMargins(this._canvas)),this._canvasMargins},_convertCoordinatesByCanvasMargins:function(n,t){function r(i,r){n[i]!==undefined&&(n[i]=t(n[i],r))}var i;return this._horizontal()?(i=this._getCanvasMargins()[this._rtl()?"right":"left"],r("left",i)):(i=this._getCanvasMargins().top,r("top",i)),r("begin",i),r("end",i),n},_convertFromCanvasCoordinates:function(n){return this._convertCoordinatesByCanvasMargins(n,function(n,t){return n+t})},_convertToCanvasCoordinates:function(n){return this._convertCoordinatesByCanvasMargins(n,function(n,t){return n-t})},_getViewportSize:function(){return(this._viewportWidth===it._UNINITIALIZED||this._viewportHeight===it._UNINITIALIZED)&&(this._viewportWidth=Math.max(0,w.getContentWidth(this._element)),this._viewportHeight=Math.max(0,w.getContentHeight(this._element)),this._writeProfilerMark("viewportSizeDetected width:"+this._viewportWidth+" height:"+this._viewportHeight),this._previousWidth=this._element.offsetWidth,this._previousHeight=this._element.offsetHeight),{width:this._viewportWidth,height:this._viewportHeight}},_itemsCount:function(){function i(){n._itemsCountPromise=null}var n=this,t;return this._cachedCount!==it._UNINITIALIZED?l.wrap(this._cachedCount):(this._itemsCountPromise?t=this._itemsCountPromise:(t=this._itemsCountPromise=this._itemsManager.dataSource.getCount().then(function(t){return t===nt.CountResult.unknown&&(t=0),n._cachedCount=t,n._selection._updateCount(n._cachedCount),t},function(){return l.cancel}),this._itemsCountPromise.then(i,i)),t)},_isSelected:function(n){return this._selection._isIncluded(n)},_LoadingState:{itemsLoading:"itemsLoading",viewPortLoaded:"viewPortLoaded",itemsLoaded:"itemsLoaded",complete:"complete"},_raiseViewLoading:function(n){this._loadingState!==this._LoadingState.itemsLoading&&(this._scrolling=!!n);this._setViewState(this._LoadingState.itemsLoading)},_raiseViewComplete:function(){this._disposed||this._view.animating||this._setViewState(this._LoadingState.complete)},_raiseHeaderFooterVisibilityEvent:function(){var t=this,u=function(n){if(!n)return!1;var i=t._lastScrollPosition,r=n[t._horizontal()?"offsetLeft":"offsetTop"],u=n[t._horizontal()?"offsetWidth":"offsetHeight"];return r+u>i&&r<i+t._getViewportLength()},f=function(i,r){var u=n.document.createEvent("CustomEvent");u.initCustomEvent(i,!0,!0,{visible:r});t._element.dispatchEvent(u)},i=!!this._header&&u(this._headerContainer),r=!!this._footer&&u(this._footerContainer);this._headerFooterVisibilityStatus.headerVisible!==i&&(this._headerFooterVisibilityStatus.headerVisible=i,f("headervisibilitychanged",i));this._headerFooterVisibilityStatus.footerVisible!==r&&(this._headerFooterVisibilityStatus.footerVisible=r,f("footervisibilitychanged",r))},_setViewState:function(t){var i,r;if(t!==this._loadingState){i={scrolling:!1};switch(t){case this._LoadingState.viewPortLoaded:this._scheduledForDispose||(gt(this),this._scheduledForDispose=!0);this._setViewState(this._LoadingState.itemsLoading);break;case this._LoadingState.itemsLoaded:i={scrolling:this._scrolling};this._setViewState(this._LoadingState.viewPortLoaded);break;case this._LoadingState.complete:this._setViewState(this._LoadingState.itemsLoaded);this._updateDeleteWrapperSize(!0)}this._writeProfilerMark("loadingStateChanged:"+t+",info");this._loadingState=t;r=n.document.createEvent("CustomEvent");r.initCustomEvent("loadingstatechanged",!0,!1,i);this._element.dispatchEvent(r)}},_createTemplates:function(){function t(t,i){var r=n.document.createElement("div");return r.className=t,i||r.setAttribute("aria-hidden",!0),r}this._itemBoxTemplate=t(it._itemBoxClass,!0)},_updateSelection:function(){var t=this._selection.getIndices(),i=this._selection.isEverything(),r={},n,u,f;if(!i)for(n=0,u=t.length;n<u;n++)f=t[n],r[f]=!0;this._view.items.each(function(n,t,u){if(u.itemBox){var f=i||!!r[n];rt._ItemEventsHandler.renderSelection(u.itemBox,t,f,!0);u.container&&w[f?"addClass":"removeClass"](u.container,it._selectedClass)}})},_getViewportLength:function(){return this._getViewportSize()[this._horizontal()?"width":"height"]},_horizontal:function(){return this._horizontalLayout},_rtl:function(){return typeof this._cachedRTL!="boolean"&&(this._cachedRTL=n.getComputedStyle(this._element,null).direction==="rtl"),this._cachedRTL},_showProgressBar:function(n,t,i){var r=this._progressBar,f=r.style,u;r.parentNode||(this._fadingProgressBar=!1,this._progressIndicatorDelayTimer&&this._progressIndicatorDelayTimer.cancel(),u=this,this._progressIndicatorDelayTimer=l.timeout(it._LISTVIEW_PROGRESS_DELAY).then(function(){u._isZombie()||(n.appendChild(r),s.fadeIn(r),u._progressIndicatorDelayTimer=null)}));f[this._rtl()?"right":"left"]=t;f.top=i},_hideProgressBar:function(){var n,t;this._progressIndicatorDelayTimer&&(this._progressIndicatorDelayTimer.cancel(),this._progressIndicatorDelayTimer=null);n=this._progressBar;n.parentNode&&!this._fadingProgressBar&&(this._fadingProgressBar=!0,t=this,s.fadeOut(n).then(function(){n.parentNode&&n.parentNode.removeChild(n);t._fadingProgressBar=!1}))},_getPanAxis:function(){return this._horizontal()?"horizontal":"vertical"},_configureForZoom:function(n,t,u){if(i.validation&&(!this._view.realizePage||typeof this._view.begin!="number"))throw new r("WinJS.UI.ListView.NotCompatibleWithSemanticZoom",kt.notCompatibleWithSemanticZoom);this._isZoomedOut=n;this._disableEntranceAnimation=!t;this._isCurrentZoomView=t;this._triggerZoom=u},_setCurrentItem:function(n,t){this._rtl()&&(n=this._viewportWidth-n);this._horizontal()?n+=this.scrollPosition:t+=this.scrollPosition;var i=this._view.hitTest(n,t),r={type:i.type?i.type:nt.ObjectType.item,index:i.index};r.index>=0&&(this._hasKeyboardFocus?this._changeFocus(r,!0,!1,!0):this._changeFocusPassively(r))},_getCurrentItem:function(){var n=this._selection._getFocused(),t,i;return n.type===nt.ObjectType.groupHeader?n={type:nt.ObjectType.item,index:this._groups.group(n.index).startIndex}:n.type!==nt.ObjectType.item&&(n={type:nt.ObjectType.item,index:n.type===nt.ObjectType.header?0:this._cachedCount}),typeof n.index!="number"&&(this._setCurrentItem(.5*this._viewportWidth,.5*this._viewportHeight),n=this._selection._getFocused()),t=this,i=this._getItemOffsetPosition(n.index).then(function(n){var i=t._canvasStart;return n[t._startProperty]+=i,n}),l.join({item:this._dataSource.itemFromIndex(n.index),position:i})},_animateItemsForPhoneZoom:function(){function s(n,t,i){return function(r){return(t[r]-n)*i}}function r(){for(var t=0,i=n.length;t<i;t++)n[t].style[pt.scriptName]=""}for(var n=[],f=[],e=[],u=Number.MAX_VALUE,t=this,i=this._view.firstIndexDisplayed,o=Math.min(this._cachedCount,this._view.lastIndexDisplayed+1);i<o;i++)e.push(this._view.waitForEntityPosition({type:nt.ObjectType.item,index:i}).then(function(){var r,e;n.push(t._view.items.containerAt(i));r=0;t.layout._getItemPosition&&(e=t.layout._getItemPosition(i),e.row&&(r=e.row));f.push(r);u=Math.min(r,u)}));return l.join(e).then(function(){return(n.length===0?l.wrap():h.executeTransition(n,{property:pt.cssName,delay:s(u,f,30),duration:100,timing:"ease-in-out",from:t._isCurrentZoomView?"rotateX(0deg)":"rotateX(-90deg)",to:t._isCurrentZoomView?"rotateX(90deg)":"rotateX(0deg)"})).then(r,r)}).then(r,r)},_beginZoom:function(){var n,u,t,r,f;return this._zooming=!0,n=null,i.isPhone?this._isZoomedOut&&(this._zoomAnimationPromise&&this._zoomAnimationPromise.cancel(),this._isCurrentZoomView?(u=this,t=function(){u._zoomAnimationPromise=null},this._zoomAnimationPromise=n=this._animateItemsForPhoneZoom().then(t,t)):(this._zoomAnimationPromise=new v,n=this._zoomAnimationPromise.promise)):(r=this._horizontal(),f=-this.scrollPosition,w.addClass(this._viewport,r?it._zoomingXClass:it._zoomingYClass),this._canvasStart=f,w.addClass(this._viewport,r?it._zoomingYClass:it._zoomingXClass)),n},_positionItem:function(n,t){function h(n){return u._getItemOffsetPosition(n).then(function(r){var e=u._horizontal(),k=u._viewport[e?"scrollWidth":"scrollHeight"],v=e?u._viewportWidth:u._viewportHeight,y=e?"headerContainerWidth":"headerContainerHeight",s=u.layout._sizes,p=0,f,o,w,h,c,l,b,a;return s&&s[y]&&(p=s[y]),o=i.isPhone?p:t[u._startProperty],w=v-(e?r.width:r.height),o=Math.max(0,Math.min(w,o)),f=r[u._startProperty]-o,h=Math.max(0,Math.min(k-v,f)),c=h-f,f=h,l={type:nt.ObjectType.item,index:n},u._hasKeyboardFocus?u._changeFocus(l,!0):u._changeFocusPassively(l),u._raiseViewLoading(!0),i.isPhone?u._viewportScrollPosition=f:(b=-f,u._canvasStart=b),u._view.realizePage(f,!0),i.isPhone&&u._isZoomedOut&&(a=function(){u._zoomAnimationPromise&&u._zoomAnimationPromise.complete&&u._zoomAnimationPromise.complete();u._zoomAnimationPromise=null},u._animateItemsForPhoneZoom().then(a,a)),e?{x:c,y:0}:{x:0,y:c}})}var u=this,f=0,e,o,s;if(n&&(f=this._isZoomedOut?n.groupIndexHint:n.firstItemIndexHint),typeof f=="number")return h(f);if(o=this._isZoomedOut?n.groupKey:n.firstItemKey,typeof o=="string"&&this._dataSource.itemFromKey)e=this._dataSource.itemFromKey(o,this._isZoomedOut?{groupMemberKey:n.key,groupMemberIndex:n.index}:null);else{if(s=this._isZoomedOut?n.groupDescription:n.firstItemDescription,i.validation&&s===undefined)throw new r("WinJS.UI.ListView.InvalidItem",kt.listViewInvalidItem);e=this._dataSource.itemFromDescription(s)}return e.then(function(n){return h(n.index)})},_endZoom:function(n){if(!this._isZombie()){if(!i.isPhone){var t=this._canvasStart;w.removeClass(this._viewport,it._zoomingYClass);w.removeClass(this._viewport,it._zoomingXClass);this._canvasStart=0;this._viewportScrollPosition=-t}this._disableEntranceAnimation=!n;this._isCurrentZoomView=n;this._zooming=!1;this._view.realizePage(this.scrollPosition,!1)}},_getItemOffsetPosition:function(n){var t=this;return this._getItemOffset({type:nt.ObjectType.item,index:n}).then(function(n){return t._ensureFirstColumnRange(nt.ObjectType.item).then(function(){return n=t._correctRangeInFirstColumn(n,nt.ObjectType.item),n=t._convertFromCanvasCoordinates(n),t._horizontal()?(n.left=n.begin,n.width=n.end-n.begin,n.height=n.totalHeight):(n.top=n.begin,n.height=n.end-n.begin,n.width=n.totalWidth),n})})},_groupRemoved:function(n){this._groupFocusCache.deleteGroup(n)},_updateFocusCache:function(n){this._updateFocusCacheItemRequest&&this._updateFocusCacheItemRequest.cancel();var t=this;this._updateFocusCacheItemRequest=this._view.items.requestItem(n).then(function(){t._updateFocusCacheItemRequest=null;var i=t._view.items.itemDataAt(n),r=t._groups.groupFromItem(n),u=t._groups.group(r).key;i.itemsManagerRecord.item&&t._groupFocusCache.updateCache(u,i.itemsManagerRecord.item.key,n)})},_changeFocus:function(n,t,i,r,u){var f,e;this._isZombie()||(n.type===nt.ObjectType.item?(f=this._view.items.itemAt(n.index),!t&&f&&w.hasClass(f,it._nonSelectableClass)&&(t=!0),this._updateFocusCache(n.index)):n.type===nt.ObjectType.groupHeader?(this._lastFocusedElementInGroupTrack=n,e=this._groups.group(n.index),f=e&&e.header):(this._lastFocusedElementInGroupTrack=n,f=n.type===nt.ObjectType.footer?this._footer:this._header),this._unsetFocusOnItem(!!f),this._hasKeyboardFocus=!0,this._selection._setFocused(n,u),r||this.ensureVisible(n),!t&&this._selectFocused(i)&&this._selection.set(n.index),this._setFocusOnItem(n))},_changeFocusPassively:function(n){var t,i;switch(n.type){case nt.ObjectType.item:t=this._view.items.itemAt(n.index);this._updateFocusCache(n.index);break;case nt.ObjectType.groupHeader:this._lastFocusedElementInGroupTrack=n;i=this._groups.group(n.index);t=i&&i.header;break;case nt.ObjectType.header:this._lastFocusedElementInGroupTrack=n;t=this._header;break;case nt.ObjectType.footer:this._lastFocusedElementInGroupTrack=n;t=this._footer}this._unsetFocusOnItem(!!t);this._selection._setFocused(n);this._setFocusOnItem(n)},_drawFocusRectangle:function(t){var i,r;if(t!==this._header&&t!==this._footer)if(w.hasClass(t,it._headerClass))w.addClass(t,it._itemFocusClass);else{if(i=this._view.items.itemBoxFrom(t),i.querySelector("."+it._itemFocusOutlineClass))return;w.addClass(i,it._itemFocusClass);r=n.document.createElement("div");r.className=it._itemFocusOutlineClass;i.appendChild(r)}},_clearFocusRectangle:function(n){var t,i,r;n&&!this._isZombie()&&n!==this._header&&n!==this._footer&&(t=this._view.items.itemBoxFrom(n),t?(w.removeClass(t,it._itemFocusClass),i=t.querySelector("."+it._itemFocusOutlineClass),i&&i.parentNode.removeChild(i)):(r=this._groups.headerFrom(n),r&&w.removeClass(r,it._itemFocusClass)))},_defaultInvoke:function(n){(this._isZoomedOut||i.isPhone&&this._triggerZoom&&n.type===nt.ObjectType.groupHeader)&&(this._changeFocusPassively(n),this._triggerZoom())},_selectionAllowed:function(n){var t=n!==undefined?this.elementFromIndex(n):null,i=!(t&&w.hasClass(t,it._nonSelectableClass));return i&&this._selectionMode!==nt.SelectionMode.none},_multiSelection:function(){return this._selectionMode===nt.SelectionMode.multi},_selectOnTap:function(){return this._tap===nt.TapBehavior.toggleSelect||this._tap===nt.TapBehavior.directSelect},_selectFocused:function(n){return this._tap===nt.TapBehavior.directSelect&&this._selectionMode===nt.SelectionMode.multi&&!n},_dispose:function(){var n,t;this._disposed||(this._disposed=!0,n=function(n){n&&(n.textContent="")},w._resizeNotifier.unsubscribe(this._element,this._onMSElementResizeBound),this._batchingViewUpdates&&this._batchingViewUpdates.cancel(),this._view&&this._view._dispose&&this._view._dispose(),this._mode&&this._mode._dispose&&this._mode._dispose(),this._groups&&this._groups._dispose&&this._groups._dispose(),this._selection&&this._selection._dispose&&this._selection._dispose(),this._layout&&this._layout.uninitialize&&this._layout.uninitialize(),this._itemsCountPromise&&this._itemsCountPromise.cancel(),this._versionManager&&this._versionManager._dispose(),this._clearInsertedItems(),this._itemsManager&&this._itemsManager.release(),this._zoomAnimationPromise&&this._zoomAnimationPromise.cancel(),n(this._viewport),n(this._canvas),n(this._canvasProxy),this._versionManager=null,this._view=null,this._mode=null,this._element=null,this._viewport=null,this._itemsManager=null,this._canvas=null,this._canvasProxy=null,this._itemsCountPromise=null,this._scrollToFunctor=null,t=yt.indexOf(this),t>=0&&yt.splice(t,1))},_isZombie:function(){return this._disposed||!(this.element.firstElementChild&&n.document.body.contains(this.element))},_ifZombieDispose:function(){var n=this._isZombie();return n&&!this._disposed&&gt(this),n},_animationsDisabled:function(){return this._viewportWidth===0||this._viewportHeight===0?!0:!h.isAnimationEnabled()},_fadeOutViewport:function(){var n=this;return new l(function(t){if(n._animationsDisabled()){t();return}if(!n._fadingViewportOut){n._waitingEntranceAnimationPromise&&(n._waitingEntranceAnimationPromise.cancel(),n._waitingEntranceAnimationPromise=null);var i=n._fireAnimationEvent(wt.contentTransition);n._firedAnimationEvent=!0;i.prevented?(n._disableEntranceAnimation=!0,n._viewport.style.opacity=1,t()):(n._fadingViewportOut=!0,n._viewport.style.overflow="hidden",s.fadeOut(n._viewport).then(function(){n._isZombie()||(n._fadingViewportOut=!1,n._viewport.style.opacity=1,t())}))}})},_animateListEntrance:function(){function r(){n._canvas.style.opacity=1;n._headerContainer.style.opacity=1;n._footerContainer.style.opacity=1;n._viewport.style.overflow="";n._raiseHeaderFooterVisibilityEvent()}var t={prevented:!1,animationPromise:l.wrap()},n=this;return(this._raiseHeaderFooterVisibilityEvent(),this._disableEntranceAnimation||this._animationsDisabled())?(r(),this._waitingEntranceAnimationPromise&&(this._waitingEntranceAnimationPromise.cancel(),this._waitingEntranceAnimationPromise=null),l.wrap()):(this._firedAnimationEvent?this._firedAnimationEvent=!1:t=this._fireAnimationEvent(wt.entrance),t.prevented||i.isPhone?(r(),l.wrap()):(this._waitingEntranceAnimationPromise&&this._waitingEntranceAnimationPromise.cancel(),this._canvas.style.opacity=0,this._viewport.style.overflow="hidden",this._headerContainer.style.opacity=1,this._footerContainer.style.opacity=1,this._waitingEntranceAnimationPromise=t.animationPromise.then(function(){if(!n._isZombie())return n._canvas.style.opacity=1,s.enterContent(n._viewport).then(function(){n._isZombie()||(n._waitingEntranceAnimationPromise=null,n._viewport.style.overflow="")})}),this._waitingEntranceAnimationPromise))},_fireAnimationEvent:function(t){var i=n.document.createEvent("CustomEvent"),r=l.wrap(),u;return i.initCustomEvent("contentanimating",!0,!0,{type:t}),t===wt.entrance&&(i.detail.setPromise=function(n){r=n}),u=!this._element.dispatchEvent(i),{prevented:u,animationPromise:r}},_createAriaMarkers:function(){this._viewport.getAttribute("aria-label")||this._viewport.setAttribute("aria-label",kt.listViewViewportAriaLabel);this._ariaStartMarker||(this._ariaStartMarker=n.document.createElement("div"),this._ariaStartMarker.id=vt(this._ariaStartMarker),this._viewport.insertBefore(this._ariaStartMarker,this._viewport.firstElementChild));this._ariaEndMarker||(this._ariaEndMarker=n.document.createElement("div"),this._ariaEndMarker.id=vt(this._ariaEndMarker),this._viewport.appendChild(this._ariaEndMarker))},_updateItemsAriaRoles:function(){var i=this,r=this._element.getAttribute("role"),n,t;this._currentMode().staticMode()?(n="list",t="listitem"):(n="listbox",t="option");(r!==n||this._itemRole!==t)&&(this._element.setAttribute("role",n),this._itemRole=t,this._view.items.each(function(n,t){t.setAttribute("role",i._itemRole)}))},_updateGroupHeadersAriaRoles:function(){var i=this.groupHeaderTapBehavior===nt.GroupHeaderTapBehavior.none?"separator":"link",n,r,t;if(this._headerRole!==i)for(this._headerRole=i,n=0,r=this._groups.length();n<r;n++)t=this._groups.group(n).header,t&&t.setAttribute("role",this._headerRole)},_setAriaSelected:function(n,t){var i=n.getAttribute("aria-selected")==="true";t!==i&&n.setAttribute("aria-selected",t)},_setupAriaSelectionObserver:function(n){n._mutationObserver||(this._mutationObserver.observe(n,{attributes:!0,attributeFilter:["aria-selected"]}),n._mutationObserver=!0)},_itemPropertyChange:function(n){function h(n){n.forEach(function(n){n.item.setAttribute("aria-selected",!n.selected)})}var r,c,e,a,o;if(!this._isZombie()){var t=this,y=t._selectionMode===nt.SelectionMode.single,i=[],s=[];for(r=0,c=n.length;r<c;r++){var u=n[r].target,f=t._view.items.itemBoxFrom(u),l=u.getAttribute("aria-selected")==="true";f&&l!==w._isSelectionRendered(f)&&(e=t._view.items.index(f),a={index:e,item:u,selected:l},(t._selectionAllowed(e)?i:s).push(a))}i.length>0&&(o=new v,t.selection._synchronize(o).then(function(){var n=t.selection._cloneSelection();return i.forEach(function(t){t.selected?n[y?"set":"add"](t.index):n.remove(t.index)}),t.selection._set(n)}).then(function(n){t._isZombie()||n||h(i);o.complete()}));h(s)}},_groupsEnabled:function(){return!!this._groups.groupDataSource},_getItemPosition:function(n,t){var i=this;return this._view.waitForEntityPosition(n).then(function(){var r,f=i._zooming&&i._canvasStart!==0,o,s,u,e;switch(n.type){case nt.ObjectType.item:r=i._view.getContainer(n.index);break;case nt.ObjectType.groupHeader:r=i._view._getHeaderContainer(n.index);break;case nt.ObjectType.header:f=!0;r=i._headerContainer;break;case nt.ObjectType.footer:f=!0;r=i._footerContainer}return r?(i._writeProfilerMark("WinJS.UI.ListView:getItemPosition,info"),i._view._expandedRange?(o=i._view._expandedRange.first.index,s=i._view._expandedRange.last.index):t=!1,t=n.type===nt.ObjectType.item?!!t&i._view._ensureContainerInDOM(n.index):!1,u=i._getItemMargins(n.type),e={left:i._rtl()?ni(r)-u.right:r.offsetLeft-u.left,top:r.offsetTop-u.top,totalWidth:w.getTotalWidth(r),totalHeight:w.getTotalHeight(r),contentWidth:w.getContentWidth(r),contentHeight:w.getContentHeight(r)},t&&i._view._forceItemsBlocksInDOM(o,s+1),f?e:i._convertToCanvasCoordinates(e)):l.cancel})},_getItemOffset:function(n,t){var i=this;return this._getItemPosition(n,t).then(function(t){var r=i._getItemMargins(n.type),u;return i._horizontal()?(u=i._rtl(),t.begin=t.left-r[u?"left":"right"],t.end=t.left+t.totalWidth+r[u?"right":"left"]):(t.begin=t.top-r.bottom,t.end=t.top+t.totalHeight+r.top),t})},_getItemMargins:function(t){t=t||nt.ObjectType.item;var r=this,i=function(t){var i=r._canvas.querySelector("."+t),u,f;return i||(i=n.document.createElement("div"),w.addClass(i,t),r._viewport.appendChild(i),u=!0),f=ct._getMargins(i),u&&r._viewport.removeChild(i),f};return t===nt.ObjectType.item?this._itemMargins?this._itemMargins:this._itemMargins=i(it._containerClass):t===nt.ObjectType.groupHeader?this._headerMargins?this._headerMargins:this._headerMargins=i(it._headerContainerClass):(this._headerFooterMargins||(this._headerFooterMargins={headerMargins:i(it._listHeaderContainerClass),footerMargins:i(it._listFooterContainerClass)}),this._headerFooterMargins[t===nt.ObjectType.header?"headerMargins":"footerMargins"])},_fireAccessibilityAnnotationCompleteEvent:function(t,i,r,u){var e={firstIndex:t,lastIndex:i,firstHeaderIndex:+r||-1,lastHeaderIndex:+u||-1},f=n.document.createEvent("CustomEvent");f.initCustomEvent("accessibilityannotationcomplete",!0,!1,e);this._element.dispatchEvent(f)},_ensureFirstColumnRange:function(n){var t,i;return n===nt.ObjectType.header||n===nt.ObjectType.footer?l.wrap():(t=n===nt.ObjectType.item?"_firstItemRange":"_firstHeaderRange",this[t]?l.wrap():(i=this,this._getItemOffset({type:n,index:0},!0).then(function(n){i[t]=n})))},_correctRangeInFirstColumn:function(n,t){if(t===nt.ObjectType.header||t===nt.ObjectType.footer)return n;var i=t===nt.ObjectType.groupHeader?this._firstHeaderRange:this._firstItemRange;return i.begin===n.begin&&(n.begin=this._horizontal()?-this._getCanvasMargins()[this._rtl()?"right":"left"]:-this._getCanvasMargins().top),n},_updateContainers:function(t,i,r,u){function vt(){var t=n.document.createElement("div");return t.className=it._containerClass,t}function yt(t,i,r){var a,ut,k,ft,et,g,rt,w,ht,nt,o,ct,l,c;i+r>y&&(r=y-i);var tt=t.itemsContainer,f=tt.itemsBlocks,s=e._view._blockSize,u=f.length?f[f.length-1]:null,h=f.length?(f.length-1)*s+u.items.length:0,p=r-h,w;if(p>0){if(a=p,u&&u.items.length<s){for(k=Math.min(a,s-u.items.length),ut=u.items.length,ft=st._stripedContainers(k,h),d.insertAdjacentHTMLUnsafe(u.element,"beforeend",ft),w=u.element.children,o=0;o<k;o++)u.items.push(w[ut+o]);a-=k}h=f.length*s;var v=Math.floor(a/s),it="",lt=h,at=h+s;for(v>0&&(et=["<div class='win-itemsblock'>"+st._stripedContainers(s,lt)+"<\/div>","<div class='win-itemsblock'>"+st._stripedContainers(s,at)+"<\/div>"],it=st._repeat(et,v),h+=v*s),g=a%s,g>0&&(it+="<div class='win-itemsblock'>"+st._stripedContainers(g,h)+"<\/div>",h+=g,v++),rt=n.document.createElement("div"),d.setInnerHTMLUnsafe(rt,it),w=rt.children,o=0;o<v;o++)l=w[o],ht={element:l,items:st._nodeListToArray(l.children)},f.push(ht)}else if(p<0)for(c=p;c<0;c++)nt=u.items.pop(),!e._view._requireFocusRestore&&nt.contains(n.document.activeElement)&&(e._view._requireFocusRestore=n.document.activeElement,e._unsetFocusOnItem()),u.element.removeChild(nt),b.push(nt),u.items.length||(tt.element===u.element.parentNode&&tt.element.removeChild(u.element),f.pop(),u=f[f.length-1]);for(o=0,ct=f.length;o<ct;o++)for(l=f[o],c=0;c<l.items.length;c++)ot.push(l.items[c])}function ti(n,t,i){for(var o=u.filter(function(n){return n.oldIndex===-1&&n.newIndex>=t&&n.newIndex<t+i}).sort(function(n,t){return n.newIndex-t.newIndex}),r=n.itemsContainer,f=0,h=o.length;f<h;f++){var c=o[f],e=c.newIndex-t,s=vt(),l=e<r.items.length?r.items[e]:null;r.items.splice(e,0,s);r.element.insertBefore(s,l)}}function pt(n,t,i){var u,f,o,s,e,r,h;if(t+i>y&&(i=y-t),u=n.itemsContainer,f=i-u.items.length,f>0)for(o=u.element.children,s=o.length,d.insertAdjacentHTMLUnsafe(u.element,"beforeend",st._repeat("<div class='win-container win-backdrop'><\/div>",f)),r=0;r<f;r++)e=o[s+r],u.items.push(e);for(r=f;r<0;r++)e=u.items.pop(),u.element.removeChild(e),b.push(e);for(r=0,h=u.items.length;r<h;r++)ot.push(u.items[r])}function ii(n,t){var r=e._view._createHeaderContainer(tt),i={header:r,itemsContainer:{element:e._view._createItemsContainer(r)}};return i.itemsContainer[e._view._blockSize?"itemsBlocks":"items"]=[],e._view._blockSize?yt(i,t,n.size):pt(i,t,n.size),i}function ri(n,t,r,f){for(var p,w,b,o,a,k,l,y,g=r+f-1,c,h,s=0,v=u.length;s<v;s++)o=u[s],o.newIndex>=r&&o.newIndex<=g&&o.oldIndex!==-1&&(c!==+c||o.newIndex<c)&&(c=o.newIndex,h=o.newIndex-o.oldIndex);if(c===+c){for(p=0,s=0,v=u.length;s<v;s++)o=u[s],o.newIndex>=r&&o.newIndex<c&&o.oldIndex===-1&&p++;for(w=0,b=c-h,s=0,v=u.length;s<v;s++)o=u[s],o.oldIndex>=t&&o.oldIndex<b&&o.newIndex===-1&&w++;if(h+=w,h-=p,h-=r-t,a=n.itemsContainer,h>0)for(k=a.element.children,d.insertAdjacentHTMLUnsafe(a.element,"afterBegin",st._repeat("<div class='win-container win-backdrop'><\/div>",h)),l=0;l<h;l++)y=k[l],a.items.splice(l,0,y);for(l=h;l<0;l++)y=a.items.shift(),a.element.removeChild(y);h&&e._affectedRange.add({start:r,end:r+f},i)}}function ui(n){for(var t=0,i=0,u=e._view.tree.length;i<u;i++){var f=e._view.tree[i],r=f.itemsContainer.items.length,o=t+r-1;if(n>=t&&n<=o)return{group:i,item:n-t};t+=r}}var e=this,gt=this._view.containers.length+r,ni=gt<i,y,ft,ht,s,ct,k,tt,rt,g,a,ut,at,v,f,h,nt,o;if(ni){for(ft=0,f=0;f<u.length;f++)u[f].oldIndex===-1&&ft++;y=this._view.containers.length+ft}else y=i;var p=[],et={},ot=[],b=[];if(ht=[],s=0,!e._view._blockSize)for(f=0,h=this._view.tree.length;f<h;f++)ht.push(s),s+=this._view.tree[f].itemsContainer.items.length;if(!e._view._blockSize)for(ct=u.filter(function(n){return n.newIndex===-1&&!n._removalHandled}).sort(function(n,t){return t.oldIndex-n.oldIndex}),f=0,h=ct.length;f<h;f++){k=ct[f];k._removalHandled=!0;nt=k._itemBox;k._itemBox=null;var g=ui(k.oldIndex),wt=this._view.tree[g.group],o=wt.itemsContainer.items[g.item];o.parentNode.removeChild(o);w.hasClass(nt,it._selectedClass)&&w.addClass(o,it._selectedClass);wt.itemsContainer.items.splice(g.item,1);k.element=o}for(this._view._modifiedGroups=[],tt=this._canvasProxy,s=0,f=0,h=t.length;f<h&&(!this._groupsEnabled()||s<y);f++){var c=t[f],lt=this._view.keyToGroupIndex[c.key],l=this._view.tree[lt];l?(e._view._blockSize?yt(l,s,c.size):(ri(l,ht[lt],s,c.size),ti(l,s,c.size),pt(l,s,c.size)),p.push(l),et[c.key]=p.length-1,delete this._view.keyToGroupIndex[c.key],tt=l.itemsContainer.element,this._view._modifiedGroups.push({oldIndex:lt,newIndex:p.length-1,element:l.header})):(rt=ii(c,s),p.push(rt),et[c.key]=p.length-1,this._view._modifiedGroups.push({oldIndex:-1,newIndex:p.length-1,element:rt.header}),tt=rt.itemsContainer.element);s+=c.size}var bt=[],kt=[],dt=this._view.keyToGroupIndex?Object.keys(this._view.keyToGroupIndex):[];for(f=0,h=dt.length;f<h;f++){if(g=this._view.keyToGroupIndex[dt[f]],a=this._view.tree[g],kt.push(a.header),bt.push(a.itemsContainer.element),this._view._blockSize)for(ut=0;ut<a.itemsContainer.itemsBlocks.length;ut++)for(at=a.itemsContainer.itemsBlocks[ut],v=0;v<at.items.length;v++)b.push(at.items[v]);else for(v=0;v<a.itemsContainer.items.length;v++)b.push(a.itemsContainer.items[v]);this._view._modifiedGroups.push({oldIndex:g,newIndex:-1,element:a.header})}for(f=0,h=u.length;f<h;f++)u[f].newIndex!==-1||u[f]._removalHandled||(u[f]._removalHandled=!0,nt=u[f]._itemBox,u[f]._itemBox=null,b.length?(o=b.pop(),w.empty(o)):o=vt(),w.hasClass(nt,it._selectedClass)&&w.addClass(o,it._selectedClass),u._containerStripe===it._containerEvenClass?(w.addClass(o,it._containerEvenClass),w.removeClass(o,it._containerOddClass)):(w.addClass(o,it._containerOddClass),w.removeClass(o,it._containerEvenClass)),o.appendChild(nt),u[f].element=o);return this._view.tree=p,this._view.keyToGroupIndex=et,this._view.containers=ot,{removedHeaders:kt,removedItemsContainers:bt}},_writeProfilerMark:function(n){var t="WinJS.UI.ListView:"+this._id+":"+n;o(t);f.log&&f.log(t,null,"listviewprofiler")}},{triggerDispose:function(){dt()}});return t.Class.mix(e,u.createEventProperties("iteminvoked","groupheaderinvoked","selectionchanging","selectionchanged","loadingstatechanged","keyboardnavigating","contentanimating","itemdragstart","itemdragenter","itemdragend","itemdragbetween","itemdragleave","itemdragchanged","itemdragdrop","headervisibilitychanged","footervisibilitychanged","accessibilityannotationcomplete")),t.Class.mix(e,y.DOMEventMixin),e})})}),t("WinJS/Controls/FlipView/_Constants",[],function(){"use strict";var n={};return n.datasourceCountChangedEvent="datasourcecountchanged",n.pageVisibilityChangedEvent="pagevisibilitychanged",n.pageSelectedEvent="pageselected",n.pageCompletedEvent="pagecompleted",n}),t("WinJS/Controls/FlipView/_PageManager",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Log","../../Core/_Resources","../../Core/_WriteProfilerMark","../../Animations","../../Promise","../../_Signal","../../Scheduler","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Utilities/_TabContainer","./_Constants"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{_FlipPageManager:i.Namespace._lazy(function(){function w(n){var t=n.winControl;return t&&t._isFlipView?!0:!1}function nt(n){n.forEach(function(n){var i=n.target,r,u;i.winControl&&i.tabIndex>=0&&(i.winControl._pageManager._updateTabIndex(i.tabIndex),i.tabIndex=-1);r=i.winControl;r&&r._isFlipView&&(u=!1,n.attributeName==="dir"?u=!0:n.attributeName==="style"&&(u=r._cachedStyleDir!==i.style.direction),u&&(r._cachedStyleDir=i.style.direction,r._pageManager._rtl=t.getComputedStyle(r._pageManager._flipperDiv,null).direction==="rtl",r._pageManager.resized()))})}var n=v._uniqueID,e=r._browserStyleEquivalents,k=50,d=250,g={get badCurrentPage(){return"Invalid argument: currentPage must be a number greater than or equal to zero and be within the bounds of the datasource"}},b=i.Class.define(function(n,i,u,f,e,o,s){this._visibleElements=[];this._flipperDiv=n;this._panningDiv=i;this._panningDivContainer=u;this._buttonVisibilityHandler=s;this._currentPage=null;this._rtl=t.getComputedStyle(this._flipperDiv,null).direction==="rtl";this._itemsManager=f;this._itemSpacing=e;this._tabIndex=v.getTabIndex(n);this._tabIndex<0&&(this._tabIndex=0);i.tabIndex=-1;n.tabIndex=-1;this._tabManager=new y.TabContainer(this._panningDivContainer);this._tabManager.tabIndex=this._tabIndex;this._lastSelectedPage=null;this._lastSelectedElement=null;this._bufferSize=b.flipPageBufferCount;this._cachedSize=-1;this._environmentSupportsTouch=o;var h=this;this._panningDiv.addEventListener("keydown",function(n){h._blockTabs&&n.keyCode===v.Key.tab&&(n.stopImmediatePropagation(),n.preventDefault())},!0);v._addEventListener(this._flipperDiv,"focusin",function(n){n.target===h._flipperDiv&&h._currentPage.element&&v._setActive(h._currentPage.element)},!1);new v._MutationObserver(nt).observe(this._flipperDiv,{attributes:!0,attributeFilter:["dir","style","tabindex"]});this._cachedStyleDir=this._flipperDiv.style.direction;this._handleManipulationStateChangedBound=this._handleManipulationStateChanged.bind(this);this._environmentSupportsTouch&&this._panningDivContainer.addEventListener(r._browserEventEquivalents.manipulationStateChanged,this._handleManipulationStateChangedBound,!0)},{initialize:function(i,r){var u=null,e,f;if(this._panningDivContainerOffsetWidth=this._panningDivContainer.offsetWidth,this._panningDivContainerOffsetHeight=this._panningDivContainer.offsetHeight,this._isHorizontal=r,!this._currentPage){for(this._bufferAriaStartMarker=t.document.createElement("div"),this._bufferAriaStartMarker.id=n(this._bufferAriaStartMarker),this._panningDiv.appendChild(this._bufferAriaStartMarker),this._currentPage=this._createFlipPage(null,this),u=this._currentPage,this._panningDiv.appendChild(u.pageRoot),e=2*this._bufferSize,f=0;f<e;f++)u=this._createFlipPage(u,this),this._panningDiv.appendChild(u.pageRoot);this._bufferAriaEndMarker=t.document.createElement("div");this._bufferAriaEndMarker.id=n(this._bufferAriaEndMarker);this._panningDiv.appendChild(this._bufferAriaEndMarker)}this._prevMarker=this._currentPage.prev.prev;this._itemsManager&&this.setNewItemsManager(this._itemsManager,i)},dispose:function(){var t=this._currentPage,n=t;do a._disposeElement(n.element),n=n.next;while(n!==t)},setOrientation:function(n){var i,t;if(this._notificationsEndedSignal){t=this;this._notificationsEndedSignal.promise.done(function(){t._notificationsEndedSignal=null;t.setOrientation(n)});return}n!==this._isHorizontal&&(this._isOrientationChanging=!0,this._isHorizontal?v.setScrollPosition(this._panningDivContainer,{scrollLeft:this._getItemStart(this._currentPage),scrollTop:0}):v.setScrollPosition(this._panningDivContainer,{scrollLeft:0,scrollTop:this._getItemStart(this._currentPage)}),this._isHorizontal=n,i=this._panningDivContainer.style,i.overflowX="hidden",i.overflowY="hidden",t=this,r._requestAnimationFrame(function(){t._isOrientationChanging=!1;t._forEachPage(function(n){var t=n.pageRoot.style;t.left="0px";t.top="0px"});i.overflowX=t._isHorizontal&&t._environmentSupportsTouch?"scroll":"hidden";i.overflowY=t._isHorizontal||!t._environmentSupportsTouch?"hidden":"scroll";t._ensureCentered()}))},resetState:function(n){var i,t,f;if(this._writeProfilerMark("WinJS.UI.FlipView:resetState,info"),n!==0){if(i=this.jumpToIndex(n,!0),!i&&r.validation)throw new u("WinJS.UI.FlipView.BadCurrentPage",g.badCurrentPage);return i}return a.disposeSubTree(this._flipperDiv),this._resetBuffer(null,!0),t=this,f=h.wrap(!0),this._itemsManager&&(f=t._itemsManager._firstItem().then(function(n){return t._currentPage.setElement(n),t._fetchPreviousItems(!0).then(function(){return t._fetchNextItems()}).then(function(){t._setButtonStates()})})),f.then(function(){t._tabManager.childFocus=t._currentPage.element;t._ensureCentered();t._itemSettledOn()})},setNewItemsManager:function(n,t){this._itemsManager=n;var i=this;return this.resetState(t).then(function(){t!==0&&(i._tabManager.childFocus=i._currentPage.element,i._ensureCentered(),i._itemSettledOn())})},currentIndex:function(){if(!this._itemsManager)return 0;var n=0,t=this._navigationAnimationRecord?this._navigationAnimationRecord.newCurrentElement:this._currentPage.element;return t&&(n=this._getElementIndex(t)),n},resetScrollPos:function(){this._ensureCentered()},scrollPosChanged:function(){if(this._hasFocus&&(this._hadFocus=!0),this._itemsManager&&this._currentPage.element&&!this._isOrientationChanging){var t=this._getViewportStart(),n=this._lastScrollPos>t?this._getTailOfBuffer():this._getHeadOfBuffer();if(t!==this._lastScrollPos){while(this._currentPage.element&&this._getItemStart(this._currentPage)>t&&this._currentPage.prev.element)this._currentPage=this._currentPage.prev,this._fetchOnePrevious(n.prev),n=n.prev;while(this._currentPage.element&&this._itemEnd(this._currentPage)<=t&&this._currentPage.next.element)this._currentPage=this._currentPage.next,this._fetchOneNext(n.next),n=n.next;this._setButtonStates();this._checkElementVisibility(!1);this._blockTabs=!0;this._lastScrollPos=t;this._currentPage.element&&(this._tabManager.childFocus=this._currentPage.element);this._setListEnds();!this._manipulationState&&this._viewportOnItemStart()&&(this._currentPage.element.setAttribute("aria-setsize",this._cachedSize),this._currentPage.element.setAttribute("aria-posinset",this.currentIndex()+1),this._timeoutPageSelection())}}},itemRetrieved:function(n,t){var u=this,r,i,f;if(this._forEachPage(function(i){if(i.element===t)return i===u._currentPage||i===u._currentPage.next?u._changeFlipPage(i,t,n):i.setElement(n,!0),!0}),this._navigationAnimationRecord&&this._navigationAnimationRecord.elementContainers)for(r=this._navigationAnimationRecord.elementContainers,i=0,f=r.length;i<f;i++)r[i].element===t&&(u._changeFlipPage(r[i],t,n),r[i].element=n);this._checkElementVisibility(!1)},resized:function(){this._panningDivContainerOffsetWidth=this._panningDivContainer.offsetWidth;this._panningDivContainerOffsetHeight=this._panningDivContainer.offsetHeight;var n=this;this._forEachPage(function(t){t.pageRoot.style.width=n._panningDivContainerOffsetWidth+"px";t.pageRoot.style.height=n._panningDivContainerOffsetHeight+"px"});this._ensureCentered();this._writeProfilerMark("WinJS.UI.FlipView:resize,StopTM")},jumpToIndex:function(n,t){var u,f,r,i;return!t&&(!this._itemsManager||!this._currentPage.element||n<0||(u=this._getElementIndex(this._currentPage.element),f=Math.abs(n-u),f===0))?h.wrap(!1):(r=h.wrap(!0),i=this,r=r.then(function(){var r=i._itemsManager._itemPromiseAtIndex(n);return h.join({element:i._itemsManager._itemFromItemPromise(r),item:r}).then(function(n){var r=n.element;return(i._resetBuffer(r,t),!r)?!1:(i._currentPage.setElement(r),i._fetchNextItems().then(function(){return i._fetchPreviousItems(!0)}).then(function(){return!0}))})}),r.then(function(n){return i._setButtonStates(),n}))},startAnimatedNavigation:function(t,i,r){var s,e,h,o,u,f;return(this._writeProfilerMark("WinJS.UI.FlipView:startAnimatedNavigation,info"),this._currentPage.element&&(s=this._currentPage,e=t?this._currentPage.next:this._currentPage.prev,e.element))?(this._hasFocus&&v._setActive(this._panningDiv),this._navigationAnimationRecord={},this._navigationAnimationRecord.goForward=t,this._navigationAnimationRecord.cancelAnimationCallback=i,this._navigationAnimationRecord.completionCallback=r,this._navigationAnimationRecord.oldCurrentPage=s,this._navigationAnimationRecord.newCurrentPage=e,h=s.element,o=e.element,this._navigationAnimationRecord.newCurrentElement=o,s.setElement(null,!0),s.elementUniqueID=n(h),e.setElement(null,!0),e.elementUniqueID=n(o),u=this._createDiscardablePage(h),f=this._createDiscardablePage(o),u.pageRoot.itemIndex=this._getElementIndex(h),f.pageRoot.itemIndex=u.pageRoot.itemIndex+(t?1:-1),u.pageRoot.style.position="absolute",f.pageRoot.style.position="absolute",u.pageRoot.style.zIndex=1,f.pageRoot.style.zIndex=2,this._setItemStart(u,0),this._setItemStart(f,0),this._blockTabs=!0,this._visibleElements.push(o),this._announceElementVisible(o),this._navigationAnimationRecord.elementContainers=[u,f],{outgoing:u,incoming:f}):null},endAnimatedNavigation:function(n,t,i){if(this._writeProfilerMark("WinJS.UI.FlipView:endAnimatedNavigation,info"),this._navigationAnimationRecord&&this._navigationAnimationRecord.oldCurrentPage&&this._navigationAnimationRecord.newCurrentPage){var r=this._restoreAnimatedElement(this._navigationAnimationRecord.oldCurrentPage,t);this._restoreAnimatedElement(this._navigationAnimationRecord.newCurrentPage,i);r||this._setViewportStart(this._getItemStart(n?this._currentPage.next:this._currentPage.prev));this._navigationAnimationRecord=null;this._itemSettledOn()}},startAnimatedJump:function(t,i,r){if(this._writeProfilerMark("WinJS.UI.FlipView:startAnimatedJump,info"),this._hasFocus&&(this._hadFocus=!0),this._currentPage.element){var f=this._currentPage.element,e=this._getElementIndex(f),u=this;return u.jumpToIndex(t).then(function(o){var c,s,h;return o?(u._navigationAnimationRecord={},u._navigationAnimationRecord.cancelAnimationCallback=i,u._navigationAnimationRecord.completionCallback=r,u._navigationAnimationRecord.oldCurrentPage=null,u._forEachPage(function(n){if(n.element===f)return u._navigationAnimationRecord.oldCurrentPage=n,!0}),u._navigationAnimationRecord.newCurrentPage=u._currentPage,u._navigationAnimationRecord.newCurrentPage===u._navigationAnimationRecord.oldCurrentPage)?null:(c=u._currentPage.element,u._navigationAnimationRecord.newCurrentElement=c,u._currentPage.setElement(null,!0),u._currentPage.elementUniqueID=n(c),u._navigationAnimationRecord.oldCurrentPage&&u._navigationAnimationRecord.oldCurrentPage.setElement(null,!0),s=u._createDiscardablePage(f),h=u._createDiscardablePage(c),s.pageRoot.itemIndex=e,h.pageRoot.itemIndex=t,s.pageRoot.style.position="absolute",h.pageRoot.style.position="absolute",s.pageRoot.style.zIndex=1,h.pageRoot.style.zIndex=2,u._setItemStart(s,0),u._setItemStart(h,u._itemSize(u._currentPage)),u._visibleElements.push(c),u._announceElementVisible(c),u._navigationAnimationRecord.elementContainers=[s,h],u._blockTabs=!0,{oldPage:s,newPage:h}):null})}return h.wrap(null)},simulateMouseWheelScroll:function(n){var u,i,r;this._environmentSupportsTouch||this._waitingForMouseScroll||(u=typeof n.deltaY=="number"?(n.deltaX||n.deltaY)>0:n.wheelDelta<0,i=u?this._currentPage.next:this._currentPage.prev,i.element)&&(r={contentX:0,contentY:0,viewportX:0,viewportY:0},r[this._isHorizontal?"contentX":"contentY"]=this._getItemStart(i),v._zoomTo(this._panningDivContainer,r),this._waitingForMouseScroll=!0,t.setTimeout(function(){this._waitingForMouseScroll=!1}.bind(this),v._zoomToDuration+100))},endAnimatedJump:function(n,t){this._writeProfilerMark("WinJS.UI.FlipView:endAnimatedJump,info");this._navigationAnimationRecord.oldCurrentPage?this._navigationAnimationRecord.oldCurrentPage.setElement(n.element,!0):n.element.parentNode&&n.element.parentNode.removeChild(n.element);this._navigationAnimationRecord.newCurrentPage.setElement(t.element,!0);this._navigationAnimationRecord=null;this._ensureCentered();this._itemSettledOn()},inserted:function(t,i,r,u){var a;this._writeProfilerMark("WinJS.UI.FlipView:inserted,info");var f=this._prevMarker,c=!1,l=!1;if(u&&(this._createAnimationRecord(n(t),null),this._getAnimationRecord(t).inserted=!0),i){do{if(f===this._currentPage&&(c=!0),f.elementUniqueID===n(i)){l=!0;var e=f,o=t,s=n(t),h;if(c)while(e.next!==this._prevMarker)h=e.next.element,s=e.next.elementUniqueID,e.next.setElement(o,!0),!o&&s&&(e.next.elementUniqueID=s),o=h,e=e.next;else for(f.elementUniqueID===f.next.elementUniqueID&&f.elementUniqueID&&(e=f.next);e.next!==this._prevMarker;)h=e.element,s=e.elementUniqueID,e.setElement(o,!0),!o&&s&&(e.elementUniqueID=s),o=h,e=e.prev;o&&(a=!1,this._forEachPage(function(t){if(n(o)===t.elementUniqueID)return a=!0,!0}),a||this._releaseElementIfNotAnimated(o));break}f=f.next}while(f!==this._prevMarker)}else if(r){while(f.next!==this._prevMarker&&f.elementUniqueID!==n(r))f===this._currentPage&&(c=!0),f=f.next;f.elementUniqueID===n(r)&&f!==this._prevMarker?(f.prev.setElement(t),l=!0):this._releaseElementIfNotAnimated(t)}else this._currentPage.setElement(t);this._getAnimationRecord(t).successfullyMoved=l;this._setButtonStates()},changed:function(t,i){var f,u,o,r,e;if(this._writeProfilerMark("WinJS.UI.FlipView:changed,info"),f=this,this._forEachPage(function(r){if(r.elementUniqueID===n(i)){var u=f._animationRecords[r.elementUniqueID];return u.changed=!0,u.oldElement=i,u.newElement=t,r.element=t,r.elementUniqueID=n(t),f._animationRecords[n(t)]=u,!0}}),this._navigationAnimationRecord&&this._navigationAnimationRecord.elementContainers){for(u=0,o=this._navigationAnimationRecord.elementContainers.length;u<o;u++)r=this._navigationAnimationRecord.elementContainers[u],r&&r.elementUniqueID===n(i)&&(r.element=t,r.elementUniqueID=n(t));e=this._navigationAnimationRecord.newCurrentElement;e&&n(e)===n(i)&&(this._navigationAnimationRecord.newCurrentElement=t)}},moved:function(t,i,r){this._writeProfilerMark("WinJS.UI.FlipView:moved,info");var u=this._getAnimationRecord(t);u||(u=this._createAnimationRecord(n(t)));u.moved=!0;this.removed(t,!1,!1);i||r?this.inserted(t,i,r,!1):u.successfullyMoved=!1},removed:function(t,i,r){var c,l,f,e;this._writeProfilerMark("WinJS.UI.FlipView:removed,info");var o=this,u=this._prevMarker,s=h.wrap();if(i){c=!1;this._forEachPage(function(i){(i.elementUniqueID===n(t)||c)&&(i.setElement(null,!0),c=!0)});this._setButtonStates();return}if(r&&(l=this._getAnimationRecord(t),l&&(l.removed=!0)),this._currentPage.elementUniqueID===n(t))this._currentPage.next.elementUniqueID?(this._shiftLeft(this._currentPage),this._ensureCentered()):this._currentPage.prev.elementUniqueID?this._shiftRight(this._currentPage):this._currentPage.setElement(null,!0);else if(u.elementUniqueID===n(t))u.next.element?s=this._itemsManager._previousItem(u.next.element).then(function(n){return n===t&&(n=o._itemsManager._previousItem(n)),n}).then(function(n){u.setElement(n,!0)}):u.setElement(null,!0);else if(u.prev.elementUniqueID===n(t))u.prev.prev&&u.prev.prev.element?s=this._itemsManager._nextItem(u.prev.prev.element).then(function(n){return n===t&&(n=o._itemsManager._nextItem(n)),n}).then(function(n){u.prev.setElement(n,!0)}):u.prev.setElement(null,!0);else{for(f=this._currentPage.prev,e=!1;f!==u&&!e;)f.elementUniqueID===n(t)&&(this._shiftRight(f),e=!0),f=f.prev;for(f=this._currentPage.next;f!==u&&!e;)f.elementUniqueID===n(t)&&(this._shiftLeft(f),e=!0),f=f.next}return s.then(function(){o._setButtonStates()})},reload:function(){this._writeProfilerMark("WinJS.UI.FlipView:reload,info");this.resetState(0)},getItemSpacing:function(){return this._itemSpacing},setItemSpacing:function(n){this._itemSpacing=n;this._ensureCentered()},notificationsStarted:function(){this._writeProfilerMark("WinJS.UI.FlipView:changeNotifications,StartTM");this._logBuffer();this._notificationsStarted=this._notificationsStarted||0;this._notificationsStarted++;this._notificationsEndedSignal=new c;this._temporaryKeys=[];this._animationRecords={};var n=this;this._forEachPage(function(t){n._createAnimationRecord(t.elementUniqueID,t)});this._animationRecords.currentPage=this._currentPage.element;this._animationRecords.nextPage=this._currentPage.next.element},notificationsEnded:function(){var n=this;this._endNotificationsWork&&this._endNotificationsWork.cancel();this._endNotificationsWork=this._ensureBufferConsistency().then(function(){function c(t){var i=null;return n._forEachPage(function(n){if(n.element===t)return i=n,!0}),i}function o(t,i){n._writeProfilerMark("WinJS.UI.FlipView:_animateOldViewportItemRemoved,info");var u=n._createDiscardablePage(i);n._setItemStart(u,t.originalLocation);r.push(n._deleteFlipPage(u))}function s(t,i){var f,u,e,o;n._writeProfilerMark("WinJS.UI.FlipView:_animateOldViewportItemMoved,info");f=t.originalLocation;t.successfullyMoved?(u=c(i),f=t.newLocation):(u=n._createDiscardablePage(i),e=n._getElementIndex(i),o=n._currentPage.element?n._getElementIndex(n._currentPage.element):0,f+=o>e?-100*n._bufferSize:100*n._bufferSize);u&&(n._setItemStart(u,t.originalLocation),r.push(n._moveFlipPage(u,function(){n._setItemStart(u,f)})))}function e(){return r.length===0&&r.push(h.wrap()),h.join(r)}var r=[];n._forEachPage(function(t){var i=n._getAnimationRecord(t.element);i&&(i.changed&&(i.oldElement.removedFromChange=!0,r.push(n._changeFlipPage(t,i.oldElement,i.newElement))),i.newLocation=t.location,n._setItemStart(t,i.originalLocation),i.inserted&&(t.elementRoot.style.opacity=0))});var u=n._animationRecords.currentPage,t=n._getAnimationRecord(u),f=n._animationRecords.nextPage,i=n._getAnimationRecord(f);t&&t.changed&&(u=t.newElement);i&&i.changed&&(f=i.newElement);(u!==n._currentPage.element||f!==n._currentPage.next.element)&&(t&&t.removed&&o(t,u),i&&i.removed&&o(i,f));n._blockTabs=!0;e().then(function(){r=[];t&&t.moved&&s(t,u);i&&i.moved&&s(i,f);var o=n._getAnimationRecord(n._currentPage.element),h=n._getAnimationRecord(n._currentPage.next.element);n._forEachPage(function(u){var f=n._getAnimationRecord(u.element);f&&(f.inserted?f!==o&&f!==h&&(u.elementRoot.style.opacity=1):f.originalLocation!==f.newLocation&&((f===t||f===i)&&(f!==t||t.moved)&&(f!==i||i.moved)||r.push(n._moveFlipPage(u,function(){n._setItemStart(u,f.newLocation)}))))});e().then(function(){r=[];o&&o.inserted&&r.push(n._insertFlipPage(n._currentPage));h&&h.inserted&&r.push(n._insertFlipPage(n._currentPage.next));e().then(function(){n._checkElementVisibility(!1);n._itemSettledOn();n._setListEnds();n._notificationsStarted--;n._notificationsStarted===0&&n._notificationsEndedSignal.complete();n._writeProfilerMark("WinJS.UI.FlipView:changeNotifications,StopTM");n._logBuffer();n._endNotificationsWork=null})})})})},disableTouchFeatures:function(){var n,t;this._environmentSupportsTouch=!1;n=this._panningDivContainer.style;this._panningDivContainer.removeEventListener(r._browserEventEquivalents.manipulationStateChanged,this._handleManipulationStateChangedBound,!0);n.overflowX="hidden";n.overflowY="hidden";t=["scroll-snap-type","scroll-snap-points-x","scroll-snap-points-y","scroll-limit-x-min","scroll-limit-x-max","scroll-limit-y-min","scroll-limit-y-max"];t.forEach(function(t){var i=e[t];i&&(n[i.scriptName]="")})},_hasFocus:{get:function(){return this._flipperDiv.contains(t.document.activeElement)}},_timeoutPageSelection:function(){var n=this;this._lastTimeoutRequest&&this._lastTimeoutRequest.cancel();this._lastTimeoutRequest=h.timeout(d).then(function(){n._itemSettledOn()})},_updateTabIndex:function(n){this._forEachPage(function(t){t.element&&(t.element.tabIndex=n)});this._tabIndex=n;this._tabManager.tabIndex=n},_releaseElementIfNotAnimated:function(n){var t=this._getAnimationRecord(n);t&&(t.changed||t.inserted||t.moved||t.removed)||this._itemsManager.releaseItem(n)},_getAnimationRecord:function(t){return t?this._animationRecords[n(t)]:null},_createAnimationRecord:function(n,t){if(n){var i=this._animationRecords[n]={removed:!1,changed:!1,inserted:!1};return t&&(i.originalLocation=t.location),i}},_writeProfilerMark:function(n){o(n);this._flipperDiv.winControl.constructor._enabledDebug&&f.log&&f.log(n,null,"flipviewdebug")},_getElementIndex:function(n){var t=0;try{t=this._itemsManager.itemObject(n).index}catch(i){}return t},_resetBuffer:function(n,t){this._writeProfilerMark("WinJS.UI.FlipView:_resetBuffer,info");var r=this._currentPage,i=r;do i.element&&i.element===n||t?i.setElement(null,!0):i.setElement(null),i=i.next;while(i!==r)},_getHeadOfBuffer:function(){return this._prevMarker.prev},_getTailOfBuffer:function(){return this._prevMarker},_insertNewFlipPage:function(n){this._writeProfilerMark("WinJS.UI.FlipView:_insertNewFlipPage,info");var t=this._createFlipPage(n,this);return this._panningDiv.appendChild(t.pageRoot),t},_fetchNextItems:function(){var n,t,i;for(this._writeProfilerMark("WinJS.UI.FlipView:_fetchNextItems,info"),n=h.wrap(this._currentPage),t=this,i=0;i<this._bufferSize;i++)n=n.then(function(n){return n.next===t._prevMarker&&t._insertNewFlipPage(n),n.element?t._itemsManager._nextItem(n.element).then(function(t){return n.next.setElement(t),n.next}):(n.next.setElement(null),n.next)});return n},_fetchOneNext:function(n){var t,i;if(this._writeProfilerMark("WinJS.UI.FlipView:_fetchOneNext,info"),t=n.prev.element,this._prevMarker===n&&(this._prevMarker=this._prevMarker.next),!t){n.setElement(null);return}return i=this,this._itemsManager._nextItem(t).then(function(t){n.setElement(t);i._movePageAhead(n.prev,n)})},_fetchPreviousItems:function(n){var i,t,r;for(this._writeProfilerMark("WinJS.UI.FlipView:_fetchPreviousItems,info"),i=this,t=h.wrap(this._currentPage),r=0;r<this._bufferSize;r++)t=t.then(function(n){return n.element?i._itemsManager._previousItem(n.element).then(function(t){return n.prev.setElement(t),n.prev}):(n.prev.setElement(null),n.prev)});return t.then(function(t){n&&(i._prevMarker=t)})},_fetchOnePrevious:function(n){var t,i;return(this._writeProfilerMark("WinJS.UI.FlipView:_fetchOnePrevious,info"),t=n.next.element,this._prevMarker===n.next&&(this._prevMarker=this._prevMarker.prev),!t)?(n.setElement(null),h.wrap()):(i=this,this._itemsManager._previousItem(t).then(function(t){n.setElement(t);i._movePageBehind(n.next,n)}))},_setButtonStates:function(){this._currentPage.prev.element?this._buttonVisibilityHandler.showPreviousButton():this._buttonVisibilityHandler.hidePreviousButton();this._currentPage.next.element?this._buttonVisibilityHandler.showNextButton():this._buttonVisibilityHandler.hideNextButton()},_ensureCentered:function(n){var t,i;for(this._writeProfilerMark("WinJS.UI.FlipView:_ensureCentered,info"),this._setItemStart(this._currentPage,k*this._viewportSize()),t=this._currentPage;t!==this._prevMarker;)this._movePageBehind(t,t.prev),t=t.prev;for(t=this._currentPage;t.next!==this._prevMarker;)this._movePageAhead(t,t.next),t=t.next;i=!1;this._lastScrollPos&&!n&&(this._setListEnds(),i=!0);this._lastScrollPos=this._getItemStart(this._currentPage);this._setViewportStart(this._lastScrollPos);this._checkElementVisibility(!0);this._setupSnapPoints();i||this._setListEnds()},_ensureBufferConsistency:function(){var t=this,i=this._currentPage.element,f;if(!i)return h.wrap();var n=!1,r={},u={};return this._forEachPage(function(t){if(t&&t.elementUniqueID){if(r[t.elementUniqueID])return n=!0,!0;if(r[t.elementUniqueID]=!0,t.location>0){if(u[t.location])return n=!0,!0;u[t.location]=!0}}}),f=Object.keys(this._animationRecords),f.forEach(function(i){var r=t._animationRecords[i];r&&(r.changed||r.inserted||r.moved||r.removed)&&(n=!0)}),n?(this._resetBuffer(null,!0),this._currentPage.setElement(i),this._fetchNextItems().then(function(){return t._fetchPreviousItems(!0)}).then(function(){t._ensureCentered()})):h.wrap()},_shiftLeft:function(n){var t,i,r;for(this._writeProfilerMark("WinJS.UI.FlipView:_shiftLeft,info"),t=n,i=null;t!==this._prevMarker&&t.next!==this._prevMarker;)i=t.next.element,!i&&t.next.elementUniqueID&&(t.elementUniqueID=t.next.elementUniqueID),t.next.setElement(null,!0),t.setElement(i,!0),t=t.next;if(t!==this._prevMarker&&t.prev.element)return r=this,this._itemsManager._nextItem(t.prev.element).then(function(n){t.setElement(n);r._createAnimationRecord(t.elementUniqueID,t)})},_logBuffer:function(){if(this._flipperDiv.winControl.constructor._enabledDebug){f.log&&f.log(this._currentPage.next.next.next.elementUniqueID+"\t@:"+this._currentPage.next.next.next.location+(this._currentPage.next.next.next.element?"\t"+this._currentPage.next.next.next.element.textContent:""),null,"flipviewdebug");f.log&&f.log(this._currentPage.next.next.next.next.elementUniqueID+"\t@:"+this._currentPage.next.next.next.next.location+(this._currentPage.next.next.next.next.element?"\t"+this._currentPage.next.next.next.next.element.textContent:""),null,"flipviewdebug");f.log&&f.log("> "+this._currentPage.elementUniqueID+"\t@:"+this._currentPage.location+(this._currentPage.element?"\t"+this._currentPage.element.textContent:""),null,"flipviewdebug");f.log&&f.log(this._currentPage.next.elementUniqueID+"\t@:"+this._currentPage.next.location+(this._currentPage.next.element?"\t"+this._currentPage.next.element.textContent:""),null,"flipviewdebug");f.log&&f.log(this._currentPage.next.next.elementUniqueID+"\t@:"+this._currentPage.next.next.location+(this._currentPage.next.next.element?"\t"+this._currentPage.next.next.element.textContent:""),null,"flipviewdebug");var t=Object.keys(this._itemsManager._elementMap),n=[];this._forEachPage(function(t){t&&t.elementUniqueID&&n.push(t.elementUniqueID)});f.log&&f.log("itemsmanager  = ["+t.join(" ")+"] flipview ["+n.join(" ")+"]",null,"flipviewdebug")}},_shiftRight:function(n){var t,i,r;for(this._writeProfilerMark("WinJS.UI.FlipView:_shiftRight,info"),t=n,i=null;t!==this._prevMarker;)i=t.prev.element,!i&&t.prev.elementUniqueID&&(t.elementUniqueID=t.prev.elementUniqueID),t.prev.setElement(null,!0),t.setElement(i,!0),t=t.prev;if(t.next.element)return r=this,this._itemsManager._previousItem(t.next.element).then(function(n){t.setElement(n);r._createAnimationRecord(t.elementUniqueID,t)})},_checkElementVisibility:function(n){var t,u,i,r;if(n){for(i=this._currentPage.element,t=0,u=this._visibleElements.length;t<u;t++)this._visibleElements[t]!==i&&this._announceElementInvisible(this._visibleElements[t]);this._visibleElements=[];i&&(this._visibleElements.push(i),this._announceElementVisible(i))}else{for(t=0,u=this._visibleElements.length;t<u;t++)(!this._visibleElements[t].parentNode||this._visibleElements[t].removedFromChange)&&this._announceElementInvisible(this._visibleElements[t]);this._visibleElements=[];r=this;this._forEachPage(function(n){var t=n.element;t&&(r._itemInView(n)?(r._visibleElements.push(t),r._announceElementVisible(t)):r._announceElementInvisible(t))})}},_announceElementVisible:function(n){if(n&&!n.visible){n.visible=!0;var i=t.document.createEvent("CustomEvent");this._writeProfilerMark("WinJS.UI.FlipView:pageVisibilityChangedEvent(visible:true),info");i.initCustomEvent(p.pageVisibilityChangedEvent,!0,!1,{source:this._flipperDiv,visible:!0});n.dispatchEvent(i)}},_announceElementInvisible:function(n){var i,r;n&&n.visible&&(n.visible=!1,i=!1,n.parentNode||(i=!0,this._panningDivContainer.appendChild(n)),r=t.document.createEvent("CustomEvent"),this._writeProfilerMark("WinJS.UI.FlipView:pageVisibilityChangedEvent(visible:false),info"),r.initCustomEvent(p.pageVisibilityChangedEvent,!0,!1,{source:this._flipperDiv,visible:!1}),n.dispatchEvent(r),i&&this._panningDivContainer.removeChild(n))},_createDiscardablePage:function(t){var r=this._createPageContainer(),i={pageRoot:r.root,elementRoot:r.elementContainer,discardable:!0,element:t,elementUniqueID:n(t),discard:function(){i.pageRoot.parentNode&&i.pageRoot.parentNode.removeChild(i.pageRoot);i.element.parentNode&&i.element.parentNode.removeChild(i.element)}};return i.pageRoot.style.top="0px",i.elementRoot.appendChild(t),this._panningDiv.appendChild(i.pageRoot),i},_createPageContainer:function(){var u=this._panningDivContainerOffsetWidth,f=this._panningDivContainerOffsetHeight,i=t.document.createElement("div"),n=i.style,r=t.document.createElement("div");return r.className="win-item",n.position="absolute",n.overflow="hidden",n.width=u+"px",n.height=f+"px",i.appendChild(r),{root:i,elementContainer:r}},_createFlipPage:function(t,i){var r={},u;return r.element=null,r.elementUniqueID=null,t?(r.prev=t,r.next=t.next,r.next.prev=r,t.next=r):(r.next=r,r.prev=r),u=this._createPageContainer(),r.elementRoot=u.elementContainer,r.elementRoot.style.msOverflowStyle="auto",r.pageRoot=u.root,r.setElement=function(t,u){if(t===undefined&&(t=null),t===r.element){t||(r.elementUniqueID=null);return}if(r.element&&(u||(i._itemsManager.releaseItem(r.element),a._disposeElement(r.element))),r.element=t,r.elementUniqueID=t?n(t):null,v.empty(r.elementRoot),r.element){if(r===i._currentPage&&(i._tabManager.childFocus=t),!w(r.element)){r.element.tabIndex=i._tabIndex;r.element.setAttribute("role","option");r.element.setAttribute("aria-selected",!1);r.element.id||(r.element.id=n(r.element));var f=function(n,t,i){n.setAttribute(i,t.id)},e=!r.next.element||r===i._prevMarker.prev;e&&(f(r.element,i._bufferAriaEndMarker,"aria-flowto"),f(i._bufferAriaEndMarker,r.element,"x-ms-aria-flowfrom"));r!==i._prevMarker&&r.prev.element&&(f(r.prev.element,r.element,"aria-flowto"),f(r.element,r.prev.element,"x-ms-aria-flowfrom"));r.next!==i._prevMarker&&r.next.element&&(f(r.element,r.next.element,"aria-flowto"),f(r.next.element,r.element,"x-ms-aria-flowfrom"));r.prev.element||f(r.element,i._bufferAriaStartMarker,"x-ms-aria-flowfrom")}r.elementRoot.appendChild(r.element)}},r},_itemInView:function(n){return this._itemEnd(n)>this._getViewportStart()&&this._getItemStart(n)<this._viewportEnd()},_getViewportStart:function(){if(this._panningDivContainer.parentNode)return this._isHorizontal?v.getScrollPosition(this._panningDivContainer).scrollLeft:v.getScrollPosition(this._panningDivContainer).scrollTop},_setViewportStart:function(n){this._panningDivContainer.parentNode&&(this._isHorizontal?v.setScrollPosition(this._panningDivContainer,{scrollLeft:n}):v.setScrollPosition(this._panningDivContainer,{scrollTop:n}))},_viewportEnd:function(){var n=this._panningDivContainer;return this._isHorizontal?this._rtl?this._getViewportStart()+this._panningDivContainerOffsetWidth:v.getScrollPosition(n).scrollLeft+this._panningDivContainerOffsetWidth:n.scrollTop+this._panningDivContainerOffsetHeight},_viewportSize:function(){return this._isHorizontal?this._panningDivContainerOffsetWidth:this._panningDivContainerOffsetHeight},_getItemStart:function(n){return n.location},_setItemStart:function(n,t){t!==undefined&&(this._isHorizontal?n.pageRoot.style.left=(this._rtl?-t:t)+"px":n.pageRoot.style.top=t+"px",n.location=t)},_itemEnd:function(n){return(this._isHorizontal?n.location+this._panningDivContainerOffsetWidth:n.location+this._panningDivContainerOffsetHeight)+this._itemSpacing},_itemSize:function(){return this._isHorizontal?this._panningDivContainerOffsetWidth:this._panningDivContainerOffsetHeight},_movePageAhead:function(n,t){var i=this._itemSize(n)+this._itemSpacing;this._setItemStart(t,this._getItemStart(n)+i)},_movePageBehind:function(n,t){var i=this._itemSize(n)+this._itemSpacing;this._setItemStart(t,this._getItemStart(n)-i)},_setupSnapPoints:function(){var n;if(this._environmentSupportsTouch){n=this._panningDivContainer.style;n[e["scroll-snap-type"].scriptName]="mandatory";var t=this._viewportSize(),u=t+this._itemSpacing,i="scroll-snap-points",r=0,f=this._getItemStart(this._currentPage);r=f%(t+this._itemSpacing);n[e[this._isHorizontal?i+"-x":i+"-y"].scriptName]="snapInterval("+r+"px, "+u+"px)"}},_setListEnds:function(){if(this._environmentSupportsTouch&&this._currentPage.element){for(var i=this._panningDivContainer.style,r=0,u=0,n=this._getTailOfBuffer(),t=this._getHeadOfBuffer(),f=e["scroll-limit-"+(this._isHorizontal?"x-min":"y-min")].scriptName,o=e["scroll-limit-"+(this._isHorizontal?"x-max":"y-max")].scriptName;!t.element;)if(t=t.prev,t===this._prevMarker.prev)break;while(!n.element)if(n=n.next,n===this._prevMarker)break;u=this._getItemStart(t);r=this._getItemStart(n);i[f]=r+"px";i[o]=u+"px"}},_viewportOnItemStart:function(){return this._getItemStart(this._currentPage)===this._getViewportStart()},_restoreAnimatedElement:function(t,i){var r=!0;return t.elementUniqueID!==n(i.element)||t.element?this._forEachPage(function(n){n.elementUniqueID!==i.elementUniqueID||n.element||(n.setElement(i.element,!0),r=!1)}):(t.setElement(i.element,!0),r=!1),r},_itemSettledOn:function(){this._lastTimeoutRequest&&(this._lastTimeoutRequest.cancel(),this._lastTimeoutRequest=null);var n=this;r._setImmediate(function(){n._viewportOnItemStart()&&(n._blockTabs=!1,n._currentPage.element&&n._lastSelectedElement!==n._currentPage.element&&(n._lastSelectedPage&&n._lastSelectedPage.element&&!w(n._lastSelectedPage.element)&&n._lastSelectedPage.element.setAttribute("aria-selected",!1),n._lastSelectedPage=n._currentPage,n._lastSelectedElement=n._currentPage.element,w(n._currentPage.element)||n._currentPage.element.setAttribute("aria-selected",!0),l.schedule(function(){var i,r,u;n._currentPage.element&&((n._hasFocus||n._hadFocus)&&(n._hadFocus=!1,v._setActive(n._currentPage.element),n._tabManager.childFocus=n._currentPage.element),i=t.document.createEvent("CustomEvent"),i.initCustomEvent(p.pageSelectedEvent,!0,!1,{source:n._flipperDiv}),n._writeProfilerMark("WinJS.UI.FlipView:pageSelectedEvent,info"),n._currentPage.element.dispatchEvent(i),r=n._currentPage.element,r&&(u=n._itemsManager._recordFromElement(r,!0),u&&u.renderComplete.then(function(){r===n._currentPage.element&&(n._currentPage.element.setAttribute("aria-setsize",n._cachedSize),n._currentPage.element.setAttribute("aria-posinset",n.currentIndex()+1),n._bufferAriaStartMarker.setAttribute("aria-flowto",n._currentPage.element.id),i=t.document.createEvent("CustomEvent"),i.initCustomEvent(p.pageCompletedEvent,!0,!1,{source:n._flipperDiv}),n._writeProfilerMark("WinJS.UI.FlipView:pageCompletedEvent,info"),n._currentPage.element.dispatchEvent(i))})))},l.Priority.normal,null,"WinJS.UI.FlipView._dispatchPageSelectedEvent")))})},_forEachPage:function(n){var t=this._prevMarker;do{if(n(t))break;t=t.next}while(t!==this._prevMarker)},_changeFlipPage:function(n,t,i){this._writeProfilerMark("WinJS.UI.FlipView:_changeFlipPage,info");n.element=null;n.setElement?n.setElement(i,!0):(t.parentNode.removeChild(t),n.elementRoot.appendChild(i));var r=t.style;return r.position="absolute",r.left="0px",r.top="0px",r.opacity=1,n.pageRoot.appendChild(t),t.style.left=Math.max(0,(n.pageRoot.offsetWidth-t.offsetWidth)/2)+"px",t.style.top=Math.max(0,(n.pageRoot.offsetHeight-t.offsetHeight)/2)+"px",s.fadeOut(t).then(function(){t.parentNode&&t.parentNode.removeChild(t)})},_deleteFlipPage:function(n){o("WinJS.UI.FlipView:_deleteFlipPage,info");n.elementRoot.style.opacity=0;var t=s.createDeleteFromListAnimation([n.elementRoot]),i=this;return t.execute().then(function(){n.discardable&&(n.discard(),i._itemsManager.releaseItem(n.element))})},_insertFlipPage:function(n){o("WinJS.UI.FlipView:_insertFlipPage,info");n.elementRoot.style.opacity=1;var t=s.createAddToListAnimation([n.elementRoot]);return t.execute().then(function(){n.discardable&&n.discard()})},_moveFlipPage:function(n,t){var r,i;return o("WinJS.UI.FlipView:_moveFlipPage,info"),r=s.createRepositionAnimation(n.pageRoot),t(),i=this,r.execute().then(function(){if(n.discardable){n.discard();var t=i._getAnimationRecord(n.element);t&&!t.successfullyMoved&&i._itemsManager.releaseItem(n.element)}})},_handleManipulationStateChanged:function(n){this._manipulationState=n.currentState;n.currentState===0&&n.target===this._panningDivContainer&&(this._itemSettledOn(),this._ensureCentered())}},{supportedForProcessing:!1});return b.flipPageBufferCount=2,b})})}),t("require-style!less/styles-flipview",[],function(){}),t("require-style!less/colors-flipview",[],function(){}),t("WinJS/Controls/FlipView",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Animations/_TransitionAnimation","../BindingList","../Promise","../Scheduler","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_ItemsManager","../Utilities/_UI","./FlipView/_Constants","./FlipView/_PageManager","require-style!less/styles-flipview","require-style!less/colors-flipview"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";t.Namespace.define("WinJS.UI",{FlipView:t.Namespace._lazy(function(){function wt(t){var i=t[0].target.winControl;i&&i instanceof p&&t.some(function(n){return n.attributeName==="dir"?!0:n.attributeName==="style"?i._cachedStyleDir!==n.target.style.direction:!1})&&(i._cachedStyleDir=i._flipviewDiv.style.direction,i._rtl=n.getComputedStyle(i._flipviewDiv,null).direction==="rtl",i._setupOrientation())}function nt(n){var t=n.target&&n.target.winControl;t&&t instanceof p&&(e("WinJS.UI.FlipView:resize,StartTM"),t._resize())}var g="win-navbutton",ot="win-flipview",tt="win-navleft",it="win-navright",st="win-navtop",ht="win-navbottom",ct="Previous",lt="Next",at=3e3,vt=500,rt="&#57570;",ut="&#57571;",yt="&#57572;",pt="&#57573;",ft=40,et={get badAxis(){return"Invalid argument: orientation must be a string, either 'horizontal' or 'vertical'"},get badCurrentPage(){return"Invalid argument: currentPage must be a number greater than or equal to zero and be within the bounds of the datasource"},get noitemsManagerForCount(){return"Invalid operation: can't get count if no dataSource has been set"},get badItemSpacingAmount(){return"Invalid argument: itemSpacing must be a number greater than or equal to zero"},get navigationDuringStateChange(){return"Error: After changing itemDataSource or itemTemplate, any navigation in the FlipView control should be delayed until the pageselected event is fired."},get panningContainerAriaLabel(){return f._getWinJSString("ui/flipViewPanningContainerAriaLabel").value}},p=t.Class.define(function(t,i){var c;e("WinJS.UI.FlipView:constructor,StartTM");this._disposed=!1;t=t||n.document.createElement("div");var o=!0,f=null,s=w._trivialHtmlRenderer,r=0,u=0;if(i){if(i.orientation&&typeof i.orientation=="string")switch(i.orientation.toLowerCase()){case"horizontal":o=!0;break;case"vertical":o=!1}i.currentPage&&(r=i.currentPage>>0,r=r<0?0:r);i.itemDataSource&&(f=i.itemDataSource);i.itemTemplate&&(s=this._getItemRenderer(i.itemTemplate));i.itemSpacing&&(u=i.itemSpacing>>0,u=u<0?0:u)}f||(c=new h.List,f=c.dataSource);y.empty(t);this._flipviewDiv=t;t.winControl=this;a._setOptions(this,i,!0);this._initializeFlipView(t,o,f,s,r,u);y.addClass(t,"win-disposable");this._avoidTrappingTime=0;this._windowWheelHandlerBound=this._windowWheelHandler.bind(this);y._globalListener.addEventListener(t,"wheel",this._windowWheelHandlerBound);y._globalListener.addEventListener(t,"mousewheel",this._windowWheelHandlerBound);e("WinJS.UI.FlipView:constructor,StopTM")},{dispose:function(){(e("WinJS.UI.FlipView:dispose,StopTM"),this._disposed)||(y._globalListener.removeEventListener(this._flipviewDiv,"wheel",this._windowWheelHandlerBound),y._globalListener.removeEventListener(this._flipviewDiv,"mousewheel",this._windowWheelHandlerBound),y._resizeNotifier.unsubscribe(this._flipviewDiv,nt),this._disposed=!0,this._pageManager.dispose(),this._itemsManager.release(),this.itemDataSource=null)},next:function(){e("WinJS.UI.FlipView:next,info");var n=this._nextAnimation?null:this._cancelDefaultAnimation;return this._navigate(!0,n)},previous:function(){e("WinJS.UI.FlipView:prev,info");var n=this._prevAnimation?null:this._cancelDefaultAnimation;return this._navigate(!1,n)},element:{get:function(){return this._flipviewDiv}},currentPage:{get:function(){return this._getCurrentIndex()},set:function(n){var t,i;if(e("WinJS.UI.FlipView:set_currentPage,info"),this._pageManager._notificationsEndedSignal){t=this;this._pageManager._notificationsEndedSignal.promise.done(function(){t._pageManager._notificationsEndedSignal=null;t.currentPage=n});return}if(!this._animating||this._cancelAnimation())if(n=n>>0,n=n<0?0:n,this._refreshTimer)this._indexAfterRefresh=n;else{if(this._pageManager._cachedSize>0?n=Math.min(this._pageManager._cachedSize-1,n):this._pageManager._cachedSize===0&&(n=0),t=this,this._jumpingToIndex===n)return;i=function(){t._jumpingToIndex=null};this._jumpingToIndex=n;var u=this._jumpAnimation?this._jumpAnimation:this._defaultAnimation.bind(this),f=this._jumpAnimation?null:this._cancelDefaultAnimation,r=function(){t._completeJump()};this._pageManager.startAnimatedJump(n,f,r).then(function(n){if(n){t._animationsStarted();var f=n.oldPage.pageRoot,o=n.newPage.pageRoot;t._contentDiv.appendChild(f);t._contentDiv.appendChild(o);t._completeJumpPending=!0;u(f,o).then(function(){t._completeJumpPending&&(r(),e("WinJS.UI.FlipView:set_currentPage.animationComplete,info"))}).done(i,i)}else i()},i)}}},orientation:{get:function(){return this._axisAsString()},set:function(n){e("WinJS.UI.FlipView:set_orientation,info");var t=n==="horizontal";t!==this._isHorizontal&&(this._isHorizontal=t,this._setupOrientation(),this._pageManager.setOrientation(this._isHorizontal))}},itemDataSource:{get:function(){return this._dataSource},set:function(n){e("WinJS.UI.FlipView:set_itemDataSource,info");this._dataSourceAfterRefresh=n||(new h.List).dataSource;this._refresh()}},itemTemplate:{get:function(){return this._itemRenderer},set:function(n){e("WinJS.UI.FlipView:set_itemTemplate,info");this._itemRendererAfterRefresh=this._getItemRenderer(n);this._refresh()}},itemSpacing:{get:function(){return this._pageManager.getItemSpacing()},set:function(n){e("WinJS.UI.FlipView:set_itemSpacing,info");n=n>>0;n=n<0?0:n;this._pageManager.setItemSpacing(n)}},count:function(){e("WinJS.UI.FlipView:count,info");var n=this;return new c(function(t,i){n._itemsManager?n._pageManager._cachedSize===b.CountResult.unknown||n._pageManager._cachedSize>=0?t(n._pageManager._cachedSize):n._dataSource.getCount().then(function(i){n._pageManager._cachedSize=i;t(i)}):i(p.noitemsManagerForCount)})},setCustomAnimations:function(n){e("WinJS.UI.FlipView:setCustomAnimations,info");n.next!==undefined&&(this._nextAnimation=n.next);n.previous!==undefined&&(this._prevAnimation=n.previous);n.jump!==undefined&&(this._jumpAnimation=n.jump)},forceLayout:function(){e("WinJS.UI.FlipView:forceLayout,info");this._pageManager.resized()},_initializeFlipView:function(t,r,u,f,e,o){function g(n){n.setAttribute("aria-hidden",!0);n.style.visibility="hidden";n.style.opacity=0;n.tabIndex=-1;n.style.zIndex=1e3}function rt(n){if(n.pointerType!==l){if(s._touchInteraction=!1,n.screenX===s._lastMouseX&&n.screenY===s._lastMouseY)return;s._lastMouseX=n.screenX;s._lastMouseY=n.screenY;s._mouseInViewport=!0;s._fadeInButton("prev");s._fadeInButton("next");s._fadeOutButtons()}}function ut(n){n.pointerType===l?(s._mouseInViewport=!1,s._touchInteraction=!0,s._fadeOutButtons(!0)):(s._touchInteraction=!1,s._isInteractive(n.target)||(n.buttons&4)!=0&&(n.stopPropagation(),n.preventDefault()))}function ft(n){n.pointerType!==l&&(s._touchInteraction=!1)}var s=this,tt=!1,c,p,k,l,a;this._flipviewDiv=t;y.addClass(this._flipviewDiv,ot);this._contentDiv=n.document.createElement("div");this._panningDivContainer=n.document.createElement("div");this._panningDivContainer.className="win-surface";this._panningDiv=n.document.createElement("div");this._prevButton=n.document.createElement("button");this._nextButton=n.document.createElement("button");this._isHorizontal=r;this._dataSource=u;this._itemRenderer=f;this._itemsManager=null;this._pageManager=null;var v=["scroll-limit-x-max","scroll-limit-x-min","scroll-limit-y-max","scroll-limit-y-min","scroll-snap-type","scroll-snap-x","scroll-snap-y","overflow-style",],h=!0,it=i._browserStyleEquivalents;for(c=0,p=v.length;c<p;c++)h=h&&!!it[v[c]];h=h&&!!i._browserEventEquivalents.manipulationStateChanged;h=h&&y._supportsSnapPoints;this._environmentSupportsTouch=h;k=this._flipviewDiv.getAttribute("aria-label");k||this._flipviewDiv.setAttribute("aria-label","");this._flipviewDiv.setAttribute("role","listbox");this._flipviewDiv.style.overflow||(this._flipviewDiv.style.overflow="hidden");this._contentDiv.style.position="relative";this._contentDiv.style.zIndex=0;this._contentDiv.style.width="100%";this._contentDiv.style.height="100%";this._panningDiv.style.position="relative";this._panningDivContainer.style.position="relative";this._panningDivContainer.style.width="100%";this._panningDivContainer.style.height="100%";this._panningDivContainer.setAttribute("role","group");this._panningDivContainer.setAttribute("aria-label",et.panningContainerAriaLabel);this._contentDiv.appendChild(this._panningDivContainer);this._flipviewDiv.appendChild(this._contentDiv);this._panningDiv.style.width="100%";this._panningDiv.style.height="100%";this._setupOrientation();g(this._prevButton);g(this._nextButton);this._prevButton.setAttribute("aria-label",ct);this._nextButton.setAttribute("aria-label",lt);this._prevButton.setAttribute("type","button");this._nextButton.setAttribute("type","button");this._panningDivContainer.appendChild(this._panningDiv);this._contentDiv.appendChild(this._prevButton);this._contentDiv.appendChild(this._nextButton);this._itemsManagerCallback={inserted:function(n,t,i){s._itemsManager._itemFromPromise(n).then(function(n){var r=s._itemsManager._elementFromHandle(t),u=s._itemsManager._elementFromHandle(i);s._pageManager.inserted(n,r,u,!0)})},countChanged:function(n,t){s._pageManager._cachedSize=n;t!==b.CountResult.unknown&&s._fireDatasourceCountChangedEvent()},changed:function(n,t){s._pageManager.changed(n,t)},moved:function(n,t,i,r){var u=function(n){s._pageManager.moved(n,t,i)};n?u(n):s._itemsManager._itemFromPromise(r).then(u)},removed:function(n,t){n&&s._pageManager.removed(n,t,!0)},knownUpdatesComplete:function(){},beginNotifications:function(){s._cancelAnimation();s._pageManager.notificationsStarted()},endNotifications:function(){s._pageManager.notificationsEnded()},itemAvailable:function(n,t){s._pageManager.itemRetrieved(n,t)},reload:function(){s._pageManager.reload()}};this._dataSource&&(this._itemsManager=w._createItemsManager(this._dataSource,this._itemRenderer,this._itemsManagerCallback,{ownerElement:this._flipviewDiv}));this._pageManager=new d._FlipPageManager(this._flipviewDiv,this._panningDiv,this._panningDivContainer,this._itemsManager,o,this._environmentSupportsTouch,{hidePreviousButton:function(){s._hasPrevContent=!1;s._fadeOutButton("prev");s._prevButton.setAttribute("aria-hidden",!0)},showPreviousButton:function(){s._hasPrevContent=!0;s._fadeInButton("prev");s._prevButton.setAttribute("aria-hidden",!1)},hideNextButton:function(){s._hasNextContent=!1;s._fadeOutButton("next");s._nextButton.setAttribute("aria-hidden",!0)},showNextButton:function(){s._hasNextContent=!0;s._fadeInButton("next");s._nextButton.setAttribute("aria-hidden",!1)}});this._pageManager.initialize(e,this._isHorizontal);this._dataSource.getCount().then(function(n){s._pageManager._cachedSize=n});this._prevButton.addEventListener("click",function(){s.previous()},!1);this._nextButton.addEventListener("click",function(){s.next()},!1);new y._MutationObserver(wt).observe(this._flipviewDiv,{attributes:!0,attributeFilter:["dir","style"]});this._cachedStyleDir=this._flipviewDiv.style.direction;this._flipviewDiv.addEventListener("mselementresize",nt);y._resizeNotifier.subscribe(this._flipviewDiv,nt);this._contentDiv.addEventListener("mouseleave",function(){s._mouseInViewport=!1},!1);l=y._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch";this._environmentSupportsTouch&&(y._addEventListener(this._contentDiv,"pointerdown",ut,!1),y._addEventListener(this._contentDiv,"pointermove",rt,!1),y._addEventListener(this._contentDiv,"pointerup",ft,!1));this._panningDivContainer.addEventListener("scroll",function(){s._scrollPosChanged()},!1);this._panningDiv.addEventListener("blur",function(){s._touchInteraction||s._fadeOutButtons()},!0);a=n.document.body.contains(this._flipviewDiv);y._addInsertedNotifier(this._flipviewDiv);this._flipviewDiv.addEventListener("WinJSNodeInserted",function(){if(a){a=!1;return}s._pageManager.resized()},!1);this._flipviewDiv.addEventListener("keydown",function(n){var r=!0,t,i;if(!s._isInteractive(n.target)){if(t=y.Key,i=!1,s._isHorizontal)switch(n.keyCode){case t.leftArrow:!s._rtl&&s.currentPage>0?(s.previous(),i=!0):s._rtl&&s.currentPage<s._pageManager._cachedSize-1&&(s.next(),i=!0);break;case t.pageUp:s.currentPage>0&&(s.previous(),i=!0);break;case t.rightArrow:!s._rtl&&s.currentPage<s._pageManager._cachedSize-1?(s.next(),i=!0):s._rtl&&s.currentPage>0&&(s.previous(),i=!0);break;case t.pageDown:s.currentPage<s._pageManager._cachedSize-1&&(s.next(),i=!0);break;case t.upArrow:case t.downArrow:i=!0;r=!1}else switch(n.keyCode){case t.upArrow:case t.pageUp:s.currentPage>0&&(s.previous(),i=!0);break;case t.downArrow:case t.pageDown:s.currentPage<s._pageManager._cachedSize-1&&(s.next(),i=!0);break;case t.space:i=!0}switch(n.keyCode){case t.home:s.currentPage=0;i=!0;break;case t.end:s._pageManager._cachedSize>0&&(s.currentPage=s._pageManager._cachedSize-1);i=!0}if(i)return n.preventDefault(),r&&n.stopPropagation(),!0}},!1);tt=!0},_windowWheelHandler:function(n){n=n.detail.originalEvent;var r=n.target&&(this._flipviewDiv.contains(n.target)||this._flipviewDiv===n.target),t=this,u=i._now(),f=this._avoidTrappingTime>u;(!r||f)&&(this._avoidTrappingTime=u+vt);r&&f?(this._panningDivContainer.style.overflowX="hidden",this._panningDivContainer.style.overflowY="hidden",i._yieldForDomModification(function(){t._pageManager._ensureCentered();t._isHorizontal?(t._panningDivContainer.style.overflowX=t._environmentSupportsTouch?"scroll":"hidden",t._panningDivContainer.style.overflowY="hidden"):(t._panningDivContainer.style.overflowY=t._environmentSupportsTouch?"scroll":"hidden",t._panningDivContainer.style.overflowX="hidden")})):r&&this._pageManager.simulateMouseWheelScroll(n)},_isInteractive:function(n){var i,t,r;if(n.parentNode)for(i=n.parentNode.querySelectorAll(".win-interactive, .win-interactive *"),t=0,r=i.length;t<r;t++)if(i[t]===n)return!0;return!1},_refreshHandler:function(){var n=this._dataSourceAfterRefresh||this._dataSource,t=this._itemRendererAfterRefresh||this._itemRenderer,i=this._indexAfterRefresh||0;this._setDatasource(n,t,i);this._dataSourceAfterRefresh=null;this._itemRendererAfterRefresh=null;this._indexAfterRefresh=0;this._refreshTimer=!1},_refresh:function(){if(!this._refreshTimer){var n=this;this._refreshTimer=!0;l.schedule(function(){n._refreshTimer&&!n._disposed&&n._refreshHandler()},l.Priority.high,null,"WinJS.UI.FlipView._refreshHandler")}},_getItemRenderer:function(t){var r=null,u,i;return typeof t=="function"?(u=new c(function(){}),i=t(u),r=i.element?typeof i.element=="object"&&typeof i.element.then=="function"?function(i){var r=n.document.createElement("div");return r.className="win-template",v.markDisposable(r),{element:r,renderComplete:t(i).element.then(function(n){r.appendChild(n)})}}:t:function(i){var r=n.document.createElement("div");return r.className="win-template",v.markDisposable(r),{element:r,renderComplete:i.then(function(){return c.as(t(i)).then(function(n){r.appendChild(n)})})}}):typeof t=="object"&&(r=t.renderItem),r},_navigate:function(n,t){var e,o;if(i.validation&&this._refreshTimer)throw new r("WinJS.UI.FlipView.NavigationDuringStateChange",et.navigationDuringStateChange);if(this._animating||(this._animatingForward=n),this._goForward=n,this._animating&&!this._cancelAnimation())return!1;var u=this,s=n?this._nextAnimation:this._prevAnimation,c=s?s:this._defaultAnimation.bind(this),h=function(n){u._completeNavigation(n)},f=this._pageManager.startAnimatedNavigation(n,t,h);return f?(this._animationsStarted(),e=f.outgoing.pageRoot,o=f.incoming.pageRoot,this._contentDiv.appendChild(e),this._contentDiv.appendChild(o),this._completeNavigationPending=!0,c(e,o).then(function(){u._completeNavigationPending&&h(u._goForward)}).done(),!0):!1},_cancelDefaultAnimation:function(n,t){n.style.opacity=0;t.style.animationName="";t.style.opacity=1},_cancelAnimation:function(){var n;if(this._pageManager._navigationAnimationRecord&&this._pageManager._navigationAnimationRecord.completionCallback&&(n=this._pageManager._navigationAnimationRecord.cancelAnimationCallback,n&&(n=n.bind(this)),this._pageManager._navigationAnimationRecord&&this._pageManager._navigationAnimationRecord.elementContainers)){var t=this._pageManager._navigationAnimationRecord.elementContainers[0],i=this._pageManager._navigationAnimationRecord.elementContainers[1],r=t.pageRoot,u=i.pageRoot;return n&&n(r,u),this._pageManager._navigationAnimationRecord.completionCallback(this._animatingForward),!0}return!1},_completeNavigation:function(n){if(!this._disposed){if(this._pageManager._resizing=!1,this._pageManager._navigationAnimationRecord&&this._pageManager._navigationAnimationRecord.elementContainers){var r=this._pageManager._navigationAnimationRecord.elementContainers[0],u=this._pageManager._navigationAnimationRecord.elementContainers[1],t=r.pageRoot,i=u.pageRoot;t.parentNode&&t.parentNode.removeChild(t);i.parentNode&&i.parentNode.removeChild(i);this._pageManager.endAnimatedNavigation(n,r,u);this._fadeOutButtons();this._scrollPosChanged();this._pageManager._ensureCentered(!0);this._animationsFinished()}this._completeNavigationPending=!1}},_completeJump:function(){if(!this._disposed){if(this._pageManager._resizing=!1,this._pageManager._navigationAnimationRecord&&this._pageManager._navigationAnimationRecord.elementContainers){var i=this._pageManager._navigationAnimationRecord.elementContainers[0],r=this._pageManager._navigationAnimationRecord.elementContainers[1],n=i.pageRoot,t=r.pageRoot;n.parentNode&&n.parentNode.removeChild(n);t.parentNode&&t.parentNode.removeChild(t);this._pageManager.endAnimatedJump(i,r);this._animationsFinished()}this._completeJumpPending=!1}},_resize:function(){this._pageManager.resized()},_setCurrentIndex:function(n){return this._pageManager.jumpToIndex(n)},_getCurrentIndex:function(){return this._pageManager.currentIndex()},_setDatasource:function(n,t,i){var r,u,f;this._animating&&this._cancelAnimation();r=0;i!==undefined&&(r=i);this._dataSource=n;this._itemRenderer=t;u=this._itemsManager;this._itemsManager=w._createItemsManager(this._dataSource,this._itemRenderer,this._itemsManagerCallback,{ownerElement:this._flipviewDiv});this._dataSource=this._itemsManager.dataSource;f=this;this._dataSource.getCount().then(function(n){f._pageManager._cachedSize=n});this._pageManager.setNewItemsManager(this._itemsManager,r);u&&u.release()},_fireDatasourceCountChangedEvent:function(){var t=this;l.schedule(function(){var i=n.document.createEvent("Event");i.initEvent(p.datasourceCountChangedEvent,!0,!0);e("WinJS.UI.FlipView:dataSourceCountChangedEvent,info");t._flipviewDiv.dispatchEvent(i)},l.Priority.normal,null,"WinJS.UI.FlipView._dispatchDataSourceCountChangedEvent")},_scrollPosChanged:function(){this._pageManager.scrollPosChanged()},_axisAsString:function(){return this._isHorizontal?"horizontal":"vertical"},_setupOrientation:function(){if(this._isHorizontal){this._panningDivContainer.style.overflowX=this._environmentSupportsTouch?"scroll":"hidden";this._panningDivContainer.style.overflowY="hidden";var t=n.getComputedStyle(this._flipviewDiv,null).direction==="rtl";this._rtl=t;t?(this._prevButton.className=g+" "+it,this._nextButton.className=g+" "+tt):(this._prevButton.className=g+" "+tt,this._nextButton.className=g+" "+it);this._prevButton.innerHTML=t?ut:rt;this._nextButton.innerHTML=t?rt:ut}else this._panningDivContainer.style.overflowY=this._environmentSupportsTouch?"scroll":"hidden",this._panningDivContainer.style.overflowX="hidden",this._prevButton.className=g+" "+st,this._nextButton.className=g+" "+ht,this._prevButton.innerHTML=yt,this._nextButton.innerHTML=pt;this._panningDivContainer.style.msOverflowStyle="none"},_fadeInButton:function(n,t){(this._mouseInViewport||t||!this._environmentSupportsTouch)&&(n==="next"&&this._hasNextContent?(this._nextButtonAnimation&&(this._nextButtonAnimation.cancel(),this._nextButtonAnimation=null),this._nextButton.style.visibility="visible",this._nextButtonAnimation=this._fadeInFromCurrentValue(this._nextButton)):n==="prev"&&this._hasPrevContent&&(this._prevButtonAnimation&&(this._prevButtonAnimation.cancel(),this._prevButtonAnimation=null),this._prevButton.style.visibility="visible",this._prevButtonAnimation=this._fadeInFromCurrentValue(this._prevButton)))},_fadeOutButton:function(n){var t=this;return n==="next"?(this._nextButtonAnimation&&(this._nextButtonAnimation.cancel(),this._nextButtonAnimation=null),this._nextButtonAnimation=o.fadeOut(this._nextButton).then(function(){t._nextButton.style.visibility="hidden"}),this._nextButtonAnimation):(this._prevButtonAnimation&&(this._prevButtonAnimation.cancel(),this._prevButtonAnimation=null),this._prevButtonAnimation=o.fadeOut(this._prevButton).then(function(){t._prevButton.style.visibility="hidden"}),this._prevButtonAnimation)},_fadeOutButtons:function(n){if(this._environmentSupportsTouch){this._buttonFadePromise&&(this._buttonFadePromise.cancel(),this._buttonFadePromise=null);var t=this;this._buttonFadePromise=(n?c.wrap():c.timeout(s._animationTimeAdjustment(at))).then(function(){t._fadeOutButton("prev");t._fadeOutButton("next");t._buttonFadePromise=null})}},_animationsStarted:function(){this._animating=!0},_animationsFinished:function(){this._animating=!1},_defaultAnimation:function(n,t){var r={},i,u,f;return t.style.left="0px",t.style.top="0px",t.style.opacity=0,i=n.itemIndex>t.itemIndex?-ft:ft,r.left=(this._isHorizontal?this._rtl?-i:i:0)+"px",r.top=(this._isHorizontal?0:i)+"px",u=o.fadeOut(n),f=o.enterContent(t,[r],{mechanism:"transition"}),c.join([u,f])},_fadeInFromCurrentValue:function(n){return s.executeTransition(n,{property:"opacity",delay:0,duration:167,timing:"linear",to:1})}},k);return t.Class.mix(p,u.createEventProperties(p.datasourceCountChangedEvent,p.pageVisibilityChangedEvent,p.pageSelectedEvent,p.pageCompletedEvent)),t.Class.mix(p,a.DOMEventMixin),p})})}),t("WinJS/Controls/ItemContainer",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../Scheduler","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_KeyboardBehavior","../Utilities/_UI","./ItemContainer/_Constants","./ItemContainer/_ItemEventsHandler"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";var g=f._createEventProperty,d={invoked:"invoked",selectionchanging:"selectionchanging",selectionchanged:"selectionchanged"};i.Namespace._moduleDefine(n,"WinJS.UI",{ItemContainer:i.Namespace._lazy(function(){var f={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get swipeOrientationDeprecated(){return"Invalid configuration: swipeOrientation is deprecated. The control will default this property to 'none'"},get swipeBehaviorDeprecated(){return"Invalid configuration: swipeBehavior is deprecated. The control will default this property to 'none'"}},o=i.Class.define(function(i,r){function s(n,t,i){return{name:t?n:n.toLowerCase(),handler:function(t){e["_on"+n](t)},capture:i}}var e,h;if(i=i||t.document.createElement("DIV"),this._id=i.id||v._uniqueID(i),this._writeProfilerMark("constructor,StartTM"),r=r||{},i.winControl)throw new u("WinJS.UI.ItemContainer.DuplicateConstruction",f.duplicateConstruction);i.winControl=this;this._element=i;v.addClass(i,"win-disposable");this._selectionMode=w.SelectionMode.single;this._draggable=!1;this._pressedEntity={type:w.ObjectType.item,index:b._INVALID_INDEX};this.tapBehavior=w.TapBehavior.invokeOnly;v.addClass(this.element,o._ClassName.itemContainer+" "+b._containerClass);this._setupInternalTree();this._selection=new n._SingleItemSelectionManager(i,this._itemBox);this._setTabIndex();l.setOptions(this,r);this._mutationObserver=new v._MutationObserver(this._itemPropertyChange.bind(this));this._mutationObserver.observe(i,{attributes:!0,attributeFilter:["aria-selected"]});this._setAriaRole();e=this;this.selectionDisabled||c.schedule(function(){e._setDirectionClass()},c.Priority.normal,null,"WinJS.UI.ItemContainer_async_initialize");this._itemEventsHandler=new k._ItemEventsHandler(Object.create({containerFromElement:function(){return e.element},indexForItemElement:function(){return 1},indexForHeaderElement:function(){return b._INVALID_INDEX},itemBoxAtIndex:function(){return e._itemBox},itemAtIndex:function(){return e.element},headerAtIndex:function(){return null},containerAtIndex:function(){return e.element},isZombie:function(){return this._disposed},getItemPosition:function(){return e._getItemPosition()},rtl:function(){return e._rtl()},fireInvokeEvent:function(){e._fireInvokeEvent()},verifySelectionAllowed:function(){return e._verifySelectionAllowed()},changeFocus:function(){},selectRange:function(n,t){return e._selection.set({firstIndex:n,lastIndex:t})}},{pressedEntity:{get:function(){return e._pressedEntity},set:function(n){e._pressedEntity=n}},pressedElement:{enumerable:!0,set:function(n){e._pressedElement=n}},eventHandlerRoot:{enumerable:!0,get:function(){return e.element}},selectionMode:{enumerable:!0,get:function(){return e._selectionMode}},accessibleItemClass:{enumerable:!0,get:function(){return b._containerClass}},canvasProxy:{enumerable:!0,get:function(){return e._captureProxy}},tapBehavior:{enumerable:!0,get:function(){return e._tapBehavior}},draggable:{enumerable:!0,get:function(){return e._draggable}},selection:{enumerable:!0,get:function(){return e._selection}},customFootprintParent:{enumerable:!0,get:function(){return null}},skipPreventDefaultOnPointerDown:{enumerable:!0,get:function(){return!0}}}));h=[s("PointerDown"),s("Click"),s("PointerUp"),s("PointerCancel"),s("LostPointerCapture"),s("ContextMenu"),s("MSHoldVisual",!0),s("FocusIn"),s("FocusOut"),s("DragStart"),s("DragEnd"),s("KeyDown")];h.forEach(function(n){v._addEventListener(e.element,n.name,n.handler,!!n.capture)});this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},draggable:{get:function(){return this._draggable},set:function(n){r.isPhone||this._draggable!==n&&(this._draggable=n,this._updateDraggableAttribute())}},selected:{get:function(){return this._selection.selected},set:function(n){this._selection.selected!==n&&(this._selection.selected=n)}},swipeOrientation:{get:function(){return"none"},set:function(){v._deprecated(f.swipeOrientationDeprecated)}},tapBehavior:{get:function(){return this._tapBehavior},set:function(n){r.isPhone&&n===w.TapBehavior.directSelect||(this._tapBehavior=n,this._setAriaRole())}},swipeBehavior:{get:function(){return"none"},set:function(){v._deprecated(f.swipeBehaviorDeprecated)}},selectionDisabled:{get:function(){return this._selectionMode===w.SelectionMode.none},set:function(n){n?this._selectionMode=w.SelectionMode.none:(this._setDirectionClass(),this._selectionMode=w.SelectionMode.single);this._setAriaRole()}},oninvoked:g(d.invoked),onselectionchanging:g(d.selectionchanging),onselectionchanged:g(d.selectionchanged),forceLayout:function(){this._forceLayout()},dispose:function(){this._disposed||(this._disposed=!0,this._itemEventsHandler.dispose(),a.disposeSubTree(this.element))},_onMSManipulationStateChanged:function(n){this._itemEventsHandler.onMSManipulationStateChanged(n)},_onPointerDown:function(n){this._itemEventsHandler.onPointerDown(n)},_onClick:function(n){this._itemEventsHandler.onClick(n)},_onPointerUp:function(n){v.hasClass(this._itemBox,b._itemFocusClass)&&this._onFocusOut(n);this._itemEventsHandler.onPointerUp(n)},_onPointerCancel:function(n){this._itemEventsHandler.onPointerCancel(n)},_onLostPointerCapture:function(n){this._itemEventsHandler.onLostPointerCapture(n)},_onContextMenu:function(n){this._itemEventsHandler.onContextMenu(n)},_onMSHoldVisual:function(n){this._itemEventsHandler.onMSHoldVisual(n)},_onFocusIn:function(){if(!this._itemBox.querySelector("."+b._itemFocusOutlineClass)&&p._keyboardSeenLast){v.addClass(this._itemBox,b._itemFocusClass);var n=t.document.createElement("div");n.className=b._itemFocusOutlineClass;this._itemBox.appendChild(n)}},_onFocusOut:function(){v.removeClass(this._itemBox,b._itemFocusClass);var n=this._itemBox.querySelector("."+b._itemFocusOutlineClass);n&&n.parentNode.removeChild(n)},_onDragStart:function(n){var t,i;this._pressedElement&&this._itemEventsHandler._isInteractive(this._pressedElement)?n.preventDefault():(this._dragging=!0,t=this,n.dataTransfer.setData("text",""),n.dataTransfer.setDragImage&&(i=this.element.getBoundingClientRect(),n.dataTransfer.setDragImage(this.element,n.clientX-i.left,n.clientY-i.top)),r._yieldForDomModification(function(){t._dragging&&v.addClass(t._itemBox,b._dragSourceClass)}))},_onDragEnd:function(){this._dragging=!1;v.removeClass(this._itemBox,b._dragSourceClass);this._itemEventsHandler.resetPointerDownState()},_onKeyDown:function(n){var u;if(!this._itemEventsHandler._isInteractive(n.target)){var t=v.Key,i=n.keyCode,r=!1;n.ctrlKey||i!==t.enter?n.ctrlKey&&i===t.enter||i===t.space?this.selectionDisabled||(this.selected=!this.selected,r=v._setActive(this.element)):i===t.escape&&this.selected&&(this.selected=!1,r=!0):(u=this._verifySelectionAllowed(),u.canTapSelect&&(this.selected=!this.selected),this._fireInvokeEvent(),r=!0);r&&(n.stopPropagation(),n.preventDefault())}},_setTabIndex:function(){var n=this.element.getAttribute("tabindex");n||this.element.setAttribute("tabindex","0")},_rtl:function(){return typeof this._cachedRTL!="boolean"&&(this._cachedRTL=t.getComputedStyle(this.element,null).direction==="rtl"),this._cachedRTL},_setDirectionClass:function(){v[this._rtl()?"addClass":"removeClass"](this.element,b._rtlListViewClass)},_forceLayout:function(){this._cachedRTL=t.getComputedStyle(this.element,null).direction==="rtl";this._setDirectionClass()},_getItemPosition:function(){var n=this.element;return n?h.wrap({left:this._rtl()?n.offsetParent.offsetWidth-n.offsetLeft-n.offsetWidth:n.offsetLeft,top:n.offsetTop,totalWidth:v.getTotalWidth(n),totalHeight:v.getTotalHeight(n),contentWidth:v.getContentWidth(n),contentHeight:v.getContentHeight(n)}):h.cancel},_itemPropertyChange:function(n){if(!this._disposed){var i=n[0].target,t=i.getAttribute("aria-selected")==="true";t!==v._isSelectionRendered(this._itemBox)&&(this.selectionDisabled?v._setAttribute(i,"aria-selected",!t):(this.selected=t,t!==this.selected&&v._setAttribute(i,"aria-selected",!t)))}},_updateDraggableAttribute:function(){this._itemBox.setAttribute("draggable",this._draggable)},_verifySelectionAllowed:function(){if(this._selectionMode!==w.SelectionMode.none&&this._tapBehavior===w.TapBehavior.toggleSelect){var n=this._selection.fireSelectionChanging();return{canSelect:n,canTapSelect:n&&this._tapBehavior===w.TapBehavior.toggleSelect}}return{canSelect:!1,canTapSelect:!1}},_setupInternalTree:function(){var i=t.document.createElement("div"),n,r;for(i.className=b._itemClass,this._captureProxy=t.document.createElement("div"),this._itemBox=t.document.createElement("div"),this._itemBox.className=b._itemBoxClass,n=this.element.firstChild;n;)r=n.nextSibling,i.appendChild(n),n=r;this.element.appendChild(this._itemBox);this._itemBox.appendChild(i);this.element.appendChild(this._captureProxy)},_fireInvokeEvent:function(){if(this.tapBehavior!==w.TapBehavior.none){var n=t.document.createEvent("CustomEvent");n.initCustomEvent(d.invoked,!0,!1,{});this.element.dispatchEvent(n)}},_setAriaRole:function(){if(!this.element.getAttribute("role")||this._usingDefaultItemRole){this._usingDefaultItemRole=!0;var n;n=this.tapBehavior===w.TapBehavior.none&&this.selectionDisabled?"listitem":"option";v._setAttribute(this.element,"role",n)}},_writeProfilerMark:function(n){var t="WinJS.UI.ItemContainer:"+this._id+":"+n;s(t);e.log&&e.log(t,null,"itemcontainerprofiler")}},{_ClassName:{itemContainer:"win-itemcontainer",vertical:"win-vertical",horizontal:"win-horizontal"}});return i.Class.mix(o,l.DOMEventMixin),o}),_SingleItemSelectionManager:i.Namespace._lazy(function(){return i.Class.define(function(n,t){this._selected=!1;this._element=n;this._itemBox=t},{selected:{get:function(){return this._selected},set:function(n){n=!!n;this._selected!==n&&this.fireSelectionChanging()&&(this._selected=n,k._ItemEventsHandler.renderSelection(this._itemBox,this._element,n,!0,this._element),this.fireSelectionChanged())}},count:function(){return this._selected?1:0},getIndices:function(){},getItems:function(){},getRanges:function(){},isEverything:function(){return!1},set:function(){this.selected=!0},clear:function(){this.selected=!1},add:function(){this.selected=!0},remove:function(){this.selected=!1},selectAll:function(){},fireSelectionChanging:function(){var n=t.document.createEvent("CustomEvent");return n.initCustomEvent(d.selectionchanging,!0,!0,{}),this._element.dispatchEvent(n)},fireSelectionChanged:function(){var n=t.document.createEvent("CustomEvent");n.initCustomEvent(d.selectionchanged,!0,!1,{});this._element.dispatchEvent(n)},_isIncluded:function(){return this._selected},_getFocused:function(){return{type:w.ObjectType.item,index:b._INVALID_INDEX}}})})})}),t("WinJS/Controls/Repeater",["exports","../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Core/_WriteProfilerMark","../BindingList","../BindingTemplate","../Promise","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable",],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{Repeater:i.Namespace._lazy(function(){function ut(n){var i=t.document.createElement("div");return i.textContent=JSON.stringify(n),i}var v="itemsloaded",y="itemchanging",p="itemchanged",w="iteminserting",b="iteminserted",k="itemmoving",d="itemmoved",g="itemremoving",nt="itemremoved",tt="itemsreloading",it="itemsreloaded",n=u._createEventProperty,f={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get asynchronousRender(){return"Top level items must render synchronously"},get repeaterReentrancy(){return"Cannot modify Repeater data until Repeater has commited previous modification."}},rt=i.Class.define(function(n,i){if(n&&n.winControl)throw new r("WinJS.UI.Repeater.DuplicateConstruction",f.duplicateConstruction);this._element=n||t.document.createElement("div");this._id=this._element.id||a._uniqueID(this._element);this._writeProfilerMark("constructor,StartTM");i=i||{};a.addClass(this._element,"win-repeater win-disposable");this._render=null;this._modifying=!1;this._disposed=!1;this._element.winControl=this;this._dataListeners={itemchanged:this._dataItemChangedHandler.bind(this),iteminserted:this._dataItemInsertedHandler.bind(this),itemmoved:this._dataItemMovedHandler.bind(this),itemremoved:this._dataItemRemovedHandler.bind(this),reload:this._dataReloadHandler.bind(this)};var u=this._extractInlineTemplate();this._initializing=!0;this.template=i.template||u;this.data=i.data;this._initializing=!1;c._setOptions(this,i,!0);this._repeatedDOM=[];this._renderAllItems();this.dispatchEvent(v,{});this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},data:{get:function(){return this._data},set:function(n){this._writeProfilerMark("data.set,StartTM");this._data&&this._removeDataListeners();this._data=n||new o.List;this._addDataListeners();this._initializing||(this._reloadRepeater(!0),this.dispatchEvent(v,{}));this._writeProfilerMark("data.set,StopTM")}},template:{get:function(){return this._template},set:function(n){this._writeProfilerMark("template.set,StartTM");this._template=n||ut;this._render=a._syncRenderer(this._template,this.element.tagName);this._initializing||(this._reloadRepeater(!0),this.dispatchEvent(v,{}));this._writeProfilerMark("template.set,StopTM")}},length:{get:function(){return this._repeatedDOM.length}},elementFromIndex:function(n){return this._repeatedDOM[n]},dispose:function(){if(!this._disposed){this._disposed=!0;this._removeDataListeners();this._data=null;this._template=null;for(var n=0,t=this._repeatedDOM.length;n<t;n++)l._disposeElement(this._repeatedDOM[n])}},onitemsloaded:n(v),onitemchanging:n(y),onitemchanged:n(p),oniteminserting:n(w),oniteminserted:n(b),onitemmoving:n(k),onitemmoved:n(d),onitemremoving:n(g),onitemremoved:n(nt),onitemsreloading:n(tt),onitemsreloaded:n(it),_extractInlineTemplate:function(){if(this._element.firstElementChild){for(var n=t.document.createElement(this._element.tagName);this._element.firstElementChild;)n.appendChild(this._element.firstElementChild);return new s.Template(n,{extractChild:!0})}},_renderAllItems:function(){for(var n,u=t.document.createDocumentFragment(),i=0,e=this._data.length;i<e;i++){if(n=this._render(this._data.getAt(i)),!n)throw new r("WinJS.UI.Repeater.AsynchronousRender",f.asynchronousRender);u.appendChild(n);this._repeatedDOM.push(n)}this._element.appendChild(u)},_reloadRepeater:function(n){this._unloadRepeatedDOM(n);this._repeatedDOM=[];this._renderAllItems()},_unloadRepeatedDOM:function(n){for(var i,t=0,r=this._repeatedDOM.length;t<r;t++)i=this._repeatedDOM[t],!n||l._disposeElement(i),i.parentElement===this._element&&this._element.removeChild(i)},_addDataListeners:function(){Object.keys(this._dataListeners).forEach(function(n){this._data.addEventListener(n,this._dataListeners[n],!1)}.bind(this))},_beginModification:function(){if(this._modifying)throw new r("WinJS.UI.Repeater.RepeaterModificationReentrancy",f.repeaterReentrancy);this._modifying=!0},_endModification:function(){this._modifying=!1},_removeDataListeners:function(){Object.keys(this._dataListeners).forEach(function(n){this._data.removeEventListener(n,this._dataListeners[n],!1)}.bind(this))},_dataItemChangedHandler:function(n){var u;this._beginModification();var e,o=this._element,i=n.detail.index,t=this._render(n.detail.newValue);if(!t)throw new r("WinJS.UI.Repeater.AsynchronousRender",f.asynchronousRender);this._repeatedDOM[i]&&(n.detail.oldElement=this._repeatedDOM[i]);n.detail.newElement=t;n.detail.setPromise=function(n){e=n};this._writeProfilerMark(y+",info");this.dispatchEvent(y,n.detail);u=null;i<this._repeatedDOM.length?(u=this._repeatedDOM[i],o.replaceChild(t,u),this._repeatedDOM[i]=t):(o.appendChild(t),this._repeatedDOM.push(t));this._endModification();this._writeProfilerMark(p+",info");this.dispatchEvent(p,n.detail);u&&h.as(e).done(function(){l._disposeElement(u)}.bind(this))},_dataItemInsertedHandler:function(n){var i,t,u,e;if(this._beginModification(),i=n.detail.index,t=this._render(n.detail.value),!t)throw new r("WinJS.UI.Repeater.AsynchronousRender",f.asynchronousRender);u=this._element;n.detail.affectedElement=t;this._writeProfilerMark(w+",info");this.dispatchEvent(w,n.detail);i<this._repeatedDOM.length?(e=this._repeatedDOM[i],u.insertBefore(t,e)):u.appendChild(t);this._repeatedDOM.splice(i,0,t);this._endModification();this._writeProfilerMark(b+",info");this.dispatchEvent(b,n.detail)},_dataItemMovedHandler:function(n){var t,i;this._beginModification();t=this._repeatedDOM[n.detail.oldIndex];n.detail.affectedElement=t;this._writeProfilerMark(k+",info");this.dispatchEvent(k,n.detail);this._repeatedDOM.splice(n.detail.oldIndex,1)[0];t.parentNode.removeChild(t);n.detail.newIndex<this._data.length-1?(i=this._repeatedDOM[n.detail.newIndex],this._element.insertBefore(t,i),this._repeatedDOM.splice(n.detail.newIndex,0,t)):(this._repeatedDOM.push(t),this._element.appendChild(t));this._endModification();this._writeProfilerMark(d+",info");this.dispatchEvent(d,n.detail)},_dataItemRemovedHandler:function(n){this._beginModification();var r,t=this._repeatedDOM[n.detail.index],i={affectedElement:t,index:n.detail.index,item:n.detail.item};i.setPromise=function(n){r=n};this._writeProfilerMark(g+",info");this.dispatchEvent(g,i);t.parentNode.removeChild(t);this._repeatedDOM.splice(n.detail.index,1);this._endModification();this._writeProfilerMark(nt+",info");this.dispatchEvent(nt,i);h.as(r).done(function(){l._disposeElement(t)}.bind(this))},_dataReloadHandler:function(){var i,n,t,r;this._beginModification();n=this._repeatedDOM.slice(0);t={affectedElements:n};t.setPromise=function(n){i=n};this._writeProfilerMark(tt+",info");this.dispatchEvent(tt,t);this._reloadRepeater(!1);r=this._repeatedDOM.slice(0);this._endModification();this._writeProfilerMark(it+",info");this.dispatchEvent(it,{affectedElements:r});h.as(i).done(function(){for(var t=0,i=n.length;t<i;t++)l._disposeElement(n[t])}.bind(this))},_writeProfilerMark:function(n){e("WinJS.UI.Repeater:"+this._id+":"+n)}},{isDeclarativeControlContainer:!0});return i.Class.mix(rt,c.DOMEventMixin),rt})})}),t("require-style!less/styles-datetimepicker",[],function(){}),t("WinJS/Controls/DatePicker",["../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_Events","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_Select","require-style!less/styles-datetimepicker"],function(n,t,i,r,u,f,e,o,s,h){"use strict";i.Namespace.define("WinJS.UI",{DatePicker:i.Namespace._lazy(function(){function b(n,i,r){var f=t.Windows.Globalization.DateTimeFormatting,u;return(n=n?n:r,u=new f.DateTimeFormatter(n),i)?new f.DateTimeFormatter(n,u.languages,u.geographicRegion,i,u.clock):u}function c(n,t,i){var f=p[n],u,r;return f||(f=p[n]={}),u=f[t],u||(u=f[t]={}),r=u[i],r||(r=u[i]={},r.formatter=b(n,t,i),r.years={}),r}function k(n,t,i,r,u,f){var o=c(n,t,i),e=o.years[f.year+"-"+f.era];return e||(e=o.formatter.format(f.getDateTime()),o.years[f.year+"-"+f.era]=e),e}function d(n,t,i,r){var u=c(n,t,i);return u.formatter.format(r.getDateTime())}function g(n,t,i,r){var u=c(n,t,i);return u.formatter.format(r.getDateTime())}function l(n){var r=t.Windows.Globalization,i=new r.Calendar;return n?new r.Calendar(i.languages,n,i.getClock()):i}function w(n,t){var i=0;if(n.era===t.era)i=t.year-n.year;else while(n.era!==t.era||n.year!==t.year)i++,n.addYears(1);return i}var a="day",v="{month.full}",y="year.full",s={get ariaLabel(){return f._getWinJSString("ui/datePicker").value},get selectDay(){return f._getWinJSString("ui/selectDay").value},get selectMonth(){return f._getWinJSString("ui/selectMonth").value},get selectYear(){return f._getWinJSString("ui/selectYear").value}},p={},r=i.Class.define(function(t,i){this._currentDate=new Date;this._minYear=this._currentDate.getFullYear()-100;this._maxYear=this._currentDate.getFullYear()+100;this._datePatterns={date:null,month:null,year:null};t=t||n.document.createElement("div");o.addClass(t,"win-disposable");t.winControl=this;var r=t.getAttribute("aria-label");r||t.setAttribute("aria-label",s.ariaLabel);this._init(t);e.setOptions(this,i)},{_information:null,_currentDate:null,_calendar:null,_disabled:!1,_dateElement:null,_dateControl:null,_monthElement:null,_monthControl:null,_minYear:null,_maxYear:null,_yearElement:null,_yearControl:null,_datePatterns:{date:null,month:null,year:null},_addAccessibilityAttributes:function(){this._domElement.setAttribute("role","group");this._dateElement.setAttribute("aria-label",s.selectDay);this._monthElement.setAttribute("aria-label",s.selectMonth);this._yearElement.setAttribute("aria-label",s.selectYear)},_addControlsInOrder:function(){var t=this._domElement,n=this,i=0;n._information.order.forEach(function(r){switch(r){case"month":t.appendChild(n._monthElement);o.addClass(n._monthElement,"win-order"+i++);break;case"date":t.appendChild(n._dateElement);o.addClass(n._dateElement,"win-order"+i++);break;case"year":t.appendChild(n._yearElement);o.addClass(n._yearElement,"win-order"+i++)}})},_createControlElements:function(){this._monthElement=n.document.createElement("select");this._monthElement.className="win-datepicker-month";this._dateElement=n.document.createElement("select");this._dateElement.className="win-datepicker-date";this._yearElement=n.document.createElement("select");this._yearElement.className="win-datepicker-year"},_createControls:function(){var t=this._information,n=t.getIndex(this.current);t.forceLanguage&&(this._domElement.setAttribute("lang",t.forceLanguage),this._domElement.setAttribute("dir",t.isRTL?"rtl":"ltr"));this._yearControl=new h._Select(this._yearElement,{dataSource:this._information.years,disabled:this.disabled,index:n.year});this._monthControl=new h._Select(this._monthElement,{dataSource:this._information.months(n.year),disabled:this.disabled,index:n.month});this._dateControl=new h._Select(this._dateElement,{dataSource:this._information.dates(n.year,n.month),disabled:this.disabled,index:n.date});this._wireupEvents()},dispose:function(){},calendar:{get:function(){return this._calendar},set:function(n){this._calendar=n;this._setElement(this._domElement)}},current:{get:function(){var n=this._currentDate,t=n.getFullYear();return new Date(Math.max(Math.min(this.maxYear,t),this.minYear),n.getMonth(),n.getDate(),12,0,0,0)},set:function(n){var t,i;typeof n=="string"?(t=new Date(Date.parse(n)),t.setHours(12,0,0,0)):t=n;i=this._currentDate;i!==t&&(this._currentDate=t,this._updateDisplay())}},disabled:{get:function(){return this._disabled},set:function(n){this._disabled!==n&&(this._disabled=n,this._yearControl&&(this._monthControl.setDisabled(n),this._dateControl.setDisabled(n),this._yearControl.setDisabled(n)))}},datePattern:{get:function(){return this._datePatterns.date},set:function(n){this._datePatterns.date!==n&&(this._datePatterns.date=n,this._init())}},element:{get:function(){return this._domElement}},_setElement:function(n){(this._domElement=this._domElement||n,this._domElement)&&(o.empty(this._domElement),o.addClass(this._domElement,"win-datepicker"),this._updateInformation(),this._createControlElements(),this._addControlsInOrder(),this._createControls(),this._addAccessibilityAttributes())},minYear:{get:function(){return this._information.getDate({year:0,month:0,date:0}).getFullYear()},set:function(n){this._minYear!==n&&(this._minYear=n,n>this._maxYear&&(this._maxYear=n),this._updateInformation(),this._yearControl&&(this._yearControl.dataSource=this._information.years),this._updateDisplay())}},maxYear:{get:function(){var n={year:this._information.years.getLength()-1};return n.month=this._information.months(n.year).getLength()-1,n.date=this._information.dates(n.year,n.month).getLength()-1,this._information.getDate(n).getFullYear()},set:function(n){this._maxYear!==n&&(this._maxYear=n,n<this._minYear&&(this._minYear=n),this._updateInformation(),this._yearControl&&(this._yearControl.dataSource=this._information.years),this._updateDisplay())}},monthPattern:{get:function(){return this._datePatterns.month},set:function(n){this._datePatterns.month!==n&&(this._datePatterns.month=n,this._init())}},_updateInformation:function(){var n=new Date(this._minYear,0,1,12,0,0),t=new Date(this._maxYear,11,31,12,0,0);n.setFullYear(this._minYear);t.setFullYear(this._maxYear);this._information=r.getInformation(n,t,this._calendar,this._datePatterns)},_init:function(n){this._setElement(n)},_updateDisplay:function(){if(this._domElement&&this._yearControl){var n=this._information.getIndex(this.current);this._yearControl.index=n.year;this._monthControl.dataSource=this._information.months(n.year);this._monthControl.index=n.month;this._dateControl.dataSource=this._information.dates(n.year,n.month);this._dateControl.index=n.date}},_wireupEvents:function(){function t(){n._currentDate=n._information.getDate({year:n._yearControl.index,month:n._monthControl.index,date:n._dateControl.index},n._currentDate);var t=n._information.getIndex(n._currentDate);n._monthControl.dataSource=n._information.months(t.year);n._monthControl.index=t.month;n._dateControl.dataSource=n._information.dates(t.year,t.month);n._dateControl.index=t.date}var n=this;this._dateElement.addEventListener("change",t,!1);this._monthElement.addEventListener("change",t,!1);this._yearElement.addEventListener("change",t,!1)},yearPattern:{get:function(){return this._datePatterns.year},set:function(n){this._datePatterns.year!==n&&(this._datePatterns.year=n,this._init())}}},{_getInformationWinRT:function(n,t,i,r){function h(n){return new Date(Math.min(new Date(Math.max(nt,n)),tt))}var nt,tt,it,p;r=r||{date:a,month:v,year:y};var u=l(i),e=l(i),f=l(i);u.setToMin();nt=u.getDateTime();u.setToMax();tt=u.getDateTime();u.hour=12;n=h(n);t=h(t);u.setDateTime(t);it={year:u.year,era:u.era};u.setDateTime(n);p=0;p=w(u,it)+1;var rt=c("day month.full year",i).formatter,o=rt.patterns[0],ut=o.charCodeAt(0)===8207,b=["date","month","year"],s={month:o.indexOf("{month"),date:o.indexOf("{day"),year:o.indexOf("{year")};b.sort(function(n,t){return s[n]<s[t]?-1:s[n]>s[t]?1:0});var ft=function(){return{getLength:function(){return p},getValue:function(t){return u.setDateTime(n),u.addYears(t),k(r.year,i,y,r,b,u)}}}(),et=function(t){return e.setDateTime(n),e.addYears(t),{getLength:function(){return e.numberOfMonthsInThisYear},getValue:function(n){return e.month=e.firstMonthInThisYear,e.addMonths(n),d(r.month,i,v,e)}}},ot=function(t,u){return f.setDateTime(n),f.addYears(t),f.month=f.firstMonthInThisYear,f.addMonths(u),f.day=f.firstDayInThisMonth,{getLength:function(){return f.numberOfDaysInThisMonth},getValue:function(n){return f.day=f.firstDayInThisMonth,f.addDays(n),g(r.date,i,a,f)}}};return{isRTL:ut,forceLanguage:rt.resolvedLanguage,order:b,getDate:function(t,i){var f,r,e,o;return i&&(u.setDateTime(i),f={year:u.year,month:u.month,day:u.day}),r=u,r.setDateTime(n),r.addYears(t.year),r.firstMonthInThisYear>r.lastMonthInThisYear?(e=t.month+r.firstMonthInThisYear>r.numberOfMonthsInThisYear?t.month+r.firstMonthInThisYear-r.numberOfMonthsInThisYear:t.month+r.firstMonthInThisYear,f&&f.year!==r.year&&(e=Math.max(Math.min(f.month,r.numberOfMonthsInThisYear),1))):e=f&&f.year!==r.year?Math.max(Math.min(f.month,r.firstMonthInThisYear+r.numberOfMonthsInThisYear-1),r.firstMonthInThisYear):Math.max(Math.min(t.month+r.firstMonthInThisYear,r.firstMonthInThisYear+r.numberOfMonthsInThisYear-1),r.firstMonthInThisYear),r.month=e,o=Math.max(Math.min(t.date+r.firstDayInThisMonth,r.firstDayInThisMonth+r.numberOfDaysInThisMonth-1),r.firstDayInThisMonth),f&&(f.year!==r.year||f.month!==r.month)&&(o=Math.max(Math.min(f.day,r.firstDayInThisMonth+r.numberOfDaysInThisMonth-1),r.firstDayInThisMonth)),r.day=r.firstDayInThisMonth,r.addDays(o-r.firstDayInThisMonth),r.getDateTime()},getIndex:function(t){var f=h(t),e,r,i,o,s;return u.setDateTime(f),e={year:u.year,era:u.era},r=0,u.setDateTime(n),u.month=1,r=w(u,e),u.setDateTime(f),i=u.month-u.firstMonthInThisYear,i<0&&(i=u.month-u.firstMonthInThisYear+u.numberOfMonthsInThisYear),o=u.day-u.firstDayInThisMonth,s={year:r,month:i,date:o},s},years:ft,months:et,dates:ot}},_getInformationJS:function(n,t){var i=n.getFullYear(),o=t.getFullYear(),r={getLength:function(){return Math.max(0,o-i+1)},getValue:function(n){return i+n}},u=["January","February","March","April","May","June","July","August","September","October","November","December"],f=function(){return{getLength:function(){return u.length},getValue:function(n){return u[n]},getMonthNumber:function(n){return Math.min(n,u.length-1)}}},e=function(n,t){var u=new Date,f=r.getValue(n),e=t+1,i;return u.setFullYear(f,e,0),i=u.getDate(),{getLength:function(){return i},getValue:function(n){return""+(n+1)},getDateNumber:function(n){return Math.min(n+1,i)}}};return{order:["month","date","year"],getDate:function(n){return new Date(r.getValue(n.year),f(n.year).getMonthNumber(n.month),e(n.year,n.month).getDateNumber(n.date),12,0)},getIndex:function(n){var t=0,o=n.getFullYear(),u,s;return t=o<i?0:o>this.maxYear?r.getLength()-1:n.getFullYear()-i,u=Math.min(n.getMonth(),f(t).getLength()),s=Math.min(n.getDate()-1,e(t,u).getLength()),{year:t,month:u,date:s}},years:r,months:f,dates:e}}});return r.getInformation=t.Windows.Globalization.Calendar&&t.Windows.Globalization.DateTimeFormatting?r._getInformationWinRT:r._getInformationJS,i.Class.mix(r,u.createEventProperties("change")),i.Class.mix(r,e.DOMEventMixin),r})})}),t("WinJS/Controls/TimePicker",["../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_Events","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_Select","require-style!less/styles-datetimepicker"],function(n,t,i,r,u,f,e,o,s,h){"use strict";i.Namespace.define("WinJS.UI",{TimePicker:i.Namespace._lazy(function(){var c="{minute.integer(2)}",l="{hour.integer(1)}",a="{period.abbreviated(2)}",s={get ariaLabel(){return f._getWinJSString("ui/timePicker").value},get selectHour(){return f._getWinJSString("ui/selectHour").value},get selectMinute(){return f._getWinJSString("ui/selectMinute").value},get selectAMPM(){return f._getWinJSString("ui/selectAMPM").value}},v=function(n,t){return n.getHours()===t.getHours()&&n.getMinutes()===t.getMinutes()},r=i.Class.define(function(t,i){this._currentTime=r._sentinelDate();t=t||n.document.createElement("div");o.addClass(t,"win-disposable");t.winControl=this;var u=t.getAttribute("aria-label");u||t.setAttribute("aria-label",s.ariaLabel);this._timePatterns={minute:null,hour:null,period:null};this._init(t);e.setOptions(this,i)},{_currentTime:null,_clock:null,_disabled:!1,_hourElement:null,_hourControl:null,_minuteElement:null,_minuteControl:null,_ampmElement:null,_ampmControl:null,_minuteIncrement:1,_timePatterns:{minute:null,hour:null,period:null},_information:null,_addAccessibilityAttributes:function(){this._domElement.setAttribute("role","group");this._hourElement.setAttribute("aria-label",s.selectHour);this._minuteElement.setAttribute("aria-label",s.selectMinute);this._ampmElement&&this._ampmElement.setAttribute("aria-label",s.selectAMPM)},_addControlsInOrder:function(n){var t=this;n.order.forEach(function(n,i){switch(n){case"hour":t._domElement.appendChild(t._hourElement);o.addClass(t._hourElement,"win-order"+i);break;case"minute":t._domElement.appendChild(t._minuteElement);o.addClass(t._minuteElement,"win-order"+i);break;case"period":t._ampmElement&&(t._domElement.appendChild(t._ampmElement),o.addClass(t._ampmElement,"win-order"+i))}})},dispose:function(){},clock:{get:function(){return this._clock},set:function(n){this._clock!==n&&(this._clock=n,this._init())}},current:{get:function(){var t=this._currentTime,n;return t?(n=r._sentinelDate(),n.setHours(t.getHours()),n.setMinutes(this._getMinutesIndex(t)*this.minuteIncrement),n.setSeconds(0),n.setMilliseconds(0),n):t},set:function(n){var t,i;typeof n=="string"?(t=r._sentinelDate(),t.setTime(Date.parse(t.toDateString()+" "+n))):(t=r._sentinelDate(),t.setHours(n.getHours()),t.setMinutes(n.getMinutes()));i=this._currentTime;v(i,t)||(this._currentTime=t,this._updateDisplay())}},disabled:{get:function(){return this._disabled},set:function(n){this._disabled!==n&&(this._disabled=n,this._hourControl&&(this._hourControl.setDisabled(n),this._minuteControl.setDisabled(n)),this._ampmControl&&this._ampmControl.setDisabled(n))}},element:{get:function(){return this._domElement}},_init:function(n){this._setElement(n);this._updateDisplay()},hourPattern:{get:function(){return this._timePatterns.hour.pattern},set:function(n){this._timePatterns.hour!==n&&(this._timePatterns.hour=n,this._init())}},_getHoursAmpm:function(n){var t=n.getHours();return this._ampmElement?t===0?{hours:12,ampm:0}:t<12?{hours:t,ampm:0}:{hours:t-12,ampm:1}:{hours:t}},_getHoursIndex:function(n){return this._ampmElement&&n===12?0:n},_getMinutesIndex:function(n){return parseInt(n.getMinutes()/this.minuteIncrement)},minuteIncrement:{get:function(){return Math.max(1,Math.abs(this._minuteIncrement|0)%60)},set:function(n){this._minuteIncrement!==n&&(this._minuteIncrement=n,this._init())}},minutePattern:{get:function(){return this._timePatterns.minute.pattern},set:function(n){this._timePatterns.minute!==n&&(this._timePatterns.minute=n,this._init())}},periodPattern:{get:function(){return this._timePatterns.period.pattern},set:function(n){this._timePatterns.period!==n&&(this._timePatterns.period=n,this._init())}},_setElement:function(t){var i,u;(this._domElement=this._domElement||t,this._domElement)&&(i=r.getInformation(this.clock,this.minuteIncrement,this._timePatterns),this._information=i,i.forceLanguage&&(this._domElement.setAttribute("lang",i.forceLanguage),this._domElement.setAttribute("dir",i.isRTL?"rtl":"ltr")),o.empty(this._domElement),o.addClass(this._domElement,"win-timepicker"),this._hourElement=n.document.createElement("select"),o.addClass(this._hourElement,"win-timepicker-hour"),this._minuteElement=n.document.createElement("select"),o.addClass(this._minuteElement,"win-timepicker-minute"),this._ampmElement=null,i.clock==="12HourClock"&&(this._ampmElement=n.document.createElement("select"),o.addClass(this._ampmElement,"win-timepicker-period")),this._addControlsInOrder(i),u=this._getHoursAmpm(this.current),this._hourControl=new h._Select(this._hourElement,{dataSource:this._getInfoHours(),disabled:this.disabled,index:this._getHoursIndex(u.hours)}),this._minuteControl=new h._Select(this._minuteElement,{dataSource:i.minutes,disabled:this.disabled,index:this._getMinutesIndex(this.current)}),this._ampmControl=null,this._ampmElement&&(this._ampmControl=new h._Select(this._ampmElement,{dataSource:i.periods,disabled:this.disabled,index:u.ampm})),this._wireupEvents(),this._updateValues(),this._addAccessibilityAttributes())},_getInfoHours:function(){return this._information.hours},_updateLayout:function(){this._domElement&&this._updateValues()},_updateValues:function(){if(this._hourControl){var n=this._getHoursAmpm(this.current);this._ampmControl&&(this._ampmControl.index=n.ampm);this._hourControl.index=this._getHoursIndex(n.hours);this._minuteControl.index=this._getMinutesIndex(this.current)}},_updateDisplay:function(){var n=this._getHoursAmpm(this.current);this._ampmControl&&(this._ampmControl.index=n.ampm);this._hourControl&&(this._hourControl.index=this._getHoursIndex(n.hours),this._minuteControl.index=this._getMinutesIndex(this.current))},_wireupEvents:function(){var n=this,i=function(){var t=n._hourControl.index;return n._ampmElement&&n._ampmControl.index===1&&t!==12&&(t+=12),t},t=function(){var t=i();n._currentTime.setHours(t);n._currentTime.setMinutes(n._minuteControl.index*n.minuteIncrement)};this._hourElement.addEventListener("change",t,!1);this._minuteElement.addEventListener("change",t,!1);this._ampmElement&&this._ampmElement.addEventListener("change",t,!1)}},{_sentinelDate:function(){var n=new Date;return new Date(2011,6,15,n.getHours(),n.getMinutes())},_getInformationWinRT:function(n,i,u){var o=function(i,r){var f=t.Windows.Globalization.DateTimeFormatting,u;return i=i?i:r,u=new f.DateTimeFormatter(i),n&&(u=f.DateTimeFormatter(i,u.languages,u.geographicRegion,u.calendar,n)),u},y=t.Windows.Globalization,e=new y.Calendar,p,s,k;n&&(e=new y.Calendar(e.languages,e.getCalendarSystem(),n));e.setDateTime(r._sentinelDate());p=e.getClock();s=24;s=e.numberOfHoursInThisPeriod;var d=function(){var n=o(u.period,a);return{getLength:function(){return 2},getValue:function(t){var i=r._sentinelDate();return t===0?(i.setHours(1),n.format(i)):t===1?(i.setHours(13),n.format(i)):null}}}(),g=function(){var t=o(u.minute,c),n=r._sentinelDate();return{getLength:function(){return 60/i},getValue:function(r){var u=r*i;return n.setMinutes(u),t.format(n)}}}(),nt=function(){var t=o(u.hour,l),n=r._sentinelDate();return{getLength:function(){return s},getValue:function(i){return n.setHours(i),t.format(n)}}}(),w=o("hour minute"),h=w.patterns[0],v=["hour","minute"],f={period:h.indexOf("{period"),hour:h.indexOf("{hour"),minute:h.indexOf("{minute")};f.period>-1&&v.push("period");var tt=t.Windows.Globalization.DateTimeFormatting.DateTimeFormatter,it=new tt("month.full",t.Windows.Globalization.ApplicationLanguages.languages,"ZZ","GregorianCalendar","24HourClock"),rt=it.patterns[0],b=rt.charCodeAt(0)===8207;return b&&(k=f.hour,f.hour=f.minute,f.minute=k),v.sort(function(n,t){return f[n]<f[t]?-1:f[n]>f[t]?1:0}),{minutes:g,hours:nt,clock:p,periods:d,order:v,forceLanguage:w.resolvedLanguage,isRTL:b}},_getInformationJS:function(n,t){var u=[12,1,2,3,4,5,6,7,8,9,10,11],i={},r;return i.getLength=function(){return 60/t},i.getValue=function(n){var i=n*t;return i<10?"0"+i.toString():i.toString()},r=["hour","minute","period"],n==="24HourClock"&&(u=["00","01","02","03","04","05","06","07","08","09",10,11,12,13,14,15,16,17,18,19,20,21,22,23],r=["hour","minute"]),{minutes:i,hours:u,clock:n||"12HourClock",periods:["AM","PM"],order:r}}});return r.getInformation=t.Windows.Globalization.DateTimeFormatting&&t.Windows.Globalization.Calendar&&t.Windows.Globalization.ApplicationLanguages?r._getInformationWinRT:r._getInformationJS,i.Class.mix(r,u.createEventProperties("change")),i.Class.mix(r,e.DOMEventMixin),r})})}),t("require-style!less/styles-backbutton",[],function(){}),t("require-style!less/colors-backbutton",[],function(){}),t("WinJS/Controls/BackButton",["exports","../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_Resources","../Navigation","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","require-style!less/styles-backbutton","require-style!less/colors-backbutton"],function(n,t,i,r,u,f,e,o){"use strict";var h=o.Key,c="win-navigation-backbutton",l="win-back",a=3,s=function(){function u(){t.addEventListener("keyup",i,!1);o._addEventListener(t,"pointerup",r,!1)}function e(){t.removeEventListener("keyup",i,!1);o._removeEventListener(t,"pointerup",r,!1)}function i(n){(n.keyCode!==h.leftArrow||!n.altKey||n.shiftKey||n.ctrlKey)&&n.keyCode!==h.browserBack||(f.back(),n.preventDefault())}function r(n){n.button===a&&f.back()}var n=0;return{addRef:function(){n===0&&u();n++},release:function(){n>0&&(n--,n===0&&e())},getCount:function(){return n}}}();i.Namespace._moduleDefine(n,"WinJS.UI",{BackButton:i.Namespace._lazy(function(){var n={get ariaLabel(){return u._getWinJSString("ui/backbuttonarialabel").value},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get badButtonElement(){return"Invalid argument: For a button, toggle, or flyout command, the element must be null or a button element"}},h=i.Class.define(function(i,u){if(i&&i.winControl)throw new r("WinJS.UI.BackButton.DuplicateConstruction",n.duplicateConstruction);this._element=i||t.document.createElement("button");u=u||{};this._initializeButton();this._disposed=!1;this._element.winControl=this;e.setOptions(this,u);this._buttonClickHandler=this._handleBackButtonClick.bind(this);this._element.addEventListener("click",this._buttonClickHandler,!1);this._navigatedHandler=this._handleNavigatedEvent.bind(this);f.addEventListener("navigated",this._navigatedHandler,!1);s.addRef()},{element:{get:function(){return this._element}},dispose:function(){this._disposed||(this._disposed=!0,f.removeEventListener("navigated",this._navigatedHandler,!1),s.release())},refresh:function(){this._element.disabled=f.canGoBack?!1:!0},_initializeButton:function(){if(this._element.tagName!=="BUTTON")throw new r("WinJS.UI.BackButton.BadButtonElement",n.badButtonElement);o.addClass(this._element,c);o.addClass(this._element,"win-disposable");this._element.innerHTML='<span class="'+l+'"><\/span>';this.refresh();this._element.setAttribute("aria-label",n.ariaLabel);this._element.setAttribute("title",n.ariaLabel);this._element.setAttribute("type","button")},_handleNavigatedEvent:function(){this.refresh()},_handleBackButtonClick:function(){f.back()}});return h._getReferenceCount=function(){return s.getCount()},i.Class.mix(h,e.DOMEventMixin),h})})}),t("require-style!less/styles-tooltip",[],function(){}),t("require-style!less/colors-tooltip",[],function(){}),t("WinJS/Controls/Tooltip",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_Events","../Animations","../Animations/_TransitionAnimation","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","require-style!less/styles-tooltip","require-style!less/colors-tooltip"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";r.Namespace._moduleDefine(n,"WinJS.UI",{Tooltip:r.Namespace._lazy(function(){function ni(n,t){return n==="pointerdown"?t===l:n in ot}function ti(n,t){return n==="pointerdown"?t!==l:n in ht}var y=0,p=c.Key,w="top",b=o._animationTimeAdjustment(400),k=o._animationTimeAdjustment(1200),d=o._animationTimeAdjustment(400),g=o._animationTimeAdjustment(5e3),nt=o._animationTimeAdjustment(0),tt=o._animationTimeAdjustment(600),it=o._animationTimeAdjustment(400),rt=o._animationTimeAdjustment(600),ut=o._animationTimeAdjustment(200),ft=o._animationTimeAdjustment(3e5),yt=12,pt=20,wt=45,bt=20,kt=12,et=1,dt=c._MSPointerEvent.MSPOINTER_TYPE_MOUSE||"mouse",l=c._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",ot={keyup:"",pointerover:"",pointerdown:""},st={pointermove:""},ht={pointerdown:"",keydown:"",focusout:"",pointerout:"",pointercancel:"",pointerup:""},gt={pointerover:"",pointerout:""},ii="win-tooltip",ri="win-tooltip-phantom",n=d,ct=2*n,lt=2.5*n,v=g,at=!1,vt=!1,a=f._createEventProperty;return r.Class.define(function(r,u){var e,f,h;if(r=r||t.document.createElement("div"),e=c.data(r).tooltip,e)return e;!vt&&i.Windows.UI.ViewManagement.UISettings&&(f=new i.Windows.UI.ViewManagement.UISettings,n=o._animationTimeAdjustment(f.mouseHoverTime),ct=2*n,lt=2.5*n,v=o._animationTimeAdjustment(f.messageDuration*1e3),h=f.handPreference,at=h===i.Windows.UI.ViewManagement.HandPreference.leftHanded);vt=!0;this._disposed=!1;this._placement=w;this._infotip=!1;this._innerHTML=null;this._contentElement=null;this._extraClass=null;this._lastContentType="html";this._anchorElement=r;this._domElement=null;this._phantomDiv=null;this._triggerByOpen=!1;this._eventListenerRemoveStack=[];this._lastKeyOrBlurEvent=null;this._currentKeyOrBlurEvent=null;r.winControl=this;c.addClass(r,"win-disposable");r.title&&(this._innerHTML=this._anchorElement.title,this._anchorElement.removeAttribute("title"));s.setOptions(this,u);this._events();c.data(r).tooltip=this},{innerHTML:{get:function(){return this._innerHTML},set:function(n){if(this._innerHTML=n,this._domElement){if(!this._innerHTML||this._innerHTML===""){this._onDismiss();return}this._domElement.innerHTML=n;this._position()}this._lastContentType="html"}},element:{get:function(){return this._anchorElement}},contentElement:{get:function(){return this._contentElement},set:function(n){if(this._contentElement=n,this._domElement){if(!this._contentElement){this._onDismiss();return}this._domElement.innerHTML="";this._domElement.appendChild(this._contentElement);this._position()}this._lastContentType="element"}},placement:{get:function(){return this._placement},set:function(n){n!=="top"&&n!=="bottom"&&n!=="left"&&n!=="right"&&(n=w);this._placement=n;this._domElement&&this._position()}},infotip:{get:function(){return this._infotip},set:function(n){this._infotip=!!n}},extraClass:{get:function(){return this._extraClass},set:function(n){this._extraClass=n}},onbeforeopen:a("beforeopen"),onopened:a("opened"),onbeforeclose:a("beforeclose"),onclosed:a("closed"),dispose:function(){var n,i,t;if(!this._disposed){for(this._disposed=!0,h.disposeSubTree(this.element),n=0,i=this._eventListenerRemoveStack.length;n<i;n++)this._eventListenerRemoveStack[n]();this._onDismiss();t=c.data(this._anchorElement);t&&delete t.tooltip}},addEventListener:function(n,t,i){if(this._anchorElement){this._anchorElement.addEventListener(n,t,i);var r=this;this._eventListenerRemoveStack.push(function(){r._anchorElement.removeEventListener(n,t,i)})}},removeEventListener:function(n,t,i){this._anchorElement&&this._anchorElement.removeEventListener(n,t,i)},open:function(n){this._triggerByOpen=!0;n!=="touch"&&n!=="mouseover"&&n!=="mousedown"&&n!=="keyboard"&&(n="default");switch(n){case"touch":this._onInvoke("touch","never");break;case"mouseover":this._onInvoke("mouse","auto");break;case"keyboard":this._onInvoke("keyboard","auto");break;case"mousedown":case"default":this._onInvoke("nodelay","never")}},close:function(){this._onDismiss()},_cleanUpDOM:function(){this._domElement&&(h.disposeSubTree(this._domElement),t.document.body.removeChild(this._domElement),this._domElement=null,t.document.body.removeChild(this._phantomDiv),this._phantomDiv=null)},_createTooltipDOM:function(){var n,i,r,u;this._cleanUpDOM();this._domElement=t.document.createElement("div");n=c._uniqueID(this._domElement);this._domElement.setAttribute("id",n);i=t.document.defaultView.getComputedStyle(this._anchorElement,null);r=this._domElement.style;r.direction=i.direction;r.writingMode=i["writing-mode"];this._domElement.setAttribute("tabindex",-1);this._domElement.setAttribute("role","tooltip");this._anchorElement.setAttribute("aria-describedby",n);this._lastContentType==="element"?this._domElement.appendChild(this._contentElement):this._domElement.innerHTML=this._innerHTML;t.document.body.appendChild(this._domElement);c.addClass(this._domElement,ii);this._extraClass&&c.addClass(this._domElement,this._extraClass);this._phantomDiv=t.document.createElement("div");this._phantomDiv.setAttribute("tabindex",-1);t.document.body.appendChild(this._phantomDiv);c.addClass(this._phantomDiv,ri);u=t.document.defaultView.getComputedStyle(this._domElement,null).zIndex+1;this._phantomDiv.style.zIndex=u},_raiseEvent:function(n,i){if(this._anchorElement){var r=t.document.createEvent("CustomEvent");r.initCustomEvent(n,!1,!1,i);this._anchorElement.dispatchEvent(r)}},_captureLastKeyBlurOrPointerOverEvent:function(n){this._lastKeyOrBlurEvent=this._currentKeyOrBlurEvent;switch(n.type){case"keyup":this._currentKeyOrBlurEvent=n.keyCode===p.shift?null:"keyboard";break;case"focusout":this._currentKeyOrBlurEvent=null}},_registerEventToListener:function(n,t){var i=this,r=function(n){i._captureLastKeyBlurOrPointerOverEvent(n);i._handleEvent(n)};c._addEventListener(n,t,r,!1);this._eventListenerRemoveStack.push(function(){c._removeEventListener(n,t,r,!1)})},_events:function(){for(var n in ot)this._registerEventToListener(this._anchorElement,n);for(n in st)this._registerEventToListener(this._anchorElement,n);for(n in ht)this._registerEventToListener(this._anchorElement,n);this._registerEventToListener(this._anchorElement,"contextmenu");this._registerEventToListener(this._anchorElement,"MSHoldVisual")},_handleEvent:function(n){var t=n._normalizedType||n.type,i,r,f;if(!this._triggerByOpen){if(t in gt&&c.eventWithinElement(this._anchorElement,n))return;if(ni(t,n.pointerType))if(n.pointerType===l)this._isShown||(this._showTrigger="touch"),this._onInvoke("touch","never",n);else{if(this._skipMouseOver&&n.pointerType===dt&&t==="pointerover"){this._skipMouseOver=!1;return}i=t.substring(0,3)==="key"?"keyboard":"mouse";this._isShown||(this._showTrigger=i);this._onInvoke(i,"auto",n)}else if(t in st)this._contactPoint={x:n.clientX,y:n.clientY};else if(ti(t,n.pointerType)){if(n.pointerType===l?(t==="pointerup"&&(this._skipMouseOver=!0,f=this,u._yieldForEvents(function(){f._skipMouseOver=!1})),r="touch"):r=t.substring(0,3)==="key"?"keyboard":"mouse",t!=="focusout"&&r!==this._showTrigger)return;this._onDismiss()}else(t==="contextmenu"||t==="MSHoldVisual")&&n.preventDefault()}},_onShowAnimationEnd:function(){if(!this._shouldDismiss&&!this._disposed&&(this._raiseEvent("opened"),this._domElement&&this._hideDelay!=="never")){var n=this,t=this._infotip?Math.min(3*v,ft):v;this._hideDelayTimer=this._setTimeout(function(){n._onDismiss()},t)}},_onHideAnimationEnd:function(){t.document.body.removeEventListener("DOMNodeRemoved",this._removeTooltip,!1);this._cleanUpDOM();this._anchorElement&&this._anchorElement.removeAttribute("aria-describedby");y=(new Date).getTime();this._triggerByOpen=!1;this._disposed||this._raiseEvent("closed")},_decideOnDelay:function(n){var t,i;return this._useAnimation=!0,n==="nodelay"?(t=0,this._useAnimation=!1):(i=(new Date).getTime(),i-y<=ut?(t=n==="touch"?this._infotip?it:nt:this._infotip?rt:tt,this._useAnimation=!1):t=n==="touch"?this._infotip?k:b:this._infotip?lt:ct),t},_getAnchorPositionFromElementWindowCoord:function(){var n=this._anchorElement.getBoundingClientRect();return{x:n.left,y:n.top,width:n.width,height:n.height}},_getAnchorPositionFromPointerWindowCoord:function(n){return{x:n.x,y:n.y,width:1,height:1}},_canPositionOnSide:function(n,t,i,r){var u=0,f=0;switch(n){case"top":u=r.width+this._offset;f=i.y;break;case"bottom":u=r.width+this._offset;f=t.height-i.y-i.height;break;case"left":u=i.x;f=r.height+this._offset;break;case"right":u=t.width-i.x-i.width;f=r.height+this._offset}return u>=r.width+this._offset&&f>=r.height+this._offset},_positionOnSide:function(n,t,i,r){var u=0,f=0;switch(n){case"top":case"bottom":u=i.x+i.width/2-r.width/2;u=Math.min(Math.max(u,0),t.width-r.width-et);f=n==="top"?i.y-r.height-this._offset:i.y+i.height+this._offset;break;case"left":case"right":f=i.y+i.height/2-r.height/2;f=Math.min(Math.max(f,0),t.height-r.height-et);u=n==="left"?i.x-r.width-this._offset:i.x+i.width+this._offset}this._domElement.style.left=u+"px";this._domElement.style.top=f+"px";this._phantomDiv.style.left=u+"px";this._phantomDiv.style.top=f+"px";this._phantomDiv.style.width=r.width+"px";this._phantomDiv.style.height=r.height+"px"},_position:function(n){var r={width:0,height:0},o={x:0,y:0,width:0,height:0},e={width:0,height:0},u,f,s,i;for(r.width=t.document.documentElement.clientWidth,r.height=t.document.documentElement.clientHeight,t.document.defaultView.getComputedStyle(t.document.body,null)["writing-mode"]==="tb-rl"&&(r.width=t.document.documentElement.clientHeight,r.height=t.document.documentElement.clientWidth),o=this._contactPoint&&(n==="touch"||n==="mouse")?this._getAnchorPositionFromPointerWindowCoord(this._contactPoint):this._getAnchorPositionFromElementWindowCoord(),e.width=this._domElement.offsetWidth,e.height=this._domElement.offsetHeight,u={top:["top","bottom","left","right"],bottom:["bottom","top","left","right"],left:["left","right","top","bottom"],right:["right","left","top","bottom"]},at&&(u.top[2]="right",u.top[3]="left",u.bottom[2]="right",u.bottom[3]="left"),f=u[this._placement],s=f.length,i=0;i<s;i++)if(i===s-1||this._canPositionOnSide(f[i],r,o,e)){this._positionOnSide(f[i],r,o,e);break}return f[i]},_showTooltip:function(n){if(!this._shouldDismiss&&(this._isShown=!0,this._raiseEvent("beforeopen"),t.document.body.contains(this._anchorElement))&&!this._shouldDismiss){if(this._lastContentType==="element"){if(!this._contentElement){this._isShown=!1;return}}else if(!this._innerHTML||this._innerHTML===""){this._isShown=!1;return}var i=this;this._removeTooltip=function(n){for(var r=i._anchorElement;r;){if(n.target===r){t.document.body.removeEventListener("DOMNodeRemoved",i._removeTooltip,!1);i._cleanUpDOM();break}r=r.parentNode}};t.document.body.addEventListener("DOMNodeRemoved",this._removeTooltip,!1);this._createTooltipDOM();this._position(n);this._useAnimation?e.fadeIn(this._domElement).then(this._onShowAnimationEnd.bind(this)):this._onShowAnimationEnd()}},_onInvoke:function(n,t,i){var r,u;(this._shouldDismiss=!1,this._isShown)||(!i||i.type!=="keyup"||this._lastKeyOrBlurEvent!=="keyboard"&&(this._lastKeyOrBlurEvent||i.keyCode===p.tab))&&(this._hideDelay=t,this._contactPoint=null,i?(this._contactPoint={x:i.clientX,y:i.clientY},this._offset=n==="touch"?wt:n==="keyboard"?yt:pt):this._offset=n==="touch"?bt:kt,this._clearTimeout(this._delayTimer),this._clearTimeout(this._hideDelayTimer),r=this._decideOnDelay(n),r>0?(u=this,this._delayTimer=this._setTimeout(function(){u._showTooltip(n)},r)):this._showTooltip(n))},_onDismiss:function(){(this._shouldDismiss=!0,this._isShown)&&(this._isShown=!1,this._showTrigger="mouse",this._domElement?(this._raiseEvent("beforeclose"),this._useAnimation?e.fadeOut(this._domElement).then(this._onHideAnimationEnd.bind(this)):this._onHideAnimationEnd()):(this._raiseEvent("beforeclose"),this._raiseEvent("closed")))},_setTimeout:function(n,i){return t.setTimeout(n,i)},_clearTimeout:function(n){t.clearTimeout(n)}},{_DELAY_INITIAL_TOUCH_SHORT:{get:function(){return b}},_DELAY_INITIAL_TOUCH_LONG:{get:function(){return k}},_DEFAULT_MOUSE_HOVER_TIME:{get:function(){return d}},_DEFAULT_MESSAGE_DURATION:{get:function(){return g}},_DELAY_RESHOW_NONINFOTIP_TOUCH:{get:function(){return nt}},_DELAY_RESHOW_NONINFOTIP_NONTOUCH:{get:function(){return tt}},_DELAY_RESHOW_INFOTIP_TOUCH:{get:function(){return it}},_DELAY_RESHOW_INFOTIP_NONTOUCH:{get:function(){return rt}},_RESHOW_THRESHOLD:{get:function(){return ut}},_HIDE_DELAY_MAX:{get:function(){return ft}}})})})}),t("require-style!less/styles-rating",[],function(){}),t("require-style!less/colors-rating",[],function(){}),t("WinJS/Controls/Rating",["../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_SafeHtml","./Tooltip","require-style!less/styles-rating","require-style!less/colors-rating"],function(n,t,i,r,u,f,e,o,s,h){"use strict";t.Namespace.define("WinJS.UI",{Rating:t.Namespace._lazy(function(){var v=r._createEventProperty,o={get averageRating(){return u._getWinJSString("ui/averageRating").value},get clearYourRating(){return u._getWinJSString("ui/clearYourRating").value},get tentativeRating(){return u._getWinJSString("ui/tentativeRating").value},get tooltipStringsIsInvalid(){return"Invalid argument: tooltipStrings must be null or an array of strings."},get unrated(){return u._getWinJSString("ui/unrated").value},get userRating(){return u._getWinJSString("ui/userRating").value}},w=5,tt=!1,c="cancel",a="change",l="previewchange",it=0,b=e._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",rt=e._MSPointerEvent.MSPOINTER_TYPE_PEN||"pen",k=e._MSPointerEvent.MSPOINTER_TYPE_MOUSE||"mouse",d="padding-left: 0px; padding-right: 0px; border-left: 0px; border-right: 0px; -ms-flex: none; -webkit-flex: none; flex: none; display: none",ut="win-rating",ft="win-star win-empty",et="win-star win-average win-empty",y="win-star win-average win-full",g="win-star win-user win-empty",ot="win-star win-user win-full",p="win-star win-tentative win-empty",nt="win-star win-tentative win-full",st="win-disabled",ht="win-average",ct="win-user";return t.Class.define(function(t,i){this._disposed=!1;t=t||n.document.createElement("div");i=i||{};this._element=t;e.addClass(this._element,"win-disposable");this._userRating=0;this._averageRating=0;this._disabled=tt;this._enableClear=!0;this._tooltipStrings=[];this._controlUpdateNeeded=!1;this._setControlSize(i.maxRating);i.tooltipStrings||this._updateTooltips(null);f.setOptions(this,i);this._controlUpdateNeeded=!0;this._forceLayout();e._addInsertedNotifier(this._element);t.winControl=this;this._events()},{maxRating:{get:function(){return this._maxRating},set:function(n){this._setControlSize(n);this._forceLayout()}},userRating:{get:function(){return this._userRating},set:function(n){this._userRating=Math.max(0,Math.min(Number(n)>>0,this._maxRating));this._updateControl()}},averageRating:{get:function(){return this._averageRating},set:function(n){this._averageRating=Number(n)<1?0:Math.min(Number(n)||0,this._maxRating);this._averageRatingElement&&this._ensureAverageMSStarRating();this._updateControl()}},disabled:{get:function(){return this._disabled},set:function(n){this._disabled=!!n;this._disabled&&this._clearTooltips();this._updateTabIndex();this._updateControl()}},enableClear:{get:function(){return this._enableClear},set:function(n){this._enableClear=!!n;this._setAriaValueMin();this._updateControl()}},tooltipStrings:{get:function(){return this._tooltipStrings},set:function(n){if(typeof n!="object")throw new i("WinJS.UI.Rating.TooltipStringsIsInvalid",o.tooltipStringsIsInvalid);this._updateTooltips(n);this._updateAccessibilityRestState()}},element:{get:function(){return this._element}},oncancel:v(c),onchange:v(a),onpreviewchange:v(l),dispose:function(){if(!this._disposed){this._disposed=!0;for(var n=0;n<this._toolTips.length;n++)this._toolTips[n].dispose();this._toolTips=null}},addEventListener:function(n,t,i){this._element.addEventListener(n,t,i)},removeEventListener:function(n,t,i){return this._element.removeEventListener(n,t,i)},_forceLayout:function(){if(this._controlUpdateNeeded){var n=!1;this._updateControl=function(){n=!0};this.userRating=this._userRating;this.averageRating=this._averageRating;this._lastEventWasChange=!1;this._lastEventWasCancel=!1;this._tentativeRating=-1;this._captured=!1;this._pointerDownFocus=!1;this._elements=[];this._toolTips=[];this._clearElement=null;this._averageRatingElement=null;this._elementWidth=null;this._elementPadding=null;this._elementBorder=null;this._floatingValue=0;this._createControl();this._setAccessibilityProperties();delete this._updateControl;n&&this._updateControl()}},_hideAverageRating:function(){this._averageRatingHidden||(this._averageRatingHidden=!0,this._averageRatingElement.style.cssText=d)},_createControl:function(){var i,t,n;for(e.addClass(this._element,ut),i="",this._averageRatingHidden=!0,n=0;n<=this._maxRating;n++)i=n===this._maxRating?i+"<div class='"+y+"' style='"+d+"'><\/div>":i+"<div class='"+g+"'><\/div>";for(s.setInnerHTMLUnsafe(this._element,i),t=this._element.firstElementChild,n=0;t;)this._elements[n]=t,n<this._maxRating&&(e.data(t).msStarRating=n+1),t=t.nextElementSibling,n++;this._averageRatingElement=this._elements[this._maxRating];this._ensureAverageMSStarRating();this._updateTabIndex()},_setAriaValueMin:function(){this._element.setAttribute("aria-valuemin",this._enableClear?0:1)},_setAccessibilityProperties:function(){this._element.setAttribute("role","slider");this._element.setAttribute("aria-valuemax",this._maxRating);this._setAriaValueMin();this._updateAccessibilityRestState()},_getText:function(t){var r=this._tooltipStrings[t],i;return r?(i=n.document.createElement("div"),i.innerHTML=r,i.textContent):t===this._maxRating?o.clearYourRating:t+1},_updateAccessibilityRestState:function(){var n=this._element;this._ariaValueNowMutationObserver&&this._ariaValueNowMutationObserver.disconnect();n.setAttribute("aria-readOnly",this._disabled);this._userRating!==0?(n.setAttribute("aria-valuenow",this._userRating),n.setAttribute("aria-label",o.userRating),n.setAttribute("aria-valuetext",this._getText(this._userRating-1))):this._averageRating!==0?(n.setAttribute("aria-valuenow",this._averageRating),n.setAttribute("aria-label",o.averageRating),n.setAttribute("aria-valuetext",this._averageRating)):(n.setAttribute("aria-valuenow",o.unrated),n.setAttribute("aria-label",o.userRating),n.setAttribute("aria-valuetext",o.unrated));this._ariaValueNowMutationObserver&&this._ariaValueNowMutationObserver.observe(this._element,{attributes:!0,attributeFilter:["aria-valuenow"]})},_updateAccessibilityHoverState:function(){var n=this._element;this._ariaValueNowMutationObserver&&this._ariaValueNowMutationObserver.disconnect();n.setAttribute("aria-readOnly",this._disabled);this._tentativeRating>0?(n.setAttribute("aria-label",o.tentativeRating),n.setAttribute("aria-valuenow",this._tentativeRating),n.setAttribute("aria-valuetext",this._getText(this._tentativeRating-1))):this._tentativeRating===0?(n.setAttribute("aria-valuenow",o.unrated),n.setAttribute("aria-label",o.tentativeRating),n.setAttribute("aria-valuetext",this._getText(this._maxRating))):(n.setAttribute("aria-valuenow",o.unrated),n.setAttribute("aria-label",o.tentativeRating),n.setAttribute("aria-valuetext",o.unrated));this._ariaValueNowMutationObserver&&this._ariaValueNowMutationObserver.observe(this._element,{attributes:!0,attributeFilter:["aria-valuenow"]})},_ensureTooltips:function(){if(!this.disabled&&this._toolTips.length===0)for(var n=0;n<this._maxRating;n++)this._toolTips[n]=new h.Tooltip(this._elements[n])},_decrementRating:function(){this._closeTooltip();var n=!0;this._tentativeRating===0||this._tentativeRating===-1&&this._userRating===0?n=!1:(this._tentativeRating>0?this._tentativeRating--:this._tentativeRating===-1&&(this._tentativeRating=this._userRating!==0?this._userRating>0?this._userRating-1:0:0),this._tentativeRating!==0||this._enableClear||(this._tentativeRating=1,n=!1));this._showTentativeRating(n,"keyboard")},_events:function(){function n(n){return{name:n,lowerCaseName:n.toLowerCase(),handler:function(t){var i=u["_on"+n];i&&i.apply(u,[t])}}}for(var u=this,i=[n("KeyDown"),n("FocusOut"),n("FocusIn"),n("PointerCancel"),n("PointerDown"),n("PointerMove"),n("PointerOver"),n("PointerUp"),n("PointerOut")],r=[n("WinJSNodeInserted")],t=0;t<i.length;++t)e._addEventListener(this._element,i[t].lowerCaseName,i[t].handler,!1);for(t=0;t<r.length;++t)this._element.addEventListener(r[t].name,r[t].handler,!1);this._ariaValueNowMutationObserver=new e._MutationObserver(this._ariaValueNowChanged.bind(this));this._ariaValueNowMutationObserver.observe(this._element,{attributes:!0,attributeFilter:["aria-valuenow"]})},_onWinJSNodeInserted:function(){this._recalculateStarProperties();this._updateControl()},_recalculateStarProperties:function(){var i=0,t;this._averageRating===1&&(i=1);t=n.getComputedStyle(this._elements[i]);this._elementWidth=t.width;n.getComputedStyle(this._element).direction==="rtl"?(this._elementPadding=t.paddingRight,this._elementBorder=t.borderRight):(this._elementPadding=t.paddingLeft,this._elementBorder=t.borderLeft)},_hideAverageStar:function(){this._averageRating!==0&&this._resetAverageStar(!1)},_incrementRating:function(){this._closeTooltip();var n=!0;(this._tentativeRating===this._maxRating||this._tentativeRating===-1&&this._userRating===this._maxRating)&&(n=!1);this._tentativeRating!==-1?this._tentativeRating<this._maxRating&&this._tentativeRating++:this._tentativeRating=this._userRating!==0?this._userRating<this._maxRating?this._userRating+1:this._maxRating:1;this._showTentativeRating(n,"keyboard")},_ariaValueNowChanged:function(){var n,t;this._disabled||(n=this._element.getAttributeNode("aria-valuenow"),n!==null&&(t=Number(n.nodeValue),this.userRating!==t&&(this.userRating=t,this._tentativeRating=this._userRating,this._raiseEvent(a,this._userRating))))},_onPointerCancel:function(){this._showCurrentRating();this._lastEventWasChange||this._raiseEvent(c,null);this._captured=!1},_onPointerDown:function(n){(n.pointerType!==k||n.button===it)&&(this._captured||(this._pointerDownAt={x:n.clientX,y:n.clientY},this._pointerDownFocus=!0,this._disabled||(e._setPointerCapture(this._element,n.pointerId),this._captured=!0,n.pointerType===b?(this._tentativeRating=e.data(n.target).msStarRating||0,this._setStarClasses(nt,this._tentativeRating,p),this._hideAverageStar(),this._updateAccessibilityHoverState(),this._openTooltip("touch"),this._raiseEvent(l,this._tentativeRating)):this._openTooltip("mousedown"))))},_onCapturedPointerMove:function(t,i){var v=this._pointerDownAt||{x:t.clientX,y:t.clientY},u,h=e._elementsFromPoint(t.clientX,v.y),f,y,o,c,l,s,a,r;if(h)for(f=0,y=h.length;f<y;f++){if(o=h[f],o.getAttribute("role")==="tooltip")return;if(e.hasClass(o,"win-star")){u=o;break}}u&&u.parentElement===this._element?c=e.data(u).msStarRating||0:(l=0,s=this.maxRating,n.getComputedStyle(this._element).direction==="rtl"&&(l=s,s=0),c=t.clientX<v.x?l:s);a=!1;r=Math.min(Math.ceil(c),this._maxRating);r!==0||this._enableClear||(r=1);r!==this._tentativeRating&&(this._closeTooltip(),a=!0);this._tentativeRating=r;this._showTentativeRating(a,i);t.preventDefault()},_onPointerMove:function(n){this._captured&&(n.pointerType===b?this._onCapturedPointerMove(n,"touch"):this._onCapturedPointerMove(n,"mousedown"))},_onPointerOver:function(n){this._disabled||n.pointerType!==rt&&n.pointerType!==k||this._onCapturedPointerMove(n,"mouseover")},_onPointerUp:function(n){this._captured&&(e._releasePointerCapture(this._element,n.pointerId),this._captured=!1,this._onUserRatingChanged());this._pointerDownAt=null},_onFocusOut:function(){this._captured||(this._onUserRatingChanged(),this._lastEventWasChange||this._lastEventWasCancel||this._raiseEvent(c,null))},_onFocusIn:function(){if(!this._pointerDownFocus){if(!this._disabled){if(this._userRating===0)for(var n=0;n<this._maxRating;n++)this._elements[n].className=p;this._hideAverageStar()}this._userRating!==0?this._raiseEvent(l,this._userRating):this._raiseEvent(l,0);this._tentativeRating=this._userRating}this._pointerDownFocus=!1},_onKeyDown:function(t){var i=e.Key,u=t.keyCode,s=n.getComputedStyle(this._element).direction,r=!0,f,h,o;switch(u){case i.enter:this._onUserRatingChanged();break;case i.tab:this._onUserRatingChanged();r=!1;break;case i.escape:this._showCurrentRating();this._lastEventWasChange||this._raiseEvent(c,null);break;case i.leftArrow:s==="rtl"&&this.userRating<this.maxRating-1?this._incrementRating():s!=="rtl"&&this.userRating>0?this._decrementRating():r=!1;break;case i.upArrow:this.userRating<this.maxRating-1?this._incrementRating():r=!1;break;case i.rightArrow:s==="rtl"&&this.userRating>0?this._decrementRating():s!=="rtl"&&this.userRating<this.maxRating-1?this._incrementRating():r=!1;break;case i.downArrow:this.userRating>0?this._decrementRating():r=!1;break;default:f=0;u>=i.num0&&u<=i.num9?f=i.num0:u>=i.numPad0&&u<=i.numPad9&&(f=i.numPad0);f>0?(h=!1,o=Math.min(u-f,this._maxRating),o!==0||this._enableClear||(o=1),o!==this._tentativeRating&&(this._closeTooltip(),h=!0),this._tentativeRating=o,this._showTentativeRating(h,"keyboard")):r=!1}r&&(t.stopPropagation(),t.preventDefault())},_onPointerOut:function(n){this._captured||e.eventWithinElement(this._element,n)||(this._showCurrentRating(),this._lastEventWasChange||this._raiseEvent(c,null))},_onUserRatingChanged:function(){this._disabled||(this._closeTooltip(),this._userRating===this._tentativeRating||this._lastEventWasCancel||this._lastEventWasChange?this._updateControl():(this.userRating=this._tentativeRating,this._raiseEvent(a,this._userRating)))},_raiseEvent:function(t,i){if(!this._disabled&&(this._lastEventWasChange=t===a,this._lastEventWasCancel=t===c,n.document.createEvent)){var r=n.document.createEvent("CustomEvent");r.initCustomEvent(t,!1,!1,{tentativeRating:i});this._element.dispatchEvent(r)}},_resetNextElement:function(t){if(this._averageRatingElement.nextSibling!==null){e._setFlexStyle(this._averageRatingElement.nextSibling,{grow:1,shrink:1});var i=this._averageRatingElement.nextSibling.style,r=n.getComputedStyle(this._element).direction;t&&(r=r==="rtl"?"ltr":"rtl");r==="rtl"?(i.paddingRight=this._elementPadding,i.borderRight=this._elementBorder,i.direction="rtl"):(i.paddingLeft=this._elementPadding,i.borderLeft=this._elementBorder,i.direction="ltr");i.backgroundPosition="left";i.backgroundSize="100% 100%";i.width=this._resizeStringValue(this._elementWidth,1,i.width)}},_resetAverageStar:function(n){this._resetNextElement(n);this._hideAverageRating()},_resizeStringValue:function(n,t,i){var r=parseFloat(n),u;return isNaN(r)?i!==null?i:n:(u=n.substring(r.toString(10).length),r=r*t,r+u)},_setControlSize:function(n){var t=(Number(n)||w)>>0;this._maxRating=t>0?t:w},_updateTooltips:function(n){var t,i=0;if(n!==null)for(i=n.length<=this._maxRating+1?n.length:this._maxRating+1,t=0;t<i;t++)this._tooltipStrings[t]=n[t];else{for(t=0;t<this._maxRating;t++)this._tooltipStrings[t]=t+1;this._tooltipStrings[this._maxRating]=o.clearYourRating}},_updateTabIndex:function(){this._element.tabIndex=this._disabled?"-1":"0"},_setStarClasses:function(n,t,i){for(var r=0;r<this._maxRating;r++)this._elements[r].className=r<t?n:i},_updateAverageStar:function(){var t=this._averageRatingElement.style,i=this._averageRatingElement.nextSibling.style;n.getComputedStyle(this._element).direction==="rtl"?(t.backgroundPosition="right",t.paddingRight=this._elementPadding,t.borderRight=this._elementBorder,i.paddingRight="0px",i.borderRight="0px",i.direction="ltr"):(t.backgroundPosition="left",i.backgroundPosition="right",t.paddingLeft=this._elementPadding,t.borderLeft=this._elementBorder,i.paddingLeft="0px",i.borderLeft="0px",i.direction="rtl");e._setFlexStyle(this._averageRatingElement,{grow:this._floatingValue,shrink:this._floatingValue});t.width=this._resizeStringValue(this._elementWidth,this._floatingValue,t.width);t.backgroundSize=100/this._floatingValue+"% 100%";t.display=n.getComputedStyle(this._averageRatingElement.nextSibling).display;this._averageRatingHidden=!1;e._setFlexStyle(this._averageRatingElement.nextSibling,{grow:1-this._floatingValue,shrink:1-this._floatingValue});i.width=this._resizeStringValue(this._elementWidth,1-this._floatingValue,i.width);i.backgroundSize=100/(1-this._floatingValue)+"% 100%"},_showCurrentRating:function(){this._closeTooltip();this._tentativeRating=-1;this._disabled||this._updateControl();this._updateAccessibilityRestState()},_showTentativeRating:function(n,t){!this._disabled&&this._tentativeRating>=0&&(this._setStarClasses(nt,this._tentativeRating,p),this._hideAverageStar());this._updateAccessibilityHoverState();n&&(this._openTooltip(t),this._raiseEvent(l,this._tentativeRating))},_openTooltip:function(t){if(!this.disabled)if(this._ensureTooltips(),this._tentativeRating>0)this._toolTips[this._tentativeRating-1].innerHTML=this._tooltipStrings[this._tentativeRating-1],this._toolTips[this._tentativeRating-1].open(t);else if(this._tentativeRating===0){this._clearElement=n.document.createElement("div");var i=this._elements[0].offsetWidth+parseInt(this._elementPadding,10);n.getComputedStyle(this._element).direction==="ltr"&&(i*=-1);this._clearElement.style.cssText="visiblity:hidden; position:absolute; width:0px; height:100%; left:"+i+"px; top:0px;";this._elements[0].appendChild(this._clearElement);this._toolTips[this._maxRating]=new h.Tooltip(this._clearElement);this._toolTips[this._maxRating].innerHTML=this._tooltipStrings[this._maxRating];this._toolTips[this._maxRating].open(t)}},_closeTooltip:function(){this._toolTips.length!==0&&(this._tentativeRating>0?this._toolTips[this._tentativeRating-1].close():this._tentativeRating===0&&this._clearElement!==null&&(this._toolTips[this._maxRating].close(),this._elements[0].removeChild(this._clearElement),this._clearElement=null))},_clearTooltips:function(){if(this._toolTips&&this._toolTips.length!==0)for(var n=0;n<this._maxRating;n++)this._toolTips[n].innerHTML=null},_appendClass:function(n){for(var t=0;t<=this._maxRating;t++)e.addClass(this._elements[t],n)},_setClasses:function(n,t,i){for(var r=0;r<this._maxRating;r++)this._elements[r].className=r<t?n:i},_ensureAverageMSStarRating:function(){e.data(this._averageRatingElement).msStarRating=Math.ceil(this._averageRating)},_updateControl:function(){var t,i;if(this._controlUpdateNeeded){if(this._averageRating!==0&&this._userRating===0&&this._averageRating>=1&&this._averageRating<=this._maxRating)for(this._setClasses(y,this._averageRating-1,et),this._averageRatingElement.className=y,t=0;t<this._maxRating;t++)t<this._averageRating&&t+1>=this._averageRating&&(this._resetNextElement(!1),this._element.insertBefore(this._averageRatingElement,this._elements[t]),this._floatingValue=this._averageRating-t,i=n.getComputedStyle(this._elements[t]),this._elementWidth=i.width,n.getComputedStyle(this._element).direction==="rtl"?(this._elementPadding=i.paddingRight,this._elementBorder=i.borderRight):(this._elementPadding=i.paddingLeft,this._elementBorder=i.borderLeft),this._updateAverageStar());this._userRating!==0&&this._userRating>=1&&this._userRating<=this._maxRating&&(this._setClasses(ot,this._userRating,g),this._resetAverageStar(!1));this._userRating===0&&this._averageRating===0&&(this._setClasses(ft,this._maxRating),this._resetAverageStar(!1));this.disabled&&this._appendClass(st);this._averageRating!==0&&this._userRating===0?this._appendClass(ht):this._appendClass(ct);this._updateAccessibilityRestState()}}})})})}),t("require-style!less/styles-toggleswitch",[],function(){}),t("require-style!less/colors-toggleswitch",[],function(){}),t("WinJS/Controls/ToggleSwitch",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_Events","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementUtilities","require-style!less/styles-toggleswitch","require-style!less/colors-toggleswitch"],function(n,t,i,r,u,f,e){"use strict";t.Namespace.define("WinJS.UI",{ToggleSwitch:t.Namespace._lazy(function(){var p="win-toggleswitch",w="win-toggleswitch-header",b="win-toggleswitch-clickregion",k="win-toggleswitch-track",d="win-toggleswitch-thumb",g="win-toggleswitch-values",i="win-toggleswitch-value",nt="win-toggleswitch-value-on",tt="win-toggleswitch-value-off",it="win-toggleswitch-description",o="win-toggleswitch-on",s="win-toggleswitch-off",h="win-toggleswitch-disabled",c="win-toggleswitch-enabled",l="win-toggleswitch-dragging",a="win-toggleswitch-pressed",v={get on(){return u._getWinJSString("ui/on").value},get off(){return u._getWinJSString("ui/off").value}},y=t.Class.define(function(t,r){t=t||n.document.createElement("div");this._domElement=t;e.addClass(this._domElement,p);this._domElement.innerHTML=['<div class="'+w+'"><\/div>','<div class="'+b+'">','   <div class="'+k+'">','       <div class="'+d+'"><\/div>',"   <\/div>",'   <div class="'+g+'">','      <div class="'+i+" "+nt+'"><\/div>','      <div class="'+i+" "+tt+'"><\/div>',"   <\/div>","<\/div>",'<div class="'+it+'"><\/div>'].join("\n");this._headerElement=this._domElement.firstElementChild;this._clickElement=this._headerElement.nextElementSibling;this._trackElement=this._clickElement.firstElementChild;this._thumbElement=this._trackElement.firstElementChild;this._labelsElement=this._trackElement.nextElementSibling;this._labelOnElement=this._labelsElement.firstElementChild;this._labelOffElement=this._labelOnElement.nextElementSibling;this._descriptionElement=this._clickElement.nextElementSibling;this._headerElement.setAttribute("aria-hidden",!0);this._labelsElement.setAttribute("aria-hidden",!0);this._headerElement.setAttribute("id",e._uniqueID(this._headerElement));this._domElement.setAttribute("aria-labelledby",this._headerElement.id);this._domElement.setAttribute("role","checkbox");this._domElement.winControl=this;e.addClass(this._domElement,"win-disposable");this._domElement.addEventListener("keydown",this._keyDownHandler.bind(this));e._addEventListener(this._clickElement,"pointerdown",this._pointerDownHandler.bind(this));e._addEventListener(this._clickElement,"pointercancel",this._pointerCancelHandler.bind(this));this._boundPointerMove=this._pointerMoveHandler.bind(this);this._boundPointerUp=this._pointerUpHandler.bind(this);this._mutationObserver=new e._MutationObserver(this._ariaChangedHandler.bind(this));this._mutationObserver.observe(this._domElement,{attributes:!0,attributeFilter:["aria-checked"]});this._dragX=0;this._dragging=!1;this.checked=!1;this.disabled=!1;this.labelOn=v.on;this.labelOff=v.off;f.setOptions(this,r)},{element:{get:function(){return this._domElement}},checked:{get:function(){return this._checked},set:function(n){(n=!!n,n!==this.checked)&&(this._checked=n,this._domElement.setAttribute("aria-checked",n),n?(e.addClass(this._domElement,o),e.removeClass(this._domElement,s)):(e.addClass(this._domElement,s),e.removeClass(this._domElement,o)),this.dispatchEvent("change"))}},disabled:{get:function(){return this._disabled},set:function(n){(n=!!n,n!==this._disabled)&&(n?(e.addClass(this._domElement,h),e.removeClass(this._domElement,c)):(e.removeClass(this._domElement,h),e.addClass(this._domElement,c)),this._disabled=n,this._domElement.setAttribute("aria-disabled",n),this._domElement.setAttribute("tabIndex",n?-1:0))}},labelOn:{get:function(){return this._labelOnElement.innerHTML},set:function(n){this._labelOnElement.innerHTML=n}},labelOff:{get:function(){return this._labelOffElement.innerHTML},set:function(n){this._labelOffElement.innerHTML=n}},title:{get:function(){return this._headerElement.innerHTML},set:function(n){this._headerElement.innerHTML=n}},onchange:r._createEventProperty("change"),dispose:function(){this._disposed||(this._disposed=!0)},_ariaChangedHandler:function(){var n=this._domElement.getAttribute("aria-checked");n=n==="true"?!0:!1;this.checked=n},_keyDownHandler:function(n){this.disabled||(n.keyCode===e.Key.space&&(n.preventDefault(),this.checked=!this.checked),(n.keyCode===e.Key.rightArrow||n.keyCode===e.Key.upArrow)&&(n.preventDefault(),this.checked=!0),(n.keyCode===e.Key.leftArrow||n.keyCode===e.Key.downArrow)&&(n.preventDefault(),this.checked=!1))},_pointerDownHandler:function(n){this.disabled||this._mousedown||(n.preventDefault(),this._mousedown=!0,this._dragXStart=n.pageX-this._trackElement.getBoundingClientRect().left,this._dragX=this._dragXStart,this._dragging=!1,e.addClass(this._domElement,a),e._globalListener.addEventListener(this._domElement,"pointermove",this._boundPointerMove,!0),e._globalListener.addEventListener(this._domElement,"pointerup",this._boundPointerUp,!0),n.pointerType===e._MSPointerEvent.MSPOINTER_TYPE_TOUCH&&e._setPointerCapture(this._domElement,n.pointerId))},_pointerCancelHandler:function(n){this._resetPressedState();n.pointerType===e._MSPointerEvent.MSPOINTER_TYPE_TOUCH&&e._releasePointerCapture(this._domElement,n.pointerId)},_pointerUpHandler:function(t){var i;if(!this.disabled&&this._mousedown){t=t.detail.originalEvent;t.preventDefault();var r=this._trackElement.getBoundingClientRect(),u=this._thumbElement.getBoundingClientRect(),f=n.getComputedStyle(this._domElement).direction==="rtl";this._dragging?(i=r.width-u.width,this.checked=f?this._dragX<i/2:this._dragX>=i/2,this._dragging=!1,e.removeClass(this._domElement,l)):this.checked=!this.checked;this._resetPressedState()}},_pointerMoveHandler:function(n){var t,i,r,u;this.disabled||this._mousedown&&((n=n.detail.originalEvent,n.preventDefault(),t=this._trackElement.getBoundingClientRect(),i=n.pageX-t.left,i>t.width)||(r=this._thumbElement.getBoundingClientRect(),u=t.width-r.width-6,this._dragX=Math.min(u,i-r.width/2),this._dragX=Math.max(2,this._dragX),!this._dragging&&Math.abs(i-this._dragXStart)>3&&(this._dragging=!0,e.addClass(this._domElement,l)),this._thumbElement.style.left=this._dragX+"px"))},_resetPressedState:function(){this._mousedown=!1;this._thumbElement.style.left="";e.removeClass(this._domElement,a);e._globalListener.removeEventListener(this._domElement,"pointermove",this._boundPointerMove,!0);e._globalListener.removeEventListener(this._domElement,"pointerup",this._boundPointerUp,!0)}});return t.Class.mix(y,f.DOMEventMixin),y})})}),t("require-style!less/styles-semanticzoom",[],function(){}),t("require-style!less/colors-semanticzoom",[],function(){}),t("WinJS/Controls/SemanticZoom",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Animations/_TransitionAnimation","../ControlProcessor","../Promise","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_ElementListUtilities","../Utilities/_Hoverable","require-style!less/styles-semanticzoom","require-style!less/colors-semanticzoom"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";t.Namespace.define("WinJS.UI",{SemanticZoom:t.Namespace._lazy(function(){function ft(n){return n}function d(n,t,i){return n+" "+s._animationTimeAdjustment(t)+"s "+i+" "+s._libraryDelay+"ms"}function yt(){return d(w.cssName,si,"ease-in-out")+", "+d("opacity",lt,"ease-in-out")}function pt(){return d(w.cssName,hi,"ease-in-out")+", "+d("opacity",oi,"ease-in-out")}function vi(){return d(w.cssName,li,vt)}function yi(){return d(w.cssName,ai,vt)}function k(n,t){return v.convertToPixels(n,t)}function g(n,t){s.isAnimationEnabled()&&(n.style[w.scriptName]="scale("+t+")")}function tt(n){var t=n.target&&n.target.winControl;t&&!t._resizing&&t._onResize()}function di(n){var t=n[0].target&&n[0].target.winControl;t&&t instanceof it&&t._onPropertyChanged()}var b=i._browserStyleEquivalents,gt={get invalidZoomFactor(){return"Invalid zoomFactor"}},ni="win-semanticzoom-button",ti="win-semanticzoom-button-location",ii=3e3,et=8,ri="win-semanticzoom",ui="win-semanticzoom-zoomedinview",fi="win-semanticzoom-zoomedoutview",ei="zoomchanged",nt=1.05,ot=.65,st=.8,ht=.2,ct=4096,lt=.333,oi=.333,si=.333,hi=.333,at=lt*1e3,ci=50,li=.333,ai=.333,vt="cubic-bezier(0.1,0.9,0.2,1)",w=b.transform,rt=b.transition.scriptName,wt=2,pi=.2,wi=.45,bi=1e3,bt=50,f={none:0,zoomedIn:1,zoomedOut:2},ut=v._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",kt=v._MSPointerEvent.MSPOINTER_TYPE_PEN||"pen",ki=v._MSPointerEvent.MSPOINTER_TYPE_MOUSE||"mouse",dt={x:0,y:0},it=t.Class.define(function(t,u){var o,f,s,e;if(this._disposed=!1,o=this,f=i.isPhone,this._element=t,this._element.winControl=this,v.addClass(this._element,"win-disposable"),v.addClass(this._element,ri),this._element.setAttribute("role","ms-semanticzoomcontainer"),s=this._element.getAttribute("aria-label"),s||this._element.setAttribute("aria-label",""),u=u||{},this._zoomedOut=!!u.zoomedOut||!!u.initiallyZoomedOut||!1,this._enableButton=!f,f||u.enableButton===undefined||(this._enableButton=!!u.enableButton),this._element.setAttribute("aria-checked",this._zoomedOut.toString()),this._zoomFactor=v._clamp(u.zoomFactor,ht,st,ot),this.zoomedInItem=u.zoomedInItem,this.zoomedOutItem=u.zoomedOutItem,i.validation&&u._zoomFactor&&u._zoomFactor!==this._zoomFactor)throw new r("WinJS.UI.SemanticZoom.InvalidZoomFactor",gt.invalidZoomFactor);this._locked=!!u.locked;this._zoomInProgress=!1;this._isBouncingIn=!1;this._isBouncing=!1;this._zooming=!1;this._aligning=!1;this._gesturing=!1;this._gestureEnding=!1;this._buttonShown=!1;this._shouldFakeTouchCancel="TouchEvent"in n;this._initialize();this._configure();e=n.document.body.contains(this._element);v._addInsertedNotifier(this._element);this._element.addEventListener("WinJSNodeInserted",function(n){if(e){e=!1;return}tt(n)},!1);this._element.addEventListener("mselementresize",tt);v._resizeNotifier.subscribe(this._element,tt);new v._MutationObserver(di).observe(this._element,{attributes:!0,attributeFilter:["aria-checked"]});f||(this._element.addEventListener("wheel",this._onWheel.bind(this),!0),this._element.addEventListener("mousewheel",this._onMouseWheel.bind(this),!0),this._element.addEventListener("keydown",this._onKeyDown.bind(this),!0),v._addEventListener(this._element,"pointerdown",this._onPointerDown.bind(this),!0),v._addEventListener(this._element,"pointermove",this._onPointerMove.bind(this),!0),v._addEventListener(this._element,"pointerout",this._onPointerOut.bind(this),!0),v._addEventListener(this._element,"pointercancel",this._onPointerCancel.bind(this),!0),v._addEventListener(this._element,"pointerup",this._onPointerUp.bind(this),!1),this._hiddenElement.addEventListener("gotpointercapture",this._onGotPointerCapture.bind(this),!1),this._hiddenElement.addEventListener("lostpointercapture",this._onLostPointerCapture.bind(this),!1),this._element.addEventListener("click",this._onClick.bind(this),!0),this._canvasIn.addEventListener(i._browserEventEquivalents.transitionEnd,this._onCanvasTransitionEnd.bind(this),!1),this._canvasOut.addEventListener(i._browserEventEquivalents.transitionEnd,this._onCanvasTransitionEnd.bind(this),!1),this._element.addEventListener("MSContentZoom",this._onMSContentZoom.bind(this),!0),this._resetPointerRecords());this._onResizeImpl();l._setOptions(this,u,!0);o._setVisibility()},{element:{get:function(){return this._element}},enableButton:{get:function(){return this._enableButton},set:function(n){var t=!!n;this._enableButton===t||i.isPhone||(this._enableButton=t,t?this._createSemanticZoomButton():this._removeSemanticZoomButton())}},zoomedOut:{get:function(){return this._zoomedOut},set:function(n){this._zoom(!!n,{x:.5*this._sezoClientWidth,y:.5*this._sezoClientHeight},!1,!1,this._zoomedOut&&i.isPhone)}},zoomFactor:{get:function(){return this._zoomFactor},set:function(n){var i=this._zoomFactor,t=v._clamp(n,ht,st,ot);i!==t&&(this._zoomFactor=t,this._onResize())}},locked:{get:function(){return this._locked},set:function(n){this._locked=!!n;n?this._hideSemanticZoomButton():this._displayButton()}},zoomedInItem:{get:function(){return this._zoomedInItem},set:function(n){this._zoomedInItem=n||ft}},zoomedOutItem:{get:function(){return this._zoomedOutItem},set:function(n){this._zoomedOutItem=n||ft}},dispose:function(){this._disposed||(this._disposed=!0,v._resizeNotifier.unsubscribe(this._element,tt),a._disposeElement(this._elementIn),a._disposeElement(this._elementOut),this._clearTimeout(this._completeZoomTimer),this._clearTimeout(this._TTFFTimer))},forceLayout:function(){this._onResizeImpl()},_initialize:function(){var t=y.children(this._element);this._elementIn=t[0];this._elementOut=t[1];this._elementIn.style.height=this._elementOut.style.height=this._element.offsetHeight+"px";h.processAll(this._elementIn);h.processAll(this._elementOut);this._viewIn=this._elementIn.winControl.zoomableView;this._viewOut=this._elementOut.winControl.zoomableView;this._element.removeChild(this._elementOut);this._element.removeChild(this._elementIn);this._element.innerHTML="";this._cropViewport=n.document.createElement("div");this._element.appendChild(this._cropViewport);this._viewportIn=n.document.createElement("div");this._opticalViewportIn=n.document.createElement("div");this._viewportOut=n.document.createElement("div");this._opticalViewportOut=n.document.createElement("div");this._opticalViewportIn.appendChild(this._viewportIn);this._opticalViewportOut.appendChild(this._viewportOut);this._cropViewport.appendChild(this._opticalViewportIn);this._cropViewport.appendChild(this._opticalViewportOut);this._canvasIn=n.document.createElement("div");this._canvasOut=n.document.createElement("div");this._viewportIn.appendChild(this._canvasIn);this._viewportOut.appendChild(this._canvasOut);this._canvasIn.appendChild(this._elementIn);this._canvasOut.appendChild(this._elementOut);this._enableButton&&this._createSemanticZoomButton();this._hiddenElement=n.document.createElement("div");this._hiddenElement.tabIndex=-1;this._hiddenElement.visibility="hidden";this._hiddenElement.setAttribute("aria-hidden","true");this._element.appendChild(this._hiddenElement);v.addClass(this._elementIn,ui);v.addClass(this._elementOut,fi);this._setLayout(this._element,"relative","hidden");this._setLayout(this._cropViewport,"absolute","hidden");this._setLayout(this._opticalViewportIn,"absolute","auto");this._setLayout(this._opticalViewportOut,"absolute","auto");this._setLayout(this._viewportIn,"absolute","hidden");this._setLayout(this._viewportOut,"absolute","hidden");this._setLayout(this._canvasIn,"absolute","hidden");this._setLayout(this._canvasOut,"absolute","hidden");this._setupOpticalViewport(this._opticalViewportIn);this._setupOpticalViewport(this._opticalViewportOut);this._viewportIn.style["-ms-overflow-style"]="-ms-autohiding-scrollbar";this._viewportOut.style["-ms-overflow-style"]="-ms-autohiding-scrollbar";this._elementIn.style.position="absolute";this._elementOut.style.position="absolute"},_createSemanticZoomButton:function(){this._sezoButton=n.document.createElement("button");this._sezoButton.setAttribute("type","button");this._sezoButton.className=ni+" "+ti;this._sezoButton.tabIndex=-1;this._sezoButton.style.visibility="hidden";this._sezoButton.setAttribute("aria-hidden",!0);this._element.appendChild(this._sezoButton);this._sezoButton.addEventListener("click",this._onSeZoButtonZoomOutClick.bind(this),!1);this._element.addEventListener("scroll",this._onSeZoChildrenScroll.bind(this),!0);v._addEventListener(this._element,"pointermove",this._onPenHover.bind(this),!1)},_removeSemanticZoomButton:function(){this._sezoButton&&(this._element.removeChild(this._sezoButton),this._sezoButton=null)},_configure:function(){var n=this._viewIn.getPanAxis(),t=this._viewOut.getPanAxis(),r=i.isPhone,e,o;if(this._pansHorizontallyIn=n==="horizontal"||n==="both",this._pansVerticallyIn=n==="vertical"||n==="both",this._pansHorizontallyOut=t==="horizontal"||t==="both",this._pansVerticallyOut=t==="vertical"||t==="both",!this._zoomInProgress){e=1/this._zoomFactor-1;o=nt-1;this._setLayout(this._elementIn,"absolute","visible");this._setLayout(this._elementOut,"absolute","visible");this._viewIn.configureForZoom(!1,!this._zoomedOut,this._zoomFromCurrent.bind(this,!0),e);this._viewOut.configureForZoom(!0,this._zoomedOut,this._zoomFromCurrent.bind(this,!1),o);this._pinching=!1;this._pinchGesture=0;this._canvasLeftIn=0;this._canvasTopIn=0;this._canvasLeftOut=0;this._canvasTopOut=0;r||(this._zoomedOut?g(this._canvasIn,this._zoomFactor):g(this._canvasOut,1/this._zoomFactor));var u=this._opticalViewportIn.style,f=this._opticalViewportOut.style,h=this._canvasIn.style,c=this._canvasOut.style;h.opacity=this._zoomedOut&&!r?0:1;c.opacity=this._zoomedOut?1:0;r&&(h.zIndex=1,c.zIndex=2);s.isAnimationEnabled()&&!r&&(u[b["transition-property"].scriptName]=w.cssName,u[b["transition-duration"].scriptName]="0s",u[b["transition-timing-function"].scriptName]="linear",f[b["transition-property"].scriptName]=w.cssName,f[b["transition-duration"].scriptName]="0s",f[b["transition-timing-function"].scriptName]="linear")}},_onPropertyChanged:function(){var t=this._element.getAttribute("aria-checked"),n=t==="true";this._zoomedOut!==n&&(this.zoomedOut=n)},_onResizeImpl:function(){this._resizing=this._resizing||0;this._resizing++;try{var r=function(n,t,i,r,u){var f=n.style;f.left=t+"px";f.top=i+"px";f.width=r+"px";f.height=u+"px"},u=n.getComputedStyle(this._element,null),f=parseFloat(u.width),e=parseFloat(u.height),o=k(this._element,u.paddingLeft),p=k(this._element,u.paddingRight),s=k(this._element,u.paddingTop),w=k(this._element,u.paddingBottom),t=f-o-p,i=e-s-w,b=1/this._zoomFactor;if(this._viewportWidth===t&&this._viewportHeight===i)return;this._sezoClientHeight=e;this._sezoClientWidth=f;this._viewportWidth=t;this._viewportHeight=i;this._configure();var h=2*b-1,c=Math.min(ct,(this._pansHorizontallyIn?h:1)*t),l=Math.min(ct,(this._pansVerticallyIn?h:1)*i);this._canvasLeftIn=.5*(c-t);this._canvasTopIn=.5*(l-i);r(this._cropViewport,o,s,t,i);r(this._viewportIn,0,0,t,i);r(this._opticalViewportIn,0,0,t,i);r(this._canvasIn,-this._canvasLeftIn,-this._canvasTopIn,c,l);r(this._elementIn,this._canvasLeftIn,this._canvasTopIn,t,i);var a=2*nt-1,v=(this._pansHorizontallyOut?a:1)*t,y=(this._pansVerticallyOut?a:1)*i;this._canvasLeftOut=.5*(v-t);this._canvasTopOut=.5*(y-i);r(this._viewportOut,0,0,t,i);r(this._opticalViewportOut,0,0,t,i);r(this._canvasOut,-this._canvasLeftOut,-this._canvasTopOut,v,y);r(this._elementOut,this._canvasLeftOut,this._canvasTopOut,t,i)}finally{this._resizing--}},_onResize:function(){this._onResizeImpl()},_onMouseMove:function(n){if(this._zooming||!this._lastMouseX&&!this._lastMouseY||n.screenX===this._lastMouseX&&n.screenY===this._lastMouseY){this._lastMouseX=n.screenX;this._lastMouseY=n.screenY;return}Math.abs(n.screenX-this._lastMouseX)<=et&&Math.abs(n.screenY-this._lastMouseY)<=et||(this._lastMouseX=n.screenX,this._lastMouseY=n.screenY,this._displayButton())},_displayButton:function(){if(p.isHoverable){n.clearTimeout(this._dismissButtonTimer);this._showSemanticZoomButton();var t=this;this._dismissButtonTimer=n.setTimeout(function(){t._hideSemanticZoomButton()},s._animationTimeAdjustment(ii))}},_showSemanticZoomButton:function(){this._disposed||this._buttonShown||!this._sezoButton||this._zoomedOut||this._locked||(o.fadeIn(this._sezoButton),this._sezoButton.style.visibility="visible",this._buttonShown=!0)},_hideSemanticZoomButton:function(n){if(!this._disposed&&this._buttonShown&&this._sezoButton){if(n)this._sezoButton.style.visibility="hidden";else{var t=this;o.fadeOut(this._sezoButton).then(function(){t._sezoButton.style.visibility="hidden"})}this._buttonShown=!1}},_onSeZoChildrenScroll:function(n){n.target!==this.element&&this._hideSemanticZoomButton(!0)},_onWheel:function(n){n.ctrlKey&&(this._zoom(n.deltaY>0,this._getPointerLocation(n)),n.stopPropagation(),n.preventDefault())},_onMouseWheel:function(n){n.ctrlKey&&(this._zoom(n.wheelDelta<0,this._getPointerLocation(n)),n.stopPropagation(),n.preventDefault())},_onPenHover:function(n){n.pointerType===kt&&n.buttons===0&&this._displayButton()},_onSeZoButtonZoomOutClick:function(){this._hideSemanticZoomButton();this._zoom(!0,{x:.5*this._sezoClientWidth,y:.5*this._sezoClientHeight},!1)},_onKeyDown:function(n){var i=!1,t;if(n.ctrlKey){t=v.Key;switch(n.keyCode){case t.add:case t.equal:case 61:this._zoom(!1);i=!0;break;case t.subtract:case t.dash:case 173:this._zoom(!0);i=!0}}i&&(n.stopPropagation(),n.preventDefault())},_createPointerRecord:function(n,t){var r=this._getPointerLocation(n),i={};return i.startX=i.currentX=r.x,i.startY=i.currentY=r.y,i.fireCancelOnPinch=t,this._pointerRecords[n.pointerId]=i,this._pointerCount=Object.keys(this._pointerRecords).length,i},_deletePointerRecord:function(n){var t=this._pointerRecords[n];return delete this._pointerRecords[n],this._pointerCount=Object.keys(this._pointerRecords).length,this._pointerCount!==2&&(this._pinching=!1),t},_fakeCancelOnPointer:function(t){var i=n.document.createEvent("UIEvent");i.initUIEvent("touchcancel",!0,!0,n,0);i.touches=t.touches;i.targetTouches=t.targetTouches;i.changedTouches=[t._currentTouch];i._fakedBySemanticZoom=!0;t.target.dispatchEvent(i)},_handlePointerDown:function(n){var i,t,r;for(this._createPointerRecord(n,!1),i=Object.keys(this._pointerRecords),t=0,r=i.length;t<r;t++)try{v._setPointerCapture(this._hiddenElement,i[t]||0)}catch(u){this._resetPointerRecords();return}n.stopImmediatePropagation();n.preventDefault()},_handleFirstPointerDown:function(n){this._resetPointerRecords();this._createPointerRecord(n,this._shouldFakeTouchCancel);this._startedZoomedOut=this._zoomedOut},_onClick:function(n){n.target!==this._element&&this._isBouncing&&n.stopImmediatePropagation()},_onPointerDown:function(n){n.pointerType===ut&&(this._pointerCount===0?this._handleFirstPointerDown(n):this._handlePointerDown(n))},_onPointerMove:function(n){function c(n,t,i,r){return Math.sqrt((i-n)*(i-n)+(r-t)*(r-t))}function o(n,t){return{x:.5*(n.currentX+t.currentX)|0,y:.5*(n.currentY+t.currentY)|0}}var i,s;if(n.pointerType===ki||n.pointerType===kt){this._onMouseMove(n);return}if(n.pointerType===ut&&(i=this._pointerRecords[n.pointerId],s=this._getPointerLocation(n),i)){if(i.currentX=s.x,i.currentY=s.y,this._pointerCount===2){this._pinching=!0;var h=Object.keys(this._pointerRecords),r=this._pointerRecords[h[0]],u=this._pointerRecords[h[1]];this._currentMidPoint=o(r,u);var l=c(r.currentX,r.currentY,u.currentX,u.currentY),t=this,a=function(n){var i=n?f.zoomedOut:f.zoomedIn,h=n?t._pinchedDirection===f.zoomedIn&&!t._zoomingOut:t._pinchedDirection===f.zoomedOut&&t._zoomingOut,c=n?!t._zoomedOut:t._zoomedOut,e,s;t._pinchedDirection===f.none?c?(t._isBouncingIn=!1,t._zoom(n,o(r,u),!0),t._pinchedDirection=i):t._isBouncingIn||t._playBounce(!0,o(r,u)):h&&(e=t._lastPinchDistance/t._lastPinchStartDistance,s=t._lastLastPinchDistance/t._lastPinchDistance,(n&&e>pi||!n&&s>wi)&&(t._zoom(n,o(r,u),!0),t._pinchedDirection=i))};this._updatePinchDistanceRecords(l);this._pinchDistanceCount>=wt&&(this._zooming||this._isBouncing||(e("WinJS.UI.SemanticZoom:EndPinchDetection,info"),a(this._lastPinchDirection===f.zoomedOut)))}else this._pointerCount>2&&this._resetPinchDistanceRecords();this._pointerCount>=2&&(i.fireCancelOnPinch&&(this._fakeCancelOnPointer(n,i),i.fireCancelOnPinch=!1),n.stopImmediatePropagation(),n.preventDefault());this._pointerCount!==2&&this._isBouncingIn&&this._playBounce(!1)}},_onPointerOut:function(n){n.pointerType===ut&&n.target===this._element&&this._completePointerUp(n,!1)},_onPointerUp:function(n){this._releasePointerCapture(n);this._completePointerUp(n,!0);this._completeZoomingIfTimeout()},_onPointerCancel:function(n){n._fakedBySemanticZoom||(this._releasePointerCapture(n),this._completePointerUp(n,!1),this._completeZoomingIfTimeout())},_onGotPointerCapture:function(n){var t=this._pointerRecords[n.pointerId];t&&(t.dirty=!1)},_onLostPointerCapture:function(n){var t=this._pointerRecords[n.pointerId],i;t&&(t.dirty=!0,i=this,c.timeout(bt).then(function(){t.dirty&&i._completePointerUp(n,!1)}))},_onMSContentZoom:function(n){var t=n.target,i,r;(t===this._opticalViewportIn||t===this._opticalViewportOut)&&(i=t.msContentZoomFactor<.995,r=t.msContentZoomFactor>1.005,!i||this._zoomedOut||this._zoomingOut?r&&(this._zoomedOut||this._zoomingOut)&&(this.zoomedOut=!1):this.zoomedOut=!0)},_updatePinchDistanceRecords:function(n){function i(i){t._lastPinchDirection===i?t._pinchDistanceCount++:(t._pinchGesture++,t._pinchDistanceCount=0,t._lastPinchStartDistance=n);t._lastPinchDirection=i;t._lastPinchDistance=n;t._lastLastPinchDistance=t._lastPinchDistance}var t=this;this._lastPinchDistance===-1?(e("WinJS.UI.SemanticZoom:StartPinchDetection,info"),this._lastPinchDistance=n):this._lastPinchDistance!==n&&(this._lastPinchDistance>n?i(f.zoomedOut):i(f.zoomedIn))},_zoomFromCurrent:function(n){this._zoom(n,null,!1,!0)},_zoom:function(n,t,r,u,f){var o;if(e("WinJS.UI.SemanticZoom:StartZoom(zoomOut="+n+"),info"),this._clearTimeout(this._completeZoomTimer),this._clearTimeout(this._TTFFTimer),this._hideSemanticZoomButton(),this._resetPinchDistanceRecords(),!this._locked&&!this._gestureEnding)if(this._zoomInProgress){if(this._gesturing===!r)return;n!==this._zoomingOut&&this._startAnimations(n)}else if(n!==this._zoomedOut){this._zooming=!0;this._aligning=!0;this._gesturing=!!r;t&&(n?this._viewIn:this._viewOut).setCurrentItem(t.x,t.y);this._zoomInProgress=!0;(n?this._opticalViewportOut:this._opticalViewportIn).style.visibility="visible";n&&i.isPhone&&(this._canvasOut.style.opacity=1);var h=this._viewIn.beginZoom(),l=this._viewOut.beginZoom(),s=null;(h||l)&&i.isPhone&&(s=c.join([h,l]));u&&!f?(o=this,(n?this._viewIn:this._viewOut).getCurrentItem().then(function(t){var i=t.position;o._prepareForZoom(n,{x:o._rtl()?o._sezoClientWidth-i.left-.5*i.width:i.left+.5*i.width,y:i.top+.5*i.height},c.wrap(t),s)})):this._prepareForZoom(n,t||{},null,s,f)}},_prepareForZoom:function(t,i,r,u,f){function c(n,t){o._canvasIn.style[b["transform-origin"].scriptName]=o._canvasLeftIn+s-n.x+"px "+(o._canvasTopIn+h-n.y)+"px";o._canvasOut.style[b["transform-origin"].scriptName]=o._canvasLeftOut+s-t.x+"px "+(o._canvasTopOut+h-t.y)+"px"}e("WinJS.UI.SemanticZoom:prepareForZoom,StartTM");var o=this,s=i.x,h=i.y;typeof s=="number"&&this._pansHorizontallyIn&&this._pansHorizontallyOut||(s=.5*this._sezoClientWidth);typeof h=="number"&&this._pansVerticallyIn&&this._pansVerticallyOut||(h=.5*this._sezoClientHeight);c(dt,dt);f?this._aligning=!1:this._alignViewsPromise=this._alignViews(t,s,h,r).then(function(){o._aligning=!1;o._gestureEnding=!1;o._alignViewsPromise=null;o._zooming||o._gesturing||o._completeZoom()});this._zoomingOut=t;n.getComputedStyle(this._canvasIn).opacity;n.getComputedStyle(this._canvasOut).opacity;e("WinJS.UI.SemanticZoom:prepareForZoom,StopTM");this._startAnimations(t,u)},_alignViews:function(n,t,i,r){var o=1-this._zoomFactor,l=this._rtl(),s=o*(l?this._viewportWidth-t:t),h=o*i,u=this,f,e;if(n){if(f=r||this._viewIn.getCurrentItem(),f)return f.then(function(n){var t=n.position,i={left:t.left*u._zoomFactor+s,top:t.top*u._zoomFactor+h,width:t.width*u._zoomFactor,height:t.height*u._zoomFactor};return u._viewOut.positionItem(u._zoomedOutItem(n.item),i)})}else if(e=r||this._viewOut.getCurrentItem(),e)return e.then(function(n){var t=n.position,i={left:(t.left-s)/u._zoomFactor,top:(t.top-h)/u._zoomFactor,width:t.width/u._zoomFactor,height:t.height/u._zoomFactor};return u._viewIn.positionItem(u._zoomedInItem(n.item),i)});return new c(function(n){n({x:0,y:0})})},_startAnimations:function(n,t){var r,u,f;this._zoomingOut=n;r=i.isPhone;s.isAnimationEnabled()&&!r&&(e("WinJS.UI.SemanticZoom:ZoomAnimation,StartTM"),this._canvasIn.style[rt]=n?yt():pt(),this._canvasOut.style[rt]=n?pt():yt());r||(g(this._canvasIn,n?this._zoomFactor:1),g(this._canvasOut,n?1:1/this._zoomFactor));this._canvasIn.style.opacity=n&&!r?0:1;(!r||n)&&(this._canvasOut.style.opacity=n?1:0);s.isAnimationEnabled()?t?(u=this,f=function(){u._canvasIn.style[w.scriptName]="";u._canvasOut.style[w.scriptName]="";u._onZoomAnimationComplete()},t.then(f,f)):this.setTimeoutAfterTTFF(this._onZoomAnimationComplete.bind(this),s._animationTimeAdjustment(at)):(this._zooming=!1,this._canvasIn.style[w.scriptName]="",this._canvasOut.style[w.scriptName]="",this._completeZoom())},_onBounceAnimationComplete:function(){this._isBouncingIn||this._disposed||this._completeZoom()},_onZoomAnimationComplete:function(){(e("WinJS.UI.SemanticZoom:ZoomAnimation,StopTM"),this._disposed)||(this._zooming=!1,this._aligning||this._gesturing||this._gestureEnding||this._completeZoom())},_onCanvasTransitionEnd:function(n){if(!this._disposed){if((n.target===this._canvasOut||n.target===this._canvasIn)&&this._isBouncing){this._onBounceAnimationComplete();return}n.target===this._canvasIn&&n.propertyName===w.cssName&&this._onZoomAnimationComplete()}},_clearTimeout:function(t){t&&n.clearTimeout(t)},_completePointerUp:function(n,t){if(!this._disposed){var i=n.pointerId,r=this._pointerRecords[i];if(r&&(this._deletePointerRecord(i),this._isBouncingIn&&this._playBounce(!1),t&&this._pinchedDirection!==f.none&&n.stopImmediatePropagation(),this._pointerCount===0)){if(this._pinchGesture===1&&!this._zooming&&this._lastPinchDirection!==f.none&&this._pinchDistanceCount<wt){this._zoom(this._lastPinchDirection===f.zoomedOut,this._currentMidPoint,!1);this._pinchGesture=0;this._attemptRecordReset();return}this._pinchedDirection!==f.none&&(this._gesturing=!1,this._aligning||this._zooming||this._completeZoom());this._pinchGesture=0;this._attemptRecordReset()}}},setTimeoutAfterTTFF:function(t,i){var r=this;r._TTFFTimer=n.setTimeout(function(){this._disposed||(r._TTFFTimer=n.setTimeout(t,i))},ci)},_completeZoomingIfTimeout:function(){if(this._pointerCount===0){var t=this;(this._zoomInProgress||this._isBouncing)&&(t._completeZoomTimer=n.setTimeout(function(){t._completeZoom()},s._animationTimeAdjustment(bi)))}},_completeZoom:function(){var t,r;if(!this._disposed){if(this._isBouncing){this._zoomedOut?this._viewOut.endZoom(!0):this._viewIn.endZoom(!0);this._isBouncing=!1;return}this._zoomInProgress&&(e("WinJS.UI.SemanticZoom:CompleteZoom,info"),this._aligning=!1,this._alignViewsPromise&&this._alignViewsPromise.cancel(),this._clearTimeout(this._completeZoomTimer),this._clearTimeout(this._TTFFTimer),this._gestureEnding=!1,this[this._zoomingOut?"_opticalViewportOut":"_opticalViewportIn"].msContentZoomFactor=1,this._viewIn.endZoom(!this._zoomingOut),this._viewOut.endZoom(this._zoomingOut),this._canvasIn.style.opacity=this._zoomingOut&&!i.isPhone?0:1,this._canvasOut.style.opacity=this._zoomingOut?1:0,this._zoomInProgress=!1,t=!1,this._zoomingOut!==this._zoomedOut&&(this._zoomedOut=!!this._zoomingOut,this._element.setAttribute("aria-checked",this._zoomedOut.toString()),t=!0),this._setVisibility(),t&&(r=n.document.createEvent("CustomEvent"),r.initCustomEvent(ei,!0,!0,this._zoomedOut),this._element.dispatchEvent(r),this._isActive&&v._setActive(this._zoomedOut?this._elementOut:this._elementIn)),e("WinJS.UI.SemanticZoom:CompleteZoom_Custom,info"))}},_isActive:function(){var t=n.document.activeElement;return this._element===t||this._element.contains(t)},_setLayout:function(n,t,i){var r=n.style;r.position=t;r.overflow=i},_setupOpticalViewport:function(n){n.style["-ms-overflow-style"]="none";i.isPhone||(n.style["-ms-content-zooming"]="zoom",n.style["-ms-content-zoom-limit-min"]="99%",n.style["-ms-content-zoom-limit-max"]="101%",n.style["-ms-content-zoom-snap-points"]="snapList(100%)",n.style["-ms-content-zoom-snap-type"]="mandatory")},_setVisibility:function(){function n(n,t){n.style.visibility=t?"visible":"hidden"}n(this._opticalViewportIn,!this._zoomedOut||i.isPhone);n(this._opticalViewportOut,this._zoomedOut);this._opticalViewportIn.setAttribute("aria-hidden",!!this._zoomedOut);this._opticalViewportOut.setAttribute("aria-hidden",!this._zoomedOut)},_resetPointerRecords:function(){this._pinchedDirection=f.none;this._pointerCount=0;this._pointerRecords={};this._resetPinchDistanceRecords()},_releasePointerCapture:function(n){var t=n.pointerId;try{v._releasePointerCapture(this._hiddenElement,t)}catch(i){}},_attemptRecordReset:function(){this._recordResetPromise&&this._recordResetPromise.cancel();var n=this;this._recordResetPromise=c.timeout(bt).then(function(){n._pointerCount===0&&(n._resetPointerRecords(),n._recordResetPromise=null)})},_resetPinchDistanceRecords:function(){this._lastPinchDirection=f.none;this._lastPinchDistance=-1;this._lastLastPinchDistance=-1;this._pinchDistanceCount=0;this._currentMidPoint=null},_getPointerLocation:function(t){var i={left:0,top:0};try{i=this._element.getBoundingClientRect()}catch(o){}var r=n.getComputedStyle(this._element,null),f=k(this._element,r.paddingLeft),u=k(this._element,r.paddingTop),e=k(this._element,r.borderLeftWidth);return{x:+t.clientX===t.clientX?t.clientX-i.left-f-e:0,y:+t.clientY===t.clientY?t.clientY-i.top-u-u:0}},_playBounce:function(n,t){var r;if(s.isAnimationEnabled()&&this._isBouncingIn!==n){this._clearTimeout(this._completeZoomTimer);this._clearTimeout(this._TTFFTimer);this._isBouncing=!0;this._isBouncingIn=n;n?this._bounceCenter=t:this._aligned=!0;var i=this._zoomedOut?this._canvasOut:this._canvasIn,u=this._zoomedOut?this._canvasLeftOut:this._canvasLeftIn,f=this._zoomedOut?this._canvasTopOut:this._canvasTopIn;i.style[b["transform-origin"].scriptName]=u+this._bounceCenter.x+"px "+(f+this._bounceCenter.y)+"px";i.style[rt]=n?vi():yi();this._zoomedOut?this._viewOut.beginZoom():this._viewIn.beginZoom();r=n?this._zoomedOut?2-nt:nt:1;g(i,r);this.setTimeoutAfterTTFF(this._onBounceAnimationComplete.bind(this),s._animationTimeAdjustment(at))}},_rtl:function(){return n.getComputedStyle(this._element,null).direction==="rtl"},_pinching:{set:function(n){this._viewIn.pinching=n;this._viewOut.pinching=n}}});return t.Class.mix(it,u.createEventProperties("zoomchanged")),t.Class.mix(it,l.DOMEventMixin),it})})}),t("WinJS/Controls/Pivot/_Constants",[],function(){"use strict";return{_ClassName:{pivot:"win-pivot",pivotLocked:"win-pivot-locked",pivotTitle:"win-pivot-title",pivotHeaderArea:"win-pivot-header-area",pivotHeaderCustomContent:"win-pivot-header-customcontent",pivotHeaderCustomContentLeft:"win-pivot-header-customcontent-left",pivotHeaderCustomContentRight:"win-pivot-header-customcontent-right",pivotHeaderItems:"win-pivot-header-items",pivotHeaders:"win-pivot-headers",pivotHeader:"win-pivot-header",pivotHeaderSelected:"win-pivot-header-selected",pivotViewport:"win-pivot-viewport",pivotSurface:"win-pivot-surface",pivotNoSnap:"win-pivot-nosnap",pivotNavButton:"win-pivot-navbutton",pivotNavButtonPrev:"win-pivot-navbutton-prev",pivotNavButtonNext:"win-pivot-navbutton-next",pivotShowNavButtons:"win-pivot-shownavbuttons",pivotInputTypeMouse:"win-pivot-mouse",pivotInputTypeTouch:"win-pivot-touch",pivotDisableContentSwipeNavigation:"win-pivot-disablecontentswipenavigation"}}}),t("WinJS/Controls/Pivot/_Item",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Resources","../../ControlProcessor","../../Promise","../../Scheduler","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","./_Constants"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{PivotItem:i.Namespace._lazy(function(){var f={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},n=i.Class.define(function(i,r){var o,s;if(i=i||t.document.createElement("DIV"),r=r||{},i.winControl)throw new u("WinJS.UI.PivotItem.DuplicateConstruction",f.duplicateConstruction);for(i.winControl=this,this._element=i,l.addClass(this.element,n._ClassName.pivotItem),l.addClass(this.element,"win-disposable"),this._element.setAttribute("role","tabpanel"),this._contentElement=t.document.createElement("DIV"),this._contentElement.className=n._ClassName.pivotItemContent,i.appendChild(this._contentElement),o=this.element.firstChild;o!==this._contentElement;)s=o.nextSibling,this._contentElement.appendChild(o),o=s;this._processors=[e.processAll];h.setOptions(this,r)},{element:{get:function(){return this._element}},contentElement:{get:function(){return this._contentElement}},header:{get:function(){return this._header},set:function(n){this._header=n;this._parentPivot&&this._parentPivot._headersState.handleHeaderChanged(this)}},_parentPivot:{get:function(){for(var n=this._element;n&&!l.hasClass(n,a._ClassName.pivot);)n=n.parentNode;return n&&n.winControl}},_process:function(){var n=this;return this._processors&&this._processors.push(function(){return s.schedulePromiseAboveNormal()}),this._processed=(this._processors||[]).reduce(function(t,i){return t.then(function(){return i(n.contentElement)})},this._processed||o.as()),this._processors=null,this._processed},dispose:function(){this._disposed||(this._disposed=!0,this._processors=null,c.disposeSubTree(this.contentElement))}},{_ClassName:{pivotItem:"win-pivot-item",pivotItemContent:"win-pivot-item-content"},isDeclarativeControlContainer:r.markSupportedForProcessing(function(n,t){t!==e.processAll&&(n._processors=n._processors||[],n._processors.push(t),n._processed&&n._process())})});return n})})}),t("require-style!less/styles-pivot",[],function(){}),t("require-style!less/colors-pivot",[],function(){}),t("WinJS/Controls/Pivot",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Animations/_TransitionAnimation","../BindingList","../ControlProcessor","../Promise","../Scheduler","../_Signal","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_TabContainer","../Utilities/_KeyboardBehavior","./Pivot/_Constants","./Pivot/_Item","require-style!less/styles-pivot","require-style!less/colors-pivot"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";t.Namespace.define("WinJS.UI",{Pivot:t.Namespace._lazy(function(){function lt(t){return n.document.createTextNode(typeof t.header=="object"?JSON.stringify(t.header):""+t.header)}function et(){}var ct=b._MSPointerEvent.MSPOINTER_TYPE_MOUSE||"mouse",st=b._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",ot=b.Key,ht=u._createEventProperty,ft={selectionChanged:"selectionchanged",itemAnimationStart:"itemanimationstart",itemAnimationEnd:"itemanimationend"},it=b._MSManipulationEvent,rt=!!(b._supportsSnapPoints&&n.HTMLElement.prototype.msZoomTo),tt={nop:{exit:et,render:et,activateHeader:et,handleNavigation:et,handleResize:et,handleHeaderChanged:et},common:{headersContainerLeadingMargin:12,headerPadding:6,headerHorizontalMargin:12,getCumulativeHeaderWidth:function(n,t){var u,f,i;if(t===0)return 0;for(u=n._headersContainerElement.children.length,i=0;i<t;i++)f=tt.common.renderHeader(n,i,!1),n._headersContainerElement.appendChild(f);var r=0,o=n._rtl?n._headersContainerElement.lastElementChild:n._headersContainerElement.children[u],e=n._rtl?n._headersContainerElement.children[u]:n._headersContainerElement.lastElementChild;for(r=e.offsetLeft+e.offsetWidth-o.offsetLeft,r+=t*tt.common.headerPadding,r+=2*tt.common.headerHorizontalMargin,i=0;i<t;i++)n._headersContainerElement.removeChild(n._headersContainerElement.lastElementChild);return r},refreshHeadersState:function(n,t){t&&(this._cachedWidth=0);var i=this._cachedWidth||this.getCumulativeHeaderWidth(n,n.items.length);this._cachedWidth=i;i>n._headerItemsWidth&&!(n._headersState instanceof tt.overflowState)?(n._headersState.exit(),n._headersState=new tt.overflowState(n)):i<=n._headerItemsWidth&&!(n._headersState instanceof tt.staticState)&&(n._headersState.exit(),n._headersState=new tt.staticState(n))},renderHeader:function(t,i,r){function o(){t._disposed||t._headersContainerElement.contains(u)&&i!==t.selectedIndex&&u.getAttribute("aria-selected")==="true"&&(t.selectedIndex=i)}var e=b._syncRenderer(lt),f=t._items.getAt(i),u=n.document.createElement("BUTTON");return u.setAttribute("type","button"),u.style.marginLeft=u.style.marginRight=tt.common.headerHorizontalMargin+"px",b.addClass(u,k._ClassName.pivotHeader),u._item=f,u._pivotItemIndex=i,e(f,u),r&&(u.setAttribute("aria-selected",i===t.selectedIndex),u.setAttribute("role","tab"),new b._MutationObserver(o).observe(u,{attributes:!0,attributeFilter:["aria-selected"]})),u},freezeHeaderWidth:function(n){n.style.width="";n.style.width=n.offsetWidth+tt.common.headerPadding+"px"},updateHeader:function(n,t){var u=n.items.indexOf(t),i=n._headersContainerElement.children[u],r;i.innerHTML="";r=b._syncRenderer(lt);r(t,i);this.freezeHeaderWidth(i)},setActiveHeader:function(t,i){var r=!1;i&&(i.classList.remove(k._ClassName.pivotHeaderSelected),i.setAttribute("aria-selected",!1),r=n.document.activeElement===i);t.classList.add(k._ClassName.pivotHeaderSelected);t.setAttribute("aria-selected",!0);r&&t.focus()}},staticState:t.Class.define(function(n){var o,e,s,r,c;if(this.pivot=n,this._firstRender=!0,this._transitionAnimation=a.wrap(),n._headersContainerElement.children.length&&h.isAnimationEnabled()){var u=n._headersContainerElement.querySelector("."+k._ClassName.pivotHeaderSelected),t=0,f=0;for(n._rtl?(t=u.offsetLeft+u.offsetWidth+tt.common.headerHorizontalMargin,f=n._headerItemsWidth-tt.common.getCumulativeHeaderWidth(n,n.selectedIndex)-tt.common.headersContainerLeadingMargin+parseFloat(n._headersContainerElement.style.marginLeft)):(t=u.offsetLeft,t+=parseFloat(n._headersContainerElement.style.marginLeft),f=tt.common.getCumulativeHeaderWidth(n,n.selectedIndex)+tt.common.headersContainerLeadingMargin+tt.common.headerHorizontalMargin),o=t-f,this.render(),e=i._browserStyleEquivalents.transform.cssName,s="translateX("+o+"px)",r=0,c=n._headersContainerElement.children.length;r<c;r++)n._headersContainerElement.children[r].style[e]=s;this._transitionAnimation=h.executeTransition(n._headersContainerElement.querySelectorAll("."+k._ClassName.pivotHeader),{property:e,delay:0,duration:k._headerSlideAnimationDuration,timing:"ease-out",to:""})}},{exit:function(){this._transitionAnimation.cancel()},render:function(){var n=this.pivot,t,i;if(!n._pendingRefresh&&n._items){if(w._disposeElement(n._headersContainerElement),b.empty(n._headersContainerElement),n._rtl?(n._headersContainerElement.style.marginLeft="0px",n._headersContainerElement.style.marginRight=tt.common.headersContainerLeadingMargin+"px"):(n._headersContainerElement.style.marginLeft=tt.common.headersContainerLeadingMargin+"px",n._headersContainerElement.style.marginRight="0px"),n._viewportElement.style.overflow=n.items.length===1?"hidden":"",n.items.length){for(t=0;t<n.items.length;t++)i=tt.common.renderHeader(n,t,!0),n._headersContainerElement.appendChild(i),tt.common.freezeHeaderWidth(i),t===n.selectedIndex&&i.classList.add(k._ClassName.pivotHeaderSelected);n._tabContainer.childFocus=n._headersContainerElement.children[n.selectedIndex]}this._firstRender=!1}},activateHeader:function(n){var t=this.pivot._headersContainerElement.children[this.pivot.selectedIndex];tt.common.setActiveHeader(n,t);this.pivot._animateToPrevious=n._pivotItemIndex<this.pivot.selectedIndex;this.pivot.selectedIndex=n._pivotItemIndex},handleNavigation:function(n,t,i){this._firstRender&&this.render();tt.common.setActiveHeader(this.pivot._headersContainerElement.children[t],this.pivot._headersContainerElement.children[i]);this.pivot._tabContainer.childFocus=this.pivot._headersContainerElement.children[t]},handleResize:function(){tt.common.refreshHeadersState(this.pivot)},handleHeaderChanged:function(n){tt.common.updateHeader(this.pivot,n);tt.common.refreshHeadersState(this.pivot,!0)}}),overflowState:t.Class.define(function(n){var u,f,s,r,c;if(this.pivot=n,this._blocked=!1,this._firstRender=!0,this._transitionAnimation=a.wrap(),n._slideHeadersAnimation=a.wrap(),n._headersContainerElement.children.length&&h.isAnimationEnabled()){u=this;f=function(){u._blocked=!1;u.render()};this._blocked=!0;var e=n._headersContainerElement.querySelector("."+k._ClassName.pivotHeaderSelected),o=0,t=0;for(n._rtl?(o=n._headerItemsWidth-tt.common.headersContainerLeadingMargin,t=e.offsetLeft,t+=tt.common.headerHorizontalMargin,t+=e.offsetWidth,t+=parseFloat(n._headersContainerElement.style.marginLeft)):(o=tt.common.headersContainerLeadingMargin,t=e.offsetLeft,t-=tt.common.headerHorizontalMargin,t+=parseFloat(n._headersContainerElement.style.marginLeft)),s=o-t,r=0;r<n.selectedIndex;r++)n._headersContainerElement.appendChild(n._headersContainerElement.children[r].cloneNode(!0));c=i._browserStyleEquivalents.transform.cssName;this._transitionAnimation=h.executeTransition(n._headersContainerElement.querySelectorAll("."+k._ClassName.pivotHeader),{property:c,delay:0,duration:k._headerSlideAnimationDuration,timing:"ease-out",to:"translateX("+s+"px)"}).then(f,f)}},{exit:function(){this._transitionAnimation.cancel();this.pivot._slideHeadersAnimation.cancel()},render:function(t){var r=this.pivot,v,o,u,s,c,e,d,a;if(!this._blocked&&!r._pendingRefresh&&r._items){if(v=r._headersContainerElement.contains(n.document.activeElement),w._disposeElement(r._headersContainerElement),b.empty(r._headersContainerElement),r._items.length===1)u=tt.common.renderHeader(r,0,!0),u.classList.add(k._ClassName.pivotHeaderSelected),r._headersContainerElement.appendChild(u),tt.common.freezeHeaderWidth(u),r._viewportElement.style.overflow="hidden",r._headersContainerElement.style.marginLeft="0px",r._headersContainerElement.style.marginRight="0px";else if(r._items.length>1){var y=r._items.length+(t?2:1),p=r._headerItemsWidth*.8,f=r.selectedIndex-1;for(r._viewportElement.style.overflow&&(r._viewportElement.style.overflow=""),o=0;o<y;o++)f===-1?f=r._items.length-1:f===r._items.length&&(f=0),u=tt.common.renderHeader(r,f,!0),r._headersContainerElement.appendChild(u),u.offsetWidth>p?(u.style.textOverflow="ellipsis",u.style.width=p+"px"):tt.common.freezeHeaderWidth(u),f===r.selectedIndex&&u.classList.add(k._ClassName.pivotHeaderSelected),f++;r._firstLoad||this._firstRender||(t?(s="",c="0"):(s="0",c=""),e=r._headersContainerElement.children[y-1],e.style.opacity=s,d=.167,e.style[i._browserStyleEquivalents.transition.scriptName]="opacity "+h._animationTimeAdjustment(d)+"s",n.getComputedStyle(e).opacity,e.style.opacity=c);r._headersContainerElement.children[0].setAttribute("aria-hidden","true");r._headersContainerElement.style.marginLeft="0px";r._headersContainerElement.style.marginRight="0px";var nt=r._rtl?"marginRight":"marginLeft",g=r._headersContainerElement.children[0],l=b.getTotalWidth(g)-tt.common.headersContainerLeadingMargin;if(g!==r._headersContainerElement.children[0])return;r._headersContainerElement.style[nt]=-1*l+"px";r._prevButton=n.document.createElement("button");r._prevButton.setAttribute("type","button");b.addClass(r._prevButton,k._ClassName.pivotNavButton);b.addClass(r._prevButton,k._ClassName.pivotNavButtonPrev);r._prevButton.addEventListener("click",function(){r.locked||(r._rtl?r._goNext():r._goPrevious())});r._headersContainerElement.appendChild(r._prevButton);r._prevButton.style.left=r._rtl?"0px":l+"px";r._nextButton=n.document.createElement("button");r._nextButton.setAttribute("type","button");b.addClass(r._nextButton,k._ClassName.pivotNavButton);b.addClass(r._nextButton,k._ClassName.pivotNavButtonNext);r._nextButton.addEventListener("click",function(){r.locked||(r._rtl?r._goPrevious():r._goNext())});r._headersContainerElement.appendChild(r._nextButton);r._nextButton.style.right=r._rtl?l+"px":"0px"}a=r._headersContainerElement.children.length>1?1:0;r._tabContainer.childFocus=r._headersContainerElement.children[a];v&&r._headersContainerElement.children[a].focus();this._firstRender=!1}},activateHeader:function(n){n.previousSibling&&(this.pivot.selectedIndex=n._pivotItemIndex)},handleNavigation:function(n,t,r){function s(n){return e?n.offsetParent.offsetWidth-n.offsetLeft-n.offsetWidth:n.offsetLeft}function c(){u._disposed||(u._headersState.render(n),u._slideHeadersAnimation=a.wrap())}var u=this.pivot,f,e,o,l;if(this._blocked||t<0||u._firstLoad){this.render(n);return}if(n?f=u._headersContainerElement.children[0]:(t<r&&(t+=u._items.length),f=u._headersContainerElement.children[1+t-r]),!f){this.render(n);return}b.removeClass(u._headersContainerElement.children[1],k._ClassName.pivotHeaderSelected);b.addClass(f,k._ClassName.pivotHeaderSelected);e=u._rtl;o=s(u._headersContainerElement.children[1])-s(f);e&&(o*=-1);l=h.isAnimationEnabled()?h.executeTransition(u._headersContainerElement.querySelectorAll("."+k._ClassName.pivotHeader),{property:i._browserStyleEquivalents.transform.cssName,delay:0,duration:k._headerSlideAnimationDuration,timing:"ease-out",to:"translateX("+o+"px)"}):a.wrap();u._slideHeadersAnimation=l.then(c,c)},handleResize:function(){tt.common.refreshHeadersState(this.pivot)},handleHeaderChanged:function(){this.render();tt.common.refreshHeadersState(this.pivot,!0)}})},k=t.Class.define(function(t,u){if(t=t||n.document.createElement("DIV"),u=u||{},t.winControl)throw new r("WinJS.UI.Pivot.DuplicateConstruction",ut.duplicateConstruction);this._handleItemChangedBound=this._handleItemChanged.bind(this);this._handleItemInsertedBound=this._handleItemInserted.bind(this);this._handleItemMovedBound=this._handleItemMoved.bind(this);this._handleItemRemovedBound=this._handleItemRemoved.bind(this);this._handleItemReloadBound=this._handleItemReload.bind(this);this._id=t.id||b._uniqueID(t);this._writeProfilerMark("constructor,StartTM");t.winControl=this;this._element=t;rt||b.addClass(this.element,k._ClassName.pivotNoSnap);this._element.setAttribute("role","tablist");this._element.getAttribute("aria-label")||this._element.setAttribute("aria-label",ut.pivotAriaLabel);b.addClass(this.element,k._ClassName.pivot);b.addClass(this.element,"win-disposable");b._addEventListener(this.element,"pointerenter",this._updatePointerType.bind(this));b._addEventListener(this.element,"pointerout",this._updatePointerType.bind(this));this._pointerType=ct;this._titleElement=n.document.createElement("DIV");this._titleElement.style.display="none";b.addClass(this._titleElement,k._ClassName.pivotTitle);this._element.appendChild(this._titleElement);this._headerAreaElement=n.document.createElement("DIV");b.addClass(this._headerAreaElement,k._ClassName.pivotHeaderArea);this._element.appendChild(this._headerAreaElement);this._headerItemsElement=n.document.createElement("DIV");b.addClass(this._headerItemsElement,k._ClassName.pivotHeaderItems);this._headerAreaElement.appendChild(this._headerItemsElement);this._headerItemsElWidth=null;this._headersContainerElement=n.document.createElement("DIV");b.addClass(this._headersContainerElement,k._ClassName.pivotHeaders);this._headersContainerElement.addEventListener("keydown",this._headersKeyDown.bind(this));this._headerItemsElement.appendChild(this._headersContainerElement);this._element.addEventListener("click",this._elementClickedHandler.bind(this));b._addEventListener(this._element,"pointerdown",this._elementPointerDownHandler.bind(this));b._addEventListener(this._element,"pointerup",this._elementPointerUpHandler.bind(this));b._addEventListener(this._headersContainerElement,"pointerenter",this._showNavButtons.bind(this));b._addEventListener(this._headersContainerElement,"pointerout",this._hideNavButtons.bind(this));this._winKeyboard=new g._WinKeyboard(this._headersContainerElement);this._tabContainer=new d.TabContainer(this._headersContainerElement);this._headerCustomContentLeft=n.document.createElement("DIV");b.addClass(this._headerCustomContentLeft,k._ClassName.pivotHeaderCustomContent);b.addClass(this._headerCustomContentLeft,k._ClassName.pivotHeaderCustomContentLeft);this._headerAreaElement.insertBefore(this._headerCustomContentLeft,this._headerAreaElement.children[0]);this._headerCustomContentRight=n.document.createElement("DIV");b.addClass(this._headerCustomContentRight,k._ClassName.pivotHeaderCustomContent);b.addClass(this._headerCustomContentRight,k._ClassName.pivotHeaderCustomContentRight);this._headerAreaElement.appendChild(this._headerCustomContentRight);this._viewportElement=n.document.createElement("DIV");this._viewportElement.className=k._ClassName.pivotViewport;this._element.appendChild(this._viewportElement);this._viewportElement.setAttribute("role","group");this._viewportElement.setAttribute("aria-label",ut.pivotViewportAriaLabel);this._resizeHandlerBound=this._resizeHandler.bind(this);this.element.addEventListener("mselementresize",this._resizeHandlerBound);b._resizeNotifier.subscribe(this.element,this._resizeHandlerBound);this._viewportElWidth=null;this._viewportElement.addEventListener("scroll",this._scrollHandler.bind(this));this._viewportElement.addEventListener("MSManipulationStateChanged",this._MSManipulationStateChangedHandler.bind(this));b._addEventListener(this._viewportElement,"pointerdown",this._pointerDownHandler.bind(this));this._surfaceElement=n.document.createElement("DIV");this._surfaceElement.className=k._ClassName.pivotSurface;this._viewportElement.appendChild(this._surfaceElement);this._offsetFromCenter=0;this._currentIndexOnScreen=0;this._loadId=0;this._navMode=k._NavigationModes.none;this._currentManipulationState=it.MS_MANIPULATION_STATE_STOPPED;this._headersState=tt.nop;this._parse();u=i._shallowCopy(u);u.items&&(this.items=u.items,delete u.items);p.setOptions(this,u);this._refresh();this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},customHeaderContentLeft:{get:function(){return this._headerCustomContentLeft.firstElementChild},set:function(n){b.empty(this._headerCustomContentLeft);this._headerCustomContentLeft.appendChild(n);this.forceLayout()}},customHeaderContentRight:{get:function(){return this._headerCustomContentRight.firstElementChild},set:function(n){b.empty(this._headerCustomContentRight);this._headerCustomContentRight.appendChild(n);this.forceLayout()}},locked:{get:function(){return b.hasClass(this.element,k._ClassName.pivotLocked)},set:function(n){b[n?"addClass":"removeClass"](this.element,k._ClassName.pivotLocked);n&&this._hideNavButtons()}},items:{get:function(){return this._pendingItems?this._pendingItems:this._items},set:function(n){var t=!this._pendingItems;this._pendingItems=n;this._refresh();t&&(this._pendingIndexOnScreen=0)}},title:{get:function(){return this._titleElement.textContent},set:function(n){n?(this._titleElement.style.display="block",this._titleElement.textContent=n):(this._titleElement.style.display="none",this._titleElement.textContent="")}},selectedIndex:{get:function(){return this.items.length===0?-1:+this._pendingIndexOnScreen===this._pendingIndexOnScreen?this._pendingIndexOnScreen:this._currentIndexOnScreen},set:function(n){n>=0&&n<this.items.length&&(this._pendingRefresh?this._pendingIndexOnScreen=n:(this._navMode=this._navMode||k._NavigationModes.api,this._loadItem(n)))}},selectedItem:{get:function(){return this.items.getAt(this.selectedIndex)},set:function(n){var t=this.items.indexOf(n);t!==-1&&(this.selectedIndex=t)}},dispose:function(){if(!this._disposed){this._disposed=!0;this._updateEvents(this._items);b._resizeNotifier.unsubscribe(this.element,this._resizeHandlerBound);this._headersState.exit();w._disposeElement(this._headersContainerElement);for(var n=0,t=this.items.length;n<t;n++)this.items.getAt(n).dispose()}},forceLayout:function(){this._disposed||this._resizeHandler()},onselectionchanged:ht(ft.selectionChanged),onitemanimationstart:ht(ft.itemAnimationStart),onitemanimationend:ht(ft.itemAnimationEnd),_currentScrollTargetLocation:{get:function(){return this._viewportWidth===k._invalidViewportWidth?0:(50+this._offsetFromCenter)*Math.ceil(this._viewportWidth)}},_pointerType:{get:function(){return this._pointerTypeValue},set:function(n){this._pointerTypeValue!==n&&(this._pointerTypeValue=n,n===st?(b.removeClass(this.element,k._ClassName.pivotInputTypeMouse),b.addClass(this.element,k._ClassName.pivotInputTypeTouch),this._hideNavButtons()):(b.removeClass(this.element,k._ClassName.pivotInputTypeTouch),b.addClass(this.element,k._ClassName.pivotInputTypeMouse)))}},_rtl:{get:function(){return this._cachedRTL}},_headerItemsWidth:{get:function(){return this._headerItemsElWidth||(this._headerItemsElWidth=parseFloat(n.getComputedStyle(this._headerItemsElement).width)),this._headerItemsElWidth||k._invalidViewportWidth}},_viewportWidth:{get:function(){return this._viewportElWidth||(this._viewportElWidth=parseFloat(n.getComputedStyle(this._viewportElement).width),rt&&(this._viewportElement.style[i._browserStyleEquivalents["scroll-snap-points-x"].scriptName]="snapInterval(0%, "+Math.ceil(this._viewportElWidth)+"px)")),this._viewportElWidth||k._invalidViewportWidth}},_invalidateMeasures:function(){this._viewportElWidth=this._headerItemsElWidth=null},_applyProperties:function(){var t,i;if(!this._disposed){if(this._pendingItems){for(this._updateEvents(this._items,this._pendingItems),this._items=this._pendingItems,this._pendingItems=null;this.element.firstElementChild!==this._titleElement;)t=this.element.firstElementChild,t.parentNode.removeChild(t);b.empty(this._surfaceElement)}this._attachItems();i=this._pendingIndexOnScreen;this._pendingIndexOnScreen=null;this._currentIndexOnScreen=0;this._firstLoad=!0;this._cachedRTL=n.getComputedStyle(this._element,null).direction==="rtl";tt.common.refreshHeadersState(this,!0);this._pendingRefresh=!1;this.selectedIndex=Math.min(i,this.items.length-1);this._firstLoad=!1;this._recenterUI()}},_attachItems:function(){var t,i,n;for(this._measured=!1,t=0,i=this.items.length;t<i;t++){if(n=this._items.getAt(t),n.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Pivot.DuplicateItem",ut.duplicateItem);n.element.style.visibility="hidden";n.element.style.opacity=0;this._surfaceElement.appendChild(n.element)}},_parse:function(){for(var i=[],n=this.element.firstElementChild,t,u;n!==this._titleElement;){if(l.processAll(n),t=n.winControl,t)i.push(t);else throw new r("WinJS.UI.Pivot.InvalidContent",ut.invalidContent);u=n.nextElementSibling;n=u}this.items=new c.List(i)},_refresh:function(){this._pendingRefresh||(this._pendingRefresh=!0,v.schedule(this._applyProperties.bind(this),v.Priority.high))},_resizeHandler:function(){if(!this._disposed&&!this._pendingRefresh){var n=this._viewportWidth,t=this._headerItemsWidth;this._invalidateMeasures();n!==this._viewportWidth||t!==this._headerItemsWidth?(f.log&&f.log("_resizeHandler from:"+n+" to: "+this._viewportWidth),this._hidePivotItemAnimation&&this._hidePivotItemAnimation.cancel(),this._showPivotItemAnimation&&this._showPivotItemAnimation.cancel(),this._slideHeadersAnimation&&this._slideHeadersAnimation.cancel(),this._recenterUI(),this._headersState.handleResize()):f.log&&f.log("_resizeHandler worthless resize")}},_activateHeader:function(n){if(!this.locked){var t=this._items.indexOf(n._item);t!==this.selectedIndex?this._headersState.activateHeader(n):b._setActiveFirstFocusableElement(this.selectedItem.element)}},_goNext:function(){this.selectedIndex<this._items.length-1?this.selectedIndex++:this.selectedIndex=0},_goPrevious:function(){this._animateToPrevious=!0;this.selectedIndex>0?this.selectedIndex--:this.selectedIndex=this._items.length-1;this._animateToPrevious=!1},_loadItem:function(t){var u=this._animateToPrevious,e,o,r,s,i,h;(this._cachedRTL=n.getComputedStyle(this._element,null).direction==="rtl",this._loadId++,e=this._loadId,this._hidePivotItemAnimation&&this._hidePivotItemAnimation.cancel(),this._showPivotItemAnimation&&this._showPivotItemAnimation.cancel(),this._slideHeadersAnimation&&this._slideHeadersAnimation.cancel(),this._currentItem&&this._hidePivotItem(this._currentItem.element,u),o=this._currentIndexOnScreen,this._currentIndexOnScreen=t,this._headersState.handleNavigation(u,t,o),t<0)||(r=this._items.getAt(t),this._currentItem=r,u?this._offsetFromCenter--:t!==o&&this._offsetFromCenter++,s=!1,rt&&this._currentManipulationState!==it.MS_MANIPULATION_STATE_INERTIA&&(this._firstLoad?(f.log&&f.log("_firstLoad index:"+this.selectedIndex+" offset: "+this._offsetFromCenter+" scrollLeft: "+this._currentScrollTargetLocation,"winjs pivot","log"),b.setScrollPosition(this._viewportElement,{scrollLeft:this._currentScrollTargetLocation})):(f.log&&f.log("zoomTo index:"+this.selectedIndex+" offset: "+this._offsetFromCenter+" scrollLeft: "+this._currentScrollTargetLocation,"winjs pivot","log"),this._viewportElement.msZoomTo({contentX:this._currentScrollTargetLocation,contentY:0,viewportX:0,viewportY:0}),s=this._offsetFromCenter!==0&&this.items.length>1)),i=this,h={index:t,direction:u?"backwards":"forward",item:r},this._writeProfilerMark("selectionChanged,info"),this._fireEvent(k._EventName.selectionChanged,!0,!1,h),r._process().then(function(){if(!i._disposed&&e===i._loadId){rt?(r.element.style[i._getDirectionAccessor()]=i._currentScrollTargetLocation+"px",i._showPivotItem(r.element,u)):i._hidePivotItemAnimation?i._showPivotItemAnimation=i._hidePivotItemAnimation.then(function(){if(!i._disposed&&e===i._loadId)return i._showPivotItem(r.element,u)}):i._showPivotItem(r.element,u);var n;s?(i._stoppedAndRecenteredSignal||(i._stoppedAndRecenteredSignal=new y),n=i._stoppedAndRecenteredSignal.promise):n=i._stoppedAndRecenteredSignal&&i._stoppedAndRecenteredSignal.promise||a.wrap();a.join([i._slideHeadersAnimation,i._showPivotItemAnimation,i._hidePivotItemAnimation]).then(function(){n.then(function(){a.timeout(50).then(function(){i._disposed||e!==i._loadId||(i._navMode=k._NavigationModes.none,i._writeProfilerMark("itemAnimationStop,info"),i._fireEvent(k._EventName.itemAnimationEnd,!0))})})})}}))},_MSManipulationStateChangedHandler:function(n){var i,t,r;(this._currentManipulationState=n.currentState,rt&&n.target===this._viewportElement)&&(this._currentManipulationState===it.MS_MANIPULATION_STATE_STOPPED?f.log&&f.log("MSManipulation: Stopped","winjs pivot","log"):this._currentManipulationState===it.MS_MANIPULATION_STATE_INERTIA?f.log&&f.log("MSManipulation: Inertia","winjs pivot","log"):f.log&&f.log("MSManipulation: Active","winjs pivot","log"),this._stoppedAndRecenteredSignal||(this._stoppedAndRecenteredSignal=new y),this._manipulationRecenterPromise&&this._manipulationRecenterPromise.cancel(),this._currentManipulationState===it.MS_MANIPULATION_STATE_STOPPED?(this._navMode===k._NavigationModes.scroll&&this._scrollHandler(),this._navMode=k._NavigationModes.none,i=this,this._manipulationRecenterPromise=a._cancelBlocker(a.join([v.schedulePromiseNormal(null,"WinJS.UI.Pivot._MSManipulationStateChangedHandler_animationPlaceholder"),this._hidePivotItemAnimation,this._showPivotItemAnimation,this._slideHeadersAnimation])).then(function(){i._disposed||(i._currentManipulationState===it.MS_MANIPULATION_STATE_STOPPED?(f.log&&f.log("Still in Stopped state: calling _recenterUI","winjs pivot","log"),i._recenterUI()):(this._stoppedAndRecenteredSignal.complete(),this._stoppedAndRecenteredSignal=null))})):this._navMode!==k._NavigationModes.api&&this._currentManipulationState===it.MS_MANIPULATION_STATE_INERTIA&&(t=n.inertiaDestinationX,+t===t&&(f.log&&f.log("MSManipulation: inertiaDestinationX: "+t),r=t-this._currentScrollTargetLocation,r>0?(f.log&&f.log("MSManipulation: Inertia diff > 1","winjs pivot","log"),this._navMode=k._NavigationModes.inertia,this._goNext()):r<0&&(f.log&&f.log("MSManipulation: Stopped diff < -1","winjs pivot","log"),this._navMode=k._NavigationModes.inertia,this._goPrevious()))))},_scrollHandler:function(){if(rt&&!this._disposed){if(this._recentering&&this._stoppedAndRecenteredSignal){this._stoppedAndRecenteredSignal.complete();this._stoppedAndRecenteredSignal=null;this._recentering=!1;return}if((this._navMode===k._NavigationModes.none||this._navMode===k._NavigationModes.scroll)&&(this._navMode=k._NavigationModes.scroll,this._currentManipulationState===it.MS_MANIPULATION_STATE_STOPPED)){f.log&&f.log("_scrollHandler ScrollPosition: "+b.getScrollPosition(this._viewportElement).scrollLeft,"winjs pivot","log");var t=b.getScrollPosition(this._viewportElement).scrollLeft-this._currentScrollTargetLocation;this._cachedRTL=n.getComputedStyle(this._element,null).direction==="rtl";t>0?(f.log&&f.log("_scrollHandler diff > 1: "+t,"winjs pivot","log"),this._goNext()):t<0&&(f.log&&f.log("_scrollHandler diff < -1: "+t,"winjs pivot","log"),this._goPrevious())}}},_recenterUI:function(){rt&&(this._offsetFromCenter=0,b.getScrollPosition(this._viewportElement).scrollLeft!==this._currentScrollTargetLocation?(this._recentering=!0,this._stoppedAndRecenteredSignal=this._stoppedAndRecenteredSignal||new y):this._stoppedAndRecenteredSignal&&(this._stoppedAndRecenteredSignal.complete(),this._stoppedAndRecenteredSignal=null),this.selectedItem&&(this.selectedItem.element.style[this._getDirectionAccessor()]=this._currentScrollTargetLocation+"px"),f.log&&f.log("_recenterUI index:"+this.selectedIndex+" offset: "+this._offsetFromCenter+" scrollLeft: "+this._currentScrollTargetLocation),b.setScrollPosition(this._viewportElement,{scrollLeft:this._currentScrollTargetLocation}))},_hidePivotItem:function(n,t){function r(){i._disposed||(i._hidePivotItemAnimation=null,n.style.visibility="hidden",n.style.opacity=0)}var i=this,u=this._rtl&&!t||t&&!this._rtl;this._hidePivotItemAnimation=h.isAnimationEnabled()?s[u?"slideRightOut":"slideLeftOut"](n):v.schedulePromiseNormal(null,"WinJS.UI.Pivot._hidePivotItem_animationPlaceholder");this._hidePivotItemAnimation.then(r,r)},_showPivotItem:function(n,t){function f(n){var t=n.getBoundingClientRect();return t.top<o.bottom&&t.bottom>o.top}function l(){e._disposed||(e._showPivotItemAnimation=null)}var c,e;if(this._writeProfilerMark("itemAnimationStart,info"),this._fireEvent(k._EventName.itemAnimationStart,!0),!h.isAnimationEnabled()){n.style.visibility="";n.style.opacity="";this._showPivotItemAnimation=null;return}var i=n.querySelectorAll(".win-pivot-slide1"),r=n.querySelectorAll(".win-pivot-slide2"),u=n.querySelectorAll(".win-pivot-slide3"),o=this._viewportElement.getBoundingClientRect();return i=Array.prototype.filter.call(i,f),r=Array.prototype.filter.call(r,f),u=Array.prototype.filter.call(u,f),c=this._rtl&&!t||t&&!this._rtl,n.style.visibility="",this._showPivotItemAnimation=s[c?"slideRightIn":"slideLeftIn"](n,i,r,u),e=this,this._showPivotItemAnimation.then(l,l),this._showPivotItemAnimation},_elementClickedHandler:function(n){var r,u,f,t,i,e;if(this.locked||this._navigationHandled){this._navigationHandled=!1;return}if(u=n.target,b.hasClass(u,k._ClassName.pivotHeader))r=u;else{if(f=!1,t=b._elementsFromPoint(n.clientX,n.clientY),t&&t[0]===this._viewportElement)for(i=0,e=t.length;i<e;i++)t[i]===u&&(f=!0),b.hasClass(t[i],k._ClassName.pivotHeader)&&(r=t[i]);f||(r=null)}r&&this._activateHeader(r)},_headersKeyDown:function(n){this.locked||(n.keyCode===ot.leftArrow||n.keyCode===ot.pageUp?(this._rtl?this._goNext():this._goPrevious(),n.preventDefault()):(n.keyCode===ot.rightArrow||n.keyCode===ot.pageDown)&&(this._rtl?this._goPrevious():this._goNext(),n.preventDefault()))},_elementPointerDownHandler:function(n){rt||(this._elementPointerDownPoint={x:n.clientX,y:n.clientY,type:n.pointerType||"mouse",time:Date.now(),inHeaders:this._headersContainerElement.contains(n.target)})},_elementPointerUpHandler:function(n){var u,r,i;if(!this._elementPointerDownPoint||this.locked){this._elementPointerDownPoint=null;return}var f=Math.abs(n.clientY-this._elementPointerDownPoint.y),t=n.clientX-this._elementPointerDownPoint.x,e=Math.abs(t*.4),o=f<e&&Math.abs(t)>32&&(!b._supportsTouchDetection||this._elementPointerDownPoint.type===n.pointerType&&n.pointerType===st)&&(!this.element.classList.contains(nt._ClassName.pivotDisableContentSwipeNavigation)||this._elementPointerDownPoint.inHeaders&&this._headersContainerElement.contains(n.target));if(this._navigationHandled=!1,o&&(u=Date.now()-this._elementPointerDownPoint.time,t*=Math.max(1,Math.pow(350/u,2)),t=this._rtl?-t:t,r=this._viewportWidth/4,t<-r?(this._goNext(),this._navigationHandled=!0):t>r&&(this._goPrevious(),this._navigationHandled=!0)),!this._navigationHandled){for(i=n.target;i!==null&&!b.hasClass(i,k._ClassName.pivotHeader);)i=i.parentElement;i!==null&&(this._activateHeader(i),this._navigationHandled=!0)}this._elementPointerDownPoint=null},_hideNavButtons:function(n){n&&this._headersContainerElement.contains(n.relatedTarget)||b.removeClass(this._headersContainerElement,k._ClassName.pivotShowNavButtons)},_pointerDownHandler:function(){f.log&&f.log("_pointerDown","winjs pivot","log");this._manipulationRecenterPromise&&this._manipulationRecenterPromise.cancel();this._slideHeadersAnimation&&this._slideHeadersAnimation.cancel();this._hidePivotItemAnimation&&this._hidePivotItemAnimation.cancel()},_showNavButtons:function(n){this.locked||n&&n.pointerType===st||b.addClass(this._headersContainerElement,k._ClassName.pivotShowNavButtons)},_handleItemChanged:function(n){if(!this._pendingItems){var u=n.detail.index,t=n.detail.newValue,i=n.detail.oldValue;if(t.element!==i.element){if(t.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Pivot.DuplicateItem",ut.duplicateItem);t.element.style.visibility="hidden";t.element.style.opacity=0;this._surfaceElement.insertBefore(t.element,i.element);this._surfaceElement.removeChild(i.element);u===this._currentIndexOnScreen&&(this.selectedIndex=this._currentIndexOnScreen)}this._headersState.render();tt.common.refreshHeadersState(this,!0)}},_handleItemInserted:function(n){if(!this._pendingItems){var i=n.detail.index,t=n.detail.value;if(t.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Pivot.DuplicateItem",ut.duplicateItem);t.element.style.visibility="hidden";t.element.style.opacity=0;i<this.items.length-1?this._surfaceElement.insertBefore(t.element,this.items.getAt(i+1).element):this._surfaceElement.appendChild(t.element);i<=this._currentIndexOnScreen&&this._currentIndexOnScreen++;this._items.length===1&&(this.selectedIndex=0);this._headersState.render();tt.common.refreshHeadersState(this,!0)}},_handleItemMoved:function(n){if(!this._pendingItems){var i=n.detail.oldIndex,t=n.detail.newIndex,r=n.detail.value;t<this.items.length-1?this._surfaceElement.insertBefore(r.element,this.items.getAt(t+1).element):this._surfaceElement.appendChild(r.element);i<this._currentIndexOnScreen&&t>=this._currentIndexOnScreen?this._currentIndexOnScreen--:t>this._currentIndexOnScreen&&i<=this._currentIndexOnScreen?this._currentIndexOnScreen++:i===this._currentIndexOnScreen&&(this.selectedIndex=t);this._headersState.render();tt.common.refreshHeadersState(this,!0)}},_handleItemReload:function(){this.items=this.items},_handleItemRemoved:function(n){if(!this._pendingItems){var i=n.detail.value,t=n.detail.index;this._surfaceElement.removeChild(i.element);t<this._currentIndexOnScreen?this._currentIndexOnScreen--:t===this._currentIndexOnScreen&&(this.selectedIndex=Math.min(this.items.length-1,this._currentIndexOnScreen));this._headersState.render();tt.common.refreshHeadersState(this,!0)}},_fireEvent:function(t,i,r,u){var f=n.document.createEvent("CustomEvent");return f.initCustomEvent(t,!!i,!!r,u),this.element.dispatchEvent(f)},_getDirectionAccessor:function(){return this._rtl?"right":"left"},_updateEvents:function(n,t){n&&(n.removeEventListener("itemchanged",this._handleItemChangedBound),n.removeEventListener("iteminserted",this._handleItemInsertedBound),n.removeEventListener("itemmoved",this._handleItemMovedBound),n.removeEventListener("itemremoved",this._handleItemRemovedBound),n.removeEventListener("reload",this._handleItemReloadBound));t&&(t.addEventListener("itemchanged",this._handleItemChangedBound),t.addEventListener("iteminserted",this._handleItemInsertedBound),t.addEventListener("itemmoved",this._handleItemMovedBound),t.addEventListener("itemremoved",this._handleItemRemovedBound),t.addEventListener("reload",this._handleItemReloadBound))},_updatePointerType:function(n){this._pointerType=n.pointerType||ct},_writeProfilerMark:function(n){var t="WinJS.UI.Pivot:"+this._id+":"+n;o(t);f.log&&f.log(t,null,"pivotprofiler")}},{_invalidViewportWidth:-1,_headerSlideAnimationDuration:250,_ClassName:nt._ClassName,_EventName:{selectionChanged:ft.selectionChanged,itemAnimationStart:ft.itemAnimationStart,itemAnimationEnd:ft.itemAnimationEnd},_NavigationModes:{api:"api",inertia:"inertia",none:"",scroll:"scroll"}}),ut;return t.Class.mix(k,p.DOMEventMixin),ut={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get duplicateItem(){return e._getWinJSString("ui/duplicateItem").value},get invalidContent(){return"Invalid content: Pivot content must be made up of PivotItems."},get pivotAriaLabel(){return e._getWinJSString("ui/pivotAriaLabel").value},get pivotViewportAriaLabel(){return e._getWinJSString("ui/pivotViewportAriaLabel").value}},k})})}),t("WinJS/Controls/Hub/_Section",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Resources","../../ControlProcessor","../../Promise","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Utilities/_KeyboardBehavior"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{HubSection:i.Namespace._lazy(function(){var a={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get seeMore(){return f._getWinJSString("ui/seeMore").value}},n=i.Class.define(function(i,r){var f,o;if(i=i||t.document.createElement("DIV"),r=r||{},i.winControl)throw new u("WinJS.UI.HubSection.DuplicateConstruction",a.duplicateConstruction);for(i.winControl=this,this._element=i,c.addClass(this.element,n._ClassName.hubSection),c.addClass(this.element,"win-disposable"),this._headerElement=t.document.createElement("DIV"),this._headerElement.className=n._ClassName.hubSectionHeader,this._headerElement.innerHTML='<button type="button" role="link" class="'+n._ClassName.hubSectionInteractive+" "+n._ClassName.hubSectionHeaderTabStop+'"><div class="'+n._ClassName.hubSectionHeaderWrapper+'" tabindex="-1"><h2 class="'+n._ClassName.hubSectionHeaderContent+'"><\/h2><span class="'+n._ClassName.hubSectionHeaderChevron+'">'+a.seeMore+"<\/span><\/div><\/button>",this._headerTabStopElement=this._headerElement.firstElementChild,this._headerWrapperElement=this._headerTabStopElement.firstElementChild,this._headerContentElement=this._headerWrapperElement.firstElementChild,this._headerChevronElement=this._headerWrapperElement.lastElementChild,i.appendChild(this._headerElement),this._winKeyboard=new l._WinKeyboard(this._headerElement),this._contentElement=t.document.createElement("DIV"),this._contentElement.className=n._ClassName.hubSectionContent,this._contentElement.style.visibility="hidden",i.appendChild(this._contentElement),f=this.element.firstChild;f!==this._headerElement;)o=f.nextSibling,this._contentElement.appendChild(f),f=o;this._processors=[e.processAll];s.setOptions(this,r)},{element:{get:function(){return this._element}},isHeaderStatic:{get:function(){return this._isHeaderStatic},set:function(t){this._isHeaderStatic=t;this._isHeaderStatic?(this._headerTabStopElement.setAttribute("role","heading"),c.removeClass(this._headerTabStopElement,n._ClassName.hubSectionInteractive)):(this._headerTabStopElement.setAttribute("role","link"),c.addClass(this._headerTabStopElement,n._ClassName.hubSectionInteractive))}},contentElement:{get:function(){return this._contentElement}},header:{get:function(){return this._header},set:function(n){this._header=n;this._renderHeader()}},_setHeaderTemplate:function(n){this._template=c._syncRenderer(n);this._renderHeader()},_renderHeader:function(){this._template&&(h._disposeElement(this._headerContentElement),c.empty(this._headerContentElement),this._template(this,this._headerContentElement))},_process:function(){var n=this;return this._processed=(this._processors||[]).reduce(function(t,i){return t.then(function(){return i(n.contentElement)})},this._processed||o.as()),this._processors=null,this._processed},dispose:function(){this._disposed||(this._disposed=!0,this._processors=null,h._disposeElement(this._headerContentElement),h.disposeSubTree(this.contentElement))}},{_ClassName:{hubSection:"win-hub-section",hubSectionHeader:"win-hub-section-header",hubSectionHeaderTabStop:"win-hub-section-header-tabstop",hubSectionHeaderWrapper:"win-hub-section-header-wrapper",hubSectionInteractive:"win-hub-section-header-interactive",hubSectionHeaderContent:"win-hub-section-header-content",hubSectionHeaderChevron:"win-hub-section-header-chevron",hubSectionContent:"win-hub-section-content"},isDeclarativeControlContainer:r.markSupportedForProcessing(function(n,t){t!==e.processAll&&(n._processors=n._processors||[],n._processors.push(t),n._processed&&n._process())})});return n})})}),t("require-style!less/styles-hub",[],function(){}),t("require-style!less/colors-hub",[],function(){}),t("WinJS/Controls/Hub",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Animations/_TransitionAnimation","../BindingList","../ControlProcessor","../Promise","../_Signal","../Scheduler","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_UI","./Hub/_Section","require-style!less/styles-hub","require-style!less/colors-hub"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";t.Namespace.define("WinJS.UI",{Hub:t.Namespace._lazy(function(){function rt(t){return n.document.createTextNode(typeof t.header=="object"?JSON.stringify(t.header):""+t.header)}var g=w.Key,it=u._createEventProperty,tt={contentAnimating:"contentanimating",headerInvoked:"headerinvoked",loadingStateChanged:"loadingstatechanged"},ft=500,et={scrollPos:"scrollTop",scrollSize:"scrollHeight",offsetPos:"offsetTop",offsetSize:"offsetHeight",oppositeOffsetSize:"offsetWidth",marginStart:"marginTop",marginEnd:"marginBottom",borderStart:"borderTopWidth",borderEnd:"borderBottomWidth",paddingStart:"paddingTop",paddingEnd:"paddingBottom"},ot={scrollPos:"scrollLeft",scrollSize:"scrollWidth",offsetPos:"offsetLeft",offsetSize:"offsetWidth",oppositeOffsetSize:"offsetHeight",marginStart:"marginRight",marginEnd:"marginLeft",borderStart:"borderRightWidth",borderEnd:"borderLeftWidth",paddingStart:"paddingRight",paddingEnd:"paddingLeft"},st={scrollPos:"scrollLeft",scrollSize:"scrollWidth",offsetPos:"offsetLeft",offsetSize:"offsetWidth",oppositeOffsetSize:"offsetHeight",marginStart:"marginLeft",marginEnd:"marginRight",borderStart:"borderLeftWidth",borderEnd:"borderRightWidth",paddingStart:"paddingLeft",paddingEnd:"paddingRight"},b=t.Class.define(function(t,i){if(t=t||n.document.createElement("DIV"),i=i||{},t.winControl)throw new r("WinJS.UI.Hub.DuplicateConstruction",nt.duplicateConstruction);this._id=t.id||w._uniqueID(t);this._writeProfilerMark("constructor,StartTM");this._windowKeyDownHandlerBound=this._windowKeyDownHandler.bind(this);n.addEventListener("keydown",this._windowKeyDownHandlerBound);t.winControl=this;this._element=t;w.addClass(this.element,b._ClassName.hub);w.addClass(this.element,"win-disposable");this._viewportElement=n.document.createElement("DIV");this._viewportElement.className=b._ClassName.hubViewport;this._element.appendChild(this._viewportElement);this._viewportElement.setAttribute("role","group");this._viewportElement.setAttribute("aria-label",nt.hubViewportAriaLabel);this._surfaceElement=n.document.createElement("DIV");this._surfaceElement.className=b._ClassName.hubSurface;this._viewportElement.appendChild(this._surfaceElement);this._visible=!1;this._viewportElement.style.opacity=0;i.orientation||(this._orientation=k.Orientation.horizontal,w.addClass(this.element,b._ClassName.hubHorizontal));this._fireEntrance=!0;this._animateEntrance=!0;this._loadId=0;this.runningAnimations=new a.wrap;this._currentIndexForSezo=0;this._parse();p.setOptions(this,i);w._addEventListener(this.element,"focusin",this._focusin.bind(this),!1);this.element.addEventListener("keydown",this._keyDownHandler.bind(this));this.element.addEventListener("click",this._clickHandler.bind(this));this._resizeHandlerBound=this._resizeHandler.bind(this);this.element.addEventListener("mselementresize",this._resizeHandlerBound);w._resizeNotifier.subscribe(this.element,this._resizeHandlerBound);this._viewportElement.addEventListener("scroll",this._scrollHandler.bind(this));this._surfaceElement.addEventListener("mselementresize",this._contentResizeHandler.bind(this));this._handleSectionChangedBind=this._handleSectionChanged.bind(this);this._handleSectionInsertedBind=this._handleSectionInserted.bind(this);this._handleSectionMovedBind=this._handleSectionMoved.bind(this);this._handleSectionRemovedBind=this._handleSectionRemoved.bind(this);this._handleSectionReloadBind=this._handleSectionReload.bind(this);this._refresh();this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},orientation:{get:function(){return this._orientation},set:function(n){if(n!==this._orientation){if(this._measured=!1,this._names){var t={};t[this._names.scrollPos]=0;w.setScrollPosition(this._viewportElement,t)}n===k.Orientation.vertical?(w.removeClass(this.element,b._ClassName.hubHorizontal),w.addClass(this.element,b._ClassName.hubVertical)):(n=k.Orientation.horizontal,w.removeClass(this.element,b._ClassName.hubVertical),w.addClass(this.element,b._ClassName.hubHorizontal));this._orientation=n;y.schedule(this._updateSnapList.bind(this),y.Priority.idle)}}},sections:{get:function(){return this._pendingSections?this._pendingSections:this._sections},set:function(n){var t=!this._pendingSections;this._pendingSections=n;this._refresh();t&&(this.scrollPosition=0)}},headerTemplate:{get:function(){return this._pendingHeaderTemplate?this._pendingHeaderTemplate:(this._headerTemplate||(this._headerTemplate=rt),this._headerTemplate)},set:function(n){this._pendingHeaderTemplate=n||rt;this._refresh()}},scrollPosition:{get:function(){return+this._pendingScrollLocation===this._pendingScrollLocation?this._pendingScrollLocation:(this._measure(),this._scrollPosition)},set:function(n){var t,i;n=Math.max(0,n);this._pendingRefresh?(this._pendingScrollLocation=n,this._pendingSectionOnScreen=null):(this._measure(),t=Math.max(0,Math.min(this._scrollLength-this._viewportSize,n)),this._scrollPosition=t,i={},i[this._names.scrollPos]=t,w.setScrollPosition(this._viewportElement,i))}},sectionOnScreen:{get:function(){var t,n;if(+this._pendingSectionOnScreen===this._pendingSectionOnScreen)return this._pendingSectionOnScreen;for(this._measure(),t=0;t<this._sectionSizes.length;t++)if(n=this._sectionSizes[t],n.offset+n.size-n.borderEnd-n.paddingEnd>this._scrollPosition+this._startSpacer+n.borderStart+n.paddingStart)return t;return-1},set:function(n){n=Math.max(0,n);this._pendingRefresh?(this._pendingSectionOnScreen=n,this._pendingScrollLocation=null):(this._measure(),n>=0&&n<this._sectionSizes.length&&this._scrollToSection(n))}},indexOfFirstVisible:{get:function(){var n,t;for(this._measure(),n=0;n<this._sectionSizes.length;n++)if(t=this._sectionSizes[n],t.offset+t.size-t.borderEnd-t.paddingEnd>this._scrollPosition)return n;return-1}},indexOfLastVisible:{get:function(){var n,t;for(this._measure(),n=this._sectionSizes.length-1;n>=0;n--)if(t=this._sectionSizes[n],t.offset+t.paddingStart+t.borderStart<this._scrollPosition+this._viewportSize)return n;return-1}},onheaderinvoked:it(tt.headerInvoked),onloadingstatechanged:it(tt.loadingStateChanged),oncontentanimating:it(tt.contentAnimating),_refresh:function(){this._pendingRefresh||(this._loadId++,this._setState(b.LoadingState.loading),this._pendingRefresh=!0,y.schedule(this._refreshImpl.bind(this),y.Priority.high))},_refreshImpl:function(){var n,t;this._disposed||(n=a.wrap(),this._pendingSections&&(this._animateEntrance=!0,this._fireEntrance=!this._visible,this._fireEntrance||(this._visible=!1,this._viewportElement.style.opacity=0,h.isAnimationEnabled()&&(t=this._fireEvent(b._EventName.contentAnimating,{type:b.AnimationType.contentTransition}),t&&(this._viewportElement.style["-ms-overflow-style"]="none",n=s.fadeOut(this._viewportElement).then(function(){this._viewportElement.style["-ms-overflow-style"]=""}.bind(this))),this._animateEntrance=t))),n.done(this._applyProperties.bind(this)))},_applyProperties:function(){var n,t;if(!this._disposed){if(this._pendingRefresh=!1,n=!1,this._pendingSections){for(n=!0,this._updateEvents(this._sections,this._pendingSections),this._sections=this._pendingSections,this._pendingSections=null;this.element.firstElementChild!==this._viewportElement;)t=this.element.firstElementChild,t.parentNode.removeChild(t);w.empty(this._surfaceElement)}this._pendingHeaderTemplate&&(this._headerTemplate=this._pendingHeaderTemplate,this._pendingHeaderTemplate=null);this._assignHeaderTemplate();n&&this._attachSections();+this._pendingSectionOnScreen===this._pendingSectionOnScreen?this.sectionOnScreen=this._pendingSectionOnScreen:this.scrollPosition=+this._pendingScrollLocation===this._pendingScrollLocation?this._pendingScrollLocation:0;this._pendingSectionOnScreen=null;this._pendingScrollLocation=null;this._setState(b.LoadingState.loading);this._loadSections()}},_handleSectionChanged:function(n){if(!this._pendingSections){var t=n.detail.newValue,i=n.detail.oldValue;if(t._setHeaderTemplate(this.headerTemplate),t.element!==i.element){if(t.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Hub.DuplicateSection",nt.duplicateSection);this._surfaceElement.insertBefore(t.element,i.element);this._surfaceElement.removeChild(i.element);this._measured=!1;this._setState(b.LoadingState.loading);this._loadSections()}}},_handleSectionInserted:function(n){var i,t,f,o,e,u,h;if(!this._pendingSections){if(i=n.detail.index,t=n.detail.value,t._animation&&t._animation.cancel(),o=this._fireEvent(b._EventName.contentAnimating,{type:b.AnimationType.insert,index:i,section:t}),o){for(e=[],u=i+1;u<this.sections.length;u++)e.push(this.sections.getAt(u).element);f=new s._createUpdateListAnimation([t.element],[],e)}if(t.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Hub.DuplicateSection",nt.duplicateSection);t._setHeaderTemplate(this.headerTemplate);i<this.sections.length-1?this._surfaceElement.insertBefore(t.element,this.sections.getAt(i+1).element):this._surfaceElement.appendChild(t.element);this._measured=!1;f&&(h=f.execute(),this.runningAnimations=a.join([this.runningAnimations,h]));this._setState(b.LoadingState.loading);this._loadSections()}},_handleSectionMoved:function(n){if(!this._pendingSections){var t=n.detail.newIndex,i=n.detail.value;t<this.sections.length-1?this._surfaceElement.insertBefore(i.element,this.sections.getAt(t+1).element):this._surfaceElement.appendChild(i.element);this._measured=!1;this._setState(b.LoadingState.loading);this._loadSections()}},_handleSectionRemoved:function(n){var u,r,e,o,h;if(!this._pendingSections){var t=n.detail.value,f=n.detail.index,i=a.wrap(),c=this._fireEvent(b._EventName.contentAnimating,{type:b.AnimationType.remove,index:f,section:t});if(c){for(u=[],r=f;r<this.sections.length;r++)u.push(this.sections.getAt(r).element);e=new s._createUpdateListAnimation([],[t.element],u);this._measure();o=t.element.offsetTop;h=t.element.offsetLeft;t.element.style.position="absolute";t.element.style.top=o;t.element.style.left=h;t.element.style.opacity=0;this._measured=!1;i=e.execute().then(function(){t.element.style.position="";t.element.style.top="";t.element.style.left="";t.element.style.opacity=1}.bind(this))}i.done(function(){this._disposed||(this._surfaceElement.removeChild(t.element),this._measured=!1)}.bind(this));t._animation=i;this.runningAnimations=a.join([this.runningAnimations,i]);this._setState(b.LoadingState.loading);this._loadSections()}},_handleSectionReload:function(){this.sections=this.sections},_updateEvents:function(n,t){n&&(n.removeEventListener("itemchanged",this._handleSectionChangedBind),n.removeEventListener("iteminserted",this._handleSectionInsertedBind),n.removeEventListener("itemmoved",this._handleSectionMovedBind),n.removeEventListener("itemremoved",this._handleSectionRemovedBind),n.removeEventListener("reload",this._handleSectionReloadBind));t&&(t.addEventListener("itemchanged",this._handleSectionChangedBind),t.addEventListener("iteminserted",this._handleSectionInsertedBind),t.addEventListener("itemmoved",this._handleSectionMovedBind),t.addEventListener("itemremoved",this._handleSectionRemovedBind),t.addEventListener("reload",this._handleSectionReloadBind))},_attachSections:function(){var t,n;for(this._measured=!1,t=0;t<this.sections.length;t++){if(n=this._sections.getAt(t),n._animation&&n._animation.cancel(),n.element.parentNode===this._surfaceElement)throw new r("WinJS.UI.Hub.DuplicateSection",nt.duplicateSection);this._surfaceElement.appendChild(n.element)}},_assignHeaderTemplate:function(){var n,t;for(this._measured=!1,n=0;n<this.sections.length;n++)t=this._sections.getAt(n),t._setHeaderTemplate(this.headerTemplate)},_loadSection:function(n){var t=this._sections.getAt(n);return t._process().then(function(){var n=t.contentElement.style;n.visibility!==""&&(n.visibility="")})},_loadSections:function(){function k(n){n.then(function(){y.schedule(g,y.Priority.idle)})}function g(){if(u===t._loadId&&!t._disposed)if(f.length){var n=f.shift(),i=t._loadSection(n);k(i)}else o.complete()}var o,e,c;this._loadId++;var u=this._loadId,t=this,l=a.wrap(),f=[],p=a.wrap();if(this._showProgressPromise||(this._showProgressPromise=a.timeout(ft).then(function(){this._disposed||(this._progressBar||(this._progressBar=n.document.createElement("progress"),w.addClass(this._progressBar,b._ClassName.hubProgress),this._progressBar.max=100),this._progressBar.parentNode||this.element.insertBefore(this._progressBar,this._viewportElement),this._showProgressPromise=null)}.bind(this),function(){this._showProgressPromise=null}.bind(this))),this.sections.length){o=new v;p=o.promise;var d=[],i=Math.max(0,this.indexOfFirstVisible),r=Math.max(0,this.indexOfLastVisible);for(e=i;e<=r;e++)d.push(this._loadSection(e));for(i--,r++;i>=0||r<this.sections.length;)r<this.sections.length&&(f.push(r),r++),i>=0&&(f.push(i),i--);c=a.join(d);c.done(function(){u!==this._loadId||t._disposed||(this._showProgressPromise&&this._showProgressPromise.cancel(),this._progressBar&&this._progressBar.parentNode&&this._progressBar.parentNode.removeChild(this._progressBar),y.schedule(function(){if(u===this._loadId&&!t._disposed&&!this._visible){if(this._visible=!0,this._viewportElement.style.opacity=1,this._animateEntrance&&h.isAnimationEnabled()){var i={type:b.AnimationType.entrance};(!this._fireEntrance||this._fireEvent(b._EventName.contentAnimating,i))&&(this._viewportElement.style["-ms-overflow-style"]="none",l=s.enterContent(this._viewportElement).then(function(){this._viewportElement.style["-ms-overflow-style"]=""}.bind(this)))}this._element===n.document.activeElement&&this._moveFocusIn(this.sectionOnScreen)}},y.Priority.high,this,"WinJS.UI.Hub.entranceAnimation"))}.bind(this));k(c)}else this._showProgressPromise&&this._showProgressPromise.cancel(),this._progressBar&&this._progressBar.parentNode&&this._progressBar.parentNode.removeChild(this._progressBar);a.join([this.runningAnimations,l,p]).done(function(){u!==this._loadId||t._disposed||(this.runningAnimations=a.wrap(),this._measured&&this._scrollLength!==this._viewportElement[this._names.scrollSize]&&(this._measured=!1),this._setState(b.LoadingState.complete),y.schedule(this._updateSnapList.bind(this),y.Priority.idle))}.bind(this))},loadingState:{get:function(){return this._loadingState}},_setState:function(t){if(t!==this._loadingState){this._writeProfilerMark("loadingStateChanged:"+t+",info");this._loadingState=t;var i=n.document.createEvent("CustomEvent");i.initCustomEvent(b._EventName.loadingStateChanged,!0,!1,{loadingState:t});this._element.dispatchEvent(i)}},_parse:function(){for(var i=[],n=this.element.firstElementChild,t,u;n!==this._viewportElement;){if(l.processAll(n),t=n.winControl,t)i.push(t);else throw new r("WinJS.UI.Hub.InvalidContent",nt.invalidContent);u=n.nextElementSibling;n=u}this.sections=new c.List(i)},_fireEvent:function(t,i){var r=n.document.createEvent("CustomEvent");return r.initCustomEvent(t,!0,!0,i),this.element.dispatchEvent(r)},_findHeaderTabStop:function(n){if(n.parentNode&&w._matchesSelector(n,".win-hub-section-header-tabstop, .win-hub-section-header-tabstop *")){while(!w.hasClass(n,"win-hub-section-header-tabstop"))n=n.parentElement;return n}return null},_isInteractive:function(t){while(t&&t!==n.document.body){if(t.classList.contains("win-interactive"))return!0;t=t.parentElement}return!1},_clickHandler:function(n){var i=this._findHeaderTabStop(n.target),t,r;i&&!this._isInteractive(n.target)&&(t=i.parentElement.parentElement.winControl,t.isHeaderStatic||(r=this.sections.indexOf(t),this._fireEvent(b._EventName.headerInvoked,{index:r,section:t})))},_resizeHandler:function(){this._measured=!1;y.schedule(this._updateSnapList.bind(this),y.Priority.idle)},_contentResizeHandler:function(){this._measured=!1;y.schedule(this._updateSnapList.bind(this),y.Priority.idle)},_scrollHandler:function(){(this._measured=!1,this._pendingSections)||(this._pendingScrollLocation=null,this._pendingSectionOnScreen=null,this._pendingScrollHandler||(this._pendingScrollHandler=i._requestAnimationFrame(function(){(this._pendingScrollHandler=null,this._pendingSections)||this.loadingState!==b.LoadingState.complete&&this._loadSections()}.bind(this))))},_measure:function(){var i,t,u,r;if(!this._measured||this._scrollLength===0){for(this._writeProfilerMark("measure,StartTM"),this._measured=!0,this._rtl=n.getComputedStyle(this._element,null).direction==="rtl",this._names=this.orientation===k.Orientation.vertical?et:this._rtl?ot:st,this._viewportSize=this._viewportElement[this._names.offsetSize],this._viewportOppositeSize=this._viewportElement[this._names.oppositeOffsetSize],this._scrollPosition=w.getScrollPosition(this._viewportElement)[this._names.scrollPos],this._scrollLength=this._viewportElement[this._names.scrollSize],i=n.getComputedStyle(this._surfaceElement),this._startSpacer=parseFloat(i[this._names.marginStart])+parseFloat(i[this._names.borderStart])+parseFloat(i[this._names.paddingStart]),this._endSpacer=parseFloat(i[this._names.marginEnd])+parseFloat(i[this._names.borderEnd])+parseFloat(i[this._names.paddingEnd]),this._sectionSizes=[],t=0;t<this.sections.length;t++)u=this.sections.getAt(t),r=n.getComputedStyle(u.element),this._sectionSizes[t]={offset:u.element[this._names.offsetPos],size:u.element[this._names.offsetSize],marginStart:parseFloat(r[this._names.marginStart]),marginEnd:parseFloat(r[this._names.marginEnd]),borderStart:parseFloat(r[this._names.borderStart]),borderEnd:parseFloat(r[this._names.borderEnd]),paddingStart:parseFloat(r[this._names.paddingStart]),paddingEnd:parseFloat(r[this._names.paddingEnd])},this._rtl&&this.orientation===k.Orientation.horizontal&&(this._sectionSizes[t].offset=this._viewportSize-(this._sectionSizes[t].offset+this._sectionSizes[t].size));this._writeProfilerMark("measure,StopTM")}},_updateSnapList:function(){var n,t,u,i,r;for(this._writeProfilerMark("updateSnapList,StartTM"),this._measure(),n="snapList(",t=0;t<this._sectionSizes.length;t++)t>0&&(n+=","),u=this._sectionSizes[t],n+=u.offset-u.marginStart-this._startSpacer+"px";n+=")";i="";r="";this.orientation===k.Orientation.vertical?i=n:r=n;this._lastSnapPointY!==i&&(this._lastSnapPointY=i,this._viewportElement.style["-ms-scroll-snap-points-y"]=i);this._lastSnapPointX!==r&&(this._lastSnapPointX=r,this._viewportElement.style["-ms-scroll-snap-points-x"]=r);this._writeProfilerMark("updateSnapList,StopTM")},_scrollToSection:function(n,t){this._measure();var i=this._sectionSizes[n],r=Math.min(this._scrollLength-this._viewportSize,i.offset-i.marginStart-this._startSpacer);this._scrollTo(r,t)},_ensureVisible:function(n,t){this._measure();var i=this._ensureVisibleMath(n,this._scrollPosition);this._scrollTo(i,t)},_ensureVisibleMath:function(n,t){this._measure();var i=this._sectionSizes[n],r=Math.min(this._scrollLength-this._viewportSize,i.offset-i.marginStart-this._startSpacer),u=Math.max(0,i.offset+i.size+i.marginEnd+this._endSpacer-this._viewportSize+1);return t>r?t=r:t<u&&(t=Math.min(r,u)),t},_scrollTo:function(n,t){if(this._scrollPosition=n,t)this.orientation===k.Orientation.vertical?w._zoomTo(this._viewportElement,{contentX:0,contentY:this._scrollPosition,viewportX:0,viewportY:0}):w._zoomTo(this._viewportElement,{contentX:this._scrollPosition,contentY:0,viewportX:0,viewportY:0});else{var i={};i[this._names.scrollPos]=this._scrollPosition;w.setScrollPosition(this._viewportElement,i)}},_windowKeyDownHandler:function(n){if(n.keyCode===g.tab){this._tabSeenLast=!0;var t=this;i._yieldForEvents(function(){t._tabSeenLast=!1})}},_focusin:function(n){var r,t,i,u;for(this._tabSeenLast&&(r=this._findHeaderTabStop(n.target),r&&!this._isInteractive(n.target)&&(i=this.sections.indexOf(r.parentElement.parentElement.winControl),i>-1&&this._ensureVisible(i,!0))),t=n.target;t&&!w.hasClass(t,d.HubSection._ClassName.hubSection);)t=t.parentElement;t&&(i=this.sections.indexOf(t.winControl),i>-1&&(this._currentIndexForSezo=i));n.target===this.element&&(+this._sectionToFocus===this._sectionToFocus&&this._sectionToFocus>=0&&this._sectionToFocus<this.sections.length?(u=this._sectionToFocus,this._sectionToFocus=null):u=this.sectionOnScreen,this._moveFocusIn(u))},_moveFocusIn:function(n){var t,i,r;if(n>=0){for(t=n;t<this.sections.length;t++){if(i=this.sections.getAt(t),r=w._trySetActive(i._headerTabStopElement,this._viewportElement),r)return;if(w._setActiveFirstFocusableElement(i.contentElement,this._viewportElement))return}for(t=n-1;t>=0;t--){if(i=this.sections.getAt(t),w._setActiveFirstFocusableElement(i.contentElement,this._viewportElement))return;if(r=w._trySetActive(i._headerTabStopElement,this._viewportElement),r)return}}},_keyDownHandler:function(n){var e,o,r,u,i,f,t,s;if(!this._isInteractive(n.target)&&!w._hasCursorKeysBehaviors(n.target))if(e=this._rtl?g.rightArrow:g.leftArrow,o=this._rtl?g.leftArrow:g.rightArrow,n.keyCode===g.upArrow||n.keyCode===g.downArrow||n.keyCode===g.leftArrow||n.keyCode===g.rightArrow||n.keyCode===g.pageUp||n.keyCode===g.pageDown){if(r=this._findHeaderTabStop(n.target),r){if(u=this.sections.indexOf(r.parentElement.parentElement.winControl),f=!1,n.keyCode===g.pageDown||this.orientation===k.Orientation.horizontal&&n.keyCode===o||this.orientation===k.Orientation.vertical&&n.keyCode===g.downArrow){for(t=u+1;t<this.sections.length;t++)if(this._tryFocus(t)){i=t;break}}else if(n.keyCode===g.pageUp||this.orientation===k.Orientation.horizontal&&n.keyCode===e||this.orientation===k.Orientation.vertical&&n.keyCode===g.upArrow)for(t=u-1;t>=0;t--)if(this._tryFocus(t)){i=t;break}(n.keyCode===g.upArrow||n.keyCode===g.downArrow||n.keyCode===g.leftArrow||n.keyCode===g.rightArrow)&&(f=!0);+i===i&&(f?this._ensureVisible(i,!0):this._scrollToSection(i,!0),n.preventDefault())}}else(n.keyCode===g.home||n.keyCode===g.end)&&(this._measure(),s=Math.max(0,this._scrollLength-this._viewportSize),this._scrollTo(n.keyCode===g.home?0:s,!0),n.preventDefault())},_tryFocus:function(t){var i=this.sections.getAt(t);return w._setActive(i._headerTabStopElement,this._viewportElement),n.document.activeElement===i._headerTabStopElement},zoomableView:{get:function(){return this._zoomableView||(this._zoomableView=new ut(this)),this._zoomableView}},_getPanAxis:function(){return this.orientation===k.Orientation.horizontal?"horizontal":"vertical"},_configureForZoom:function(){},_setCurrentItem:function(n,t){var r,i,u;for(r=this.orientation===k.Orientation.horizontal?n:t,this._measure(),r=r+this._scrollPosition,this._currentIndexForSezo=this._sectionSizes.length-1,i=1;i<this._sectionSizes.length;i++)if(u=this._sectionSizes[i],u.offset-u.marginStart>r){this._currentIndexForSezo=i-1;break}},_getCurrentItem:function(){var i,t,n,r;if(this._sectionSizes.length>0)return this._measure(),t=Math.max(0,Math.min(this._currentIndexForSezo,this._sectionSizes.length)),n=this._sectionSizes[t],i=this.orientation===k.Orientation.horizontal?{left:Math.max(0,n.offset-n.marginStart-this._scrollPosition),top:0,width:n.size,height:this._viewportOppositeSize}:{left:0,top:Math.max(0,n.offset-n.marginStart-this._scrollPosition),width:this._viewportOppositeSize,height:n.size},r=this.sections.getAt(t),a.wrap({item:{data:r,index:t,groupIndexHint:t},position:i})},_beginZoom:function(){this._viewportElement.style["-ms-overflow-style"]="none"},_positionItem:function(n,t){var u,f,i,r;n.index>=0&&n.index<this._sectionSizes.length&&(this._measure(),u=this._sectionSizes[n.index],f=this.orientation===k.Orientation.horizontal?t.left:t.top,this._sectionToFocus=n.index,i=u.offset-f,i=this._ensureVisibleMath(n.index,i),this._scrollPosition=i,r={},r[this._names.scrollPos]=this._scrollPosition,w.setScrollPosition(this._viewportElement,r))},_endZoom:function(){this._viewportElement.style["-ms-overflow-style"]=""},_writeProfilerMark:function(n){var t="WinJS.UI.Hub:"+this._id+":"+n;o(t);f.log&&f.log(t,null,"hubprofiler")},dispose:function(){if(!this._disposed){this._disposed=!0;n.removeEventListener("keydown",this._windowKeyDownHandlerBound);w._resizeNotifier.unsubscribe(this.element,this._resizeHandlerBound);this._updateEvents(this._sections);for(var t=0;t<this.sections.length;t++)this.sections.getAt(t).dispose()}}},{AnimationType:{entrance:"entrance",contentTransition:"contentTransition",insert:"insert",remove:"remove"},LoadingState:{loading:"loading",complete:"complete"},_ClassName:{hub:"win-hub",hubSurface:"win-hub-surface",hubProgress:"win-hub-progress",hubViewport:"win-hub-viewport",hubVertical:"win-hub-vertical",hubHorizontal:"win-hub-horizontal"},_EventName:{contentAnimating:tt.contentAnimating,headerInvoked:tt.headerInvoked,loadingStateChanged:tt.loadingStateChanged}}),ut,nt;return t.Class.mix(b,p.DOMEventMixin),ut=t.Class.define(function(n){this._hub=n},{getPanAxis:function(){return this._hub._getPanAxis()},configureForZoom:function(n,t,i,r){this._hub._configureForZoom(n,t,i,r)},setCurrentItem:function(n,t){this._hub._setCurrentItem(n,t)},getCurrentItem:function(){return this._hub._getCurrentItem()},beginZoom:function(){this._hub._beginZoom()},positionItem:function(n,t){return this._hub._positionItem(n,t)},endZoom:function(n){this._hub._endZoom(n)}}),nt={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get duplicateSection(){return"Hub duplicate sections: Each HubSection must be unique"},get invalidContent(){return"Invalid content: Hub content must be made up of HubSections."},get hubViewportAriaLabel(){return e._getWinJSString("ui/hubViewportAriaLabel").value}},b})})}),t("require-style!less/styles-lightdismissservice",[],function(){}),t("WinJS/_LightDismissService",["require","exports","./Application","./Core/_Base","./Core/_BaseUtils","./Utilities/_ElementUtilities","./Core/_Global","./Utilities/_KeyboardBehavior","./Core/_Log","./Core/_Resources"],function(n,t,i,r,u,f,e,o,s,h){function l(n,t){var i=e.document.activeElement;return n===i?!0:(t?f._setActive(n):n.focus(),i!==e.document.activeElement)}var w,a;n(["require-style!less/styles-lightdismissservice"]);"use strict";var v=1e3,y=2,p={get closeOverlay(){return h._getWinJSString("ui/closeOverlay").value}};t._ClassNames={_clickEater:"win-clickeater"};w={requestingFocusOnKeyboardInput:"requestingfocusonkeyboardinput",edgyStarting:"edgystarting",edgyCompleted:"edgycompleted",edgyCanceled:"edgycanceled"};t.LightDismissalReasons={tap:"tap",lostFocus:"lostFocus",escape:"escape",hardwareBackButton:"hardwareBackButton",windowResize:"windowResize",windowBlur:"windowBlur",edgy:"edgy"};t.DismissalPolicies={light:function(n){switch(n.reason){case t.LightDismissalReasons.tap:case t.LightDismissalReasons.escape:return n.active?!0:(n.stopPropagation(),!1);case t.LightDismissalReasons.hardwareBackButton:return n.active?(n.preventDefault(),!0):(n.stopPropagation(),!1);case t.LightDismissalReasons.lostFocus:case t.LightDismissalReasons.windowResize:case t.LightDismissalReasons.windowBlur:case t.LightDismissalReasons.edgy:return!0}},sticky:function(n){return n.stopPropagation(),!1}};a=function(){function n(n){this.element=n.element;this.element.tabIndex=n.tabIndex;this.onLightDismiss=n.onLightDismiss;n.setZIndex&&(this.setZIndex=n.setZIndex);n.getZIndexCount&&(this.getZIndexCount=n.getZIndexCount);n.containsElement&&(this.containsElement=n.containsElement);n.onActivate&&(this.onActivate=n.onActivate);this._customOnFocus=n.onFocus;this._customOnHide=n.onHide;n.onShouldLightDismiss&&(this.onShouldLightDismiss=n.onShouldLightDismiss)}return n.prototype.restoreFocus=function(){var n=e.document.activeElement,t;return n&&this.containsElement(n)?(this._ldeCurrentFocus=n,!0):(t=!o._keyboardSeenLast,this._ldeCurrentFocus&&this.containsElement(this._ldeCurrentFocus)&&l(this._ldeCurrentFocus,t))},n.prototype.setZIndex=function(n){this.element.style.zIndex=n},n.prototype.getZIndexCount=function(){return 1},n.prototype.containsElement=function(n){return this.element.contains(n)},n.prototype.onActivate=function(n){this.restoreFocus()||f._focusFirstFocusableElement(this.element,n)||l(this.element,n)},n.prototype.onFocus=function(n){this._ldeCurrentFocus=n;this._customOnFocus&&this._customOnFocus(n)},n.prototype.onHide=function(){this._ldeCurrentFocus=null;this._customOnHide&&this._customOnHide()},n.prototype.onShouldLightDismiss=function(n){return t.DismissalPolicies.light(n)},n.prototype.onLightDismiss=function(){},n}();t.LightDismissableElement=a;var b=function(){function n(){}return n.prototype.setZIndex=function(){},n.prototype.getZIndexCount=function(){return 1},n.prototype.containsElement=function(n){return e.document.body.contains(n)},n.prototype.onActivate=function(n){this.currentFocus&&this.containsElement(this.currentFocus)&&l(this.currentFocus,n)||e.document.body&&f._focusFirstFocusableElement(e.document.body,n)||e.document.body&&l(e.document.body,n)},n.prototype.onFocus=function(n){this.currentFocus=n},n.prototype.onHide=function(){this.currentFocus=null},n.prototype.onShouldLightDismiss=function(){return!1},n.prototype.onLightDismiss=function(){},n}(),k=function(){function n(){this._debug=!1;this._clients=[];this._notifying=!1;this._bodyClient=new b;this._updateDom_rendered={serviceActive:!1};this._clickEaterEl=this._createClickEater();this._onFocusInBound=this._onFocusIn.bind(this);this._onKeyDownBound=this._onKeyDown.bind(this);this._onWindowResizeBound=this._onWindowResize.bind(this);this._onClickEaterPointerUpBound=this._onClickEaterPointerUp.bind(this);this._onClickEaterPointerCancelBound=this._onClickEaterPointerCancel.bind(this);i.addEventListener("backclick",this._onBackClick.bind(this));e.window.addEventListener("blur",this._onWindowBlur.bind(this));this.shown(this._bodyClient)}return n.prototype.shown=function(n){var t=this._clients.indexOf(n);t===-1&&(this._clients.push(n),this._updateDom())},n.prototype.hidden=function(n){var t=this._clients.indexOf(n);t!==-1&&(this._clients.splice(t,1),n.setZIndex(""),n.onHide(),this._updateDom())},n.prototype.updated=function(){this._updateDom()},n.prototype.isShown=function(n){return this._clients.indexOf(n)!==-1},n.prototype.isTopmost=function(n){return n===this._clients[this._clients.length-1]},n.prototype._setDebug=function(n){this._debug=n},n.prototype._updateDom=function(){var s=this._updateDom_rendered,n,i,r,t,u,h;this._notifying||(n=this._clients.length>1,n!==s.serviceActive&&(n?(f._addEventListener(e.document.documentElement,"focusin",this._onFocusInBound),e.document.documentElement.addEventListener("keydown",this._onKeyDownBound),e.window.addEventListener("resize",this._onWindowResizeBound),this._bodyClient.currentFocus=e.document.activeElement,e.document.body.appendChild(this._clickEaterEl)):(f._removeEventListener(e.document.documentElement,"focusin",this._onFocusInBound),e.document.documentElement.removeEventListener("keydown",this._onKeyDownBound),e.window.removeEventListener("resize",this._onWindowResizeBound),i=this._clickEaterEl.parentNode,i&&i.removeChild(this._clickEaterEl)),s.serviceActive=n),r=0,t=v+1,this._clients.forEach(function(n){var i=t+r;n.setZIndex(""+i);t=i;r=n.getZIndexCount()+1}),n&&(this._clickEaterEl.style.zIndex=""+(t-1)),u=this._clients.length>0?this._clients[this._clients.length-1]:null,this._activeDismissable!==u&&(this._activeDismissable=u,h=!o._keyboardSeenLast,this._activeDismissable&&this._activeDismissable.onActivate(h)))},n.prototype._dispatchLightDismiss=function(n,t){var i,r;if(this._notifying){s.log&&s.log('_LightDismissService ignored dismiss trigger to avoid re-entrancy: "'+n+'"',"winjs _LightDismissService","warning");return}if(t=t||this._clients.slice(0),t.length!==0){for(this._notifying=!0,i={reason:n,active:!1,_stop:!1,stopPropagation:function(){this._stop=!0},_doDefault:!0,preventDefault:function(){this._doDefault=!1}},r=t.length-1;r>=0&&!i._stop;r--)if(i.active=this._activeDismissable===t[r],t[r].onShouldLightDismiss(i))t[r].onLightDismiss(i);return this._notifying=!1,this._updateDom(),i._doDefault}},n.prototype._clickEaterTapped=function(){this._dispatchLightDismiss(t.LightDismissalReasons.tap)},n.prototype._onFocusIn=function(n){for(var r=n.target,i=this._clients.length-1;i>=0;i--)if(this._clients[i].containsElement(r))break;if(i!==-1)this._clients[i].onFocus(r);this._dispatchLightDismiss(t.LightDismissalReasons.lostFocus,this._clients.slice(i+1,this._clients.length))},n.prototype._onKeyDown=function(n){n.keyCode===f.Key.escape&&(n.preventDefault(),n.stopPropagation(),this._dispatchLightDismiss(t.LightDismissalReasons.escape))},n.prototype._onBackClick=function(){var n=this._dispatchLightDismiss(t.LightDismissalReasons.hardwareBackButton);return!n},n.prototype._onWindowResize=function(){this._dispatchLightDismiss(t.LightDismissalReasons.windowResize)},n.prototype._onWindowBlur=function(){if(!this._debug)if(e.document.hasFocus()){var n=e.document.activeElement;n&&n.tagName==="IFRAME"&&!n.msLightDismissBlur&&(n.addEventListener("blur",this._onWindowBlur.bind(this),!1),n.msLightDismissBlur=!0)}else this._dispatchLightDismiss(t.LightDismissalReasons.windowBlur)},n.prototype._createClickEater=function(){var n=e.document.createElement("section");return n.className=t._ClassNames._clickEater,f._addEventListener(n,"pointerdown",this._onClickEaterPointerDown.bind(this),!0),n.addEventListener("click",this._onClickEaterClick.bind(this),!0),n.setAttribute("role","menuitem"),n.setAttribute("aria-label",p.closeOverlay),n.setAttribute("unselectable","on"),n},n.prototype._onClickEaterPointerDown=function(n){n.stopPropagation();n.preventDefault();n.button!==y&&(this._clickEaterPointerId=n.pointerId,this._registeredClickEaterCleanUp||(f._addEventListener(e.window,"pointerup",this._onClickEaterPointerUpBound),f._addEventListener(e.window,"pointercancel",this._onClickEaterPointerCancelBound),this._registeredClickEaterCleanUp=!0))},n.prototype._onClickEaterPointerUp=function(n){var i=this,t;n.stopPropagation();n.preventDefault();n.pointerId===this._clickEaterPointerId&&(this._resetClickEaterPointerState(),t=e.document.elementFromPoint(n.clientX,n.clientY),t===this._clickEaterEl&&(this._skipClickEaterClick=!0,u._yieldForEvents(function(){i._skipClickEaterClick=!1}),this._clickEaterTapped()))},n.prototype._onClickEaterClick=function(n){n.stopPropagation();n.preventDefault();this._skipClickEaterClick||this._clickEaterTapped()},n.prototype._onClickEaterPointerCancel=function(n){n.pointerId===this._clickEaterPointerId&&this._resetClickEaterPointerState()},n.prototype._resetClickEaterPointerState=function(){this._registeredClickEaterCleanUp&&(f._removeEventListener(e.window,"pointerup",this._onClickEaterPointerUpBound),f._removeEventListener(e.window,"pointercancel",this._onClickEaterPointerCancelBound));this._clickEaterPointerId=null;this._registeredClickEaterCleanUp=!1},n}(),c=new k;t.shown=c.shown.bind(c);t.hidden=c.hidden.bind(c);t.updated=c.updated.bind(c);t.isShown=c.isShown.bind(c);t.isTopmost=c.isTopmost.bind(c);t._clickEaterTapped=c._clickEaterTapped.bind(c);t._onBackClick=c._onBackClick.bind(c);t._setDebug=c._setDebug.bind(c);r.Namespace.define("WinJS.UI._LightDismissService",{shown:t.shown,hidden:t.hidden,updated:t.updated,isShown:t.isShown,isTopmost:t.isTopmost,_clickEaterTapped:t._clickEaterTapped,_onBackClick:t._onBackClick,_setDebug:t._setDebug,LightDismissableElement:a,DismissalPolicies:t.DismissalPolicies,LightDismissalReasons:t.LightDismissalReasons,_ClassNames:t._ClassNames,_service:c})}),t("WinJS/Controls/_LegacyAppBar/_Constants",["exports","../../Core/_Base",],function(n,t){"use strict";t.Namespace._moduleDefine(n,null,{appBarClass:"win-navbar",firstDivClass:"win-firstdiv",finalDivClass:"win-finaldiv",invokeButtonClass:"win-navbar-invokebutton",ellipsisClass:"win-navbar-ellipsis",primaryCommandsClass:"win-primarygroup",secondaryCommandsClass:"win-secondarygroup",commandLayoutClass:"win-commandlayout",menuLayoutClass:"win-menulayout",topClass:"win-top",bottomClass:"win-bottom",showingClass:"win-navbar-opening",shownClass:"win-navbar-opened",hidingClass:"win-navbar-closing",hiddenClass:"win-navbar-closed",compactClass:"win-navbar-compact",minimalClass:"win-navbar-minimal",menuContainerClass:"win-navbar-menu",appBarPlacementTop:"top",appBarPlacementBottom:"bottom",appBarLayoutCustom:"custom",appBarLayoutCommands:"commands",appBarLayoutMenu:"menu",appBarInvokeButtonWidth:32,typeSeparator:"separator",typeContent:"content",typeButton:"button",typeToggle:"toggle",typeFlyout:"flyout",appBarCommandClass:"win-command",appBarCommandGlobalClass:"win-global",appBarCommandSelectionClass:"win-selection",sectionSelection:"selection",sectionGlobal:"global",sectionPrimary:"primary",sectionSecondary:"secondary",menuCommandClass:"win-command",menuCommandButtonClass:"win-command-button",menuCommandToggleClass:"win-command-toggle",menuCommandFlyoutClass:"win-command-flyout",menuCommandFlyoutActivatedClass:"win-command-flyout-activated",menuCommandSeparatorClass:"win-command-separator",_menuCommandInvokedEvent:"_invoked",menuClass:"win-menu",menuContainsToggleCommandClass:"win-menu-containstogglecommand",menuContainsFlyoutCommandClass:"win-menu-containsflyoutcommand",menuMouseSpacingClass:"win-menu-mousespacing",menuTouchSpacingClass:"win-menu-touchspacing",menuCommandHoverDelay:400,overlayClass:"win-overlay",flyoutClass:"win-flyout",flyoutLightClass:"win-ui-light",settingsFlyoutClass:"win-settingsflyout",scrollsClass:"win-scrolls",separatorWidth:34,buttonWidth:68,narrowClass:"win-narrow",wideClass:"win-wide",_visualViewportClass:"win-visualviewport-space",commandVisibilityChanged:"commandvisibilitychanged"})}),t("WinJS/Utilities/_KeyboardInfo",["require","exports","../Core/_Global","../Core/_WinRT"],function(n,t,i,r){"use strict";var u={visualViewportClass:"win-visualviewport-space",scrollTimeout:150};t._KeyboardInfo;t._KeyboardInfo={get _visible(){try{return r.Windows.UI.ViewManagement.InputPane&&r.Windows.UI.ViewManagement.InputPane.getForCurrentView().occludedRect.height>0}catch(n){return!1}},get _extraOccluded(){var n=0;return!t._KeyboardInfo._isResized&&r.Windows.UI.ViewManagement.InputPane&&(n=r.Windows.UI.ViewManagement.InputPane.getForCurrentView().occludedRect.height),n},get _isResized(){var n=i.document.documentElement.clientHeight/i.innerHeight,t=i.document.documentElement.clientWidth/i.innerWidth;return t/n<.99},get _visibleDocBottom(){return t._KeyboardInfo._visibleDocTop+t._KeyboardInfo._visibleDocHeight},get _visibleDocHeight(){return t._KeyboardInfo._visualViewportHeight-t._KeyboardInfo._extraOccluded},get _visibleDocTop(){return 0},get _visibleDocBottomOffset(){return t._KeyboardInfo._extraOccluded},get _visualViewportHeight(){var n=t._KeyboardInfo._visualViewportSpace;return n.height},get _visualViewportWidth(){var n=t._KeyboardInfo._visualViewportSpace;return n.width},get _visualViewportSpace(){var n=i.document.body.querySelector("."+u.visualViewportClass);return n||(n=i.document.createElement("DIV"),n.className=u.visualViewportClass,i.document.body.appendChild(n)),n.getBoundingClientRect()},get _animationShowLength(){var n,u;if(r.Windows.UI.Core.AnimationMetrics){var t=r.Windows.UI.Core.AnimationMetrics,e=new t.AnimationDescription(t.AnimationEffect.showPanel,t.AnimationEffectTarget.primary),f=e.animations,i=0;for(n=0;n<f.size;n++)u=f[n],i=Math.max(i,u.delay+u.duration);return i}return 0},get _scrollTimeout(){return u.scrollTimeout},get _layoutViewportCoords(){var n=i.window.pageYOffset-i.document.documentElement.scrollTop,t=i.document.documentElement.clientHeight-(n+this._visibleDocHeight);return{visibleDocTop:n,visibleDocBottom:t}}}}),t("require-style!less/styles-overlay",[],function(){}),t("require-style!less/colors-overlay",[],function(){}),t("WinJS/Controls/Flyout/_Overlay",["exports","../../Core/_Global","../../Core/_WinRT","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Events","../../Core/_Resources","../../Core/_WriteProfilerMark","../../Animations","../../Application","../../ControlProcessor","../../Promise","../../Scheduler","../../Utilities/_Control","../../Utilities/_ElementUtilities","../../Utilities/_KeyboardInfo","../_LegacyAppBar/_Constants","require-style!less/styles-overlay","require-style!less/colors-overlay"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";r.Namespace._moduleDefine(n,"WinJS.UI",{_Overlay:r.Namespace._lazy(function(){function e(n,i,r){var e=t.document.querySelectorAll("."+b.overlayClass),s,u,h,f,o;if(e)for(s=e.length,u=0;u<s;u++)if(h=e[u],f=h.winControl,!f._disposed&&f&&(o=f[i](n),r&&o))return o}function k(n){var i,r,u;if(!n)return[];for(typeof n!="string"&&n&&n.length||(n=[n]),r=[],i=0;i<n.length;i++)n[i]&&(typeof n[i]=="string"?(u=t.document.getElementById(n[i]),u&&r.push(u)):n[i].element?r.push(n[i].element):r.push(n[i]));return r}var n=r.Class.define(function(){this._currentState=n.states.off;this._inputPaneShowing=this._inputPaneShowing.bind(this);this._inputPaneHiding=this._inputPaneHiding.bind(this);this._documentScroll=this._documentScroll.bind(this);this._windowResized=this._windowResized.bind(this)},{initialize:function(){this._toggleListeners(n.states.on)},reset:function(){this._toggleListeners(n.states.off);this._toggleListeners(n.states.on)},_inputPaneShowing:function(t){s(n.profilerString+"_showingKeyboard,StartTM");e(t,"_showingKeyboard");s(n.profilerString+"_showingKeyboard,StopTM")},_inputPaneHiding:function(t){s(n.profilerString+"_hidingKeyboard,StartTM");e(t,"_hidingKeyboard");s(n.profilerString+"_hidingKeyboard,StopTM")},_documentScroll:function(t){s(n.profilerString+"_checkScrollPosition,StartTM");e(t,"_checkScrollPosition");s(n.profilerString+"_checkScrollPosition,StopTM")},_windowResized:function(t){s(n.profilerString+"_baseResize,StartTM");e(t,"_baseResize");s(n.profilerString+"_baseResize,StopTM")},_toggleListeners:function(r){var u,f;this._currentState!==r&&(r===n.states.on?u="addEventListener":r===n.states.off&&(u="removeEventListener"),i.Windows.UI.ViewManagement.InputPane&&(f=i.Windows.UI.ViewManagement.InputPane.getForCurrentView(),f[u]("showing",this._inputPaneShowing,!1),f[u]("hiding",this._inputPaneHiding,!1),t.document[u]("scroll",this._documentScroll,!1)),t.addEventListener("resize",this._windowResized,!1),this._currentState=r)}},{profilerString:{get:function(){return"WinJS.UI._Overlay Global Listener:"}},states:{get:function(){return{off:0,on:1}}}}),c={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get mustContainCommands(){return"Invalid HTML: AppBars/Menus must contain only AppBarCommands/MenuCommands"},get closeOverlay(){return o._getWinJSString("ui/closeOverlay").value}},u=r.Class.define(function(n,t){this._baseOverlayConstructor(n,t)},{_baseOverlayConstructor:function(n,i){var e,r;if(this._disposed=!1,n||(n=t.document.createElement("div")),e=n.winControl,e)throw new f("WinJS.UI._Overlay.DuplicateConstruction",c.duplicateConstruction);this._element||(this._element=n);this._element.hasAttribute("tabIndex")||(this._element.tabIndex=-1);this._sticky=!1;this._doNext="";this._element.style.visibility="hidden";this._element.style.opacity=0;n.winControl=this;p.addClass(this._element,b.overlayClass);p.addClass(this._element,"win-disposable");r=this._element.getAttribute("unselectable");(r===null||r===undefined)&&this._element.setAttribute("unselectable","on");this._currentAnimateIn=this._baseAnimateIn;this._currentAnimateOut=this._baseAnimateOut;this._animationPromise=a.as();this._queuedToShow=[];this._queuedToHide=[];this._queuedCommandAnimation=!1;i&&y.setOptions(this,i);u._globalEventListeners.initialize()},element:{get:function(){return this._element}},dispose:function(){this._disposed||(this._disposed=!0,this._dispose())},_dispose:function(){},_show:function(){this._baseShow()},_hide:function(){this._baseHide()},hidden:{get:function(){return this._element.style.visibility==="hidden"||this._element.winAnimating==="hiding"||this._doNext==="hide"}},addEventListener:function(n,t,i){return this._element.addEventListener(n,t,i)},removeEventListener:function(n,t,i){return this._element.removeEventListener(n,t,i)},_baseShow:function(){if(this._animating||this._needToHandleHidingKeyboard)return this._doNext="show",!1;if(this._element.style.visibility!=="visible"){this._element.winAnimating="showing";this._element.style.display="";this._element.style.visibility="hidden";this._queuedCommandAnimation&&(this._showAndHideFast(this._queuedToShow,this._queuedToHide),this._queuedToShow=[],this._queuedToHide=[]);this._sendEvent(u.beforeShow);this._findPosition();var n=this;return this._animationPromise=this._currentAnimateIn().then(function(){n._baseEndShow()},function(){n._baseEndShow()}),!0}return!1},_findPosition:function(){},_baseEndShow:function(){this._disposed||(this._element.setAttribute("aria-hidden","false"),this._element.winAnimating="",this._endShow(),this._doNext==="show"&&(this._doNext=""),this._sendEvent(u.afterShow),this._writeProfilerMark("show,StopTM"),v.schedule(this._checkDoNext,v.Priority.normal,this,"WinJS.UI._Overlay._checkDoNext"))},_endShow:function(){},_baseHide:function(){if(this._animating)return this._doNext="hide",!1;if(this._needToHandleHidingKeyboard&&(this._element.style.visibility=""),this._element.style.visibility!=="hidden"){if(this._element.winAnimating="hiding",this._element.setAttribute("aria-hidden","true"),this._sendEvent(u.beforeHide),this._element.style.visibility==="")this._element.style.opacity=0,this._baseEndHide();else{var n=this;this._animationPromise=this._currentAnimateOut().then(function(){n._baseEndHide()},function(){n._baseEndHide()})}return!0}return!1},_baseEndHide:function(){this._disposed||(this._beforeEndHide(),this._element.style.visibility="hidden",this._element.style.display="none",this._element.winAnimating="",this._queuedCommandAnimation&&(this._showAndHideFast(this._queuedToShow,this._queuedToHide),this._queuedToShow=[],this._queuedToHide=[]),this._doNext==="hide"&&(this._doNext=""),this._sendEvent(u.afterHide),this._writeProfilerMark("hide,StopTM"),v.schedule(this._checkDoNext,v.Priority.normal,this,"WinJS.UI._Overlay._checkDoNext"))},_beforeEndHide:function(){},_checkDoNext:function(){this._animating||this._needToHandleHidingKeyboard||this._disposed||(this._doNext==="hide"?(this._hide(),this._doNext=""):this._queuedCommandAnimation?this._showAndHideQueue():this._doNext==="show"&&(this._show(),this._doNext=""))},_baseAnimateIn:function(){return this._element.style.opacity=0,this._element.style.visibility="visible",t.getComputedStyle(this._element,null).opacity,h.fadeIn(this._element)},_baseAnimateOut:function(){return this._element.style.opacity=1,t.getComputedStyle(this._element,null).opacity,h.fadeOut(this._element)},_animating:{get:function(){return!!this._element.winAnimating}},_sendEvent:function(n,i){if(!this._disposed){var r=t.document.createEvent("CustomEvent");r.initEvent(n,!0,!0,i||{});this._element.dispatchEvent(r)}},_showCommands:function(n,t){var i=this._resolveCommands(n);this._showAndHideCommands(i.commands,[],t)},_hideCommands:function(n,t){var i=this._resolveCommands(n);this._showAndHideCommands([],i.commands,t)},_showOnlyCommands:function(n,t){var i=this._resolveCommands(n);this._showAndHideCommands(i.commands,i.others,t)},_showAndHideCommands:function(n,t,i){i||this.hidden&&!this._animating?(this._showAndHideFast(n,t),this._removeFromQueue(n,this._queuedToShow),this._removeFromQueue(t,this._queuedToHide)):(this._updateAnimateQueue(n,this._queuedToShow,this._queuedToHide),this._updateAnimateQueue(t,this._queuedToHide,this._queuedToShow))},_removeFromQueue:function(n,t){for(var i,r=0;r<n.length;r++)for(i=0;i<t.length;i++)if(t[i]===n[r]){t.splice(i,1);break}},_updateAnimateQueue:function(n,t,i){var u,r;if(!this._disposed){for(u=0;u<n.length;u++){for(r=0;r<t.length;r++)if(t[r]===n[u])break;for(r===t.length&&(t[r]=n[u]),r=0;r<i.length;r++)if(i[r]===n[u]){i.splice(r,1);break}}this._queuedCommandAnimation||(this._animating||v.schedule(this._checkDoNext,v.Priority.normal,this,"WinJS.UI._Overlay._checkDoNext"),this._queuedCommandAnimation=!0)}},_showAndHideFast:function(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i&&i.style&&(i.style.visibility="",i.style.display="");for(r=0;r<t.length;r++)i=t[r],i&&i.style&&(i.style.visibility="hidden",i.style.display="none");this._commandsUpdated()},_showAndHideQueue:function(){var f,u;if(this._queuedCommandAnimation=!1,this.hidden)this._showAndHideFast(this._queuedToShow,this._queuedToHide),v.schedule(this._checkDoNext,v.Priority.normal,this,"WinJS.UI._Overlay._checkDoNext");else{for(var i=this._queuedToShow,r=this._queuedToHide,e=this._findSiblings(i.concat(r)),n=0;n<i.length;n++)i[n]&&i[n].style&&t.document.body.contains(i[n])?i[n].style.visibility!=="hidden"&&i[n].style.opacity!=="0"&&(e.push(i[n]),i.splice(n,1),n--):(i.splice(n,1),n--);for(n=0;n<r.length;n++)r[n]&&r[n].style&&t.document.body.contains(r[n])&&r[n].style.visibility!=="hidden"&&r[n].style.opacity!=="0"||(r.splice(n,1),n--);f=this._baseBeginAnimateCommands(i,r,e);u=this;f?f.done(function(){u._baseEndAnimateCommands(r)},function(){u._baseEndAnimateCommands(r)}):v.schedule(function(){u._baseEndAnimateCommands([])},v.Priority.normal,null,"WinJS.UI._Overlay._endAnimateCommandsWithoutAnimation")}this._queuedToShow=[];this._queuedToHide=[]},_baseBeginAnimateCommands:function(n,i,r){var e,o,u,v,s,c,f,l;for(this._beginAnimateCommands(n,i,this._getVisibleCommands(r)),e=null,o=null,i.length>0&&(o=h.createDeleteFromListAnimation(i,n.length===0?r:undefined)),n.length>0&&(e=h.createAddToListAnimation(n,r)),u=0,v=i.length;u<v;u++)s=i[u].getBoundingClientRect(),c=t.getComputedStyle(i[u]),i[u].style.top=s.top-parseFloat(c.marginTop)+"px",i[u].style.left=s.left-parseFloat(c.marginLeft)+"px",i[u].style.opacity=0,i[u].style.position="fixed";for(this._element.winAnimating="rearranging",f=null,o&&(f=o.execute()),u=0;u<n.length;u++)n[u].style.visibility="",n[u].style.display="",n[u].style.opacity=1;return e&&(l=e.execute(),f=f?a.join([f,l]):l),f},_beginAnimateCommands:function(){},_getVisibleCommands:function(n){var r,t=n,u=[],i,f;for(t||(t=this.element.querySelectorAll(".win-command")),i=0,f=t.length;i<f;i++)r=t[i].winControl||t[i],r.hidden||u.push(r);return u},_baseEndAnimateCommands:function(n){if(!this._disposed){for(var t=0;t<n.length;t++)n[t].style.position="",n[t].style.top="",n[t].style.left="",n[t].getBoundingClientRect(),n[t].style.visibility="hidden",n[t].style.display="none",n[t].style.opacity=1;this._element.winAnimating="";this._endAnimateCommands();this._checkDoNext()}},_endAnimateCommands:function(){},_resolveCommands:function(n){var t,r,i,u,f;for(n=k(n),t={},t.commands=[],t.others=[],r=this.element.querySelectorAll(".win-command"),i=0;i<r.length;i++){for(f=!1,u=0;u<n.length;u++)if(n[u]===r[i]){t.commands.push(r[i]);n.splice(u,1);f=!0;break}f||t.others.push(r[i])}return t},_findSiblings:function(n){for(var f=[],r=this.element.querySelectorAll(".win-command"),i,u,t=0;t<r.length;t++){for(u=!1,i=0;i<n.length;i++)if(n[i]===r[t]){n.splice(i,1);u=!0;break}u||f.push(r[t])}return f},_baseResize:function(n){this._resize(n)},_hideOrDismiss:function(){var n=this._element;n&&p.hasClass(n,b.settingsFlyoutClass)?this._dismiss():n&&p.hasClass(n,b.appBarClass)?this.close():this.hide()},_resize:function(){},_commandsUpdated:function(){},_checkScrollPosition:function(){},_showingKeyboard:function(){},_hidingKeyboard:function(){},_verifyCommandsOnly:function(n,t){for(var r=n.children,u=new Array(r.length),i=0;i<r.length;i++)if(p.hasClass(r[i],"win-command")||r[i].getAttribute("data-win-control")===t)l.processAll(r[i]),u[i]=r[i].winControl;else throw new f("WinJS.UI._Overlay.MustContainCommands",c.mustContainCommands);return u},_focusOnLastFocusableElementOrThis:function(){this._focusOnLastFocusableElement()||u._trySetActive(this._element)},_focusOnLastFocusableElement:function(){var i,r,n;return this._element.firstElementChild?(i=this._element.firstElementChild.tabIndex,r=this._element.lastElementChild.tabIndex,this._element.firstElementChild.tabIndex=-1,this._element.lastElementChild.tabIndex=-1,n=p._focusLastFocusableElement(this._element),n&&u._trySelect(t.document.activeElement),this._element.firstElementChild.tabIndex=i,this._element.lastElementChild.tabIndex=r,n):!1},_focusOnFirstFocusableElementOrThis:function(){this._focusOnFirstFocusableElement()||u._trySetActive(this._element)},_focusOnFirstFocusableElement:function(n,i){var f,e,r;return this._element.firstElementChild?(f=this._element.firstElementChild.tabIndex,e=this._element.lastElementChild.tabIndex,this._element.firstElementChild.tabIndex=-1,this._element.lastElementChild.tabIndex=-1,r=p._focusFirstFocusableElement(this._element,n,i),r&&u._trySelect(t.document.activeElement),this._element.firstElementChild.tabIndex=f,this._element.lastElementChild.tabIndex=e,r):!1},_writeProfilerMark:function(n){s("WinJS.UI._Overlay:"+this._id+":"+n)}},{_isFlyoutVisible:function(){for(var i,r=t.document.querySelectorAll("."+b.flyoutClass),n=0;n<r.length;n++)if(i=r[n].winControl,i&&!i.hidden)return!0;return!1},_trySetActive:function(n,i){return!n||!t.document.body||!t.document.body.contains(n)?!1:p._setActive(n,i)?n===t.document.activeElement:!1},_trySelect:function(n){try{n&&n.select&&n.select()}catch(t){}},_sizeOfDocument:function(){return{width:t.document.documentElement.offsetWidth,height:t.document.documentElement.offsetHeight}},_getParentControlUsingClassName:function(n,i){while(n&&n!==t.document.body){if(p.hasClass(n,i))return n.winControl;n=n.parentNode}return null},_globalEventListeners:new n,_hideAppBars:function(n){var t=n.map(function(n){return n.close(),n._animationPromise});return a.join(t)},_showAppBars:function(n){var t=n.map(function(n){return n._show(),n._animationPromise});return a.join(t)},_keyboardInfo:w._KeyboardInfo,_scrollTimeout:w._KeyboardInfo._scrollTimeout,beforeShow:"beforeshow",beforeHide:"beforehide",afterShow:"aftershow",afterHide:"afterhide",commonstrings:{get cannotChangeCommandsWhenVisible(){return"Invalid argument: You must call hide() before changing {0} commands"},get cannotChangeHiddenProperty(){return"Unable to set hidden property while parent {0} is visible."}}});return r.Class.mix(u,y.DOMEventMixin),u})})}),t("WinJS/Controls/Flyout",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Log","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../_Signal","../_LightDismissService","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_KeyboardBehavior","../Utilities/_Hoverable","./_LegacyAppBar/_Constants","./Flyout/_Overlay"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{Flyout:i.Namespace._lazy(function(){function d(n,i){return parseFloat(n,t.getComputedStyle(n,null)[i])}var p=v.Key,k={get ariaLabel(){return o._getWinJSString("ui/flyoutAriaLabel").value},get noAnchor(){return"Invalid argument: Flyout anchor element not found in DOM."},get badPlacement(){return"Invalid argument: Flyout placement should be 'top' (default), 'bottom', 'left', 'right', 'auto', 'autohorizontal', or 'autovertical'."},get badAlignment(){return"Invalid argument: Flyout alignment should be 'center' (default), 'left', or 'right'."}},g=f._createEventProperty,nt=i.Class.define(function(n){this._onLightDismiss=n;this._currentlyFocusedClient=null;this._clients=[]},{shown:function(n){n._focusable=!0;var t=this._clients.indexOf(n);t===-1&&(this._clients.push(n),l.isShown(this)?(l.updated(this),this._activateTopFocusableClientIfNeeded()):l.shown(this))},hiding:function(n){var t=this._clients.indexOf(n);t!==-1&&(this._clients[t]._focusable=!1,this._activateTopFocusableClientIfNeeded())},hidden:function(n){var t=this._clients.indexOf(n);t!==-1&&(this._clients.splice(t,1),n.setZIndex(""),n.onHide(),this._clients.length===0?l.hidden(this):(l.updated(this),this._activateTopFocusableClientIfNeeded()))},clients:{get:function(){return this._clients}},_clientForElement:function(n){for(var t=this._clients.length-1;t>=0;t--)if(this._clients[t].containsElement(n))return this._clients[t];return null},_focusableClientForElement:function(n){for(var t=this._clients.length-1;t>=0;t--)if(this._clients[t]._focusable&&this._clients[t].containsElement(n))return this._clients[t];return null},_getTopmostFocusableClient:function(){for(var t,n=this._clients.length-1;n>=0;n--)if(t=this._clients[n],t&&t._focusable)return t;return null},_activateTopFocusableClientIfNeeded:function(){var n=this._getTopmostFocusableClient(),t;if(n&&l.isTopmost(this)){t=!y._keyboardSeenLast;n.onActivate(t)}},setZIndex:function(n){this._clients.forEach(function(t,i){t.setZIndex(n+i)},this)},getZIndexCount:function(){return this._clients.length},containsElement:function(n){return!!this._clientForElement(n)},onActivate:function(n){var i=this._focusableClientForElement(t.document.activeElement);!i&&this._clients.indexOf(this._currentlyFocusedClient)!==-1&&this._currentlyFocusedClient._focusable&&(i=this._currentlyFocusedClient);i||(i=this._getTopmostFocusableClient());this._currentlyFocusedClient=i;i&&i.onActivate(n)},onFocus:function(n){this._currentlyFocusedClient=this._clientForElement(n);this._currentlyFocusedClient&&this._currentlyFocusedClient.onFocus(n)},onHide:function(){this._currentlyFocusedClient=null},onShouldLightDismiss:function(n){return l.DismissalPolicies.light(n)},onLightDismiss:function(n){this._onLightDismiss(n)}}),tt=i.Class.define(function(){var n=this;this._dismissableLayer=new nt(function(t){t.reason===l.LightDismissalReasons.escape?n.collapseFlyout(n.getAt(n.length-1)):n.collapseAll()});this._cascadingStack=[];this._handleKeyDownInCascade_bound=this._handleKeyDownInCascade.bind(this);this._inputType=null},{appendFlyout:function(n){e.log&&this.indexOf(n)>=0&&e.log("_CascadeManager is attempting to append a Flyout that is already in the cascade.","winjs _CascadeManager","error");e.log&&this.reentrancyLock&&e.log("_CascadeManager is attempting to append a Flyout through reentrancy.","winjs _CascadeManager","error");var t=this.indexOfElement(n._currentAnchor);t>=0?this.collapseFlyout(this.getAt(t+1)):this.collapseAll();n.element.addEventListener("keydown",this._handleKeyDownInCascade_bound,!1);this._cascadingStack.push(n);this._dismissableLayer.shown(n._dismissable)},collapseFlyout:function(n){var i,t;if(!this.reentrancyLock&&n&&this.indexOf(n)>=0){for(this.reentrancyLock=!0,i=new c,this.unlocked=i.promise;this.length&&n!==t;)t=this._cascadingStack.pop(),t.element.removeEventListener("keydown",this._handleKeyDownInCascade_bound,!1),t._hide();this._cascadingStack.length===0&&(this._inputType=null);this.reentrancyLock=!1;this.unlocked=null;i.complete()}},flyoutHiding:function(n){this._dismissableLayer.hiding(n._dismissable)},flyoutHidden:function(n){this._dismissableLayer.hidden(n._dismissable)},collapseAll:function(){var n=this.getAt(0);n&&this.collapseFlyout(n)},indexOf:function(n){return this._cascadingStack.indexOf(n)},indexOfElement:function(n){for(var r,i=-1,t=0,u=this.length;t<u;t++)if(r=this.getAt(t),r.element.contains(n)){i=t;break}return i},length:{get:function(){return this._cascadingStack.length}},getAt:function(n){return this._cascadingStack[n]},handleFocusIntoFlyout:function(n){var t=this.indexOfElement(n.target),i;t>=0&&(i=this.getAt(t+1),this.collapseFlyout(i))},inputType:{get:function(){return this._inputType||(this._inputType=y._lastInputType),this._inputType}},dismissableLayer:{get:function(){return this._dismissableLayer}},_handleKeyDownInCascade:function(n){var u=t.getComputedStyle(n.target).direction==="rtl",f=u?p.rightArrow:p.leftArrow,e=n.target,i,r;n.keyCode===f?(i=this.indexOfElement(e),i>=1&&(r=this.getAt(i),this.collapseFlyout(r),n.preventDefault())):(n.keyCode===p.alt||n.keyCode===p.F10)&&this.collapseAll()}}),n=i.Class.derive(b._Overlay,function(n,i){var r,u,f;return i=i||{},this._element=n||t.document.createElement("div"),this._id=this._element.id||v._uniqueID(this._element),this._writeProfilerMark("constructor,StartTM"),this._baseFlyoutConstructor(this._element,i),r=this._element.getElementsByTagName("*"),u=this._addFirstDiv(),u.tabIndex=v._getLowestTabIndexInList(r),f=this._addFinalDiv(),f.tabIndex=v._getHighestTabIndexInList(r),this._element.addEventListener("keydown",this._handleKeyDown,!0),this._writeProfilerMark("constructor,StopTM"),this},{_lastMaxHeight:null,_baseFlyoutConstructor:function(n,t){var i,r,u;this._placement="auto";this._alignment="center";this._baseOverlayConstructor(n,t);this._element.style.visibilty="hidden";this._element.style.display="none";v.addClass(this._element,w.flyoutClass);i=this;this._dismissable=new l.LightDismissableElement({element:this._element,tabIndex:this._element.hasAttribute("tabIndex")?this._element.tabIndex:-1,onLightDismiss:function(){i.hide()},onActivate:function(){i._dismissable.restoreFocus()||(v.hasClass(i.element,w.menuClass)?b._Overlay._trySetActive(i._element):i._focusOnFirstFocusableElementOrThis())}});r=this._element.getAttribute("role");(r===null||r===""||r===undefined)&&(v.hasClass(this._element,w.menuClass)?this._element.setAttribute("role","menu"):this._element.setAttribute("role","dialog"));u=this._element.getAttribute("aria-label");(u===null||u===""||u===undefined)&&this._element.setAttribute("aria-label",k.ariaLabel);this._currentAnimateIn=this._flyoutAnimateIn;this._currentAnimateOut=this._flyoutAnimateOut;v._addEventListener(this.element,"focusin",this._handleFocusIn.bind(this),!1)},anchor:{get:function(){return this._anchor},set:function(n){this._anchor=n}},placement:{get:function(){return this._placement},set:function(n){if(n!=="top"&&n!=="bottom"&&n!=="left"&&n!=="right"&&n!=="auto"&&n!=="autohorizontal"&&n!=="autovertical")throw new u("WinJS.UI.Flyout.BadPlacement",k.badPlacement);this._placement=n}},alignment:{get:function(){return this._alignment},set:function(n){if(n!=="right"&&n!=="left"&&n!=="center")throw new u("WinJS.UI.Flyout.BadAlignment",k.badAlignment);this._alignment=n}},disabled:{get:function(){return!!this._element.disabled},set:function(n){n=!!n;var t=!!this._element.disabled;t!==n&&(this._element.disabled=n,!this.hidden&&this._element.disabled&&this.hide())}},onbeforeshow:g(b._Overlay.beforeShow),onaftershow:g(b._Overlay.afterShow),onbeforehide:g(b._Overlay.beforeHide),onafterhide:g(b._Overlay.afterHide),_dispose:function(){a.disposeSubTree(this.element);this._hide();n._cascadeManager.flyoutHidden(this);this.anchor=null},show:function(n,t,i){this._writeProfilerMark("show,StartTM");this._show(n,t,i)},_show:function(n,t,i){this._baseFlyoutShow(n,t,i)},hide:function(){this._writeProfilerMark("hide,StartTM");this._hide()},_hide:function(){n._cascadeManager.collapseFlyout(this);this._baseHide()&&n._cascadeManager.flyoutHiding(this)},_beforeEndHide:function(){n._cascadeManager.flyoutHidden(this)},_baseFlyoutShow:function(i,r,f){var h,s,e,o;if(!this.disabled){if(i||(i=this._anchor),r||(r=this._placement),f||(f=this._alignment),typeof i=="string"?i=t.document.getElementById(i):i&&i.element&&(i=i.element),i)this._currentAnchor=i,this._currentPlacement=r,this._currentAlignment=f;else{if(!this._reuseCurrent)throw new u("WinJS.UI.Flyout.NoAnchor",k.noAnchor);this._reuseCurrent=null}this._element.winAnimating?(this._reuseCurrent=!0,this._doNext="show"):n._cascadeManager.reentrancyLock?(this._reuseCurrent=!0,this._doNext="show",h=this,n._cascadeManager.unlocked.then(function(){h._checkDoNext()})):this._baseShow()&&(v.hasClass(this.element,"win-menu")||(s=this._element.getElementsByTagName("*"),e=this.element.querySelectorAll(".win-first"),this.element.children.length&&!v.hasClass(this.element.children[0],w.firstDivClass)&&(e&&e.length>0&&e.item(0).parentNode.removeChild(e.item(0)),e=this._addFirstDiv()),e.tabIndex=v._getLowestTabIndexInList(s),o=this.element.querySelectorAll(".win-final"),v.hasClass(this.element.children[this.element.children.length-1],w.finalDivClass)||(o&&o.length>0&&o.item(0).parentNode.removeChild(o.item(0)),o=this._addFinalDiv()),o.tabIndex=v._getHighestTabIndexInList(s)),n._cascadeManager.appendFlyout(this))}},_lightDismiss:function(){n._cascadeManager.collapseAll()},_findPosition:function(){this._nextHeight=null;this._keyboardMovedUs=!1;this._hasScrolls=!1;this._keyboardSquishedUs=0;this._checkMenuCommands&&this._checkMenuCommands();this._updateAdjustments(this._currentAlignment);this._getTopLeft();this._scrollTop=this._nextTop-b._Overlay._keyboardInfo._visibleDocTop;this._nextTop<0?(this._element.style.bottom="0px",this._element.style.top="auto"):(this._element.style.top=this._nextTop+"px",this._element.style.bottom="auto");this._nextLeft<0?(this._element.style.right="0px",this._element.style.left="auto"):(this._element.style.left=this._nextLeft+"px",this._element.style.right="auto");this._nextHeight!==null&&(v.addClass(this._element,w.scrollsClass),this._lastMaxHeight=this._element.style.maxHeight,this._element.style.maxHeight=this._nextHeight+"px",this._nextBottom=this._nextTop+this._nextHeight,this._hasScrolls=!0);b._Overlay._keyboardInfo._visible&&(this._checkKeyboardFit(),this._keyboardMovedUs&&this._adjustForKeyboard())},_getTopLeft:function(){var i,t={},n={};try{i=this._currentAnchor.getBoundingClientRect()}catch(r){throw new u("WinJS.UI.Flyout.NoAnchor",k.noAnchor);}n.top=i.top;n.bottom=i.bottom;n.left=i.left;n.right=i.right;n.height=n.bottom-n.top;n.width=n.right-n.left;t.marginTop=d(this._element,"marginTop");t.marginBottom=d(this._element,"marginBottom");t.marginLeft=d(this._element,"marginLeft");t.marginRight=d(this._element,"marginRight");t.width=v.getTotalWidth(this._element);t.height=v.getTotalHeight(this._element);t.innerWidth=v.getContentWidth(this._element);t.innerHeight=v.getContentHeight(this._element);this._nextMarginPadding=t.height-t.innerHeight;switch(this._currentPlacement){case"top":this._fitTop(n,t)||(this._nextTop=b._Overlay._keyboardInfo._visibleDocTop,this._nextHeight=n.top-b._Overlay._keyboardInfo._visibleDocTop-this._nextMarginPadding);this._centerHorizontally(n,t,this._currentAlignment);break;case"bottom":this._fitBottom(n,t)||(this._nextTop=-1,this._nextHeight=b._Overlay._keyboardInfo._visibleDocHeight-(n.bottom-b._Overlay._keyboardInfo._visibleDocTop)-this._nextMarginPadding);this._centerHorizontally(n,t,this._currentAlignment);break;case"left":this._fitLeft(n,t)||(this._nextLeft=0);this._centerVertically(n,t);break;case"right":this._fitRight(n,t)||(this._nextLeft=-1);this._centerVertically(n,t);break;case"autovertical":this._fitTop(n,t)||this._fitBottom(n,t)||this._configureVerticalWithScroll(n);this._centerHorizontally(n,t,this._currentAlignment);break;case"autohorizontal":this._fitLeft(n,t)||this._fitRight(n,t)||(this._nextLeft=-1);this._centerVertically(n,t);break;case"auto":this._sometimesFitsAbove(n,t)?(this._fitTop(n,t)||this._fitBottom(n,t),this._centerHorizontally(n,t,this._currentAlignment)):this._fitLeft(n,t)||this._fitRight(n,t)?this._centerVertically(n,t):(this._configureVerticalWithScroll(n),this._centerHorizontally(n,t,this._currentAlignment));break;default:throw new u("WinJS.UI.Flyout.BadPlacement",k.badPlacement);}this._nextBottom=this._nextTop+t.height},_configureVerticalWithScroll:function(n){this._topHasMoreRoom(n)?(this._nextTop=b._Overlay._keyboardInfo._visibleDocTop,this._nextHeight=n.top-b._Overlay._keyboardInfo._visibleDocTop-this._nextMarginPadding):(this._nextTop=-1,this._nextHeight=b._Overlay._keyboardInfo._visibleDocHeight-(n.bottom-b._Overlay._keyboardInfo._visibleDocTop)-this._nextMarginPadding)},_sometimesFitsAbove:function(n,t){return(b._Overlay._keyboardInfo._visibleDocHeight-n.height)/2>=t.height},_topHasMoreRoom:function(n){return n.top>b._Overlay._keyboardInfo._visibleDocHeight-n.bottom},_fitTop:function(n,t){return this._nextTop=n.top-t.height,this._nextAnimOffset={top:"50px",left:"0px",keyframe:"WinJS-showFlyoutTop"},this._nextTop>=b._Overlay._keyboardInfo._visibleDocTop&&this._nextTop+t.height<=b._Overlay._keyboardInfo._visibleDocBottom},_fitBottom:function(n,t){return this._nextTop=n.bottom,this._nextAnimOffset={top:"-50px",left:"0px",keyframe:"WinJS-showFlyoutBottom"},this._nextTop>=b._Overlay._keyboardInfo._visibleDocTop&&this._nextTop+t.height<=b._Overlay._keyboardInfo._visibleDocBottom},_fitLeft:function(n,t){return this._nextLeft=n.left-t.width,this._nextAnimOffset={top:"0px",left:"50px",keyframe:"WinJS-showFlyoutLeft"},this._nextLeft>=0&&this._nextLeft+t.width<=b._Overlay._keyboardInfo._visualViewportWidth},_fitRight:function(n,t){return this._nextLeft=n.right,this._nextAnimOffset={top:"0px",left:"-50px",keyframe:"WinJS-showFlyoutRight"},this._nextLeft>=0&&this._nextLeft+t.width<=b._Overlay._keyboardInfo._visualViewportWidth},_centerVertically:function(n,t){this._nextTop=n.top+n.height/2-t.height/2;this._nextTop<b._Overlay._keyboardInfo._visibleDocTop?this._nextTop=b._Overlay._keyboardInfo._visibleDocTop:this._nextTop+t.height>=b._Overlay._keyboardInfo._visibleDocBottom&&(this._nextTop=-1)},_centerHorizontally:function(n,i,r){if(r==="center")this._nextLeft=n.left+n.width/2-i.width/2;else if(r==="left")this._nextLeft=n.left;else if(r==="right")this._nextLeft=n.right-i.width;else throw new u("WinJS.UI.Flyout.BadAlignment",k.badAlignment);this._nextLeft<0?this._nextLeft=0:this._nextLeft+i.width>=t.document.documentElement.clientWidth&&(this._nextLeft=-1)},_updateAdjustments:function(n){this._element.style.top="0px";this._element.style.bottom="auto";this._element.style.left="0px";this._element.style.right="auto";v.removeClass(this._element,w.scrollsClass);this._lastMaxHeight!==null&&(this._element.style.maxHeight=this._lastMaxHeight,this._lastMaxHeight=null);n==="center"?(v.removeClass(this._element,"win-leftalign"),v.removeClass(this._element,"win-rightalign")):n==="left"?(v.addClass(this._element,"win-leftalign"),v.removeClass(this._element,"win-rightalign")):n==="right"&&(v.addClass(this._element,"win-rightalign"),v.removeClass(this._element,"win-leftalign"))},_showingKeyboard:function(n){if(!this.hidden&&(n.ensuredFocusedElementInView=!0,this._checkKeyboardFit(),this._keyboardMovedUs)){this._element.style.opacity=0;var i=this;t.setTimeout(function(){i._adjustForKeyboard();i._baseAnimateIn()},b._Overlay._keyboardInfo._animationShowLength)}},_resize:function(){if((!this.hidden||this._animating)&&this._needToHandleHidingKeyboard){var n=this;r._setImmediate(function(){(!n.hidden||n._animating)&&n._findPosition()});this._needToHandleHidingKeyboard=!1}},_checkKeyboardFit:function(){var t=v.getTotalHeight(this._element),n=b._Overlay._keyboardInfo._visibleDocHeight-this._nextMarginPadding;t>n?(this._keyboardMovedUs=!0,this._scrollTop=0,this._keyboardSquishedUs=n):this._nextTop===-1?this._keyboardMovedUs=!0:this._nextTop<b._Overlay._keyboardInfo._visibleDocTop?(this._scrollTop=0,this._keyboardMovedUs=!0):this._nextBottom>b._Overlay._keyboardInfo._visibleDocBottom&&(this._scrollTop=-1,this._keyboardMovedUs=!0)},_adjustForKeyboard:function(){this._keyboardSquishedUs&&(this._hasScrolls||(v.addClass(this._element,w.scrollsClass),this._lastMaxHeight=this._element.style.maxHeight),this._element.style.maxHeight=this._keyboardSquishedUs+"px");this._checkScrollPosition(!0)},_hidingKeyboard:function(){if(!this.hidden||this._animating)if(b._Overlay._keyboardInfo._isResized)this._needToHandleHidingKeyboard=!0;else{var n=this;r._setImmediate(function(){(!n.hidden||n._animating)&&n._findPosition()})}},_checkScrollPosition:function(n){(!this.hidden||n)&&(this._scrollTop<0?(this._element.style.bottom=b._Overlay._keyboardInfo._visibleDocBottomOffset+"px",this._element.style.top="auto"):(this._element.style.top=b._Overlay._keyboardInfo._visibleDocTop+"px",this._element.style.bottom="auto"))},_flyoutAnimateIn:function(){return this._keyboardMovedUs?this._baseAnimateIn():(this._element.style.opacity=1,this._element.style.visibility="visible",h.showPopup(this._element,this._nextAnimOffset))},_flyoutAnimateOut:function(){return this._keyboardMovedUs?this._baseAnimateOut():(this._element.style.opacity=0,h.hidePopup(this._element,this._nextAnimOffset))},_hideAllOtherFlyouts:function(n){for(var i,u=t.document.querySelectorAll("."+w.flyoutClass),r=0;r<u.length;r++)i=u[r].winControl,i&&!i.hidden&&i!==n&&i.hide()},_handleKeyDown:function(n){(n.keyCode===p.space||n.keyCode===p.enter)&&this===t.document.activeElement?(n.preventDefault(),n.stopPropagation(),this.winControl.hide()):!n.shiftKey||n.keyCode!==p.tab||this!==t.document.activeElement||n.altKey||n.ctrlKey||n.metaKey||(n.preventDefault(),n.stopPropagation(),this.winControl._focusOnLastFocusableElementOrThis())},_handleFocusIn:function(t){this.element.contains(t.relatedTarget)||n._cascadeManager.handleFocusIntoFlyout(t)},_addFirstDiv:function(){var n=t.document.createElement("div"),i;return n.className=w.firstDivClass,n.style.display="inline",n.setAttribute("role","menuitem"),n.setAttribute("aria-hidden","true"),this._element.children[0]?this._element.insertBefore(n,this._element.children[0]):this._element.appendChild(n),i=this,v._addEventListener(n,"focusin",function(){i._focusOnLastFocusableElementOrThis()},!1),n},_addFinalDiv:function(){var n=t.document.createElement("div"),i;return n.className=w.finalDivClass,n.style.display="inline",n.setAttribute("role","menuitem"),n.setAttribute("aria-hidden","true"),this._element.appendChild(n),i=this,v._addEventListener(n,"focusin",function(){i._focusOnFirstFocusableElementOrThis()},!1),n},_writeProfilerMark:function(n){s("WinJS.UI.Flyout:"+this._id+":"+n)}},{_cascadeManager:new tt});return n})})}),t("WinJS/Controls/CommandingSurface/_Constants",["require","exports"],function(n,t){t.ClassNames={controlCssClass:"win-commandingsurface",disposableCssClass:"win-disposable",actionAreaCssClass:"win-commandingsurface-actionarea",actionAreaContainerCssClass:"win-commandingsurface-actionareacontainer",overflowButtonCssClass:"win-commandingsurface-overflowbutton",spacerCssClass:"win-commandingsurface-spacer",ellipsisCssClass:"win-commandingsurface-ellipsis",overflowAreaCssClass:"win-commandingsurface-overflowarea",overflowAreaContainerCssClass:"win-commandingsurface-overflowareacontainer",contentFlyoutCssClass:"win-commandingsurface-contentflyout",emptyCommandingSurfaceCssClass:"win-commandingsurface-empty",menuCssClass:"win-menu",menuContainsToggleCommandClass:"win-menu-containstogglecommand",openedClass:"win-commandingsurface-opened",closingClass:"win-commandingsurface-closing",closedClass:"win-commandingsurface-closed",noneClass:"win-commandingsurface-closeddisplaynone",minimalClass:"win-commandingsurface-closeddisplayminimal",compactClass:"win-commandingsurface-closeddisplaycompact",fullClass:"win-commandingsurface-closeddisplayfull",overflowTopClass:"win-commandingsurface-overflowtop",overflowBottomClass:"win-commandingsurface-overflowbottom"};t.EventNames={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"};t.actionAreaCommandWidth=68;t.actionAreaSeparatorWidth=34;t.actionAreaOverflowButtonWidth=32;t.overflowCommandHeight=44;t.overflowSeparatorHeight=12;t.controlMinWidth=t.actionAreaOverflowButtonWidth;t.overflowAreaMaxWidth=480;t.heightOfMinimal=24;t.heightOfCompact=48;t.contentMenuCommandDefaultLabel="Custom content";t.defaultClosedDisplayMode="compact";t.defaultOpened=!1;t.defaultOverflowDirection="bottom";t.typeSeparator="separator";t.typeContent="content";t.typeButton="button";t.typeToggle="toggle";t.typeFlyout="flyout";t.commandSelector=".win-command";t.primaryCommandSection="primary";t.secondaryCommandSection="secondary"}),t("WinJS/Controls/ToolBar/_Constants",["require","exports","../CommandingSurface/_Constants"],function(n,t,i){t.ClassNames={controlCssClass:"win-toolbar",disposableCssClass:"win-disposable",actionAreaCssClass:"win-toolbar-actionarea",overflowButtonCssClass:"win-toolbar-overflowbutton",spacerCssClass:"win-toolbar-spacer",ellipsisCssClass:"win-toolbar-ellipsis",overflowAreaCssClass:"win-toolbar-overflowarea",contentFlyoutCssClass:"win-toolbar-contentflyout",emptytoolbarCssClass:"win-toolbar-empty",menuCssClass:"win-menu",menuContainsToggleCommandClass:"win-menu-containstogglecommand",openedClass:"win-toolbar-opened",closedClass:"win-toolbar-closed",compactClass:"win-toolbar-closeddisplaycompact",fullClass:"win-toolbar-closeddisplayfull",overflowTopClass:"win-toolbar-overflowtop",overflowBottomClass:"win-toolbar-overflowbottom",placeHolderCssClass:"win-toolbar-placeholder"};t.EventNames={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"};t.OverflowDirection={top:"top",bottom:"bottom"};t.overflowAreaMaxWidth=i.overflowAreaMaxWidth;t.controlMinWidth=i.controlMinWidth;t.defaultClosedDisplayMode="compact";t.defaultOpened=!1;t.typeSeparator="separator";t.typeContent="content";t.typeButton="button";t.typeToggle="toggle";t.typeFlyout="flyout";t.commandSelector=".win-command";t.primaryCommandSection="primary";t.secondaryCommandSection="secondary"}),t("WinJS/Controls/AppBar/_Icon",["exports","../../Core/_Base","../../Core/_Resources"],function(n,t,i){"use strict";var r=["previous","next","play","pause","edit","save","clear","delete","remove","add","cancel","accept","more","redo","undo","home","up","forward","right","back","left","favorite","camera","settings","video","sync","download","mail","find","help","upload","emoji","twopage","leavechat","mailforward","clock","send","crop","rotatecamera","people","closepane","openpane","world","flag","previewlink","globe","trim","attachcamera","zoomin","bookmarks","document","protecteddocument","page","bullets","comment","mail2","contactinfo","hangup","viewall","mappin","phone","videochat","switch","contact","rename","pin","musicinfo","go","keyboard","dockleft","dockright","dockbottom","remote","refresh","rotate","shuffle","list","shop","selectall","orientation","import","importall","browsephotos","webcam","pictures","savelocal","caption","stop","showresults","volume","repair","message","page2","calendarday","calendarweek","calendar","characters","mailreplyall","read","link","accounts","showbcc","hidebcc","cut","attach","paste","filter","copy","emoji2","important","mailreply","slideshow","sort","manage","allapps","disconnectdrive","mapdrive","newwindow","openwith","contactpresence","priority","uploadskydrive","gototoday","font","fontcolor","contact2","folder","audio","placeholder","view","setlockscreen","settile","cc","stopslideshow","permissions","highlight","disableupdates","unfavorite","unpin","openlocal","mute","italic","underline","bold","movetofolder","likedislike","dislike","like","alignright","aligncenter","alignleft","zoom","zoomout","openfile","otheruser","admin","street","map","clearselection","fontdecrease","fontincrease","fontsize","cellphone","reshare","tag","repeatone","repeatall","outlinestar","solidstar","calculator","directions","target","library","phonebook","memo","microphone","postupdate","backtowindow","fullscreen","newfolder","calendarreply","unsyncfolder","reporthacked","syncfolder","blockcontact","switchapps","addfriend","touchpointer","gotostart","zerobars","onebar","twobars","threebars","fourbars","scan","preview","hamburger"].reduce(function(n,t){return n[t]={get:function(){return i._getWinJSString("ui/appBarIcons/"+t).value}},n},{});t.Namespace._moduleDefine(n,"WinJS.UI.AppBarIcon",r)}),t("WinJS/Controls/AppBar/_Command",["exports","../../Core/_Global","../../Core/_WinRT","../../Core/_Base","../../Core/_ErrorFromName","../../Core/_Resources","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../Flyout/_Overlay","../Tooltip","../_LegacyAppBar/_Constants","./_Icon"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";r.Namespace._moduleDefine(n,"WinJS.UI",{AppBarCommand:r.Namespace._lazy(function(){function v(n){var r=this.winControl,i;if(r&&(r._type===l.typeToggle?r.selected=!r.selected:r._type===l.typeFlyout&&r._flyout&&(i=r._flyout,typeof i=="string"&&(i=t.document.getElementById(i)),i.show||(i=i.winControl),i&&i.show&&i.show(this,"autovertical")),r.onclick))r.onclick(n)}var n={get ariaLabel(){return f._getWinJSString("ui/appBarCommandAriaLabel").value},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get badClick(){return"Invalid argument: The onclick property for an {0} must be a function"},get badDivElement(){return"Invalid argument: For a content command, the element must be null or a div element"},get badHrElement(){return"Invalid argument: For a separator, the element must be null or an hr element"},get badButtonElement(){return"Invalid argument: For a button, toggle, or flyout command, the element must be null or a button element"},get badPriority(){return"Invalid argument: the priority of an {0} must be a non-negative integer"}};return r.Class.define(function(t,i){var r,f;if(t&&t.winControl)throw new u("WinJS.UI.AppBarCommand.DuplicateConstruction",n.duplicateConstruction);this._disposed=!1;i||(i={});i.type||(this._type=l.typeButton);i.section=i.section||l.sectionPrimary;this._element=t;i.type===l.typeContent?this._createContent():i.type===l.typeSeparator?this._createSeparator():this._createButton();s.addClass(this._element,"win-disposable");this._element.winControl=this;s.addClass(this._element,l.appBarCommandClass);i.onclick&&(this.onclick=i.onclick);i.onclick=v;e.setOptions(this,i);this._type!==l.typeToggle||i.selected||(this.selected=!1);this._type!==l.typeSeparator&&(r=this._element.getAttribute("role"),(r===null||r===""||r===undefined)&&(r=this._type===l.typeToggle?"menuitemcheckbox":this._type===l.typeContent?"group":"menuitem",this._element.setAttribute("role",r),this._type===l.typeFlyout&&this._element.setAttribute("aria-haspopup",!0)),f=this._element.getAttribute("aria-label"),(f===null||f===""||f===undefined)&&this._element.setAttribute("aria-label",n.ariaLabel))},{id:{get:function(){return this._element.id},set:function(n){n&&!this._element.id&&(this._element.id=n)}},type:{get:function(){return this._type},set:function(n){this._type||(this._type=n!==l.typeContent&&n!==l.typeFlyout&&n!==l.typeToggle&&n!==l.typeSeparator?l.typeButton:n)}},label:{get:function(){return this._label},set:function(n){this._label=n;this._labelSpan&&(this._labelSpan.textContent=this.label);!this.tooltip&&this._tooltipControl&&(this._tooltip=this.label,this._tooltipControl.innerHTML=this.label);this._element.setAttribute("aria-label",this.label);this._testIdenticalTooltip()}},icon:{get:function(){return this._icon},set:function(n){this._icon=a[n]||n;this._imageSpan&&(this._icon&&this._icon.length===1?(this._imageSpan.textContent=this._icon,this._imageSpan.style.backgroundImage="",this._imageSpan.style.msHighContrastAdjust="",s.addClass(this._imageSpan,"win-commandglyph")):(this._imageSpan.textContent="",this._imageSpan.style.backgroundImage=this._icon,this._imageSpan.style.msHighContrastAdjust="none",s.removeClass(this._imageSpan,"win-commandglyph")))}},onclick:{get:function(){return this._onclick},set:function(t){if(t&&typeof t!="function")throw new u("WinJS.UI.AppBarCommand.BadClick",f._formatString(n.badClick,"AppBarCommand"));this._onclick=t}},priority:{get:function(){return this._priority},set:function(t){if(t===undefined||typeof t=="number"&&t>=0)this._priority=t;else throw new u("WinJS.UI.AppBarCommand.BadPriority",f._formatString(n.badPriority,"AppBarCommand"));}},flyout:{get:function(){var n=this._flyout;return typeof n=="string"&&(n=t.document.getElementById(n)),n&&!n.element&&n.winControl&&(n=n.winControl),n},set:function(n){var t=n;t&&typeof t!="string"&&(t.element&&(t=t.element),t&&(t.id?t=t.id:(t.id=s._uniqueID(t),t=t.id)));typeof t=="string"&&this._element.setAttribute("aria-owns",t);this._flyout=n}},section:{get:function(){return this._section},set:function(n){(!this._section||i.Windows.ApplicationModel.DesignMode.designModeEnabled)&&this._setSection(n)}},tooltip:{get:function(){return this._tooltip},set:function(n){this._tooltip=n;this._tooltipControl&&(this._tooltipControl.innerHTML=this._tooltip);this._testIdenticalTooltip()}},selected:{get:function(){return this._element.getAttribute("aria-checked")==="true"},set:function(n){this._element.setAttribute("aria-checked",n)}},element:{get:function(){return this._element}},disabled:{get:function(){return!!this._element.disabled},set:function(n){this._element.disabled=n}},hidden:{get:function(){return this._element.style.visibility==="hidden"},set:function(n){if(n!==this.hidden){var t=this._element.style,i=t.visibility,r=t.display;n?(t.visibility="hidden",t.display="none"):(t.visibility="",t.display="inline-block");this._sendEvent(l.commandVisibilityChanged)||(t.visibility=i,t.display=r)}}},firstElementFocus:{get:function(){return this._firstElementFocus||this._lastElementFocus||this._element},set:function(n){this._firstElementFocus=n===this.element?null:n;this._updateTabStop()}},lastElementFocus:{get:function(){return this._lastElementFocus||this._firstElementFocus||this._element},set:function(n){this._lastElementFocus=n===this.element?null:n;this._updateTabStop()}},dispose:function(){this._disposed||(this._disposed=!0,this._tooltipControl&&this._tooltipControl.dispose(),this._type===l.typeContent&&o.disposeSubTree(this.element))},addEventListener:function(n,t,i){return this._element.addEventListener(n,t,i)},removeEventListener:function(n,t,i){return this._element.removeEventListener(n,t,i)},extraClass:{get:function(){return this._extraClass},set:function(n){this._extraClass&&s.removeClass(this._element,this._extraClass);this._extraClass=n;s.addClass(this._element,this._extraClass)}},_testIdenticalTooltip:function(){this._hideIfFullSize=this._label===this._tooltip},_createContent:function(){if(this._element){if(this._element.tagName!=="DIV")throw new u("WinJS.UI.AppBarCommand.BadDivElement",n.badDivElement);}else this._element=t.document.createElement("div");parseInt(this._element.getAttribute("tabIndex"),10)!==this._element.tabIndex&&(this._element.tabIndex=0)},_createSeparator:function(){if(this._element){if(this._element.tagName!=="HR")throw new u("WinJS.UI.AppBarCommand.BadHrElement",n.badHrElement);}else this._element=t.document.createElement("hr")},_createButton:function(){var i,r;if(this._element){if(this._element.tagName!=="BUTTON")throw new u("WinJS.UI.AppBarCommand.BadButtonElement",n.badButtonElement);i=this._element.getAttribute("type");(i===null||i===""||i===undefined)&&this._element.setAttribute("type","button");this._element.innerHTML=""}else this._element=t.document.createElement("button");this._element.type="button";this._iconSpan=t.document.createElement("span");this._iconSpan.setAttribute("aria-hidden","true");this._iconSpan.className="win-commandicon";this._iconSpan.tabIndex=-1;this._element.appendChild(this._iconSpan);this._imageSpan=t.document.createElement("span");this._imageSpan.setAttribute("aria-hidden","true");this._imageSpan.className="win-commandimage";this._imageSpan.tabIndex=-1;this._iconSpan.appendChild(this._imageSpan);this._labelSpan=t.document.createElement("span");this._labelSpan.setAttribute("aria-hidden","true");this._labelSpan.className="win-label";this._labelSpan.tabIndex=-1;this._element.appendChild(this._labelSpan);this._tooltipControl=new c.Tooltip(this._element);r=this;this._tooltipControl.addEventListener("beforeopen",function(){r._hideIfFullSize&&!h._Overlay._getParentControlUsingClassName(r._element.parentElement,l.reducedClass)&&r._tooltipControl.close()},!1)},_setSection:function(n){n||(n=l.sectionPrimary);this._section&&(this._section===l.sectionGlobal?s.removeClass(this._element,l.appBarCommandGlobalClass):this.section===l.sectionSelection&&s.removeClass(this._element,l.appBarCommandSelectionClass));this._section=n;n===l.sectionGlobal?s.addClass(this._element,l.appBarCommandGlobalClass):n===l.sectionSelection&&s.addClass(this._element,l.appBarCommandSelectionClass)},_updateTabStop:function(){this.element.tabIndex=this._firstElementFocus||this._lastElementFocus?-1:0},_isFocusable:function(){return!this.hidden&&this._type!==l.typeSeparator&&!this.element.disabled&&(this.firstElementFocus.tabIndex>=0||this.lastElementFocus.tabIndex>=0)},_sendEvent:function(n,i){if(!this._disposed){var r=t.document.createEvent("CustomEvent");return r.initEvent(n,!0,!0,i||{}),this._element.dispatchEvent(r)}}})})});r.Namespace._moduleDefine(n,"WinJS.UI",{Command:r.Namespace._lazy(function(){return n.AppBarCommand})})}),t("WinJS/Controls/Menu/_Command",["exports","../../Core/_Global","../../Core/_Base","../../Core/_ErrorFromName","../../Core/_Resources","../../Promise","../../Utilities/_Control","../../Utilities/_ElementUtilities","../_LegacyAppBar/_Constants","../Flyout/_Overlay"],function(n,t,i,r,u,f,e,o,s,h){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{MenuCommand:i.Namespace._lazy(function(){var n={get ariaLabel(){return u._getWinJSString("ui/menuCommandAriaLabel").value},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get badClick(){return"Invalid argument: The onclick property for an {0} must be a function"},get badHrElement(){return"Invalid argument: For a separator, the element must be null or an hr element"},get badButtonElement(){return"Invalid argument: For a button, toggle, or flyout command, the element must be null or a button element"}},c=i.Class.define(function(t,i){var u,f;if(t&&t.winControl)throw new r("WinJS.UI.MenuCommand.DuplicateConstruction",n.duplicateConstruction);this._disposed=!1;i||(i={});i.type||(this._type=s.typeButton);this._element=t;i.type===s.typeSeparator?this._createSeparator():this._createButton();o.addClass(this._element,"win-disposable");this._element.winControl=this;o.addClass(this._element,s.menuCommandClass);i.selected||i.type!==s.typeToggle||(this.selected=!1);i.onclick&&(this.onclick=i.onclick);i.onclick=this._handleClick.bind(this);e.setOptions(this,i);this._type!==s.typeSeparator&&(u=this._element.getAttribute("role"),(u===null||u===""||u===undefined)&&(u="menuitem",this._type===s.typeToggle&&(u="menuitemcheckbox"),this._element.setAttribute("role",u),this._type===s.typeFlyout&&this._element.setAttribute("aria-haspopup",!0)),f=this._element.getAttribute("aria-label"),(f===null||f===""||f===undefined)&&this._element.setAttribute("aria-label",n.ariaLabel))},{id:{get:function(){return this._element.id},set:function(n){this._element.id||(this._element.id=n)}},type:{get:function(){return this._type},set:function(n){this._type||(n!==s.typeButton&&n!==s.typeFlyout&&n!==s.typeToggle&&n!==s.typeSeparator&&(n=s.typeButton),this._type=n,n===s.typeButton?o.addClass(this.element,s.menuCommandButtonClass):n===s.typeFlyout?(o.addClass(this.element,s.menuCommandFlyoutClass),this.element.addEventListener("keydown",this._handleKeyDown.bind(this),!1)):n===s.typeSeparator?o.addClass(this.element,s.menuCommandSeparatorClass):n===s.typeToggle&&o.addClass(this.element,s.menuCommandToggleClass))}},label:{get:function(){return this._label},set:function(n){this._label=n||"";this._labelSpan&&(this._labelSpan.textContent=this.label);this._element.setAttribute("aria-label",this.label)}},onclick:{get:function(){return this._onclick},set:function(t){if(t&&typeof t!="function")throw new r("WinJS.UI.MenuCommand.BadClick",u._formatString(n.badClick,"MenuCommand"));this._onclick=t}},flyout:{get:function(){var n=this._flyout;return typeof n=="string"&&(n=t.document.getElementById(n)),n&&!n.element&&(n=n.winControl),n},set:function(n){var t=n;t&&typeof t!="string"&&(t.element&&(t=t.element),t&&(t.id?t=t.id:(t.id=o._uniqueID(t),t=t.id)));typeof t=="string"&&this._element.setAttribute("aria-owns",t);this._flyout!==n&&c._deactivateFlyoutCommand(this);this._flyout=n}},selected:{get:function(){return this._element.getAttribute("aria-checked")==="true"},set:function(n){this._element.setAttribute("aria-checked",!!n)}},element:{get:function(){return this._element}},disabled:{get:function(){return!!this._element.disabled},set:function(n){n=!!n;n&&this.type===s.typeFlyout&&c._deactivateFlyoutCommand(this);this._element.disabled=n}},hidden:{get:function(){return this._element.style.visibility==="hidden"},set:function(n){var i=h._Overlay._getParentControlUsingClassName(this._element,s.menuClass),t;if(i&&!i.hidden)throw new r("WinJS.UI.MenuCommand.CannotChangeHiddenProperty",u._formatString(h._Overlay.commonstrings.cannotChangeHiddenProperty,"Menu"));t=this._element.style;n?(this.type===s.typeFlyout&&c._deactivateFlyoutCommand(this),t.visibility="hidden",t.display="none"):(t.visibility="",t.display="block")}},extraClass:{get:function(){return this._extraClass},set:function(n){this._extraClass&&o.removeClass(this._element,this._extraClass);this._extraClass=n;o.addClass(this._element,this._extraClass)}},dispose:function(){this._disposed||(this._disposed=!0,this._flyout&&this._flyout.dispose())},addEventListener:function(n,t,i){return this._element.addEventListener(n,t,i)},removeEventListener:function(n,t,i){return this._element.removeEventListener(n,t,i)},_createSeparator:function(){if(this._element){if(this._element.tagName!=="HR")throw new r("WinJS.UI.MenuCommand.BadHrElement",n.badHrElement);}else this._element=t.document.createElement("hr")},_createButton:function(){if(this._element){if(this._element.tagName!=="BUTTON")throw new r("WinJS.UI.MenuCommand.BadButtonElement",n.badButtonElement);}else this._element=t.document.createElement("button");this._element.innerHTML='<div class="win-menucommand-liner"><span class="win-toggleicon" aria-hidden="true"><\/span><span class="win-label" aria-hidden="true"><\/span><span class="win-flyouticon" aria-hidden="true"><\/span><\/div>';this._element.type="button";this._menuCommandLiner=this._element.firstElementChild;this._toggleSpan=this._menuCommandLiner.firstElementChild;this._labelSpan=this._toggleSpan.nextElementSibling;this._flyoutSpan=this._labelSpan.nextElementSibling},_sendEvent:function(n,i){if(!this._disposed){var r=t.document.createEvent("CustomEvent");r.initCustomEvent(n,!0,!0,i||{});this._element.dispatchEvent(r)}},_invoke:function(n){if(!this.hidden&&!this.disabled&&!this._disposed){if(this._type===s.typeToggle?this.selected=!this.selected:this._type===s.typeFlyout&&c._activateFlyoutCommand(this),n&&n.type==="click"&&this.onclick)this.onclick(n);this._sendEvent(s._menuCommandInvokedEvent,{command:this})}},_handleClick:function(n){this._invoke(n)},_handleKeyDown:function(n){var i=o.Key,r=t.getComputedStyle(this.element).direction==="rtl",u=r?i.leftArrow:i.rightArrow;n.keyCode===u&&this.type===s.typeFlyout&&(this._invoke(n),n.preventDefault())}},{_activateFlyoutCommand:function(n){return new f(function(t,i){n=n.winControl||n;var r=n.flyout;r&&r.hidden&&r.show?(o.addClass(n.element,s.menuCommandFlyoutActivatedClass),r.addEventListener("beforehide",function u(){r.removeEventListener("beforehide",u,!1);o.removeClass(n.element,s.menuCommandFlyoutActivatedClass)},!1),r.addEventListener("aftershow",function f(){r.removeEventListener("aftershow",f,!1);t()},!1),r.show(n,"right")):i()})},_deactivateFlyoutCommand:function(n){return new f(function(t){n=n.winControl||n;o.removeClass(n.element,s.menuCommandFlyoutActivatedClass);var i=n.flyout;i&&!i.hidden&&i.hide?(i.addEventListener("afterhide",function r(){i.removeEventListener("afterhide",r,!1);t()},!1),i.hide()):t()})}});return c})})}),r=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},t("WinJS/Controls/CommandingSurface/_MenuCommand",["require","exports","../Menu/_Command"],function(n,t,i){var u=function(n){function t(t,i){i&&i.beforeInvoke&&(this._beforeInvoke=i.beforeInvoke);n.call(this,t,i)}return r(t,n),t.prototype._invoke=function(t){this._beforeInvoke&&this._beforeInvoke(t);n.prototype._invoke.call(this,t)},t}(i.MenuCommand);t._MenuCommand=u}),t("WinJS/Utilities/_OpenCloseMachine",["require","exports","../Core/_Global","../Promise","../_Signal"],function(n,t,i,r,u){"use strict";function c(n){return r._cancelBlocker(n,function(){n.cancel()})}function f(){}function e(n,t){n._interruptibleWorkPromises=n._interruptibleWorkPromises||[];var i=new u;n._interruptibleWorkPromises.push(t(i.promise));i.complete()}function o(){(this._interruptibleWorkPromises||[]).forEach(function(n){n.cancel()})}var s={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"},l=function(){function n(n){this._control=n;this._initializedSignal=new u;this._disposed=!1;this._setState(h.Init)}return n.prototype.exitInit=function(){this._initializedSignal.complete()},n.prototype.updateDom=function(){this._state.updateDom()},n.prototype.open=function(){this._state.open()},n.prototype.close=function(){this._state.close()},Object.defineProperty(n.prototype,"opened",{get:function(){return this._state.opened},set:function(n){n?this.open():this.close()},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._setState(h.Disposed);this._disposed=!0;this._control=null},n.prototype._setState=function(n,t){this._disposed||(this._state&&this._state.exit(),this._state=new n,this._state.machine=this,this._state.enter(t))},n.prototype._fireEvent=function(n,t){t=t||{};var u=t.detail||null,f=!!t.cancelable,r=i.document.createEvent("CustomEvent");return r.initCustomEvent(n,!0,f,u),this._control.eventElement.dispatchEvent(r)},n.prototype._fireBeforeOpen=function(){return this._fireEvent(s.beforeOpen,{cancelable:!0})},n.prototype._fireBeforeClose=function(){return this._fireEvent(s.beforeClose,{cancelable:!0})},n}(),h;t.OpenCloseMachine=l,function(n){function t(){this.machine._control.onUpdateDom()}var u=function(){function n(){this.name="Init";this.exit=o;this.updateDom=f}return n.prototype.enter=function(){var n=this;e(this,function(t){return t.then(function(){return n.machine._initializedSignal.promise}).then(function(){n.machine._control.onUpdateDomWithIsOpened(n._opened);n.machine._setState(n._opened?r:i)})})},Object.defineProperty(n.prototype,"opened",{get:function(){return this._opened},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._opened=!0},n.prototype.close=function(){this._opened=!1},n}();n.Init=u;var i=function(){function n(){this.name="Closed";this.exit=f;this.opened=!1;this.close=f;this.updateDom=t}return n.prototype.enter=function(n){n=n||{};n.openIsPending&&this.open()},n.prototype.open=function(){this.machine._setState(h)},n}(),h=function(){function n(){this.name="BeforeOpen";this.exit=o;this.opened=!1;this.open=f;this.close=f;this.updateDom=t}return n.prototype.enter=function(){var n=this;e(this,function(t){return t.then(function(){return n.machine._fireBeforeOpen()}).then(function(t){t?n.machine._setState(l):n.machine._setState(i)})})},n}(),l=function(){function n(){this.name="Opening";this.exit=o;this.updateDom=f}return n.prototype.enter=function(){var n=this;e(this,function(t){return t.then(function(){return n._closeIsPending=!1,c(n.machine._control.onOpen())}).then(function(){n.machine._fireEvent(s.afterOpen)}).then(function(){n.machine._control.onUpdateDom();n.machine._setState(r,{closeIsPending:n._closeIsPending})})})},Object.defineProperty(n.prototype,"opened",{get:function(){return!this._closeIsPending},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._closeIsPending=!1},n.prototype.close=function(){this._closeIsPending=!0},n}(),r=function(){function n(){this.name="Opened";this.exit=f;this.opened=!0;this.open=f;this.updateDom=t}return n.prototype.enter=function(n){n=n||{};n.closeIsPending&&this.close()},n.prototype.close=function(){this.machine._setState(a)},n}(),a=function(){function n(){this.name="BeforeClose";this.exit=o;this.opened=!0;this.open=f;this.close=f;this.updateDom=t}return n.prototype.enter=function(){var n=this;e(this,function(t){return t.then(function(){return n.machine._fireBeforeClose()}).then(function(t){t?n.machine._setState(v):n.machine._setState(r)})})},n}(),v=function(){function n(){this.name="Closing";this.exit=o;this.updateDom=f}return n.prototype.enter=function(){var n=this;e(this,function(t){return t.then(function(){return n._openIsPending=!1,c(n.machine._control.onClose())}).then(function(){n.machine._fireEvent(s.afterClose)}).then(function(){n.machine._control.onUpdateDom();n.machine._setState(i,{openIsPending:n._openIsPending})})})},Object.defineProperty(n.prototype,"opened",{get:function(){return this._openIsPending},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._openIsPending=!0},n.prototype.close=function(){this._openIsPending=!1},n}(),y=function(){function n(){this.name="Disposed";this.enter=f;this.exit=f;this.opened=!1;this.open=f;this.close=f;this.updateDom=f}return n}();n.Disposed=y}(h||(h={}))}),t("require-style!less/styles-commandingsurface",[],function(){}),t("require-style!less/colors-commandingsurface",[],function(){}),t("WinJS/Controls/CommandingSurface/_CommandingSurface",["require","exports","../../Animations","../../Core/_Base","../../Core/_BaseUtils","../../BindingList","../../ControlProcessor","../CommandingSurface/_Constants","../AppBar/_Command","../CommandingSurface/_MenuCommand","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Core/_ErrorFromName","../../Core/_Events","../../Controls/Flyout","../../Core/_Global","../../Utilities/_Hoverable","../../Utilities/_KeyboardBehavior","../../Core/_Log","../../Promise","../../Core/_Resources","../../Scheduler","../../Utilities/_OpenCloseMachine","../../_Signal","../../Core/_WriteProfilerMark"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut){function ct(n,t){t&&a.addClass(n,t)}function lt(n,t){t&&a.removeClass(n,t)}function yt(n,t){return n.filter(function(n){return t.indexOf(n)<0})}var et,ot,at;n(["require-style!less/styles-commandingsurface"]);n(["require-style!less/colors-commandingsurface"]);"use strict";var vt={get overflowButtonAriaLabel(){return nt._getWinJSString("ui/commandingSurfaceOverflowButtonAriaLabel").value},get badData(){return"Invalid argument: The data property must an instance of a WinJS.Binding.List"},get mustContainCommands(){return"The commandingSurface can only contain WinJS.UI.Command or WinJS.UI.AppBarCommand controls"},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},ft={newDataStage:3,measuringStage:2,layoutStage:1,idle:0},st={bottom:"bottom",top:"top"},ht={};ht[st.top]=o.ClassNames.overflowTopClass;ht[st.bottom]=o.ClassNames.overflowBottomClass;et={none:"none",minimal:"minimal",compact:"compact",full:"full"};ot={};ot[et.none]=o.ClassNames.noneClass;ot[et.minimal]=o.ClassNames.minimalClass;ot[et.compact]=o.ClassNames.compactClass;ot[et.full]=o.ClassNames.fullClass;at=function(){function n(n,t){var i=this;if(t===void 0&&(t={}),this._hoverable=b.isHoverable,this._dataChangedEvents=["itemchanged","iteminserted","itemmoved","itemremoved","reload"],this._updateDomImpl_renderedState={closedDisplayMode:undefined,isOpenedMode:undefined,overflowDirection:undefined,overflowAlignmentOffset:undefined},this._writeProfilerMark("constructor,StartTM"),n&&n.winControl)throw new v("WinJS.UI._CommandingSurface.DuplicateConstruction",vt.duplicateConstruction);this._initializeDom(n||w.document.createElement("div"));this._machine=t.openCloseMachine||new it.OpenCloseMachine({eventElement:this._dom.root,onOpen:function(){return i.synchronousOpen(),g.wrap()},onClose:function(){return i.synchronousClose(),g.wrap()},onUpdateDom:function(){i.updateDomImpl()},onUpdateDomWithIsOpened:function(n){n?i.synchronousOpen():i.synchronousClose()}});this._disposed=!1;this._primaryCommands=[];this._secondaryCommands=[];this._refreshBound=this._refresh.bind(this);this._resizeHandlerBound=this._resizeHandler.bind(this);this._winKeyboard=new k._WinKeyboard(this._dom.root);this._refreshPending=!1;this._rtl=!1;this._initializedSignal=new rt;this._nextLayoutStage=ft.idle;this._isOpenedMode=o.defaultOpened;this.overflowDirection=o.defaultOverflowDirection;this.closedDisplayMode=o.defaultClosedDisplayMode;this.opened=this._isOpenedMode;t.data||(t=u._shallowCopy(t),t.data=t.data||this._getDataFromDOMElements());c.setOptions(this,t);a._resizeNotifier.subscribe(this._dom.root,this._resizeHandlerBound);this._dom.root.addEventListener("keydown",this._keyDownHandler.bind(this));a._inDom(this._dom.root).then(function(){i._rtl=w.getComputedStyle(i._dom.root).direction==="rtl";t.openCloseMachine||i._machine.exitInit();i._initializedSignal.complete();i._writeProfilerMark("constructor,StopTM")})}return Object.defineProperty(n.prototype,"element",{get:function(){return this._dom.root},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(n){if(this._writeProfilerMark("set_data,info"),n!==this.data){if(!(n instanceof f.List))throw new v("WinJS.UI._CommandingSurface.BadData",vt.badData);this._data&&this._removeDataListeners();this._data=n;this._addDataListeners();this._dataUpdated()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closedDisplayMode",{get:function(){return this._closedDisplayMode},set:function(n){this._writeProfilerMark("set_closedDisplayMode,info");var t=n!==this._closedDisplayMode;et[n]&&t&&(this._closedDisplayMode=n,this._machine.updateDom())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"overflowDirection",{get:function(){return this._overflowDirection},set:function(n){var t=n!==this._overflowDirection;st[n]&&t&&(this._overflowDirection=n,this._machine.updateDom())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"opened",{get:function(){return this._machine.opened},set:function(n){this._machine.opened=n},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._machine.open()},n.prototype.close=function(){this._machine.close()},n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._machine.dispose(),a._resizeNotifier.unsubscribe(this._dom.root,this._resizeHandlerBound),this._contentFlyout&&(this._contentFlyout.dispose(),this._contentFlyout.element.parentNode.removeChild(this._contentFlyout.element)),l.disposeSubTree(this._dom.root))},n.prototype.forceLayout=function(){this._meaurementsDirty();this._machine.updateDom()},n.prototype.getBoundingRects=function(){return{commandingSurface:this._dom.root.getBoundingClientRect(),overflowArea:this._dom.overflowArea.getBoundingClientRect()}},n.prototype.getCommandById=function(n){var t,r,i;if(this._data)for(t=0,r=this._data.length;t<r;t++)if(i=this._data.getAt(t),i.id===n)return i;return null},n.prototype.showOnlyCommands=function(n){var t,i,r;if(this._data){for(t=0,i=this._data.length;t<i;t++)this._data.getAt(t).hidden=!0;for(t=0,i=n.length;t<i;t++)r=typeof n[t]=="string"?this.getCommandById(n[t]):n[t],r&&(r.hidden=!1)}},n.prototype.deferredDomUpate=function(){this._machine.updateDom()},n.prototype.createOpenAnimation=function(n){d.log&&this._updateDomImpl_renderedState.isOpenedMode&&d.log("The CommandingSurface should only attempt to create an open animation when it's not already opened");var t=this;return{execute:function(){var r=t.getBoundingRects();return t._dom.overflowAreaContainer.style.width=r.overflowArea.width+"px",t._dom.overflowAreaContainer.style.height=r.overflowArea.height+"px",i._commandingSurfaceOpenAnimation({actionAreaClipper:t._dom.actionAreaContainer,actionArea:t._dom.actionArea,overflowAreaClipper:t._dom.overflowAreaContainer,overflowArea:t._dom.overflowArea,oldHeight:n,newHeight:r.commandingSurface.height,overflowAreaHeight:r.overflowArea.height,menuPositionedAbove:t.overflowDirection===st.top}).then(function(){t._dom.actionAreaContainer.style.transform="";t._dom.actionArea.style.transform="";t._dom.overflowAreaContainer.style.transform="";t._dom.overflowArea.style.transform=""})}}},n.prototype.createCloseAnimation=function(n){d.log&&(this._updateDomImpl_renderedState.isOpenedMode||d.log("The CommandingSurface should only attempt to create an closed animation when it's not already closed"));var r=this.getBoundingRects().commandingSurface.height,u=this._dom.overflowArea.offsetHeight,f=this._dom.overflowArea.offsetTop,t=this;return{execute:function(){return a.addClass(t.element,o.ClassNames.closingClass),i._commandingSurfaceCloseAnimation({actionAreaClipper:t._dom.actionAreaContainer,actionArea:t._dom.actionArea,overflowAreaClipper:t._dom.overflowAreaContainer,overflowArea:t._dom.overflowArea,oldHeight:r,newHeight:n,overflowAreaHeight:u,menuPositionedAbove:t.overflowDirection===st.top}).then(function(){a.removeClass(t.element,o.ClassNames.closingClass);t._dom.actionAreaContainer.style.transform="";t._dom.actionArea.style.transform="";t._dom.overflowAreaContainer.style.transform="";t._dom.overflowArea.style.transform=""})}}},Object.defineProperty(n.prototype,"initialized",{get:function(){return this._initializedSignal.promise},enumerable:!0,configurable:!0}),n.prototype._writeProfilerMark=function(n){ut("WinJS.UI._CommandingSurface:"+this._id+":"+n)},n.prototype._initializeDom=function(n){var s=this,t,r,e,i,u,f;this._writeProfilerMark("_intializeDom,info");n.winControl=this;this._id=n.id||a._uniqueID(n);n.hasAttribute("tabIndex")||(n.tabIndex=-1);a.addClass(n,o.ClassNames.controlCssClass);a.addClass(n,o.ClassNames.disposableCssClass);t=w.document.createElement("div");a.addClass(t,o.ClassNames.actionAreaCssClass);a._reparentChildren(n,t);r=w.document.createElement("div");a.addClass(r,o.ClassNames.actionAreaContainerCssClass);r.appendChild(t);n.appendChild(r);e=w.document.createElement("div");a.addClass(e,o.ClassNames.spacerCssClass);t.appendChild(e);i=w.document.createElement("button");i.tabIndex=0;i.innerHTML="<span class='"+o.ClassNames.ellipsisCssClass+"'><\/span>";a.addClass(i,o.ClassNames.overflowButtonCssClass);t.appendChild(i);i.addEventListener("click",function(){s.opened=!s.opened});u=w.document.createElement("div");a.addClass(u,o.ClassNames.overflowAreaCssClass);a.addClass(u,o.ClassNames.menuCssClass);f=w.document.createElement("div");a.addClass(f,o.ClassNames.overflowAreaContainerCssClass);f.appendChild(u);n.appendChild(f);this._dom={root:n,actionArea:t,actionAreaContainer:r,spacer:e,overflowButton:i,overflowArea:u,overflowAreaContainer:f}},n.prototype._getFocusableElementsInfo=function(){var i=this,n={elements:[],focusedIndex:-1},t=Array.prototype.slice.call(this._dom.actionArea.children),t=Array.prototype.slice.call(this._dom.actionArea.children);return this._dom.overflowArea.style.display!=="none"&&(t=t.concat(Array.prototype.slice.call(this._dom.overflowArea.children))),t.forEach(function(t){i._isElementFocusable(t)&&(n.elements.push(t),t.contains(w.document.activeElement)&&(n.focusedIndex=n.elements.length-1))}),n},n.prototype._dataUpdated=function(){var n=this;this._primaryCommands=[];this._secondaryCommands=[];this.data.length>0&&this.data.forEach(function(t){t.section==="secondary"?n._secondaryCommands.push(t):n._primaryCommands.push(t)});this._dataDirty();this._machine.updateDom()},n.prototype._refresh=function(){var n=this;this._refreshPending||(this._refreshPending=!0,tt.schedule(function(){n._refreshPending&&!n._disposed&&(n._refreshPending=!1,n._dataUpdated())},tt.Priority.high,null,"WinJS.UI._CommandingSurface._refresh"))},n.prototype._addDataListeners=function(){var n=this;this._dataChangedEvents.forEach(function(t){n._data.addEventListener(t,n._refreshBound,!1)})},n.prototype._removeDataListeners=function(){var n=this;this._dataChangedEvents.forEach(function(t){n._data.removeEventListener(t,n._refreshBound,!1)})},n.prototype._isElementFocusable=function(n){var i=!1,t;return n&&(t=n.winControl,i=t?t.element.style.display!=="none"&&t.type!==o.typeSeparator&&!t.hidden&&!t.disabled&&(!t.firstElementFocus||t.firstElementFocus.tabIndex>=0||t.lastElementFocus.tabIndex>=0):n.style.display!=="none"&&getComputedStyle(n).visibility!=="hidden"&&n.tabIndex>=0),i},n.prototype._isCommandInActionArea=function(n){return n&&n.winControl&&n.parentElement===this._dom.actionArea},n.prototype._getLastElementFocus=function(n){return this._isCommandInActionArea(n)?n.winControl.lastElementFocus:n},n.prototype._getFirstElementFocus=function(n){return this._isCommandInActionArea(n)?n.winControl.firstElementFocus:n},n.prototype._keyDownHandler=function(n){var i,t,u,r;if(!n.altKey){if(a._matchesSelector(n.target,".win-interactive, .win-interactive *"))return;if(i=a.Key,t=this._getFocusableElementsInfo(),t.elements.length)switch(n.keyCode){case this._rtl?i.rightArrow:i.leftArrow:case i.upArrow:r=Math.max(0,t.focusedIndex-1);u=this._getLastElementFocus(t.elements[r%t.elements.length]);break;case this._rtl?i.leftArrow:i.rightArrow:case i.downArrow:r=Math.min(t.focusedIndex+1,t.elements.length-1);u=this._getFirstElementFocus(t.elements[r]);break;case i.home:r=0;u=this._getFirstElementFocus(t.elements[r]);break;case i.end:r=t.elements.length-1;u=this._getLastElementFocus(t.elements[r])}u&&u!==w.document.activeElement&&(u.focus(),n.preventDefault())}},n.prototype._getDataFromDOMElements=function(){var i,r,n,t;for(this._writeProfilerMark("_getDataFromDOMElements,info"),e.processAll(this._dom.actionArea,!0),i=[],r=this._dom.actionArea.children.length,t=0;t<r;t++)if(n=this._dom.actionArea.children[t],n.winControl&&n.winControl instanceof s.AppBarCommand)i.push(n.winControl);else if(n!==this._dom.overflowButton&&n!==this._dom.spacer)throw new v("WinJS.UI._CommandingSurface.MustContainCommands",vt.mustContainCommands);return new f.List(i)},n.prototype._resizeHandler=function(){if(this._dom.root.offsetWidth){var n=a._getPreciseContentWidth(this._dom.actionArea);this._cachedMeasurements&&this._cachedMeasurements.actionAreaContentBoxWidth!==n&&(this._cachedMeasurements.actionAreaContentBoxWidth=n,this._layoutDirty(),this._machine.updateDom())}},n.prototype._dataDirty=function(){this._nextLayoutStage=Math.max(ft.newDataStage,this._nextLayoutStage)},n.prototype._meaurementsDirty=function(){this._nextLayoutStage=Math.max(ft.measuringStage,this._nextLayoutStage)},n.prototype._layoutDirty=function(){this._nextLayoutStage=Math.max(ft.layoutStage,this._nextLayoutStage)},n.prototype.synchronousOpen=function(){this._overflowAlignmentOffset=0;this._isOpenedMode=!0;this.updateDomImpl();this._overflowAlignmentOffset=this._computeAdjustedOverflowAreaOffset();this.updateDomImpl()},n.prototype._computeAdjustedOverflowAreaOffset=function(){var i,r,u;d.log&&(this._updateDomImpl_renderedState.isOpenedMode||d.log("The CommandingSurface should only attempt to compute adjusted overflowArea offset  when it has been rendered opened"),this._updateDomImpl_renderedState.overflowAlignmentOffset!==0&&d.log("The CommandingSurface should only attempt to compute adjusted overflowArea offset  when it has been rendered with an overflowAlignementOffset of 0"));var f=this._dom.overflowArea,t=this.getBoundingRects(),n=0;return this._rtl?(i=window.innerWidth,r=t.overflowArea.right,n=Math.min(i-r,0)):(u=t.overflowArea.left,n=Math.min(0,u)),n},n.prototype.synchronousClose=function(){this._isOpenedMode=!1;this.updateDomImpl()},n.prototype.updateDomImpl=function(){this._updateDomImpl_renderDisplayMode();this._updateDomImpl_updateCommands()},n.prototype._updateDomImpl_renderDisplayMode=function(){var n=this._updateDomImpl_renderedState,t,i;n.isOpenedMode!==this._isOpenedMode&&(this._isOpenedMode?(lt(this._dom.root,o.ClassNames.closedClass),ct(this._dom.root,o.ClassNames.openedClass)):(lt(this._dom.root,o.ClassNames.openedClass),ct(this._dom.root,o.ClassNames.closedClass)),n.isOpenedMode=this._isOpenedMode);n.closedDisplayMode!==this.closedDisplayMode&&(lt(this._dom.root,ot[n.closedDisplayMode]),ct(this._dom.root,ot[this.closedDisplayMode]),n.closedDisplayMode=this.closedDisplayMode);n.overflowDirection!==this.overflowDirection&&(lt(this._dom.root,ht[n.overflowDirection]),ct(this._dom.root,ht[this.overflowDirection]),n.overflowDirection=this.overflowDirection);this._overflowAlignmentOffset!==n.overflowAlignmentOffset&&(t=this._rtl?"left":"right",i=this._overflowAlignmentOffset+"px",this._dom.overflowAreaContainer.style[t]=i)},n.prototype._updateDomImpl_updateCommands=function(){var n,i,t;for(this._writeProfilerMark("_updateDomImpl_updateCommands,info"),n=this._nextLayoutStage;n!==ft.idle;){i=n;t=!1;switch(i){case ft.newDataStage:n=ft.measuringStage;t=this._processNewData();break;case ft.measuringStage:n=ft.layoutStage;t=this._measure();break;case ft.layoutStage:n=ft.idle;t=this._layoutCommands()}if(!t){n=i;break}}this._nextLayoutStage=n},n.prototype._getDataChangeInfo=function(){var r=[],t=[],u=[],n=[],f=[],i=[],e=[],s=[];return Array.prototype.forEach.call(this._dom.actionArea.querySelectorAll(o.commandSelector),function(t){t.style.display!=="none"&&n.push(t);f.push(t)}),this.data.forEach(function(n){n.element.style.display!=="none"?i.push(n.element):e.push(n.element);s.push(n.element)}),t=yt(n,i),u=yt(n,t),r=yt(i,n).concat(e),{newElements:s,currentElements:f,added:r,deleted:t,affected:u}},n.prototype._processNewData=function(){var r=this,n,t;return this._writeProfilerMark("_processNewData,info"),n=this._getDataChangeInfo(),t=i._createUpdateListAnimation(n.added,n.deleted,n.affected),n.currentElements.forEach(function(n){n.parentElement&&n.parentElement.removeChild(n)}),n.newElements.forEach(function(n){r._dom.actionArea.appendChild(n)}),this._dom.actionArea.appendChild(this._dom.overflowButton),this.data.length>0?a.removeClass(this._dom.root,o.ClassNames.emptyCommandingSurfaceCssClass):a.addClass(this._dom.root,o.ClassNames.emptyCommandingSurfaceCssClass),t.execute(),!0},n.prototype._measure=function(){var u=this,i;if(this._writeProfilerMark("_measure,info"),i=w.document.body.contains(this._dom.root)&&this._dom.actionArea.offsetWidth>0,i){var f=a._getPreciseTotalWidth(this._dom.overflowButton),e=a._getPreciseContentWidth(this._dom.actionArea),n=0,t=0,r={};return this._primaryCommands.forEach(function(i){var f=i.element.style.display;i.element.style.display="";i.type===o.typeContent?r[u._commandUniqueId(i)]=a._getPreciseTotalWidth(i.element):i.type===o.typeSeparator?n||(n=a._getPreciseTotalWidth(i.element)):t||(t=a._getPreciseTotalWidth(i.element));i.element.style.display=f}),this._cachedMeasurements={contentCommandWidths:r,separatorWidth:n,standardCommandWidth:t,overflowButtonWidth:f,actionAreaContentBoxWidth:e},!0}return!1},n.prototype._layoutCommands=function(){var n=this,r,i,e,f,s,u,t,c,l;return this._writeProfilerMark("_layoutCommands,StartTM"),this._primaryCommands.forEach(function(n){n.element.style.display=n.hidden?"none":""}),r=this._getPrimaryCommandsLocation(),this._hideSeparatorsIfNeeded(r.actionArea),r.overflowArea.forEach(function(n){n.element.style.display="none"}),this._secondaryCommands.forEach(function(n){n.element.style.display="none"}),i=r.overflowArea,e=i.length>0||this._secondaryCommands.length>0,this._dom.overflowButton.style.display=e?"":"none",f=function(n){return n.type===o.typeContent},s=i.some(f)||this._secondaryCommands.some(f),s&&!this._contentFlyout&&(this._contentFlyoutInterior=w.document.createElement("div"),a.addClass(this._contentFlyoutInterior,o.ClassNames.contentFlyoutCssClass),this._contentFlyout=new p.Flyout,this._contentFlyout.element.appendChild(this._contentFlyoutInterior),w.document.body.appendChild(this._contentFlyout.element),this._contentFlyout.onbeforeshow=function(){a.empty(n._contentFlyoutInterior);a._reparentChildren(n._chosenCommand.element,n._contentFlyoutInterior)},this._contentFlyout.onafterhide=function(){a._reparentChildren(n._contentFlyoutInterior,n._chosenCommand.element)}),a.empty(this._dom.overflowArea),u=!1,t=[],i.forEach(function(i){i.type===o.typeToggle&&(u=!0);t.push(n._projectAsMenuCommand(i))}),c=this._secondaryCommands.length,i.length>0&&c>0&&(l=new h._MenuCommand(null,{type:o.typeSeparator}),t.push(l)),this._secondaryCommands.forEach(function(i){i.hidden||(i.type===o.typeToggle&&(u=!0),t.push(n._projectAsMenuCommand(i)))}),this._hideSeparatorsIfNeeded(t),t.forEach(function(t){n._dom.overflowArea.appendChild(t.element)}),a[u?"addClass":"removeClass"](this._dom.overflowArea,o.ClassNames.menuContainsToggleCommandClass),this._writeProfilerMark("_layoutCommands,StopTM"),!0},n.prototype._commandUniqueId=function(n){return a._uniqueID(n.element)},n.prototype._getCommandsInfo=function(){for(var n,i=0,r=[],u=0,f=0,t=this._primaryCommands.length-1;t>=0;t--)n=this._primaryCommands[t],u=n.priority===undefined?f--:n.priority,i=n.element.style.display==="none"?0:this._getCommandWidth(n),r.unshift({command:n,width:i,priority:u});return r},n.prototype._getPrimaryCommandsLocation=function(){var n,i;this._writeProfilerMark("_getCommandsLocation,info");var r=[],u=[],f=0,h=this._secondaryCommands.length>0,e=this._getCommandsInfo(),t=e.slice(0).sort(function(n,t){return n.priority-t.priority}),o=Number.MAX_VALUE,s=this._cachedMeasurements.actionAreaContentBoxWidth;for(n=0,i=t.length;n<i;n++)if(s-=t[n].width,f=h||n<i-1?this._cachedMeasurements.overflowButtonWidth:0,s-f<0){o=t[n].priority-1;break}return e.forEach(function(n){n.priority<=o?r.push(n.command):u.push(n.command)}),{actionArea:r,overflowArea:u}},n.prototype._getCommandWidth=function(n){return n.type===o.typeContent?this._cachedMeasurements.contentCommandWidths[this._commandUniqueId(n)]:n.type===o.typeSeparator?this._cachedMeasurements.separatorWidth:this._cachedMeasurements.standardCommandWidth},n.prototype._projectAsMenuCommand=function(n){var i=this,t=new h._MenuCommand(null,{label:n.label,type:(n.type===o.typeContent?o.typeFlyout:n.type)||o.typeButton,disabled:n.disabled,flyout:n.flyout,beforeInvoke:function(){i._chosenCommand=t._originalICommand;i._chosenCommand.type===o.typeToggle&&(i._chosenCommand.selected=!i._chosenCommand.selected)}});return n.selected&&(t.selected=!0),n.extraClass&&(t.extraClass=n.extraClass),n.type===o.typeContent?(t.label||(t.label=o.contentMenuCommandDefaultLabel),t.flyout=this._contentFlyout):t.onclick=n.onclick,t._originalICommand=n,t},n.prototype._hideSeparatorsIfNeeded=function(n){var r=o.typeSeparator,i,u=n.length,t;for(n.forEach(function(n){n.type===o.typeSeparator&&r===o.typeSeparator&&(n.element.style.display="none");r=n.type}),t=u-1;t>=0;t--)if(i=n[t],i.type===o.typeSeparator)i.element.style.display="none";else break},n.ClosedDisplayMode=et,n.OverflowDirection=st,n.supportedForProcessing=!0,n}();t._CommandingSurface=at;r.Class.mix(at,y.createEventProperties(o.EventNames.beforeOpen,o.EventNames.afterOpen,o.EventNames.beforeClose,o.EventNames.afterClose));r.Class.mix(at,c.DOMEventMixin)}),t("WinJS/Controls/CommandingSurface",["require","exports"],function(n){function i(){return t||n(["./CommandingSurface/_CommandingSurface"],function(n){t=n}),t._CommandingSurface}var t=null;return Object.create({},{_CommandingSurface:{get:function(){return i()}}})}),t("require-style!less/styles-toolbar",[],function(){}),t("WinJS/Controls/ToolBar/_ToolBar",["require","exports","../../Core/_Base","../ToolBar/_Constants","../CommandingSurface","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Core/_ErrorFromName","../../Core/_Events","../../Core/_Global","../../_LightDismissService","../../Core/_Resources","../../Utilities/_OpenCloseMachine","../../Core/_WriteProfilerMark"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){function p(n,t){t&&o.addClass(n,t)}function g(n,t){t&&o.removeClass(n,t)}var k;n(["require-style!less/styles-toolbar"]);"use strict";var d={get ariaLabel(){return a._getWinJSString("ui/toolbarAriaLabel").value},get overflowButtonAriaLabel(){return a._getWinJSString("ui/toolbarOverflowButtonAriaLabel").value},get mustContainCommands(){return"The toolbar can only contain WinJS.UI.Command or WinJS.UI.AppBarCommand controls"},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},w={compact:"compact",full:"full"},b={};b[w.compact]=r.ClassNames.compactClass;b[w.full]=r.ClassNames.fullClass;k=function(){function n(n,t){var i=this,e;if(t===void 0&&(t={}),this._updateDomImpl_renderedState={isOpenedMode:undefined,closedDisplayMode:undefined,prevInlineWidth:undefined},this._writeProfilerMark("constructor,StartTM"),n&&n.winControl)throw new s("WinJS.UI.ToolBar.DuplicateConstruction",d.duplicateConstruction);this._initializeDom(n||c.document.createElement("div"));e=new v.OpenCloseMachine({eventElement:this.element,onOpen:function(){var n=i._commandingSurface.createOpenAnimation(i._getClosedHeight());return i._synchronousOpen(),n.execute()},onClose:function(){var n=i._commandingSurface.createCloseAnimation(i._getClosedHeight());return n.execute().then(function(){i._synchronousClose()})},onUpdateDom:function(){i._updateDomImpl()},onUpdateDomWithIsOpened:function(n){i._isOpenedMode=n;i._updateDomImpl()}});this._handleShowingKeyboardBound=this._handleShowingKeyboard.bind(this);o._inputPaneListener.addEventListener(this._dom.root,"showing",this._handleShowingKeyboardBound);this._disposed=!1;this._cachedClosedHeight=null;this._commandingSurface=new u._CommandingSurface(this._dom.commandingSurfaceEl,{openCloseMachine:e});p(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-actionarea"),r.ClassNames.actionAreaCssClass);p(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-overflowarea"),r.ClassNames.overflowAreaCssClass);p(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-overflowbutton"),r.ClassNames.overflowButtonCssClass);p(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-ellipsis"),r.ClassNames.ellipsisCssClass);this._isOpenedMode=r.defaultOpened;this._dismissable=new l.LightDismissableElement({element:this._dom.root,tabIndex:this._dom.root.hasAttribute("tabIndex")?this._dom.root.tabIndex:-1,onLightDismiss:function(){i.close()}});this.closedDisplayMode=r.defaultClosedDisplayMode;this.opened=this._isOpenedMode;f.setOptions(this,t);o._inDom(this.element).then(function(){return i._commandingSurface.initialized}).then(function(){e.exitInit();i._writeProfilerMark("constructor,StopTM")})}return Object.defineProperty(n.prototype,"element",{get:function(){return this._dom.root},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._commandingSurface.data},set:function(n){this._commandingSurface.data=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closedDisplayMode",{get:function(){return this._commandingSurface.closedDisplayMode},set:function(n){w[n]&&(this._commandingSurface.closedDisplayMode=n,this._cachedClosedHeight=null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"opened",{get:function(){return this._commandingSurface.opened},set:function(n){this._commandingSurface.opened=n},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._commandingSurface.open()},n.prototype.close=function(){this._commandingSurface.close()},n.prototype.dispose=function(){this._disposed||(this._disposed=!0,l.hidden(this._dismissable),this._commandingSurface.dispose(),this._synchronousClose(),o._inputPaneListener.removeEventListener(this._dom.root,"showing",this._handleShowingKeyboardBound),e.disposeSubTree(this.element))},n.prototype.forceLayout=function(){this._commandingSurface.forceLayout()},n.prototype.getCommandById=function(n){return this._commandingSurface.getCommandById(n)},n.prototype.showOnlyCommands=function(n){return this._commandingSurface.showOnlyCommands(n)},n.prototype._writeProfilerMark=function(n){y("WinJS.UI.ToolBar:"+this._id+":"+n)},n.prototype._initializeDom=function(n){var u,f,t,i;this._writeProfilerMark("_intializeDom,info");n.winControl=this;this._id=n.id||o._uniqueID(n);o.addClass(n,r.ClassNames.controlCssClass);o.addClass(n,r.ClassNames.disposableCssClass);u=n.getAttribute("role");u||n.setAttribute("role","menubar");f=n.getAttribute("aria-label");f||n.setAttribute("aria-label",d.ariaLabel);t=document.createElement("DIV");o._reparentChildren(n,t);n.appendChild(t);i=c.document.createElement("DIV");o.addClass(i,r.ClassNames.placeHolderCssClass);e.markDisposable(i,this.dispose.bind(this));this._dom={root:n,commandingSurfaceEl:t,placeHolder:i}},n.prototype._handleShowingKeyboard=function(){this.close()},n.prototype._synchronousOpen=function(){this._isOpenedMode=!0;this._updateDomImpl()},n.prototype._synchronousClose=function(){this._isOpenedMode=!1;this._updateDomImpl()},n.prototype._updateDomImpl=function(){var n=this._updateDomImpl_renderedState;n.isOpenedMode!==this._isOpenedMode&&(this._isOpenedMode?this._updateDomImpl_renderOpened():this._updateDomImpl_renderClosed(),n.isOpenedMode=this._isOpenedMode);n.closedDisplayMode!==this.closedDisplayMode&&(g(this._dom.root,b[n.closedDisplayMode]),p(this._dom.root,b[this.closedDisplayMode]),n.closedDisplayMode=this.closedDisplayMode);this._commandingSurface.updateDomImpl()},n.prototype._getClosedHeight=function(){if(this._cachedClosedHeight===null){var n=this._isOpenedMode;this._isOpenedMode&&this._synchronousClose();this._cachedClosedHeight=this._commandingSurface.getBoundingRects().commandingSurface.height;n&&this._synchronousOpen()}return this._cachedClosedHeight},n.prototype._updateDomImpl_renderOpened=function(){var u=this;this._updateDomImpl_renderedState.prevInlineWidth=this._dom.root.style.width;var t=this._dom.root.getBoundingClientRect(),v=o._getPreciseContentWidth(this._dom.root),y=o._getPreciseContentHeight(this._dom.root),f=getComputedStyle(this._dom.root),p=o._convertToPrecisePixels(f.paddingTop),w=o._convertToPrecisePixels(f.borderTopWidth),n=o._getPreciseMargins(this._dom.root),e=t.top+w+p,b=e+y,s=this._dom.placeHolder,i=s.style;i.width=t.width+"px";i.height=t.height+"px";i.marginTop=n.top+"px";i.marginRight=n.right+"px";i.marginBottom=n.bottom+"px";i.marginLeft=n.left+"px";o._maintainFocus(function(){u._dom.root.parentElement.insertBefore(s,u._dom.root);c.document.body.appendChild(u._dom.root)});this._dom.root.style.width=v+"px";this._dom.root.style.left=t.left-n.left+"px";var h=0,a=c.innerHeight,k=e-h,d=a-b;k>d?(this._commandingSurface.overflowDirection=r.OverflowDirection.top,this._dom.root.style.bottom=a-t.bottom-n.bottom+"px"):(this._commandingSurface.overflowDirection=r.OverflowDirection.bottom,this._dom.root.style.top=h+t.top-n.top+"px");o.addClass(this._dom.root,r.ClassNames.openedClass);o.removeClass(this._dom.root,r.ClassNames.closedClass);this._commandingSurface.synchronousOpen();l.shown(this._dismissable)},n.prototype._updateDomImpl_renderClosed=function(){var n=this;this._dom.placeHolder.parentElement&&o._maintainFocus(function(){var t=n._dom.placeHolder;t.parentElement.insertBefore(n._dom.root,t);t.parentElement.removeChild(t)});this._dom.root.style.top="";this._dom.root.style.right="";this._dom.root.style.bottom="";this._dom.root.style.left="";this._dom.root.style.width=this._updateDomImpl_renderedState.prevInlineWidth;o.addClass(this._dom.root,r.ClassNames.closedClass);o.removeClass(this._dom.root,r.ClassNames.openedClass);this._commandingSurface.synchronousClose();l.hidden(this._dismissable)},n.ClosedDisplayMode=w,n.supportedForProcessing=!0,n}();t.ToolBar=k;i.Class.mix(k,h.createEventProperties(r.EventNames.beforeOpen,r.EventNames.afterOpen,r.EventNames.beforeClose,r.EventNames.afterClose));i.Class.mix(k,f.DOMEventMixin)}),t("WinJS/Controls/ToolBar",["require","exports","../Core/_Base"],function(n,t,i){var r=null;i.Namespace.define("WinJS.UI",{ToolBar:{get:function(){return r||n(["./ToolBar/_ToolBar"],function(n){r=n}),r.ToolBar}}})}),t("WinJS/Controls/_LegacyAppBar/_Layouts",["exports","../../Animations/_TransitionAnimation","../../BindingList","../../Core/_BaseUtils","../../Core/_Global","../../Core/_Base","../../Core/_ErrorFromName","../../Core/_Resources","../../Core/_WriteProfilerMark","../../Controls/ToolBar","../../Controls/ToolBar/_Constants","../../Promise","../../Scheduler","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../AppBar/_Command","./_Constants"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";f.Namespace._moduleDefine(n,"WinJS.UI",{_AppBarBaseLayout:f.Namespace._lazy(function(){var n=b.appBarLayoutCustom,t={get nullCommand(){return"Invalid argument: command must not be null"}};return f.Class.define(function(n,t){this._disposed=!1;t=t||{};v.setOptions(this,t);n&&this.connect(n)},{className:{get:function(){return this._className}},type:{get:function(){return this._type||n}},commandsInOrder:{get:function(){var n=this.appBarEl.querySelectorAll("."+b.appBarCommandClass);return Array.prototype.map.call(n,function(n){return n.winControl})}},connect:function(n){this.className&&p.addClass(n,this.className);this.appBarEl=n},disconnect:function(){this.className&&p.removeClass(this.appBarEl,this.className);this.appBarEl=null;this.dispose()},layout:function(n){for(var i,r=n.length,t=0;t<r;t++)i=this.sanitizeCommand(n[t]),this.appBarEl.appendChild(i._element)},showCommands:function(n){this.appBarEl.winControl._showCommands(n)},showOnlyCommands:function(n){this.appBarEl.winControl._showOnlyCommands(n)},hideCommands:function(n){this.appBarEl.winControl._hideCommands(n)},sanitizeCommand:function(n){if(!n)throw new e("WinJS.UI.AppBar.NullCommand",t.nullCommand);return n=n.winControl||n,n._element||(n=new w.AppBarCommand(null,n)),n._element.parentElement&&n._element.parentElement.removeChild(n._element),n},dispose:function(){this._disposed=!0},disposeChildren:function(){var t=this.appBarEl.querySelectorAll("."+b.firstDivClass),n,u,f,i,r;for(t=t.length>=1?t[0]:null,n=this.appBarEl.querySelectorAll("."+b.finalDivClass),n=n.length>=1?n[0]:null,u=this.appBarEl.children,f=u.length,i=0;i<f;i++)if(r=u[i],r===t||r===n)continue;else y.disposeSubTree(r)},handleKeyDown:function(){},commandsUpdated:function(){},beginAnimateCommands:function(){},endAnimateCommands:function(){},scale:function(){},resize:function(){},positionChanging:function(){return l.wrap()},setFocusOnShow:function(){this.appBarEl.winControl._setFocusToAppBar()}})})});f.Namespace._moduleDefine(n,"WinJS.UI",{_AppBarCommandsLayout:f.Namespace._lazy(function(){var t=b.commandLayoutClass,i=b.appBarLayoutCommands;return f.Class.derive(n._AppBarBaseLayout,function(r){n._AppBarBaseLayout.call(this,r,{_className:t,_type:i});this._commandLayoutsInit(r)},{commandsInOrder:{get:function(){return this._originalCommands.filter(function(n){return this.appBarEl.contains(n.element)},this)}},layout:function(n){var i,r,t;for(p.empty(this._primaryCommands),p.empty(this._secondaryCommands),this._originalCommands=[],i=0,r=n.length;i<r;i++)t=this.sanitizeCommand(n[i]),this._originalCommands.push(t),"primary"===t.section||"global"===t.section?this._primaryCommands.appendChild(t._element):this._secondaryCommands.appendChild(t._element);this.appBarEl.appendChild(this._secondaryCommands);this.appBarEl.appendChild(this._primaryCommands);this._needToMeasureNewCommands=!0;a.schedule(function(){this._needToMeasureNewCommands&&!this._disposed&&this.scale()}.bind(this),a.Priority.idle,this,"WinJS._commandLayoutsMixin._scaleNewCommands")},disposeChildren:function(){y.disposeSubTree(this._primaryCommands);y.disposeSubTree(this._secondaryCommands)},handleKeyDown:function(n){var i=p.Key,h,t,f,r;if(!p._matchesSelector(n.target,".win-interactive, .win-interactive *")){var e=u.getComputedStyle(this.appBarEl).direction==="rtl",o=e?i.rightArrow:i.leftArrow,s=e?i.leftArrow:i.rightArrow;if(n.keyCode===o||n.keyCode===s||n.keyCode===i.home||n.keyCode===i.end){if(h=this._primaryCommands.contains(u.document.activeElement),t=this._getFocusableCommandsInLogicalOrder(h),t.length)switch(n.keyCode){case o:r=Math.max(-1,t.focusedIndex-1)+t.length;f=t[r%t.length].winControl.lastElementFocus;break;case s:r=t.focusedIndex+1+t.length;f=t[r%t.length].winControl.firstElementFocus;break;case i.home:r=0;f=t[r].winControl.firstElementFocus;break;case i.end:r=t.length-1;f=t[r].winControl.lastElementFocus}f&&f!==u.document.activeElement&&(f.focus(),n.preventDefault())}}},commandsUpdated:function(n){var t=n?n:this.commandsInOrder.filter(function(n){return!n.hidden});this._fullSizeWidthOfLastKnownVisibleCommands=this._getWidthOfFullSizeCommands(t)},beginAnimateCommands:function(n,t,i){var r,u;this._scaleAfterAnimations=!1;r=this._getWidthOfFullSizeCommands(n)-this._getWidthOfFullSizeCommands(t);r>0?(u=i.concat(n),this.commandsUpdated(u),this.scale()):r<0&&(this._scaleAfterAnimations=!0)},endAnimateCommands:function(){this._scaleAfterAnimations&&(this.commandsUpdated(),this.scale())},resize:function(){this._disposed||(this._appBarTotalKnownWidth=null,this.appBarEl.winControl.opened&&this.scale())},disconnect:function(){n._AppBarBaseLayout.prototype.disconnect.call(this)},_getWidthOfFullSizeCommands:function(n){var i,t,e;this._needToMeasureNewCommands&&this._measureContentCommands();var r=0,u=0,f=0;if(n)for(t=0,e=n.length;t<e;t++)i=n[t].winControl||n[t],i._type===b.typeSeparator?u++:i._type!==b.typeContent?f++:r+=i._fullSizeWidth;else return this._fullSizeWidthOfLastKnownVisibleCommands;return r+(u*b.separatorWidth+f*b.buttonWidth)},_getFocusableCommandsInLogicalOrder:function(){var i=this._secondaryCommands.children,r=this._primaryCommands.children,n=-1,f=function(t){for(var i,e,r=[],f=0,o=t.length;f<o;f++)i=t[f],p.hasClass(i,b.appBarCommandClass)&&i.winControl&&(e=i.contains(u.document.activeElement),(i.winControl._isFocusable()||e)&&(r.push(i),e&&(n=r.length-1)));return r},e=Array.prototype.slice.call(i).concat(Array.prototype.slice.call(r)),t=f(e);return t.focusedIndex=n,t},_commandLayoutsInit:function(){this._primaryCommands=u.document.createElement("DIV");this._secondaryCommands=u.document.createElement("DIV");p.addClass(this._primaryCommands,b.primaryCommandsClass);p.addClass(this._secondaryCommands,b.secondaryCommandsClass)},_scaleHelper:function(){var n=this.appBarEl.winControl.closedDisplayMode==="minimal"?b.appBarInvokeButtonWidth:0;return u.document.documentElement.clientWidth-n},_measureContentCommands:function(){var r,f,e,i,n,t,o;if(u.document.body.contains(this.appBarEl)){for(this._needToMeasureNewCommands=!1,r=p.hasClass(this.appBarEl,"win-navbar-closed"),p.removeClass(this.appBarEl,"win-navbar-closed"),f=this.appBarEl.style.display,this.appBarEl.style.display="",i=this.appBarEl.querySelectorAll("div."+b.appBarCommandClass),t=0,o=i.length;t<o;t++)n=i[t],n.winControl&&n.winControl._type===b.typeContent&&(e=n.style.display,n.style.display="",n.winControl._fullSizeWidth=p.getTotalWidth(n)||0,n.style.display=e);this.appBarEl.style.display=f;r&&p.addClass(this.appBarEl,"win-navbar-closed");this.commandsUpdated()}}})})});f.Namespace._moduleDefine(n,"WinJS.UI",{_AppBarMenuLayout:f.Namespace._lazy(function(){function o(n,i){var o=i.duration*t._animationFactor,s=r._browserStyleEquivalents.transition.scriptName,f;return n.style[s]=o+"ms "+e.cssName+" "+i.timing,n.style[e.scriptName]=i.to,new l(function(t){var h=function(t){t.target===n&&t.propertyName===e.cssName&&f()},c=!1,i;f=function(){c||(u.clearTimeout(i),n.removeEventListener(r._browserEventEquivalents.transitionEnd,h),n.style[s]="",c=!0);t()};i=u.setTimeout(function(){i=u.setTimeout(f,o)},50);n.addEventListener(r._browserEventEquivalents.transitionEnd,h)},function(){f()})}function k(n,t,i){var f=i.anchorTrailingEdge?i.to.total-i.from.total:i.from.total-i.to.total,s=i.dimension==="width"?"translateX":"translateY",h=i.dimension,c=i.duration||367,a=i.timing||"cubic-bezier(0.1, 0.9, 0.2, 1)",r;return n.style[h]=i.to.total+"px",n.style[e.scriptName]=s+"("+f+"px)",t.style[h]=i.to.content+"px",t.style[e.scriptName]=s+"("+-f+"px)",u.getComputedStyle(n).opacity,u.getComputedStyle(t).opacity,r={duration:c,timing:a,to:""},l.join([o(n,r),o(t,r)])}function d(n,t,i){var f=i.anchorTrailingEdge?i.from.total-i.to.total:i.to.total-i.from.total,s=i.dimension==="width"?"translateX":"translateY",c=i.duration||367,a=i.timing||"cubic-bezier(0.1, 0.9, 0.2, 1)";n.style[e.scriptName]="";t.style[e.scriptName]="";u.getComputedStyle(n).opacity;u.getComputedStyle(t).opacity;var h={duration:c,timing:a},v=r._merge(h,{to:s+"("+f+"px)"}),y=r._merge(h,{to:s+"("+-f+"px)"});return l.join([o(n,v),o(t,y)])}function a(n,t,i){return i.to.total>i.from.total?k(n,t,i):i.to.total<i.from.total?d(n,t,i):l.as()}var v=b.menuLayoutClass,w=b.appBarLayoutMenu,e=r._browserStyleEquivalents.transform;return f.Class.derive(n._AppBarBaseLayout,function(t){n._AppBarBaseLayout.call(this,t,{_className:v,_type:w});this._tranformNames=r._browserStyleEquivalents.transform;this._animationCompleteBound=this._animationComplete.bind(this);this._positionToolBarBound=this._positionToolBar.bind(this)},{commandsInOrder:{get:function(){return this._originalCommands}},layout:function(n){this._writeProfilerMark("layout,info");n=n||[];this._originalCommands=[];var t=this;n.forEach(function(n){t._originalCommands.push(t.sanitizeCommand(n))});this._displayedCommands=this._originalCommands.slice(0);this._menu?p.empty(this._menu):(this._menu=u.document.createElement("div"),p.addClass(this._menu,b.menuContainerClass));this.appBarEl.appendChild(this._menu);this._toolbarEl=u.document.createElement("div");this._menu.appendChild(this._toolbarEl);this._createToolBar(n)},showCommands:function(n){var r=this._getCommandsElements(n),t=[],i=[],u=this;this._originalCommands.forEach(function(n){(r.indexOf(n.element)>=0||u._displayedCommands.indexOf(n)>=0)&&(i.push(n),t.push(n))});this._displayedCommands=i;this._updateData(t)},showOnlyCommands:function(n){this._displayedCommands=[];this.showCommands(n)},hideCommands:function(n){var r=this._getCommandsElements(n),t=[],i=[],u=this;this._originalCommands.forEach(function(n){r.indexOf(n.element)===-1&&u._displayedCommands.indexOf(n)>=0&&(i.push(n),t.push(n))});this._displayedCommands=i;this._updateData(t)},connect:function(t){this._writeProfilerMark("connect,info");n._AppBarBaseLayout.prototype.connect.call(this,t);this._id=p._uniqueID(t)},resize:function(){this._writeProfilerMark("resize,info");this._initialized&&(this._forceLayoutPending=!0)},positionChanging:function(n,t){return this._writeProfilerMark("positionChanging from:"+n+" to: "+t+",info"),this._animationPromise=this._animationPromise||l.wrap(),this._animating&&this._animationPromise.cancel(),this._animating=!0,t==="shown"||n!=="shown"&&t==="compact"?(this._positionToolBar(),this._animationPromise=this._animateToolBarEntrance()):this._animationPromise=n==="minimal"||n==="compact"||n==="hidden"?l.wrap():this._animateToolBarExit(),this._animationPromise.then(this._animationCompleteBound,this._animationCompleteBound),this._animationPromise},disposeChildren:function(){this._writeProfilerMark("disposeChildren,info");this._toolbar&&y.disposeSubTree(this._toolbarEl);this._originalCommands=[];this._displayedCommands=[]},setFocusOnShow:function(){this.appBarEl.winControl._setFocusToAppBar(!0,this._menu)},_updateData:function(n){var t=p.hasClass(this.appBarEl,"win-navbar-closed"),u=p.hasClass(this.appBarEl,"win-navbar-opened"),r;p.removeClass(this.appBarEl,"win-navbar-closed");r=this.appBarEl.style.display;this.appBarEl.style.display="";this._toolbar.data=new i.List(n);t&&this._positionToolBar();this.appBarEl.style.display=r;t&&p.addClass(this.appBarEl,"win-navbar-closed");u&&(this._positionToolBar(),this._animateToolBarEntrance())},_getCommandsElements:function(n){var i,t,e,f,o,r;if(!n)return[];for(typeof n!="string"&&n&&n.length||(n=[n]),i=[],t=0,e=n.length;t<e;t++)if(n[t])if(typeof n[t]=="string")if(r=u.document.getElementById(n[t]),r)i.push(r);else for(f=0,o=this._originalCommands.length;f<o;f++)r=this._originalCommands[f].element,r.id===n[t]&&i.push(r);else n[t].element?i.push(n[t].element):i.push(n[t]);return i},_animationComplete:function(){this._disposed||(this._animating=!1)},_createToolBar:function(){var n,t,r;this._writeProfilerMark("_createToolBar,info");n=p.hasClass(this.appBarEl,"win-navbar-closed");p.removeClass(this.appBarEl,"win-navbar-closed");t=this.appBarEl.style.display;this.appBarEl.style.display="";this._toolbar=new h.ToolBar(this._toolbarEl,{data:new i.List(this._originalCommands),shownDisplayMode:"full"});r=this;this._appbarInvokeButton=this.appBarEl.querySelector("."+b.invokeButtonClass);this._overflowButton=this._toolbarEl.querySelector("."+c.overflowButtonCssClass);this._overflowButton.addEventListener("click",function(){r._appbarInvokeButton.click()});this._positionToolBar();this.appBarEl.style.display=t;n&&p.addClass(this.appBarEl,"win-navbar-closed")},_positionToolBar:function(){this._disposed||(this._writeProfilerMark("_positionToolBar,info"),this._initialized=!0)},_animateToolBarEntrance:function(){var n,t;return this._writeProfilerMark("_animateToolBarEntrance,info"),this._forceLayoutPending&&(this._forceLayoutPending=!1,this._toolbar.forceLayout(),this._positionToolBar()),n=this._isMinimal()?0:this.appBarEl.offsetHeight,this._isBottom()?(t=this._menu.offsetHeight-n,this._executeTranslate(this._menu,"translateY("+-t+"px)")):a(this._menu,this._toolbarEl,{from:{content:n,total:n},to:{content:this._menu.offsetHeight,total:this._menu.offsetHeight},dimension:"height",duration:400,timing:"ease-in"})},_animateToolBarExit:function(){this._writeProfilerMark("_animateToolBarExit,info");var n=this._isMinimal()?0:this.appBarEl.offsetHeight;return this._isBottom()?this._executeTranslate(this._menu,"none"):a(this._menu,this._toolbarEl,{from:{content:this._menu.offsetHeight,total:this._menu.offsetHeight},to:{content:n,total:n},dimension:"height",duration:400,timing:"ease-in"})},_executeTranslate:function(n,i){return t.executeTransition(n,{property:this._tranformNames.cssName,delay:0,duration:400,timing:"ease-in",to:i})},_isMinimal:function(){return this.appBarEl.winControl.closedDisplayMode==="minimal"},_isBottom:function(){return this.appBarEl.winControl.placement==="bottom"},_writeProfilerMark:function(n){s("WinJS.UI._AppBarMenuLayout:"+this._id+":"+n)}})})})}),t("WinJS/Controls/_LegacyAppBar",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Promise","../Scheduler","../_LightDismissService","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_KeyboardBehavior","./_LegacyAppBar/_Constants","./_LegacyAppBar/_Layouts","./AppBar/_Command","./AppBar/_Icon","./Flyout/_Overlay","../Application"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";r.Namespace._moduleDefine(n,"WinJS.UI",{_LegacyAppBar:r.Namespace._lazy(function(){function ot(n){var r=t.document.querySelectorAll("."+k.appBarClass),e,i,u,f;if(r)for(e=r.length,i=0;i<e;i++)u=r[i],f=u.winControl,f&&!u.disabled&&f._manipulationChanged(n)}var g={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"},it=e._createEventProperty,ut={none:0,hidden:0,minimal:25,compact:48},n={none:"hidden",hidden:"hidden",minimal:"minimal",shown:"shown",compact:"compact"},w={none:"none",minimal:"minimal",compact:"compact"},ft="shown",rt="hidden",et=!1,nt={get ariaLabel(){return o._getWinJSString("ui/appBarAriaLabel").value},get requiresCommands(){return"Invalid argument: commands must not be empty"},get cannotChangePlacementWhenVisible(){return"Invalid argument: The placement property cannot be set when the AppBar is visible, call hide() first"},get cannotChangeLayoutWhenVisible(){return"Invalid argument: The layout property cannot be set when the AppBar is visible, call hide() first"}};return r.Class.derive(tt._Overlay,function(i,r){var u,f,e,o;return this._initializing=!0,r=r||{},this._element=i||t.document.createElement("div"),this._id=this._element.id||p._uniqueID(this._element),this._writeProfilerMark("constructor,StartTM"),p.addClass(this._element,k.appBarClass),u=this,this._dismissable=new a.LightDismissableElement({element:this._element,tabIndex:this._element.hasAttribute("tabIndex")?this._element.tabIndex:-1,onLightDismiss:function(){u.close()},onActivate:function(){u._dismissable.restoreFocus()||u._layoutImpl.setFocusOnShow()}}),f=this._element.getAttribute("role"),f||this._element.setAttribute("role","menubar"),e=this._element.getAttribute("aria-label"),e||this._element.setAttribute("aria-label",nt.ariaLabel),this._baseOverlayConstructor(this._element),this._lastPositionVisited=n.none,p.addClass(this._element,k.hiddenClass),this._invokeButton=t.document.createElement("button"),this._invokeButton.tabIndex=0,this._invokeButton.setAttribute("type","button"),this._invokeButton.innerHTML="<span class='"+k.ellipsisClass+"'><\/span>",p.addClass(this._invokeButton,k.invokeButtonClass),this._element.appendChild(this._invokeButton),this._invokeButton.addEventListener("click",function(){u.opened?u._hide():u._show()},!1),this._layout=k.appBarLayoutCustom,delete r._layout,this.placement=r.placement||k.appBarPlacementBottom,this.closedDisplayMode=r.closedDisplayMode||w.compact,v.setOptions(this,r),o=this._commandsUpdated.bind(this),this._element.addEventListener(k.commandVisibilityChanged,function(n){u._disposed||(u.opened&&n.preventDefault(),o())}),this._initializing=!1,this._setFocusToAppBarBound=this._setFocusToAppBar.bind(this),this._element.addEventListener("keydown",this._handleKeyDown.bind(this),!1),et||(t.document.addEventListener("MSManipulationStateChanged",ot,!1),et=!0),this.closedDisplayMode===w.none&&this.layout===k.appBarLayoutCommands&&(this._element.style.display="none"),this._winKeyboard=new b._WinKeyboard(this._element),this._writeProfilerMark("constructor,StopTM"),this},{placement:{get:function(){return this._placement},set:function(n){var t=!1;if(i.Windows.ApplicationModel.DesignMode.designModeEnabled&&(this._hide(),t=!0),this.opened)throw new f("WinJS.UI._LegacyAppBar.CannotChangePlacementWhenVisible",nt.cannotChangePlacementWhenVisible);this._placement=n===k.appBarPlacementTop?k.appBarPlacementTop:k.appBarPlacementBottom;this._placement===k.appBarPlacementTop?(p.addClass(this._element,k.topClass),p.removeClass(this._element,k.bottomClass)):this._placement===k.appBarPlacementBottom&&(p.removeClass(this._element,k.topClass),p.addClass(this._element,k.bottomClass));this._ensurePosition();t&&this._show()}},_layout:{get:function(){return this._layoutImpl.type},set:function(n){var r,t;if(n!==k.appBarLayoutCommands&&n!==k.appBarLayoutCustom&&n!==k.appBarLayoutMenu,r=!1,i.Windows.ApplicationModel.DesignMode.designModeEnabled&&(this._hide(),r=!0),this.opened)throw new f("WinJS.UI._LegacyAppBar.CannotChangeLayoutWhenVisible",nt.cannotChangeLayoutWhenVisible);this._initializing||(t=this._layoutImpl.commandsInOrder,this._layoutImpl.disconnect());this._layoutImpl=n===k.appBarLayoutCommands?new d._AppBarCommandsLayout:n===k.appBarLayoutMenu?new d._AppBarMenuLayout:new d._AppBarBaseLayout;this._layoutImpl.connect(this._element);t&&t.length&&this._layoutCommands(t);r&&this._show()},configurable:!0},commands:{set:function(n){if(this.opened)throw new f("WinJS.UI._LegacyAppBar.CannotChangeCommandsWhenVisible",o._formatString(tt._Overlay.commonstrings.cannotChangeCommandsWhenVisible,"_LegacyAppBar"));this._initializing||this._disposeChildren();this._layoutCommands(n)}},_layoutCommands:function(n){p.empty(this._element);this._element.appendChild(this._invokeButton);Array.isArray(n)||(n=[n]);this._layoutImpl.layout(n)},closedDisplayMode:{get:function(){return this._closedDisplayMode},set:function(t){var i=this._closedDisplayMode,r;i!==t&&(r=p.hasClass(this._element,k.hiddenClass)||p.hasClass(this._element,k.hidingClass),t===w.none?(this._closedDisplayMode=w.none,r&&i||(p.removeClass(this._element,k.minimalClass),p.removeClass(this._element,k.compactClass))):t===w.minimal?(this._closedDisplayMode=w.minimal,r&&i&&i!==w.none||(p.addClass(this._element,k.minimalClass),p.removeClass(this._element,k.compactClass))):(this._closedDisplayMode=w.compact,p.addClass(this._element,k.compactClass),p.removeClass(this._element,k.minimalClass)),this._layoutImpl.resize(),r&&this._changeVisiblePosition(n[this._closedDisplayMode]))}},opened:{get:function(){return!p.hasClass(this._element,k.hiddenClass)&&!p.hasClass(this._element,k.hidingClass)&&this._doNext!==n.minimal&&this._doNext!==n.compact&&this._doNext!==n.none}},onbeforeopen:it(g.beforeOpen),onafteropen:it(g.afterOpen),onbeforeclose:it(g.beforeClose),onafterclose:it(g.afterClose),getCommandById:function(n){var t=this._layoutImpl.commandsInOrder.filter(function(t){return t.id===n||t.element.id===n});return t.length===1?t[0]:t.length===0?null:t},showCommands:function(n){if(!n)throw new f("WinJS.UI._LegacyAppBar.RequiresCommands",nt.requiresCommands);this._layoutImpl.showCommands(n)},hideCommands:function(n){if(!n)throw new f("WinJS.UI._LegacyAppBar.RequiresCommands",nt.requiresCommands);this._layoutImpl.hideCommands(n)},showOnlyCommands:function(n){if(!n)throw new f("WinJS.UI._LegacyAppBar.RequiresCommands",nt.requiresCommands);this._layoutImpl.showOnlyCommands(n)},open:function(){this._writeProfilerMark("show,StartTM");this._show()},_show:function(){var i=n.shown,t=null;!this.disabled&&(p.hasClass(this._element,k.hiddenClass)||p.hasClass(this._element,k.hidingClass))&&(t=ft);this._changeVisiblePosition(i,t);t&&(this._updateFirstAndFinalDiv(),a.shown(this._dismissable))},close:function(){this._writeProfilerMark("hide,StartTM");this._hide()},_hide:function(t){var t=t||n[this.closedDisplayMode],i=null;p.hasClass(this._element,k.hiddenClass)||p.hasClass(this._element,k.hidingClass)||(i=rt);this._changeVisiblePosition(t,i)},_dispose:function(){y.disposeSubTree(this.element);a.hidden(this._dismissable);this._layoutImpl.dispose();this.disabled=!0;this.close()},_disposeChildren:function(){this._layoutImpl.disposeChildren()},_handleKeyDown:function(n){this._invokeButton.contains(t.document.activeElement)||this._layoutImpl.handleKeyDown(n)},_visiblePixels:{get:function(){return{hidden:ut.hidden,minimal:ut.minimal,compact:Math.max(this._heightWithoutLabels||0,ut.compact),shown:this._element.offsetHeight}}},_visiblePosition:{get:function(){return this._animating&&n[this._element.winAnimating]?this._element.winAnimating:this._lastPositionVisited}},_visible:{get:function(){return this._visiblePosition!==n.none}},_changeVisiblePosition:function(t,i){var r,u,f;this._visiblePosition===t&&!this._keyboardObscured||this.disabled&&t!==n.disabled?this._afterPositionChange(null):this._animating||this._needToHandleShowingKeyboard||this._needToHandleHidingKeyboard?(this._doNext=t,this._afterPositionChange(null)):(this._element.winAnimating=t,r=this._initializing?!1:!0,u=this._lastPositionVisited,this._element.style.display="",f=t===n.hidden,this._keyboardObscured&&(f?r=!1:u=n.hidden,this._keyboardObscured=!1),i===ft?this._beforeShow():i===rt&&this._beforeHide(),this._ensurePosition(),this._element.style.opacity=1,this._element.style.visibility="visible",this._animationPromise=r?this._animatePositionChange(u,t):c.wrap(),this._animationPromise.then(function(){this._afterPositionChange(t,i)}.bind(this),function(){this._afterPositionChange(t,i)}.bind(this)))},_afterPositionChange:function(t,i){if(!this._disposed){if(t){t===n.minimal&&(p.addClass(this._element,k.minimalClass),p.removeClass(this._element,k.compactClass));t===n.hidden&&this.closedDisplayMode===w.none&&(p.removeClass(this._element,k.minimalClass),p.removeClass(this._element,k.compactClass));this._element.winAnimating="";this._lastPositionVisited=t;this._doNext===this._lastPositionVisited&&(this._doNext="");i===rt&&a.hidden(this._dismissable);t===n.hidden&&(this._element.style.visibility="hidden",this._element.style.display="none");var r=u._browserStyleEquivalents.transform.scriptName;this._element.style[r]="";i===ft?this._afterShow():i===rt&&this._afterHide();l.schedule(this._checkDoNext,l.Priority.normal,this,"WinJS.UI._LegacyAppBar._checkDoNext")}this._afterPositionChangeCallBack()}},_afterPositionChangeCallBack:function(){},_beforeShow:function(){this._queuedCommandAnimation&&(this._showAndHideFast(this._queuedToShow,this._queuedToHide),this._queuedToShow=[],this._queuedToHide=[]);this._layoutImpl.scale();this.closedDisplayMode===w.compact&&(this._heightWithoutLabels=this._element.offsetHeight);p.removeClass(this._element,k.hiddenClass);p.addClass(this._element,k.showingClass);this._sendEvent(g.beforeOpen)},_afterShow:function(){p.removeClass(this._element,k.showingClass);p.addClass(this._element,k.shownClass);this._sendEvent(g.afterOpen);this._writeProfilerMark("show,StopTM")},_beforeHide:function(){p.removeClass(this._element,k.shownClass);p.addClass(this._element,k.hidingClass);this._sendEvent(g.beforeClose)},_afterHide:function(){this._queuedCommandAnimation&&(this._showAndHideFast(this._queuedToShow,this._queuedToHide),this._queuedToShow=[],this._queuedToHide=[]);p.removeClass(this._element,k.hidingClass);p.addClass(this._element,k.hiddenClass);this._sendEvent(g.afterClose);this._writeProfilerMark("hide,StopTM")},_animatePositionChange:function(t,i){var a=this._layoutImpl.positionChanging(t,i),r,f=this._visiblePixels[t],e=this._visiblePixels[i],o=Math.abs(e-f),u=this._placement===k.appBarPlacementTop?-o:o,s,l;return this._placement===k.appBarPlacementTop&&(t===n.shown&&i===n.compact||t===n.compact&&i===n.shown)&&(u=0),e>f?(s={top:u+"px",left:"0px"},r=h.showEdgeUI(this._element,s,{mechanism:"transition"})):(l={top:u+"px",left:"0px"},r=h.hideEdgeUI(this._element,l,{mechanism:"transition"})),c.join([a,r])},_checkDoNext:function(){this._animating||this._needToHandleShowingKeyboard||this._needToHandleHidingKeyboard||this._disposed||(this._doNext===n.disabled||this._doNext===n.hidden||this._doNext===n.minimal||this._doNext===n.compact?(this._hide(this._doNext),this._doNext=""):this._queuedCommandAnimation?this._showAndHideQueue():this._doNext===n.shown&&(this._show(),this._doNext=""))},_setFocusToAppBar:function(n,t){this._focusOnFirstFocusableElement(n,t)||tt._Overlay._trySetActive(this._element,t)},_commandsUpdated:function(){this._initializing||(this._layoutImpl.commandsUpdated(),this._layoutImpl.scale())},_beginAnimateCommands:function(n,t,i){this._layoutImpl.beginAnimateCommands(n,t,i)},_endAnimateCommands:function(){this._layoutImpl.endAnimateCommands();this._endAnimateCommandsCallBack()},_endAnimateCommandsCallBack:function(){},_getTopOfVisualViewport:function(){return tt._Overlay._keyboardInfo._visibleDocTop},_getAdjustedBottom:function(){return tt._Overlay._keyboardInfo._visibleDocBottomOffset},_showingKeyboard:function(n){if(this._keyboardObscured=!1,this._needToHandleHidingKeyboard=!1,!tt._Overlay._keyboardInfo._visible||!this._alreadyInPlace()){this._needToHandleShowingKeyboard=!0;this.opened&&this._element.contains(t.document.activeElement)&&(n.ensuredFocusedElementInView=!0);this._visible&&this._placement!==k.appBarPlacementTop&&tt._Overlay._isFlyoutVisible()?this._keyboardObscured=!0:this._scrollHappened=!1;var i=this;t.setTimeout(function(n){i._checkKeyboardTimer(n)},tt._Overlay._keyboardInfo._animationShowLength+tt._Overlay._scrollTimeout)}},_hidingKeyboard:function(){this._keyboardObscured=!1;this._needToHandleShowingKeyboard=!1;this._needToHandleHidingKeyboard=!0;tt._Overlay._keyboardInfo._isResized||((this._visible||this._animating)&&(this._checkScrollPosition(),this._element.style.display=""),this._needToHandleHidingKeyboard=!1)},_resize:function(n){this._needToHandleShowingKeyboard?this._visible&&(this._placement===k.appBarPlacementTop||this._keyboardObscured||(this._element.style.display="none")):this._needToHandleHidingKeyboard&&(this._needToHandleHidingKeyboard=!1,(this._visible||this._animating)&&(this._checkScrollPosition(),this._element.style.display=""));this._initializing||this._layoutImpl.resize(n)},_checkKeyboardTimer:function(){this._scrollHappened||this._mayEdgeBackIn()},_manipulationChanged:function(n){n.currentState===0&&this._scrollHappened&&this._mayEdgeBackIn()},_mayEdgeBackIn:function(){if(this._needToHandleShowingKeyboard)if(this._needToHandleShowingKeyboard=!1,this._keyboardObscured||this._placement===k.appBarPlacementTop&&tt._Overlay._keyboardInfo._visibleDocTop===0)this._checkDoNext();else{var t=this._visiblePosition;this._lastPositionVisited=n.hidden;this._changeVisiblePosition(t,!1)}this._scrollHappened=!1},_ensurePosition:function(){var n=this._computePositionOffset();this._element.style.bottom=n.bottom;this._element.style.top=n.top},_computePositionOffset:function(){var n={};return this._placement===k.appBarPlacementBottom?(n.bottom=this._getAdjustedBottom()+"px",n.top=""):this._placement===k.appBarPlacementTop&&(n.bottom="",n.top=this._getTopOfVisualViewport()+"px"),n},_checkScrollPosition:function(){if(this._needToHandleShowingKeyboard){this._scrollHappened=!0;return}(this._visible||this._animating)&&(this._ensurePosition(),this._checkDoNext())},_alreadyInPlace:function(){var n=this._computePositionOffset();return n.top===this._element.style.top&&n.bottom===this._element.style.bottom},_updateFirstAndFinalDiv:function(){var i=this._element.querySelectorAll("."+k.firstDivClass),n,r,u;i=i.length>=1?i[0]:null;n=this._element.querySelectorAll("."+k.finalDivClass);n=n.length>=1?n[0]:null;i&&this._element.children[0]!==i&&(i.parentNode.removeChild(i),i=null);n&&this._element.children[this._element.children.length-1]!==n&&(n.parentNode.removeChild(n),n=null);i||(i=t.document.createElement("div"),i.style.display="inline",i.className=k.firstDivClass,i.tabIndex=-1,i.setAttribute("aria-hidden","true"),p._addEventListener(i,"focusin",this._focusOnLastFocusableElementOrThis.bind(this),!1),this._element.children[0]?this._element.insertBefore(i,this._element.children[0]):this._element.appendChild(i));n||(n=t.document.createElement("div"),n.style.display="inline",n.className=k.finalDivClass,n.tabIndex=-1,n.setAttribute("aria-hidden","true"),p._addEventListener(n,"focusin",this._focusOnFirstFocusableElementOrThis.bind(this),!1),this._element.appendChild(n));this._element.children[this._element.children.length-2]!==this._invokeButton&&this._element.insertBefore(this._invokeButton,n);r=this._element.getElementsByTagName("*");u=p._getHighestTabIndexInList(r);this._invokeButton.tabIndex=u;i&&(i.tabIndex=p._getLowestTabIndexInList(r));n&&(n.tabIndex=u)},_writeProfilerMark:function(n){s("WinJS.UI._LegacyAppBar:"+this._id+":"+n)}},{_Events:g})})})}),t("WinJS/Controls/MediaPlayer/MediaElementAdapter",["exports","../../Core/_Global","../../Core/_WinRT","../../Core/_Base","../../Core/_ErrorFromName","../../Core/_Resources","../../Navigation","../../Utilities/_Control","../../Utilities/_ElementUtilities"],function(n,t,i,r,u,f,e,o,s){"use strict";var h=s,l={get mediaElementAdapterConstructorNullParameter(){return f._getWinJSString("ui/mediaElementAdapterConstructorNullParameter").value}},c=r.Class.define(function(n,t){this.baseMediaElementAdapterConstructor(n,t)},{_resetInternalState:function(){this.liveTime=0;this.isPauseAllowed=!0;this.isPlayAllowed=!0;this.isLive=!1;this.seekAllowed=!0},liveTime:{get:function(){return this._liveTime},set:function(n){this._liveTime=n}},isLive:{get:function(){return this._isLive},set:function(n){this._isLive=n}},pauseAllowed:{get:function(){return this._pauseAllowed},set:function(n){this._pauseAllowed=n;n?(this._mediaPlayer._playPauseButton.disabled=!1,this._smtControls&&(this._smtControls.isPauseEnabled=!0)):(this._mediaPlayer._playPauseButton.disabled=!0,this._smtControls&&(this._smtControls.isPauseEnabled=!1))}},isPauseAllowed:{get:function(){return this.pauseAllowed},set:function(n){this.pauseAllowed=n}},playAllowed:{get:function(){return this._playAllowed},set:function(n){this._playAllowed=n;n?(this._mediaPlayer._playPauseButton.disabled=!1,this._smtControls&&(this._smtControls.isPlayEnabled=!0)):(this._mediaPlayer._playPauseButton.disabled=!0,this._smtControls&&(this._smtControls.isPlayEnabled=!1))}},isPlayAllowed:{get:function(){return this.playAllowed},set:function(n){this.playAllowed=n}},seekAllowed:{get:function(){return this._seekAllowed},set:function(n){this._seekAllowed=n;n?(this._mediaPlayer._chapterSkipBackButton&&(this._mediaPlayer._chapterSkipBackButton.disabled=!1),this._mediaPlayer._chapterSkipForwardButton&&(this._mediaPlayer._chapterSkipForwardButton.disabled=!1),this._mediaPlayer._fastForwardButton&&(this._mediaPlayer._fastForwardButton.disabled=!1,this._smtControls&&(this._smtControls.isFastForwardEnabled=!0)),this._mediaPlayer._rewindButton&&(this._mediaPlayer._rewindButton.disabled=!1,this._smtControls&&(this._smtControls.isRewindEnabled=!0)),this._mediaPlayer._timeSkipBackButton&&(this._mediaPlayer._timeSkipBackButton.disabled=!1),this._mediaPlayer._timeSkipForwardButton&&(this._mediaPlayer._timeSkipForwardButton.disabled=!1),h.removeClass(this._mediaPlayer._element,"win-mediaplayer-seekbar-disabled")):(this._mediaPlayer._chapterSkipBackButton&&(this._mediaPlayer._chapterSkipBackButton.disabled=!0),this._mediaPlayer._chapterSkipForwardButton&&(this._mediaPlayer._chapterSkipForwardButton.disabled=!0),this._mediaPlayer._fastForwardButton&&(this._mediaPlayer._fastForwardButton.disabled=!0,this._smtControls&&(this._smtControls.isFastForwardEnabled=!1)),this._mediaPlayer._rewindButton&&(this._mediaPlayer._rewindButton.disabled=!0,this._smtControls&&(this._smtControls.isRewindEnabled=!1)),this._mediaPlayer._timeSkipBackButton&&(this._mediaPlayer._timeSkipBackButton.disabled=!0),this._mediaPlayer._timeSkipForwardButton&&(this._mediaPlayer._timeSkipForwardButton.disabled=!0),h.addClass(this._mediaPlayer._element,"win-mediaplayer-seekbar-disabled"))}},isSeekAllowed:{get:function(){return this.seekAllowed},set:function(n){this.seekAllowed=n}},mediaElement:{get:function(){return this._mediaElement},set:function(n){var r=this._mediaElement,i;this._mediaElement=n;this._resetInternalState();this._mediaPlayer._setupNewMediaElement(this._mediaElement,r);this._mediaPlayer&&this._mediaPlayer.element&&(i=t.document.createEvent("Event"),i.initEvent("mediaelementchanged",!0,!1),this._mediaPlayer.element.dispatchEvent(i))}},baseMediaElementAdapterConstructor:function(n,t){if(this._disposed=!1,this._liveTime=0,this._pauseAllowed=!0,this._playAllowed=!0,this._isLive=!1,this._seekAllowed=!0,this._mediaElement=null,this._mediaPlayer=null,this._smtControls=null,n)this._mediaPlayer=n;else throw new u("WinJS.UI.MediaElementAdapter.nullParameter",l.mediaElementAdapterConstructorNullParameter);if(h.hasWinRT&&i.Windows.Media.SystemMediaTransportControls&&(this._smtControls=i.Windows.Media.SystemMediaTransportControls.getForCurrentView()),t)this._mediaElement=t;else{var r=this._mediaPlayer._element;r&&r.getElementsByTagName&&(this.mediaElement=r.getElementsByTagName("video")[0],this.mediaElement||(this.mediaElement=r.getElementsByTagName("audio")[0]))}},dispose:function(){this._disposed||(this._disposed=!0,this._mediaElement&&this._mediaElement.removeAttribute("src"),this._liveTime=null,this._mediaElement=null,this._mediaPlayer=null,this._smtControls=null)},nextTrack:function(){},pause:function(){this._mediaElement&&this._pauseAllowed&&this._mediaElement.pause()},play:function(){this._mediaElement&&this._playAllowed&&this._mediaElement.play()},previousTrack:function(){},seek:function(n){this._mediaElement&&this._seekAllowed&&(this._mediaElement.currentTime=n)},stop:function(){this._mediaElement&&this._seekAllowed&&(this._mediaElement.currentTime=this._mediaPlayer?this._mediaPlayer.startTime:0,this._mediaElement.pause())}});return r.Namespace.define("WinJS.UI",{MediaElementAdapter:c}),c}),t("WinJS/Controls/MediaPlayer/_MediaUI",["exports","../../Core/_BaseCoreUtils","../../Core/_Base"],function(n,t,i){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{Layout:{full:"full",partial:"partial"},MediaCommand:{audioTracks:"audioTracks",cast:"cast",chapterSkipBack:"chapterSkipBack",chapterSkipForward:"chapterSkipForward",closedCaptions:"closedCaptions",fastForward:"fastForward",goToLive:"goToLive",nextTrack:"nextTrack",pause:"pause",play:"play",playbackRate:"playbackRate",playFromBeginning:"playFromBeginning",previousTrack:"previousTrack",rewind:"rewind",seek:"seek",stop:"stop",timeSkipBack:"timeSkipBack",timeSkipForward:"timeSkipForward",volume:"volume",zoom:"zoom"},MarkerType:{advertisement:"advertisement",chapter:"chapter",custom:"custom"}})}),t("require-style!less/styles-mediaplayer",[],function(){}),t("require-style!less/colors-mediaplayer",[],function(){}),t("WinJS/Controls/MediaPlayer",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_Events","../Core/_ErrorFromName","../Res","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../_Signal","../Scheduler","../Application","../BindingList","../Animations","../Animations/_TransitionAnimation","../Navigation","../Utilities/_Dispose","../Utilities/_Control","../ControlProcessor","../Controls/AppBar/_Command","../Controls/AppBar/_Icon","../Controls/MediaPlayer/MediaElementAdapter","../Controls/BackButton","../Controls/Flyout","../Controls/ToolBar/_ToolBar","../Utilities/_ElementUtilities","../Controls/MediaPlayer/_MediaUI","require-style!less/styles-mediaplayer","require-style!less/colors-mediaplayer"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){"use strict";var at=a,ct=w,ot=ft,lt=et.Layout,st=et.MediaCommand,ht=et.MarkerType;r.Namespace.define("WinJS.UI",{MediaPlayer:r.Namespace._lazy(function(){function vt(n,t,i){return n.keyframe?n.keyframe:!i||n.left!==t.left||n.top!==t.top||n.rtlflip&&!t.rtlflip?null:n.rtlflip?yt(i):i}function wt(n,t){return!t||!n.rtlflip?t:yt(t)}function yt(n){var i=n+"-rtl";return function(r,u){return t.window.getComputedStyle(u).direction==="ltr"?n:i}}function et(n,i){return i=i||"",function(r,u){var e=n.getOffset(r),f=e.left;return e.rtlflip&&t.window.getComputedStyle(u).direction==="rtl"&&(f=f.toString(),f=f.charAt(0)==="-"?f.substring(1):"-"+f),i+"translate("+f+", "+e.top+")"}}var a=null,y;ot.hasWinRT&&i.Windows.Xbox&&i.Windows.Xbox.SmartGlass&&(a=i.Windows.Xbox.SmartGlass);var n={get chapterSkipBackMediaCommandDisplayText(){return o._getWinJSString("ui/chapterSkipBackMediaCommandDisplayText").value},get chapterSkipForwardMediaCommandDisplayText(){return o._getWinJSString("ui/chapterSkipForwardMediaCommandDisplayText").value},get closedCaptionsLabelNone(){return o._getWinJSString("ui/closedCaptionsLabelNone").value},get closedCaptionsMediaCommandDisplayText(){return o._getWinJSString("ui/closedCaptionsMediaCommandDisplayText").value},get fastForwardMediaCommandDisplayText(){return o._getWinJSString("ui/fastForwardMediaCommandDisplayText").value},get fastForwardFeedbackDisplayText(){return o._getWinJSString("ui/fastForwardFeedbackDisplayText").value},get fastForwardFeedbackSlowMotionDisplayText(){return o._getWinJSString("ui/fastForwardFeedbackSlowMotionDisplayText").value},get goToFullScreenButtonLabel(){return o._getWinJSString("ui/goToFullScreenButtonLabel").value},get goToLiveMediaCommandDisplayText(){return o._getWinJSString("ui/goToLiveMediaCommandDisplayText").value},get mediaErrorAborted(){return o._getWinJSString("ui/mediaErrorAborted").value},get mediaErrorNetwork(){return o._getWinJSString("ui/mediaErrorNetwork").value},get mediaErrorDecode(){return o._getWinJSString("ui/mediaErrorDecode").value},get mediaErrorSourceNotSupported(){return o._getWinJSString("ui/mediaErrorSourceNotSupported").value},get mediaErrorUnknown(){return o._getWinJSString("ui/mediaErrorUnknown").value},get mediaPlayerAddMarkerErrorInvalidMarkerType(){return"Invalid argument: The type used is not supported."},get mediaPlayerOverlayActiveOptionIndicator(){return o._getWinJSString("ui/mediaPlayerOverlayActiveOptionIndicator").value},get mediaPlayerLayvolumeoutUnsupportedValue(){return"Invalid argument: The value for XboxJS.UI.MediaPlayer.layout is not supported."},get mediaPlayerInvalidTimeValue(){return"Invalid argument: Time must be a number."},get mediaPlayerNullContentType(){return"Invalid argument: contentType cannot be null."},get mediaPlayerNullMetadata(){return"Invalid argument: metadata cannot be null."},get mediaPlayerSetContentMetadataInvalidContentRating(){return"Invalid argument: contentRating is empty or incorrectly formatted."},get nextTrackMediaCommandDisplayText(){return o._getWinJSString("ui/nextTrackMediaCommandDisplayText").value},get playbackRateHalfSpeedLabel(){return o._getWinJSString("ui/playbackRateHalfSpeedLabel").value},get playbackRateNormalSpeedLabel(){return o._getWinJSString("ui/playbackRateNormalSpeedLabel").value},get playbackRateOneAndHalfSpeedLabel(){return o._getWinJSString("ui/playbackRateOneAndHalfSpeedLabel").value},get playbackRateDoubleSpeedLabel(){return o._getWinJSString("ui/playbackRateDoubleSpeedLabel").value},get playMediaCommandDisplayText(){return o._getWinJSString("ui/playMediaCommandDisplayText").value},get playFromBeginningMediaCommandDisplayText(){return o._getWinJSString("ui/playMediaCommandDisplayText").value},get pauseMediaCommandDisplayText(){return o._getWinJSString("ui/pauseMediaCommandDisplayText").value},get previousTrackMediaCommandDisplayText(){return o._getWinJSString("ui/playFromBeginningMediaCommandDisplayText").value},get replayMediaCommandDisplayText(){return o._getWinJSString("ui/replayMediaCommandDisplayText").value},get rewindMediaCommandDisplayText(){return o._getWinJSString("ui/rewindMediaCommandDisplayText").value},get rewindFeedbackDisplayText(){return o._getWinJSString("ui/rewindFeedbackDisplayText").value},get rewindFeedbackSlowMotionDisplayText(){return o._getWinJSString("ui/rewindFeedbackSlowMotionDisplayText").value},get stopMediaCommandDisplayText(){return o._getWinJSString("ui/stopMediaCommandDisplayText").value},get timeSeparator(){return o._getWinJSString("ui/timeSeparator").value},get timeSkipBackMediaCommandDisplayText(){return o._getWinJSString("ui/timeSkipBackMediaCommandDisplayText").value},get timeSkipForwardMediaCommandDisplayText(){return o._getWinJSString("ui/timeSkipForwardMediaCommandDisplayText").value},get mediaPlayerAudioTracksButtonLabel(){return o._getWinJSString("ui/mediaPlayerAudioTracksButtonLabel").value},get mediaPlayerStopButtonLabel(){return o._getWinJSString("ui/mediaPlayerStopButtonLabel").value},get mediaPlayerPreviousTrackButtonLabel(){return o._getWinJSString("ui/mediaPlayerPreviousTrackButtonLabel").value},get mediaPlayerPlayFromBeginningButtonLabel(){return o._getWinJSString("ui/mediaPlayerPlayFromBeginningButtonLabel").value},get mediaPlayerChapterSkipBackButtonLabel(){return o._getWinJSString("ui/mediaPlayerChapterSkipBackButtonLabel").value},get mediaPlayerRewindButtonLabel(){return o._getWinJSString("ui/mediaPlayerRewindButtonLabel").value},get mediaPlayerTimeSkipBackButtonLabel(){return o._getWinJSString("ui/mediaPlayerTimeSkipBackButtonLabel").value},get mediaPlayerPlayButtonLabel(){return o._getWinJSString("ui/mediaPlayerPlayButtonLabel").value},get mediaPlayerPlayRateButtonLabel(){return o._getWinJSString("ui/mediaPlayerPlayRateButtonLabel").value},get mediaPlayerTimeSkipForwardButtonLabel(){return o._getWinJSString("ui/mediaPlayerTimeSkipForwardButtonLabel").value},get mediaPlayerFastForwardButtonLabel(){return o._getWinJSString("ui/mediaPlayerFastForwardButtonLabel").value},get mediaPlayerChapterSkipForwardButtonLabel(){return o._getWinJSString("ui/mediaPlayerChapterSkipForwardButtonLabel").value},get mediaPlayerNextTrackButtonLabel(){return o._getWinJSString("ui/mediaPlayerNextTrackButtonLabel").value},get mediaPlayerClosedCaptionsButtonLabel(){return o._getWinJSString("ui/mediaPlayerClosedCaptionsButtonLabel").value},get mediaPlayerZoomButtonLabel(){return o._getWinJSString("ui/mediaPlayerZoomButtonLabel").value},get mediaPlayerLiveButtonLabel(){return o._getWinJSString("ui/mediaPlayerLiveButtonLabel").value},get mediaPlayerToggleSnapButtonLabel(){return o._getWinJSString("ui/mediaPlayerToggleSnapButtonLabel").value},get mediaPlayerCastButtonLabel(){return o._getWinJSString("ui/mediaPlayerCastButtonLabel").value},get mediaPlayerVolumeButtonLabel(){return o._getWinJSString("ui/mediaPlayerVolumeButtonLabel").value},get mediaPlayerFullscreenButtonLabel(){return o._getWinJSString("ui/mediaPlayerFullscreenButtonLabel").value}},c=ot.hasWinRT&&i.Windows.UI.ViewManagement,pt=[{top:"0px",left:"11px",rtlflip:!0}],ft=r.Class.define(function(n,t,i){i=i||pt;Array.isArray(n)&&n.length>0?(this.offsetArray=n,n.length===1&&(this.keyframe=vt(n[0],i[0],t))):n&&n.hasOwnProperty("top")&&n.hasOwnProperty("left")?(this.offsetArray=[n],this.keyframe=vt(n,i[0],t)):(this.offsetArray=i,this.keyframe=wt(i[0],t))},{getOffset:function(n){return n>=this.offsetArray.length&&(n=this.offsetArray.length-1),this.offsetArray[n]}},{supportedForProcessing:!1});return y=r.Class.define(function(r,u){s("WinJS.UI.MediaPlayer:constructor,StartTM");r=r||t.document.createElement("div");r.winControl=this;ot.addClass(r,"win-disposable win-mediaplayer win-mediaplayer-doublerow");this._adjustedContentType=null;this._audioTracksButton=null;this._areControlsHiding=!1;this._backButton=null;this._busyIndicator=null;this._buttonEventSubscriptions=[];this._castButton=null;this._chapterSkipBackButton=null;this._chapterSkipForwardButton=null;this._closedCaptionsButton=null;this._commandsOverflowFlyout=null;this._element=r;ot.hasWinRT&&i.Windows.Media.ContentRestrictions&&i.Windows.Media.ContentRestrictions.RatedContentRestrictions&&(this._contentRestrictions=new i.Windows.Media.ContentRestrictions.RatedContentRestrictions);this._checkPremiumVideoPrivilegeBind=this._checkPremiumVideoPrivilege.bind(this);this._checkParentalControlsBind=this._checkParentalControls.bind(this);this._checkPremiumVideoAndParentalControlsBind=this._checkPremiumVideoAndParentalControls.bind(this);this._controlHideTimeout=null;this._controls=null;this._controlsAddedHideDuration=null;this._controlsFadeInAnimation=null;this._controlsFadeOutAnimation=null;this._controlsKeyupInputHandler=null;this._currentTimeIndicator=null;this._currentTimeVisualElements=null;this._currentScrubbingVelocity=0;this._defaultChapterMarkers=[];this._disposed=!1;this._doesEndTimeNeedResetting=!0;this._doesStartTimeNeedResetting=!0;this._doMarkersNeedResetting=!0;this._endTime=0;this._endTimeReached=!1;this._errorFlyout=null;this._errorText=null;this._fastForwardButton=null;this._fastForwardOrRewindTimer=null;this._fastForwardOrRewindTimerElapsedTime=0;this._gestureEventSubscriptions=[];this._gestureRecognizer=null;ot.hasWinRT&&(this._gestureRecognizer=new i.Windows.UI.Input.GestureRecognizer,this._gestureRecognizer.gestureSettings=i.Windows.UI.Input.GestureSettings.manipulationTranslateX|i.Windows.UI.Input.GestureSettings.manipulationTranslateY);this._goToFullScreenButton=null;this._goToLiveButton=null;this._handleBeforeShowOverflowMenuBind=this._handleBeforeShowOverflowMenu.bind(this);this._handleCheckpointCallback=null;this._handleSeekedAfterExitFastForwardOrRewindBind=null;this._handleSystemTransportControlsButtonPressedBind=null;this._handleTransportBarButtonFocus=null;this._handleTransportBarButtonFocusBind=null;this._handleVoiceEngagedBind=null;this._handleVoiceDisengagedBind=null;this._hasCustomMarkers=!1;this._inputHandlerClickCallback=null;this._inputHandlerPointerDownCallback;this._inputHandlerPointerMoveCallback=null;this._inputHandlerPointerUpCallback=null;this._inputHandlerElement=null;this._isBusyInternal=!1;this._isChapterMarkerVisualsDirty=!1;this._compact=!1;this._controlsVisible=!1;this._isInFastForwardOrRewindMode=!1;this._fullScreen=!1;this._handleTimelineArrowKeyDownBind=this._handleTimelineArrowKeyDown.bind(this);this._isHandAtLeftEdge=!1;this._isHandAtRightEdge=!1;this._isPointerDown=!1;this._isSeekWindowEnabled=!1;this._isThumbnailEnabled=!0;this._isThumbGrabbed=!1;this._keydownInputHandler=null;this._keyupInputHandler=null;this._lastControlsResetTimeStamp=null;this._lastFastForwardOrRewindTimerTime=0;this._lastPointerPosition="0,0";this._lastPosition=0;this._layout=null;this._loadTextTrackCallback=null;this._markers=[];this._mediaCommandFeedbackText=null;this._mediaElementAdapter=null;this._mediaEventSubscriptions=[];this._mediaMetadata=null;this._mediaState={};this._metadataTitle=null;this._metadataDescription=null;this._muteButton=null;this._nextCustomMarkerIndex=-1;this._nextCustomMarkerTime=-1;this._nextTrackButton=null;this._onHideControlsCommandInvokedBind=null;this._onShowControlsCommandInvokedBind=null;this._playbackSpeedIndicator=null;this._playbackRateButton=null;this._playbackRateFlyout=null;this._playPauseButton=null;this._playFromBeginningButton=null;this._pendingAdditionalCommands=null;this._previousPlaybackRate=0;this._previousCustomMarkerIndex=-1;this._previousCustomMarkerTime=-1;this._previousTrackButton=null;this._previousVolumeValue=0;this._progress=null;this._progressContainer=null;this._updateMediaStateBind=null;this._relativeTimelineStartOffset=0;this._rewindButton=null;this._seekBar=null;this._seekMark=null;this._seekTimeIndicator=null;this._seekWindowLeftEdgeElement=null;this._seekWindowRightEdgeElement=null;this._smartGlassInputHandler=null;this._startOffsetX=0;this._startTime=0;this._stopButton=null;this._smtControls=null;ot.hasWinRT&&i.Windows.Media.SystemMediaTransportControls&&(this._smtControls=i.Windows.Media.SystemMediaTransportControls.getForCurrentView());this._targetPlaybackRate=0;this._targetCurrentTime=0;this._minimumSeekableRangeInPixels=0;this._thumbElement=null;this._thumbElementWidthDividedByTwo=0;this._thumbnailEnabled=!0;this._thumbnailImage=null;this._thumbnailImageVisual=null;this._thumbImageElementWidthDividedByTwo=0;this._toggleFullScreenButton=null;this._timeline=null;this._timeBeforeShowingBusyVisual=1e3;this._timeFormatter=this._defaultTimeFormatter;this._timeRemainingIndicator=null;this._timeSeparator=n.timeSeparator;this._timeSkipBackButton=null;this._timeSkipForwardButton=null;this._toolbar=null;this._toolbarElement=null;this._totalSeekBarWidth=0;this._totalTimeInternal=0;this._totalTimeIndicator=null;this._transportControls=null;this._updateAudioTracksButtonStateBind=this._updateAudioTracksButtonState.bind(this);this._updateClosedCaptionsButtonStateBind=this._updateClosedCaptionsButtonState.bind(this);this._volumeButton=null;this._volumeFlyout=null;this._volumeSlider=null;this._volumeValue=null;this._wasStartTimeSetProgrammatically=!1;this._wasEndTimeSetProgrammatically=!1;this._wasDragAndNotClick=!1;this._wasPausedBeforeScrubbing=!1;this._wasPlayingBeforeSuspend=!1;this._wasTimeClampedToEndTime=!1;this._windowResizeCallback=null;this._zoomButton=null;this._chapterSkipBackButtonVisible=!1;this._chapterSkipForwardButtonVisible=!1;this._fastForwardButtonVisible=!1;this._nextTrackButtonVisible=!1;this._playFromBeginningButtonVisible=!1;this._playPauseButtonVisible=!0;this._playbackRateButtonVisible=!1;this._previousTrackButtonVisible=!1;this._rewindButtonVisible=!1;this._stopButtonVisible=!1;this._timeSkipBackButtonVisible=!1;this._timeSkipForwardButtonVisible=!1;this._zoomButtonVisible=!1;this._goToLiveButtonVisible=!1;this._fullScreenButtonVisible=!0;this._castButtonVisible=!1;this._playbackRateButtonVisible=!1;this._muteButtonVisible=!1;this._volumeButtonVisible=!0;this._seekBarVisible=!0;this._chapterSkipBackButtonEnabled=!0;this._chapterSkipForwardButtonEnabled=!0;this._fastForwardButtonEnabled=!0;this._nextTrackButtonEnabled=!0;this._playFromBeginningButtonEnabled=!0;this._playPauseButtonEnabled=!0;this._previousTrackButtonEnabled=!0;this._rewindButtonEnabled=!0;this._stopButtonEnabled=!0;this._timeSkipBackButtonEnabled=!0;this._timeSkipForwardButtonEnabled=!0;this._zoomButtonEnabled=!0;this._goToLiveButtonEnabled=!0;this._castButtonEnabled=!0;this._fullScreenButtonEnabled=!0;this._playbackRateButtonEnabled=!0;this._volumeButtonEnabled=!0;this._muteButtonEnabled=!0;this._seekingEnabled=!0;this._skipAnimations=!1;this._CHAPTER_SKIP_THRESHOLD=1;this._CONTROLS_AUTO_HIDE_DURATION=3e3;this._FAST_FORWARD_OR_REWIND_TIMER_INTERVAL=250;this._MARKER_PROXIMITY_THRESHOLD=.5;this._MINIMUM_MEDIA_LENGTH_FOR_DEFAULT_MARKERS=60;this._MINIMUM_ACCURATE_SEEKABLE_RANGE=1800;this._MINIMUM_POINTER_DELTA_TO_ENABLE_SNAPPING_TO_NEAREST_MARKER=4;this._GESTURE_REGION_FOR_MOVING_THE_SEEKABLE_WINDOW=200;this._REPORT_MEDIA_STATE_INTERVAL=5e3;this._SEEK_OFFSET=.1;this._SKIP_BACK_INTERVAL=8;this._SKIP_FORWARD_INTERVAL=30;this._SNAP_TO_NEAREST_MARKER_THRESHOLD=.005;this._MEDIA_READY_STATE_HAVE_NOTHING=0;this._MEDIA_READY_STATE_HAVE_METADATA=1;this._MEDIA_READY_STATE_HAVE_CURRENT_DATA=2;this._MEDIA_READY_STATE_HAVE_FUTURE_DATA=3;this._MEDIA_READY_STATE_HAVE_ENOUGH_DATA=4;this._PLAYBACKRATE_FAST_FORWARD_MAX_RATE=128;this._PLAYBACKRATE_FAST_FORWARD_128X=128;this._PLAYBACKRATE_FAST_FORWARD_64X=64;this._PLAYBACKRATE_FAST_FORWARD_32X=32;this._PLAYBACKRATE_FAST_FORWARD_16X=16;this._PLAYBACKRATE_FAST_FORWARD_8X=8;this._PLAYBACKRATE_FAST_FORWARD_4X=4;this._PLAYBACKRATE_FAST_FORWARD_2X=2;this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE=.5;this._PLAYBACKRATE_PLAYING=1;this._PLAYBACKRATE_NOT_PLAYING=1;this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE=-.5;this._PLAYBACKRATE_REWIND_2X=-2;this._PLAYBACKRATE_REWIND_4X=-4;this._PLAYBACKRATE_REWIND_8X=-8;this._PLAYBACKRATE_REWIND_16X=-16;this._PLAYBACKRATE_REWIND_32X=-32;this._PLAYBACKRATE_REWIND_64X=-64;this._PLAYBACKRATE_REWIND_128X=-128;this._PLAYBACKRATE_REWIND_MAX_RATE=-128;this._TAG_NAME_AUDIO="AUDIO";this._TAG_NAME_VIDEO="VIDEO";this._layout=u&&u.layout?u.layout:lt.full;this._mediaPlayerHtml='<div class="win-mediaplayer-container">   <div class="win-mediaplayer-controls win-mediaplayer-hidden">       <div class="win-mediaplayer-mediatitle"><\/div>       <div class="win-mediaplayer-mediadescription"><\/div>       <div class="win-mediaplayer-transportcontrols">        <div class="win-mediaplayer-timeline win-mediaplayer-thumbnailmode" tabIndex="0">            <div class="win-mediaplayer-progresscontainer">                <div class="win-mediaplayer-seekbar">                  <div class="win-mediaplayer-buffer"><\/div>                  <div class="win-mediaplayer-seekprogress"><\/div>                  <div class="win-mediaplayer-seekbarvisualelements-container">                      <div class="win-mediaplayer-thumb win-mediaplayer-hidden">                          <div class="win-mediaplayer-thumbvisual"><\/div>                      <\/div>                      <div class="win-mediaplayer-thumbnail win-mediaplayer-hidden">                          <div class="win-mediaplayer-thumbnailvisual">                              <div class="win-mediaplayer-playbackspeedindicator"><\/div>                              <div class="win-mediaplayer-seektimeindicator"><\/div>                          <\/div>                      <\/div>                      <div class="win-mediaplayer-seek-mark"><\/div>                  <\/div>                  <div class="win-mediaplayer-seek-leftboundary win-invisible"><\/div>                  <div class="win-mediaplayer-seek-rightboundary win-invisible"><\/div>                <\/div>                <div class="win-mediaplayer-currenttimeindicator"><\/div>                <div class="win-mediaplayer-timeremainingindicator"><\/div>                <div class="win-mediaplayer-totaltimeindicator"><\/div>            <\/div>            <div class="win-mediaplayer-inputfeedback"><\/div>         <\/div>         <div class="win-mediaplayer-commands" data-win-control="WinJS.UI.ToolBar">         <\/div>       <\/div>    <\/div><\/div><div class="win-mediaplayer-inputhandler"><\/div><progress class="win-mediaplayer-busy win-mediaplayer-hidden win-ring win-large"><\/progress>';var f=this;this._keydownInputHandler=function(n){f._onInputHandlerKeyDown(n)};this._keyupInputHandler=function(n){f._onInputHandlerKeyUp(n)};this._controlsKeyupInputHandler=function(n){f._onControlsKeyupInputHandler(n)};this._windowResizeCallback=function(){if(!f._disposed){var n=f._element.querySelector(".win-mediaplayer-controls");n&&(ot.hasWinRT&&i.Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily==="Windows.Xbox"&&(this._isXboxSnapMode?(ot.removeClass(n,"win-mediaplayer-hidden"),f.showControls()):(ot.addClass(n,"win-mediaplayer-hidden"),f._controlsVisible=!1,f.hideControls())),f._controlsVisible&&(f._updateChapterMarkerVisuals(),f._updateTimelineVisuals()),l.schedule(function(){f._disposed||(f._totalSeekBarWidth=f._seekBar.clientWidth,f._seekBarLeftOffset=f._seekBar.offsetLeft,f._thumbElementWidthDividedByTwo=f._thumbElement.clientWidth/2,f._thumbImageElementWidthDividedByTwo=f._thumbnailImage.clientWidth/2)},l.Priority.normal,this))}};t.window.addEventListener("resize",this._windowResizeCallback,!1);this._handleVisibilityChangedCallback=function(){t.document.visibilityState==="hidden"?(f._wasPlayingBeforeSuspend=f._mediaElementAdapter.mediaElement&&f._mediaElementAdapter.mediaElement.paused?!1:!0,f.pause()):t.document.visibilityState==="visible"&&(f._wasPlayingBeforeSuspend?f.play():f.pause())};t.document.addEventListener("visibilitychange",this._handleVisibilityChangedCallback,!1);this._handleCheckpointCallback=function(){f.pause()};at.addEventListener("checkpoint",this._handleCheckpointCallback,!1);this._updateDomElements();u&&k.setOptions(this,u);this._mediaElementAdapter||(this.mediaElementAdapter=new tt(this,null));this._isXboxSnapMode&&this._showControls(!0);this._handleBeforeNavigatedCallback=function(){f._handleBeforeNavigated()};ct.addEventListener("beforenavigate",this._handleBeforeNavigatedCallback,!1);this._updateMediaStateBind=this._updateMediaState.bind(this);this._updateMediaStateTimerCookie=t.setInterval(this._updateMediaStateBind,this._REPORT_MEDIA_STATE_INTERVAL);ot.hasWinRT&&i.Windows.UI.WebUI.WebUIApplication.addEventListener("resuming",this._checkPremiumVideoAndParentalControlsBind,!1);this._contentRestrictions&&this._contentRestrictions.addEventListener("restrictionschanged",this._checkParentalControlsBind,!1);this._onShowControlsCommandInvokedBind=this._onShowControlsCommandInvoked.bind(this);this._onHideControlsCommandInvokedBind=this._onHideControlsCommandInvoked.bind(this);ot.hasWinRT&&i.Windows.Media.SystemMediaTransportControls&&(this._smtControls.isStopEnabled=ct.canGoBack,this._handleSystemTransportControlsButtonPressedBind=this._handleSystemTransportControlsButtonPressed.bind(this),this._handleSystemTransportControlsPropertyChangedBind=this._handleSystemTransportControlsPropertyChanged.bind(this),this._smtControls.addEventListener("buttonpressed",this._handleSystemTransportControlsButtonPressedBind,!1),this._smtControls.addEventListener("propertychanged",this._handleSystemTransportControlsPropertyChangedBind,!1));s("WinJS.UI.MediaPlayer:constructor,StopTM")},{_isBusy:{get:function(){return this._isBusyInternal},set:function(n){if(!this._disposed){this._isBusyInternal=n;var t=this;n?(ot.removeClass(this._busyIndicator,"win-mediaplayer-hidden"),p.executeTransition(this._busyIndicator,[{property:"opacity",delay:0,duration:200,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:0,to:1}])):h.timeout(1e3).then(function(){if(t._busyIndicator){var n=p.executeTransition(t._busyIndicator,[{property:"opacity",delay:0,duration:200,timing:"cubic-bezier(0.1, 0.9, 0.2, 1)",from:1,to:0}]);n.done(function(){t._busyIndicator&&ot.addClass(t._busyIndicator,"win-mediaplayer-hidden")})}});this._updateMediaState(!1)}}},_isXbox:{get:function(){return ot.hasWinRT&&i.Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily==="Windows.Xbox"?!0:!1}},isXboxSnapMode:{get:function(){return this._isXbox&&t.window.screenWidth<=480?!0:!1}},_totalTime:{get:function(){return this._totalTimeInternal},set:function(n){this._totalTimeInternal=n;!this._markers.length&&this._totalTimeInternal>this._MINIMUM_MEDIA_LENGTH_FOR_DEFAULT_MARKERS?this._initializeDefaultChapterMarkers():this._defaultChapterMarkers.length=0}},_addButtonEventHandler:function(n,t,i){if(n){var u=this,r={button:n,eventName:t,handler:function(n){if(i.call(u,n),n.stopPropagation(),n.type==="click"&&!n.deviceSessionId){var t=n.target.querySelector(".win-mediaplayer-icon");t&&p.executeAnimation(t,[{property:"transform",delay:0,duration:100,timing:"ease-out",from:"scale(2)",to:"scale(1)"}])}}};n.addEventListener(t,r.handler,!1);this._buttonEventSubscriptions.push(r)}},_addGestureEventHandler:function(n,t,i){var u=this,r={owner:n,eventName:t,handler:function(n){i.call(u,n)}};n.addEventListener(t,r.handler,!1);this._gestureEventSubscriptions.push(r)},_addMediaEventListener:function(n,t,i){n&&(n.addEventListener(t,i,!1),this._mediaEventSubscriptions&&this._mediaEventSubscriptions.push({eventName:t,handler:i}))},_checkPremiumVideoPrivilege:function(){var n=this;return new h(function(t,r){var u,s;if(!n._mediaMetadata||!n._mediaMetadata.requiresPremiumVideoPrivilege||!i.Windows.Xbox){t(!0);return}var f=[],c=0,e=!1,l=i.Windows.Xbox.ApplicationModel.Store.PrivilegeCheckResult.noIssue,o=i.Windows.Xbox.System.User.users;for(u=0,s=o.size;u<s;u++)o[u].isSignedIn&&!o[u].isGuest&&(f.push(i.Windows.Xbox.ApplicationModel.Store.Product.checkPrivilegeAsync(o[u],224,!0,null)),c++);for(u=0,s=c;u<s;u++)f.length&&f[u].then(function(n){e=n===l?!0:!1});c===0&&(e=!1);h.join(f).then(function(){e?t(!0):t(!1)},function(){r()})})},_checkParentalControls:function(){var u,t,r,n,f;if(!ot.hasWinRT||!i.Windows.Xbox||!this._mediaMetadata||!this._mediaMetadata.contentRating||!this._mediaMetadata.contentType||!this._mediaMetadata.contentId)return h.wrap(!0);for(u=this._mediaMetadata.contentType,t=new i.Windows.Media.ContentRestrictions.RatedContentDescription(this._mediaMetadata.contentId,this._mediaMetadata.title,null,u),t.category=u,r=[],r=Array.isArray(this._mediaMetadata.contentRating)?this._mediaMetadata.contentRating:[this._mediaMetadata.contentRating],n=0,f=r.length;n<f;n++)t.ratings[n]=r[n];return this._contentRestrictions.requestContentAccessAsync(t)},_checkPremiumVideoAndParentalControls:function(){if(!this._disposed){var i=this,n=!1,t=!1,r=this._checkPremiumVideoPrivilegeBind().then(function(t){n=t?!0:!1},function(){n=!1}),u=this._checkParentalControlsBind().then(function(n){t=n?!0:!1},function(){t=!1});h.join([r,u]).then(function(){n&&t||(ct.canGoBack?ct.Navigation.back():(i.pause(),i._mediaElementAdapter.mediaElement&&(i._mediaElementAdapter.mediaElement.style.display="none")))},function(){})}},_clearChapterMarkerVisuals:function(){var i,n,r,t;if(!this._disposed)for(this._clearDefaultChapterMarkers(),i=this._markers.length,n=0;n<i;n++)this._markers[n].type===ht.chapter&&(r=this._markers[n].time,t=this._element.querySelector("#ms__marker"+r.toString().replace(".","_")),t&&t.parentNode&&t.parentNode.removeChild(t))},_clearDefaultChapterMarkers:function(){var i,n,r,t;if(!this._disposed){for(i=this._defaultChapterMarkers.length,n=0;n<i;n++)this._defaultChapterMarkers[n].type===ht.chapter&&(r=this._defaultChapterMarkers[n].time,t=this._element.querySelector("#ms__marker"+r.toString().replace(".","_")),t&&t.parentNode&&t.parentNode.removeChild(t));this._defaultChapterMarkers.length=0}},_clearMediaCommandFeedbackText:function(){this._mediaCommandFeedbackText&&(this._mediaCommandFeedbackText.textContent="")},_clearTimeDisplay:function(){this._currentTimeIndicator&&this._totalTimeIndicator&&(this._currentTimeIndicator.textContent="",this._totalTimeIndicator.textContent="",this._seekTimeIndicator.textContent="")},_defaultTimeFormatter:function(n){var t,i,r;return isNaN(n)?"":(t=Math.floor(n/60),n=Math.floor(n%60),i=Math.floor(t/60),t=t%60,r="",i>0?i.toString()+this._timeSeparator+this._getTimeString(t)+this._timeSeparator+this._getTimeString(n):t.toString()+this._timeSeparator+this._getTimeString(n))},_dispatchCancellableEvent:function(n,i){if(this._disposed)return!0;var r=t.document.createEvent("Event");return r.initEvent(n,!0,!0),i&&(r.detail=i),this._element.dispatchEvent(r)},_exitFastForwardOrRewind:function(n){this._isInFastForwardOrRewindMode&&(t.clearInterval(this._fastForwardOrRewindTimer),this._fastForwardOrRewindTimer=null,this._isInFastForwardOrRewindMode=!1,this._thumbnailImage&&(ot.addClass(this._thumbElement,"win-mediaplayer-hidden"),ot.addClass(this._thumbnailImage,"win-mediaplayer-hidden"),ot.removeClass(this._element,"win-mediaplayer-scrubbing"),ot.removeClass(this._element,"win-mediaplayer-rewind"),ot.removeClass(this._element,"win-mediaplayer-fastforward")),this._isThumbnailEnabled&&this._mediaElementAdapter&&this._isFastForwardOrRewind(this._targetPlaybackRate)&&(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&(this._shouldPlayAfterExitingFastForwardOrRewind=n,this._mediaElementAdapter.mediaElement.playbackRate=this._previousPlaybackRate,this._handleSeekedAfterExitFastForwardOrRewindBind||(this._handleSeekedAfterExitFastForwardOrRewindBind=this._handleSeekedAfterExitFastForwardOrRewind.bind(this)),this._mediaElementAdapter.mediaElement.addEventListener("seeked",this._handleSeekedAfterExitFastForwardOrRewindBind,!1),this._targetCurrentTime>this._endTime-this._SEEK_OFFSET&&!this._wasTimeClampedToEndTime?(this._wasTimeClampedToEndTime=!0,this._seekInternal(this._endTime-this._SEEK_OFFSET,!1)):this._seekInternal(this._targetCurrentTime,!1)),this._targetPlaybackRate=1),this._controlHideTimeout&&this._removeControlsTimer())},_getTimeString:function(n){var t=n.toString();return n<10&&(t="0"+t),t},_getTotalTimeText:function(){var n="";return this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._totalTime!==Infinity&&(n=Math.ceil(this._totalTime)),this._timeFormatter(n)},_getElapsedTimeText:function(){var t="",n;return this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(n=0,n=this._isInFastForwardOrRewindMode?this._targetCurrentTime:this._mediaElementAdapter.mediaElement.currentTime,n<this._startTime?n=this._startTime:n>this._endTime&&(n=this._endTime),t=Math.ceil(n-this._startTime)),this._timeFormatter(t)},_getRemainingTimeText:function(){var t="",n;return this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(n=0,n=this._isInFastForwardOrRewindMode?this._targetCurrentTime:this._mediaElementAdapter.mediaElement.currentTime,n<this._startTime?n=this._startTime:n>this._endTime&&(n=this._endTime),t=Math.ceil(this._endTime-(n-this._startTime))),"-"+this._timeFormatter(t)},_handleBeforeShowOverflowMenu:function(){for(var r,u,s,f,e=t.document.body.querySelector(".win-toolbar-overflowarea"),o=e.querySelectorAll("button"),n=0,i=o.length;n<i;n++)ot.removeClass(o[n],"win-mediaplayer-hidden");for(r=this._transportControls.querySelectorAll("button"),n=0,i=r.length;n<i;n++)u=r[n],ot.hasClass(u,"win-mediaplayer-hidden")&&(s=u.getAttribute("aria-label"),f=e.querySelector("button[aria-label='"+s+"']"),f&&ot.addClass(f,"win-mediaplayer-hidden"))},_handlePointerDown:function(n){this._handlePointerMove(n)},_handlePointerHover:function(){this._onShowControlsCommandInvokedBind()},_handlePointerMove:function(n){this._isThumbGrabbed&&(n.clientX<100?this._isHandAtLeftEdge=!0:n.clientX>t.screen.availWidth-100?this._isHandAtRightEdge=!0:(this._isHandAtLeftEdge=!1,this._isHandAtRightEdge=!1,this._currentScrubbingVelocity=0))},_handlePointerUp:function(n){this._handlePointerMove(n)},_handleManipulationStarted:function(n){this._inputHandlerPointerDownCallback(n)},_handleManipulationEnd:function(n){this._inputHandlerPointerUpCallback(n)},_handleManipulationUpdated:function(n){this._inputHandlerPointerMoveCallback(n)},_handleManipulationCompleted:function(n){this._inputHandlerPointerUpCallback(n)},_handleBeforeNavigated:function(){this._updateMediaState(!0)},_handleSeekedAfterExitFastForwardOrRewind:function(){this._disposed||(this._mediaElementAdapter.mediaElement.removeEventListener("seeked",this._handleSeekedAfterExitFastForwardOrRewindBind),this._shouldPlayAfterExitingFastForwardOrRewind?this._mediaElementAdapter&&this._mediaElementAdapter.play&&(this._mediaElementAdapter.mediaElement.playbackRate===0&&(this._mediaElementAdapter.mediaElement.playbackRate=this._mediaElementAdapter.mediaElement.defaultPlaybackRate),this._mediaElementAdapter.play()):this._mediaElementAdapter&&this._mediaElementAdapter.pause&&(this._mediaElementAdapter.mediaElement.playbackRate===0&&(this._mediaElementAdapter.mediaElement.playbackRate=this._mediaElementAdapter.mediaElement.defaultPlaybackRate),this._mediaElementAdapter.pause()))},_handleStartTimeReached:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._exitFastForwardOrRewind(!0);var n=this._mediaElementAdapter.mediaElement;!this._isInFastForwardOrRewindMode&&n.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&this._seekInternal(this._startTime+this._SEEK_OFFSET,!1);this._clearMediaCommandFeedbackText();n.loop&&this._playFromBeginning()}},_handleEndTimeReached:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&!this._endTimeReached){this._exitFastForwardOrRewind(!0);this._endTimeReached=!0;var n=this._mediaElementAdapter.mediaElement;!this._isInFastForwardOrRewindMode&&n.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&!this._wasTimeClampedToEndTime&&(this._wasTimeClampedToEndTime=!0,this._seekInternal(this._endTime-this._SEEK_OFFSET,!1));n.loop?(this._playFromBeginning(),this._endTimeReached=!1):(this._wasEndTimeSetProgrammatically&&this.pause(),this._updateMediaState(!0));this._clearMediaCommandFeedbackText()}},_handleSystemTransportControlsButtonPressed:function(n){var t=i.Windows.Media.SystemMediaTransportControlsButton;switch(n.button){case t.play:this.playPauseButtonEnabled&&this.playPauseButtonVisible&&(this._mediaElementAdapter.mediaElement.paused?(this._showPauseButton(),this.play()):this._isInFastForwardOrRewindMode&&(this._isThumbnailEnabled||(this._isInFastForwardOrRewindMode=!1,this._mediaElementAdapter.mediaElement.playbackRate=this._mediaElementAdapter.mediaElement.defaultPlaybackRate),this._showPauseButton(),this.play()));break;case t.pause:this.playbackRateButtonEnabled&&this.playbackRateButtonVisible&&(this._showPlayButton(),this.pause());break;case t.stop:w.back();break;case t.fastForward:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._fastForwardButton.focus(),this._fastForwardButton.click());break;case t.rewind:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._rewindButton.focus(),this._rewindButton.click());break;case t.next:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._nextTrackButton.focus(),this._nextTrackButton.click(),this._chapterSkipForwardButton.focus(),this._chapterSkipForwardButton.click());break;case t.previous:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._previousTrackButton.focus(),this._previousTrackButton.click(),this._chapterSkipBackButton.focus(),this._chapterSkipBackButton.click())}},_handleSystemTransportControlsPropertyChanged:function(n){var u=i.Windows.Media.SystemMediaTransportControlsProperty,t=this._smtControls.displayUpdater,r;switch(n.property){case u.playbackPosition:t.type===i.Windows.Media.MediaPlaybackType.video&&(r=1e3,this._seekInternal(t.videoProperties.playbackPosition/r,!1))}},_handleTimelineArrowKeyDown:function(n){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(n.key==="Left"||n.key==="Right")){var t=0,i=this._totalTime/100;n.key==="Left"?t=this._mediaElementAdapter.mediaElement.currentTime-i:n.key==="Right"&&(t=this._mediaElementAdapter.mediaElement.currentTime+i);this._seekInternal(t);n.stopPropagation()}},_handleVolumeFlyoutShow:function(){this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._volumeValue&&(this._volumeValue.textContent=this._mediaElementAdapter.mediaElement.volume)},_handleVolumeSliderChange:function(){var n=0;this._volumeSlider&&(n=this._volumeSlider.value);this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(this._mediaElementAdapter.mediaElement.volume=n/100);this._volumeValue&&(this._volumeValue.textContent=n)},_hideControls:function(){var r,n;(s("WinJS.UI.MediaPlayer:_hideControls,StartTM"),!this._controlsVisible||this._isXboxSnapMode||this._disposed)||(r=this._dispatchCancellableEvent("beforehidecontrols",{}),r?this._isInFastForwardOrRewindMode||this._areControlsHiding||(this._layout==="full"&&ct.canGoBack&&i.Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily==="Windows.Desktop"&&ot.addClass(this._backButton.element,"win-mediaplayer-hidden"),this._areControlsHiding=!0,this._removeControlsTimer(),t.document.activeElement&&this._transportControls.contains(t.document.activeElement)&&this._element.focus(),n=this,this._playHideControlsAnimation().then(function(){n._disposed||(s("WinJS.UI.MediaPlayer:_hideControls,StopTM"),n._controlsVisible=!1,n._areControlsHiding=!1,ot.addClass(n._controls,"win-mediaplayer-hidden"),n.dispatchEvent("afterhidecontrols",{}))})):this._removeControlsTimer(),this._wasStartTimeSetProgrammatically||this._wasEndTimeSetProgrammatically||!this._markers.length||this._unsubscribeFromTimeUpdates())},_isButtonEnabledAndVisible:function(n){var i=!0,r;return n?(r=t.getComputedStyle(n),(n&&n.disabled||r.display==="none")&&(i=!1)):i=!1,i},_isFastForwardOrRewind:function(n){return n!==this._PLAYBACKRATE_PLAYING&&n!==this._PLAYBACKRATE_NOT_PLAYING},_isFocusOnAVisibleFlyout:function(){for(var r,i=t.document.querySelectorAll(".win-overlay, .win-customoverlay"),n=0,u=i.length;n<u;n++)if(r=i[n],r.contains(t.document.activeElement))return!0;return!1},_initializeChapterMarkers:function(n){var u,f,t;s("WinJS.UI.MediaPlayer:_initializeChapterMarkers,StartTM");var r=n.textTracks,i=!1,e=r.length;for(t=0;t<e;t++)if(u=r[t],u.kind==="chapters"){i=!0;break}if(!i)for(f=this._markers.length,t=0;t<f;t++)this._markers[t].type===ht.chapter&&(i=!0);i?this._initializeCustomChapterMarkers(n):this._totalTime>this._MINIMUM_MEDIA_LENGTH_FOR_DEFAULT_MARKERS&&this._initializeDefaultChapterMarkers();s("WinJS.UI.MediaPlayer:_initializeChapterMarkers,StopTM")},_initializeCustomChapterMarkers:function(n){var t,u;this._defaultChapterMarkers.length=0;var r=n.textTracks,i=n.getElementsByTagName("track"),f=i.length;for(t=0;t<f;t++)i[t].kind==="chapters"&&(r[t].mode=r[t].HIDDEN,u=this,this._loadTextTrackCallback=function(){for(var t=this.track.cues,i=t.length,n=0;n<i;n++)u.addMarker(t[n].startTime,ht.chapter,t[n].text)},i[t].addEventListener("load",this._loadTextTrackCallback,!1))},_initializeDefaultChapterMarkers:function(){var r,n,i;if(this._chapterSkipBackButton&&t.getComputedStyle(this._chapterSkipBackButton).display!=="none"||this._chapterSkipForwardButton&&t.getComputedStyle(this._chapterSkipForwardButton).display!=="none"){for(this._defaultChapterMarkers.length=0,r=this._totalTime/10,this._defaultChapterMarkers.push({time:this._startTime,type:ht.chapter,data:{},extraClass:"win-mediaplayer-chaptermarker"}),n=0,i=0;i<9;i++)n+=r,this._defaultChapterMarkers.push({time:n,type:ht.chapter,data:{},extraClass:"win-mediaplayer-chaptermarker"});this._defaultChapterMarkers.push({time:this._endTime,type:ht.chapter,data:{},extraClass:"win-mediaplayer-chaptermarker"});this._isChapterMarkerVisualsDirty=!0}},_onAudioTracksCommandInvoked:function(){if(!this._audioTracksFlyout){var i=t.document.createElement("div");ot.addClass(i,"win-mediaplayer-audiotracks win-mediaplayer-overlay");this._audioTracksFlyout=new rt.Flyout(i);this._audioTracksButton.type="flyout";this._audioTracksButton.flyout=this._audioTracksFlyout;i.style.display="none";t.document.body.appendChild(i)}this._audioTracksButton&&(this._refreshAudioTracksMenu(),this._audioTracksFlyout.show(this._audioTracksButton,"top"));this._updateUIAndRaiseEvents(st.audioTracks,n.audioTracksMediaCommandDisplayText)},_onCastCommandInvoked:function(){if(ot.hasWinRT&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this.castButtonEnabled&&this.castButtonVisible){var t=new i.Windows.Media.Casting.CastingDevicePicker;t.show({height:500,width:500,x:10,y:100},i.Windows.UI.Popups.Placement.above);this._updateUIAndRaiseEvents(st.cast,n.castMediaCommandDisplayText)}},_onCanPlay:function(){this._isBusy=!1;this._startTime!==0&&(this._seekInternal(this._startTime,!1),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.autoplay&&this.play())},_onChapterSkipBackCommandInvoked:function(){this.chapterSkipBackButtonEnabled&&this.chapterSkipBackButtonVisible&&this.chapterSkipBack()},_onChapterSkipForwardCommandInvoked:function(){this.chapterSkipForwardButtonEnabled&&this.chapterSkipForwardButtonVisible&&this.chapterSkipForward()},_onClosedCaptionsCommandInvoked:function(){if(!this._closedCaptionsFlyout){var i=t.document.createElement("div");ot.addClass(i,"win-mediaplayer-closedcaptions win-mediaplayer-overlay");this._closedCaptionsFlyout=new rt.Flyout(i);this._closedCaptionsButton.type="flyout";this._closedCaptionsButton.flyout=this._closedCaptionsFlyout;i.style.display="none";t.document.body.appendChild(i)}this._closedCaptionsButton&&(this._refreshClosedCaptionsMenu(),this._closedCaptionsFlyout.show(this._closedCaptionsButton,"top"));this._updateUIAndRaiseEvents(st.closedCaptions,n.closedCaptionsMediaCommandDisplayText)},_onControlsKeyupInputHandler:function(n){(n.key==="GamepadB"||n.key==="Escape")&&this._isXboxSnapMode&&this._controlsVisible&&(this._exitFastForwardOrRewind(!0),this._hideControls(),n.stopPropagation())},_onZoomCommandInvoked:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this.zoomButtonEnabled&&this.zoomButtonVisible){var n="";this._mediaElementAdapter.mediaElement.msZoom?(this._mediaElementAdapter.mediaElement.msZoom=!1,n="Letterbox"):(this._mediaElementAdapter.mediaElement.msZoom=!0,n="Native");this._updateUIAndRaiseEvents(st.zoom,n)}},_onDurationChange:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(isFinite(this._mediaElementAdapter.mediaElement.duration)||(this._mediaElementAdapter.isLive=!0),!this._wasEndTimeSetProgrammatically)){var n=this._mediaElementAdapter.mediaElement.duration;this._endTime=n;this._totalTime=this._endTime-this._startTime;this._updateTimelineVisuals();this._updateMediaState(!1)}},_onEnded:function(){this._exitFastForwardOrRewind(!1);this._endTimeReached=!1;this._isThumbGrabbed&&this._onThumbDragStop(null);this._updateMediaState(!1)},_onEmptied:function(){this._resetInternalState();this._clearTimeDisplay()},_onError:function(){var r;if(this._errorFlyout||(r=t.document.createElement("div"),ot.addClass(r,"win-mediaplayer-errorflyout win-mediaplayer-overlay"),r.innerHTML='     <div class="win-mediaplayer-errortext"><\/div>',this._errorFlyout=new rt.Flyout(r),r.style.display="none",t.document.body.appendChild(r),this._errorText=r.querySelector(".win-mediaplayer-errortext")),this._transportControls&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.error){var u=this._mediaElementAdapter.mediaElement.error,i="",f=this._mediaElementAdapter.mediaElement;if(u.msExtendedErrorCode)switch(f.error.msExtendedErrorCode){case 1:i=n.mediaErrorAborted;break;default:i=n.mediaErrorUnknown}else switch(u.code){case 1:i=n.mediaErrorAborted;break;case 2:i=n.mediaErrorAborted;break;case 3:i=n.mediaErrorAborted;break;case 4:i=n.mediaErrorAborted;break;default:i=n.mediaErrorUnknown}this._errorText.textContent=i;this._errorFlyout.show(this._transportControls,"top")}},_onFastForwardCommandInvoked:function(){this.fastForwardButtonEnabled&&this.fastForwardButtonVisible&&this.fastForward()},_onFastForwardRewindTimerTick:function(){var e,t,r,u,n;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){var i=this._mediaElementAdapter.mediaElement,f=this._startTime,o=this._endTime,s=i.currentTime,h=(new Date).getTime()-this._lastFastForwardOrRewindTimerTime,c=Math.floor(h/100)/10;this._fastForwardOrRewindTimerElapsedTime+=c*this._targetPlaybackRate;this._targetCurrentTime=this._fastForwardOrRewindTimerElapsedTime+s;this._targetCurrentTime>=o?(this._targetCurrentTime=o,this._handleEndTimeReached()):this._targetCurrentTime<=f&&(this._targetCurrentTime=f,this._handleStartTimeReached());this._progress&&this._totalTime!==0&&(e=(this._targetCurrentTime-f)/this._totalTime,t=e*this._totalSeekBarWidth,this._thumbnailImage&&(r=this._thumbImageElementWidthDividedByTwo,u=this._totalSeekBarWidth-this._thumbImageElementWidthDividedByTwo,t<r?(n=1*(t-r),n<-1*this._thumbImageElementWidthDividedByTwo&&(n=-1*this._thumbImageElementWidthDividedByTwo),this._seekMark.style.transform="translateX("+n+"px)",this._thumbElement.style.transform="translate("+n+"px, 3px)",ot.addClass(this._thumbElement,"win-mediaplayer-thumbnail-lefttriangle"),this._currentTimeVisualElements.style.transform="translateX("+r+"px)"):t>u?(n=t-u,n>this._thumbImageElementWidthDividedByTwo&&(n=this._thumbImageElementWidthDividedByTwo),this._seekMark.style.transform="translateX("+n+"px)",this._thumbElement.style.transform="translate("+(n-14)+"px, 6px)",ot.addClass(this._thumbElement,"win-mediaplayer-thumbnail-righttriangle"),this._currentTimeVisualElements.style.transform="translateX("+u+"px)"):(this._seekMark.style.transform="none",ot.removeClass(this._thumbElement,"win-mediaplayer-thumbnail-lefttriangle"),ot.removeClass(this._thumbElement,"win-mediaplayer-thumbnail-righttriangle"),this._thumbElement.style.transform="rotate(45deg)",this._currentTimeVisualElements.style.transform="translateX("+t+"px)")),this._progress.style.transform="scaleX("+e+")",this._updateTimeDisplay(),this.dispatchEvent("targettimeupdate",{}),this._thumbnailEnabled&&this.dispatchEvent("thumbnailrequest",{currentTime:this._targetCurrentTime,playbackRate:this._targetPlaybackRate}));this._lastFastForwardOrRewindTimerTime=(new Date).getTime();this._isThumbnailEnabled&&i.playbackRate!==0&&(this._previousPlaybackRate=i.playbackRate,i.playbackRate=0)}},_onGoToFullScreenCommandInvoked:function(){ot.hasWinRT&&(i.Windows.Xbox?i.Windows.UI.ViewManagement.ApplicationView.tryUnsnapToFullscreen():i.Windows.UI.ViewManagement.ApplicationView.tryUnsnap())},_onHideControlsCommandInvoked:function(){this._disposed||(this._isThumbGrabbed&&this._onThumbDragStop(null),this._hideControls())},_onInputHandlerKeyDown:function(n){if(!this._disposed)switch(n.keyCode){case ot.Key.escape:!this._isFocusOnAVisibleFlyout()&&this.fullScreen&&(this.fullScreen=!1);break;case ot.Key.space:this._isFocusOnAVisibleFlyout()||(this._showControls(!0),this._onPlayPauseCommandInvoked());break;case ot.Key.gamepadLeftShoulder:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._chapterSkipBackButton.click(),this._playPauseButton.focus());break;case ot.Key.gamepadRightShoulder:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._chapterSkipForwardButton.click(),this._playPauseButton.focus());break;case ot.Key.gamepadLeftTrigger:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._rewindButton.click(),this._playPauseButton.focus());break;case ot.Key.gamepadRightTrigger:this._isXboxSnapMode&&(this._controlsVisible||this._showControls(),this._fastForwardButton.click(),this._playPauseButton.focus())}},_onInputHandlerKeyUp:function(n){if(!this._disposed)switch(n.keyCode){case ot.Key.gamepadA:!this._isXboxSnapMode||this._controlsVisible||this._isFocusOnAVisibleFlyout()||(this._showControls(),this._playPauseButton.focus())}},_onInputHandlerPointerDown:function(n){this._lastPointerPosition=n.x+","+n.y;this._exitFastForwardOrRewind(!0);this._controlsVisible?this._onThumbStartDrag(n):this._showControls()},_onInputHandlerPointerHover:function(){this._showControls()},_onInputHandlerPointerMove:function(n){this._showControls();(this._isPointerDown||this._isXbox)&&this._onThumbDrag(n)},_onInputHandlerClick:function(n){n.srcElement!==this._seekMark&&n.srcElement!==this._progressContainer&&(this._isXbox||this._showControls(!0),this._onPlayPauseCommandInvoked())},_inputHandlerMouseDown:function(){this._isPointerDown=!0},_inputHandlerMouseOut:function(n){this._isPointerDown&&!t.document.hasFocus()&&(this._isPointerDown=!1,this._onThumbDragStop(n))},_inputHandlerMouseUp:function(){this._isPointerDown=!1},_onInputHandlerPointerUp:function(n){this._isThumbGrabbed&&this._onThumbDragStop(n);var t=n.pageX+","+n.pageY,i=this._lastPointerPosition;t===i&&this._hideControls()},_onLoadStart:function(){this._clearMediaCommandFeedbackText();this._clearTimeDisplay();this._wasStartTimeSetProgrammatically||this._wasEndTimeSetProgrammatically||this._hasCustomMarkers||this._unsubscribeFromTimeUpdates();this._doMarkersNeedResetting&&(this._markers.length=0,this._hasCustomMarkers=!1,this._doMarkersNeedResetting=!1);this._isChapterMarkerVisualsDirty=!0;var n=this;h.timeout(this._timeBeforeShowingBusyVisual).done(function(){n._mediaElementAdapter&&n._mediaElementAdapter.mediaElement&&n._mediaElementAdapter.mediaElement.readyState<n._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&(n._isBusy=!0)})},_onLiveButtonCommandInvoked:function(){this.goToLiveButtonEnabled&&this.goToLiveButtonVisible&&this.goToLive()},_onLoadedMetadata:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._mediaElementAdapter.mediaElement.duration===Number.POSITIVE_INFINITY&&(this._mediaElementAdapter.isLive=!0);var n=this._mediaElementAdapter.mediaElement;this._updateDefaultStartAndEndTime(n);this._initializeChapterMarkers(n);this._updateAudioTracksButtonStateBind();this._updateClosedCaptionsButtonStateBind()}},_onMarkerCollectionChanged:function(){this._markers.sort(function(n,t){return n.time-t.time});this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._recalculateNextAndPreviousCustomMarkerIndexAndTime(this._mediaElementAdapter.mediaElement.currentTime);this._hasCustomMarkers||(this._subscribeToTimeUpdates(),this._hasCustomMarkers=!0);this._isChapterMarkerVisualsDirty=!0;this._updateChapterMarkerVisuals()},_onMuteCommandInvoked:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._mediaElementAdapter.mediaElement.volume===0?(this._mediaElementAdapter.mediaElement.volume=this._previousVolumeValue,this._muteButton&&(this._muteButton.winControl.icon="volume")):(this._previousVolumeValue=this._mediaElementAdapter.mediaElement.volume,this._mediaElementAdapter.mediaElement.volume=0,this._muteButton&&(this._muteButton.winControl.icon="mute"));var t=this._mediaElementAdapter.mediaElement.volume*100;this._volumeSlider&&(this._volumeSlider.value=t);this._volumeValue&&(this._volumeValue.textContent=t)}this._updateUIAndRaiseEvents(st.mute,n.mediaPlayerMuteButtonLabel)},_onNextTrackCommandInvoked:function(){this.nextTrackButtonEnabled&&this.nextTrackButtonVisible&&this.nextTrack()},_onPause:function(){s("WinJS.UI.MediaPlayer:pause,StopTM");this._showPlayButton()},_onPlayFromBeginningCommandInvoked:function(){this.playFromBeginningButtonEnabled&&this.playFromBeginningButtonVisible&&(this._playFromBeginning(),this._updateUIAndRaiseEvents(st.playFromBeginning,n.playFromBeginningMediaCommandDisplayText))},_onPlaybackRateCommandInvoked:function(){var u,f,o,r,i,e;if(!this._playbackRateFlyout)for(u=t.document.createElement("div"),ot.addClass(u,"win-mediaplayer-playbackrate win-mediaplayer-overlay"),u.innerHTML='     <button value="0.5">'+n.playbackRateHalfSpeedLabel+'<\/button>     <button value="1">'+n.playbackRateNormalSpeedLabel+'<\/button>     <button value="1.5">'+n.playbackRateOneAndHalfSpeedLabel+'<\/button>     <button value="2">'+n.playbackRateDoubleSpeedLabel+"<\/button>",this._playbackRateFlyout=new rt.Flyout(u),this._playbackRateButton.type="flyout",this._playbackRateButton.flyout=this._playbackRateFlyout,u.style.display="none",t.document.body.appendChild(u),f=this,r=u.querySelectorAll("button"),i=0,e=r.length;i<e;i++)r[i].addEventListener("click",function(n){if(f._mediaElementAdapter&&f._mediaElementAdapter.mediaElement){var t=this;f._mediaElementAdapter.mediaElement.playbackRate=f._mediaElementAdapter.mediaElement.defaultPlaybackRate*t.value;n.stopPropagation()}});if(this._playbackRateButton){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement)for(o=this._mediaElementAdapter.mediaElement.playbackRate,r=this._playbackRateFlyout.element.querySelectorAll("button"),i=0,e=r.length;i<e;i++)r[i].value===o?ot.addClass(r[i],"win-active"):ot.removeClass(r[i],"win-active");this._playbackRateFlyout.show(this._playbackRateButton,"top")}this._updateUIAndRaiseEvents(st.playbackRate,n.mediaPlayerPlaybackRateButtonLabel)},_onPlayPauseCommandInvoked:function(){(!this._isXbox||this._controlsVisible)&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this.playPauseButtonEnabled&&this.playPauseButtonVisible&&(this._mediaElementAdapter.mediaElement.paused?(this._showPauseButton(),this.play()):this._isInFastForwardOrRewindMode?(this._isThumbnailEnabled||(this._isInFastForwardOrRewindMode=!1,this._mediaElementAdapter.mediaElement.playbackRate=this._mediaElementAdapter.mediaElement.defaultPlaybackRate),this._showPauseButton(),this.play()):(this._showPlayButton(),this.pause()))},_onPlay:function(){this._showPauseButton();this._updateMediaState(!1)},_onPlaying:function(){s("WinJS.UI.MediaPlayer:play,StopTM");this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(this._mediaElementAdapter.mediaElement.playbackRate===this._mediaElementAdapter.mediaElement.defaultPlaybackRate&&this._showPauseButton(),this._updateMediaState(!1))},_onPreviousTrackCommandInvoked:function(){this.previousTrackButtonEnabled&&this.previousTrackButtonVisible&&this.previousTrack()},_onProgress:function(){var t;if(this._controlsVisible&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(!ot.hasWinRT||c&&c.ApplicationView.value!==c.ApplicationViewState.snapped)&&this._mediaElementAdapter.mediaElement.buffered.length){var n=this._mediaElementAdapter.mediaElement,i=n.currentTime,r=-1;for(t=n.buffered.length-1;t>=0;t--)if(i>=n.buffered.start(t)&&i<=n.buffered.end(t)){r=t;break}if(r!==-1){var u=n.buffered.length-1,f=n.buffered.start(u),e=n.buffered.end(u),o=(e-f)/this._totalTime,s=f/this._totalTime*this._totalSeekBarWidth;this._buffer.style.transform="scaleX("+o+") translateX("+s+"px)"}else this._buffer.style.transform="scaleX(0)"}},_onRateChange:function(){this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&!this._isThumbnailEnabled&&(this._mediaElementAdapter.mediaElement.playbackRate===this._mediaElementAdapter.mediaElement.defaultPlaybackRate?(this._isInFastForwardOrRewindMode=!1,this._showPauseButton(),this._updateInfoDisplay(n.playMediaCommandDisplayText)):this._mediaElementAdapter.mediaElement.playbackRate===0?(this._isInFastForwardOrRewindMode=!1,this._showPlayButton(),this._updateInfoDisplay(n.pauseMediaCommandDisplayText)):(this._isInFastForwardOrRewindMode=!0,this._showPlayButton(),this._setFastForwardOrRewindText()),this._updateMediaState(!1))},_onRewindCommandInvoked:function(){this.rewindButtonEnabled&&this.rewindButtonVisible&&this.rewind()},_onSeeked:function(){s("WinJS.UI.MediaPlayer:seek,StopTM");this._isBusy=!1;this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(this._recalculateNextAndPreviousCustomMarkerIndexAndTime(this._mediaElementAdapter.mediaElement.currentTime),this._controlsVisible&&(this._isThumbnailEnabled&&(this._seekMark.style.transform="none"),this._updateTimelineVisuals()))},_onSeeking:function(){var n=this,t;h.timeout(this._timeBeforeShowingBusyVisual).done(function(){n._mediaElementAdapter&&n._mediaElementAdapter.mediaElement&&n._mediaElementAdapter.mediaElement.seeking&&(n._isBusy=!0)});(this._wasStartTimeSetProgrammatically||this._wasEndTimeSetProgrammatically)&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(t=this._mediaElementAdapter.mediaElement.currentTime,t<this._startTime?this._handleStartTimeReached():t>this._endTime&&this._handleEndTimeReached())},_onShowControlsCommandInvoked:function(){this._disposed||this._isXbox&&!this._isXboxSnapMode||this._controlsVisible||this._isFocusOnAVisibleFlyout()||this._showControls(!0,!0)},_onThumbDrag:function(n){var r,f,t,u,e,s,i,c,o,l,h;if(!this._mediaElementAdapter||this._mediaElementAdapter.seekAllowed){if(this._isSeekWindowEnabled&&(this._isHandAtLeftEdge||this._isHandAtRightEdge)){this._currentScrubbingVelocity=n.velocities.linear.x;return}if(r=n.pageX,f=this._seekBar.getBoundingClientRect(),r<f.left?r=f.left:r>f.right?r=f.right:r-=f.left,t=0,u=r/this._totalSeekBarWidth,t=u*this._totalSeekBarWidth,u<0?u=0:u>1&&(u=1),this._progress.style.transform="scaleX("+u+")",this._thumbnailImage&&(this._isSeekWindowEnabled?t<this._leftBoundary?t=this._leftBoundary:t>this._rightBoundary&&(t=this._rightBoundary):t<0?t=0:t>this._totalSeekBarWidth&&(t=this._totalSeekBarWidth),e=0,e=this.isThumbnailEnabled?this._thumbImageElementWidthDividedByTwo:50,s=this._totalSeekBarWidth-e,t<e?(i=1*(t-e),i<-1*this._thumbImageElementWidthDividedByTwo&&(i=-1*this._thumbImageElementWidthDividedByTwo),this._seekMark.style.transform="translateX("+i+"px)",this._thumbElement.style.transform="translate("+i+"px, 3px)",ot.addClass(this._thumbElement,"win-mediaplayer-thumbnail-lefttriangle"),this._currentTimeVisualElements.style.transform="translateX("+e+"px)"):t>s?(i=t-s,i>this._thumbImageElementWidthDividedByTwo&&(i=this._thumbImageElementWidthDividedByTwo),this._seekMark.style.transform="translateX("+i+"px)",this._thumbElement.style.transform="translate("+(i-14)+"px, 6px)",ot.addClass(this._thumbElement,"win-mediaplayer-thumbnail-righttriangle"),this._currentTimeVisualElements.style.transform="translateX("+s+"px)"):(this._seekMark.style.transform="none",this._thumbElement.style.transform="rotate(45deg)",ot.removeClass(this._thumbElement,"win-mediaplayer-thumbnail-righttriangle"),ot.removeClass(this._thumbElement,"win-mediaplayer-thumbnail-lefttriangle"),this._currentTimeVisualElements.style.transform="translateX("+t+"px)")),this._seekCurrentTime=u*this._totalTime,this._seekCurrentTime<0?this._seekCurrentTime=0:this._seekCurrentTime>this._totalTime&&(this._seekCurrentTime=this._totalTime),this._markers.length&&this._lastPosition-r<this._MINIMUM_POINTER_DELTA_TO_ENABLE_SNAPPING_TO_NEAREST_MARKER&&this.chapterSkipBackButtonEnabled&&this.chapterSkipBackButtonVisible&&this.chapterSkipForwardButtonEnabled&&this.chapterSkipForwardButtonVisible)for(c=this._totalTime*this._SNAP_TO_NEAREST_MARKER_THRESHOLD,o=0,l=this._markers.length;o<l;o++)if(Math.abs(this._markers[o].time-this._seekCurrentTime)<c){this._seekCurrentTime=this._markers[o].time;h=this._seekCurrentTime/this._totalTime;this._progress.style.transform="scaleX("+h+"px)";this._currentTimeVisualElements.style.transform="translateX("+h+"px)";break}this.dispatchEvent("thumbnailrequest",{currentTime:this._seekCurrentTime,playbackRate:0});this._thumbnailImage&&(this._seekTimeIndicator.textContent=this._timeFormatter(this._seekCurrentTime));this._lastPosition=r}},_onThumbDragStop:function(){if(!this._mediaElementAdapter||this._mediaElementAdapter.seekAllowed){ot.removeClass(this._transportControls,"win-invisible");var n=this._mediaElementAdapter.mediaElement;ot.hasWinRT&&i.Windows.Xbox&&(i.Windows.Xbox.Input.InputManager.systemCursorVisibility=i.Windows.Xbox.Input.SystemCursorVisibility.visible);this._isSeekWindowEnabled&&(ot.addClass(this._seekWindowLeftEdgeElement,"win-invisible"),ot.addClass(this._seekWindowRightEdgeElement,"win-invisible"));this._thumbnailImage&&(ot.addClass(this._thumbElement,"win-mediaplayer-hidden"),ot.addClass(this._thumbnailImage,"win-mediaplayer-hidden"),this._seekMark.style.transform="none",this._thumbElement.style.transform="rotate(45deg)");ot.removeClass(this._element,"win-mediaplayer-scrubbing");this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&this.seek(this._seekCurrentTime);this._wasPausedBeforeScrubbing||n.ended||(this._mediaElementAdapter.mediaElement.playbackRate=this._previousPlaybackRate,n.play());this._setControlsTimer();this._isThumbGrabbed=!1}},_onThumbStartDrag:function(n){var r,f,u,e,o,s;this._mediaElementAdapter&&this._mediaElementAdapter.seekAllowed&&this._mediaElementAdapter.mediaElement&&this._controlsVisible&&(r=this._mediaElementAdapter.mediaElement,this._wasPausedBeforeScrubbing=r.paused,this._controlHideTimeout&&this._removeControlsTimer(),r.tagName===this._TAG_NAME_VIDEO&&(r.pause(),this._previousPlaybackRate=this._mediaElementAdapter.mediaElement.playbackRate,this._mediaElementAdapter.mediaElement.playbackRate=0),this._startOffsetX=n.x,this._lastPosition=this._startOffsetX,this._isSeekWindowEnabled=this._totalTime>this._MINIMUM_ACCURATE_SEEKABLE_RANGE?!0:!1,ot.addClass(this._transportControls,"win-invisible"),f=this._mediaElementAdapter.mediaElement.currentTime,this._relativeTimelineStartOffset=f/this._totalTime,this._isSeekWindowEnabled&&(this._minimumSeekableRange=this._MINIMUM_ACCURATE_SEEKABLE_RANGE/this._totalTime,u=n.position.x/t.screen.availWidth,e=1-u,this._seekWindowLeftEdge=this._relativeTimelineStartOffset-u*this._minimumSeekableRange,this._seekWindowRightEdge=this._relativeTimelineStartOffset+e*this._minimumSeekableRange,this._seekWindowLeftEdge<0?this._seekWindowLeftEdge=0:this._seekWindowRightEdge>1&&(this._seekWindowRightEdge=1),this._seekWindowSize=this._seekWindowRightEdge-this._seekWindowLeftEdge,this._leftBoundary=this._seekWindowLeftEdge*this._totalSeekBarWidth,this._rightBoundary=this._seekWindowRightEdge*this._totalSeekBarWidth,this._seekWindowSizeInPixels=this._rightBoundary-this._leftBoundary,this._seekWindowLeftEdgeElement.style.transform="translateX("+this._leftBoundary+"px)",this._seekWindowRightEdgeElement.style.transform="translateX("+this._rightBoundary+"px)",o=this._seekWindowLeftEdge*this._totalTime,s=this._seekWindowRightEdge*this._totalTime,this._seekWindowLeftEdgeElement.textContent=this._timeFormatter(o),this._seekWindowRightEdgeElement.textContent=this._timeFormatter(s),ot.removeClass(this._seekWindowLeftEdgeElement,"win-invisible"),ot.removeClass(this._seekWindowRightEdgeElement,"win-invisible")),this._isThumbGrabbed=!0,ot.hasWinRT&&i.Windows.Xbox&&(i.Windows.Xbox.Input.InputManager.systemCursorVisibility=i.Windows.Xbox.Input.SystemCursorVisibility.hidden),this._thumbnailImage&&(ot.removeClass(this._thumbElement,"win-mediaplayer-hidden"),ot.removeClass(this._thumbnailImage,"win-mediaplayer-hidden"),this._thumbImageElementWidthDividedByTwo||(this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2)),ot.addClass(this._element,"win-mediaplayer-scrubbing"))},_onTimeSkipForwardCommandInvoked:function(){this.timeSkipForwardButtonEnabled&&this.timeSkipForwardButtonVisible&&this.timeSkipForward()},_onTimeSkipBackCommandInvoked:function(){this.timeSkipBackButtonEnabled&&this.timeSkipBackButtonVisible&&this.timeSkipBack()},_onTimeUpdate:function(){var i,r,n,t;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){if(i=this._mediaElementAdapter.mediaElement.currentTime,this._mediaElementAdapter.mediaElement.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&(i<this._startTime?this._handleStartTimeReached():i>this._endTime&&this._handleEndTimeReached()),this._nextCustomMarkerTime!==-1&&!this._isInFastForwardOrRewindMode&&Math.abs(this._nextCustomMarkerTime-i)<this._MARKER_PROXIMITY_THRESHOLD){for(this._markers[this._nextCustomMarkerIndex]&&this.dispatchEvent("markerreached",this._markers[this._nextCustomMarkerIndex]),r=this._markers.length,n=this._nextCustomMarkerIndex,t=n+1;t<r;t++)if(this._markers[t].time-i<this._MARKER_PROXIMITY_THRESHOLD)this.dispatchEvent("markerreached",this._markers[t]),n=t;else break;n+1<this._markers.length&&this._markers[n+1]?(this._nextCustomMarkerIndex=n+1,this._nextCustomMarkerTime=this._markers[this._nextCustomMarkerIndex].time):(this._nextCustomMarkerIndex=-1,this._nextCustomMarkerTime=-1);n>=0&&this._markers.length&&this._markers[n]?(this._previousCustomMarkerIndex=n,this._previousCustomMarkerTime=this._markers[this._previousCustomMarkerIndex].time):(this._previousCustomMarkerIndex=-1,this._previousCustomMarkerTime=-1)}this._mediaElementAdapter&&this._controlsVisible&&(this._mediaElementAdapter.isLive||(this._syncTimeAndProgress(!1),this._updateTimeDisplay()))}},_onToggleFullscreenCommandInvoked:function(){this.fullScreen=this.fullScreen?!1:!0},_onStopCommandInvoked:function(){this.stopButtonEnabled&&this.stopButtonVisible&&this.stop()},_onVolumeCommandInvoked:function(){if(!this._volumeFlyout){var i=t.document.createElement("div");ot.addClass(i,"win-mediaplayer-volume win-mediaplayer-overlay");i.innerHTML='     <div class="win-mediaplayer-volume-heading">Speakers<\/div>     <div class="win-mediaplayer-volume-controls">       <button class="win-mediaplayer-mutebutton"><\/button>       <input class="win-mediaplayer-volume-slider" type="range" />       <div class="win-mediaplayer-volume-value"><\/div>     <\/div>';this._volumeFlyout=new rt.Flyout(i);this._volumeButton.type="flyout";this._volumeButton.flyout=this._volumeFlyout;i.style.display="none";t.document.body.appendChild(i);this._muteButton=i.querySelector(".win-mediaplayer-mutebutton");this._volumeSlider=i.querySelector(".win-mediaplayer-volume-slider");this._volumeValue=i.querySelector(".win-mediaplayer-volume-value");this._volumeFlyout.addEventListener("aftershow",this._handleVolumeFlyoutShowCallback,!1);this._volumeSlider.addEventListener("change",this._handleVolumeSliderChangeCallback,!1);this._addButtonEventHandler(this._muteButton,"click",this._onMuteCommandInvoked)}this._volumeButton&&this._volumeFlyout.show(this._volumeButton,"top");this._updateUIAndRaiseEvents(st.volume,n.mediaPlayerVolumeButtonLabel)},_playFromBeginning:function(){if(s("WinJS.UI.MediaPlayer:_playFromBeginning,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){var t=this._mediaElementAdapter.mediaElement;t.ended&&t.load();t.currentTime!==this._startTime&&t.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&(this._seekInternal(this._startTime,!1),t.playbackRate=t.defaultPlaybackRate,t.play(),this._endTimeReached=!1);this._updateUIAndRaiseEvents(st.playFromBeginning,n.replayMediaCommandDisplayText)}},_recalculateNextAndPreviousCustomMarkerIndexAndTime:function(n){var t;s("WinJS.UI.MediaPlayer:_recalculateNextAndPreviousCustomMarkerIndexAndTime,StartTM");var u=this._markers.length,i=!1,r=!1;for(t=0;t<u;t++){if(i&&r)return;!r&&this._markers[t].time>=n&&(this._nextCustomMarkerIndex=t,this._nextCustomMarkerTime=this._markers[t].time,r=!0);!i&&this._markers[t].time<=n&&(this._previousCustomMarkerIndex=t,this._previousCustomMarkerTime=this._markers[t].time,i=!0)}s("WinJS.UI.MediaPlayer:_recalculateNextAndPreviousCustomMarkerIndexAndTime,StopTM")},_recalculateCachedUIElementSizes:function(){l.schedule(function(){this._disposed||(this._totalSeekBarWidth=this._seekBar.clientWidth,this._seekBarLeftOffset=this._seekBar.offsetLeft,this._thumbElementWidthDividedByTwo=this._thumbElement.clientWidth/2,this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2)},l.Priority.normal,this)},_refreshAudioTracksMenu:function(){for(var o,n,u,s,f=this._audioTracksFlyout.element.querySelectorAll("button"),r=0,e=f.length;r<e;r++)f[r].parentNode.removeChild(f[r]);if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.audioTracks)for(o=this._mediaElementAdapter.mediaElement.audioTracks,r=0,e=o.length;r<e;r++)n=o[r],u=t.document.createElement("button"),u.textContent=n.label||n.language,ot.hasWinRT&&!n.label&&(s=new i.Windows.Globalization.Language(n.language),u.textContent=s.displayName),n.enabled&&ot.addClass(u,"win-active"),u.addEventListener("click",function(){return function(){n&&!n.enabled&&(n.enabled=!0,this._refreshAudioTracksMenu())}.bind(this)}.bind(this)(n)),this._audioTracksFlyout.element.appendChild(u)},_refreshClosedCaptionsMenu:function(){for(var o,u,i,f=this._closedCaptionsFlyout.element.querySelectorAll("button"),r=0,e=f.length;r<e;r++)f[r].parentNode.removeChild(f[r]);if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.textTracks){for(o=this._mediaElementAdapter.mediaElement.textTracks,r=0,e=o.length;r<e;r++)u=o[r],(u.kind==="caption"||u.kind==="subtitles")&&(i=t.document.createElement("button"),i.textContent=u.label,u.mode==="showing"?(ot.addClass(i,"win-active"),i.textContent+=" "+n.mediaPlayerOverlayActiveOptionIndicator):u.mode==="hidden"&&ot.addClass(i,"win-mediaplayer-hidden"),i.addEventListener("click",function(n,t){return function(){this._setActiveTextTrack(t)}.bind(this)}.bind(this)(u,r)),this._closedCaptionsFlyout.element.appendChild(i));i=t.document.createElement("button");i.textContent=n.closedCaptionsLabelNone;i.addEventListener("click",function(){this._setActiveTextTrack(null)}.bind(this));this._closedCaptionsFlyout.element.appendChild(i)}},_removeButtonEventHandlers:function(){var n;if(this._buttonEventSubscriptions){for(n=0;n<this._buttonEventSubscriptions.length;n++){var t=this._buttonEventSubscriptions[n].button,i=this._buttonEventSubscriptions[n].eventName,r=this._buttonEventSubscriptions[n].handler;t.removeEventListener(i,r)}this._buttonEventSubscriptions=[]}},_removeControlsTimer:function(){this._controlHideTimeout&&(t.clearTimeout(this._controlHideTimeout),this._controlHideTimeout=null)},_removeGestureEventHandlers:function(){var n;if(this._gestureEventSubscriptions){for(n=0;n<this._gestureEventSubscriptions.length;n++){var t=this._gestureEventSubscriptions[n].owner,i=this._gestureEventSubscriptions[n].eventName,r=this._gestureEventSubscriptions[n].handler;t.removeEventListener(i,r)}this._gestureEventSubscriptions=[]}},_resetAutoHideControlsTimer:function(){if(this._controlHideTimeout){var n=this;t.clearTimeout(this._controlHideTimeout);this._controlHideTimeout=t.setTimeout(function(){n._hideControls()},this._CONTROLS_AUTO_HIDE_DURATION)}},_resetAutoHideTimers:function(){this._resetAutoHideControlsTimer()},_resetInternalState:function(){this._isBusy=!1;this._isChapterMarkerVisualsDirty=!1;this._doesEndTimeNeedResetting=!0;this._doesStartTimeNeedResetting=!0;this._doMarkersNeedResetting=!0;this._defaultChapterMarkers=[];this._endTime=0;this._endTimeReached=!1;this._FAST_FORWARD_OR_REWIND_TIMER_INTERVAL=250;this._handleTransportBarButtonFocus=null;this._hasCustomMarkers=!1;this._lastFastForwardOrRewindTimerTime=0;this._fastForwardOrRewindTimerElapsedTime=0;this._isInFastForwardOrRewindMode=!1;this._nextCustomMarkerIndex=-1;this._nextCustomMarkerTime=-1;this._previousCustomMarkerIndex=-1;this._previousCustomMarkerTime=-1;this._startTime=0;this._targetPlaybackRate=0;this._targetCurrentTime=0;this._totalTimeInternal=0;this._wasStartTimeSetProgrammatically=!1;this._wasEndTimeSetProgrammatically=!1;this._wasTimeClampedToEndTime=!1;this._progress.style.transform="scaleX(0)"},_seekInternal:function(n,t){this._mediaElementAdapter&&this._mediaElementAdapter.seek&&this._mediaElementAdapter.seekAllowed&&(this._exitFastForwardOrRewind(!0),n<this._startTime?n=this._startTime:n>this._endTime&&(n=this._endTime),this._mediaElementAdapter.isLive&&(n>this._liveTime?n=this._liveTime:n>this._endTime&&(n=this._endTime)),!isNaN(n)&&(t||!t&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA)&&this._mediaElementAdapter.seek(n),t&&this._updateUIAndRaiseEvents(st.seek,null))},_setActiveTextTrack:function(t){var o=this._closedCaptionsFlyout.element.querySelectorAll("button"),u,i,e,f,r;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.textTracks)for(u=this._mediaElementAdapter.mediaElement.textTracks,i=0,e=u.length;i<e;i++)f=u[i],r=o[i],r.textContent=f.label,i===t?(f.mode="showing",ot.addClass(r,"win-active"),r.textContent+=" "+n.mediaPlayerOverlayActiveOptionIndicator):(u[i].mode="hidden",ot.removeClass(r,"win-active"))},_setControlsTimer:function(){var n=this;this._controlHideTimeout=t.setTimeout(function(){n._hideControls()},this._controlsAddedHideDuration||this._CONTROLS_AUTO_HIDE_DURATION);this._lastControlsResetTimeStamp=Date.now()},_setFastForwardOrRewindText:function(){var t,i,r,u,f;this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(t=this._PLAYBACKRATE_NOT_PLAYING,t=this._isThumbnailEnabled?this._targetPlaybackRate:this._mediaElementAdapter.mediaElement.playbackRate,i="",r="",t>=this._PLAYBACKRATE_FAST_FORWARD_2X?(u=Math.floor(t/this._mediaElementAdapter.mediaElement.defaultPlaybackRate),r=st.fastForward,i=o._formatString(n.fastForwardFeedbackDisplayText,u)):t<=this._PLAYBACKRATE_REWIND_2X?(f=Math.floor(t/(-1*this._mediaElementAdapter.mediaElement.defaultPlaybackRate)),r=st.rewind,i=o._formatString(n.rewindFeedbackDisplayText,f)):t===this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE?(r=st.fastForward,i=n.fastForwardFeedbackSlowMotionDisplayText):t===this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE?(r=st.rewind,i=n.rewindFeedbackSlowMotionDisplayText):(r=st.play,i=n.playMediaCommandDisplayText),this._playbackSpeedIndicator.textContent=i,this.dispatchEvent("mediacommandexecuted",{mediaCommand:r}),this._updateMediaState(!1))},_setupNewMediaElement:function(n,t){if(s("WinJS.UI.MediaPlayer:_setupNewMediaElement,StartTM"),t&&(this._resetInternalState(),this._unsubscribeFromMediaEvents(t),ot.removeClass(t,"win-mediaplayer-video")),n&&this._element){n.controls=!1;ot.addClass(n,"win-mediaplayer-video");this.fullScreen=this._fullScreen?!0:!1;var r=null;r=this._fullScreen?this._element.querySelector(".win-mediaplayer"):this._element.querySelector(".win-mediaplayer-controls");r&&r.parentNode&&n.canHaveHTML&&r.parentNode.insertBefore(n,r);n&&(n.tagName===this._TAG_NAME_AUDIO?(this._layout===lt.partial?(ot.removeClass(this._controls,"win-mediaplayer-audio-full"),ot.addClass(this._controls,"win-mediaplayer-audio-partial")):this._layout===lt.full&&(ot.removeClass(this._controls,"win-mediaplayer-audio-partial"),ot.addClass(this._controls,"win-mediaplayer-audio-full")),this._smtControls&&(this._smtControls.displayUpdater.type=i.Windows.Media.MediaPlaybackType.audio)):(this._layout===lt.partial?(ot.removeClass(this._controls,"win-mediaplayer-video-full"),ot.addClass(this._controls,"win-mediaplayer-video-partial")):this._layout===lt.full&&(ot.removeClass(this._controls,"win-mediaplayer-video-partial"),ot.addClass(this._controls,"win-mediaplayer-video-full")),this._smtControls&&(this._smtControls.displayUpdater.type=i.Windows.Media.MediaPlaybackType.video)),n.readyState>this._MEDIA_READY_STATE_HAVE_METADATA&&this._updateDefaultStartAndEndTime(n),this._controlsVisible&&this._subscribeToTimeUpdates(),this._updateTimelineVisuals())}n&&(n.paused?this._showPlayButton():this._showPauseButton());n&&n.readyState>=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA?(t&&(this._doesEndTimeNeedResetting=!1,this._doesStartTimeNeedResetting=!1,this._doMarkersNeedResetting=!1),this._updateDefaultStartAndEndTime(n),this._wasEndTimeSetProgrammatically||(this._totalTime=n.duration-this._startTime,this._updateTimelineVisuals()),this._markers.length=0,this._initializeChapterMarkers(n)):t&&(this._doesEndTimeNeedResetting=!0,this._doesStartTimeNeedResetting=!0,this._doMarkersNeedResetting=!0);this._subscribeToMediaEvents(n);this._smtControls&&(this._smtControls.isNextEnabled=this.chapterSkipForwardButtonEnabled&&this.chapterSkipForwardButtonVisible||this.nextTrackButtonEnabled&&this.nextTrackButtonVisible,this._smtControls.isPreviousEnabled=this.chapterSkipBackButtonEnabled&&this.chapterSkipBackButtonVisible||this.previousTrackButtonEnabled&&this.previousTrackButtonVisible);s("WinJS.UI.MediaPlayer:_setupNewMediaElement,StopTM")},_showControls:function(n,t){var u,r;(s("WinJS.UI.MediaPlayer:_showControls,StartTM"),this._controlsVisible||this._isXboxSnapMode&&!n||this._disposed)||(this._totalSeekBarWidth||(this._totalSeekBarWidth=this._seekBar.clientWidth,this._seekBarLeftOffset=this._seekBar.offsetLeft,this._thumbElementWidthDividedByTwo=this._thumbElement.clientWidth/2,this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2),(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.currentSrc||n)&&(u=this._dispatchCancellableEvent("beforeshowcontrols",{}),u&&(ot.removeClass(this._controls,"win-mediaplayer-hidden"),this._controlsVisible=!0,this._updateChapterMarkerVisuals(),this._layout==="full"&&ct.canGoBack&&i.Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily==="Windows.Desktop"&&ot.removeClass(this._backButton.element,"win-mediaplayer-hidden"),this._controlHideTimeout&&this._removeControlsTimer(),this._transportControls.style.opacity=1,r=this,this._playShowControlsAnimation().then(function(){r._disposed||(s("WinJS.UI.MediaPlayer:_showControls,StopTM"),r.dispatchEvent("aftershowcontrols",{}))}),ot.hasWinRT&&(!c||c.ApplicationView.value===c.ApplicationViewState.snapped)||this._isInFastForwardOrRewindMode||t||this._setControlsTimer(),this._subscribeToTimeUpdates(),this._updateTimelineVisuals())))},_playShowControlsAnimation:function(){var l,r,y,f,e,n,t,w;if(this._skipAnimations)return h.wrap();var i=[],u=[],a=[],s=[],c=[],v=this._transportControls.querySelectorAll("button");for(n=0,t=v.length;n<t;n++)l=v[n],ot.hasClass(l,"win-mediaplayer-hidden")||l.style.display==="none"||l.style.visibility==="hidden"||i.push(v[n]);if(r=i.length,y=r%2!=0,this._compact){for(n=r-1;n>=0;n--)i[n].leftOfTimelineInSingleRowLayout&&u.push(i[n]);for(f=-64,n=u.length;n>0;n--)a.push({left:f+"px",top:"100px"}),f-=64*(n+1);for(n=0,t=r;n<t;n++)i[n].leftOfTimelineInSingleRowLayout||s.push(i[n]);for(e=64,n=s.length;n>0;n--)c.push({left:e+"px",top:"100px"}),e+=64*(n+1)}else{for(n=Math.floor(r/2)-1;n>=0;n--)u.push(i[n]);for(f=-64,n=0,t=u.length;n<t;n++)a.push({left:f+"px",top:"100px"}),f-=64*(n+1);for(n=Math.ceil(r/2),t=r;n<t;n++)s.push(i[n]);for(e=64,n=0,t=s.length;n<t;n++)c.push({left:e+"px",top:"100px"}),e+=64*(n+1);c.push({left:"0px",top:"100px"})}var o=[],b=new ft(a,"WinJS-showLeftTransportBarButtons",[{top:"100px",left:"-12px",rtlflip:!0}]),k=new ft(c,"WinJS-showRightTransportBarButtons",[{top:"100px",left:"12px",rtlflip:!0}]);return o.push(p.executeAnimation(u,[{property:"transform",delay:0,duration:500,timing:"cubic-bezier(0.16, 1, 0.29, 0.99)",from:et(b),to:"none"}])),y&&!this.compact&&(w=i[u.length],o.push(p.executeAnimation(w,[{property:"transform",delay:0,duration:500,timing:"cubic-bezier(0.16, 1, 0.29, 0.99)",from:"translateY(100px)",to:"none"}]))),o.push(p.executeAnimation(s,[{property:"transform",delay:0,duration:500,timing:"cubic-bezier(0.16, 1, 0.29, 0.99)",from:et(k),to:"none"}])),o.push(p.executeAnimation(this._progressContainer,[{property:"transform",delay:0,duration:500,timing:"cubic-bezier(0.16, 1, 0.29, 0.99)",from:"translateY(100px)",to:"none"}])),o.push(p.executeTransition(this._controls,[{property:"opacity",delay:0,duration:100,timing:"linear",from:0,to:1}])),h.join(o)},_playHideControlsAnimation:function(){var i,r,f,o,e,n,u,t,s;if(this._skipAnimations)return h.wrap();for(i=this._transportControls.querySelectorAll("button"),r=[],n=0,u=i.length;n<u;n++)f=i[n],ot.hasClass(f)||f.style.display==="none"||f.style.visibility==="hidden"||r.push(i[n]);for(o=r.length,e=[],n=0,u=o;n<u;n++)e.push({left:"0px",top:"100px"});return t=[],s=new ft(e,"WinJS-showLeftTransportBarButtons",[{top:"100px",left:"0px",rtlflip:!0}]),t.push(p.executeAnimation(r,[{property:"transform",delay:0,duration:333,timing:"cubic-bezier(0.71, 0.01, 0.84, 0)",from:"none",to:et(s)}])),t.push(p.executeAnimation(this._progressContainer,[{property:"transform",delay:0,duration:333,timing:"cubic-bezier(0.71, 0.01, 0.84, 0)",from:"none",to:"translateY(100px)"}])),t.push(p.executeTransition(this._controls,[{property:"opacity",delay:0,duration:333,timing:"linear",from:1,to:0}])),h.join(t)},_startFastForwardOrRewind:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.pause&&this._mediaElementAdapter.mediaElement){this._previousPlaybackRate=this._mediaElementAdapter.mediaElement.playbackRate;this._mediaElementAdapter.mediaElement.playbackRate=0;this._mediaElementAdapter.pause();this._fastForwardOrRewindTimerElapsedTime=0;this._lastFastForwardOrRewindTimerTime=(new Date).getTime();var n=this;this._onFastForwardRewindTimerTick();this._fastForwardOrRewindTimer=t.setInterval(function(){n._onFastForwardRewindTimerTick()},this._FAST_FORWARD_OR_REWIND_TIMER_INTERVAL);this._thumbnailImage&&(ot.removeClass(this._thumbElement,"win-mediaplayer-hidden"),ot.removeClass(this._thumbnailImage,"win-mediaplayer-hidden"),this._targetPlaybackRate===0||this._targetPlaybackRate===1?(ot.removeClass(this._element,"win-mediaplayer-scrubbing"),ot.removeClass(this._element,"win-mediaplayer-rewind"),ot.removeClass(this._element,"win-mediaplayer-fastforward")):this._targetPlaybackRate>0?(ot.removeClass(this._element,"win-mediaplayer-scrubbing"),ot.removeClass(this._element,"win-mediaplayer-rewind"),ot.addClass(this._element,"win-mediaplayer-fastforward")):this._targetPlaybackRate<0&&(ot.removeClass(this._element,"win-mediaplayer-scrubbing"),ot.removeClass(this._element,"win-mediaplayer-fastforward"),ot.addClass(this._element,"win-mediaplayer-rewind")),this._thumbImageElementWidthDividedByTwo||(this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2));this._isInFastForwardOrRewindMode=!0;this._wasTimeClampedToEndTime=!1}},_showPauseButton:function(){this._playPauseButton.winControl.icon=nt.pause;this._smtControls&&(this._smtControls.isPauseEnabled=!0,this._smtControls.isPlayEnabled=!1)},_showPlayButton:function(){this._playPauseButton.winControl.icon=nt.play;this._smtControls&&(this._smtControls.isPauseEnabled=!1,this._smtControls.isPlayEnabled=!0)},_subscribeToTimeUpdates:function(){var n=this;this._unsubscribeFromTimeUpdates();this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._addMediaEventListener(this._mediaElementAdapter.mediaElement,"timeupdate",function(){n._onTimeUpdate()})},_subscribeToMediaEvents:function(n){s("WinJS.UI.MediaPlayer:_subscribeToMediaEvents,StartTM");var t=this;this._addMediaEventListener(n,"addtrack",function(){t._updateAudioTracksButtonStateBind();t._updateClosedCaptionsButtonStateBind()});this._addMediaEventListener(n,"canplay",function(){t._onCanPlay()});this._addMediaEventListener(n,"change",function(){t._updateAudioTracksButtonStateBind();t._updateClosedCaptionsButtonStateBind()});this._addMediaEventListener(n,"durationchange",function(){t._onDurationChange()});this._addMediaEventListener(n,"emptied",function(){t._onEmptied()});this._addMediaEventListener(n,"ended",function(){t._onEnded()});this._addMediaEventListener(n,"error",function(n){t._onError(n)});this._addMediaEventListener(n,"loadstart",function(){t._onLoadStart()});this._addMediaEventListener(n,"loadedmetadata",function(){t._onLoadedMetadata()});this._addMediaEventListener(n,"pause",function(){t._onPause()});this._addMediaEventListener(n,"play",function(){t._onPlay()});this._addMediaEventListener(n,"playing",function(){t._onPlaying()});this._addMediaEventListener(n,"progress",function(){t._onProgress()});this._addMediaEventListener(n,"ratechange",function(){t._onRateChange()});this._addMediaEventListener(n,"removetrack",function(){t._updateClosedCaptionsButtonStateBind()});this._addMediaEventListener(n,"seeked",function(){t._onSeeked()});this._addMediaEventListener(n,"seeking",function(){t._onSeeking()});s("WinJS.UI.MediaPlayer:_subscribeToMediaEvents,StopTM")},_syncTimeAndProgress:function(n){var u;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(!ot.hasWinRT||c&&c.ApplicationView.value!==c.ApplicationViewState.snapped)){var f=this._mediaElementAdapter.mediaElement,e=this._startTime,r=this._endTime,t=f.currentTime-e,i=0;(!this._mediaElementAdapter.mediaElement.paused||n)&&(this._isThumbGrabbed||this._isInFastForwardOrRewindMode||!(n||this._controlsVisible)||(!this._totalSeekBarWidth&&this._seekBar.clientWidth&&(this._totalSeekBarWidth=this._seekBar.clientWidth),i=t/this._totalTime,u=i*this._totalSeekBarWidth,this._currentTimeVisualElements.style.transform="translateX("+u+"px)"),t>r&&(t=r),this._progress&&!this._isThumbGrabbed&&(this._progress.style.transform=this._totalTime!==0?"scaleX("+i+")":"scaleX(0)"))}},_timelineClickHandler:function(n){var t=n.x/this._totalSeekBarWidth*this._totalTime;this._seekInternal(t)},_unsubscribeFromMediaEvents:function(n){var i,t;if(n)for(i=this._mediaEventSubscriptions.length,t=0;t<i;t++)n.removeEventListener(this._mediaEventSubscriptions[t].eventName,this._mediaEventSubscriptions[t].handler);this._mediaEventSubscriptions=[]},_unsubscribeFromMediaEvent:function(n){var r,t,u,i;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement)for(r=this._mediaEventSubscriptions.length,t=0,u=r;t<u;t++)if(i=this._mediaEventSubscriptions[t].eventName,n===i){this._mediaElementAdapter.mediaElement.removeEventListener(i,this._mediaEventSubscriptions[t].handler);this._mediaEventSubscriptions.splice(t,1);break}},_unsubscribeFromTimeUpdates:function(){this._hasCustomMarkers||this._controlsVisible||this._unsubscribeFromMediaEvent("timeupdate")},_updateAudioTracksButtonState:function(){this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.audioTracks&&this._mediaElementAdapter.mediaElement.audioTracks.length>1?ot.removeClass(this._audioTracksButton,"win-mediaplayer-hidden"):ot.addClass(this._audioTracksButton,"win-mediaplayer-hidden")},_updateChapterMarkerVisuals:function(){var i,f,e,r,o,n,u,h,c;if(s("WinJS.UI.MediaPlayer:_updateChapterMarkerVisuals,StartTM"),this._isChapterMarkerVisualsDirty){if(i=null,i=this._defaultChapterMarkers.length?this._markers.concat(this._defaultChapterMarkers):this._markers,this._seekBar.parentNode)for(f=this._seekBar.parentNode.querySelectorAll(".win-mediaplayer-marker"),e=f.length,n=0;n<e;n++)f[n].parentNode.removeChild(f[n]);for(r=null,o=i.length,n=0;n<o;n++)r=i[n].time,i[n].extraClass&&r!==null&&(this._totalSeekBarWidth||(this._totalSeekBarWidth=this._seekBar.clientWidth,this._thumbElementWidthDividedByTwo=this._thumbElement.clientWidth/2,this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2),u=t.document.createElement("div"),u.id="ms__marker"+r.toString().replace(".","_"),ot.addClass(u,"win-mediaplayer-marker "+i[n].extraClass),h=r/this._totalTime,c=h*this._totalSeekBarWidth,u.style.marginLeft=c+"px",this._seekBar.parentNode&&this._seekBar.parentNode.insertBefore(u,this._seekBar.nextElementSibling));this._isChapterMarkerVisualsDirty=!0}s("WinJS.UI.MediaPlayer:_updateChapterMarkerVisuals,StopTM")},_updateClosedCaptionsButtonState:function(){var t,i,n,u,r;if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.textTracks){for(t=!1,i=this._mediaElementAdapter.mediaElement.textTracks,n=0,u=i.length;n<u;n++)if(r=i[n],r.kind==="caption"||r.kind==="subtitles"){t=!0;break}t?ot.removeClass(this._closedCaptionsButton,"win-mediaplayer-hidden"):ot.addClass(this._closedCaptionsButton,"win-mediaplayer-hidden")}},_updateDefaultStartAndEndTime:function(n){this._wasStartTimeSetProgrammatically||(this._startTime=n.initialTime||0,this._defaultChapterMarkers.length&&this._initializeDefaultChapterMarkers(),this._updateTimelineVisuals());this._wasEndTimeSetProgrammatically||(this._endTime=n.duration,this._defaultChapterMarkers.length&&this._initializeDefaultChapterMarkers(),this._updateTimelineVisuals());this._doesStartTimeNeedResetting&&(this._wasStartTimeSetProgrammatically=!1);this._doesEndTimeNeedResetting&&(this._wasEndTimeSetProgrammatically=!1);this._updateTimeDisplay()},_updateDomElements:function(){var i,u,f,r,n,o;if(s("WinJS.UI.MediaPlayer:_updateDomElements,StartTM"),this._removeButtonEventHandlers(),i=this._element.querySelector(".win-mediaplayer"),i||(i=t.document.createElement("div"),ot.addClass(i,"win-mediaplayer")),this._customButtons=this._element.querySelectorAll("[data-win-control='WinJS.UI.Command']"),i.innerHTML=this._mediaPlayerHtml,this._element.appendChild(i),this._buffer=this._element.querySelector(".win-mediaplayer-buffer"),this._busyIndicator=this._element.querySelector(".win-mediaplayer-busy"),this._controls=this._element.querySelector(".win-mediaplayer-controls"),this._currentTimeIndicator=this._element.querySelector(".win-mediaplayer-currenttimeindicator"),this._currentTimeVisualElements=this._element.querySelector(".win-mediaplayer-seekbarvisualelements-container"),this._inputHandlerElement=this._element.querySelector(".win-mediaplayer-inputhandler"),this._mediaCommandFeedbackText=this._element.querySelector(".win-mediaplayer-inputfeedback"),this._mediaPlayerContainer=this._element.querySelector(".win-mediaplayer-container"),this._playbackSpeedIndicator=this._element.querySelector(".win-mediaplayer-playbackspeedindicator"),this._progress=this._element.querySelector(".win-mediaplayer-seekprogress"),this._progressContainer=this._element.querySelector(".win-mediaplayer-progresscontainer"),this._metadataTitle=this._element.querySelector(".win-mediaplayer-mediatitle"),this._metadataDescription=this._element.querySelector(".win-mediaplayer-mediadescription"),this._seekBar=this._element.querySelector(".win-mediaplayer-seekbar"),this._seekMark=this._element.querySelector(".win-mediaplayer-seek-mark"),this._seekWindowLeftEdgeElement=this._element.querySelector(".win-mediaplayer-seek-leftboundary"),this._seekWindowRightEdgeElement=this._element.querySelector(".win-mediaplayer-seek-rightboundary"),this._seekTimeIndicator=this._element.querySelector(".win-mediaplayer-seektimeindicator"),this._thumbnailImage=this._element.querySelector(".win-mediaplayer-thumbnail"),this._thumbnailImageVisual=this._element.querySelector(".win-mediaplayer-thumbnailvisual"),this._thumbElement=this._element.querySelector(".win-mediaplayer-thumb"),this._timeline=this._element.querySelector(".win-mediaplayer-timeline"),this._timeRemainingIndicator=this._element.querySelector(".win-mediaplayer-timeremainingindicator"),this._toolbarElement=this._element.querySelector(".win-mediaplayer-commands"),this._totalTimeIndicator=this._element.querySelector(".win-mediaplayer-totaltimeindicator"),this._transportControls=this._element.querySelector(".win-mediaplayer-transportcontrols"),this._snappedOverlay=this._element.querySelector(".win-mediaplayer-snapped-overlay"),this._toolbar=new ut.ToolBar(this._toolbarElement),this._toolbar._updateDomImpl(),u=t.document.body.querySelector(".win-toolbar-overflowarea"),u&&this._commandsOverflowFlyout&&(this._commandsOverflowFlyout=u.winControl,this._commandsOverflowFlyout.addEventListener("beforeshow",this._handleBeforeShowOverflowMenuBind,!1)),this._updateTransportBarButtons(),f=this,this._transportControls)for(this._chapterSkipBackButton=this._transportControls.querySelector(".win-mediaplayer-chapterskipbackbutton"),this._chapterSkipForwardButton=this._transportControls.querySelector(".win-mediaplayer-chapterskipforwardbutton"),this._fastForwardButton=this._transportControls.querySelector(".win-mediaplayer-fastforwardbutton"),this._nextTrackButton=this._transportControls.querySelector(".win-mediaplayer-nexttrackbutton"),this._playFromBeginningButton=this._transportControls.querySelector(".win-mediaplayer-playfrombeginningbutton"),this._playPauseButton=this._transportControls.querySelector(".win-mediaplayer-playpausebutton"),this._playbackRateButton=this._transportControls.querySelector(".win-mediaplayer-playbackratebutton"),this._previousTrackButton=this._transportControls.querySelector(".win-mediaplayer-previoustrackbutton"),this._rewindButton=this._transportControls.querySelector(".win-mediaplayer-rewindbutton"),this._stopButton=this._transportControls.querySelector(".win-mediaplayer-stopbutton"),this._timeSkipBackButton=this._transportControls.querySelector(".win-mediaplayer-timeskipbackbutton"),this._timeSkipForwardButton=this._transportControls.querySelector(".win-mediaplayer-timeskipforwardbutton"),this._audioTracksButton=this._transportControls.querySelector(".win-mediaplayer-audiotracksbutton"),this._closedCaptionsButton=this._transportControls.querySelector(".win-mediaplayer-closedcaptionsbutton"),this._goToLiveButton=this._transportControls.querySelector(".win-mediaplayer-livebutton"),this._goToFullScreenButton=this._transportControls.querySelector(".win-mediaplayer-togglesnapbutton"),this._toggleFullScreenButton=this._transportControls.querySelector(".win-mediaplayer-fullscreenbutton"),this._castButton=this._transportControls.querySelector(".win-mediaplayer-playonremotedevicebutton"),this._volumeButton=this._transportControls.querySelector(".win-mediaplayer-volumebutton"),this._zoomButton=this._transportControls.querySelector(".win-mediaplayer-zoombutton"),this._backButton=new it.BackButton,this._busyIndicator.parentNode.insertBefore(this._backButton.element,this._busyIndicator),ot.addClass(this._backButton.element,"win-mediaplayer-hidden"),this._handleTransportBarButtonFocus=function(){f._resetAutoHideTimers()},this._handleTransportBarButtonClick=function(){f._resetAutoHideTimers()},this._handleTransportBarButtonKeyDown=function(n){n.key==="GamepadA"&&ot.addClass(n.srcElement,"win-mediaplayer-transportbarbutton-active")},this._handleTransportBarButtonKeyUp=function(n){n.key==="GamepadA"&&ot.removeClass(n.srcElement,"win-mediaplayer-transportbarbutton-active")},r=this._transportControls.getElementsByTagName("button"),n=0,o=r.length;n<o;n++)this._addButtonEventHandler(r[n],"focus",this._handleTransportBarButtonFocus),this._addButtonEventHandler(r[n],"click",this._handleTransportBarButtonClick),this._addButtonEventHandler(r[n],"keydown",this._handleTransportBarButtonKeyDown),this._addButtonEventHandler(r[n],"keyup",this._handleTransportBarButtonKeyUp);this._inputHandlerPointerDownCallback=this._onInputHandlerPointerDown.bind(this);this._inputHandlerPointerHoverCallback=this._onInputHandlerPointerHover.bind(this);this._inputHandlerPointerMoveCallback=this._onInputHandlerPointerMove.bind(this);this._inputHandlerPointerUpCallback=this._onInputHandlerPointerUp.bind(this);this._inputHandlerClickCallback=this._onInputHandlerClick.bind(this);this._inputHandlerMouseDownCallback=this._inputHandlerMouseDown.bind(this);this._inputHandlerMouseOutCallback=this._inputHandlerMouseOut.bind(this);this._inputHandlerMouseUpCallback=this._inputHandlerMouseUp.bind(this);this._handleVolumeFlyoutShowCallback=this._handleVolumeFlyoutShow.bind(this);this._handleVolumeSliderChangeCallback=this._handleVolumeSliderChange.bind(this);this._gestureRecognizer&&(this._addGestureEventHandler(this._gestureRecognizer,"manipulationstarted",this._handleManipulationStarted),this._addGestureEventHandler(this._gestureRecognizer,"manipulationupdated",this._handleManipulationUpdated),this._addGestureEventHandler(this._gestureRecognizer,"manipulationcompleted",this._handleManipulationCompleted),this._addGestureEventHandler(this._gestureRecognizer,"manipulationend",this._handleManipulationEnd));this._isXbox?(this._addGestureEventHandler(this._inputHandlerElement,"click",this._inputHandlerClickCallback),this._addGestureEventHandler(this._inputHandlerElement,"pointerdown",this._handlePointerDown),this._addGestureEventHandler(this._inputHandlerElement,"pointerhover",this._handlePointerHover),this._addGestureEventHandler(this._inputHandlerElement,"pointermove",this._handlePointerMove),this._addGestureEventHandler(this._inputHandlerElement,"pointerup",this._handlePointerUp)):(this._addGestureEventHandler(this._mediaPlayerContainer,"click",this._inputHandlerClickCallback),this._addGestureEventHandler(this._progressContainer,"mousedown",this._inputHandlerPointerDownCallback),this._addGestureEventHandler(this._progressContainer,"mouseover",this._handlePointerHover),this._addGestureEventHandler(t.window,"mousemove",this._inputHandlerPointerMoveCallback),this._addGestureEventHandler(this._progressContainer,"mouseup",this._inputHandlerPointerUpCallback),this._addGestureEventHandler(this._progressContainer,"mousedown",this._inputHandlerMouseDownCallback),this._addGestureEventHandler(t.document,"mouseout",this._inputHandlerMouseOutCallback),this._addGestureEventHandler(t.window,"mouseup",this._inputHandlerMouseUpCallback));this._addGestureEventHandler(this._progressContainer,"click",this._timelineClickHandler);this._timeline.addEventListener("keydown",this._handleTimelineArrowKeyDownBind,!1);this._element.addEventListener("keyup",this._controlsKeyupInputHandler,!1);e.processAll(this._element);s("WinJS.UI.MediaPlayer:_updateDomElements,StopTM")},_updateFastForwardAndRewindState:function(n,t){!this._isFastForwardOrRewind(n)&&this._isFastForwardOrRewind(t)?this._startFastForwardOrRewind():this._isFastForwardOrRewind(n)&&!this._isFastForwardOrRewind(t)&&this._exitFastForwardOrRewind(!0);this.dispatchEvent("targetratechange",{});this._updateMediaState(!1)},_updateFullScreenButtonVisuals:function(){this._toggleFullScreenButton.winControl.icon=this.fullScreen?"backtowindow":"fullscreen"},_updateInfoDisplay:function(n){this._mediaCommandFeedbackText.textContent=n},_updateMediaState:function(n){if(ot.hasWinRT&&i.Windows.Xbox&&this._smtControls){var u=1e3,r=i.Windows.Media.MediaPlaybackStatus,t=this._smtControls.displayUpdater;t&&this._mediaMetadata&&(t.appMediaId=this._mediaMetadata.contentId);this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.src?n||this._mediaElementAdapter.mediaElement.ended?this._smtControls.playbackStatus=r.stopped:this._isBusy?this._mediaElementAdapter.mediaElement.readyState<=this._MEDIA_READY_STATE_HAVE_FUTURE_DATA&&(this._smtControls.playbackStatus=r.changing):this._smtControls.playbackStatus=this._isInFastForwardOrRewindMode?this._isInFastForwardOrRewindMode?r.playing:r.closed:this._mediaElementAdapter.mediaElement.paused?r.paused:r.playing:this._smtControls.playbackStatus=r.closed;this._smtControls.isFastForwardEnabled=this.fastForwardButtonEnabled&&this.fastForwardButtonVisible;this._smtControls.isNextEnabled=this.chapterSkipForwardButtonEnabled&&this.chapterSkipForwardButtonVisible||this.nextTrackButtonEnabled&&this.nextTrackButtonVisible;this.playPauseButtonEnabled&&this.playPauseButtonEnabled&&this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(this._mediaElementAdapter.mediaElement.paused?(this._smtControls.isPlayEnabled=!0,this._smtControls.isPauseEnabled=!1):(this._smtControls.isPlayEnabled=!1,this._smtControls.isPauseEnabled=!0));this._smtControls.isPreviousEnabled=this.chapterSkipBackButtonEnabled&&this.chapterSkipBackButtonVisible||this.previousTrackButtonEnabled&&this.previousTrackButtonVisible;this._smtControls.isRewindEnabled=this.rewindButtonEnabled&&this.rewindButtonVisible;this._smtControls.isStopEnabled=this.stopButtonEnabled&&this.stopButtonVisible;this._smtControls.isChannelUpEnabled=this._isButtonEnabledAndVisible(this._channelUpButton);this._smtControls.isChannelDownEnabled=this._isButtonEnabledAndVisible(this._channelDownButton);this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&!isFinite(this._mediaElementAdapter.mediaElement.duration)&&this._mediaElementAdapter.mediaElement.readyState>this._MEDIA_READY_STATE_HAVE_METADATA&&(this._mediaElementAdapter.isLive=!0);t.type===i.Windows.Media.MediaPlaybackType.video&&(t.videoProperties.mediaStart=0,this._mediaElementAdapter&&this._mediaElementAdapter.seekAllowed?(isFinite(this._startTime)&&(t.videoProperties.minSeek=this._startTime*u),this._mediaElementAdapter.isLive?t.videoProperties.maxSeek=isFinite(this.targetCurrentTime)&&isFinite(this._startTime)?(this.targetCurrentTime-this._startTime)*u:0:isFinite(this._endTime)&&(t.videoProperties.maxSeek=this._endTime*u)):(t.videoProperties.minSeek=0,t.videoProperties.maxSeek=0),t.videoProperties.playbackPosition=isFinite(this.targetCurrentTime)?this.targetCurrentTime*u:0,t.videoProperties.playbackRate=this.targetPlaybackRate,this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&t.type&&(this._mediaElementAdapter.isLive?(t.videoProperties.mediaStart=0,t.videoProperties.mediaEnd=-1):this._mediaElementAdapter.mediaElement.duration&&isFinite(this._mediaElementAdapter.mediaElement.duration)&&(t.videoProperties.mediaStart=0,t.videoProperties.mediaEnd=this._mediaElementAdapter.mediaElement.duration*u)));t.update()}},_updateTimeDisplay:function(){if(this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(!ot.hasWinRT||c&&c.ApplicationView.value!==c.ApplicationViewState.snapped))if(this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_FUTURE_DATA)this._clearTimeDisplay();else{var n=this._getElapsedTimeText();this._currentTimeIndicator.textContent=n;this._totalTimeIndicator.textContent="-"+this._getTotalTimeText();this._isInFastForwardOrRewindMode&&(this._seekTimeIndicator.textContent=n)}},_updateTimelineVisuals:function(){this._syncTimeAndProgress(!0);this._updateTimeDisplay()},_updateTransportBarButtons:function(){for(var h=[{internalVariableName:"_playFromBeginningButton",classList:"win-mediaplayer-hidden win-mediaplayer-playfrombeginningbutton",options:{id:"win-mediaplayer-playfrombeginning",label:n.mediaPlayerPlayFromBeginningButtonLabel,tooltip:n.mediaPlayerPlayFromBeginningButtonLabel,priority:3,icon:"refresh",onclick:this._onPlayFromBeginningCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_playPauseButton",classList:"win-mediaplayer-playpausebutton",options:{id:"win-mediaplayer-playpause",label:n.mediaPlayerPlayButtonLabel,tooltip:n.mediaPlayerPlayButtonLabel,priority:3,icon:"play",onclick:this._onPlayPauseCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_playbackRateButton",classList:"win-mediaplayer-hidden win-mediaplayer-playbackratebutton",options:{id:"win-mediaplayer-playbackrate",label:n.mediaPlayerPlayRateButtonLabel,tooltip:n.mediaPlayerPlayRateButtonLabel,priority:5,icon:"settings",onclick:this._onPlaybackRateCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_stopButton",classList:"win-mediaplayer-hidden win-mediaplayer-stopbutton",options:{id:"win-mediaplayer-stop",label:n.mediaPlayerStopButtonLabel,tooltip:n.mediaPlayerStopButtonLabel,priority:27,icon:"stop",onclick:this._onStopCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_timeSkipBackButton",classList:"win-mediaplayer-hidden win-mediaplayer-timeskipbackbutton",options:{id:"win-mediaplayer-timeskipback",label:n.mediaPlayerTimeSkipBackButtonLabel,tooltip:n.mediaPlayerTimeSkipBackButtonLabel,priority:23,icon:"undo",onclick:this._onTimeSkipBackCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_timeSkipForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-timeskipforwardbutton",options:{id:"win-mediaplayer-timeskipforward",label:n.mediaPlayerTimeSkipForwardButtonLabel,tooltip:n.mediaPlayerTimeSkipForwardButtonLabel,priority:23,icon:"redo",onclick:this._onTimeSkipForwardCommandInvoked.bind(this)},leftOfTimelineInSingleRowLayout:!0},{internalVariableName:"_previousTrackButton",classList:"win-mediaplayer-hidden win-mediaplayer-previoustrackbutton",options:{id:"win-mediaplayer-playfrombeginning",label:n.mediaPlayerPreviousTrackButtonLabel,tooltip:n.mediaPlayerPreviousTrackButtonLabel,priority:17,icon:"refresh",onclick:this._onPlayFromBeginningCommandInvoked.bind(this)}},{internalVariableName:"_chapterSkipBackButton",classList:"win-mediaplayer-hidden win-mediaplayer-chapterskipbackbutton",options:{id:"win-mediaplayer-chapterskipback",label:n.mediaPlayerChapterSkipBackButtonLabel,tooltip:n.mediaPlayerChapterSkipBackButtonLabel,priority:17,icon:"previous",onclick:this._onChapterSkipBackCommandInvoked.bind(this)}},{internalVariableName:"_rewindButton",classList:"win-mediaplayer-hidden win-mediaplayer-rewindbutton",options:{id:"win-mediaplayer-rewind",label:n.mediaPlayerRewindButtonLabel,tooltip:n.mediaPlayerRewindButtonLabel,section:"primary",priority:25,icon:"previous",onclick:this._onRewindCommandInvoked.bind(this)}},{internalVariableName:"_fastForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-fastforwardbutton",options:{id:"win-mediaplayer-fastforward",label:n.mediaPlayerFastForwardButtonLabel,tooltip:n.mediaPlayerFastForwardButtonLabel,priority:25,icon:"next",onclick:this._onFastForwardCommandInvoked.bind(this)}},{internalVariableName:"_chapterSkipForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-chapterskipforwardbutton",options:{id:"win-mediaplayer-chapterskipforward",label:n.mediaPlayerChapterSkipForwardButtonLabel,tooltip:n.mediaPlayerChapterSkipForwardButtonLabel,priority:17,icon:"forward",onclick:this._onChapterSkipForwardCommandInvoked.bind(this)}},{internalVariableName:"_nextTrackButton",classList:"win-mediaplayer-hidden win-mediaplayer-nexttrackbutton",options:{id:"win-mediaplayer-nexttrack",label:n.mediaPlayerNextTrackButtonLabel,tooltip:n.mediaPlayerNextTrackButtonLabel,priority:17,icon:"next",onclick:this._onNextTrackCommandInvoked.bind(this)}},{internalVariableName:"_closedCaptionsButton",classList:"win-mediaplayer-hidden win-mediaplayer-closedcaptionsbutton",options:{id:"win-mediaplayer-closedcaptions",label:n.mediaPlayerClosedCaptionsButtonLabel,tooltip:n.mediaPlayerClosedCaptionsButtonLabel,priority:11,icon:"cc",onclick:this._onClosedCaptionsCommandInvoked.bind(this)}},{internalVariableName:"_castButton",classList:"win-mediaplayer-playonremotedevicebutton",options:{id:"win-mediaplayer-playonremotedevice",label:n.mediaPlayerCastButtonLabel,tooltip:n.mediaPlayerCastButtonLabel,priority:13,icon:"setlockscreen",onclick:this._onCastCommandInvoked.bind(this)}},{internalVariableName:"_zoomButton",classList:"win-mediaplayer-hidden win-mediaplayer-zoombutton",options:{id:"win-mediaplayer-zoom",label:n.mediaPlayerZoomButtonLabel,tooltip:n.mediaPlayerZoomButtonLabel,priority:19,icon:"stopslideshow",onclick:this._onZoomCommandInvoked.bind(this)}},{internalVariableName:"_audioTracksButton",classList:"win-mediaplayer-hidden win-mediaplayer-audiotracksbutton",options:{id:"win-mediaplayer-audiotracks",label:n.mediaPlayerAudioTracksButtonLabel,tooltip:n.mediaPlayerAudioTracksButtonLabel,priority:15,icon:"characters",onclick:this._onAudioTracksCommandInvoked.bind(this)}},{internalVariableName:"_goToLiveButton",classList:"win-mediaplayer-hidden win-mediaplayer-livebutton",options:{id:"win-mediaplayer-live",label:n.mediaPlayerLiveButtonLabel,tooltip:n.mediaPlayerLiveButtonLabel,priority:21,icon:"gotostart",onclick:this._onLiveButtonCommandInvoked.bind(this)}},{internalVariableName:"_volumeButton",classList:"win-mediaplayer-volumebutton",options:{id:"win-mediaplayer-volume",label:n.mediaPlayerVolumeButtonLabel,tooltip:n.mediaPlayerVolumeButtonLabel,priority:7,icon:"volume",onclick:this._onVolumeCommandInvoked.bind(this)}},{internalVariableName:"_toggleFullScreenButton",classList:"win-mediaplayer-fullscreenbutton",options:{id:"win-mediaplayer-fullscreen",label:n.mediaPlayerFullscreenButtonLabel,tooltip:n.mediaPlayerFullscreenButtonLabel,priority:9,icon:"fullscreen",onclick:this._onToggleFullscreenCommandInvoked.bind(this)}}],c=[{internalVariableName:"_stopButton",classList:"win-mediaplayer-hidden win-mediaplayer-stopbutton",options:{id:"win-mediaplayer-stop",label:n.mediaPlayerStopButtonLabel,tooltip:n.mediaPlayerStopButtonLabel,priority:27,icon:"stop",onclick:this._onStopCommandInvoked.bind(this)}},{internalVariableName:"_playFromBeginningButton",classList:"win-mediaplayer-hidden win-mediaplayer-playfrombeginningbutton",options:{id:"win-mediaplayer-playfrombeginning",label:n.mediaPlayerPlayFromBeginningButtonLabel,tooltip:n.mediaPlayerPlayFromBeginningButtonLabel,priority:3,icon:"refresh",onclick:this._onPlayFromBeginningCommandInvoked.bind(this)}},{internalVariableName:"_zoomButton",classList:"win-mediaplayer-hidden win-mediaplayer-zoombutton",options:{id:"win-mediaplayer-zoom",label:n.mediaPlayerZoomButtonLabel,tooltip:n.mediaPlayerZoomButtonLabel,priority:19,icon:"stopslideshow",onclick:this._onZoomCommandInvoked.bind(this)}},{internalVariableName:"_castButton",classList:"win-mediaplayer-playonremotedevicebutton",options:{id:"win-mediaplayer-playonremotedevice",label:n.mediaPlayerCastButtonLabel,tooltip:n.mediaPlayerCastButtonLabel,priority:13,icon:"setlockscreen",onclick:this._onCastCommandInvoked.bind(this)}},{internalVariableName:"_audioTracksButton",classList:"win-mediaplayer-hidden win-mediaplayer-audiotracksbutton",options:{id:"win-mediaplayer-audiotracks",label:n.mediaPlayerAudioTracksButtonLabel,tooltip:n.mediaPlayerAudioTracksButtonLabel,priority:15,icon:"characters",onclick:this._onAudioTracksCommandInvoked.bind(this)}},{internalVariableName:"_previousTrackButton",classList:"win-mediaplayer-hidden win-mediaplayer-previoustrackbutton",options:{id:"win-mediaplayer-playfrombeginning",label:n.mediaPlayerPreviousTrackButtonLabel,tooltip:n.mediaPlayerPreviousTrackButtonLabel,priority:17,icon:"refresh",onclick:this._onPlayFromBeginningCommandInvoked.bind(this)}},{internalVariableName:"_chapterSkipBackButton",classList:"win-mediaplayer-hidden win-mediaplayer-chapterskipbackbutton",options:{id:"win-mediaplayer-chapterskipback",label:n.mediaPlayerChapterSkipBackButtonLabel,tooltip:n.mediaPlayerChapterSkipBackButtonLabel,priority:17,icon:"previous",onclick:this._onChapterSkipBackCommandInvoked.bind(this)}},{internalVariableName:"_rewindButton",classList:"win-mediaplayer-hidden win-mediaplayer-rewindbutton",options:{id:"win-mediaplayer-rewind",label:n.mediaPlayerRewindButtonLabel,tooltip:n.mediaPlayerRewindButtonLabel,section:"primary",priority:25,icon:"previous",onclick:this._onRewindCommandInvoked.bind(this)}},{internalVariableName:"_timeSkipBackButton",classList:"win-mediaplayer-hidden win-mediaplayer-timeskipbackbutton",options:{id:"win-mediaplayer-timeskipback",label:n.mediaPlayerTimeSkipBackButtonLabel,tooltip:n.mediaPlayerTimeSkipBackButtonLabel,priority:23,icon:"undo",onclick:this._onTimeSkipBackCommandInvoked.bind(this)}},{internalVariableName:"_playPauseButton",classList:"win-mediaplayer-playpausebutton",options:{id:"win-mediaplayer-playpause",label:n.mediaPlayerPlayButtonLabel,tooltip:n.mediaPlayerPlayButtonLabel,priority:3,icon:"play",onclick:this._onPlayPauseCommandInvoked.bind(this)}},{internalVariableName:"_playbackRateButton",classList:"win-mediaplayer-hidden win-mediaplayer-playbackratebutton",options:{id:"win-mediaplayer-playbackrate",label:n.mediaPlayerPlayRateButtonLabel,tooltip:n.mediaPlayerPlayRateButtonLabel,priority:5,icon:"settings",onclick:this._onPlaybackRateCommandInvoked.bind(this)}},{internalVariableName:"_timeSkipForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-timeskipforwardbutton",options:{id:"win-mediaplayer-timeskipforward",label:n.mediaPlayerTimeSkipForwardButtonLabel,tooltip:n.mediaPlayerTimeSkipForwardButtonLabel,priority:23,icon:"redo",onclick:this._onTimeSkipForwardCommandInvoked.bind(this)}},{internalVariableName:"_fastForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-fastforwardbutton",options:{id:"win-mediaplayer-fastforward",label:n.mediaPlayerFastForwardButtonLabel,tooltip:n.mediaPlayerFastForwardButtonLabel,priority:25,icon:"next",onclick:this._onFastForwardCommandInvoked.bind(this)}},{internalVariableName:"_chapterSkipForwardButton",classList:"win-mediaplayer-hidden win-mediaplayer-chapterskipforwardbutton",options:{id:"win-mediaplayer-chapterskipforward",label:n.mediaPlayerChapterSkipForwardButtonLabel,tooltip:n.mediaPlayerChapterSkipForwardButtonLabel,priority:17,icon:"forward",onclick:this._onChapterSkipForwardCommandInvoked.bind(this)}},{internalVariableName:"_nextTrackButton",classList:"win-mediaplayer-hidden win-mediaplayer-nexttrackbutton",options:{id:"win-mediaplayer-nexttrack",label:n.mediaPlayerNextTrackButtonLabel,tooltip:n.mediaPlayerNextTrackButtonLabel,priority:17,icon:"next",onclick:this._onNextTrackCommandInvoked.bind(this)}},{internalVariableName:"_closedCaptionsButton",classList:"win-mediaplayer-hidden win-mediaplayer-closedcaptionsbutton",options:{id:"win-mediaplayer-closedcaptions",label:n.mediaPlayerClosedCaptionsButtonLabel,tooltip:n.mediaPlayerClosedCaptionsButtonLabel,priority:11,icon:"cc",onclick:this._onClosedCaptionsCommandInvoked.bind(this)}},{internalVariableName:"_goToLiveButton",classList:"win-mediaplayer-hidden win-mediaplayer-livebutton",options:{id:"win-mediaplayer-live",label:n.mediaPlayerLiveButtonLabel,tooltip:n.mediaPlayerLiveButtonLabel,priority:21,icon:"gotostart",onclick:this._onLiveButtonCommandInvoked.bind(this)}},{internalVariableName:"_volumeButton",classList:"win-mediaplayer-volumebutton",options:{id:"win-mediaplayer-volume",label:n.mediaPlayerVolumeButtonLabel,tooltip:n.mediaPlayerVolumeButtonLabel,priority:7,icon:"volume",onclick:this._onVolumeCommandInvoked.bind(this)}},{internalVariableName:"_toggleFullScreenButton",classList:"win-mediaplayer-fullscreenbutton",options:{id:"win-mediaplayer-fullscreen",label:n.mediaPlayerFullscreenButtonLabel,tooltip:n.mediaPlayerFullscreenButtonLabel,priority:9,icon:"fullscreen",onclick:this._onToggleFullscreenCommandInvoked.bind(this)}}],s=this._compact?h:c,f=new v.List,i=0,e=s.length;i<e;i++){var u=s[i],o=null,r=null;this._toolbarInitialized?(r=this._toolbarElement.querySelector("#"+u.options.id),o=r.winControl):(r=t.document.createElement("button"),ot.addClass(r,u.classList),o=new g.AppBarCommand(r,u.options));u.leftOfTimelineInSingleRowLayout&&(r.leftOfTimelineInSingleRowLayout=!0);f.push(o)}for(i=0,e=this._customButtons.length;i<e;i++)d.process(this._customButtons[i]),f.push(this._customButtons[i].winControl);this._pendingAdditionalCommands&&(this._toolbar.data.concat(this._pendingAdditionalCommands),this._pendingAdditionalCommands=null);this._toolbar.data=f;this._toolbar._updateDomImpl();this._toolbar._updateDomImpl_renderOpened=function(){};this._totalSeekBarWidth=this._seekBar.clientWidth;this._thumbElementWidthDividedByTwo=this._thumbElement.clientWidth/2;this._thumbImageElementWidthDividedByTwo=this._thumbnailImage.clientWidth/2},_updateUIAndRaiseEvents:function(n){this.dispatchEvent("mediacommandexecuted",{mediaCommand:n});this._updateMediaState(!1)},controlsVisible:{get:function(){return this._controlsVisible}},isControlsVisible:{get:function(){return this.controlsVisible}},endTime:{get:function(){return this._endTime?this._endTime:this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement?this._mediaElementAdapter.mediaElement.duration:undefined},set:function(t){if(t<0||isNaN(t)||!isFinite(t))throw new f("WinJS.UI.MediaPlayer.invalidTimeValue",n.mediaPlayerInvalidTimeValue);this._endTime=t;this._wasEndTimeSetProgrammatically=!0;this._totalTime=this._endTime-this._startTime;(!this._mediaElementAdapter||!this._mediaElementAdapter.mediaElement||this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_METADATA)&&(this._doesEndTimeNeedResetting=!1);this._subscribeToTimeUpdates();this._updateTimelineVisuals();this._updateMediaState(!1)}},element:{get:function(){return this._element}},commands:{get:function(){return this._toolbar.data},set:function(n){this._toolbar?this._toolbar.data=n:this._pendingAdditionalCommands=n}},compact:{get:function(){return this._compact},set:function(n){var r,i,u;if(this._compact===n){!n&&this._commandsOverflowFlyout&&this._commandsOverflowFlyout.element&&ot.addClass(this._commandsOverflowFlyout.element,"win-mediaplayer-doublerow");return}this._compact=n;this._updateTransportBarButtons();this._compact?(r=null,r=this._timeline.winControl?this._timeline.winControl:new g.Command(this._timeline,{type:"content"}),i=this._toolbar.data,u=i.indexOf(this._toolbarElement.querySelector(".win-mediaplayer-timeskipforwardbutton").winControl),i.push(r),i.move(i.length-1,u),ot.removeClass(this._element,"win-mediaplayer-doublerow"),ot.addClass(this._element,"win-mediaplayer-singlerow"),this._commandsOverflowFlyout&&ot.removeClass(t.document.body.querySelector(".win-toolbar-overflowarea"),"win-mediaplayer-doublerow")):(this._toolbarElement.parentNode.insertBefore(this._timeline,this._toolbarElement),ot.removeClass(this._element,"win-mediaplayer-singlerow"),ot.addClass(this._element,"win-mediaplayer-doublerow"),ot.addClass(t.document.body.querySelector(".win-toolbar-overflowarea"),"win-mediaplayer-doublerow"))}},fullScreen:{get:function(){var r,n;return ot.hasWinRT?(r=i.Windows.UI.ViewManagement.ApplicationView.getForCurrentView(),this._fullScreen=r.isFullScreen):(n=this._element,n.requestFullscreen?this._fullScreen=t.document.fullScreenElement?!0:!1:n.msRequestFullscreen?this._fullScreen=t.document.msFullscreenElement?!0:!1:n.mozRequestFullScreen?this._fullScreen=t.document.mozFullScreenElement?!0:!1:n.webkitRequestFullscreen&&(this._fullScreen=t.document.webkitFullscreenElement?!0:!1)),this._fullScreen},set:function(n){var r=this._element,u;n?(ot.addClass(this._element,"win-mediaplayer-fullscreen"),ot.removeClass(this.element,"win-focusable"),this._element.removeEventListener("keydown",this._keydownInputHandler),this._element.removeEventListener("keyup",this._keyupInputHandler),t.document.addEventListener("keydown",this._keydownInputHandler,!1),t.document.addEventListener("keyup",this._keyupInputHandler,!1),this._toggleFullScreenButton&&(this._toggleFullScreenButton.winControl.icon="backtowindow"),ot.hasWinRT?(u=i.Windows.UI.ViewManagement.ApplicationView.getForCurrentView(),u.tryEnterFullScreenMode()):r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen(),this._recalculateCachedUIElementSizes()):(ot.removeClass(this._element,"win-mediaplayer-fullscreen"),ot.addClass(this.element,"win-focusable"),t.document.removeEventListener("keydown",this._keydownInputHandler),t.document.removeEventListener("keyup",this._keyupInputHandler),this._element.addEventListener("keydown",this._keydownInputHandler,!1),this._element.addEventListener("keyup",this._keyupInputHandler,!1),this._toggleFullScreenButton&&(this._toggleFullScreenButton.winControl.icon="fullscreen"),ot.hasWinRT?(u=i.Windows.UI.ViewManagement.ApplicationView.getForCurrentView(),u.exitFullScreenMode()):r.requestFullscreen?t.document.cancelFullScreen():r.msRequestFullscreen?t.document.msExitFullscreen():r.mozRequestFullScreen?t.document.mozCancelFullScreen():r.webkitRequestFullscreen&&t.document.webkitCancelFullScreen(),this._recalculateCachedUIElementSizes());this._fullScreen=n}},isFullScreen:{get:function(){return this.fullScreen},set:function(n){this.fullScreen=n}},thumbnailEnabled:{get:function(){return this._thumbnailEnabled},set:function(n){n?ot.addClass(this._timeline,"win-mediaplayer-thumbnailmode"):ot.removeClass(this._timeline,"win-mediaplayer-thumbnailmode");this._thumbnailEnabled=n;this._isThumbnailEnabled=!0}},isThumbnailEnabled:{get:function(){return this.thumbnailEnabled},set:function(n){this.thumbnailEnabled=n}},markers:{get:function(){return this._markers},set:function(n){this._markers.length=0;this._markers=n;(!this._mediaElementAdapter||!this._mediaElementAdapter.mediaElement||this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_METADATA)&&(this._doMarkersNeedResetting=!1);this._markers.length||(this._hasCustomMarkers=!1,this._unsubscribeFromTimeUpdates());this._onMarkerCollectionChanged()}},mediaElementAdapter:{get:function(){return this._mediaElementAdapter},set:function(n){var t=null,i=null;this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(t=this._mediaElementAdapter.mediaElement);n&&n.mediaElement&&(i=n.mediaElement);this._setupNewMediaElement(i,t);this._mediaElementAdapter=n}},layout:{get:function(){return this._layout},set:function(t){if(t!==lt.full&&t!==lt.partial)throw new f("WinJS.UI.MediaPlayer.unsupportedLayout",n.mediaPlayerLayoutUnsupportedValue);this._layout=t;this._updateDomElements()}},startTime:{get:function(){return this._startTime||0},set:function(t){if(t<0||isNaN(t)||!isFinite(t))throw new f("WinJS.UI.MediaPlayer.invalidTimeValue",n.mediaPlayerInvalidTimeValue);this._startTime=t;this._wasStartTimeSetProgrammatically=!0;this._totalTime=this._endTime-this._startTime;(!this._mediaElementAdapter||!this._mediaElementAdapter.mediaElement||this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_METADATA)&&(this._doesStartTimeNeedResetting=!1);this._subscribeToTimeUpdates();this._updateTimelineVisuals();this._updateMediaState(!1)}},targetCurrentTime:{get:function(){var n=0;return this._isThumbnailEnabled&&this._isInFastForwardOrRewindMode?n=this._targetCurrentTime:this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(n=this._mediaElementAdapter.mediaElement.currentTime),n}},targetPlaybackRate:{get:function(){var n=0;return this._isThumbnailEnabled&&this._isInFastForwardOrRewindMode?n=this._targetPlaybackRate:this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(n=this._mediaElementAdapter.mediaElement.playbackRate),n}},timeFormatter:{get:function(){return this._timeFormatter},set:function(n){this._timeFormatter=n?n:this._defaultTimeFormatter}},thumbnailImage:{set:function(n){this._thumbnailImageVisual.style.backgroundImage="url("+n+")"}},castButtonVisible:{get:function(){return this._castButtonVisible},set:function(n){this._castButtonVisible=n?!0:!1;this._castButtonVisible?ot.removeClass(this._castButton,"win-mediaplayer-hidden"):ot.addClass(this._castButton,"win-mediaplayer-hidden")}},castButtonEnabled:{get:function(){return this._castButtonEnabled},set:function(n){this._castButtonEnabled=n?!0:!1;this._castButton.disabled=this._castButtonEnabled?!1:!0}},chapterSkipBackButtonVisible:{get:function(){return this._chapterSkipBackButtonVisible},set:function(n){this._chapterSkipBackButtonVisible=n?!0:!1;this._chapterSkipBackButtonVisible?ot.removeClass(this._chapterSkipBackButton,"win-mediaplayer-hidden"):ot.addClass(this._chapterSkipBackButton,"win-mediaplayer-hidden")}},chapterSkipBackButtonEnabled:{get:function(){return this._chapterSkipBackButtonEnabled},set:function(n){this._chapterSkipBackButtonEnabled=n?!0:!1;this._chapterSkipBackButton.disabled=this._chapterSkipBackButtonEnabled?!1:!0}},chapterSkipForwardButtonVisible:{get:function(){return this._chapterSkipForwardButtonVisible},set:function(n){this._chapterSkipForwardButtonVisible=n?!0:!1;this._chapterSkipForwardButtonVisible?ot.removeClass(this._chapterSkipForwardButton,"win-mediaplayer-hidden"):ot.addClass(this._chapterSkipForwardButton,"win-mediaplayer-hidden")}},chapterSkipForwardButtonEnabled:{get:function(){return this._chapterSkipForwardButtonEnabled},set:function(n){this._chapterSkipForwardButtonEnabled=n?!0:!1;this._chapterSkipForwardButton.disabled=this._chapterSkipForwardButtonEnabled?!1:!0}},fastForwardButtonVisible:{get:function(){return this._fastForwardButtonVisible},set:function(n){this._fastForwardButtonVisible=n?!0:!1;this._fastForwardButtonVisible?ot.removeClass(this._fastForwardButton,"win-mediaplayer-hidden"):ot.addClass(this._fastForwardButton,"win-mediaplayer-hidden")}},fastForwardButtonEnabled:{get:function(){return this._fastForwardButtonEnabled},set:function(n){this._fastForwardButtonEnabled=n?!0:!1;this._fastForwardButton.disabled=this._fastForwardButtonEnabled?!1:!0}},fullscreenButtonVisible:{get:function(){return this._fullscreenButtonVisible},set:function(n){this._fullscreenButtonVisible=n?!0:!1;this._fullscreenButtonVisible?ot.removeClass(this._toggleFullScreenButton,"win-mediaplayer-hidden"):ot.addClass(this._toggleFullScreenButton,"win-mediaplayer-hidden")}},fullscreenButtonEnabled:{get:function(){return this._fullscreenButtonEnabled},set:function(n){this._fullscreenButtonEnabled=n?!0:!1;this._toggleFullScreenButton.disabled=this._fullscreenButtonEnabled?!1:!0}},goToLiveButtonVisible:{get:function(){return this._goToLiveButtonVisible},set:function(n){this._goToLiveButtonVisible=n?!0:!1;this._goToLiveButtonVisible?ot.removeClass(this._goToLiveButton,"win-mediaplayer-hidden"):ot.addClass(this._goToLiveButton,"win-mediaplayer-hidden")}},goToLiveButtonEnabled:{get:function(){return this._goToLiveButtonEnabled},set:function(n){this._goToLiveButtonEnabled=n?!0:!1;this._goToLiveButton.disabled=this._goToLiveButtonEnabled?!1:!0}},nextTrackButtonVisible:{get:function(){return this._nextTrackButtonVisible},set:function(n){this._nextTrackButtonVisible=n?!0:!1;this._nextTrackButtonVisible?ot.removeClass(this._nextTrackButton,"win-mediaplayer-hidden"):ot.addClass(this._nextTrackButton,"win-mediaplayer-hidden")}},nextTrackButtonEnabled:{get:function(){return this._nextTrackButtonEnabled},set:function(n){this._nextTrackButtonEnabled=n?!0:!1;this._nextTrackButton.disabled=this._nextTrackButtonEnabled?!1:!0}},playFromBeginningButtonVisible:{get:function(){return this._playFromBeginningButtonVisible},set:function(n){this._playFromBeginningButtonVisible=n?!0:!1;this._playFromBeginningButtonVisible?ot.removeClass(this._playFromBeginningButton,"win-mediaplayer-hidden"):ot.addClass(this._playFromBeginningButton,"win-mediaplayer-hidden")}},playFromBeginningButtonEnabled:{get:function(){return this._playFromBeginningButtonEnabled},set:function(n){this._playFromBeginningButtonEnabled=n?!0:!1;this._playFromBeginningButton.disabled=this._playFromBeginningButtonEnabled?!1:!0}},playPauseButtonVisible:{get:function(){return this._playPauseButtonVisible},set:function(n){this._playPauseButtonVisible=n?!0:!1;this._playPauseButtonVisible?ot.removeClass(this._playPauseButton,"win-mediaplayer-hidden"):ot.addClass(this._playPauseButton,"win-mediaplayer-hidden")}},playPauseButtonEnabled:{get:function(){return this._playPauseButtonEnabled},set:function(n){this._playPauseButtonEnabled=n?!0:!1;this._playPauseButton.disabled=this._playPauseButtonEnabled?!1:!0}},playbackRateButtonVisible:{get:function(){return this._playbackRateButtonVisible},set:function(n){this._playbackRateButtonVisible=n?!0:!1;this._playbackRateButtonVisible?ot.removeClass(this._playbackRateButton,"win-mediaplayer-hidden"):ot.addClass(this._playbackRateButton,"win-mediaplayer-hidden")}},playbackRateButtonEnabled:{get:function(){return this._playbackRateButtonEnabled},set:function(n){this._playPauseButtonEnabled=n?!0:!1;this._playbackRateButton.disabled=this._playbackRateButtonEnabled?!1:!0}},previousTrackButtonVisible:{get:function(){return this._previousTrackButtonVisible},set:function(n){this._previousTrackButtonVisible=n?!0:!1;this._previousTrackButtonVisible?ot.removeClass(this._previousTrackButton,"win-mediaplayer-hidden"):ot.addClass(this._previousTrackButton,"win-mediaplayer-hidden")}},previousTrackButtonEnabled:{get:function(){return this._previousTrackButtonEnabled},set:function(n){this._previousTrackButtonEnabled=n?!0:!1;this._previousTrackButton.disabled=this._previousTrackButtonEnabled?!1:!0}},rewindButtonVisible:{get:function(){return this._rewindButtonVisible},set:function(n){this._rewindButtonVisible=n?!0:!1;this._rewindButtonVisible?ot.removeClass(this._rewindButton,"win-mediaplayer-hidden"):ot.addClass(this._rewindButton,"win-mediaplayer-hidden")}},rewindButtonEnabled:{get:function(){return this._rewindButtonEnabled},set:function(n){this._rewindButtonEnabled=n?!0:!1;this._rewindButton.disabled=this._rewindButtonEnabled?!1:!0}},seekBarVisible:{get:function(){return this._seekBarVisible},set:function(n){this._seekBarVisible=n?!0:!1;this._seekBarVisible?ot.removeClass(this._progressContainer,"win-mediaplayer-hidden"):ot.addClass(this._progressContainer,"win-mediaplayer-hidden")}},seekingEnabled:{get:function(){return this._mediaElementAdapter?this._mediaElementAdapter.seekAllowed:!1},set:function(n){this._mediaElementAdapter&&(this._mediaElementAdapter.seekAllowed=n?!0:!1)}},stopButtonVisible:{get:function(){return this._stopButtonVisible},set:function(n){this._stopButtonVisible=n?!0:!1;this._stopButtonVisible?ot.removeClass(this._stopButton,"win-mediaplayer-hidden"):ot.addClass(this._stopButton,"win-mediaplayer-hidden")}},stopButtonEnabled:{get:function(){return this._stopButtonEnabled},set:function(n){this._stopButtonEnabled=n?!0:!1;this._stopButton.disabled=this._stopButtonEnabled?!1:!0}},timeSkipBackButtonVisible:{get:function(){return this._timeSkipBackButtonVisible},set:function(n){this._timeSkipBackButtonVisible=n?!0:!1;this._timeSkipBackButtonVisible?ot.removeClass(this._timeSkipBackButton,"win-mediaplayer-hidden"):ot.addClass(this._timeSkipBackButton,"win-mediaplayer-hidden")}},timeSkipBackButtonEnabled:{get:function(){return this._timeSkipBackButtonEnabled},set:function(n){this._timeSkipBackButtonEnabled=n?!0:!1;this._timeSkipBackButton.disabled=this._timeSkipBackButtonEnabled?!1:!0}},timeSkipForwardButtonVisible:{get:function(){return this._timeSkipForwardButtonVisible},set:function(n){this._timeSkipForwardButtonVisible=n?!0:!1;this._timeSkipForwardButtonVisible?ot.removeClass(this._timeSkipForwardButton,"win-mediaplayer-hidden"):ot.addClass(this._timeSkipForwardButton,"win-mediaplayer-hidden")}},timeSkipForwardButtonEnabled:{get:function(){return this._timeSkipForwardButtonEnabled},set:function(n){this._timeSkipForwardButtonEnabled=n?!0:!1;this._timeSkipForwardButton.disabled=this._timeSkipForwardButtonEnabled?!1:!0}},volumeButtonVisible:{get:function(){return this._volumeButtonVisible},set:function(n){this._volumeButtonVisible=n?!0:!1;this._volumeButtonVisible?ot.removeClass(this._volumeButton,"win-mediaplayer-hidden"):ot.addClass(this._volumeButton,"win-mediaplayer-hidden")}},volumeButtonEnabled:{get:function(){return this._volumeButtonEnabled},set:function(n){this._volumeButtonEnabled=n?!0:!1;this._volumeButton.disabled=this._volumeButtonEnabled?!1:!0}},zoomButtonVisible:{get:function(){return this._zoomButtonVisible},set:function(n){this._zoomButtonVisible=n?!0:!1;this._zoomButtonVisible?ot.removeClass(this._zoomButton,"win-mediaplayer-hidden"):ot.addClass(this._zoomButton,"win-mediaplayer-hidden")}},zoomButtonEnabled:{get:function(){return this._zoomButtonEnabled},set:function(n){this._zoomButtonEnabled=n?!0:!1;this._zoomButton.disabled=this._zoomButtonEnabled?!1:!0}},addMarker:function(t,i,r,u){var o,e;if(s("WinJS.UI.MediaPlayer:addMarker,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){if(!t&&t!==0||isNaN(t))throw new f("WinJS.UI.MediaPlayer.timeNotANumber",n.mediaPlayerInvalidTimeValue);if(i||(i=ht.chapter),i!==ht.advertisement&&i!==ht.chapter&&i!==ht.custom)throw new f("WinJS.UI.MediaPlayer.InvalidMarkerType",n.mediaPlayerAddMarkerErrorInvalidMarkerType);for(i===ht.chapter?(u||(u="win-mediaplayer-chaptermarker"),this._defaultChapterMarkers.length&&this._clearDefaultChapterMarkers()):i===ht.advertisement&&(u||(u="win-mediaplayer-advertisementmarker"),this._defaultChapterMarkers.length&&this._clearDefaultChapterMarkers()),o=this._markers.length,e=0;e<o;e++)if(this._markers[e].time===t){this._markers.splice(e,1);break}this._markers.push({time:t,type:i,data:r,extraClass:u});(!this._mediaElementAdapter||!this._mediaElementAdapter.mediaElement||this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_METADATA)&&(this._doMarkersNeedResetting=!1);this._onMarkerCollectionChanged();s("WinJS.UI.MediaPlayer:addMarker,StopTM")}},chapterSkipBack:function(){var u,t;if(s("WinJS.UI.MediaPlayer:chapterSkipBack,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._exitFastForwardOrRewind(!0);var r=-1,f=this._mediaElementAdapter.mediaElement.currentTime,i=null;for(i=this._defaultChapterMarkers.length?this._defaultChapterMarkers:this._markers,u=i.length,t=u-1;t>=0;t--)if((i[t].type===ht.chapter||i[t].type===ht.advertisement)&&i[t].time+this._CHAPTER_SKIP_THRESHOLD<f){r=i[t].time;break}r!==-1?this._seekInternal(r,!1):this._seekInternal(this._startTime,!1);this._updateUIAndRaiseEvents(st.chapterSkipBack,n.chapterSkipBackMediaCommandDisplayText)}},chapterSkipForward:function(){var u,t;if(s("WinJS.UI.MediaPlayer:chapterSkipForward,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._exitFastForwardOrRewind(!0);var r=-1,f=this._mediaElementAdapter.mediaElement.currentTime,i=null;for(i=this._defaultChapterMarkers.length?this._defaultChapterMarkers:this._markers,u=i.length,t=0;t<u;t++)if((i[t].type===ht.chapter||i[t].type===ht.advertisement)&&i[t].time-this._CHAPTER_SKIP_THRESHOLD>f){r=i[t].time;break}r!==-1?this._seekInternal(r,!1):this._seekInternal(this._endTime,!1);this._updateUIAndRaiseEvents(st.chapterSkipForward,n.chapterSkipForwardMediaCommandDisplayText)}},dispose:function(){var u,f,r,e,n;if(s("WinJS.UI.MediaPlayer:dispose,StartTM"),!this._disposed){if(this._disposed=!0,this._controlsFadeInAnimation&&(this._controlsFadeInAnimation.cancel(),this._controlsFInAnimation=null),this._controlsFadeOutAnimation&&(this._controlsFadeOutAnimation.cancel(),this._controlsFadeOutAnimation=null),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.removeEventListener("seeked",this._handleSeekedAfterExitFastForwardOrRewindBind),this._handleSeekedAfterExitFastForwardOrRewindBind=null,t.window.removeEventListener("resize",this._windowResizeCallback),this._windowResizeCallback=null,ot.hasWinRT&&i.Windows.UI.WebUI.WebUIApplication.removeEventListener("resuming",this._checkPremiumVideoAndParentalControlsBind),at.removeEventListener("checkpoint",this._handleCheckpointCallback),this._contentRestrictions&&this._contentRestrictions.removeEventListener("restrictionschanged",this._checkParentalControlsBind),t.document.removeEventListener("visibilitychange",this._handleVisibilityChangedCallback),this._handleVisibilityChangedCallback=null,t.document.removeEventListener("keydown",this._keydownInputHandler),t.document.removeEventListener("keyup",this._keyupInputHandler),t.document.removeEventListener("keyup",this._controlsKeyupInputHandler),this._controlsKeyupInputHandler=null,this._timeline.removeEventListener("keydown",this._handleTimelineArrowKeyDownBind),this._handleTimelineArrowKeyDownBind=null,ot.hasWinRT&&i.Windows.Media.SystemMediaTransportControls,this._handleSystemTransportControlsButtonPressedBind=null,this._handleSystemTransportControlsPropertyChangedBind=null,this._smtControls=null,this._element&&(this._element.removeEventListener("keydown",this._keydownInputHandler),this._element.removeEventListener("keyup",this._keyupInputHandler),this._keydownInputHandler=null,this._keyupInputHandler=null,a&&a.removeEventListener&&a.removeEventListener("message",this._smartGlassInputHandler),this._smartGlassInputHandler=null),ct.removeEventListener("beforenavigate",this._handleBeforeNavigatedCallback),this._isXbox&&(t.WinJS.UI.Voice.removeEventListener("listeningstart",this._onShowControlsCommandInvokedBind),t.WinJS.UI.Voice.removeEventListener("listeningend",this._onHideControlsCommandInvokedBind),t.window.removeEventListener("gestureengaged",this._onShowControlsCommandInvokedBind),t.window.removeEventListener("gesturedisengaged",this._onHideControlsCommandInvokedBind),this._onShowControlsCommandInvokedBind=null,this._onHideControlsCommandInvokedBind=null),this._commandsOverflowFlyout&&this._commandsOverflowFlyout.removeEventListener("beforeshow",this._handleBeforeShowOverflowMenuBind),this._handleBeforeShowOverflowMenuBind=null,this._volumeFlyout&&this._volumeFlyout.removeEventListener("aftershow",this._handleVolumeFlyoutShowCallback),this._volumeSlider&&this._volumeSlider.removeEventListener("change",this._handleVolumeSliderChangeCallback),this._closedCaptionsFlyout&&t.document.body.removeChild(this._audioTracksFlyout.element),this._closedCaptionsFlyout&&t.document.body.removeChild(this._closedCaptionsFlyout.element),this._errorFlyout&&t.document.body.removeChild(this._errorFlyout),this._playbackRateFlyout&&t.document.body.removeChild(this._playbackRateFlyout),this._volumeFlyout&&t.document.body.removeChild(this._volumeFlyout.element),this._removeControlsTimer(),t.clearInterval(this._fastForwardOrRewindTimer),t.clearInterval(this._updateMediaStateTimerCookie),this._updateMediaStateTimerCookie=null,this._unsubscribeFromTimeUpdates(),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&this._unsubscribeFromMediaEvents(this._mediaElementAdapter.mediaElement),this._mediaEventSubscriptions=null,this._removeButtonEventHandlers(),this._buttonEventSubscriptions=null,this._removeGestureEventHandlers(),this._gestureEventSubscriptions=null,this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement&&(u=this._mediaElementAdapter.mediaElement,f=u.textTracks,f))for(r=u.getElementsByTagName("track"),e=r.length,n=0;n<e;n++)r[n].kind==="chapters"&&r[n].removeEventListener("load",this._loadTextTrackCallback);this._adjustedContentType=null;this._audioTracksButton=null;this._audioTracksFlyout=null;this._backButton.dispose();this._backButton=null;this._busyIndicator=null;this._castButton=null;this._chapterSkipBackButton=null;this._chapterSkipForwardButton=null;this._checkPremiumVideoPrivilegeBind=null;this._checkParentalControlsBind=null;this._checkPremiumVideoAndParentalControlsBind=null;this._closedCaptionsButton=null;this._closedCaptionsFlyout=null;this._commandsOverflowFlyout=null;this._contentRestrictions=null;this._controlHideTimeout=null;this._controls=null;this._controlsAddedHideDuration=null;this._currentScrubbingVelocity=null;this._currentTimeIndicator=null;this._currentTimeVisualElements=null;this._defaultChapterMarkers=[];this._defaultChapterMarkers=null;this._endTime=null;this._errorFlyout=null;this._errorText=null;this._fastForwardButton=null;this._fastForwardOrRewindTimer=null;this._fastForwardOrRewindTimerElapsedTime=null;this._gestureRecognizer=null;this._goToFullScreenButton=null;this._goToLiveButton=null;this._handleBeforeNavigatedCallback=null;this._handleCheckpointCallback=null;this._handleTransportBarButtonFocusBind=null;this._handleTransportBarButtonClick=null;this._handleTransportBarButtonFocus=null;this._handleTransportBarButtonKeyDown=null;this._handleTransportBarButtonKeyUp=null;this._inputHandlerElement=null;this._inputHandlerClickCallback=null;this._inputHandlerPointerDownCallback=null;this._inputHandlerPointerMoveCallback=null;this._inputHandlerPointerUpCallback=null;this._lastControlsResetTimeStamp=null;this._lastFastForwardOrRewindTimerTime=null;this._lastControlsResetTimeStamp=null;this._lastPointerPosition=null;this._lastPosition=null;this._layout=null;this._loadTextTrackCallback=null;this._markers=[];this._markers=null;this._mediaCommandFeedbackText=null;this._mediaElementAdapter&&this._mediaElementAdapter.dispose();this._mediaElementAdapter=null;this._mediaMetadata=null;this._mediaPlayerContainer=null;this._mediaPlayerHtml=null;this._mediaState=null;this._metadataTitle=null;this._metadataDescription=null;this._minimumSeekableRangeInPixels=null;this._muteButton=null;this._nextCustomMarkerIndex=null;this._nextCustomMarkerTime=null;this._previousCustomMarkerIndex=null;this._previousCustomMarkerTime=null;this._nextTrackButton=null;this._playbackRateButton=null;this._playbackRateFlyout=null;this._playbackSpeedIndicator=null;this._playPauseButton=null;this._playFromBeginningButton=null;this._pendingAdditionalCommands=null;this._previousPlaybackRate=null;this._previousTrackButton=null;this._previousVolumeValue=null;this._progress=null;this._progressContainer=null;this._updateMediaStateBind=null;this._relativeTimelineStartOffset=null;this._rewindButton=null;this._seekBar=null;this._seekMark=null;this._seekTimeIndicator=null;this._seekWindowLeftEdgeElement=null;this._seekWindowRightEdgeElement=null;this._skipAnimations=!1;this._startTime=null;this._startOffsetX=null;this._stopButton=null;this._smtControls=null;this._targetCurrentTime=null;this._targetPlaybackRate=null;this._thumbnailImage=null;this._thumbnailImageVisual=null;this._thumbElement=null;this._thumbElementWidthDividedByTwo=null;this._timeFormatter=null;this._thumbImageElementWidthDividedByTwo=null;this._timeBeforeShowingBusyVisual=null;this._timeRemainingIndicator=null;this._timeSeparator=null;this._timeSkipBackButton=null;this._timeSkipForwardButton=null;this._timeline=null;this._toggleFullScreenButton=null;this._toolbar=null;this._toolbarElement=null;this._totalSeekBarWidth=null;this._totalTimeIndicator=null;this._totalTimeInternal=null;this._transportControls=null;this._updateAudioTracksButtonStateBind=null;this._updateClosedCaptionsButtonStateBind=null;this._volumeButton=null;this._volumeFlyout&&this._volumeFlyout.dispose();this._volumeFlyout=null;this._volumeSlider=null;this._volumeValue=null;this._zoomButton=null;this._CHAPTER_SKIP_THRESHOLD=null;this._FAST_FORWARD_OR_REWIND_TIMER_INTERVAL=null;this._MINIMUM_ACCURATE_SEEKABLE_RANGE=null;this._MINIMUM_POINTER_DELTA_TO_ENABLE_SNAPPING_TO_NEAREST_MARKER=null;this._GESTURE_REGION_FOR_MOVING_THE_SEEKABLE_WINDOW=null;this._REPORT_MEDIA_STATE_INTERVAL=null;this._SNAP_TO_NEAREST_MARKER_THRESHOLD=null;this._CONTROLS_AUTO_HIDE_DURATION=null;this._MARKER_PROXIMITY_THRESHOLD=null;this._MINIMUM_MEDIA_LENGTH_FOR_DEFAULT_MARKERS=null;this._MOUSE_LEFT_BUTTON=null;this._MOUSE_POINTER_TYPE=null;this._SEEK_OFFSET=null;this._SKIP_BACK_INTERVAL=null;this._SKIP_FORWARD_INTERVAL=null;this._MEDIA_READY_STATE_HAVE_NOTHING=null;this._MEDIA_READY_STATE_HAVE_METADATA=null;this._MEDIA_READY_STATE_HAVE_CURRENT_DATA=null;this._MEDIA_READY_STATE_HAVE_FUTURE_DATA=null;this._MEDIA_READY_STATE_HAVE_ENOUGH_DATA=null;this._PLAYBACKRATE_FAST_FORWARD_MAX_RATE=null;this._PLAYBACKRATE_FAST_FORWARD_128X=null;this._PLAYBACKRATE_FAST_FORWARD_64X=null;this._PLAYBACKRATE_FAST_FORWARD_32X=null;this._PLAYBACKRATE_FAST_FORWARD_16X=null;this._PLAYBACKRATE_FAST_FORWARD_8X=null;this._PLAYBACKRATE_FAST_FORWARD_4X=null;this._PLAYBACKRATE_FAST_FORWARD_2X=null;this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE=null;this._PLAYBACKRATE_PLAYING=null;this._PLAYBACKRATE_NOT_PLAYING=null;this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE=null;this._PLAYBACKRATE_REWIND_2X=null;this._PLAYBACKRATE_REWIND_4X=null;this._PLAYBACKRATE_REWIND_8X=null;this._PLAYBACKRATE_REWIND_16X=null;this._PLAYBACKRATE_REWIND_32X=null;this._PLAYBACKRATE_REWIND_64X=null;this._PLAYBACKRATE_REWIND_128X=null;this._PLAYBACKRATE_REWIND_MAX_RATE=null;this._TAG_NAME_AUDIO=null;this._TAG_NAME_VIDEO=null;b.disposeSubTree(this._element);this._element.winControl=null;this._element=null;s("WinJS.UI.MediaPlayer:dispose,StopTM")}},fastForward:function(){var t,n,i;if(s("WinJS.UI.MediaPlayer:fastForward,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){if(this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_FUTURE_DATA)return;this._controlsVisible||this._showControls();t=null;this._isInFastForwardOrRewindMode||(this._targetPlaybackRate=this._mediaElementAdapter.mediaElement.playbackRate,this._targetCurrentTime=this._mediaElementAdapter.mediaElement.currentTime);n=null;n=this._isThumbnailEnabled?this._targetPlaybackRate:this._mediaElementAdapter.mediaElement.playbackRate;!this._isInFastForwardOrRewindMode&&this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_REWIND_2X?t=this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE:this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE?t=this._PLAYBACKRATE_PLAYING:!this._isInFastForwardOrRewindMode&&this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_PLAYING?t=this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE:this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE?t=this._PLAYBACKRATE_FAST_FORWARD_2X:n<this._PLAYBACKRATE_FAST_FORWARD_MAX_RATE&&n>=this._PLAYBACKRATE_FAST_FORWARD_2X?t=Math.min(Math.floor(n)*2,this._PLAYBACKRATE_FAST_FORWARD_MAX_RATE):n<this._PLAYBACKRATE_FAST_FORWARD_2X&&n>=this._PLAYBACKRATE_PLAYING?t=this._PLAYBACKRATE_FAST_FORWARD_2X:n<this._PLAYBACKRATE_PLAYING&&n>=this._PLAYBACKRATE_REWIND_2X?t=this._PLAYBACKRATE_PLAYING:n<this._PLAYBACKRATE_REWIND_2X&&n>=this._PLAYBACKRATE_REWIND_MAX_RATE&&(t=Math.floor(n)/2);t&&(this._isThumbnailEnabled?this._isFastForwardOrRewind(t)?(i=n,this._targetPlaybackRate=t,this._updateFastForwardAndRewindState(i,t)):this._exitFastForwardOrRewind(!0):(this._mediaElementAdapter.mediaElement.paused&&t!==this._PLAYBACKRATE_PLAYING&&this._mediaElementAdapter.play(),this._mediaElementAdapter.mediaElement.playbackRate=t));this._setFastForwardOrRewindText()}},goToLive:function(){s("WinJS.UI.MediaPlayer:goToLive,StartTM");this._mediaElementAdapter&&(this._exitFastForwardOrRewind(!0),this._seekInternal(this._mediaElementAdapter.liveTime,!1),this._updateUIAndRaiseEvents(st.goToLive,n.goToLiveMediaCommandDisplayText))},hideControls:function(){this._hideControls()},nextTrack:function(){s("WinJS.UI.MediaPlayer:nextTrack,StartTM");this._mediaElementAdapter&&this._mediaElementAdapter.nextTrack&&(this._exitFastForwardOrRewind(!0),this._mediaElementAdapter.nextTrack(),this._updateUIAndRaiseEvents(st.nextTrack,n.nextTrackMediaCommandDisplayText))},pause:function(){s("WinJS.UI.MediaPlayer:pause,StartTM");this._mediaElementAdapter&&this._mediaElementAdapter.pause&&(this._isThumbnailEnabled&&!this._isFastForwardOrRewind?this._exitFastForwardOrRewind(!1):this._mediaElementAdapter.pause(),this._updateUIAndRaiseEvents(st.pause,n.pauseMediaCommandDisplayText))},play:function(){s("WinJS.UI.MediaPlayer:play,StartTM");this._mediaElementAdapter&&this._mediaElementAdapter.play&&(this._isThumbnailEnabled&&this._isInFastForwardOrRewindMode?this._exitFastForwardOrRewind(!0):this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.ended||this._endTimeReached?this._playFromBeginning():this._mediaElementAdapter.play(),this._updateUIAndRaiseEvents(st.play,n.playMediaCommandDisplayText))},previousTrack:function(){s("WinJS.UI.MediaPlayer:previousTrack,StartTM");this._mediaElementAdapter&&this._mediaElementAdapter.previousTrack&&(this._mediaElementAdapter.previousTrack(),this._exitFastForwardOrRewind(!0),this._updateUIAndRaiseEvents(st.previousTrack,n.previousTrackMediaCommandDisplayText))},removeMarker:function(n){var i,t;for(s("WinJS.UI.MediaPlayer:removeMarker,StartTM"),i=this._markers.length,t=0;t<i;t++)if(this._markers[t].time===n){this._markers.splice(t,1);break}i=this._markers.length;this._nextCustomMarkerTime===n&&(this._nextCustomMarkerIndex<i-1&&this._markers[this._nextCustomMarkerIndex]?(this._nextCustomMarkerIndex++,this._nextCustomMarkerTime=this._markers[this._nextCustomMarkerIndex].time):(this._nextCustomMarkerIndex=-1,this._nextCustomMarkerTime=-1));this._previousCustomMarkerTime===n&&(this._previousCustomMarkerIndex>0&&this._markers[this._previousCustomMarkerTime]?(this._previousCustomMarkerIndex--,this._previousCustomMarkerTime=this._markers[this._previousCustomMarkerTime].time):(this._previousCustomMarkerIndex=-1,this._previousCustomMarkerTime=-1));this._markers.length===0&&(this._hasCustomMarkers=!1,this._unsubscribeFromTimeUpdates());this._isChapterMarkerVisualsDirty=!0;this._updateChapterMarkerVisuals();s("WinJS.UI.MediaPlayer:removeMarker,StopTM")},rewind:function(){var t,n,i;if(s("WinJS.UI.MediaPlayer:rewind,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){if(this._mediaElementAdapter.mediaElement.readyState<this._MEDIA_READY_STATE_HAVE_FUTURE_DATA)return;this._controlsVisible||this._showControls();t=null;this._isInFastForwardOrRewindMode||(this._targetPlaybackRate=this._mediaElementAdapter.mediaElement.playbackRate,this._targetCurrentTime=this._mediaElementAdapter.mediaElement.currentTime);n=this._PLAYBACKRATE_NOT_PLAYING;n=this._isThumbnailEnabled?this._targetPlaybackRate:this._mediaElementAdapter.mediaElement.playbackRate;!this._isInFastForwardOrRewindMode&&this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_FAST_FORWARD_2X?t=this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE:this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_FAST_FORWARD_SLOW_MOTION_RATE?t=this._PLAYBACKRATE_PLAYING:!this._isInFastForwardOrRewindMode&&this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_PLAYING?t=this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE:this._mediaElementAdapter.mediaElement.paused&&n===this._PLAYBACKRATE_REWIND_SLOW_MOTION_RATE?t=this._PLAYBACKRATE_REWIND_2X:n>this._PLAYBACKRATE_REWIND_MAX_RATE&&n<=this._PLAYBACKRATE_REWIND_2X?t=Math.max(Math.floor(n)*2,this._PLAYBACKRATE_REWIND_MAX_RATE):n>this._PLAYBACKRATE_REWIND_2X&&n<=this._PLAYBACKRATE_PLAYING?t=this._PLAYBACKRATE_REWIND_2X:n>this._PLAYBACKRATE_PLAYING&&n<=this._PLAYBACKRATE_FAST_FORWARD_2X?t=this._PLAYBACKRATE_PLAYING:n>this._PLAYBACKRATE_FAST_FORWARD_2X&&n<=this._PLAYBACKRATE_FAST_FORWARD_MAX_RATE&&(t=Math.floor(n)/2);t&&(this._isThumbnailEnabled?this._isFastForwardOrRewind(t)?(i=n,this._targetPlaybackRate=t,this._updateFastForwardAndRewindState(i,t)):this._exitFastForwardOrRewind(!0):(this._mediaElementAdapter.mediaElement.paused&&t!==this._PLAYBACKRATE_PLAYING&&this._mediaElementAdapter.play(),this._mediaElementAdapter.mediaElement.playbackRate=t));this._setFastForwardOrRewindText()}},seek:function(n){s("WinJS.UI.MediaPlayer:seek,StartTM");this._seekInternal(n,!0)},setContentMetadata:function(t,r){var u;if(s("WinJS.UI.MediaPlayer:setContentMetadata,StartTM"),!t)throw new f("WinJS.UI.MediaPlayer.nullContentType",n.mediaPlayerNullContentType);if(!r)throw new f("WinJS.UI.MediaPlayer.nullMetadata",n.mediaPlayerNullMetadata);this._mediaMetadata=r;this._mediaMetadata.contentType=t;this._metadataTitle.textContent=this._mediaMetadata.title||"";this._metadataDescription.textContent=this._mediaMetadata.description||"";this._smtControls&&(u=this._smtControls.displayUpdater,u.type=this._mediaElementAdapter.mediaElement&&this._mediaElementAdapter.mediaElement.tagName===this._TAG_NAME_AUDIO?i.Windows.Media.MediaPlaybackType.audio:i.Windows.Media.MediaPlaybackType.video,u.appMediaId=this._mediaMetadata.contentId,u.type===i.Windows.Media.MediaPlaybackType.video&&(u.videoProperties.title=this._mediaMetadata.title),u.update());var c=this,e=!1,o=!1;return s("WinJS.UI.MediaPlayer:setContentMetadata,StopTM"),new h(function(n,t){var i=c._checkPremiumVideoPrivilege().then(function(n){e=n?!0:!1}),r=c._checkParentalControls().then(function(n){o=n?!0:!1});h.join([i,r]).then(function(){if(e&&o)n();else{t();return}},function(){t();return})})},showControls:function(){this._showControls(!1)},stop:function(){this._mediaElementAdapter&&this._mediaElementAdapter.stop&&(this._mediaElementAdapter.stop(),this._updateUIAndRaiseEvents(st.stop,n.stopMediaCommandDisplayText))},timeSkipBack:function(){if(s("WinJS.UI.MediaPlayer:timeSkipBack,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._exitFastForwardOrRewind(!0);var t=this._mediaElementAdapter.mediaElement.currentTime-this._SKIP_BACK_INTERVAL;t<this._startTime&&(t=this._startTime);this._seekInternal(t,!1);this._updateUIAndRaiseEvents(st.timeSkipBack,n.timeSkipBackMediaCommandDisplayText)}},timeSkipForward:function(){if(s("WinJS.UI.MediaPlayer:timeSkipForward,StartTM"),this._mediaElementAdapter&&this._mediaElementAdapter.mediaElement){this._exitFastForwardOrRewind(!0);var t=this._mediaElementAdapter.mediaElement.currentTime+this._SKIP_FORWARD_INTERVAL;t>this._endTime&&(t=this._endTime);this._seekInternal(t,!1);this._updateUIAndRaiseEvents(st.timeSkipForward,n.timeSkipForwardMediaCommandDisplayText)}}},{_sounds:{initialized:!1,elementFocus1:null,elementFocus2:null,elementFocus3:null,elementFocus4:null,selectButtonClick:null,overlayIn:null,overlayOut:null}}),r.Class.mix(y,u.createEventProperties("beforeshowcontrols","aftershowcontrols","beforehidecontrols","afterhidecontrols","markerreached","mediacommandexecuted","targetratechange","targettimeupdate","thumbnailrequest")),r.Class.mix(y,k.DOMEventMixin),y})})}),t("WinJS/Controls/Menu",["exports","../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Resources","../Core/_WriteProfilerMark","../Promise","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Utilities/_KeyboardBehavior","./_LegacyAppBar/_Constants","./Flyout","./Flyout/_Overlay","./Menu/_Command"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{Menu:i.Namespace._lazy(function(){function w(n){var t=n.element||n;return s._matchesSelector(t,"."+l.menuClass+" ."+l.menuCommandClass)}var n=s.Key,h={get ariaLabel(){return f._getWinJSString("ui/menuAriaLabel").value},get requiresCommands(){return"Invalid argument: commands must not be empty"},get nullCommand(){return"Invalid argument: command must not be null"}},p=i.Class.derive(a.Flyout,function(n,i){i=i||{};this._element=n||t.document.createElement("div");this._id=this._element.id||s._uniqueID(this._element);this._writeProfilerMark("constructor,StartTM");!i.commands&&this._element&&(i=r._shallowCopy(i),i.commands=this._verifyCommandsOnly(this._element,"WinJS.UI.MenuCommand"));var u=this._element?this._element.getAttribute("role"):null,f=this._element?this._element.getAttribute("aria-label"):null;this._baseFlyoutConstructor(this._element,i);(u===null||u===""||u===undefined)&&this._element.setAttribute("role","menu");(f===null||f===""||f===undefined)&&this._element.setAttribute("aria-label",h.ariaLabel);this._element.addEventListener("keydown",this._handleKeyDown.bind(this),!0);this._element.addEventListener(l._menuCommandInvokedEvent,this._handleCommandInvoked.bind(this),!1);this._element.addEventListener("mouseover",this._handleMouseOver.bind(this),!1);this._element.addEventListener("mouseout",this._handleMouseOut.bind(this),!1);s.addClass(this._element,l.menuClass);this._winKeyboard=new c._WinKeyboard(this._element);this.hide();this._writeProfilerMark("constructor,StopTM")},{commands:{set:function(n){var i,t;if(!this.hidden)throw new u("WinJS.UI.Menu.CannotChangeCommandsWhenVisible",f._formatString(v._Overlay.commonstrings.cannotChangeCommandsWhenVisible,"Menu"));for(s.empty(this._element),Array.isArray(n)||(n=[n]),i=n.length,t=0;t<i;t++)this._addCommand(n[t])}},getCommandById:function(n){for(var r=this.element.querySelectorAll("#"+n),t=[],i=0,u=r.length;i<u;i++)r[i].winControl&&t.push(r[i].winControl);return t.length===1?t[0]:t.length===0?null:t},showCommands:function(n){if(!n)throw new u("WinJS.UI.Menu.RequiresCommands",h.requiresCommands);this._showCommands(n,!0)},hideCommands:function(n){if(!n)throw new u("WinJS.UI.Menu.RequiresCommands",h.requiresCommands);this._hideCommands(n,!0)},showOnlyCommands:function(n){if(!n)throw new u("WinJS.UI.Menu.RequiresCommands",h.requiresCommands);this._showOnlyCommands(n,!0)},show:function(n,t,i){this._writeProfilerMark("show,StartTM");this._show(n,t,i)},_show:function(n,t,i){s.hasClass(this.element,l.menuMouseSpacingClass)||s.hasClass(this.element,l.menuTouchSpacingClass)||s.addClass(this.element,a.Flyout._cascadeManager.inputType===c._InputTypes.mouse||a.Flyout._cascadeManager.inputType===c._InputTypes.keyboard?l.menuMouseSpacingClass:l.menuTouchSpacingClass);this._baseFlyoutShow(n,t,i)},_hide:function(){this._hoverPromise&&this._hoverPromise.cancel();a.Flyout.prototype._hide.call(this)},_beforeEndHide:function(){s.removeClass(this.element,l.menuMouseSpacingClass);s.removeClass(this.element,l.menuTouchSpacingClass);a.Flyout.prototype._beforeEndHide.call(this)},_addCommand:function(n){if(!n)throw new u("WinJS.UI.Menu.NullCommand",h.nullCommand);n._element||(n=new y.MenuCommand(null,n));n._element.parentElement&&n._element.parentElement.removeChild(n._element);this._element.appendChild(n._element)},_dispose:function(){this._hoverPromise&&this._hoverPromise.cancel();a.Flyout.prototype._dispose.call(this)},_commandsUpdated:function(){this.hidden||this._checkMenuCommands()},_checkMenuCommands:function(){var i=this._element.querySelectorAll(".win-command"),r=!1,u=!1,t,f,n;if(i)for(t=0,f=i.length;t<f;t++)n=i[t].winControl,n&&!n.hidden&&(r||n.type!==l.typeToggle||(r=!0),u||n.type!==l.typeFlyout||(u=!0));s[r?"addClass":"removeClass"](this._element,l.menuContainsToggleCommandClass);s[u?"addClass":"removeClass"](this._element,l.menuContainsFlyoutCommandClass)},_handleKeyDown:function(i){i.keyCode===n.upArrow?(p._focusOnPreviousElement(this.element),i.preventDefault()):i.keyCode===n.downArrow?(p._focusOnNextElement(this.element),i.preventDefault()):(i.keyCode===n.space||i.keyCode===n.enter)&&this.element===t.document.activeElement?(i.preventDefault(),this.hide()):i.keyCode===n.tab&&i.preventDefault()},_handleFocusIn:function(n){var t=n.target,i,r;w(t)?(i=t.winControl,s.hasClass(i.element,l.menuCommandFlyoutActivatedClass)?i.flyout.element.focus():(r=this.element.querySelector("."+l.menuCommandFlyoutActivatedClass),r&&y.MenuCommand._deactivateFlyoutCommand(r))):t===this.element&&a.Flyout.prototype._handleFocusIn.call(this,n)},_handleCommandInvoked:function(n){this._hoverPromise&&this._hoverPromise.cancel();var t=n.detail.command;t._type!==l.typeFlyout&&t._type!==l.typeSeparator&&this._lightDismiss()},_hoverPromise:null,_handleMouseOver:function(n){var t=n.target,i,r;w(t)&&(i=t.winControl,r=this,t.focus&&(t.focus(),s.removeClass(t,"win-keyboard"),i.type===l.typeFlyout&&i.flyout&&i.flyout.hidden&&(this._hoverPromise=this._hoverPromise||o.timeout(l.menuCommandHoverDelay).then(function(){r.hidden||r._disposed||i._invoke(n);r._hoverPromise=null},function(){r._hoverPromise=null}))))},_handleMouseOut:function(n){var i=n.target;w(i)&&!i.contains(n.relatedTarget)&&(i===t.document.activeElement&&this.element.focus(),this._hoverPromise&&this._hoverPromise.cancel())},_writeProfilerMark:function(n){e("WinJS.UI.Menu:"+this._id+":"+n)}});return p._focusOnNextElement=function(n){var i=t.document.activeElement;do i=i===n?i.firstElementChild:i.nextElementSibling,i?i.focus():i=n;while(i!==t.document.activeElement)},p._focusOnPreviousElement=function(n){var i=t.document.activeElement;do i=i===n?i.lastElementChild:i.previousElementSibling,i?i.focus():i=n;while(i!==t.document.activeElement)},p})})}),t("WinJS/Controls/AutoSuggestBox/_SearchSuggestionManagerShim",["exports","../../_Signal","../../Core/_Base","../../Core/_BaseUtils","../../Core/_Events","../../BindingList",],function(n,t,i,r,u){"use strict";var e={reset:0,itemInserted:1,itemRemoved:2,itemChanged:3},f={Query:0,Result:1,Separator:2},o=i.Class.derive(Array,function(){},{reset:function(){this.length=0;this.dispatchEvent("vectorchanged",{collectionChange:e.reset,index:0})},insert:function(n,t){this.splice(n,0,t);this.dispatchEvent("vectorchanged",{collectionChange:e.itemInserted,index:n})},remove:function(n){this.splice(n,1);this.dispatchEvent("vectorchanged",{collectionChange:e.itemRemoved,index:n})}});i.Class.mix(o,u.eventMixin);var h=i.Class.define(function(){this._data=[]},{size:{get:function(){return this._data.length}},appendQuerySuggestion:function(n){this._data.push({kind:f.Query,text:n})},appendQuerySuggestions:function(n){n.forEach(this.appendQuerySuggestion.bind(this))},appendResultSuggestion:function(n,t,i,r,u){this._data.push({kind:f.Result,text:n,detailText:t,tag:i,imageUrl:r,imageAlternateText:u,image:null})},appendSearchSeparator:function(n){this._data.push({kind:f.Separator,text:n})}}),c=i.Class.define(function(n,t,i){this._queryText=n;this._language=t;this._linguisticDetails=i;this._searchSuggestionCollection=new h},{language:{get:function(){return this._language}},linguisticDetails:{get:function(){return this._linguisticDetails}},queryText:{get:function(){return this._queryText}},searchSuggestionCollection:{get:function(){return this._searchSuggestionCollection}},getDeferral:function(){return this._deferralSignal||(this._deferralSignal=new t)},_deferralSignal:null}),s=i.Class.define(function(){this._updateVector=this._updateVector.bind(this);this._suggestionVector=new o;this._query="";this._history={"":[]};this._dataSource=[];this.searchHistoryContext="";this.searchHistoryEnabled=!0},{addToHistory:function(n){var t,r,i,u,e;if(n&&n.trim()){for(t=this._history[this.searchHistoryContext],r=-1,i=0,u=t.length;i<u;i++)if(e=t[i],e.text.toLowerCase()===n.toLowerCase()){r=i;break}r>=0&&t.splice(r,1);t.splice(0,0,{text:n,kind:f.Query});this._updateVector()}},clearHistory:function(){this._history[this.searchHistoryContext]=[];this._updateVector()},setLocalContentSuggestionSettings:function(){},setQuery:function(n){function r(n){i._dataSource=n;i._updateVector()}var i=this,t;this._query=n;t=new c(n);this.dispatchEvent("suggestionsrequested",{request:t});t._deferralSignal?t._deferralSignal.promise.then(r.bind(this,t.searchSuggestionCollection._data)):r(t.searchSuggestionCollection._data)},searchHistoryContext:{get:function(){return""+this._searchHistoryContext},set:function(n){n=""+n;this._history[n]||(this._history[n]=[]);this._searchHistoryContext=n}},searchHistoryEnabled:{get:function(){return this._searchHistoryEnabled},set:function(n){this._searchHistoryEnabled=n}},suggestions:{get:function(){return this._suggestionVector}},_updateVector:function(){var n,t,i;for(this.suggestions.insert(this.suggestions.length,{text:"",kind:f.Query});this.suggestions.length>1;)this.suggestions.remove(0);n=0;t={};this.searchHistoryEnabled&&(i=this._query.toLowerCase(),this._history[this.searchHistoryContext].forEach(function(r){var u=r.text.toLowerCase();u.indexOf(i)===0&&(this.suggestions.insert(n,r),t[u]=!0,n++)},this));this._dataSource.forEach(function(i){i.kind===f.Query?t[i.text.toLowerCase()]||(this.suggestions.insert(n,i),n++):(this.suggestions.insert(n,i),n++)},this);this.suggestions.remove(this.suggestions.length-1)}});i.Class.mix(s,u.eventMixin);i.Namespace._moduleDefine(n,null,{_CollectionChange:e,_SearchSuggestionKind:f,_SearchSuggestionManagerShim:s})}),t("require-style!less/styles-autosuggestbox",[],function(){}),t("require-style!less/colors-autosuggestbox",[],function(){}),t("WinJS/Controls/AutoSuggestBox",["exports","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementListUtilities","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Animations","../BindingList","../Promise","./Repeater","./AutoSuggestBox/_SearchSuggestionManagerShim","require-style!less/styles-autosuggestbox","require-style!less/colors-autosuggestbox"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";var w={asb:"win-autosuggestbox",asbDisabled:"win-autosuggestbox-disabled",asbFlyout:"win-autosuggestbox-flyout",asbFlyoutAbove:"win-autosuggestbox-flyout-above",asbBoxFlyoutHighlightText:"win-autosuggestbox-flyout-highlighttext",asbHitHighlightSpan:"win-autosuggestbox-hithighlight-span",asbInput:"win-autosuggestbox-input",asbInputFocus:"win-autosuggestbox-input-focus",asbSuggestionQuery:"win-autosuggestbox-suggestion-query",asbSuggestionResult:"win-autosuggestbox-suggestion-result",asbSuggestionResultText:"win-autosuggestbox-suggestion-result-text",asbSuggestionResultDetailedText:"win-autosuggestbox-suggestion-result-detailed-text",asbSuggestionSelected:"win-autosuggestbox-suggestion-selected",asbSuggestionSeparator:"win-autosuggestbox-suggestion-separator"};r.Namespace._moduleDefine(n,"WinJS.UI",{AutoSuggestBox:r.Namespace._lazy(function(){function k(n,i,r,u){function a(n,i,r){var u=t.document.createElement("span");return u.textContent=i,u.setAttribute("aria-hidden","true"),u.classList.add(w.asbHitHighlightSpan),n.insertBefore(u,r),u}var o,c,v,f,l,e,y;if(r){for(s.query("."+w.asbHitHighlightSpan,n).forEach(function(n){n.parentNode.removeChild(n)}),o=n.firstChild,c=i.hits,!c&&u&&i.kind!==p._SearchSuggestionKind.Separator&&(c=u.find(r)),v=d._sortAndMergeHits(c),f=0,l=0;l<v.length;l++)e=v[l],a(n,r.substring(f,e.startPosition),o),f=e.startPosition+e.length,y=a(n,r.substring(e.startPosition,f),o),h.addClass(y,w.asbBoxFlyoutHighlightText);f<r.length&&a(n,r.substring(f),o)}}function g(n){var i={ctrlKey:1,altKey:2,shiftKey:4},t=0;return n.ctrlKey&&(t|=i.ctrlKey),n.altKey&&(t|=i.altKey),n.shiftKey&&(t|=i.shiftKey),t}function nt(n,i){function c(t){n._internalFocusMove=!0;n._inputElement.focus();n._processSuggestionChosen(i,t)}var r=t.document.createElement("div"),f=new t.Image,s,u,a,o,v;return f.style.opacity=0,s=function(n){function t(){f.removeEventListener("load",t,!1);l.fadeIn(f)}f.addEventListener("load",t,!1);f.src=n},i.image!==null?i.image.openReadAsync().then(function(n){n!==null&&s(t.URL.createObjectURL(n,{oneTimeOnly:!0}))}):i.imageUrl!==null&&s(i.imageUrl),f.setAttribute("aria-hidden","true"),r.appendChild(f),u=t.document.createElement("div"),h.addClass(u,w.asbSuggestionResultText),k(u,i,i.text),u.title=i.text,u.setAttribute("aria-hidden","true"),r.appendChild(u),a=t.document.createElement("br"),u.appendChild(a),o=t.document.createElement("span"),h.addClass(o,w.asbSuggestionResultDetailedText),k(o,i,i.detailText),o.title=i.detailText,o.setAttribute("aria-hidden","true"),u.appendChild(o),h.addClass(r,w.asbSuggestionResult),h._addEventListener(r,"click",function(t){n._isFlyoutPointerDown||c(t)}),h._addEventListener(r,"pointerup",c),r.setAttribute("role","option"),v=e._formatString(b.ariaLabelResult,i.text,i.detailText),r.setAttribute("aria-label",v),r}function tt(n,i){function u(t){n._internalFocusMove=!0;n._inputElement.focus();n._processSuggestionChosen(i,t)}var r=t.document.createElement("div"),f;return k(r,i,i.text),r.title=i.text,r.classList.add(w.asbSuggestionQuery),h._addEventListener(r,"click",function(t){n._isFlyoutPointerDown||u(t)}),h._addEventListener(r,"pointerup",u),f=e._formatString(b.ariaLabelQuery,i.text),r.setAttribute("role","option"),r.setAttribute("aria-label",f),r}function it(n){var i=t.document.createElement("div"),r,u;return n.text.length>0&&(r=t.document.createElement("div"),r.textContent=n.text,r.title=n.text,r.setAttribute("aria-hidden","true"),i.appendChild(r)),i.insertAdjacentHTML("beforeend","<hr/>"),h.addClass(i,w.asbSuggestionSeparator),i.setAttribute("role","separator"),u=e._formatString(b.ariaLabelSeparator,n.text),i.setAttribute("aria-label",u),i}var n=h.Key,c={querychanged:"querychanged",querysubmitted:"querysubmitted",resultsuggestionchosen:"resultsuggestionchosen",suggestionsrequested:"suggestionsrequested"},b={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get invalidSuggestionKind(){return"Error: Invalid suggestion kind."},get ariaLabel(){return e._getWinJSString("ui/autoSuggestBoxAriaLabel").value},get ariaLabelInputNoPlaceHolder(){return e._getWinJSString("ui/autoSuggestBoxAriaLabelInputNoPlaceHolder").value},get ariaLabelInputPlaceHolder(){return e._getWinJSString("ui/autoSuggestBoxAriaLabelInputPlaceHolder").value},get ariaLabelQuery(){return e._getWinJSString("ui/autoSuggestBoxAriaLabelQuery").value},get ariaLabelResult(){return e._getWinJSString("ui/autoSuggestBoxAriaLabelResult").value},get ariaLabelSeparator(){return e._getWinJSString("ui/autoSuggestBoxAriaLabelSeparator").value}},d=r.Class.define(function(n,i){if(n=n||t.document.createElement("div"),i=i||{},n.winControl)throw new u("WinJS.UI.AutoSuggestBox.DuplicateConstruction",b.duplicateConstruction);this._suggestionsChangedHandler=this._suggestionsChangedHandler.bind(this);this._suggestionsRequestedHandler=this._suggestionsRequestedHandler.bind(this);this._element=n;n.winControl=this;n.classList.add(w.asb);n.classList.add("win-disposable");this._setupDOM();this._setupSSM();this._chooseSuggestionOnEnter=!1;this._currentFocusedIndex=-1;this._currentSelectedIndex=-1;this._flyoutOpenPromise=v.wrap();this._lastKeyPressLanguage="";this._prevLinguisticDetails=this._getLinguisticDetails();this._prevQueryText="";o.setOptions(this,i);this._hideFlyout()},{onresultsuggestionchosen:f._createEventProperty(c.resultsuggestionchosen),onquerychanged:f._createEventProperty(c.querychanged),onquerysubmitted:f._createEventProperty(c.querysubmitted),onsuggestionsrequested:f._createEventProperty(c.suggestionsrequested),element:{get:function(){return this._element}},chooseSuggestionOnEnter:{get:function(){return this._chooseSuggestionOnEnter},set:function(n){this._chooseSuggestionOnEnter=!!n}},disabled:{get:function(){return this._inputElement.disabled},set:function(n){this._inputElement.disabled!==!!n&&(n?this._disableControl():this._enableControl())}},placeholderText:{get:function(){return this._inputElement.placeholder},set:function(n){this._inputElement.placeholder=n;this._updateInputElementAriaLabel()}},queryText:{get:function(){return this._inputElement.value},set:function(n){this._inputElement.value="";this._inputElement.value=n}},searchHistoryDisabled:{get:function(){return!this._suggestionManager.searchHistoryEnabled},set:function(n){this._suggestionManager.searchHistoryEnabled=!n}},searchHistoryContext:{get:function(){return this._suggestionManager.searchHistoryContext},set:function(n){this._suggestionManager.searchHistoryContext=n}},dispose:function(){this._disposed||(this._flyoutOpenPromise.cancel(),this._suggestions.removeEventListener("vectorchanged",this._suggestionsChangedHandler),this._suggestionManager.removeEventListener("suggestionsrequested",this._suggestionsRequestedHandler),this._suggestionManager=null,this._suggestions=null,this._hitFinder=null,this._disposed=!0)},setLocalContentSuggestionSettings:function(n){this._suggestionManager.setLocalContentSuggestionSettings(n)},_setupDOM:function(){function f(n){return u._renderSuggestion(n)}var r=this._flyoutPointerReleasedHandler.bind(this),n=this._inputOrImeChangeHandler.bind(this),i,u;this._element.getAttribute("aria-label")||this._element.setAttribute("aria-label",b.ariaLabel);this._element.setAttribute("role","group");this._inputElement=t.document.createElement("input");this._inputElement.autocorrect="off";this._inputElement.type="search";this._inputElement.classList.add(w.asbInput);this._inputElement.setAttribute("role","textbox");this._inputElement.addEventListener("keydown",this._keyDownHandler.bind(this));this._inputElement.addEventListener("keypress",this._keyPressHandler.bind(this));this._inputElement.addEventListener("keyup",this._keyUpHandler.bind(this));this._inputElement.addEventListener("focus",this._inputFocusHandler.bind(this));this._inputElement.addEventListener("blur",this._inputBlurHandler.bind(this));this._inputElement.addEventListener("input",n);this._inputElement.addEventListener("compositionstart",n);this._inputElement.addEventListener("compositionupdate",n);this._inputElement.addEventListener("compositionend",n);h._addEventListener(this._inputElement,"pointerdown",this._inputPointerDownHandler.bind(this));this._updateInputElementAriaLabel();this._element.appendChild(this._inputElement);i=this._tryGetInputContext();i&&(i.addEventListener("MSCandidateWindowShow",this._msCandidateWindowShowHandler.bind(this)),i.addEventListener("MSCandidateWindowHide",this._msCandidateWindowHideHandler.bind(this)));this._flyoutElement=t.document.createElement("div");this._flyoutElement.classList.add(w.asbFlyout);this._flyoutElement.addEventListener("blur",this._flyoutBlurHandler.bind(this));h._addEventListener(this._flyoutElement,"pointerup",r);h._addEventListener(this._flyoutElement,"pointercancel",r);h._addEventListener(this._flyoutElement,"pointerout",r);h._addEventListener(this._flyoutElement,"pointerdown",this._flyoutPointerDownHandler.bind(this));this._element.appendChild(this._flyoutElement);u=this;this._suggestionsData=new a.List;this._repeaterElement=t.document.createElement("div");this._repeater=new y.Repeater(this._repeaterElement,{data:this._suggestionsData,template:f});h._ensureId(this._repeaterElement);this._repeaterElement.setAttribute("role","listbox");this._repeaterElement.setAttribute("aria-live","polite");this._flyoutElement.appendChild(this._repeaterElement)},_setupSSM:function(){this._suggestionManager=new p._SearchSuggestionManagerShim;this._suggestions=this._suggestionManager.suggestions;this._suggestions.addEventListener("vectorchanged",this._suggestionsChangedHandler);this._suggestionManager.addEventListener("suggestionsrequested",this._suggestionsRequestedHandler)},_hideFlyout:function(){this._isFlyoutShown()&&(this._flyoutElement.style.display="none")},_showFlyout:function(){var e=this._prevNumSuggestions||0,u,f;if((this._prevNumSuggestions=this._suggestionsData.length,!this._isFlyoutShown()||e!==this._suggestionsData.length)&&this._suggestionsData.length!==0){this._flyoutElement.style.display="block";var n=this._inputElement.getBoundingClientRect(),i=this._flyoutElement.getBoundingClientRect(),r=t.document.documentElement.clientWidth,o=n.top,s=t.document.documentElement.clientHeight-n.bottom;this._flyoutBelowInput=s>=o;this._flyoutBelowInput?(this._flyoutElement.classList.remove(w.asbFlyoutAbove),this._flyoutElement.scrollTop=0):(this._flyoutElement.classList.add(w.asbFlyoutAbove),this._flyoutElement.scrollTop=this._flyoutElement.scrollHeight-this._flyoutElement.clientHeight);this._addFlyoutIMEPaddingIfRequired();u=t.getComputedStyle(this._flyoutElement).direction==="rtl"?n.right-i.width>=0||n.left+i.width>r:n.left+i.width>r&&n.right-i.width>=0;this._flyoutElement.style.left=u?n.width-i.width-this._element.clientLeft+"px":"-"+this._element.clientLeft+"px";this._flyoutElement.style.touchAction=this._flyoutElement.scrollHeight>i.height?"pan-y":"none";this._flyoutOpenPromise.cancel();f=this._flyoutBelowInput?"WinJS-flyoutBelowASB-showPopup":"WinJS-flyoutAboveASB-showPopup";this._flyoutOpenPromise=l.showPopup(this._flyoutElement,{top:"0px",left:"0px",keyframe:f})}},_addFlyoutIMEPaddingIfRequired:function(){var i=this._tryGetInputContext(),r;if(i&&this._isFlyoutShown()&&this._flyoutBelowInput){var u=this._flyoutElement.getBoundingClientRect(),n=i.getCandidateWindowClientRect(),t=this._inputElement.getBoundingClientRect(),f=t.bottom,e=t.bottom+u.height;n.top>e||n.bottom<f||(r=l.createRepositionAnimation(this._flyoutElement),n.width<t.width*.45?this._flyoutElement.style.marginLeft=n.width+"px":this._flyoutElement.style.marginTop=n.bottom-n.top+4+"px",r.execute())}},_findNextSuggestionElementIndex:function(n){for(var i=n<0?0:n+1,t=i;t<this._suggestionsData.length;t++)if(this._repeater.elementFromIndex(t)&&this._isSuggestionSelectable(this._suggestionsData.getAt(t)))return t;return-1},_findPreviousSuggestionElementIndex:function(n){for(var i=n>=this._suggestionsData.length?this._suggestionsData.length-1:n-1,t=i;t>=0;t--)if(this._repeater.elementFromIndex(t)&&this._isSuggestionSelectable(this._suggestionsData.getAt(t)))return t;return-1},_isFlyoutShown:function(){return this._flyoutElement.style.display!=="none"},_isSuggestionSelectable:function(n){return n.kind===p._SearchSuggestionKind.Query||n.kind===p._SearchSuggestionKind.Result},_processSuggestionChosen:function(n,t){this.queryText=n.text;n.kind===p._SearchSuggestionKind.Query?this._submitQuery(n.text,!1,t):n.kind===p._SearchSuggestionKind.Result&&this._fireEvent(c.resultsuggestionchosen,{tag:n.tag,keyModifiers:g(t),storageFile:null});this._hideFlyout()},_selectSuggestionAtIndex:function(n){function u(n){var i=t._flyoutElement.getBoundingClientRect().bottom-t._flyoutElement.getBoundingClientRect().top,r;n.offsetTop+n.offsetHeight>t._flyoutElement.scrollTop+i?(r=n.offsetTop+n.offsetHeight-(t._flyoutElement.scrollTop+i),h._zoomTo(t._flyoutElement,{contentX:0,contentY:t._flyoutElement.scrollTop+r,viewportX:0,viewportY:0})):n.offsetTop<t._flyoutElement.scrollTop&&h._zoomTo(t._flyoutElement,{contentX:0,contentY:n.offsetTop,viewportX:0,viewportY:0})}for(var t=this,i=null,r=0;r<this._suggestionsData.length;r++)i=this._repeater.elementFromIndex(r),r!==n?(i.classList.remove(w.asbSuggestionSelected),i.setAttribute("aria-selected","false")):(i.classList.add(w.asbSuggestionSelected),u(i),i.setAttribute("aria-selected","true"));this._currentSelectedIndex=n;i?this._inputElement.setAttribute("aria-activedescendant",this._repeaterElement.id+n):this._inputElement.hasAttribute("aria-activedescendant")&&this._inputElement.removeAttribute("aria-activedescendant")},_updateFakeFocus:function(){var n;n=this._isFlyoutShown()&&this._chooseSuggestionOnEnter?this._findNextSuggestionElementIndex(-1):-1;this._selectSuggestionAtIndex(n)},_updateQueryTextWithSuggestionText:function(n){n>=0&&n<this._suggestionsData.length&&(this.queryText=this._suggestionsData.getAt(n).text)},_disableControl:function(){this._isFlyoutShown()&&this._hideFlyout();this._element.disabled=!0;this._element.classList.add(w.asbDisabled);this._inputElement.disabled=!0},_enableControl:function(){this._element.disabled=!1;this._element.classList.remove(w.asbDisabled);this._inputElement.disabled=!1;t.document.activeElement===this._element&&h._setActive(this._inputElement)},_fireEvent:function(n,i){var r=t.document.createEvent("CustomEvent");return r.initCustomEvent(n,!0,!0,i),this._element.dispatchEvent(r)},_getLinguisticDetails:function(n,t){function c(n,t,r,u,f){for(var e=null,s=[],o=0;o<n.length;o++)s[o]=u+n[o]+f;if(i.Windows.ApplicationModel.Search.SearchQueryLinguisticDetails)try{e=new i.Windows.ApplicationModel.Search.SearchQueryLinguisticDetails(s,t,r)}catch(h){}return e||(e={queryTextAlternatives:s,queryTextCompositionStart:t,queryTextCompositionLength:r}),e}var e=null,r;if(this._inputElement.value===this._prevQueryText&&n&&this._prevLinguisticDetails&&t)e=this._prevLinguisticDetails;else{var h=[],u=0,f=0,o="",s="";t&&(r=this._tryGetInputContext(),r&&r.getCompositionAlternatives&&(h=r.getCompositionAlternatives(),u=r.compositionStartOffset,f=r.compositionEndOffset-r.compositionStartOffset,this._inputElement.value!==this._prevQueryText||this._prevCompositionLength===0||f>0?(o=this._inputElement.value.substring(0,u),s=this._inputElement.value.substring(u+f)):(o=this._inputElement.value.substring(0,this._prevCompositionStart),s=this._inputElement.value.substring(this._prevCompositionStart+this._prevCompositionLength))));e=c(h,u,f,o,s)}return e},_isElementInSearchControl:function(n){return this.element.contains(n)||this.element===n},_renderSuggestion:function(n){var t=null;if(!n)return t;if(n.kind===p._SearchSuggestionKind.Query)t=tt(this,n);else if(n.kind===p._SearchSuggestionKind.Separator)t=it(n);else if(n.kind===p._SearchSuggestionKind.Result)t=nt(this,n);else throw new u("WinJS.UI.AutoSuggestBox.invalidSuggestionKind",b.invalidSuggestionKind);return t},_shouldIgnoreInput:function(){var n=this._isProcessingDownKey||this._isProcessingUpKey||this._isProcessingTabKey||this._isProcessingEnterKey;return n||this._isFlyoutPointerDown},_submitQuery:function(n,t,r){this._disposed||(i.Windows.Globalization.Language&&(this._lastKeyPressLanguage=i.Windows.Globalization.Language.currentInputMethodLanguageTag),this._fireEvent(c.querysubmitted,{language:this._lastKeyPressLanguage,linguisticDetails:this._getLinguisticDetails(!0,t),queryText:n,keyModifiers:g(r)}),this._suggestionManager&&this._suggestionManager.addToHistory(this._inputElement.value,this._lastKeyPressLanguage))},_tryGetInputContext:function(){if(this._inputElement.msGetInputContext)try{return this._inputElement.msGetInputContext()}catch(n){return null}return null},_updateInputElementAriaLabel:function(){this._inputElement.setAttribute("aria-label",this._inputElement.placeholder?e._formatString(b.ariaLabelInputPlaceHolder,this._inputElement.placeholder):b.ariaLabelInputNoPlaceHolder)},_flyoutBlurHandler:function(){this._isElementInSearchControl(t.document.activeElement)?this._internalFocusMove=!0:(this._element.classList.remove(w.asbInputFocus),this._hideFlyout())},_flyoutPointerDownHandler:function(n){function u(){if(i)for(var n=0;n<r._suggestionsData.length;n++)if(r._repeater.elementFromIndex(n)===i)return n;return-1}var r=this,i=n.target,t;for(this._isFlyoutPointerDown=!0;i&&i.parentNode!==this._repeaterElement;)i=i.parentNode;t=u();t>=0&&t<this._suggestionsData.length&&this._currentFocusedIndex!==t&&this._isSuggestionSelectable(this._suggestionsData.getAt(t))&&(this._currentFocusedIndex=t,this._selectSuggestionAtIndex(t),this._updateQueryTextWithSuggestionText(this._currentFocusedIndex));n.preventDefault()},_flyoutPointerReleasedHandler:function(){if(this._isFlyoutPointerDown=!1,this._reflowImeOnPointerRelease){this._reflowImeOnPointerRelease=!1;var n=l.createRepositionAnimation(this._flyoutElement);this._flyoutElement.style.marginTop="";this._flyoutElement.style.marginLeft="";n.execute()}},_inputBlurHandler:function(){this._isElementInSearchControl(t.document.activeElement)||(this._element.classList.remove(w.asbInputFocus),this._hideFlyout());this.queryText=this._prevQueryText;this._isProcessingDownKey=!1;this._isProcessingUpKey=!1;this._isProcessingTabKey=!1;this._isProcessingEnterKey=!1},_inputFocusHandler:function(n){this._inputElement.value!==this._prevQueryText&&i.Windows.Data.Text.SemanticTextQuery&&(this._hitFinder=this._inputElement.value!==""?new i.Windows.Data.Text.SemanticTextQuery(this._inputElement.value,this._inputElement.lang):null);n.target!==this._inputElement||this._internalFocusMove||(this._showFlyout(),this._currentFocusedIndex!==-1?this._selectSuggestionAtIndex(this._currentFocusedIndex):this._updateFakeFocus(),this._suggestionManager.setQuery(this._inputElement.value,this._lastKeyPressLanguage,this._getLinguisticDetails(!0,!0)));this._internalFocusMove=!1;this._element.classList.add(w.asbInputFocus)},_inputOrImeChangeHandler:function(){function r(n){var i=!1;return(t._prevLinguisticDetails.queryTextCompositionStart!==n.queryTextCompositionStart||t._prevLinguisticDetails.queryTextCompositionLength!==n.queryTextCompositionLength||t._prevLinguisticDetails.queryTextAlternatives.length!==n.queryTextAlternatives.length)&&(i=!0),t._prevLinguisticDetails=n,i}var t=this,n,r;if(!this._shouldIgnoreInput()){if(n=this._getLinguisticDetails(!1,!0),r=r(n),(this._inputElement.value!==this._prevQueryText||this._prevCompositionLength===0||n.queryTextCompositionLength>0)&&(this._prevCompositionStart=n.queryTextCompositionStart,this._prevCompositionLength=n.queryTextCompositionLength),this._prevQueryText===this._inputElement.value&&!r)return;this._prevQueryText=this._inputElement.value;i.Windows.Globalization.Language&&(this._lastKeyPressLanguage=i.Windows.Globalization.Language.currentInputMethodLanguageTag);i.Windows.Data.Text.SemanticTextQuery&&(this._hitFinder=this._inputElement.value!==""?new i.Windows.Data.Text.SemanticTextQuery(this._inputElement.value,this._lastKeyPressLanguage):null);this._fireEvent(c.querychanged,{language:this._lastKeyPressLanguage,queryText:this._inputElement.value,linguisticDetails:n});this._suggestionManager.setQuery(this._inputElement.value,this._lastKeyPressLanguage,n)}},_inputPointerDownHandler:function(){t.document.activeElement===this._inputElement&&this._currentSelectedIndex!==-1&&(this._currentFocusedIndex=-1,this._selectSuggestionAtIndex(this._currentFocusedIndex))},_keyDownHandler:function(t){function i(n){e._currentFocusedIndex=n;e._selectSuggestionAtIndex(n);t.preventDefault();t.stopPropagation()}var e=this,r,u,f;this._lastKeyPressLanguage=t.locale;t.keyCode===n.tab?this._isProcessingTabKey=!0:t.keyCode===n.upArrow?this._isProcessingUpKey=!0:t.keyCode===n.downArrow?this._isProcessingDownKey=!0:t.keyCode===n.enter&&t.locale==="ko"&&(this._isProcessingEnterKey=!0);t.keyCode!==n.IME&&(t.keyCode===n.tab?(r=!0,t.shiftKey?this._currentFocusedIndex!==-1&&(i(-1),r=!1):this._currentFocusedIndex===-1&&(this._currentFocusedIndex=this._flyoutBelowInput?this._findNextSuggestionElementIndex(this._currentFocusedIndex):this._findPreviousSuggestionElementIndex(this._suggestionsData.length),this._currentFocusedIndex!==-1&&(i(this._currentFocusedIndex),this._updateQueryTextWithSuggestionText(this._currentFocusedIndex),r=!1)),r&&this._hideFlyout()):t.keyCode===n.escape?this._currentFocusedIndex!==-1?(this.queryText=this._prevQueryText,i(-1)):this.queryText!==""&&(this.queryText="",this._inputOrImeChangeHandler(null),t.preventDefault(),t.stopPropagation()):this._flyoutBelowInput&&t.keyCode===n.upArrow||!this._flyoutBelowInput&&t.keyCode===n.downArrow?(this._currentSelectedIndex!==-1?(u=this._findPreviousSuggestionElementIndex(this._currentSelectedIndex),u===-1&&(this.queryText=this._prevQueryText)):u=this._findPreviousSuggestionElementIndex(this._suggestionsData.length),i(u),this._updateQueryTextWithSuggestionText(this._currentFocusedIndex)):this._flyoutBelowInput&&t.keyCode===n.downArrow||!this._flyoutBelowInput&&t.keyCode===n.upArrow?(f=this._findNextSuggestionElementIndex(this._currentSelectedIndex),this._currentSelectedIndex!==-1&&f===-1&&(this.queryText=this._prevQueryText),i(f),this._updateQueryTextWithSuggestionText(this._currentFocusedIndex)):t.keyCode===n.enter&&(this._currentSelectedIndex===-1?this._submitQuery(this._inputElement.value,!0,t):this._processSuggestionChosen(this._suggestionsData.getAt(this._currentSelectedIndex),t),this._hideFlyout()))},_keyUpHandler:function(t){t.keyCode===n.tab?this._isProcessingTabKey=!1:t.keyCode===n.upArrow?this._isProcessingUpKey=!1:t.keyCode===n.downArrow?this._isProcessingDownKey=!1:t.keyCode===n.enter&&(this._isProcessingEnterKey=!1)},_keyPressHandler:function(n){this._lastKeyPressLanguage=n.locale},_msCandidateWindowHideHandler:function(){if(this._isFlyoutPointerDown)this._reflowImeOnPointerRelease=!0;else{var n=l.createRepositionAnimation(this._flyoutElement);this._flyoutElement.style.marginTop="";this._flyoutElement.style.marginLeft="";n.execute()}},_msCandidateWindowShowHandler:function(){this._addFlyoutIMEPaddingIfRequired();this._reflowImeOnPointerRelease=!1},_suggestionsChangedHandler:function(n){var f=n.collectionChange||n.detail.collectionChange,r=+n.index===n.index?n.index:n.detail.index,e=p._CollectionChange,i,u,o,s;f===e.reset?(this._isFlyoutShown()&&this._hideFlyout(),this._suggestionsData.splice(0,this._suggestionsData.length)):f===e.itemInserted?(i=this._suggestions[r],this._suggestionsData.splice(r,0,i),this._showFlyout()):f===e.itemRemoved?(this._suggestionsData.length===1&&(h._setActive(this._inputElement),this._hideFlyout()),this._suggestionsData.splice(r,1)):f===e.itemChanged&&(i=this._suggestions[r],i!==this._suggestionsData.getAt(r)?this._suggestionsData.setAt(r,i):(u=this._repeater.elementFromIndex(r),h.hasClass(u,w.asbSuggestionQuery)?k(u,i,i.text):(o=u.querySelector("."+w.asbSuggestionResultText),o&&(k(o,i,i.text),s=u.querySelector("."+w.asbSuggestionResultDetailedText),s&&k(s,i,i.detailText)))));t.document.activeElement===this._inputElement&&this._updateFakeFocus()},_suggestionsRequestedHandler:function(n){i.Windows.Globalization.Language&&(this._lastKeyPressLanguage=i.Windows.Globalization.Language.currentInputMethodLanguageTag);var t=n.request||n.detail.request,r;this._fireEvent(c.suggestionsrequested,{setPromise:function(n){r=t.getDeferral();n.then(function(){r.complete()})},searchSuggestionCollection:t.searchSuggestionCollection,language:this._lastKeyPressLanguage,linguisticDetails:this._getLinguisticDetails(!0,!0),queryText:this._inputElement.value})}},{createResultSuggestionImage:function(n){return i.Windows.Foundation.Uri&&i.Windows.Storage.Streams.RandomAccessStreamReference?i.Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(new i.Windows.Foundation.Uri(n)):n},_EventNames:c,_sortAndMergeHits:function(n){function u(n,t){var i=0;return n.startPosition<t.startPosition?i=-1:n.startPosition>t.startPosition&&(i=1),i}function f(n,t,i){var r,u,f;return i===0?n.push(t):(r=n[n.length-1],u=r.startPosition+r.length,t.startPosition<=u?(f=t.startPosition+t.length,f>u&&(r.length=f-r.startPosition)):n.push(t)),n}var r=[],i,t;if(n){for(i=new Array(n.length),t=0;t<n.length;t++)i.push({startPosition:n[t].startPosition,length:n[t].length});i.sort(u);i.reduce(f,r)}return r}});return r.Class.mix(d,o.DOMEventMixin),d})});n.ClassNames=w}),t("require-style!less/styles-searchbox",[],function(){}),t("require-style!less/colors-searchbox",[],function(){}),t("WinJS/Controls/SearchBox",["../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","./AutoSuggestBox","../Utilities/_Control","../Utilities/_ElementUtilities","./AutoSuggestBox/_SearchSuggestionManagerShim","../Application","require-style!less/styles-searchbox","require-style!less/colors-searchbox"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";i.Namespace.define("WinJS.UI",{SearchBox:i.Namespace._lazy(function(){var r={searchBox:"win-searchbox",searchBoxDisabled:"win-searchbox-disabled",searchBoxInput:"win-searchbox-input",searchBoxInputFocus:"win-searchbox-input-focus",searchBoxButton:"win-searchbox-button",searchBoxFlyout:"win-searchbox-flyout",searchBoxFlyoutHighlightText:"win-searchbox-flyout-highlighttext",searchBoxHitHighlightSpan:"win-searchbox-hithighlight-span",searchBoxSuggestionResult:"win-searchbox-suggestion-result",searchBoxSuggestionResultText:"win-searchbox-suggestion-result-text",searchBoxSuggestionResultDetailedText:"win-searchbox-suggestion-result-detailed-text",searchBoxSuggestionSelected:"win-searchbox-suggestion-selected",searchBoxSuggestionQuery:"win-searchbox-suggestion-query",searchBoxSuggestionSeparator:"win-searchbox-suggestion-separator",searchBoxButtonInputFocus:"win-searchbox-button-input-focus",searchBoxButtonDisabled:"win-searchbox-button-disabled"},a={receivingfocusonkeyboardinput:"receivingfocusonkeyboardinput"},u={get invalidSearchBoxSuggestionKind(){return"Error: Invalid search suggestion kind."},get ariaLabel(){return f._getWinJSString("ui/searchBoxAriaLabel").value},get ariaLabelInputNoPlaceHolder(){return f._getWinJSString("ui/searchBoxAriaLabelInputNoPlaceHolder").value},get ariaLabelInputPlaceHolder(){return f._getWinJSString("ui/searchBoxAriaLabelInputPlaceHolder").value}},l=i.Class.derive(e.AutoSuggestBox,function(t,i){this._requestingFocusOnKeyboardInputHandlerBind=this._requestingFocusOnKeyboardInputHandler.bind(this);this._buttonElement=n.document.createElement("div");this._focusOnKeyboardInput=!1;e.AutoSuggestBox.call(this,t,i);this.element.classList.add(r.searchBox);this._flyoutElement.classList.add(r.searchBoxFlyout);this._inputElement.classList.add(r.searchBoxInput);this._inputElement.addEventListener("blur",this._searchboxInputBlurHandler.bind(this));this._inputElement.addEventListener("focus",this._searchboxInputFocusHandler.bind(this));this._buttonElement.tabIndex=-1;this._buttonElement.classList.add(r.searchBoxButton);this._buttonElement.addEventListener("click",this._buttonClickHandler.bind(this));s._addEventListener(this._buttonElement,"pointerdown",this._buttonPointerDownHandler.bind(this));this.element.appendChild(this._buttonElement)},{focusOnKeyboardInput:{get:function(){return this._focusOnKeyboardInput},set:function(n){this._focusOnKeyboardInput&&!n?c._applicationListener.removeEventListener(this.element,"requestingfocusonkeyboardinput",this._requestingFocusOnKeyboardInputHandlerBind):this._focusOnKeyboardInput||!n||c._applicationListener.addEventListener(this.element,"requestingfocusonkeyboardinput",this._requestingFocusOnKeyboardInputHandlerBind);this._focusOnKeyboardInput=!!n}},dispose:function(){this._disposed||(e.AutoSuggestBox.prototype.dispose.call(this),this._focusOnKeyboardInput&&c._applicationListener.removeEventListener(this.element,"requestingfocusonkeyboardinput",this._requestingFocusOnKeyboardInputHandlerBind))},_disableControl:function(){e.AutoSuggestBox.prototype._disableControl.call(this);this._buttonElement.disabled=!0;this._buttonElement.classList.add(r.searchBoxButtonDisabled);this.element.classList.add(r.searchBoxDisabled)},_enableControl:function(){e.AutoSuggestBox.prototype._enableControl.call(this);this._buttonElement.disabled=!1;this._buttonElement.classList.remove(r.searchBoxButtonDisabled);this.element.classList.remove(r.searchBoxDisabled)},_renderSuggestion:function(n){var t=e.AutoSuggestBox.prototype._renderSuggestion.call(this,n),s,c,f,o,i,u;if(n.kind===h._SearchSuggestionKind.Query)t.classList.add(r.searchBoxSuggestionQuery);else if(n.kind===h._SearchSuggestionKind.Separator)t.classList.add(r.searchBoxSuggestionSeparator);else{for(t.classList.add(r.searchBoxSuggestionResult),s=t.querySelector("."+e.ClassNames.asbSuggestionResultText),s.classList.add(r.searchBoxSuggestionResultText),c=t.querySelector("."+e.ClassNames.asbSuggestionResultDetailedText),c.classList.add(r.searchBoxSuggestionResultDetailedText),f=t.querySelectorAll("."+e.ClassNames.asbHitHighlightSpan),i=0,u=f.length;i<u;i++)f[i].classList.add(r.searchBoxHitHighlightSpan);for(o=t.querySelectorAll("."+e.ClassNames.asbBoxFlyoutHighlightText),i=0,u=o.length;i<u;i++)o[i].classList.add(r.searchBoxFlyoutHighlightText)}return t},_selectSuggestionAtIndex:function(n){var t,i;e.AutoSuggestBox.prototype._selectSuggestionAtIndex.call(this,n);t=this.element.querySelector("."+r.searchBoxSuggestionSelected);t&&t.classList.remove(r.searchBoxSuggestionSelected);i=this.element.querySelector("."+e.ClassNames.asbSuggestionSelected);i&&i.classList.add(r.searchBoxSuggestionSelected)},_shouldIgnoreInput:function(){var n=e.AutoSuggestBox.prototype._shouldIgnoreInput(),t=s._matchesSelector(this._buttonElement,":active");return n||t},_updateInputElementAriaLabel:function(){this._inputElement.setAttribute("aria-label",this._inputElement.placeholder?f._formatString(u.ariaLabelInputPlaceHolder,this._inputElement.placeholder):u.ariaLabelInputNoPlaceHolder)},_buttonPointerDownHandler:function(n){this._inputElement.focus();n.preventDefault()},_buttonClickHandler:function(n){this._inputElement.focus();this._submitQuery(this._inputElement.value,!0,n);this._hideFlyout()},_searchboxInputBlurHandler:function(){s.removeClass(this.element,r.searchBoxInputFocus);s.removeClass(this._buttonElement,r.searchBoxButtonInputFocus)},_searchboxInputFocusHandler:function(){s.addClass(this.element,r.searchBoxInputFocus);s.addClass(this._buttonElement,r.searchBoxButtonInputFocus)},_requestingFocusOnKeyboardInputHandler:function(){if(this._fireEvent(a.receivingfocusonkeyboardinput,null),n.document.activeElement!==this._inputElement)try{this._inputElement.focus()}catch(t){}}},{createResultSuggestionImage:function(n){return t.Windows.Foundation.Uri&&t.Windows.Storage.Streams.RandomAccessStreamReference?t.Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(new t.Windows.Foundation.Uri(n)):n},_getKeyModifiers:function(n){var i={ctrlKey:1,altKey:2,shiftKey:4},t=0;return n.ctrlKey&&(t|=i.ctrlKey),n.altKey&&(t|=i.altKey),n.shiftKey&&(t|=i.shiftKey),t},_isTypeToSearchKey:function(n){return n.shiftKey||n.ctrlKey||n.altKey?!1:!0}});return i.Class.mix(l,o.DOMEventMixin),l})})}),t("WinJS/Controls/SettingsFlyout",["../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Events","../Core/_Resources","../Core/_WriteProfilerMark","../Animations","../Pages","../Promise","../_LightDismissService","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_ElementListUtilities","../Utilities/_Hoverable","./_LegacyAppBar/_Constants","./Flyout/_Overlay"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";i.Namespace.define("WinJS.UI",{SettingsFlyout:i.Namespace._lazy(function(){function rt(){if(t.Windows.UI.ApplicationSettings.SettingsEdgeLocation){var n=t.Windows.UI.ApplicationSettings;return n.SettingsPane.edge===n.SettingsEdgeLocation.left}return!1}function ut(n,t){for(var f=n.querySelectorAll("."+w.settingsFlyoutClass),r,i,u=0;u<f.length;u++)if(i=f[u].winControl,i){if(i.settingsCommandId===t){r=i;break}f[u].id===t&&(r=r||i)}return r}var g=v.Key,d=f._createEventProperty,nt,tt="narrow",it="wide",p=i.Class.derive(b._Overlay,function(t,i){var r,u,f;this._element=t||n.document.createElement("div");this._id=this._element.id||v._uniqueID(this._element);this._writeProfilerMark("constructor,StartTM");this._baseOverlayConstructor(this._element,i);this._addFirstDiv();this._addFinalDiv();this._element.addEventListener("keydown",this._handleKeyDown,!0);this._element.style.visibilty="hidden";this._element.style.display="none";v.addClass(this._element,w.settingsFlyoutClass);r=this;this._dismissable=new l.LightDismissableElement({element:this._element,tabIndex:this._element.hasAttribute("tabIndex")?this._element.tabIndex:-1,onLightDismiss:function(){r.hide()},onActivate:function(n){if(!r._dismissable.restoreFocus()){var t=r.element.querySelector("."+w.firstDivClass);t&&(t.msSettingsFlyoutFocusOut||(v._addEventListener(t,"focusout",function(){nt=1},!1),t.msSettingsFlyoutFocusOut=!0),nt=0,v._tryFocus(t,n))}}});y.query("div.win-content",this._element).forEach(function(n){v._matchesSelector(n,".win-ui-dark, .win-ui-dark *")||v.addClass(n,w.flyoutLightClass)});u=this._element.getAttribute("role");(u===null||u===""||u===undefined)&&this._element.setAttribute("role","dialog");f=this._element.getAttribute("aria-label");(f===null||f===""||f===undefined)&&this._element.setAttribute("aria-label",k.ariaLabel);this._currentAnimateIn=this._animateSlideIn;this._currentAnimateOut=this._animateSlideOut;this._writeProfilerMark("constructor,StopTM")},{width:{get:function(){return this._width},set:function(n){(v._deprecated(k.widthDeprecationMessage),n!==this._width)&&(this._width===tt?v.removeClass(this._element,w.narrowClass):this._width===it&&v.removeClass(this._element,w.wideClass),this._width=n,this._width===tt?v.addClass(this._element,w.narrowClass):this._width===it&&v.addClass(this._element,w.wideClass))}},settingsCommandId:{get:function(){return this._settingsCommandId},set:function(n){this._settingsCommandId=n}},disabled:{get:function(){return!!this._element.disabled},set:function(n){n=!!n;var t=!!this._element.disabled;t!==n&&(this._element.disabled=n,!this.hidden&&this._element.disabled&&this._dismiss())}},onbeforeshow:d(b._Overlay.beforeShow),onaftershow:d(b._Overlay.afterShow),onbeforehide:d(b._Overlay.beforeHide),onafterhide:d(b._Overlay.afterHide),show:function(){this.disabled||(this._writeProfilerMark("show,StartTM"),this._show())},_dispose:function(){l.hidden(this._dismissable);a.disposeSubTree(this.element);this._dismiss()},_show:function(){var n,t;this._baseShow()&&(v.hasClass(this.element.children[0],w.firstDivClass)||(n=this.element.querySelectorAll("."+w.firstDivClass),n&&n.length>0&&n.item(0).parentNode.removeChild(n.item(0)),this._addFirstDiv()),v.hasClass(this.element.children[this.element.children.length-1],w.finalDivClass)||(t=this.element.querySelectorAll("."+w.finalDivClass),t&&t.length>0&&t.item(0).parentNode.removeChild(t.item(0)),this._addFinalDiv()),this._setBackButtonsAriaLabel(),l.shown(this._dismissable))},_setBackButtonsAriaLabel:function(){for(var i=this.element.querySelectorAll(".win-backbutton"),n,t=0;t<i.length;t++)n=i[t].getAttribute("aria-label"),(n===null||n===""||n===undefined)&&i[t].setAttribute("aria-label",k.backbuttonAriaLabel)},hide:function(){this._writeProfilerMark("hide,StartTM");this._hide()},_hide:function(){this._baseHide()},_beforeEndHide:function(){l.hidden(this._dismissable)},_animateSlideIn:function(){var i=rt(),r=i?"-100px":"100px",n,t;return y.query("div.win-content",this._element).forEach(function(n){s.enterPage(n,{left:r})}),t=this._element.offsetWidth,i?(n={top:"0px",left:"-"+t+"px"},this._element.style.right="auto",this._element.style.left="0px"):(n={top:"0px",left:t+"px"},this._element.style.right="0px",this._element.style.left="auto"),this._element.style.opacity=1,this._element.style.visibility="visible",s.showPanel(this._element,n)},_animateSlideOut:function(){var t,n=this._element.offsetWidth;return rt()?(t={top:"0px",left:n+"px"},this._element.style.right="auto",this._element.style.left="-"+n+"px"):(t={top:"0px",left:"-"+n+"px"},this._element.style.right="-"+n+"px",this._element.style.left="auto"),s.showPanel(this._element,t)},_fragmentDiv:{get:function(){return this._fragDiv},set:function(n){this._fragDiv=n}},_unloadPage:function(t){var i=t.currentTarget.winControl;i.removeEventListener(b._Overlay.afterHide,this._unloadPage,!1);c.as().then(function(){i._fragmentDiv&&(n.document.body.removeChild(i._fragmentDiv),i._fragmentDiv=null)})},_dismiss:function(){this.addEventListener(b._Overlay.afterHide,this._unloadPage,!1);this._hide()},_handleKeyDown:function(t){var r,i;if((t.keyCode===g.space||t.keyCode===g.enter)&&this.children[0]===n.document.activeElement)t.preventDefault(),t.stopPropagation(),this.winControl._dismiss();else if(t.shiftKey&&t.keyCode===g.tab&&this.children[0]===n.document.activeElement)for(t.preventDefault(),t.stopPropagation(),r=this.getElementsByTagName("*"),i=r.length-2;i>=0;i--)if(r[i].focus(),r[i]===n.document.activeElement)break},_focusOnLastFocusableElementFromParent:function(){var u=n.document.activeElement,t,r,i;if(nt&&u&&v.hasClass(u,w.firstDivClass)&&(t=this.parentElement.getElementsByTagName("*"),!(t.length<=2)))if(r=t[t.length-1].tabIndex,r){for(i=t.length-2;i>0;i--)if(t[i].tabIndex===r){t[i].focus();break}}else for(i=t.length-2;i>0;i--)if((t[i].tagName!=="DIV"||t[i].getAttribute("tabIndex")!==null)&&(t[i].focus(),t[i]===n.document.activeElement))break},_focusOnFirstFocusableElementFromParent:function(){var u=n.document.activeElement,i,r,t;if(u&&v.hasClass(u,w.finalDivClass)&&(i=this.parentElement.getElementsByTagName("*"),!(i.length<=2)))if(r=i[0].tabIndex,r){for(t=1;t<i.length-1;t++)if(i[t].tabIndex===r){i[t].focus();break}}else for(t=1;t<i.length-1;t++)if((i[t].tagName!=="DIV"||i[t].getAttribute("tabIndex")!==null)&&(i[t].focus(),i[t]===n.document.activeElement))break},_addFirstDiv:function(){for(var t,r=this._element.getElementsByTagName("*"),u=0,i=0;i<r.length;i++)0<r[i].tabIndex&&(u===0||r[i].tabIndex<u)&&(u=r[i].tabIndex);t=n.document.createElement("div");t.className=w.firstDivClass;t.style.display="inline";t.setAttribute("role","menuitem");t.setAttribute("aria-hidden","true");t.tabIndex=u;v._addEventListener(t,"focusin",this._focusOnLastFocusableElementFromParent,!1);this._element.children[0]?this._element.insertBefore(t,this._element.children[0]):this._element.appendChild(t)},_addFinalDiv:function(){for(var t,r=this._element.getElementsByTagName("*"),u=0,i=0;i<r.length;i++)r[i].tabIndex>u&&(u=r[i].tabIndex);t=n.document.createElement("div");t.className=w.finalDivClass;t.style.display="inline";t.setAttribute("role","menuitem");t.setAttribute("aria-hidden","true");t.tabIndex=u;v._addEventListener(t,"focusin",this._focusOnFirstFocusableElementFromParent,!1);this._element.appendChild(t)},_writeProfilerMark:function(n){o("WinJS.UI.SettingsFlyout:"+this._id+":"+n)}}),r,k;return p.show=function(){var r,f,i,u;for(t.Windows.UI.ApplicationSettings.SettingsPane&&t.Windows.UI.ApplicationSettings.SettingsPane.show(),r=n.document.querySelectorAll('div[data-win-control="WinJS.UI.SettingsFlyout"]'),f=r.length,i=0;i<f;i++)u=r[i].winControl,u&&u._dismiss()},r={event:undefined},p.populateSettings=function(n){if(r.event=n.detail,r.event.applicationcommands){var i=t.Windows.UI.ApplicationSettings;Object.keys(r.event.applicationcommands).forEach(function(n){var t=r.event.applicationcommands[n],u;t.title||(t.title=n);u=new i.SettingsCommand(n,t.title,p._onSettingsCommand);r.event.e.request.applicationCommands.append(u)})}},p._onSettingsCommand=function(n){var t=n.id;r.event.applicationcommands&&r.event.applicationcommands[t]&&p.showSettings(t,r.event.applicationcommands[t].href)},p.showSettings=function(t,i){var f=ut(n.document,t),r;if(f)f.show();else if(i)r=n.document.createElement("div"),r=n.document.body.appendChild(r),h.render(i,r).then(function(){f=ut(r,t);f?(f._fragmentDiv=r,f.show()):n.document.body.removeChild(r)});else throw new u("WinJS.UI.SettingsFlyout.BadReference",k.badReference);},k={get ariaLabel(){return e._getWinJSString("ui/settingsFlyoutAriaLabel").value},get badReference(){return"Invalid argument: Invalid href to settings flyout fragment"},get backbuttonAriaLabel(){return e._getWinJSString("ui/backbuttonarialabel").value},get widthDeprecationMessage(){return"SettingsFlyout.width may be altered or unavailable in future versions. Instead, style the CSS width property on elements with the .win-settingsflyout class."}},p})})}),t("WinJS/Controls/NavBar/_Command",["exports","../../Core/_Global","../../Core/_Base","../../Core/_ErrorFromName","../../Core/_Resources","../../ControlProcessor","../../Navigation","../../Utilities/_Control","../../Utilities/_ElementUtilities","../AppBar/_Icon"],function(n,t,i,r,u,f,e,o,s,h){"use strict";i.Namespace._moduleDefine(n,"WinJS.UI",{_WinPressed:i.Namespace._lazy(function(){var n=i.Class.define(function(n){this._element=n;s._addEventListener(this._element,"pointerdown",this._MSPointerDownButtonHandler.bind(this))},{_MSPointerDownButtonHandler:function(i){this._pointerUpBound||(this._pointerUpBound=this._MSPointerUpHandler.bind(this),this._pointerCancelBound=this._MSPointerCancelHandler.bind(this),this._pointerOverBound=this._MSPointerOverHandler.bind(this),this._pointerOutBound=this._MSPointerOutHandler.bind(this));i.isPrimary&&(this._pointerId&&this._resetPointer(),s._matchesSelector(i.target,".win-interactive, .win-interactive *")||(this._pointerId=i.pointerId,s._addEventListener(t,"pointerup",this._pointerUpBound,!0),s._addEventListener(t,"pointercancel",this._pointerCancelBound),s._addEventListener(this._element,"pointerover",this._pointerOverBound,!0),s._addEventListener(this._element,"pointerout",this._pointerOutBound,!0),s.addClass(this._element,n.winPressed)))},_MSPointerOverHandler:function(t){this._pointerId===t.pointerId&&s.addClass(this._element,n.winPressed)},_MSPointerOutHandler:function(t){this._pointerId===t.pointerId&&s.removeClass(this._element,n.winPressed)},_MSPointerCancelHandler:function(n){this._pointerId===n.pointerId&&this._resetPointer()},_MSPointerUpHandler:function(n){this._pointerId===n.pointerId&&this._resetPointer()},_resetPointer:function(){this._pointerId=null;s._removeEventListener(t,"pointerup",this._pointerUpBound,!0);s._removeEventListener(t,"pointercancel",this._pointerCancelBound,!0);s._removeEventListener(this._element,"pointerover",this._pointerOverBound,!0);s._removeEventListener(this._element,"pointerout",this._pointerOutBound,!0);s.removeClass(this._element,n.winPressed)},dispose:function(){this._disposed||(this._disposed=!0,this._resetPointer())}},{winPressed:"win-pressed"});return n}),NavBarCommand:i.Namespace._lazy(function(){var c=s.Key,l={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},u=i.Class.define(function(n,i){if(n=n||t.document.createElement("DIV"),i=i||{},n.winControl)throw new r("WinJS.UI.NavBarCommand.DuplicateConstruction",l.duplicateConstruction);n.winControl=this;this._element=n;s.addClass(this.element,u._ClassName.navbarcommand);s.addClass(this.element,"win-disposable");this._tooltip=null;this._splitOpened=!1;this._buildDom();n.addEventListener("keydown",this._keydownHandler.bind(this));o.setOptions(this,i)},{element:{get:function(){return this._element}},label:{get:function(){return this._label},set:function(n){this._label=n;this._labelEl.textContent=n}},tooltip:{get:function(){return this._tooltip},set:function(n){this._tooltip=n;this._tooltip||this._tooltip===""?this._element.setAttribute("title",this._tooltip):this._element.removeAttribute("title")}},icon:{get:function(){return this._icon},set:function(n){this._icon=h[n]||n;this._icon&&this._icon.length===1?(this._imageSpan.textContent=this._icon,this._imageSpan.style.backgroundImage="",this._imageSpan.style.msHighContrastAdjust="",this._imageSpan.style.display=""):this._icon&&this._icon.length>1?(this._imageSpan.textContent="",this._imageSpan.style.backgroundImage=this._icon,this._imageSpan.style.msHighContrastAdjust="none",this._imageSpan.style.display=""):(this._imageSpan.textContent="",this._imageSpan.style.backgroundImage="",this._imageSpan.style.msHighContrastAdjust="",this._imageSpan.style.display="none")}},location:{get:function(){return this._location},set:function(n){this._location=n}},state:{get:function(){return this._state},set:function(n){this._state=n}},splitButton:{get:function(){return this._split},set:function(n){this._split=n;this._splitButtonEl.style.display=this._split?"":"none"}},splitOpened:{get:function(){return this._splitOpened},set:function(n){this._splitOpened!==!!n&&this._toggleSplit()}},_toggleSplit:function(){this._splitOpened=!this._splitOpened;this._splitOpened?(s.addClass(this._splitButtonEl,u._ClassName.navbarcommandsplitbuttonopened),this._splitButtonEl.setAttribute("aria-expanded","true")):(s.removeClass(this._splitButtonEl,u._ClassName.navbarcommandsplitbuttonopened),this._splitButtonEl.setAttribute("aria-expanded","false"));this._fireEvent(u._EventName._splitToggle)},_rtl:{get:function(){return t.getComputedStyle(this.element).direction==="rtl"}},_keydownHandler:function(n){if(!s._matchesSelector(n.target,".win-interactive, .win-interactive *")){var t=this._rtl?c.rightArrow:c.leftArrow,i=this._rtl?c.leftArrow:c.rightArrow;n.altKey||n.keyCode!==t&&n.keyCode!==c.home&&n.keyCode!==c.end||n.target!==this._splitButtonEl?!n.altKey&&n.keyCode===i&&this.splitButton&&(n.target===this._buttonEl||this._buttonEl.contains(n.target))?(s._setActive(this._splitButtonEl),n.keyCode===i&&n.stopPropagation(),n.preventDefault()):(n.keyCode===c.space||n.keyCode===c.enter)&&(n.target===this._buttonEl||this._buttonEl.contains(n.target))?(this.location&&e.navigate(this.location,this.state),this._fireEvent(u._EventName._invoked)):(n.keyCode===c.space||n.keyCode===c.enter)&&n.target===this._splitButtonEl&&this._toggleSplit():(s._setActive(this._buttonEl),n.keyCode===t&&n.stopPropagation(),n.preventDefault())}},_getFocusInto:function(n){var t=this._rtl?c.rightArrow:c.leftArrow;return n===t&&this.splitButton?this._splitButtonEl:this._buttonEl},_buildDom:function(){var r='<div tabindex="0" role="button" class="'+u._ClassName.navbarcommandbutton+'"><div class="'+u._ClassName.navbarcommandbuttoncontent+'"><div class="'+u._ClassName.navbarcommandicon+'"><\/div><div class="'+u._ClassName.navbarcommandlabel+'"><\/div><\/div><\/div><div tabindex="-1" aria-expanded="false" class="'+u._ClassName.navbarcommandsplitbutton+'"><\/div>',i,t;for(this.element.insertAdjacentHTML("afterBegin",r),this._buttonEl=this.element.firstElementChild,this._buttonPressedBehavior=new n._WinPressed(this._buttonEl),this._contentEl=this._buttonEl.firstElementChild,this._imageSpan=this._contentEl.firstElementChild,this._imageSpan.style.display="none",this._labelEl=this._imageSpan.nextElementSibling,this._splitButtonEl=this._buttonEl.nextElementSibling,this._splitButtonPressedBehavior=new n._WinPressed(this._splitButtonEl),this._splitButtonEl.style.display="none",s._ensureId(this._buttonEl),this._splitButtonEl.setAttribute("aria-labelledby",this._buttonEl.id),this._buttonEl.addEventListener("click",this._handleButtonClick.bind(this)),i=new s._MutationObserver(this._splitButtonAriaExpandedPropertyChangeHandler.bind(this)),i.observe(this._splitButtonEl,{attributes:!0,attributeFilter:["aria-expanded"]}),this._splitButtonEl.addEventListener("click",this._handleSplitButtonClick.bind(this)),t=this._splitButtonEl.nextSibling;t;)this._buttonEl.insertBefore(t,this._contentEl),t.nodeName!=="#text"&&f.processAll(t),t=this._splitButtonEl.nextSibling},_handleButtonClick:function(n){var t=n.target;s._matchesSelector(t,".win-interactive, .win-interactive *")||(this.location&&e.navigate(this.location,this.state),this._fireEvent(u._EventName._invoked))},_splitButtonAriaExpandedPropertyChangeHandler:function(){this._splitButtonEl.getAttribute("aria-expanded")==="true"!==this._splitOpened&&this._toggleSplit()},_handleSplitButtonClick:function(){this._toggleSplit()},_fireEvent:function(n,i){var r=t.document.createEvent("CustomEvent");r.initCustomEvent(n,!0,!1,i);this.element.dispatchEvent(r)},dispose:function(){this._disposed||(this._disposed=!0,this._buttonPressedBehavior.dispose(),this._splitButtonPressedBehavior.dispose())}},{_ClassName:{navbarcommand:"win-navbarcommand",navbarcommandbutton:"win-navbarcommand-button",navbarcommandbuttoncontent:"win-navbarcommand-button-content",navbarcommandsplitbutton:"win-navbarcommand-splitbutton",navbarcommandsplitbuttonopened:"win-navbarcommand-splitbutton-opened",navbarcommandicon:"win-navbarcommand-icon",navbarcommandlabel:"win-navbarcommand-label"},_EventName:{_invoked:"_invoked",_splitToggle:"_splittoggle"}});return i.Class.mix(u,o.DOMEventMixin),u})})}),t("WinJS/Controls/NavBar/_Container",["exports","../../Core/_Global","../../Core/_Base","../../Core/_BaseUtils","../../Core/_ErrorFromName","../../Core/_Events","../../Core/_Log","../../Core/_Resources","../../Core/_WriteProfilerMark","../../Animations","../../Animations/_TransitionAnimation","../../BindingList","../../ControlProcessor","../../Navigation","../../Promise","../../Scheduler","../../Utilities/_Control","../../Utilities/_ElementUtilities","../../Utilities/_KeyboardBehavior","../../Utilities/_UI","../_LegacyAppBar/_Constants","../Repeater","./_Command"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";function it(){return t.document.activeElement===null||t.document.activeElement===t.document.body}i.Namespace._moduleDefine(n,"WinJS.UI",{NavBarContainer:i.Namespace._lazy(function(){var ut=b.Key,ft=3e3,et=b._MSPointerEvent.MSPOINTER_TYPE_TOUCH||"touch",ot=0,st=f._createEventProperty,rt={invoked:"invoked",splittoggle:"splittoggle"},ht={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get navBarContainerViewportAriaLabel(){return o._getWinJSString("ui/navBarContainerViewportAriaLabel").value}},n=i.Class.define(function(i,r){if(i=i||t.document.createElement("DIV"),this._id=i.id||b._uniqueID(i),this._writeProfilerMark("constructor,StartTM"),r=r||{},i.winControl)throw new u("WinJS.UI.NavBarContainer.DuplicateConstruction",ht.duplicateConstruction);i.winControl=this;this._element=i;b.addClass(this.element,n._ClassName.navbarcontainer);b.addClass(this.element,"win-disposable");i.getAttribute("tabIndex")||(i.tabIndex=-1);this._focusCurrentItemPassivelyBound=this._focusCurrentItemPassively.bind(this);this._closeSplitAndResetBound=this._closeSplitAndReset.bind(this);this._currentManipulationState=ot;this._panningDisabled=!b._supportsSnapPoints;this._fixedSize=!1;this._maxRows=1;this._sizes={};this._setupTree();this._duringConstructor=!0;this._dataChangingBound=this._dataChanging.bind(this);this._dataChangedBound=this._dataChanged.bind(this);v.addEventListener("navigated",this._closeSplitAndResetBound);this.layout=r.layout||d.Orientation.horizontal;r.maxRows&&(this.maxRows=r.maxRows);r.template&&(this.template=r.template);r.data&&(this.data=r.data);r.fixedSize&&(this.fixedSize=r.fixedSize);w._setOptions(this,r,!0);this._duringConstructor=!1;r.currentIndex&&(this.currentIndex=r.currentIndex);this._updatePageUI();p.schedule(function(){this._updateAppBarReference()},p.Priority.normal,this,"WinJS.UI.NavBarContainer_async_initialize");this._writeProfilerMark("constructor,StopTM")},{element:{get:function(){return this._element}},template:{get:function(){return this._template},set:function(n){if(this._template=n,this._repeater){var i=this.element.contains(t.document.activeElement);this._duringConstructor||this._closeSplitIfOpen();this._repeater.template=this._repeater.template;this._duringConstructor||(this._measured=!1,this._sizes.itemMeasured=!1,this._reset(),i&&this._keyboardBehavior._focus(0))}}},_render:function(n){var r=t.document.createElement("div"),i=this._template,u;return i&&(i.render?i.render(n,r):i.winControl&&i.winControl.render?i.winControl.render(n,r):r.appendChild(i(n))),u=new tt.NavBarCommand(r,n),u._element},data:{get:function(){return this._repeater&&this._repeater.data},set:function(n){n||(n=new l.List);this._duringConstructor||this._closeSplitIfOpen();this._removeDataChangingEvents();this._removeDataChangedEvents();var i=this.element.contains(t.document.activeElement);this._repeater||(this._surfaceEl.innerHTML="",this._repeater=new nt.Repeater(this._surfaceEl,{template:this._render.bind(this)}));this._addDataChangingEvents(n);this._repeater.data=n;this._addDataChangedEvents(n);this._duringConstructor||(this._measured=!1,this._sizes.itemMeasured=!1,this._reset(),i&&this._keyboardBehavior._focus(0))}},maxRows:{get:function(){return this._maxRows},set:function(n){n=+n===n?n:1;this._maxRows=Math.max(1,n);this._duringConstructor||(this._closeSplitIfOpen(),this._measured=!1,this._reset())}},layout:{get:function(){return this._layout},set:function(t){t===d.Orientation.vertical?(this._layout=d.Orientation.vertical,b.removeClass(this.element,n._ClassName.horizontal),b.addClass(this.element,n._ClassName.vertical)):(this._layout=d.Orientation.horizontal,b.removeClass(this.element,n._ClassName.vertical),b.addClass(this.element,n._ClassName.horizontal));this._viewportEl.style.msScrollSnapType="";this._zooming=!1;this._duringConstructor||(this._measured=!1,this._sizes.itemMeasured=!1,this._ensureVisible(this._keyboardBehavior.currentIndex,!0),this._updatePageUI(),this._closeSplitIfOpen())}},currentIndex:{get:function(){return this._keyboardBehavior.currentIndex},set:function(n){if(n===+n){var i=this.element.contains(t.document.activeElement);this._keyboardBehavior.currentIndex=n;this._ensureVisible(this._keyboardBehavior.currentIndex,!0);i&&this._keyboardBehavior._focus()}}},fixedSize:{get:function(){return this._fixedSize},set:function(n){this._fixedSize=!!n;this._duringConstructor||(this._closeSplitIfOpen(),this._measured?this._surfaceEl.children.length>0&&this._updateGridStyles():this._measure())}},oninvoked:st(rt.invoked),onsplittoggle:st(rt.splittoggle),forceLayout:function(){this._resizeHandler();this._measured&&(this._scrollPosition=b.getScrollPosition(this._viewportEl)[this.layout===d.Orientation.horizontal?"scrollLeft":"scrollTop"]);this._duringForceLayout=!0;this._ensureVisible(this._keyboardBehavior.currentIndex,!0);this._updatePageUI();this._duringForceLayout=!1},_updateAppBarReference:function(){if(!this._appBarEl||!this._appBarEl.contains(this.element)){this._appBarEl&&(this._appBarEl.removeEventListener("beforeopen",this._closeSplitAndResetBound),this._appBarEl.removeEventListener("beforeopen",this._resizeImplBound),this._appBarEl.removeEventListener("afteropen",this._focusCurrentItemPassivelyBound));for(var n=this.element.parentNode;n&&!b.hasClass(n,g.appBarClass);)n=n.parentNode;this._appBarEl=n;this._appBarEl&&(this._appBarEl.addEventListener("beforeopen",this._closeSplitAndResetBound),this._appBarEl.addEventListener("afteropen",this._focusCurrentItemPassivelyBound))}},_closeSplitAndReset:function(){this._closeSplitIfOpen();this._reset()},_dataChanging:function(n){this._elementHadFocus=t.document.activeElement;this._currentSplitNavItem&&this._currentSplitNavItem.splitOpened&&(n.type==="itemremoved"?this._surfaceEl.children[n.detail.index].winControl===this._currentSplitNavItem&&this._closeSplitIfOpen():n.type==="itemchanged"?this._surfaceEl.children[n.detail.index].winControl===this._currentSplitNavItem&&this._closeSplitIfOpen():n.type==="itemmoved"?this._surfaceEl.children[n.detail.oldIndex].winControl===this._currentSplitNavItem&&this._closeSplitIfOpen():n.type==="reload"&&this._closeSplitIfOpen())},_dataChanged:function(n){this._measured=!1;n.type==="itemremoved"?n.detail.index<this._keyboardBehavior.currentIndex?this._keyboardBehavior.currentIndex--:n.detail.index===this._keyboardBehavior.currentIndex&&(this._keyboardBehavior.currentIndex=this._keyboardBehavior.currentIndex,it()&&this._elementHadFocus&&this._keyboardBehavior._focus()):n.type==="itemchanged"?n.detail.index===this._keyboardBehavior.currentIndex&&it()&&this._elementHadFocus&&this._keyboardBehavior._focus():n.type==="iteminserted"?n.detail.index<=this._keyboardBehavior.currentIndex&&this._keyboardBehavior.currentIndex++:n.type==="itemmoved"?n.detail.oldIndex===this._keyboardBehavior.currentIndex&&(this._keyboardBehavior.currentIndex=n.detail.newIndex,it()&&this._elementHadFocus&&this._keyboardBehavior._focus()):n.type==="reload"&&(this._keyboardBehavior.currentIndex=0,it()&&this._elementHadFocus&&this._keyboardBehavior._focus());this._ensureVisible(this._keyboardBehavior.currentIndex,!0);this._updatePageUI()},_focusCurrentItemPassively:function(){this.element.contains(t.document.activeElement)&&this._keyboardBehavior._focus()},_reset:function(){this._keyboardBehavior.currentIndex=0;this.element.contains(t.document.activeElement)&&this._keyboardBehavior._focus(0);this._viewportEl.style.msScrollSnapType="";this._zooming=!1;this._ensureVisible(0,!0);this._updatePageUI()},_removeDataChangedEvents:function(){this._repeater&&(this._repeater.data.removeEventListener("itemchanged",this._dataChangedBound),this._repeater.data.removeEventListener("iteminserted",this._dataChangedBound),this._repeater.data.removeEventListener("itemmoved",this._dataChangedBound),this._repeater.data.removeEventListener("itemremoved",this._dataChangedBound),this._repeater.data.removeEventListener("reload",this._dataChangedBound))},_addDataChangedEvents:function(){this._repeater&&(this._repeater.data.addEventListener("itemchanged",this._dataChangedBound),this._repeater.data.addEventListener("iteminserted",this._dataChangedBound),this._repeater.data.addEventListener("itemmoved",this._dataChangedBound),this._repeater.data.addEventListener("itemremoved",this._dataChangedBound),this._repeater.data.addEventListener("reload",this._dataChangedBound))},_removeDataChangingEvents:function(){this._repeater&&(this._repeater.data.removeEventListener("itemchanged",this._dataChangingBound),this._repeater.data.removeEventListener("iteminserted",this._dataChangingBound),this._repeater.data.removeEventListener("itemmoved",this._dataChangingBound),this._repeater.data.removeEventListener("itemremoved",this._dataChangingBound),this._repeater.data.removeEventListener("reload",this._dataChangingBound))},_addDataChangingEvents:function(n){n.addEventListener("itemchanged",this._dataChangingBound);n.addEventListener("iteminserted",this._dataChangingBound);n.addEventListener("itemmoved",this._dataChangingBound);n.addEventListener("itemremoved",this._dataChangingBound);n.addEventListener("reload",this._dataChangingBound)},_mouseleave:function(){this._mouseInViewport&&(this._mouseInViewport=!1,this._updateArrows())},_MSPointerDown:function(n){n.pointerType===et&&this._mouseInViewport&&(this._mouseInViewport=!1,this._updateArrows())},_MSPointerMove:function(n){n.pointerType!==et&&(this._mouseInViewport||(this._mouseInViewport=!0,this._updateArrows()))},_setupTree:function(){this._animateNextPreviousButtons=y.wrap();this._element.addEventListener("mouseleave",this._mouseleave.bind(this));b._addEventListener(this._element,"pointerdown",this._MSPointerDown.bind(this));b._addEventListener(this._element,"pointermove",this._MSPointerMove.bind(this));b._addEventListener(this._element,"focusin",this._focusHandler.bind(this),!1);this._pageindicatorsEl=t.document.createElement("div");b.addClass(this._pageindicatorsEl,n._ClassName.pageindicators);this._element.appendChild(this._pageindicatorsEl);this._ariaStartMarker=t.document.createElement("div");this._element.appendChild(this._ariaStartMarker);this._viewportEl=t.document.createElement("div");b.addClass(this._viewportEl,n._ClassName.viewport);this._element.appendChild(this._viewportEl);this._viewportEl.setAttribute("role","group");this._viewportEl.setAttribute("aria-label",ht.navBarContainerViewportAriaLabel);this._boundResizeHandler=this._resizeHandler.bind(this);b._resizeNotifier.subscribe(this._element,this._boundResizeHandler);this._viewportEl.addEventListener("mselementresize",this._resizeHandler.bind(this));this._viewportEl.addEventListener("scroll",this._scrollHandler.bind(this));this._viewportEl.addEventListener("MSManipulationStateChanged",this._MSManipulationStateChangedHandler.bind(this));this._ariaEndMarker=t.document.createElement("div");this._element.appendChild(this._ariaEndMarker);this._surfaceEl=t.document.createElement("div");b.addClass(this._surfaceEl,n._ClassName.surface);this._viewportEl.appendChild(this._surfaceEl);this._surfaceEl.addEventListener("_invoked",this._navbarCommandInvokedHandler.bind(this));this._surfaceEl.addEventListener("_splittoggle",this._navbarCommandSplitToggleHandler.bind(this));b._addEventListener(this._surfaceEl,"focusin",this._itemsFocusHandler.bind(this),!1);this._surfaceEl.addEventListener("keydown",this._keyDownHandler.bind(this));for(var i=this.element.firstElementChild;i!==this._pageindicatorsEl;)this._surfaceEl.appendChild(i),a.process(i),i=this.element.firstElementChild;this._leftArrowEl=t.document.createElement("div");b.addClass(this._leftArrowEl,n._ClassName.navleftarrow);b.addClass(this._leftArrowEl,n._ClassName.navarrow);this._element.appendChild(this._leftArrowEl);this._leftArrowEl.addEventListener("click",this._goLeft.bind(this));this._leftArrowEl.style.opacity=0;this._leftArrowEl.style.visibility="hidden";this._leftArrowFadeOut=y.wrap();this._rightArrowEl=t.document.createElement("div");b.addClass(this._rightArrowEl,n._ClassName.navrightarrow);b.addClass(this._rightArrowEl,n._ClassName.navarrow);this._element.appendChild(this._rightArrowEl);this._rightArrowEl.addEventListener("click",this._goRight.bind(this));this._rightArrowEl.style.opacity=0;this._rightArrowEl.style.visibility="hidden";this._rightArrowFadeOut=y.wrap();this._keyboardBehavior=new k._KeyboardBehavior(this._surfaceEl,{scroller:this._viewportEl});this._winKeyboard=new k._WinKeyboard(this._surfaceEl)},_goRight:function(){this._sizes.rtl?this._goPrev():this._goNext()},_goLeft:function(){this._sizes.rtl?this._goNext():this._goPrev()},_goNext:function(){this._measure();var n=this._sizes.rowsPerPage*this._sizes.columnsPerPage,t=Math.min(Math.floor(this._keyboardBehavior.currentIndex/n)+1,this._sizes.pages-1);this._keyboardBehavior.currentIndex=Math.min(n*t,this._surfaceEl.children.length);this._keyboardBehavior._focus()},_goPrev:function(){this._measure();var n=this._sizes.rowsPerPage*this._sizes.columnsPerPage,t=Math.max(0,Math.floor(this._keyboardBehavior.currentIndex/n)-1);this._keyboardBehavior.currentIndex=Math.max(n*t,0);this._keyboardBehavior._focus()},_currentPage:{get:function(){return this.layout===d.Orientation.horizontal&&(this._measure(),this._sizes.viewportOffsetWidth>0)?Math.min(this._sizes.pages-1,Math.round(this._scrollPosition/this._sizes.viewportOffsetWidth)):0}},_resizeHandler:function(){if(!this._disposed&&this._measured){var n=this.layout===d.Orientation.horizontal?this._sizes.viewportOffsetWidth!==parseFloat(t.getComputedStyle(this._viewportEl).width):this._sizes.viewportOffsetHeight!==parseFloat(t.getComputedStyle(this._viewportEl).height);n&&(this._measured=!1,this._pendingResize||(this._pendingResize=!0,this._resizeImplBound=this._resizeImplBound||this._resizeImpl.bind(this),this._updateAppBarReference(),this._appBarEl&&this._appBarEl.winControl&&!this._appBarEl.winControl.opened?(p.schedule(this._resizeImplBound,p.Priority.idle,null,"WinJS.UI.NavBarContainer._resizeImpl"),this._appBarEl.addEventListener("beforeopen",this._resizeImplBound)):this._resizeImpl()))}},_resizeImpl:function(){!this._disposed&&this._pendingResize&&(this._pendingResize=!1,this._appBarEl&&this._appBarEl.removeEventListener("beforeopen",this._resizeImplBound),this._keyboardBehavior.currentIndex=0,this.element.contains(t.document.activeElement)&&this._keyboardBehavior._focus(this._keyboardBehavior.currentIndex),this._closeSplitIfOpen(),this._ensureVisible(this._keyboardBehavior.currentIndex,!0),this._updatePageUI())},_keyDownHandler:function(n){var h=n.keyCode,v,i,c,p,a,w,s;if(!n.altKey&&(h===ut.pageUp||h===ut.pageDown)){if(v=n.target,b._matchesSelector(v,".win-interactive, .win-interactive *"))return;i=this._keyboardBehavior.currentIndex;this._measure();var r=this._sizes,y=Math.floor(i/(r.columnsPerPage*r.rowsPerPage)),u=null;if(h===ut.pageUp){if(this.layout===d.Orientation.horizontal)c=y*r.columnsPerPage*r.rowsPerPage,i=i===c&&this._surfaceEl.children[i].winControl._buttonEl===t.document.activeElement?i-r.columnsPerPage*r.rowsPerPage:c;else{var o=this._surfaceEl.children[i],e=o.offsetTop,l=e+o.offsetHeight,f=this._zooming?this._zoomPosition:this._scrollPosition;if(e>=f&&l<f+r.viewportOffsetHeight)while(i>0&&this._surfaceEl.children[i-1].offsetTop>f)i--;if(this._keyboardBehavior.currentIndex===i){for(p=l-r.viewportOffsetHeight,i=Math.max(0,i-1);i>0&&this._surfaceEl.children[i-1].offsetTop>p;)i--;u=i>0?this._surfaceEl.children[i].offsetTop-this._sizes.itemMarginTop:0}}i=Math.max(i,0);this._keyboardBehavior.currentIndex=i;s=this._surfaceEl.children[i].winControl._buttonEl;u!==null&&this._scrollTo(u);b._setActive(s,this._viewportEl)}else{if(this.layout===d.Orientation.horizontal)a=(y+1)*r.columnsPerPage*r.rowsPerPage-1,i=i===a?i+r.columnsPerPage*r.rowsPerPage:a;else{var o=this._surfaceEl.children[this._keyboardBehavior.currentIndex],e=o.offsetTop,l=e+o.offsetHeight,f=this._zooming?this._zoomPosition:this._scrollPosition;if(e>=f&&l<f+r.viewportOffsetHeight)while(i<this._surfaceEl.children.length-1&&this._surfaceEl.children[i+1].offsetTop+this._surfaceEl.children[i+1].offsetHeight<f+r.viewportOffsetHeight)i++;if(i===this._keyboardBehavior.currentIndex){for(w=e+r.viewportOffsetHeight,i=Math.min(this._surfaceEl.children.length-1,i+1);i<this._surfaceEl.children.length-1&&this._surfaceEl.children[i+1].offsetTop+this._surfaceEl.children[i+1].offsetHeight<w;)i++;u=i<this._surfaceEl.children.length-1?this._surfaceEl.children[i+1].offsetTop-this._sizes.viewportOffsetHeight:this._scrollLength-this._sizes.viewportOffsetHeight}}i=Math.min(i,this._surfaceEl.children.length-1);this._keyboardBehavior.currentIndex=i;s=this._surfaceEl.children[i].winControl._buttonEl;u!==null&&this._scrollTo(u);try{b._setActive(s,this._viewportEl)}catch(k){}}}},_focusHandler:function(n){var t=n.target;this._surfaceEl.contains(t)||(this._skipEnsureVisible=!0,this._keyboardBehavior._focus(this._keyboardBehavior.currentIndex))},_itemsFocusHandler:function(n){var t=n.target,i;if(t!==this._surfaceEl){while(t.parentNode!==this._surfaceEl)t=t.parentNode;for(i=-1;t;)i++,t=t.previousSibling;this._skipEnsureVisible?this._skipEnsureVisible=!1:this._ensureVisible(i)}},_ensureVisible:function(n,t){var r,u,f,e,i;this._measure();this.layout===d.Orientation.horizontal?(r=Math.floor(n/(this._sizes.rowsPerPage*this._sizes.columnsPerPage)),this._scrollTo(r*this._sizes.viewportOffsetWidth,t)):(u=this._surfaceEl.children[n],f=n>0?u.offsetTop-this._sizes.itemMarginTop:0,e=n<this._surfaceEl.children.length-1?this._surfaceEl.children[n+1].offsetTop-this._sizes.viewportOffsetHeight:this._scrollLength-this._sizes.viewportOffsetHeight,i=this._zooming?this._zoomPosition:this._scrollPosition,i=Math.max(i,e),i=Math.min(i,f),this._scrollTo(i,t))},_scrollTo:function(n,t){if(this._measure(),n=this.layout===d.Orientation.horizontal?Math.max(0,Math.min(this._scrollLength-this._sizes.viewportOffsetWidth,n)):Math.max(0,Math.min(this._scrollLength-this._sizes.viewportOffsetHeight,n)),t){if(Math.abs(this._scrollPosition-n)>1){this._zooming=!1;this._scrollPosition=n;this._updatePageUI();this._duringForceLayout||this._closeSplitIfOpen();var i={};i[this.layout===d.Orientation.horizontal?"scrollLeft":"scrollTop"]=n;b.setScrollPosition(this._viewportEl,i)}}else(!this._zooming&&Math.abs(this._scrollPosition-n)>1||this._zooming&&Math.abs(this._zoomPosition-n)>1)&&(this._zoomPosition=n,this._zooming=!0,this.layout===d.Orientation.horizontal?(this._viewportEl.style.msScrollSnapType="none",b._zoomTo(this._viewportEl,{contentX:n,contentY:0,viewportX:0,viewportY:0})):b._zoomTo(this._viewportEl,{contentX:0,contentY:n,viewportX:0,viewportY:0}),this._closeSplitIfOpen())},_MSManipulationStateChangedHandler:function(n){this._currentManipulationState=n.currentState;n.currentState===n.MS_MANIPULATION_STATE_ACTIVE&&(this._viewportEl.style.msScrollSnapType="",this._zooming=!1);t.clearTimeout(this._manipulationStateTimeoutId);n.currentState===n.MS_MANIPULATION_STATE_STOPPED&&(this._manipulationStateTimeoutId=t.setTimeout(function(){this._viewportEl.style.msScrollSnapType="";this._zooming=!1;this._updateCurrentIndexIfPageChanged()}.bind(this),100))},_scrollHandler:function(){if(!this._disposed&&(this._measured=!1,!this._checkingScroll)){var n=this;this._checkingScroll=r._requestAnimationFrame(function(){if(!n._disposed){n._checkingScroll=null;var t=b.getScrollPosition(n._viewportEl)[n.layout===d.Orientation.horizontal?"scrollLeft":"scrollTop"];t!==n._scrollPosition&&(n._scrollPosition=t,n._closeSplitIfOpen());n._updatePageUI();n._zooming||n._currentManipulationState!==ot||n._updateCurrentIndexIfPageChanged()}})}},_updateCurrentIndexIfPageChanged:function(){if(this.layout===d.Orientation.horizontal){this._measure();var n=this._currentPage,i=n*this._sizes.rowsPerPage*this._sizes.columnsPerPage,r=(n+1)*this._sizes.rowsPerPage*this._sizes.columnsPerPage-1;(this._keyboardBehavior.currentIndex<i||this._keyboardBehavior.currentIndex>r)&&(this._keyboardBehavior.currentIndex=i,this.element.contains(t.document.activeElement)&&this._keyboardBehavior._focus(this._keyboardBehavior.currentIndex))}},_measure:function(){var n,r,i,u,f;this._measured||(this._resizeImpl(),this._writeProfilerMark("measure,StartTM"),n=this._sizes,n.rtl=t.getComputedStyle(this._element).direction==="rtl",r=this._surfaceEl.children.length,r>0?(this._sizes.itemMeasured||(this._writeProfilerMark("measureItem,StartTM"),i=this._surfaceEl.firstElementChild,i.style.margin="",i.style.width="",u=t.getComputedStyle(i),n.itemOffsetWidth=parseFloat(t.getComputedStyle(i).width),i.offsetWidth===0&&(n.itemOffsetWidth=0),n.itemMarginLeft=parseFloat(u.marginLeft),n.itemMarginRight=parseFloat(u.marginRight),n.itemWidth=n.itemOffsetWidth+n.itemMarginLeft+n.itemMarginRight,n.itemOffsetHeight=parseFloat(t.getComputedStyle(i).height),i.offsetHeight===0&&(n.itemOffsetHeight=0),n.itemMarginTop=parseFloat(u.marginTop),n.itemMarginBottom=parseFloat(u.marginBottom),n.itemHeight=n.itemOffsetHeight+n.itemMarginTop+n.itemMarginBottom,n.itemOffsetWidth>0&&n.itemOffsetHeight>0&&(n.itemMeasured=!0),this._writeProfilerMark("measureItem,StopTM")),n.viewportOffsetWidth=parseFloat(t.getComputedStyle(this._viewportEl).width),this._viewportEl.offsetWidth===0&&(n.viewportOffsetWidth=0),n.viewportOffsetHeight=parseFloat(t.getComputedStyle(this._viewportEl).height),this._viewportEl.offsetHeight===0&&(n.viewportOffsetHeight=0),this._measured=n.viewportOffsetWidth===0||n.itemOffsetHeight===0?!1:!0,this.layout===d.Orientation.horizontal?(this._scrollPosition=b.getScrollPosition(this._viewportEl).scrollLeft,n.leadingEdge=this._leftArrowEl.offsetWidth+parseInt(t.getComputedStyle(this._leftArrowEl).marginLeft)+parseInt(t.getComputedStyle(this._leftArrowEl).marginRight),f=n.viewportOffsetWidth-n.leadingEdge*2,n.maxColumns=n.itemWidth?Math.max(1,Math.floor(f/n.itemWidth)):1,n.rowsPerPage=Math.min(this.maxRows,Math.ceil(r/n.maxColumns)),n.columnsPerPage=Math.min(n.maxColumns,r),n.pages=Math.ceil(r/(n.columnsPerPage*n.rowsPerPage)),n.trailingEdge=n.leadingEdge,n.extraSpace=f-n.columnsPerPage*n.itemWidth,this._scrollLength=n.viewportOffsetWidth*n.pages,this._keyboardBehavior.fixedSize=n.rowsPerPage,this._keyboardBehavior.fixedDirection=k._KeyboardBehavior.FixedDirection.height,this._surfaceEl.style.height=n.itemHeight*n.rowsPerPage+"px",this._surfaceEl.style.width=this._scrollLength+"px"):(this._scrollPosition=this._viewportEl.scrollTop,n.leadingEdge=0,n.rowsPerPage=r,n.columnsPerPage=1,n.pages=1,n.trailingEdge=0,this._scrollLength=this._viewportEl.scrollHeight,this._keyboardBehavior.fixedSize=n.columnsPerPage,this._keyboardBehavior.fixedDirection=k._KeyboardBehavior.FixedDirection.width,this._surfaceEl.style.height="",this._surfaceEl.style.width=""),this._updateGridStyles()):(n.pages=1,this._hasPreviousContent=!1,this._hasNextContent=!1,this._surfaceEl.style.height="",this._surfaceEl.style.width=""),this._writeProfilerMark("measure,StopTM"))},_updateGridStyles:function(){for(var t,r,u,f,a,o,s,n=this._sizes,v=this._surfaceEl.children.length,i=0;i<v;i++){if(t=this._surfaceEl.children[i],f="",this.layout===d.Orientation.horizontal){var h=Math.floor(i/n.rowsPerPage),c=h%n.columnsPerPage==0,l=h%n.columnsPerPage==n.columnsPerPage-1,e=n.trailingEdge;this.fixedSize?e+=n.extraSpace:(a=n.extraSpace-(n.maxColumns-n.columnsPerPage)*n.itemWidth,f=n.itemOffsetWidth+a/n.maxColumns+"px");n.rtl?(o=c?n.leadingEdge:0,s=l?e:0):(o=l?e:0,s=c?n.leadingEdge:0);r=o+n.itemMarginRight+"px";u=s+n.itemMarginLeft+"px"}else r="",u="";t.style.marginRight!==r&&(t.style.marginRight=r);t.style.marginLeft!==u&&(t.style.marginLeft=u);t.style.width!==f&&(t.style.width=f)}},_updatePageUI:function(){var t,i,f,r,e,u;for(this._measure(),t=this._currentPage,this._hasPreviousContent=t!==0,this._hasNextContent=t<this._sizes.pages-1,this._updateArrows(),this._indicatorCount!==this._sizes.pages&&(this._indicatorCount=this._sizes.pages,this._pageindicatorsEl.innerHTML=new Array(this._sizes.pages+1).join('<span class="'+n._ClassName.indicator+'"><\/span>')),i=0;i<this._pageindicatorsEl.children.length;i++)i===t?b.addClass(this._pageindicatorsEl.children[i],n._ClassName.currentindicator):b.removeClass(this._pageindicatorsEl.children[i],n._ClassName.currentindicator);this._sizes.pages>1?(this._viewportEl.style.overflowX=this._panningDisabled?"hidden":"",this._pageindicatorsEl.style.visibility=""):(this._viewportEl.style.overflowX="hidden",this._pageindicatorsEl.style.visibility="hidden");this._sizes.pages<=1||this._layout!==d.Orientation.horizontal?(this._ariaStartMarker.removeAttribute("aria-flowto"),this._ariaEndMarker.removeAttribute("x-ms-aria-flowfrom")):(f=t*this._sizes.rowsPerPage*this._sizes.columnsPerPage,r=this._surfaceEl.children[f].winControl._buttonEl,b._ensureId(r),this._ariaStartMarker.setAttribute("aria-flowto",r.id),e=Math.min(this._surfaceEl.children.length-1,(t+1)*this._sizes.rowsPerPage*this._sizes.columnsPerPage-1),u=this._surfaceEl.children[e].winControl._buttonEl,b._ensureId(u),this._ariaEndMarker.setAttribute("x-ms-aria-flowfrom",u.id))},_closeSplitIfOpen:function(){this._currentSplitNavItem&&(this._currentSplitNavItem.splitOpened&&this._currentSplitNavItem._toggleSplit(),this._currentSplitNavItem=null)},_updateArrows:function(){var n=this._sizes.rtl?this._hasNextContent:this._hasPreviousContent,t=this._sizes.rtl?this._hasPreviousContent:this._hasNextContent,i=this;(this._mouseInViewport||this._panningDisabled)&&n?(this._leftArrowWaitingToFadeOut&&this._leftArrowWaitingToFadeOut.cancel(),this._leftArrowWaitingToFadeOut=null,this._leftArrowFadeOut&&this._leftArrowFadeOut.cancel(),this._leftArrowFadeOut=null,this._leftArrowEl.style.visibility="",this._leftArrowFadeIn=this._leftArrowFadeIn||h.fadeIn(this._leftArrowEl)):(n?this._leftArrowWaitingToFadeOut=this._leftArrowWaitingToFadeOut||y.timeout(c._animationTimeAdjustment(ft)):(this._leftArrowWaitingToFadeOut&&this._leftArrowWaitingToFadeOut.cancel(),this._leftArrowWaitingToFadeOut=y.wrap()),this._leftArrowWaitingToFadeOut.then(function(){this._leftArrowFadeIn&&this._leftArrowFadeIn.cancel();this._leftArrowFadeIn=null;this._leftArrowFadeOut=this._leftArrowFadeOut||h.fadeOut(this._leftArrowEl).then(function(){i._leftArrowEl.style.visibility="hidden"})}.bind(this)));(this._mouseInViewport||this._panningDisabled)&&t?(this._rightArrowWaitingToFadeOut&&this._rightArrowWaitingToFadeOut.cancel(),this._rightArrowWaitingToFadeOut=null,this._rightArrowFadeOut&&this._rightArrowFadeOut.cancel(),this._rightArrowFadeOut=null,this._rightArrowEl.style.visibility="",this._rightArrowFadeIn=this._rightArrowFadeIn||h.fadeIn(this._rightArrowEl)):(t?this._rightArrowWaitingToFadeOut=this._rightArrowWaitingToFadeOut||y.timeout(c._animationTimeAdjustment(ft)):(this._rightArrowWaitingToFadeOut&&this._rightArrowWaitingToFadeOut.cancel(),this._rightArrowWaitingToFadeOut=y.wrap()),this._rightArrowWaitingToFadeOut.then(function(){this._rightArrowFadeIn&&this._rightArrowFadeIn.cancel();this._rightArrowFadeIn=null;this._rightArrowFadeOut=this._rightArrowFadeOut||h.fadeOut(this._rightArrowEl).then(function(){i._rightArrowEl.style.visibility="hidden"})}.bind(this)))},_navbarCommandInvokedHandler:function(t){for(var i=t.target,r=-1;i;)r++,i=i.previousSibling;this._fireEvent(n._EventName.invoked,{index:r,navbarCommand:t.target.winControl,data:this._repeater?this._repeater.data.getAt(r):null})},_navbarCommandSplitToggleHandler:function(t){for(var r=t.target,u=-1,i;r;)u++,r=r.previousSibling;i=t.target.winControl;this._closeSplitIfOpen();i.splitOpened&&(this._currentSplitNavItem=i);this._fireEvent(n._EventName.splitToggle,{opened:i.splitOpened,index:u,navbarCommand:i,data:this._repeater?this._repeater.data.getAt(u):null})},_fireEvent:function(n,i){var r=t.document.createEvent("CustomEvent");r.initCustomEvent(n,!0,!1,i);this.element.dispatchEvent(r)},_writeProfilerMark:function(n){var t="WinJS.UI.NavBarContainer:"+this._id+":"+n;s(t);e.log&&e.log(t,null,"navbarcontainerprofiler")},dispose:function(){this._disposed||(this._disposed=!0,this._appBarEl&&(this._appBarEl.removeEventListener("beforeopen",this._closeSplitAndResetBound),this._appBarEl.removeEventListener("beforeopen",this._resizeImplBound)),v.removeEventListener("navigated",this._closeSplitAndResetBound),this._leftArrowWaitingToFadeOut&&this._leftArrowWaitingToFadeOut.cancel(),this._leftArrowFadeOut&&this._leftArrowFadeOut.cancel(),this._leftArrowFadeIn&&this._leftArrowFadeIn.cancel(),this._rightArrowWaitingToFadeOut&&this._rightArrowWaitingToFadeOut.cancel(),this._rightArrowFadeOut&&this._rightArrowFadeOut.cancel(),this._rightArrowFadeIn&&this._rightArrowFadeIn.cancel(),b._resizeNotifier.unsubscribe(this._element,this._boundResizeHandler),this._removeDataChangingEvents(),this._removeDataChangedEvents())}},{_ClassName:{navbarcontainer:"win-navbarcontainer",pageindicators:"win-navbarcontainer-pageindicator-box",indicator:"win-navbarcontainer-pageindicator",currentindicator:"win-navbarcontainer-pageindicator-current",vertical:"win-navbarcontainer-vertical",horizontal:"win-navbarcontainer-horizontal",viewport:"win-navbarcontainer-viewport",surface:"win-navbarcontainer-surface",navarrow:"win-navbarcontainer-navarrow",navleftarrow:"win-navbarcontainer-navleft",navrightarrow:"win-navbarcontainer-navright"},_EventName:{invoked:rt.invoked,splitToggle:rt.splittoggle}});return i.Class.mix(n,w.DOMEventMixin),n})})}),t("require-style!less/styles-navbar",[],function(){}),t("require-style!less/colors-navbar",[],function(){}),t("WinJS/Controls/NavBar",["../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_BaseUtils","../Core/_Events","../Core/_WriteProfilerMark","../Promise","../Scheduler","../Utilities/_ElementUtilities","../Utilities/_Hoverable","./_LegacyAppBar","./NavBar/_Command","./NavBar/_Container","require-style!less/styles-navbar","require-style!less/colors-navbar"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l="custom";i.Namespace.define("WinJS.UI",{NavBar:i.Namespace._lazy(function(){var a="childrenprocessed",v=u._createEventProperty,h=i.Class.derive(c._LegacyAppBar,function(n,i){i=i||{};i=r._shallowCopy(i);i.placement=i.placement||"top";i.layout=l;i.closedDisplayMode=i.closedDisplayMode||"minimal";c._LegacyAppBar.call(this,n,i);this._element.addEventListener("beforeopen",this._handleBeforeShow.bind(this));s.addClass(this.element,h._ClassName.navbar);t.Windows.ApplicationModel.DesignMode.designModeEnabled?this._processChildren():o.schedule(this._processChildren.bind(this),o.Priority.idle,null,"WinJS.UI.NavBar.processChildren")},{closedDisplayMode:{get:function(){return this._closedDisplayMode},set:function(n){var t=n==="none"?"none":"minimal";Object.getOwnPropertyDescriptor(c._LegacyAppBar.prototype,"closedDisplayMode").set.call(this,t);this._closedDisplayMode=t}},onchildrenprocessed:v(a),_processChildren:function(){if(!this._processed){this._processed=!0;this._writeProfilerMark("processChildren,StartTM");var n=this,t=e.as();return this._processors&&this._processors.forEach(function(i){for(var r=0,u=n.element.children.length;r<u;r++)(function(n){t=t.then(function(){i(n)})})(n.element.children[r])}),t.then(function(){n._writeProfilerMark("processChildren,StopTM");n._fireEvent(h._EventName.childrenProcessed)},function(){n._writeProfilerMark("processChildren,StopTM");n._fireEvent(h._EventName.childrenProcessed)})}return e.wrap()},_show:function(){if(!this.disabled){var n=this;this._processChildren().then(function(){c._LegacyAppBar.prototype._show.call(n)})}},_handleBeforeShow:function(){var t,n;if(!this._disposed)for(t=this.element.querySelectorAll(".win-navbarcontainer"),n=0;n<t.length;n++)t[n].winControl.forceLayout()},_fireEvent:function(t,i){var r=n.document.createEvent("CustomEvent");r.initCustomEvent(t,!0,!1,i||{});this.element.dispatchEvent(r)},_writeProfilerMark:function(n){f("WinJS.UI.NavBar:"+this._id+":"+n)}},{_ClassName:{navbar:"win-navbar"},_EventName:{childrenProcessed:a},isDeclarativeControlContainer:r.markSupportedForProcessing(function(n,t){if(n._processed)for(var i=0,r=n.element.children.length;i<r;i++)t(n.element.children[i]);else n._processors=n._processors||[],n._processors.push(t)})});return h})})}),t("require-style!less/styles-viewbox",[],function(){}),t("WinJS/Controls/ViewBox",["../Core/_Global","../Core/_Base","../Core/_BaseUtils","../Core/_ErrorFromName","../Core/_Resources","../Scheduler","../Utilities/_Control","../Utilities/_Dispose","../Utilities/_ElementUtilities","../Utilities/_Hoverable","require-style!less/styles-viewbox"],function(n,t,i,r,u,f,e,o,s){"use strict";t.Namespace.define("WinJS.UI",{ViewBox:t.Namespace._lazy(function(){function c(n){if(n&&!n._resizing){n._resizing=n._resizing||0;n._resizing++;try{n._updateLayout()}finally{n._resizing--}}}function u(n){n.target&&c(n.target.winControl)}function h(n){n.target&&c(n.target.parentElement.winControl)}var a={get invalidViewBoxChildren(){return"ViewBox expects to only have one child element"}},l=t.Class.define(function(t){this._disposed=!1;this._element=t||n.document.createElement("div");var i=this.element;i.winControl=this;s.addClass(i,"win-disposable");s.addClass(i,"win-viewbox");this.forceLayout()},{_sizer:null,_element:null,element:{get:function(){return this._element}},_rtl:{get:function(){return n.getComputedStyle(this.element).direction==="rtl"}},_initialize:function(){var n=this.element,t,e;if(n.firstElementChild!==this._sizer){if(i.validation&&n.childElementCount!==1)throw new r("WinJS.UI.ViewBox.InvalidChildren",a.invalidViewBoxChildren);this._sizer&&(this._sizer.onresize=null);t=n.firstElementChild;this._sizer=t;t&&(s._resizeNotifier.subscribe(n,u),n.addEventListener("mselementresize",u),s._resizeNotifier.subscribe(t,h),t.addEventListener("mselementresize",h));n.clientWidth===0&&n.clientHeight===0&&(e=this,f.schedule(function(){e._updateLayout()},f.Priority.normal,null,"WinJS.UI.ViewBox._updateLayout"))}},_updateLayout:function(){var n=this._sizer;if(n){var r=this.element,u=n.clientWidth,f=n.clientHeight,e=r.clientWidth,o=r.clientHeight,h=e/u,c=o/f,t=Math.min(h,c),l=Math.abs(e-u*t)/2,a=Math.abs(o-f*t)/2,s=this._rtl;this._sizer.style[i._browserStyleEquivalents.transform.scriptName]="translate("+(s?"-":"")+l+"px,"+a+"px) scale("+t+")";this._sizer.style[i._browserStyleEquivalents["transform-origin"].scriptName]=s?"top right":"top left"}},dispose:function(){this._disposed||(this.element&&s._resizeNotifier.unsubscribe(this.element,u),this._sizer&&s._resizeNotifier.unsubscribe(this._sizer,h),this._disposed=!0,o.disposeSubTree(this._element))},forceLayout:function(){this._initialize();this._updateLayout()}});return t.Class.mix(l,e.DOMEventMixin),l})})}),t("require-style!less/styles-contentdialog",[],function(){}),t("require-style!less/colors-contentdialog",[],function(){}),t("WinJS/Controls/ContentDialog",["../Application","../Utilities/_Dispose","../Promise","../_Signal","../Core/_BaseUtils","../Core/_Global","../Core/_WinRT","../Core/_Base","../Core/_Events","../Core/_ErrorFromName","../Core/_Resources","../Utilities/_Control","../Utilities/_ElementUtilities","../Utilities/_Hoverable","../Animations","require-style!less/styles-contentdialog","require-style!less/colors-contentdialog"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function w(n){p&&p.aDialogIsShowing()&&n.stopImmediatePropagation()}var p;["edgystarting","edgycompleted","edgycanceled"].forEach(function(t){n.addEventListener(t,w)});o.Namespace.define("WinJS.UI",{ContentDialog:o.Namespace._lazy(function(){function et(n){while(n){if(a.hasClass(n,"win-flyout"))return!0;n=n.parentNode}return!1}function ut(n){return i._cancelBlocker(n,function(){n.cancel()})}function it(n){n.ensuredFocusedElementInView=!0;this.dialog._renderForInputPane(n.occludedRect.height)}function rt(){this.dialog._clearInputPaneRendering()}function c(){}function g(n,t){n._interruptibleWorkPromises=n._interruptibleWorkPromises||[];var i=new r;n._interruptibleWorkPromises.push(t(n,i.promise));i.complete()}function nt(){(this._interruptibleWorkPromises||[]).forEach(function(n){n.cancel()})}var b={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"},get controlDisposed(){return"Cannot interact with the control after it has been disposed"},get contentDialogAlreadyShowing(){return"Cannot show a ContentDialog if there is already a ContentDialog that is showing"}},k={none:"none",primary:"primary",secondary:"secondary"},v={contentDialog:"win-contentdialog",backgroundOverlay:"win-contentdialog-backgroundoverlay",dialog:"win-contentdialog-dialog",title:"win-contentdialog-title",content:"win-contentdialog-content",commands:"win-contentdialog-commands",primaryCommand:"win-contentdialog-primarycommand",secondaryCommand:"win-contentdialog-secondarycommand",_verticalAlignment:"win-contentdialog-verticalalignment",_scroller:"win-contentdialog-scroller",_column0or1:"win-contentdialog-column0or1",_visible:"win-contentdialog-visible",_tabStop:"win-contentdialog-tabstop",_commandSpacer:"win-contentdialog-commandspacer"},d={beforeShow:"beforeshow",afterShow:"aftershow",beforeHide:"beforehide",afterHide:"afterhide"},ft=96,w,tt;return p=new(o.Class.define(function(){this._dialogs=[];this._prevFocus=null},{willShow:function(n){var t=this._dialogs.length;this._pruneDialogsMissingFromDom();this._dialogs.indexOf(n)===-1&&this._dialogs.push(n);t===0&&this._dialogs.length===1&&this._firstDialogWillShow(n)},didHide:function(n){var i=this._dialogs.length,t;this._pruneDialogsMissingFromDom();t=this._dialogs.indexOf(n);t!==-1&&this._dialogs.splice(t,1);i>0&&this._dialogs.length===0&&this._lastDialogDidHide()},aDialogIsShowing:function(){return this._dialogs.some(function(n){return!n.hidden})},_pruneDialogsMissingFromDom:function(){this._dialogs=this._dialogs.filter(function(n){return!f.document.body.contains(n.element)})},_firstDialogWillShow:function(){this._prevFocus=f.document.activeElement},_lastDialogDidHide:function(){var n=this._prevFocus;this._prevFocus=null;n&&n.focus()}})),w={Init:o.Class.define(null,{name:"Init",hidden:!0,enter:function(){this.dialog._dismissedSignal=null;this.dialog._setState(w.Hidden,!1)},exit:c,show:function(){throw"It's illegal to call show on the Init state";},hide:c,onCommandClicked:c,onInputPaneShown:c,onInputPaneHidden:c}),Hidden:o.Class.define(null,{name:"Hidden",hidden:!0,enter:function(n){n?this.show():p.didHide(this.dialog)},exit:c,show:function(){if(p.aDialogIsShowing())return i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing));var n=this.dialog._dismissedSignal=new r;return this.dialog._setState(w.BeforeShow),n.promise},hide:c,onCommandClicked:c,onInputPaneShown:c,onInputPaneHidden:c}),BeforeShow:o.Class.define(null,{name:"BeforeShow",hidden:!0,enter:function(){g(this,function(n,t){return t.then(function(){return n.dialog._fireBeforeShow()}).then(function(t){return t||n.dialog._cancelDismissalPromise(null),t}).then(function(t){t?n.dialog._setState(w.Showing):n.dialog._setState(w.Hidden,!1)})})},exit:nt,show:function(){return i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing))},hide:c,onCommandClicked:c,onInputPaneShown:c,onInputPaneHidden:c}),Showing:o.Class.define(null,{name:"Showing",hidden:{get:function(){return!!this._pendingHide}},enter:function(){g(this,function(n,t){return t.then(function(){if(n._pendingHide=null,a.addClass(n.dialog._dom.root,v._visible),n.dialog._addExternalListeners(),e.Windows.UI.ViewManagement.InputPane){var t=e.Windows.UI.ViewManagement.InputPane.getForCurrentView().occludedRect.height;t>0&&n.dialog._renderForInputPane(t)}return p.willShow(n.dialog),n.dialog._focusInitialElement(),n.dialog._playEntranceAnimation()}).then(function(){n.dialog._fireEvent(d.afterShow)}).then(function(){n.dialog._setState(w.Shown,n._pendingHide)})})},exit:nt,show:function(){if(this._pendingHide){var n=this._pendingHide.dismissalResult;return this._pendingHide=null,this.dialog._resetDismissalPromise(n,new r).promise}return i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing))},hide:function(n){this._pendingHide={dismissalResult:n}},onCommandClicked:c,onInputPaneShown:it,onInputPaneHidden:rt}),Shown:o.Class.define(null,{name:"Shown",hidden:!1,enter:function(n){n&&this.hide(n.dismissalResult)},exit:c,show:function(){return i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing))},hide:function(n){this.dialog._setState(w.BeforeHide,n)},onCommandClicked:function(n){this.hide(n)},onInputPaneShown:it,onInputPaneHidden:rt}),BeforeHide:o.Class.define(null,{name:"BeforeHide",hidden:!1,enter:function(n){g(this,function(t,i){return i.then(function(){return t.dialog._fireBeforeHide(n)}).then(function(i){i?t.dialog._setState(w.Hiding,n):t.dialog._setState(w.Shown,null)})})},exit:nt,show:function(){return i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing))},hide:c,onCommandClicked:c,onInputPaneShown:it,onInputPaneHidden:rt}),Hiding:o.Class.define(null,{name:"Hiding",hidden:{get:function(){return!this._showIsPending}},enter:function(n){g(this,function(t,i){return i.then(function(){t._showIsPending=!1;t.dialog._resetDismissalPromise(n,null)}).then(function(){return t.dialog._playExitAnimation()}).then(function(){t.dialog._removeExternalListeners();a.removeClass(t.dialog._dom.root,v._visible);t.dialog._clearInputPaneRendering();t.dialog._fireAfterHide(n)}).then(function(){t.dialog._setState(w.Hidden,t._showIsPending)})})},exit:nt,show:function(){return this._showIsPending?i.wrapError(new h("WinJS.UI.ContentDialog.ContentDialogAlreadyShowing",b.contentDialogAlreadyShowing)):(this._showIsPending=!0,this.dialog._dismissedSignal=new r,this.dialog._dismissedSignal.promise)},hide:function(n){this._showIsPending&&(this._showIsPending=!1,this.dialog._resetDismissalPromise(n,null))},onCommandClicked:c,onInputPaneShown:c,onInputPaneHidden:c}),Disposed:o.Class.define(null,{name:"Disposed",hidden:!0,enter:function(){p.didHide(this.dialog);this.dialog._removeExternalListeners();this.dialog._dismissedSignal&&this.dialog._dismissedSignal.error(new h("WinJS.UI.ContentDialog.ControlDisposed",b.controlDisposed))},exit:c,show:function(){return i.wrapError(new h("WinJS.UI.ContentDialog.ControlDisposed",b.controlDisposed))},hide:c,onCommandClicked:c,onInputPaneShown:c,onInputPaneHidden:c})},tt=o.Class.define(function(n,t){if(n&&n.winControl)throw new h("WinJS.UI.ContentDialog.DuplicateConstruction",b.duplicateConstruction);t=t||{};this._onBackClickBound=this._onBackClick.bind(this);this._onBeforeRequestingFocusOnKeyboardInputBound=this._onBeforeRequestingFocusOnKeyboardInput.bind(this);this._onInputPaneShownBound=this._onInputPaneShown.bind(this);this._onInputPaneHiddenBound=this._onInputPaneHidden.bind(this);this._onFocusInBound=this._onFocusIn.bind(this);this._onKeyDownEnteringDocumentBound=this._onKeyDownEnteringDocument.bind(this);this._onKeyEnteringDocumentBound=this._onKeyEnteringDocument.bind(this);this._disposed=!1;this._resizedForInputPane=!1;this._currentFocus=null;this._initializeDom(n||f.document.createElement("div"));this._setState(w.Init);this.title="";this.primaryCommandText="";this.primaryCommandDisabled=!1;this.secondaryCommandText="";this.secondaryCommandDisabled=!1;l.setOptions(this,t)},{element:{get:function(){return this._dom.root}},title:{get:function(){return this._title},set:function(n){n=n||"";this._title!==n&&(this._title=n,this._dom.title.textContent=n,this._dom.title.style.display=n?"":"none")}},primaryCommandText:{get:function(){return this._primaryCommandText},set:function(n){n=n||"";this._primaryCommandText!==n&&(this._primaryCommandText=n,this._dom.commands[0].textContent=n,this._updateCommandsUI())}},secondaryCommandText:{get:function(){return this._secondaryCommandText},set:function(n){n=n||"";this._secondaryCommandText!==n&&(this._secondaryCommandText=n,this._dom.commands[1].textContent=n,this._updateCommandsUI())}},primaryCommandDisabled:{get:function(){return this._primaryCommandDisabled},set:function(n){n=!!n;this._primaryCommandDisabled!==n&&(this._primaryCommandDisabled=n,this._dom.commands[0].disabled=n)}},secondaryCommandDisabled:{get:function(){return this._secondaryCommandDisabled},set:function(n){n=!!n;this._secondaryCommandDisabled!==n&&(this._secondaryCommandDisabled=n,this._dom.commands[1].disabled=n)}},hidden:{get:function(){return this._state.hidden}},dispose:function(){this._disposed||(this._setState(w.Disposed),this._disposed=!0,t._disposeElement(this._dom.content))},show:function(){return this._state.show()},hide:function(n){this._state.hide(n===undefined?k.none:n)},_initializeDom:function(n){var r=f.document.createElement("div"),t,i;r.className=v.content;a._reparentChildren(n,r);n.winControl=this;a.addClass(n,v.contentDialog);a.addClass(n,v._verticalAlignment);a.addClass(n,"win-disposable");n.innerHTML='<div class="'+v.backgroundOverlay+'"><\/div><div class="'+v._tabStop+'"><\/div><div tabindex="-1" role="dialog" class="'+v.dialog+'"><div class="'+v.title+'"><\/div><div class="'+v._scroller+'"><\/div><div class="'+v.commands+'"><button type="button" class="'+v._commandSpacer+'"><\/button><button type="button" class="'+v.primaryCommand+'"><\/button><button type="button" class="'+v.secondaryCommand+'"><\/button><\/div><\/div><div class="'+v._tabStop+'"><\/div><div class="'+v._column0or1+'"><\/div>';t={};t.root=n;t.backgroundOverlay=t.root.firstElementChild;t.startBodyTab=t.backgroundOverlay.nextElementSibling;t.dialog=t.startBodyTab.nextElementSibling;t.title=t.dialog.firstElementChild;t.scroller=t.title.nextElementSibling;t.commandContainer=t.scroller.nextElementSibling;t.commandSpacer=t.commandContainer.firstElementChild;t.commands=[];t.commands.push(t.commandSpacer.nextElementSibling);t.commands.push(t.commands[0].nextElementSibling);t.endBodyTab=t.dialog.nextElementSibling;t.content=r;this._dom=t;t.scroller.appendChild(t.content);a._ensureId(t.title);a._ensureId(t.startBodyTab);a._ensureId(t.endBodyTab);t.dialog.setAttribute("aria-labelledby",t.title.id);t.startBodyTab.setAttribute("x-ms-aria-flowfrom",t.endBodyTab.id);t.endBodyTab.setAttribute("aria-flowto",t.startBodyTab.id);this._updateTabIndices();i=this._onKeyLeavingElement.bind(this);t.root.addEventListener("keydown",i);t.root.addEventListener("keyup",i);t.root.addEventListener("keypress",i);a._addEventListener(t.root,"pointerdown",this._onPointerDown.bind(this));a._addEventListener(t.root,"pointerup",this._onPointerUp.bind(this));t.root.addEventListener("click",this._onClick.bind(this));a._addEventListener(t.startBodyTab,"focusin",this._onStartBodyTabFocusIn.bind(this));a._addEventListener(t.endBodyTab,"focusin",this._onEndBodyTabFocusIn.bind(this));t.commands[0].addEventListener("click",this._onCommandClicked.bind(this,k.primary));t.commands[1].addEventListener("click",this._onCommandClicked.bind(this,k.secondary))},_updateCommandsUI:function(){this._dom.commands[0].style.display=this.primaryCommandText?"":"none";this._dom.commands[1].style.display=this.secondaryCommandText?"":"none";this._dom.commandSpacer.style.display=this.primaryCommandText&&!this.secondaryCommandText||!this.primaryCommandText&&this.secondaryCommandText?"":"none"},_updateTabIndices:function(){this._updateTabIndicesThrottled||(this._updateTabIndicesThrottled=u._throttledFunction(100,this._updateTabIndicesImpl.bind(this)));this._updateTabIndicesThrottled()},_updateTabIndicesImpl:function(){var n=a._getHighAndLowTabIndices(this._dom.content);this._dom.startBodyTab.tabIndex=n.lowest;this._dom.commands[0].tabIndex=n.highest;this._dom.commands[1].tabIndex=n.highest;this._dom.endBodyTab.tabIndex=n.highest},_elementInDialog:function(n){return this._dom.dialog.contains(n)||n===this._dom.startBodyTab||n===this._dom.endBodyTab},_retakeFocus:function(){this._currentFocus&&this._elementInDialog(this._currentFocus)&&a._tryFocus(this._currentFocus)||this._focusInitialElement()},_isTopLevel:{get:function(){return!et(f.document.activeElement)}},_onCommandClicked:function(n){this._state.onCommandClicked(n)},_onPointerDown:function(n){n.stopPropagation();this._elementInDialog(n.target)||n.preventDefault()},_onPointerUp:function(n){n.stopPropagation();this._elementInDialog(n.target)||n.preventDefault()},_onClick:function(n){n.stopPropagation();this._elementInDialog(n.target)||n.preventDefault()},_onFocusIn:function(n){n=n.detail.originalEvent;this._isTopLevel&&(this._elementInDialog(n.target)?this._currentFocus=n.target:this._retakeFocus())},_onKeyDownEnteringDocument:function(n){n=n.detail.originalEvent;this._isTopLevel&&(n.keyCode===a.Key.tab?this._updateTabIndices():n.keyCode===a.Key.escape?(this.hide(k.none),n.preventDefault(),n.stopImmediatePropagation()):this._elementInDialog(f.document.activeElement)||(n.preventDefault(),n.stopImmediatePropagation()))},_onKeyEnteringDocument:function(n){n=n.detail.originalEvent;this._isTopLevel&&!this._elementInDialog(f.document.activeElement)&&n.keyCode!==a.Key.tab&&(n.preventDefault(),n.stopImmediatePropagation())},_onKeyLeavingElement:function(n){this._isTopLevel&&n.stopImmediatePropagation()},_onBeforeRequestingFocusOnKeyboardInput:function(n){n.preventDefault()},_onBackClick:function(n){this._isTopLevel&&(this.hide(k.none),n.preventDefault())},_onStartBodyTabFocusIn:function(){a._focusLastFocusableElement(this._dom.dialog)},_onEndBodyTabFocusIn:function(){a._focusFirstFocusableElement(this._dom.dialog)},_onInputPaneShown:function(n){this._state.onInputPaneShown(n.detail.originalEvent)},_onInputPaneHidden:function(){this._state.onInputPaneHidden()},_setState:function(n,t){this._disposed||(this._state&&this._state.exit(),this._state=new n,this._state.dialog=this,this._state.enter(t))},_resetDismissalPromise:function(n,t){var i=this._dismissedSignal,r=this._dismissedSignal=t;return i.complete({result:n}),r},_cancelDismissalPromise:function(n){var t=this._dismissedSignal,i=this._dismissedSignal=n;return t.cancel(),i},_fireEvent:function(n,t){t=t||{};var r=t.detail||null,u=!!t.cancelable,i=f.document.createEvent("CustomEvent");return i.initCustomEvent(n,!0,u,r),this._dom.root.dispatchEvent(i)},_fireBeforeShow:function(){return this._fireEvent(d.beforeShow,{cancelable:!0})},_fireBeforeHide:function(n){return this._fireEvent(d.beforeHide,{detail:{result:n},cancelable:!0})},_fireAfterHide:function(n){this._fireEvent(d.afterHide,{detail:{result:n}})},_playEntranceAnimation:function(){return ut(y.fadeIn(this._dom.root))},_playExitAnimation:function(){return ut(y.fadeOut(this._dom.root))},_addExternalListeners:function(){a._inputPaneListener.addEventListener(this._dom.root,"showing",this._onInputPaneShownBound);a._inputPaneListener.addEventListener(this._dom.root,"hiding",this._onInputPaneShownBound);a._documentElementListener.addEventListener(this._dom.root,"keydown",this._onKeyDownEnteringDocumentBound,!0);a._documentElementListener.addEventListener(this._dom.root,"keyup",this._onKeyEnteringDocumentBound,!0);a._documentElementListener.addEventListener(this._dom.root,"keypress",this._onKeyEnteringDocumentBound,!0);a._documentElementListener.addEventListener(this._dom.root,"focusin",this._onFocusInBound);n._applicationListener.addEventListener(this._dom.root,"backclick",this._onBackClickBound);n._applicationListener.addEventListener(this._dom.root,"beforerequestingfocusonkeyboardinput",this._onBeforeRequestingFocusOnKeyboardInputBound)},_removeExternalListeners:function(){a._inputPaneListener.removeEventListener(this._dom.root,"showing",this._onInputPaneShownBound);a._inputPaneListener.removeEventListener(this._dom.root,"hiding",this._onInputPaneShownBound);a._documentElementListener.removeEventListener(this._dom.root,"keydown",this._onKeyDownEnteringDocumentBound,!0);a._documentElementListener.removeEventListener(this._dom.root,"keyup",this._onKeyEnteringDocumentBound,!0);a._documentElementListener.removeEventListener(this._dom.root,"keypress",this._onKeyEnteringDocumentBound,!0);a._documentElementListener.removeEventListener(this._dom.root,"focusin",this._onFocusInBound);n._applicationListener.removeEventListener(this._dom.root,"backclick",this._onBackClickBound);n._applicationListener.removeEventListener(this._dom.root,"beforerequestingfocusonkeyboardinput",this._onBeforeRequestingFocusOnKeyboardInputBound)},_renderForInputPane:function(n){var r;this._clearInputPaneRendering();var i=this._dom.dialog,t=i.style,h=i.offsetLeft,u=i.offsetTop,e=i.offsetHeight,o=u+e,s=this._dom.root.offsetHeight-n,c=a.getTotalHeight(this._dom.title),l=a.getTotalHeight(this._dom.commandContainer);o>s&&(r=e-(o-s),r-c-l<ft&&this._dom.scroller.insertBefore(this._dom.title,this._dom.content),this._dom.root.style.display="block",t.height=r+"px",t.position="absolute",t.left=h+"px",t.top=u+"px",t.minHeight=0,this._resizedForInputPane=!0,f.document.activeElement.focus())},_clearInputPaneRendering:function(){if(this._resizedForInputPane){this._dom.title.parentNode!==this._dom.dialog&&this._dom.dialog.insertBefore(this._dom.title,this._dom.scroller);var n=this._dom.dialog.style;this._dom.root.style.display="";n.height="";n.position="";n.left="";n.top="";n.minHeight="";this._resizedForInputPane=!1}},_focusInitialElement:function(){a._focusFirstFocusableElement(this._dom.content)||this._dom.dialog.focus()}},{DismissalResult:k,_ClassNames:v}),o.Class.mix(tt,s.createEventProperties("beforeshow","aftershow","beforehide","afterhide")),o.Class.mix(tt,l.DOMEventMixin),tt})})}),t("require-style!less/styles-splitview",[],function(){}),t("require-style!less/colors-splitview",[],function(){}),t("WinJS/Controls/SplitView/_SplitView",["require","exports","../../Animations","../../Core/_Base","../../Core/_BaseUtils","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Core/_ErrorFromName","../../Core/_Events","../../Core/_Global","../../_LightDismissService","../../Utilities/_OpenCloseMachine"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){function rt(n,t){t&&o.addClass(n,t)}function ut(n,t){t&&o.removeClass(n,t)}function ft(n,t){return t===w.width?{content:n.contentWidth,total:n.totalWidth}:{content:n.contentHeight,total:n.totalHeight}}var d,b,tt;n(["require-style!less/styles-splitview"]);n(["require-style!less/colors-splitview"]);"use strict";var it=u._browserStyleEquivalents.transform,et={get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},v={splitView:"win-splitview",pane:"win-splitview-pane",content:"win-splitview-content",paneClosed:"win-splitview-pane-closed",paneOpened:"win-splitview-pane-opened",_panePlaceholder:"win-splitview-paneplaceholder",_paneWrapper:"win-splitview-panewrapper",_contentWrapper:"win-splitview-contentwrapper",_placementLeft:"win-splitview-placementleft",_placementRight:"win-splitview-placementright",_placementTop:"win-splitview-placementtop",_placementBottom:"win-splitview-placementbottom",_closedDisplayNone:"win-splitview-closeddisplaynone",_closedDisplayInline:"win-splitview-closeddisplayinline",_openedDisplayInline:"win-splitview-openeddisplayinline",_openedDisplayOverlay:"win-splitview-openeddisplayoverlay"},g={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"},w={width:"width",height:"height"},k={none:"none",inline:"inline"},p={inline:"inline",overlay:"overlay"},y={left:"left",right:"right",top:"top",bottom:"bottom"},nt={};nt[k.none]=v._closedDisplayNone;nt[k.inline]=v._closedDisplayInline;d={};d[p.overlay]=v._openedDisplayOverlay;d[p.inline]=v._openedDisplayInline;b={};b[y.left]=v._placementLeft;b[y.right]=v._placementRight;b[y.top]=v._placementTop;b[y.bottom]=v._placementBottom;tt=function(){function n(n,t){var i=this;if(t===void 0&&(t={}),this._updateDomImpl_rendered={paneIsFirst:undefined,isOpenedMode:undefined,closedDisplayMode:undefined,openedDisplayMode:undefined,panePlacement:undefined,panePlaceholderWidth:undefined,panePlaceholderHeight:undefined,isOverlayShown:undefined},n&&n.winControl)throw new s("WinJS.UI.SplitView.DuplicateConstruction",et.duplicateConstruction);this._initializeDom(n||c.document.createElement("div"));this._machine=new a.OpenCloseMachine({eventElement:this._dom.root,onOpen:function(){i._cachedHiddenPaneThickness=null;var n=i._getHiddenPaneThickness();return i._isOpenedMode=!0,i._updateDomImpl(),i._playShowAnimation(n)},onClose:function(){return i._playHideAnimation(i._getHiddenPaneThickness()).then(function(){i._isOpenedMode=!1;i._updateDomImpl()})},onUpdateDom:function(){i._updateDomImpl()},onUpdateDomWithIsOpened:function(n){i._isOpenedMode=n;i._updateDomImpl()}});this._disposed=!1;this._dismissable=new l.LightDismissableElement({element:this._dom.paneWrapper,tabIndex:-1,onLightDismiss:function(){i.closePane()}});this._cachedHiddenPaneThickness=null;this.paneOpened=!1;this.closedDisplayMode=k.inline;this.openedDisplayMode=p.overlay;this.panePlacement=y.left;f.setOptions(this,t);o._inDom(this._dom.root).then(function(){i._rtl=c.getComputedStyle(i._dom.root).direction==="rtl";i._machine.exitInit()})}return Object.defineProperty(n.prototype,"element",{get:function(){return this._dom.root},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paneElement",{get:function(){return this._dom.pane},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contentElement",{get:function(){return this._dom.content},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closedDisplayMode",{get:function(){return this._closedDisplayMode},set:function(n){k[n]&&this._closedDisplayMode!==n&&(this._closedDisplayMode=n,this._cachedHiddenPaneThickness=null,this._machine.updateDom())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"openedDisplayMode",{get:function(){return this._openedDisplayMode},set:function(n){p[n]&&this._openedDisplayMode!==n&&(this._openedDisplayMode=n,this._cachedHiddenPaneThickness=null,this._machine.updateDom())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"panePlacement",{get:function(){return this._panePlacement},set:function(n){y[n]&&this._panePlacement!==n&&(this._panePlacement=n,this._cachedHiddenPaneThickness=null,this._machine.updateDom())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paneOpened",{get:function(){return this._machine.opened},set:function(n){this._machine.opened=n},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._machine.dispose(),l.hidden(this._dismissable),e._disposeElement(this._dom.pane),e._disposeElement(this._dom.content))},n.prototype.openPane=function(){this._machine.open()},n.prototype.closePane=function(){this._machine.close()},n.prototype._initializeDom=function(n){var r=n.firstElementChild||c.document.createElement("div"),t,i,s,u,e,f;for(o.addClass(r,v.pane),t=c.document.createElement("div"),o.addClass(t,v.content),i=r.nextSibling;i;)s=i.nextSibling,t.appendChild(i),i=s;u=c.document.createElement("div");u.className=v._paneWrapper;u.appendChild(r);e=c.document.createElement("div");e.className=v._panePlaceholder;f=c.document.createElement("div");f.className=v._contentWrapper;f.appendChild(t);n.winControl=this;o.addClass(n,v.splitView);o.addClass(n,"win-disposable");this._dom={root:n,pane:r,paneWrapper:u,panePlaceholder:e,content:t,contentWrapper:f}},n.prototype._measureElement=function(n){var t=getComputedStyle(n),i=o._getPositionRelativeTo(n,this._dom.root),r=parseInt(t.marginLeft,10),u=parseInt(t.marginTop,10);return{left:i.left-r,top:i.top-u,contentWidth:o.getContentWidth(n),contentHeight:o.getContentHeight(n),totalWidth:o.getTotalWidth(n),totalHeight:o.getTotalHeight(n)}},n.prototype._setContentRect=function(n){var t=this._dom.contentWrapper.style;t.left=n.left+"px";t.top=n.top+"px";t.height=n.contentHeight+"px";t.width=n.contentWidth+"px"},n.prototype._prepareAnimation=function(n,t){var i=this._dom.paneWrapper.style,r;i.position="absolute";i.left=n.left+"px";i.top=n.top+"px";i.height=n.totalHeight+"px";i.width=n.totalWidth+"px";r=this._dom.contentWrapper.style;r.position="absolute";this._setContentRect(t)},n.prototype._clearAnimation=function(){var t=this._dom.paneWrapper.style,n,i;t.position="";t.left="";t.top="";t.height="";t.width="";t[it.scriptName]="";n=this._dom.contentWrapper.style;n.position="";n.left="";n.top="";n.height="";n.width="";n[it.scriptName]="";i=this._dom.pane.style;i.height="";i.width="";i[it.scriptName]=""},n.prototype._getHiddenContentRect=function(n,t,i){if(this.openedDisplayMode===p.overlay)return n;var f=this._rtl?y.left:y.right,u=this.panePlacement===f||this.panePlacement===y.bottom?0:1,r={content:i.content-t.content,total:i.total-t.total};return this._horizontal?{left:n.left-u*r.total,top:n.top,contentWidth:n.contentWidth+r.content,contentHeight:n.contentHeight,totalWidth:n.totalWidth+r.total,totalHeight:n.totalHeight}:{left:n.left,top:n.top-u*r.total,contentWidth:n.contentWidth,contentHeight:n.contentHeight+r.content,totalWidth:n.totalWidth,totalHeight:n.totalHeight+r.total}},Object.defineProperty(n.prototype,"_horizontal",{get:function(){return this.panePlacement===y.left||this.panePlacement===y.right},enumerable:!0,configurable:!0}),n.prototype._getHiddenPaneThickness=function(){if(this._cachedHiddenPaneThickness===null)if(this._closedDisplayMode===k.none)this._cachedHiddenPaneThickness={content:0,total:0};else{this._isOpenedMode&&(o.removeClass(this._dom.root,v.paneOpened),o.addClass(this._dom.root,v.paneClosed));var n=this._measureElement(this._dom.pane);this._cachedHiddenPaneThickness=ft(n,this._horizontal?w.width:w.height);this._isOpenedMode&&(o.removeClass(this._dom.root,v.paneClosed),o.addClass(this._dom.root,v.paneOpened))}return this._cachedHiddenPaneThickness},n.prototype._playShowAnimation=function(n){var t=this,u=this._horizontal?w.width:w.height,f=this._measureElement(this._dom.pane),e=this._measureElement(this._dom.content),r=ft(f,u),h=this._getHiddenContentRect(e,n,r),o,s;return this._prepareAnimation(f,h),o=function(){var f=t._rtl?y.left:y.right,e=n.total+.3*(r.total-n.total);return i._resizeTransition(t._dom.paneWrapper,t._dom.pane,{from:e,to:r.total,actualSize:r.total,dimension:u,anchorTrailingEdge:t.panePlacement===f||t.panePlacement===y.bottom})},s=function(){return t.openedDisplayMode===p.inline&&t._setContentRect(e),o()},s().then(function(){t._clearAnimation()})},n.prototype._playHideAnimation=function(n){var t=this,u=this._horizontal?w.width:w.height,f=this._measureElement(this._dom.pane),e=this._measureElement(this._dom.content),r=ft(f,u),h=this._getHiddenContentRect(e,n,r),o,s;return this._prepareAnimation(f,e),o=function(){var f=t._rtl?y.left:y.right,e=r.total-.3*(r.total-n.total);return i._resizeTransition(t._dom.paneWrapper,t._dom.pane,{from:e,to:n.total,actualSize:r.total,dimension:u,anchorTrailingEdge:t.panePlacement===f||t.panePlacement===y.bottom})},s=function(){return t.openedDisplayMode===p.inline&&t._setContentRect(h),o()},s().then(function(){t._clearAnimation()})},n.prototype._updateDomImpl=function(){var n=this._updateDomImpl_rendered,u=this.panePlacement===y.left||this.panePlacement===y.top,r,t,i,f,e;u!==n.paneIsFirst&&(u?(this._dom.root.appendChild(this._dom.panePlaceholder),this._dom.root.appendChild(this._dom.paneWrapper),this._dom.root.appendChild(this._dom.contentWrapper)):(this._dom.root.appendChild(this._dom.contentWrapper),this._dom.root.appendChild(this._dom.paneWrapper),this._dom.root.appendChild(this._dom.panePlaceholder)));n.paneIsFirst=u;n.isOpenedMode!==this._isOpenedMode&&(this._isOpenedMode?(o.removeClass(this._dom.root,v.paneClosed),o.addClass(this._dom.root,v.paneOpened)):(o.removeClass(this._dom.root,v.paneOpened),o.addClass(this._dom.root,v.paneClosed)));n.isOpenedMode=this._isOpenedMode;n.panePlacement!==this.panePlacement&&(ut(this._dom.root,b[n.panePlacement]),rt(this._dom.root,b[this.panePlacement]),n.panePlacement=this.panePlacement);n.closedDisplayMode!==this.closedDisplayMode&&(ut(this._dom.root,nt[n.closedDisplayMode]),rt(this._dom.root,nt[this.closedDisplayMode]),n.closedDisplayMode=this.closedDisplayMode);n.openedDisplayMode!==this.openedDisplayMode&&(ut(this._dom.root,d[n.openedDisplayMode]),rt(this._dom.root,d[this.openedDisplayMode]),n.openedDisplayMode=this.openedDisplayMode);r=this._isOpenedMode&&this.openedDisplayMode===p.overlay;r?(f=this._getHiddenPaneThickness(),this._horizontal?(t=f.total+"px",i=""):(t="",i=f.total+"px")):(t="",i="");(n.panePlaceholderWidth!==t||n.panePlaceholderHeight!==i)&&(e=this._dom.panePlaceholder.style,e.width=t,e.height=i,n.panePlaceholderWidth=t,n.panePlaceholderHeight=i);n.isOverlayShown!==r&&(r?l.shown(this._dismissable):l.hidden(this._dismissable),n.isOverlayShown=r)},n.ClosedDisplayMode=k,n.OpenedDisplayMode=p,n.PanePlacement=y,n.supportedForProcessing=!0,n._ClassNames=v,n}();t.SplitView=tt;r.Class.mix(tt,h.createEventProperties(g.beforeOpen,g.afterOpen,g.beforeClose,g.afterClose));r.Class.mix(tt,f.DOMEventMixin)}),t("WinJS/Controls/SplitView",["require","exports","../Core/_Base"],function(n,t,i){var r=null;i.Namespace.define("WinJS.UI",{SplitView:{get:function(){return r||n(["./SplitView/_SplitView"],function(n){r=n}),r.SplitView}}})}),t("WinJS/Controls/AppBar/_Constants",["require","exports","../CommandingSurface/_Constants"],function(n,t,i){t.ClassNames={controlCssClass:"win-appbar",disposableCssClass:"win-disposable",actionAreaCssClass:"win-appbar-actionarea",overflowButtonCssClass:"win-appbar-overflowbutton",spacerCssClass:"win-appbar-spacer",ellipsisCssClass:"win-appbar-ellipsis",overflowAreaCssClass:"win-appbar-overflowarea",contentFlyoutCssClass:"win-appbar-contentflyout",emptyappbarCssClass:"win-appbar-empty",menuCssClass:"win-menu",menuContainsToggleCommandClass:"win-menu-containstogglecommand",openedClass:"win-appbar-opened",closedClass:"win-appbar-closed",noneClass:"win-appbar-closeddisplaynone",minimalClass:"win-appbar-closeddisplayminimal",compactClass:"win-appbar-closeddisplaycompact",fullClass:"win-appbar-closeddisplayfull",placementTopClass:"win-appbar-top",placementBottomClass:"win-appbar-bottom"};t.EventNames={beforeOpen:"beforeopen",afterOpen:"afteropen",beforeClose:"beforeclose",afterClose:"afterclose"};t.controlMinWidth=i.controlMinWidth;t.defaultClosedDisplayMode="compact";t.defaultOpened=!1;t.defaultPlacement="bottom";t.typeSeparator="separator";t.typeContent="content";t.typeButton="button";t.typeToggle="toggle";t.typeFlyout="flyout";t.commandSelector=".win-command";t.primaryCommandSection="primary";t.secondaryCommandSection="secondary"}),t("require-style!less/styles-appbar",[],function(){}),t("WinJS/Controls/AppBar/_AppBar",["require","exports","../../Core/_Base","../AppBar/_Constants","../CommandingSurface","../../Utilities/_Control","../../Utilities/_Dispose","../../Utilities/_ElementUtilities","../../Core/_ErrorFromName","../../Core/_Events","../../Core/_Global","../../Utilities/_KeyboardInfo","../../_LightDismissService","../../Promise","../../Core/_Resources","../../Utilities/_OpenCloseMachine","../../Core/_WriteProfilerMark"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){function k(n,t){t&&o.addClass(n,t)}function it(n,t){t&&o.removeClass(n,t)}var b,tt,rt;n(["require-style!less/styles-appbar"]);"use strict";var d=l._KeyboardInfo,ut={get ariaLabel(){return y._getWinJSString("ui/appBarAriaLabel").value},get overflowButtonAriaLabel(){return y._getWinJSString("ui/appBarOverflowButtonAriaLabel").value},get mustContainCommands(){return"The AppBar can only contain WinJS.UI.Command or WinJS.UI.AppBarCommand controls"},get duplicateConstruction(){return"Invalid argument: Controls may only be instantiated one time for each DOM element"}},g={none:"none",minimal:"minimal",compact:"compact",full:"full"},nt={};nt[g.none]=r.ClassNames.noneClass;nt[g.minimal]=r.ClassNames.minimalClass;nt[g.compact]=r.ClassNames.compactClass;nt[g.full]=r.ClassNames.fullClass;b={top:"top",bottom:"bottom"};tt={};tt[b.top]=r.ClassNames.placementTopClass;tt[b.bottom]=r.ClassNames.placementBottomClass;rt=function(){function n(t,i){var e=this,h;if(i===void 0&&(i={}),this._updateDomImpl_renderedState={isOpenedMode:undefined,placement:undefined,closedDisplayMode:undefined,adjustedOffsets:{top:undefined,bottom:undefined}},this._writeProfilerMark("constructor,StartTM"),t&&t.winControl)throw new s("WinJS.UI.AppBar.DuplicateConstruction",ut.duplicateConstruction);this._initializeDom(t||c.document.createElement("div"));h=new p.OpenCloseMachine({eventElement:this.element,onOpen:function(){var t=e._commandingSurface.createOpenAnimation(e._getClosedHeight());return e.element.style.position="fixed",e._placement===n.Placement.top?e.element.style.top=l._KeyboardInfo._layoutViewportCoords.visibleDocTop+"px":e.element.style.bottom=l._KeyboardInfo._layoutViewportCoords.visibleDocBottom+"px",e._synchronousOpen(),t.execute().then(function(){e.element.style.position="";e.element.style.top=e._adjustedOffsets.top;e.element.style.bottom=e._adjustedOffsets.bottom})},onClose:function(){var t=e._commandingSurface.createCloseAnimation(e._getClosedHeight());return e.element.style.position="fixed",e._placement===n.Placement.top?e.element.style.top=l._KeyboardInfo._layoutViewportCoords.visibleDocTop+"px":e.element.style.bottom=l._KeyboardInfo._layoutViewportCoords.visibleDocBottom+"px",t.execute().then(function(){e._synchronousClose();e.element.style.position="";e.element.style.top=e._adjustedOffsets.top;e.element.style.bottom=e._adjustedOffsets.bottom})},onUpdateDom:function(){e._updateDomImpl()},onUpdateDomWithIsOpened:function(n){e._isOpenedMode=n;e._updateDomImpl()}});this._handleShowingKeyboardBound=this._handleShowingKeyboard.bind(this);this._handleHidingKeyboardBound=this._handleHidingKeyboard.bind(this);o._inputPaneListener.addEventListener(this._dom.root,"showing",this._handleShowingKeyboardBound);o._inputPaneListener.addEventListener(this._dom.root,"hiding",this._handleHidingKeyboardBound);this._disposed=!1;this._cachedClosedHeight=null;this._commandingSurface=new u._CommandingSurface(this._dom.commandingSurfaceEl,{openCloseMachine:h});k(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-actionarea"),r.ClassNames.actionAreaCssClass);k(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-overflowarea"),r.ClassNames.overflowAreaCssClass);k(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-overflowbutton"),r.ClassNames.overflowButtonCssClass);k(this._dom.commandingSurfaceEl.querySelector(".win-commandingsurface-ellipsis"),r.ClassNames.ellipsisCssClass);this._isOpenedMode=r.defaultOpened;this._dismissable=new a.LightDismissableElement({element:this._dom.root,tabIndex:this._dom.root.hasAttribute("tabIndex")?this._dom.root.tabIndex:-1,onLightDismiss:function(){e.close()}});this.closedDisplayMode=r.defaultClosedDisplayMode;this.placement=r.defaultPlacement;this.opened=this._isOpenedMode;f.setOptions(this,i);o._inDom(this.element).then(function(){return e._commandingSurface.initialized}).then(function(){h.exitInit();e._writeProfilerMark("constructor,StopTM")})}return Object.defineProperty(n.prototype,"element",{get:function(){return this._dom.root},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._commandingSurface.data},set:function(n){this._commandingSurface.data=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closedDisplayMode",{get:function(){return this._commandingSurface.closedDisplayMode},set:function(n){g[n]&&(this._commandingSurface.closedDisplayMode=n,this._cachedClosedHeight=null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"placement",{get:function(){return this._placement},set:function(n){if(b[n]&&this._placement!==n){this._placement=n;switch(n){case b.top:this._commandingSurface.overflowDirection="bottom";break;case b.bottom:this._commandingSurface.overflowDirection="top"}this._adjustedOffsets=this._computeAdjustedOffsets();this._commandingSurface.deferredDomUpate()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"opened",{get:function(){return this._commandingSurface.opened},set:function(n){this._commandingSurface.opened=n},enumerable:!0,configurable:!0}),n.prototype.open=function(){this._commandingSurface.open()},n.prototype.close=function(){this._commandingSurface.close()},n.prototype.dispose=function(){this._disposed||(this._disposed=!0,a.hidden(this._dismissable),this._commandingSurface.dispose(),o._inputPaneListener.removeEventListener(this._dom.root,"showing",this._handleShowingKeyboardBound),o._inputPaneListener.removeEventListener(this._dom.root,"hiding",this._handleHidingKeyboardBound),e.disposeSubTree(this.element))},n.prototype.forceLayout=function(){this._commandingSurface.forceLayout()},n.prototype.getCommandById=function(n){return this._commandingSurface.getCommandById(n)},n.prototype.showOnlyCommands=function(n){return this._commandingSurface.showOnlyCommands(n)},n.prototype._writeProfilerMark=function(n){w("WinJS.UI.AppBar:"+this._id+":"+n)},n.prototype._initializeDom=function(n){var i,u,t;this._writeProfilerMark("_intializeDom,info");n.winControl=this;this._id=n.id||o._uniqueID(n);o.addClass(n,r.ClassNames.controlCssClass);o.addClass(n,r.ClassNames.disposableCssClass);i=n.getAttribute("role");i||n.setAttribute("role","menubar");u=n.getAttribute("aria-label");u||n.setAttribute("aria-label",ut.ariaLabel);t=document.createElement("DIV");o._reparentChildren(n,t);n.appendChild(t);this._dom={root:n,commandingSurfaceEl:t}},n.prototype._handleShowingKeyboard=function(n){var t=this,i,r;return this._dom.root.contains(c.document.activeElement)&&(i=n.detail.originalEvent,i.ensuredFocusedElementInView=!0),r=d._animationShowLength+d._scrollTimeout,v.timeout(r).then(function(){t._shouldAdjustForShowingKeyboard()&&!t._disposed&&(t._adjustedOffsets=t._computeAdjustedOffsets(),t._commandingSurface.deferredDomUpate())})},n.prototype._shouldAdjustForShowingKeyboard=function(){return d._visible&&!d._isResized},n.prototype._handleHidingKeyboard=function(){this._adjustedOffsets=this._computeAdjustedOffsets();this._commandingSurface.deferredDomUpate()},n.prototype._computeAdjustedOffsets=function(){var n={top:"",bottom:""};return this._placement===b.bottom?n.bottom=d._visibleDocBottomOffset+"px":this._placement===b.top&&(n.top=d._visibleDocTop+"px"),n},n.prototype._synchronousOpen=function(){this._isOpenedMode=!0;this._updateDomImpl()},n.prototype._synchronousClose=function(){this._isOpenedMode=!1;this._updateDomImpl()},n.prototype._updateDomImpl=function(){var n=this._updateDomImpl_renderedState;n.isOpenedMode!==this._isOpenedMode&&(this._isOpenedMode?this._updateDomImpl_renderOpened():this._updateDomImpl_renderClosed(),n.isOpenedMode=this._isOpenedMode);n.placement!==this.placement&&(it(this._dom.root,tt[n.placement]),k(this._dom.root,tt[this.placement]),n.placement=this.placement);n.closedDisplayMode!==this.closedDisplayMode&&(it(this._dom.root,nt[n.closedDisplayMode]),k(this._dom.root,nt[this.closedDisplayMode]),n.closedDisplayMode=this.closedDisplayMode);n.adjustedOffsets.top!==this._adjustedOffsets.top&&(this._dom.root.style.top=this._adjustedOffsets.top,n.adjustedOffsets.top=this._adjustedOffsets.top);n.adjustedOffsets.bottom!==this._adjustedOffsets.bottom&&(this._dom.root.style.bottom=this._adjustedOffsets.bottom,n.adjustedOffsets.bottom=this._adjustedOffsets.bottom);this._commandingSurface.updateDomImpl()},n.prototype._getClosedHeight=function(){if(this._cachedClosedHeight===null){var n=this._isOpenedMode;this._isOpenedMode&&this._synchronousClose();this._cachedClosedHeight=this._commandingSurface.getBoundingRects().commandingSurface.height;n&&this._synchronousOpen()}return this._cachedClosedHeight},n.prototype._updateDomImpl_renderOpened=function(){k(this._dom.root,r.ClassNames.openedClass);it(this._dom.root,r.ClassNames.closedClass);this._commandingSurface.synchronousOpen();a.shown(this._dismissable)},n.prototype._updateDomImpl_renderClosed=function(){k(this._dom.root,r.ClassNames.closedClass);it(this._dom.root,r.ClassNames.openedClass);this._commandingSurface.synchronousClose();a.hidden(this._dismissable)},n.ClosedDisplayMode=g,n.Placement=b,n.supportedForProcessing=!0,n}();t.AppBar=rt;i.Class.mix(rt,h.createEventProperties(r.EventNames.beforeOpen,r.EventNames.afterOpen,r.EventNames.beforeClose,r.EventNames.afterClose));i.Class.mix(rt,f.DOMEventMixin)}),t("WinJS/Controls/AppBar",["require","exports","../Core/_Base"],function(n,t,i){var r=null;i.Namespace.define("WinJS.UI",{AppBar:{get:function(){return r||n(["./AppBar/_AppBar"],function(n){r=n}),r.AppBar}}})}),t("WinJS",["WinJS/Core/_WinJS","WinJS/Core","WinJS/Promise","WinJS/_Signal","WinJS/Scheduler","WinJS/Utilities","WinJS/XYFocus","WinJS/Fragments","WinJS/Application","WinJS/Navigation","WinJS/Animations","WinJS/Binding","WinJS/BindingTemplate","WinJS/BindingList","WinJS/Res","WinJS/Pages","WinJS/ControlProcessor","WinJS/Controls/HtmlControl","WinJS/VirtualizedDataSource","WinJS/Controls/IntrinsicControls","WinJS/Controls/ListView","WinJS/Controls/FlipView","WinJS/Controls/ItemContainer","WinJS/Controls/Repeater","WinJS/Controls/DatePicker","WinJS/Controls/TimePicker","WinJS/Controls/BackButton","WinJS/Controls/Rating","WinJS/Controls/ToggleSwitch","WinJS/Controls/SemanticZoom","WinJS/Controls/Pivot","WinJS/Controls/Hub","WinJS/Controls/Flyout","WinJS/Controls/_LegacyAppBar","WinJS/Controls/MediaPlayer","WinJS/Controls/MediaPlayer/MediaElementAdapter","WinJS/Controls/MediaPlayer/_MediaUI","WinJS/Controls/Menu","WinJS/Controls/SearchBox","WinJS/Controls/SettingsFlyout","WinJS/Controls/NavBar","WinJS/Controls/Tooltip","WinJS/Controls/ViewBox","WinJS/Controls/ContentDialog","WinJS/Controls/SplitView","WinJS/Controls/ToolBar","WinJS/Controls/AppBar",],function(n){"use strict";return n.Namespace.define("WinJS.Utilities",{_require:i,_define:t}),n}),i(["WinJS/Core/_WinJS","WinJS"],function(t){n.WinJS=t}),n.WinJS})})();