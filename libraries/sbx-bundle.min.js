function LokiTridentAdapter(n,t){this.app="loki";this.db=t;typeof n!="undefined"&&(this.app=n);this.catalog=null}function nullFunction(){}function TridentMemoryAdapter(n){var t=this;this.name="memory adapter";this.successCallback=nullFunction;this.errorCallback=nullFunction;n.hasOwnProperty("successCallback")&&(this.successCallback=n.successCallback);n.hasOwnProperty("errorCallback")&&(this.errorCallback=n.errorCallback);this.db=new loki("trident memory");this.kvpColl=this.db.addCollection("kvp");setTimeout(function(){t.successCallback()},1)}function TridentIndexedAdapter(n){this.name="indexedDB";this.db=null;this.upgradeCallback=nullFunction;this.successCallback=nullFunction;this.errorCallback=nullFunction;n.hasOwnProperty("upgradeCallback")&&(this.upgradeCallback=n.upgradeCallback);n.hasOwnProperty("successCallback")&&(this.successCallback=n.successCallback);n.hasOwnProperty("errorCallback")&&(this.errorCallback=n.errorCallback);this.initializeDatabase()}function TridentServiceAdapter(n){this.name="service";this.serviceLocation="";this.successCallback=nullFunction;this.errorCallback=nullFunction;n.hasOwnProperty("serviceLocation")&&(this.serviceLocation=n.serviceLocation);typeof n.successCallback=="function"&&(this.successCallback=n.successCallback);typeof n.errorCallback=="function"&&(this.errorCallback=n.errorCallback);setTimeout(this.successCallback,1)}function TridentList(n,t){this.listSettings={listElementId:n,selectedId:null,clickCallback:t,bright:!1}}function Pool(n){var t=this;this.taskQueue=[];this.workerQueue=[];this.poolSize=n;this.addWorkerTask=function(n){if(t.workerQueue.length>0){var i=t.workerQueue.shift();i.run(n)}else t.taskQueue.push(n)};this.init=function(){for(var i=0;i<n;i++)t.workerQueue.push(new WorkerThread(t))};this.freeWorkerThread=function(n){if(t.taskQueue.length>0){var i=t.taskQueue.shift();n.run(i)}else t.workerQueue.push(n)}}function WorkerThread(n){function i(n){t.workerTask.callback(n);t.parentPool.freeWorkerThread(t)}var t=this;this.parentPool=n;this.workerTask={};this.run=function(n){if(this.workerTask=n,this.workerTask.script!=null){var t=new Worker(n.script);t.addEventListener("message",i,!1);t.postMessage(n.startMessage)}}}function WorkerTask(n,t,i){this.script=n;this.callback=t;this.startMessage=i}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},BABYLON,prettyPrint,saveAs,MemoryStats;!function(n){var tt=function(){function t(n,t,i){void 0===n&&(n=0);void 0===t&&(t=0);void 0===i&&(i=0);this.r=n;this.g=t;this.b=i}return t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},t.prototype.toArray=function(n,t){return void 0===t&&(t=0),n[t]=this.r,n[t+1]=this.g,n[t+2]=this.b,this},t.prototype.toColor4=function(n){return void 0===n&&(n=1),new s(this.r,this.g,this.b,n)},t.prototype.asArray=function(){var n=[];return this.toArray(n,0),n},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(n){return new t(this.r*n.r,this.g*n.g,this.b*n.b)},t.prototype.multiplyToRef=function(n,t){return t.r=this.r*n.r,t.g=this.g*n.g,t.b=this.b*n.b,this},t.prototype.equals=function(n){return n&&this.r===n.r&&this.g===n.g&&this.b===n.b},t.prototype.equalsFloats=function(n,t,i){return this.r===n&&this.g===t&&this.b===i},t.prototype.scale=function(n){return new t(this.r*n,this.g*n,this.b*n)},t.prototype.scaleToRef=function(n,t){return t.r=this.r*n,t.g=this.g*n,t.b=this.b*n,this},t.prototype.add=function(n){return new t(this.r+n.r,this.g+n.g,this.b+n.b)},t.prototype.addToRef=function(n,t){return t.r=this.r+n.r,t.g=this.g+n.g,t.b=this.b+n.b,this},t.prototype.subtract=function(n){return new t(this.r-n.r,this.g-n.g,this.b-n.b)},t.prototype.subtractToRef=function(n,t){return t.r=this.r-n.r,t.g=this.g-n.g,t.b=this.b-n.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(n){return this.r=n.r,this.g=n.g,this.b=n.b,this},t.prototype.copyFromFloats=function(n,t,i){return this.r=n,this.g=t,this.b=i,this},t.prototype.toHexString=function(){var t=255*this.r|0,i=255*this.g|0,r=255*this.b|0;return"#"+n.Tools.ToHex(t)+n.Tools.ToHex(i)+n.Tools.ToHex(r)},t.FromHexString=function(i){if("#"!==i.substring(0,1)||7!==i.length)return n.Tools.Warn("Color3.FromHexString must be called with a string like #FFFFFF"),new t(0,0,0);var r=parseInt(i.substring(1,3),16),u=parseInt(i.substring(3,5),16),f=parseInt(i.substring(5,7),16);return t.FromInts(r,u,f)},t.FromArray=function(n,i){return void 0===i&&(i=0),new t(n[i],n[i+1],n[i+2])},t.FromInts=function(n,i,r){return new t(n/255,i/255,r/255)},t.Lerp=function(n,i,r){var u=n.r+(i.r-n.r)*r,f=n.g+(i.g-n.g)*r,e=n.b+(i.b-n.b)*r;return new t(u,f,e)},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t}(),s,r,t,l,u,i,h,a,v,y,o,p,e,f,c,w,b,k,d,g,nt;n.Color3=tt;s=function(){function t(n,t,i,r){this.r=n;this.g=t;this.b=i;this.a=r}return t.prototype.addInPlace=function(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this.a+=n.a,this},t.prototype.asArray=function(){var n=[];return this.toArray(n,0),n},t.prototype.toArray=function(n,t){return void 0===t&&(t=0),n[t]=this.r,n[t+1]=this.g,n[t+2]=this.b,n[t+3]=this.a,this},t.prototype.add=function(n){return new t(this.r+n.r,this.g+n.g,this.b+n.b,this.a+n.a)},t.prototype.subtract=function(n){return new t(this.r-n.r,this.g-n.g,this.b-n.b,this.a-n.a)},t.prototype.subtractToRef=function(n,t){return t.r=this.r-n.r,t.g=this.g-n.g,t.b=this.b-n.b,t.a=this.a-n.a,this},t.prototype.scale=function(n){return new t(this.r*n,this.g*n,this.b*n,this.a*n)},t.prototype.scaleToRef=function(n,t){return t.r=this.r*n,t.g=this.g*n,t.b=this.b*n,t.a=this.a*n,this},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(n){return this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this},t.prototype.toHexString=function(){var t=255*this.r|0,i=255*this.g|0,r=255*this.b|0,u=255*this.a|0;return"#"+n.Tools.ToHex(t)+n.Tools.ToHex(i)+n.Tools.ToHex(r)+n.Tools.ToHex(u)},t.FromHexString=function(i){if("#"!==i.substring(0,1)||9!==i.length)return n.Tools.Warn("Color4.FromHexString must be called with a string like #FFFFFFFF"),new t(0,0,0,0);var r=parseInt(i.substring(1,3),16),u=parseInt(i.substring(3,5),16),f=parseInt(i.substring(5,7),16),e=parseInt(i.substring(7,9),16);return t.FromInts(r,u,f,e)},t.Lerp=function(n,i,r){var u=new t(0,0,0,0);return t.LerpToRef(n,i,r,u),u},t.LerpToRef=function(n,t,i,r){r.r=n.r+(t.r-n.r)*i;r.g=n.g+(t.g-n.g)*i;r.b=n.b+(t.b-n.b)*i;r.a=n.a+(t.a-n.a)*i},t.FromArray=function(n,i){return void 0===i&&(i=0),new t(n[i],n[i+1],n[i+2],n[i+3])},t.FromInts=function(n,i,r,u){return new t(n/255,i/255,r/255,u/255)},t}();n.Color4=s;r=function(){function t(n,t){this.x=n;this.y=t}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},t.prototype.toArray=function(n,t){return void 0===t&&(t=0),n[t]=this.x,n[t+1]=this.y,this},t.prototype.asArray=function(){var n=[];return this.toArray(n,0),n},t.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this},t.prototype.copyFromFloats=function(n,t){return this.x=n,this.y=t,this},t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.addVector3=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y)},t.prototype.subtractInPlace=function(n){return this.x-=n.x,this.y-=n.y,this},t.prototype.multiplyInPlace=function(n){return this.x*=n.x,this.y*=n.y,this},t.prototype.multiply=function(n){return new t(this.x*n.x,this.y*n.y)},t.prototype.multiplyToRef=function(n,t){return t.x=this.x*n.x,t.y=this.y*n.y,this},t.prototype.multiplyByFloats=function(n,i){return new t(this.x*n,this.y*i)},t.prototype.divide=function(n){return new t(this.x/n.x,this.y/n.y)},t.prototype.divideToRef=function(n,t){return t.x=this.x/n.x,t.y=this.y/n.y,this},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.scaleInPlace=function(n){return this.x*=n,this.y*=n,this},t.prototype.scale=function(n){return new t(this.x*n,this.y*n)},t.prototype.equals=function(n){return n&&this.x===n.x&&this.y===n.y},t.prototype.equalsWithEpsilon=function(t,i){return void 0===i&&(i=n.Engine.Epsilon),t&&n.Tools.WithinEpsilon(this.x,t.x,i)&&n.Tools.WithinEpsilon(this.y,t.y,i)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.length(),n;return 0===t?this:(n=1/t,this.x*=n,this.y*=n,this)},t.prototype.clone=function(){return new t(this.x,this.y)},t.Zero=function(){return new t(0,0)},t.FromArray=function(n,i){return void 0===i&&(i=0),new t(n[i],n[i+1])},t.FromArrayToRef=function(n,t,i){i.x=n[t];i.y=n[t+1]},t.CatmullRom=function(n,i,r,u,f){var e=f*f,o=f*e,s=.5*(2*i.x+(-n.x+r.x)*f+(2*n.x-5*i.x+4*r.x-u.x)*e+(-n.x+3*i.x-3*r.x+u.x)*o),h=.5*(2*i.y+(-n.y+r.y)*f+(2*n.y-5*i.y+4*r.y-u.y)*e+(-n.y+3*i.y-3*r.y+u.y)*o);return new t(s,h)},t.Clamp=function(n,i,r){var f=n.x,u;return f=f>r.x?r.x:f,f=f<i.x?i.x:f,u=n.y,u=u>r.y?r.y:u,u=u<i.y?i.y:u,new t(f,u)},t.Hermite=function(n,i,r,u,f){var e=f*f,o=f*e,s=2*o-3*e+1,h=-2*o+3*e,c=o-2*e+f,l=o-e,a=n.x*s+r.x*h+i.x*c+u.x*l,v=n.y*s+r.y*h+i.y*c+u.y*l;return new t(a,v)},t.Lerp=function(n,i,r){var u=n.x+(i.x-n.x)*r,f=n.y+(i.y-n.y)*r;return new t(u,f)},t.Dot=function(n,t){return n.x*t.x+n.y*t.y},t.Normalize=function(n){var t=n.clone();return t.normalize(),t},t.Minimize=function(n,i){var r=n.x<i.x?n.x:i.x,u=n.y<i.y?n.y:i.y;return new t(r,u)},t.Maximize=function(n,i){var r=n.x>i.x?n.x:i.x,u=n.y>i.y?n.y:i.y;return new t(r,u)},t.Transform=function(n,i){var r=n.x*i.m[0]+n.y*i.m[4],u=n.x*i.m[1]+n.y*i.m[5];return new t(r,u)},t.Distance=function(n,i){return Math.sqrt(t.DistanceSquared(n,i))},t.DistanceSquared=function(n,t){var i=n.x-t.x,r=n.y-t.y;return i*i+r*r},t}();n.Vector2=r;t=function(){function t(n,t,i){this.x=n;this.y=t;this.z=i}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"}"},t.prototype.asArray=function(){var n=[];return this.toArray(n,0),n},t.prototype.toArray=function(n,t){return void 0===t&&(t=0),n[t]=this.x,n[t+1]=this.y,n[t+2]=this.z,this},t.prototype.toQuaternion=function(){var n=new u(0,0,0,1),r=Math.cos(.5*(this.x+this.z)),f=Math.sin(.5*(this.x+this.z)),e=Math.cos(.5*(this.z-this.x)),o=Math.sin(.5*(this.z-this.x)),t=Math.cos(.5*this.y),i=Math.sin(.5*this.y);return n.x=e*i,n.y=-o*i,n.z=f*t,n.w=r*t,n},t.prototype.addInPlace=function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this},t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y,this.z+n.z)},t.prototype.addToRef=function(n,t){return t.x=this.x+n.x,t.y=this.y+n.y,t.z=this.z+n.z,this},t.prototype.subtractInPlace=function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this},t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y,this.z-n.z)},t.prototype.subtractToRef=function(n,t){return t.x=this.x-n.x,t.y=this.y-n.y,t.z=this.z-n.z,this},t.prototype.subtractFromFloats=function(n,i,r){return new t(this.x-n,this.y-i,this.z-r)},t.prototype.subtractFromFloatsToRef=function(n,t,i,r){return r.x=this.x-n,r.y=this.y-t,r.z=this.z-i,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.scaleInPlace=function(n){return this.x*=n,this.y*=n,this.z*=n,this},t.prototype.scale=function(n){return new t(this.x*n,this.y*n,this.z*n)},t.prototype.scaleToRef=function(n,t){t.x=this.x*n;t.y=this.y*n;t.z=this.z*n},t.prototype.equals=function(n){return n&&this.x===n.x&&this.y===n.y&&this.z===n.z},t.prototype.equalsWithEpsilon=function(t,i){return void 0===i&&(i=n.Engine.Epsilon),t&&n.Tools.WithinEpsilon(this.x,t.x,i)&&n.Tools.WithinEpsilon(this.y,t.y,i)&&n.Tools.WithinEpsilon(this.z,t.z,i)},t.prototype.equalsToFloats=function(n,t,i){return this.x===n&&this.y===t&&this.z===i},t.prototype.multiplyInPlace=function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this},t.prototype.multiply=function(n){return new t(this.x*n.x,this.y*n.y,this.z*n.z)},t.prototype.multiplyToRef=function(n,t){return t.x=this.x*n.x,t.y=this.y*n.y,t.z=this.z*n.z,this},t.prototype.multiplyByFloats=function(n,i,r){return new t(this.x*n,this.y*i,this.z*r)},t.prototype.divide=function(n){return new t(this.x/n.x,this.y/n.y,this.z/n.z)},t.prototype.divideToRef=function(n,t){return t.x=this.x/n.x,t.y=this.y/n.y,t.z=this.z/n.z,this},t.prototype.MinimizeInPlace=function(n){return n.x<this.x&&(this.x=n.x),n.y<this.y&&(this.y=n.y),n.z<this.z&&(this.z=n.z),this},t.prototype.MaximizeInPlace=function(n){return n.x>this.x&&(this.x=n.x),n.y>this.y&&(this.y=n.y),n.z>this.z&&(this.z=n.z),this},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalize=function(){var t=this.length(),n;return 0===t||1===t?this:(n=1/t,this.x*=n,this.y*=n,this.z*=n,this)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this},t.prototype.copyFromFloats=function(n,t,i){return this.x=n,this.y=t,this.z=i,this},t.GetClipFactor=function(n,i,r,u){var f=t.Dot(n,r)-u,e=t.Dot(i,r)-u;return f/(f-e)},t.FromArray=function(n,i){return i||(i=0),new t(n[i],n[i+1],n[i+2])},t.FromFloatArray=function(n,i){return i||(i=0),new t(n[i],n[i+1],n[i+2])},t.FromArrayToRef=function(n,t,i){i.x=n[t];i.y=n[t+1];i.z=n[t+2]},t.FromFloatArrayToRef=function(n,t,i){i.x=n[t];i.y=n[t+1];i.z=n[t+2]},t.FromFloatsToRef=function(n,t,i,r){r.x=n;r.y=t;r.z=i},t.Zero=function(){return new t(0,0,0)},t.Up=function(){return new t(0,1,0)},t.TransformCoordinates=function(n,i){var r=t.Zero();return t.TransformCoordinatesToRef(n,i,r),r},t.TransformCoordinatesToRef=function(n,t,i){var u=n.x*t.m[0]+n.y*t.m[4]+n.z*t.m[8]+t.m[12],f=n.x*t.m[1]+n.y*t.m[5]+n.z*t.m[9]+t.m[13],e=n.x*t.m[2]+n.y*t.m[6]+n.z*t.m[10]+t.m[14],r=n.x*t.m[3]+n.y*t.m[7]+n.z*t.m[11]+t.m[15];i.x=u/r;i.y=f/r;i.z=e/r},t.TransformCoordinatesFromFloatsToRef=function(n,t,i,r,u){var e=n*r.m[0]+t*r.m[4]+i*r.m[8]+r.m[12],o=n*r.m[1]+t*r.m[5]+i*r.m[9]+r.m[13],s=n*r.m[2]+t*r.m[6]+i*r.m[10]+r.m[14],f=n*r.m[3]+t*r.m[7]+i*r.m[11]+r.m[15];u.x=e/f;u.y=o/f;u.z=s/f},t.TransformCoordinatesToRefSIMD=function(n,t,i){var u=SIMD.float32x4.loadXYZ(n._data,0),f=SIMD.float32x4.load(t.m,0),e=SIMD.float32x4.load(t.m,4),o=SIMD.float32x4.load(t.m,8),s=SIMD.float32x4.load(t.m,12),r=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,0,0,0,0),f),SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,1,1,1,1),e)),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,2,2,2,2),o),s));r=SIMD.float32x4.div(r,SIMD.float32x4.swizzle(r,3,3,3,3));SIMD.float32x4.storeXYZ(i._data,0,r)},t.TransformCoordinatesFromFloatsToRefSIMD=function(n,t,i,r,u){var e=SIMD.float32x4.splat(n),o=SIMD.float32x4.splat(t),s=SIMD.float32x4.splat(i),h=SIMD.float32x4.load(r.m,0),c=SIMD.float32x4.load(r.m,4),l=SIMD.float32x4.load(r.m,8),a=SIMD.float32x4.load(r.m,12),f=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(e,h),SIMD.float32x4.mul(o,c)),SIMD.float32x4.add(SIMD.float32x4.mul(s,l),a));f=SIMD.float32x4.div(f,SIMD.float32x4.swizzle(f,3,3,3,3));SIMD.float32x4.storeXYZ(u._data,0,f)},t.TransformNormal=function(n,i){var r=t.Zero();return t.TransformNormalToRef(n,i,r),r},t.TransformNormalToRef=function(n,t,i){i.x=n.x*t.m[0]+n.y*t.m[4]+n.z*t.m[8];i.y=n.x*t.m[1]+n.y*t.m[5]+n.z*t.m[9];i.z=n.x*t.m[2]+n.y*t.m[6]+n.z*t.m[10]},t.TransformNormalFromFloatsToRef=function(n,t,i,r,u){u.x=n*r.m[0]+t*r.m[4]+i*r.m[8];u.y=n*r.m[1]+t*r.m[5]+i*r.m[9];u.z=n*r.m[2]+t*r.m[6]+i*r.m[10]},t.CatmullRom=function(n,i,r,u,f){var e=f*f,o=f*e,s=.5*(2*i.x+(-n.x+r.x)*f+(2*n.x-5*i.x+4*r.x-u.x)*e+(-n.x+3*i.x-3*r.x+u.x)*o),h=.5*(2*i.y+(-n.y+r.y)*f+(2*n.y-5*i.y+4*r.y-u.y)*e+(-n.y+3*i.y-3*r.y+u.y)*o),c=.5*(2*i.z+(-n.z+r.z)*f+(2*n.z-5*i.z+4*r.z-u.z)*e+(-n.z+3*i.z-3*r.z+u.z)*o);return new t(s,h,c)},t.Clamp=function(n,i,r){var e=n.x,u,f;return e=e>r.x?r.x:e,e=e<i.x?i.x:e,u=n.y,u=u>r.y?r.y:u,u=u<i.y?i.y:u,f=n.z,f=f>r.z?r.z:f,f=f<i.z?i.z:f,new t(e,u,f)},t.Hermite=function(n,i,r,u,f){var e=f*f,o=f*e,s=2*o-3*e+1,h=-2*o+3*e,c=o-2*e+f,l=o-e,a=n.x*s+r.x*h+i.x*c+u.x*l,v=n.y*s+r.y*h+i.y*c+u.y*l,y=n.z*s+r.z*h+i.z*c+u.z*l;return new t(a,v,y)},t.Lerp=function(n,i,r){var u=n.x+(i.x-n.x)*r,f=n.y+(i.y-n.y)*r,e=n.z+(i.z-n.z)*r;return new t(u,f,e)},t.Dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},t.Cross=function(n,i){var r=t.Zero();return t.CrossToRef(n,i,r),r},t.CrossToRef=function(n,t,i){i.x=n.y*t.z-n.z*t.y;i.y=n.z*t.x-n.x*t.z;i.z=n.x*t.y-n.y*t.x},t.Normalize=function(n){var i=t.Zero();return t.NormalizeToRef(n,i),i},t.NormalizeToRef=function(n,t){t.copyFrom(n);t.normalize()},t.Project=function(n,r,u,f){var e=f.width,o=f.height,s=f.x,h=f.y,c=i.FromValues(e/2,0,0,0,0,-o/2,0,0,0,0,1,0,s+e/2,o/2+h,0,1),l=r.multiply(u).multiply(c);return t.TransformCoordinates(n,l)},t.UnprojectFromTransform=function(i,r,u,f,e){var o=f.multiply(e),s,h;return o.invert(),i.x=i.x/r*2-1,i.y=-(i.y/u*2-1),s=t.TransformCoordinates(i,o),h=i.x*o.m[3]+i.y*o.m[7]+i.z*o.m[11]+o.m[15],n.Tools.WithinEpsilon(h,1)&&(s=s.scale(1/h)),s},t.Unproject=function(i,r,u,f,e,o){var s=f.multiply(e).multiply(o);s.invert();var h=new t(i.x/r*2-1,-(i.y/u*2-1),i.z),c=t.TransformCoordinates(h,s),l=h.x*s.m[3]+h.y*s.m[7]+h.z*s.m[11]+s.m[15];return n.Tools.WithinEpsilon(l,1)&&(c=c.scale(1/l)),c},t.Minimize=function(n,t){var i=n.clone();return i.MinimizeInPlace(t),i},t.Maximize=function(n,t){var i=n.clone();return i.MaximizeInPlace(t),i},t.Distance=function(n,i){return Math.sqrt(t.DistanceSquared(n,i))},t.DistanceSquared=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.z-t.z;return i*i+r*r+u*u},t.Center=function(n,t){var i=n.add(t);return i.scaleInPlace(.5),i},t.RotationFromAxis=function(n,i,r){var u=t.Zero();return t.RotationFromAxisToRef(n,i,r,u),u},t.RotationFromAxisToRef=function(i,r,u,f){var c,e,b,rt=t.Normalize(i),l=t.Normalize(u),nt=o.X,ut=o.Y,k=0,d=0,g=0,v=0,tt=0,p=0,h=0,a=-1,it=0,s=0,y,w;n.Tools.WithinEpsilon(l.z,0,n.Engine.Epsilon)?p=1:n.Tools.WithinEpsilon(l.x,0,n.Engine.Epsilon)?v=1:(h=l.z/l.x,v=-h*Math.sqrt(1/(1+h*h)),p=Math.sqrt(1/(1+h*h)));e=new t(v,tt,p);e.normalize();b=t.Cross(l,e);b.normalize();c=t.Cross(rt,e);c.normalize();t.Dot(l,c)<0&&(a=1);s=t.Dot(rt,e);s=Math.min(1,Math.max(-1,s));g=Math.acos(s)*a;t.Dot(e,nt)<0&&(g=Math.PI+g,e=e.scaleInPlace(-1),b=b.scaleInPlace(-1),it++);v=0;tt=0;p=0;a=-1;n.Tools.WithinEpsilon(l.z,0,n.Engine.Epsilon)?v=1:(h=e.z/e.x,v=-h*Math.sqrt(1/(1+h*h)),p=Math.sqrt(1/(1+h*h)));y=new t(v,tt,p);y.normalize();w=t.Cross(y,e);w.normalize();c=t.Cross(l,y);c.normalize();t.Dot(e,c)<0&&(a=1);s=t.Dot(l,y);s=Math.min(1,Math.max(-1,s));d=Math.acos(s)*a;t.Dot(w,ut)<0&&(d=Math.PI+d,w=w.scaleInPlace(-1),y=y.scaleInPlace(-1),it++);a=-1;c=t.Cross(nt,e);c.normalize();t.Dot(c,ut)<0&&(a=1);s=t.Dot(e,nt);s=Math.min(1,Math.max(-1,s));k=-Math.acos(s)*a;0>s&&2>it&&(k=Math.PI+k);f.x=d;f.y=k;f.z=g},t}();n.Vector3=t;l=function(){function t(n,t,i,r){this.x=n;this.y=t;this.z=i;this.w=r}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"W:"+this.w+"}"},t.prototype.asArray=function(){var n=[];return this.toArray(n,0),n},t.prototype.toArray=function(n,t){return void 0===t&&(t=0),n[t]=this.x,n[t+1]=this.y,n[t+2]=this.z,n[t+3]=this.w,this},t.prototype.addInPlace=function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this.w+=n.w,this},t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y,this.z+n.z,this.w+n.w)},t.prototype.addToRef=function(n,t){return t.x=this.x+n.x,t.y=this.y+n.y,t.z=this.z+n.z,t.w=this.w+n.w,this},t.prototype.subtractInPlace=function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this},t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y,this.z-n.z,this.w-n.w)},t.prototype.subtractToRef=function(n,t){return t.x=this.x-n.x,t.y=this.y-n.y,t.z=this.z-n.z,t.w=this.w-n.w,this},t.prototype.subtractFromFloats=function(n,i,r,u){return new t(this.x-n,this.y-i,this.z-r,this.w-u)},t.prototype.subtractFromFloatsToRef=function(n,t,i,r,u){return u.x=this.x-n,u.y=this.y-t,u.z=this.z-i,u.w=this.w-r,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.scaleInPlace=function(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this},t.prototype.scale=function(n){return new t(this.x*n,this.y*n,this.z*n,this.w*n)},t.prototype.scaleToRef=function(n,t){t.x=this.x*n;t.y=this.y*n;t.z=this.z*n;t.w=this.w*n},t.prototype.equals=function(n){return n&&this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w},t.prototype.equalsWithEpsilon=function(t,i){return void 0===i&&(i=n.Engine.Epsilon),t&&n.Tools.WithinEpsilon(this.x,t.x,i)&&n.Tools.WithinEpsilon(this.y,t.y,i)&&n.Tools.WithinEpsilon(this.z,t.z,i)&&n.Tools.WithinEpsilon(this.w,t.w,i)},t.prototype.equalsToFloats=function(n,t,i,r){return this.x===n&&this.y===t&&this.z===i&&this.w===r},t.prototype.multiplyInPlace=function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this.w*=n.w,this},t.prototype.multiply=function(n){return new t(this.x*n.x,this.y*n.y,this.z*n.z,this.w*n.w)},t.prototype.multiplyToRef=function(n,t){return t.x=this.x*n.x,t.y=this.y*n.y,t.z=this.z*n.z,t.w=this.w*n.w,this},t.prototype.multiplyByFloats=function(n,i,r,u){return new t(this.x*n,this.y*i,this.z*r,this.w*u)},t.prototype.divide=function(n){return new t(this.x/n.x,this.y/n.y,this.z/n.z,this.w/n.w)},t.prototype.divideToRef=function(n,t){return t.x=this.x/n.x,t.y=this.y/n.y,t.z=this.z/n.z,t.w=this.w/n.w,this},t.prototype.MinimizeInPlace=function(n){return n.x<this.x&&(this.x=n.x),n.y<this.y&&(this.y=n.y),n.z<this.z&&(this.z=n.z),n.w<this.w&&(this.w=n.w),this},t.prototype.MaximizeInPlace=function(n){return n.x>this.x&&(this.x=n.x),n.y>this.y&&(this.y=n.y),n.z>this.z&&(this.z=n.z),n.w>this.w&&(this.w=n.w),this},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var t=this.length(),n;return 0===t?this:(n=1/t,this.x*=n,this.y*=n,this.z*=n,this.w*=n,this)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w,this},t.prototype.copyFromFloats=function(n,t,i,r){return this.x=n,this.y=t,this.z=i,this.w=r,this},t.FromArray=function(n,i){return i||(i=0),new t(n[i],n[i+1],n[i+2],n[i+3])},t.FromArrayToRef=function(n,t,i){i.x=n[t];i.y=n[t+1];i.z=n[t+2];i.w=n[t+3]},t.FromFloatArrayToRef=function(n,t,i){i.x=n[t];i.y=n[t+1];i.z=n[t+2];i.w=n[t+3]},t.FromFloatsToRef=function(n,t,i,r,u){u.x=n;u.y=t;u.z=i;u.w=r},t.Zero=function(){return new t(0,0,0,0)},t.Normalize=function(n){var i=t.Zero();return t.NormalizeToRef(n,i),i},t.NormalizeToRef=function(n,t){t.copyFrom(n);t.normalize()},t.Minimize=function(n,t){var i=n.clone();return i.MinimizeInPlace(t),i},t.Maximize=function(n,t){var i=n.clone();return i.MaximizeInPlace(t),i},t.Distance=function(n,i){return Math.sqrt(t.DistanceSquared(n,i))},t.DistanceSquared=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.z-t.z,f=n.w-t.w;return i*i+r*r+u*u+f*f},t.Center=function(n,t){var i=n.add(t);return i.scaleInPlace(.5),i},t}();n.Vector4=l;u=function(){function n(n,t,i,r){void 0===n&&(n=0);void 0===t&&(t=0);void 0===i&&(i=0);void 0===r&&(r=1);this.x=n;this.y=t;this.z=i;this.w=r}return n.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},n.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},n.prototype.equals=function(n){return n&&this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)},n.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w,this},n.prototype.copyFromFloats=function(n,t,i,r){return this.x=n,this.y=t,this.z=i,this.w=r,this},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},n.prototype.scale=function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},n.prototype.multiply=function(t){var i=new n(0,0,0,1);return this.multiplyToRef(t,i),i},n.prototype.multiplyToRef=function(n,t){var i=this.x*n.w+this.y*n.z-this.z*n.y+this.w*n.x,r=-this.x*n.z+this.y*n.w+this.z*n.x+this.w*n.y,u=this.x*n.y-this.y*n.x+this.z*n.w+this.w*n.z,f=-this.x*n.x-this.y*n.y-this.z*n.z+this.w*n.w;return t.copyFromFloats(i,r,u,f),this},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},n.prototype.normalize=function(){var n=1/this.length();return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this},n.prototype.toEulerAngles=function(){var n=t.Zero();return this.toEulerAnglesToRef(n),n},n.prototype.toEulerAnglesToRef=function(n){var i=this.x,r=this.y,t=this.z,f=this.w,o=i*r,s=i*t,h=f*r,c=f*t,l=f*i,a=r*t,v=i*i,e=r*r,u=v+e;return 0!==u&&1!==u?(n.x=Math.atan2(s+h,l-a),n.y=Math.acos(1-2*u),n.z=Math.atan2(s-h,l+a)):0===u?(n.x=0,n.y=0,n.z=Math.atan2(o-c,.5-e-t*t)):(n.x=Math.atan2(o-c,.5-e-t*t),n.y=Math.PI,n.z=0),this},n.prototype.toRotationMatrix=function(n){var t=this.x*this.x,i=this.y*this.y,r=this.z*this.z,u=this.x*this.y,f=this.z*this.w,e=this.z*this.x,o=this.y*this.w,s=this.y*this.z,h=this.x*this.w;return n.m[0]=1-2*(i+r),n.m[1]=2*(u+f),n.m[2]=2*(e-o),n.m[3]=0,n.m[4]=2*(u-f),n.m[5]=1-2*(r+t),n.m[6]=2*(s+h),n.m[7]=0,n.m[8]=2*(e+o),n.m[9]=2*(s-h),n.m[10]=1-2*(i+t),n.m[11]=0,n.m[12]=0,n.m[13]=0,n.m[14]=0,n.m[15]=1,this},n.prototype.fromRotationMatrix=function(t){return n.FromRotationMatrixToRef(t,this),this},n.FromRotationMatrix=function(t){var i=new n;return n.FromRotationMatrixToRef(t,i),i},n.FromRotationMatrixToRef=function(n,t){var i,r=n.m,u=r[0],o=r[4],s=r[8],h=r[1],f=r[5],c=r[9],l=r[2],a=r[6],e=r[10],v=u+f+e;v>0?(i=.5/Math.sqrt(v+1),t.w=.25/i,t.x=(a-c)*i,t.y=(s-l)*i,t.z=(h-o)*i):u>f&&u>e?(i=2*Math.sqrt(1+u-f-e),t.w=(a-c)/i,t.x=.25*i,t.y=(o+h)/i,t.z=(s+l)/i):f>e?(i=2*Math.sqrt(1+f-u-e),t.w=(s-l)/i,t.x=(o+h)/i,t.y=.25*i,t.z=(c+a)/i):(i=2*Math.sqrt(1+e-u-f),t.w=(h-o)/i,t.x=(s+l)/i,t.y=(c+a)/i,t.z=.25*i)},n.Inverse=function(t){return new n(-t.x,-t.y,-t.z,t.w)},n.Identity=function(){return new n(0,0,0,1)},n.RotationAxis=function(t,i){var r=new n,u=Math.sin(i/2);return r.w=Math.cos(i/2),r.x=t.x*u,r.y=t.y*u,r.z=t.z*u,r},n.FromArray=function(t,i){return i||(i=0),new n(t[i],t[i+1],t[i+2],t[i+3])},n.RotationYawPitchRoll=function(t,i,r){var u=new n;return n.RotationYawPitchRollToRef(t,i,r,u),u},n.RotationYawPitchRollToRef=function(n,t,i,r){var c=.5*i,l=.5*t,a=.5*n,u=Math.sin(c),f=Math.cos(c),e=Math.sin(l),o=Math.cos(l),s=Math.sin(a),h=Math.cos(a);r.x=h*e*f+s*o*u;r.y=s*o*f-h*e*u;r.z=h*o*u-s*e*f;r.w=h*o*f+s*e*u},n.RotationAlphaBetaGamma=function(t,i,r){var u=new n;return n.RotationAlphaBetaGammaToRef(t,i,r,u),u},n.RotationAlphaBetaGammaToRef=function(n,t,i,r){var f=.5*(i+n),e=.5*(i-n),u=.5*t;r.x=Math.cos(e)*Math.sin(u);r.y=Math.sin(e)*Math.sin(u);r.z=Math.sin(f)*Math.cos(u);r.w=Math.cos(f)*Math.cos(u)},n.Slerp=function(t,i,r){var u,f,e=r,o=t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w,c=!1,s,h;return(0>o&&(c=!0,o=-o),o>.999999)?(f=1-e,u=c?-e:e):(s=Math.acos(o),h=1/Math.sin(s),f=Math.sin((1-e)*s)*h,u=c?-Math.sin(e*s)*h:Math.sin(e*s)*h),new n(f*t.x+u*i.x,f*t.y+u*i.y,f*t.z+u*i.z,f*t.w+u*i.w)},n}();n.Quaternion=u;i=function(){function i(){this.m=new Float32Array(16)}return i.prototype.isIdentity=function(){return 1!==this.m[0]||1!==this.m[5]||1!==this.m[10]||1!==this.m[15]?!1:0!==this.m[1]||0!==this.m[2]||0!==this.m[3]||0!==this.m[4]||0!==this.m[6]||0!==this.m[7]||0!==this.m[8]||0!==this.m[9]||0!==this.m[11]||0!==this.m[12]||0!==this.m[13]||0!==this.m[14]?!1:!0},i.prototype.determinant=function(){var n=this.m[10]*this.m[15]-this.m[11]*this.m[14],t=this.m[9]*this.m[15]-this.m[11]*this.m[13],i=this.m[9]*this.m[14]-this.m[10]*this.m[13],r=this.m[8]*this.m[15]-this.m[11]*this.m[12],u=this.m[8]*this.m[14]-this.m[10]*this.m[12],f=this.m[8]*this.m[13]-this.m[9]*this.m[12];return this.m[0]*(this.m[5]*n-this.m[6]*t+this.m[7]*i)-this.m[1]*(this.m[4]*n-this.m[6]*r+this.m[7]*u)+this.m[2]*(this.m[4]*t-this.m[5]*r+this.m[7]*f)-this.m[3]*(this.m[4]*i-this.m[5]*u+this.m[6]*f)},i.prototype.toArray=function(){return this.m},i.prototype.asArray=function(){return this.toArray()},i.prototype.invert=function(){return this.invertToRef(this),this},i.prototype.reset=function(){for(var n=0;16>n;n++)this.m[n]=0;return this},i.prototype.add=function(n){var t=new i;return this.addToRef(n,t),t},i.prototype.addToRef=function(n,t){for(var i=0;16>i;i++)t.m[i]=this.m[i]+n.m[i];return this},i.prototype.addToSelf=function(n){for(var t=0;16>t;t++)this.m[t]+=n.m[t];return this},i.prototype.invertToRef=function(n){var i=this.m[0],r=this.m[1],u=this.m[2],f=this.m[3],e=this.m[4],o=this.m[5],s=this.m[6],h=this.m[7],c=this.m[8],l=this.m[9],a=this.m[10],v=this.m[11],y=this.m[12],p=this.m[13],w=this.m[14],b=this.m[15],k=a*b-v*w,d=l*b-v*p,g=l*w-a*p,nt=c*b-v*y,tt=c*w-a*y,it=c*p-l*y,rt=o*k-s*d+h*g,ut=-(e*k-s*nt+h*tt),ft=e*d-o*nt+h*it,et=-(e*g-o*tt+s*it),t=1/(i*rt+r*ut+u*ft+f*et),ot=s*b-h*w,st=o*b-h*p,ht=o*w-s*p,ct=e*b-h*y,lt=e*w-s*y,at=e*p-o*y,vt=s*v-h*a,yt=o*v-h*l,pt=o*a-s*l,wt=e*v-h*c,bt=e*a-s*c,kt=e*l-o*c;return n.m[0]=rt*t,n.m[4]=ut*t,n.m[8]=ft*t,n.m[12]=et*t,n.m[1]=-(r*k-u*d+f*g)*t,n.m[5]=(i*k-u*nt+f*tt)*t,n.m[9]=-(i*d-r*nt+f*it)*t,n.m[13]=(i*g-r*tt+u*it)*t,n.m[2]=(r*ot-u*st+f*ht)*t,n.m[6]=-(i*ot-u*ct+f*lt)*t,n.m[10]=(i*st-r*ct+f*at)*t,n.m[14]=-(i*ht-r*lt+u*at)*t,n.m[3]=-(r*vt-u*yt+f*pt)*t,n.m[7]=(i*vt-u*wt+f*bt)*t,n.m[11]=-(i*yt-r*wt+f*kt)*t,n.m[15]=(i*pt-r*bt+u*kt)*t,this},i.prototype.invertToRefSIMD=function(n){var c,o,h,s,t,e,i,r,u,f,l=this.m,a=n.m,v=SIMD.float32x4.load(l,0),y=SIMD.float32x4.load(l,4),p=SIMD.float32x4.load(l,8),w=SIMD.float32x4.load(l,12);return t=SIMD.float32x4.shuffle(v,y,0,1,4,5),o=SIMD.float32x4.shuffle(p,w,0,1,4,5),c=SIMD.float32x4.shuffle(t,o,0,2,4,6),o=SIMD.float32x4.shuffle(o,t,1,3,5,7),t=SIMD.float32x4.shuffle(v,y,2,3,6,7),s=SIMD.float32x4.shuffle(p,w,2,3,6,7),h=SIMD.float32x4.shuffle(t,s,0,2,4,6),s=SIMD.float32x4.shuffle(s,t,1,3,5,7),t=SIMD.float32x4.mul(h,s),t=SIMD.float32x4.swizzle(t,1,0,3,2),e=SIMD.float32x4.mul(o,t),i=SIMD.float32x4.mul(c,t),t=SIMD.float32x4.swizzle(t,2,3,0,1),e=SIMD.float32x4.sub(SIMD.float32x4.mul(o,t),e),i=SIMD.float32x4.sub(SIMD.float32x4.mul(c,t),i),i=SIMD.float32x4.swizzle(i,2,3,0,1),t=SIMD.float32x4.mul(o,h),t=SIMD.float32x4.swizzle(t,1,0,3,2),e=SIMD.float32x4.add(SIMD.float32x4.mul(s,t),e),u=SIMD.float32x4.mul(c,t),t=SIMD.float32x4.swizzle(t,2,3,0,1),e=SIMD.float32x4.sub(e,SIMD.float32x4.mul(s,t)),u=SIMD.float32x4.sub(SIMD.float32x4.mul(c,t),u),u=SIMD.float32x4.swizzle(u,2,3,0,1),t=SIMD.float32x4.mul(SIMD.float32x4.swizzle(o,2,3,0,1),s),t=SIMD.float32x4.swizzle(t,1,0,3,2),h=SIMD.float32x4.swizzle(h,2,3,0,1),e=SIMD.float32x4.add(SIMD.float32x4.mul(h,t),e),r=SIMD.float32x4.mul(c,t),t=SIMD.float32x4.swizzle(t,2,3,0,1),e=SIMD.float32x4.sub(e,SIMD.float32x4.mul(h,t)),r=SIMD.float32x4.sub(SIMD.float32x4.mul(c,t),r),r=SIMD.float32x4.swizzle(r,2,3,0,1),t=SIMD.float32x4.mul(c,o),t=SIMD.float32x4.swizzle(t,1,0,3,2),r=SIMD.float32x4.add(SIMD.float32x4.mul(s,t),r),u=SIMD.float32x4.sub(SIMD.float32x4.mul(h,t),u),t=SIMD.float32x4.swizzle(t,2,3,0,1),r=SIMD.float32x4.sub(SIMD.float32x4.mul(s,t),r),u=SIMD.float32x4.sub(u,SIMD.float32x4.mul(h,t)),t=SIMD.float32x4.mul(c,s),t=SIMD.float32x4.swizzle(t,1,0,3,2),i=SIMD.float32x4.sub(i,SIMD.float32x4.mul(h,t)),r=SIMD.float32x4.add(SIMD.float32x4.mul(o,t),r),t=SIMD.float32x4.swizzle(t,2,3,0,1),i=SIMD.float32x4.add(SIMD.float32x4.mul(h,t),i),r=SIMD.float32x4.sub(r,SIMD.float32x4.mul(o,t)),t=SIMD.float32x4.mul(c,h),t=SIMD.float32x4.swizzle(t,1,0,3,2),i=SIMD.float32x4.add(SIMD.float32x4.mul(s,t),i),u=SIMD.float32x4.sub(u,SIMD.float32x4.mul(o,t)),t=SIMD.float32x4.swizzle(t,2,3,0,1),i=SIMD.float32x4.sub(i,SIMD.float32x4.mul(s,t)),u=SIMD.float32x4.add(SIMD.float32x4.mul(o,t),u),f=SIMD.float32x4.mul(c,e),f=SIMD.float32x4.add(SIMD.float32x4.swizzle(f,2,3,0,1),f),f=SIMD.float32x4.add(SIMD.float32x4.swizzle(f,1,0,3,2),f),t=SIMD.float32x4.reciprocalApproximation(f),f=SIMD.float32x4.sub(SIMD.float32x4.add(t,t),SIMD.float32x4.mul(f,SIMD.float32x4.mul(t,t))),f=SIMD.float32x4.swizzle(f,0,0,0,0),e=SIMD.float32x4.mul(f,e),i=SIMD.float32x4.mul(f,i),r=SIMD.float32x4.mul(f,r),u=SIMD.float32x4.mul(f,u),SIMD.float32x4.store(a,0,e),SIMD.float32x4.store(a,4,i),SIMD.float32x4.store(a,8,r),SIMD.float32x4.store(a,12,u),this},i.prototype.setTranslation=function(n){return this.m[12]=n.x,this.m[13]=n.y,this.m[14]=n.z,this},i.prototype.multiply=function(n){var t=new i;return this.multiplyToRef(n,t),t},i.prototype.copyFrom=function(n){for(var t=0;16>t;t++)this.m[t]=n.m[t];return this},i.prototype.copyToArray=function(n,t){void 0===t&&(t=0);for(var i=0;16>i;i++)n[t+i]=this.m[i];return this},i.prototype.multiplyToRef=function(n,t){return this.multiplyToArray(n,t.m,0),this},i.prototype.multiplyToArray=function(n,t,i){var r=this.m[0],u=this.m[1],f=this.m[2],e=this.m[3],o=this.m[4],s=this.m[5],h=this.m[6],c=this.m[7],l=this.m[8],a=this.m[9],v=this.m[10],y=this.m[11],p=this.m[12],w=this.m[13],b=this.m[14],k=this.m[15],d=n.m[0],g=n.m[1],nt=n.m[2],tt=n.m[3],it=n.m[4],rt=n.m[5],ut=n.m[6],ft=n.m[7],et=n.m[8],ot=n.m[9],st=n.m[10],ht=n.m[11],ct=n.m[12],lt=n.m[13],at=n.m[14],vt=n.m[15];return t[i]=r*d+u*it+f*et+e*ct,t[i+1]=r*g+u*rt+f*ot+e*lt,t[i+2]=r*nt+u*ut+f*st+e*at,t[i+3]=r*tt+u*ft+f*ht+e*vt,t[i+4]=o*d+s*it+h*et+c*ct,t[i+5]=o*g+s*rt+h*ot+c*lt,t[i+6]=o*nt+s*ut+h*st+c*at,t[i+7]=o*tt+s*ft+h*ht+c*vt,t[i+8]=l*d+a*it+v*et+y*ct,t[i+9]=l*g+a*rt+v*ot+y*lt,t[i+10]=l*nt+a*ut+v*st+y*at,t[i+11]=l*tt+a*ft+v*ht+y*vt,t[i+12]=p*d+w*it+b*et+k*ct,t[i+13]=p*g+w*rt+b*ot+k*lt,t[i+14]=p*nt+w*ut+b*st+k*at,t[i+15]=p*tt+w*ft+b*ht+k*vt,this},i.prototype.multiplyToArraySIMD=function(n,t,i){var r,u,f;void 0===i&&(i=0);var e=this.m,o=n.m,s=SIMD.float32x4.load(o,0),h=SIMD.float32x4.load(o,4),c=SIMD.float32x4.load(o,8),l=SIMD.float32x4.load(o,12),a=SIMD.float32x4.load(e,0);SIMD.float32x4.store(t,i+0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(a,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(a,1,1,1,1),h),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(a,2,2,2,2),c),SIMD.float32x4.mul(SIMD.float32x4.swizzle(a,3,3,3,3),l)))));r=SIMD.float32x4.load(e,4);SIMD.float32x4.store(t,i+4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,1,1,1,1),h),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,2,2,2,2),c),SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,3,3,3,3),l)))));u=SIMD.float32x4.load(e,8);SIMD.float32x4.store(t,i+8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,1,1,1,1),h),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,2,2,2,2),c),SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,3,3,3,3),l)))));f=SIMD.float32x4.load(e,12);SIMD.float32x4.store(t,i+12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,1,1,1,1),h),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,2,2,2,2),c),SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,3,3,3,3),l)))))},i.prototype.equals=function(n){return n&&this.m[0]===n.m[0]&&this.m[1]===n.m[1]&&this.m[2]===n.m[2]&&this.m[3]===n.m[3]&&this.m[4]===n.m[4]&&this.m[5]===n.m[5]&&this.m[6]===n.m[6]&&this.m[7]===n.m[7]&&this.m[8]===n.m[8]&&this.m[9]===n.m[9]&&this.m[10]===n.m[10]&&this.m[11]===n.m[11]&&this.m[12]===n.m[12]&&this.m[13]===n.m[13]&&this.m[14]===n.m[14]&&this.m[15]===n.m[15]},i.prototype.clone=function(){return i.FromValues(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5],this.m[6],this.m[7],this.m[8],this.m[9],this.m[10],this.m[11],this.m[12],this.m[13],this.m[14],this.m[15])},i.prototype.decompose=function(t,r,f){var e;f.x=this.m[12];f.y=this.m[13];f.z=this.m[14];var o=n.Tools.Sign(this.m[0]*this.m[1]*this.m[2]*this.m[3])<0?-1:1,s=n.Tools.Sign(this.m[4]*this.m[5]*this.m[6]*this.m[7])<0?-1:1,h=n.Tools.Sign(this.m[8]*this.m[9]*this.m[10]*this.m[11])<0?-1:1;return(t.x=o*Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]+this.m[2]*this.m[2]),t.y=s*Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]+this.m[6]*this.m[6]),t.z=h*Math.sqrt(this.m[8]*this.m[8]+this.m[9]*this.m[9]+this.m[10]*this.m[10]),0===t.x||0===t.y||0===t.z)?(r.x=0,r.y=0,r.z=0,r.w=1,!1):(e=i.FromValues(this.m[0]/t.x,this.m[1]/t.x,this.m[2]/t.x,0,this.m[4]/t.y,this.m[5]/t.y,this.m[6]/t.y,0,this.m[8]/t.z,this.m[9]/t.z,this.m[10]/t.z,0,0,0,0,1),u.FromRotationMatrixToRef(e,r),!0)},i.FromArray=function(n,t){var r=new i;return t||(t=0),i.FromArrayToRef(n,t,r),r},i.FromArrayToRef=function(n,t,i){for(var r=0;16>r;r++)i.m[r]=n[r+t]},i.FromFloat32ArrayToRefScaled=function(n,t,i,r){for(var u=0;16>u;u++)r.m[u]=n[u+t]*i},i.FromValuesToRef=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){w.m[0]=n;w.m[1]=t;w.m[2]=i;w.m[3]=r;w.m[4]=u;w.m[5]=f;w.m[6]=e;w.m[7]=o;w.m[8]=s;w.m[9]=h;w.m[10]=c;w.m[11]=l;w.m[12]=a;w.m[13]=v;w.m[14]=y;w.m[15]=p},i.FromValues=function(n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var b=new i;return b.m[0]=n,b.m[1]=t,b.m[2]=r,b.m[3]=u,b.m[4]=f,b.m[5]=e,b.m[6]=o,b.m[7]=s,b.m[8]=h,b.m[9]=c,b.m[10]=l,b.m[11]=a,b.m[12]=v,b.m[13]=y,b.m[14]=p,b.m[15]=w,b},i.Compose=function(n,t,r){var u=i.FromValues(n.x,0,0,0,0,n.y,0,0,0,0,n.z,0,0,0,0,1),f=i.Identity();return t.toRotationMatrix(f),u=u.multiply(f),u.setTranslation(r),u},i.Identity=function(){return i.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},i.IdentityToRef=function(n){i.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,n)},i.Zero=function(){return i.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},i.RotationX=function(n){var t=new i;return i.RotationXToRef(n,t),t},i.Invert=function(n){var t=new i;return n.invertToRef(t),t},i.RotationXToRef=function(n,t){var i=Math.sin(n),r=Math.cos(n);t.m[0]=1;t.m[15]=1;t.m[5]=r;t.m[10]=r;t.m[9]=-i;t.m[6]=i;t.m[1]=0;t.m[2]=0;t.m[3]=0;t.m[4]=0;t.m[7]=0;t.m[8]=0;t.m[11]=0;t.m[12]=0;t.m[13]=0;t.m[14]=0},i.RotationY=function(n){var t=new i;return i.RotationYToRef(n,t),t},i.RotationYToRef=function(n,t){var i=Math.sin(n),r=Math.cos(n);t.m[5]=1;t.m[15]=1;t.m[0]=r;t.m[2]=-i;t.m[8]=i;t.m[10]=r;t.m[1]=0;t.m[3]=0;t.m[4]=0;t.m[6]=0;t.m[7]=0;t.m[9]=0;t.m[11]=0;t.m[12]=0;t.m[13]=0;t.m[14]=0},i.RotationZ=function(n){var t=new i;return i.RotationZToRef(n,t),t},i.RotationZToRef=function(n,t){var i=Math.sin(n),r=Math.cos(n);t.m[10]=1;t.m[15]=1;t.m[0]=r;t.m[1]=i;t.m[4]=-i;t.m[5]=r;t.m[2]=0;t.m[3]=0;t.m[6]=0;t.m[7]=0;t.m[8]=0;t.m[9]=0;t.m[11]=0;t.m[12]=0;t.m[13]=0;t.m[14]=0},i.RotationAxis=function(n,t){var f=Math.sin(-t),e=Math.cos(-t),u=1-e,r;return n.normalize(),r=i.Zero(),r.m[0]=n.x*n.x*u+e,r.m[1]=n.x*n.y*u-n.z*f,r.m[2]=n.x*n.z*u+n.y*f,r.m[3]=0,r.m[4]=n.y*n.x*u+n.z*f,r.m[5]=n.y*n.y*u+e,r.m[6]=n.y*n.z*u-n.x*f,r.m[7]=0,r.m[8]=n.z*n.x*u-n.y*f,r.m[9]=n.z*n.y*u+n.x*f,r.m[10]=n.z*n.z*u+e,r.m[11]=0,r.m[15]=1,r},i.RotationYawPitchRoll=function(n,t,r){var u=new i;return i.RotationYawPitchRollToRef(n,t,r,u),u},i.RotationYawPitchRollToRef=function(n,t,i,r){u.RotationYawPitchRollToRef(n,t,i,this._tempQuaternion);this._tempQuaternion.toRotationMatrix(r)},i.Scaling=function(n,t,r){var u=i.Zero();return i.ScalingToRef(n,t,r,u),u},i.ScalingToRef=function(n,t,i,r){r.m[0]=n;r.m[1]=0;r.m[2]=0;r.m[3]=0;r.m[4]=0;r.m[5]=t;r.m[6]=0;r.m[7]=0;r.m[8]=0;r.m[9]=0;r.m[10]=i;r.m[11]=0;r.m[12]=0;r.m[13]=0;r.m[14]=0;r.m[15]=1},i.Translation=function(n,t,r){var u=i.Identity();return i.TranslationToRef(n,t,r,u),u},i.TranslationToRef=function(n,t,r,u){i.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,n,t,r,1,u)},i.LookAtLH=function(n,t,r){var u=i.Zero();return i.LookAtLHToRef(n,t,r,u),u},i.LookAtLHToRef=function(n,r,u,f){r.subtractToRef(n,this._zAxis);this._zAxis.normalize();t.CrossToRef(u,this._zAxis,this._xAxis);this._xAxis.normalize();t.CrossToRef(this._zAxis,this._xAxis,this._yAxis);this._yAxis.normalize();var e=-t.Dot(this._xAxis,n),o=-t.Dot(this._yAxis,n),s=-t.Dot(this._zAxis,n);return i.FromValuesToRef(this._xAxis.x,this._yAxis.x,this._zAxis.x,0,this._xAxis.y,this._yAxis.y,this._zAxis.y,0,this._xAxis.z,this._yAxis.z,this._zAxis.z,0,e,o,s,1,f)},i.LookAtLHToRefSIMD=function(n,t,i,r){var h=r.m,tt=SIMD.float32x4(t.x,t.y,t.z,0),nt=SIMD.float32x4(n.x,n.y,n.z,0),o=SIMD.float32x4(i.x,i.y,i.z,0),e=SIMD.float32x4.sub(tt,nt),u=SIMD.float32x4.mul(e,e),f,d,g;u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3)));e=SIMD.float32x4.mul(e,SIMD.float32x4.reciprocalSqrtApproximation(u));u=SIMD.float32x4.mul(o,o);u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3)));o=SIMD.float32x4.mul(o,SIMD.float32x4.reciprocalSqrtApproximation(u));f=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(e,1,2,0,3),SIMD.float32x4.swizzle(o,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(e,2,0,1,3),SIMD.float32x4.swizzle(o,1,2,0,3)));u=SIMD.float32x4.mul(f,f);u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3)));f=SIMD.float32x4.mul(f,SIMD.float32x4.reciprocalSqrtApproximation(u));d=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,1,2,0,3),SIMD.float32x4.swizzle(e,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,2,0,1,3),SIMD.float32x4.swizzle(e,1,2,0,3)));u=SIMD.float32x4.mul(f,f);u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3)));f=SIMD.float32x4.mul(f,SIMD.float32x4.reciprocalSqrtApproximation(u));g=SIMD.float32x4.splat(0);f=SIMD.float32x4.neg(f);var c=SIMD.float32x4.shuffle(f,d,0,1,4,5),l=SIMD.float32x4.shuffle(e,g,0,1,4,5),a=SIMD.float32x4.shuffle(c,l,0,2,4,6),v=SIMD.float32x4.shuffle(c,l,1,3,5,7);c=SIMD.float32x4.shuffle(f,d,2,3,6,7);l=SIMD.float32x4.shuffle(e,g,2,3,6,7);var y=SIMD.float32x4.shuffle(c,l,0,2,4,6),p=SIMD.float32x4(0,0,0,1),w=SIMD.float32x4(1,0,0,0),b=SIMD.float32x4(0,1,0,0),k=SIMD.float32x4(0,0,1,0),s=SIMD.float32x4.neg(nt);s=SIMD.float32x4.withW(s,1);SIMD.float32x4.store(h,0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,0,0,0,0),a),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,1,1,1,1),v),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,2,2,2,2),y),SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,3,3,3,3),p)))));SIMD.float32x4.store(h,4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,0,0,0,0),a),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,1,1,1,1),v),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,2,2,2,2),y),SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,3,3,3,3),p)))));SIMD.float32x4.store(h,8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(k,0,0,0,0),a),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(k,1,1,1,1),v),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(k,2,2,2,2),y),SIMD.float32x4.mul(SIMD.float32x4.swizzle(k,3,3,3,3),p)))));SIMD.float32x4.store(h,12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(s,0,0,0,0),a),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(s,1,1,1,1),v),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(s,2,2,2,2),y),SIMD.float32x4.mul(SIMD.float32x4.swizzle(s,3,3,3,3),p)))))},i.OrthoLH=function(n,t,r,u){var f=i.Zero();return i.OrthoLHToRef(n,t,r,u,f),f},i.OrthoLHToRef=function(n,t,r,u,f){var e=2/n,o=2/t,s=1/(u-r),h=r/(r-u);i.FromValuesToRef(e,0,0,0,0,o,0,0,0,0,s,0,0,0,h,1,f)},i.OrthoOffCenterLH=function(n,t,r,u,f,e){var o=i.Zero();return i.OrthoOffCenterLHToRef(n,t,r,u,f,e,o),o},i.OrthoOffCenterLHToRef=function(n,t,i,r,u,f,e){e.m[0]=2/(t-n);e.m[1]=e.m[2]=e.m[3]=0;e.m[5]=2/(r-i);e.m[4]=e.m[6]=e.m[7]=0;e.m[10]=-1/(u-f);e.m[8]=e.m[9]=e.m[11]=0;e.m[12]=(n+t)/(n-t);e.m[13]=(r+i)/(i-r);e.m[14]=u/(u-f);e.m[15]=1},i.PerspectiveLH=function(n,t,r,u){var f=i.Zero();return f.m[0]=2*r/n,f.m[1]=f.m[2]=f.m[3]=0,f.m[5]=2*r/t,f.m[4]=f.m[6]=f.m[7]=0,f.m[10]=-u/(r-u),f.m[8]=f.m[9]=0,f.m[11]=1,f.m[12]=f.m[13]=f.m[15]=0,f.m[14]=r*u/(r-u),f},i.PerspectiveFovLH=function(n,t,r,u){var f=i.Zero();return i.PerspectiveFovLHToRef(n,t,r,u,f),f},i.PerspectiveFovLHToRef=function(t,i,r,u,f,e){void 0===e&&(e=n.Camera.FOVMODE_VERTICAL_FIXED);var o=1/Math.tan(.5*t),s=e===n.Camera.FOVMODE_VERTICAL_FIXED;f.m[0]=s?o/i:o;f.m[1]=f.m[2]=f.m[3]=0;f.m[5]=s?o:o*i;f.m[4]=f.m[6]=f.m[7]=0;f.m[8]=f.m[9]=0;f.m[10]=-u/(r-u);f.m[11]=1;f.m[12]=f.m[13]=f.m[15]=0;f.m[14]=r*u/(r-u)},i.GetFinalMatrix=function(n,t,r,u,f,e){var o=n.width,s=n.height,h=n.x,c=n.y,l=i.FromValues(o/2,0,0,0,0,-s/2,0,0,0,0,e-f,0,h+o/2,s/2+c,f,1);return t.multiply(r).multiply(u).multiply(l)},i.GetAsMatrix2x2=function(n){return new Float32Array([n.m[0],n.m[1],n.m[4],n.m[5]])},i.GetAsMatrix3x3=function(n){return new Float32Array([n.m[0],n.m[1],n.m[2],n.m[4],n.m[5],n.m[6],n.m[8],n.m[9],n.m[10]])},i.Transpose=function(n){var t=new i;return t.m[0]=n.m[0],t.m[1]=n.m[4],t.m[2]=n.m[8],t.m[3]=n.m[12],t.m[4]=n.m[1],t.m[5]=n.m[5],t.m[6]=n.m[9],t.m[7]=n.m[13],t.m[8]=n.m[2],t.m[9]=n.m[6],t.m[10]=n.m[10],t.m[11]=n.m[14],t.m[12]=n.m[3],t.m[13]=n.m[7],t.m[14]=n.m[11],t.m[15]=n.m[15],t},i.Reflection=function(n){var t=new i;return i.ReflectionToRef(n,t),t},i.ReflectionToRef=function(n,t){n.normalize();var i=n.normal.x,r=n.normal.y,u=n.normal.z,f=-2*i,e=-2*r,o=-2*u;t.m[0]=f*i+1;t.m[1]=e*i;t.m[2]=o*i;t.m[3]=0;t.m[4]=f*r;t.m[5]=e*r+1;t.m[6]=o*r;t.m[7]=0;t.m[8]=f*u;t.m[9]=e*u;t.m[10]=o*u+1;t.m[11]=0;t.m[12]=f*n.d;t.m[13]=e*n.d;t.m[14]=o*n.d;t.m[15]=1},i._tempQuaternion=new u,i._xAxis=t.Zero(),i._yAxis=t.Zero(),i._zAxis=t.Zero(),i}();n.Matrix=i;h=function(){function n(n,i,r,u){this.normal=new t(n,i,r);this.d=u}return n.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},n.prototype.clone=function(){return new n(this.normal.x,this.normal.y,this.normal.z,this.d)},n.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),n=0;return 0!==t&&(n=1/t),this.normal.x*=n,this.normal.y*=n,this.normal.z*=n,this.d*=n,this},n.prototype.transform=function(t){var r=i.Transpose(t),u=this.normal.x,f=this.normal.y,e=this.normal.z,o=this.d,s=u*r.m[0]+f*r.m[1]+e*r.m[2]+o*r.m[3],h=u*r.m[4]+f*r.m[5]+e*r.m[6]+o*r.m[7],c=u*r.m[8]+f*r.m[9]+e*r.m[10]+o*r.m[11],l=u*r.m[12]+f*r.m[13]+e*r.m[14]+o*r.m[15];return new n(s,h,c,l)},n.prototype.dotCoordinate=function(n){return this.normal.x*n.x+this.normal.y*n.y+this.normal.z*n.z+this.d},n.prototype.copyFromPoints=function(n,t,i){var r,o=t.x-n.x,s=t.y-n.y,h=t.z-n.z,c=i.x-n.x,l=i.y-n.y,a=i.z-n.z,u=s*a-h*l,f=h*c-o*a,e=o*l-s*c,v=Math.sqrt(u*u+f*f+e*e);return r=0!==v?1/v:0,this.normal.x=u*r,this.normal.y=f*r,this.normal.z=e*r,this.d=-(this.normal.x*n.x+this.normal.y*n.y+this.normal.z*n.z),this},n.prototype.isFrontFacingTo=function(n,i){var r=t.Dot(this.normal,n);return i>=r},n.prototype.signedDistanceTo=function(n){return t.Dot(n,this.normal)+this.d},n.FromArray=function(t){return new n(t[0],t[1],t[2],t[3])},n.FromPoints=function(t,i,r){var u=new n(0,0,0,0);return u.copyFromPoints(t,i,r),u},n.FromPositionAndNormal=function(t,i){var r=new n(0,0,0,0);return i.normalize(),r.normal=i,r.d=-(i.x*t.x+i.y*t.y+i.z*t.z),r},n.SignedDistanceToPlaneFromPositionAndNormal=function(n,i,r){var u=-(i.x*n.x+i.y*n.y+i.z*n.z);return t.Dot(r,i)+u},n}();n.Plane=h;a=function(){function n(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}return n.prototype.toGlobal=function(t){var i=t.getRenderWidth(),r=t.getRenderHeight();return new n(this.x*i,this.y*r,this.width*i,this.height*r)},n}();n.Viewport=a;v=function(){function n(){}return n.GetPlanes=function(t){for(var i=[],r=0;6>r;r++)i.push(new h(0,0,0,0));return n.GetPlanesToRef(t,i),i},n.GetPlanesToRef=function(n,t){t[0].normal.x=n.m[3]+n.m[2];t[0].normal.y=n.m[7]+n.m[6];t[0].normal.z=n.m[11]+n.m[10];t[0].d=n.m[15]+n.m[14];t[0].normalize();t[1].normal.x=n.m[3]-n.m[2];t[1].normal.y=n.m[7]-n.m[6];t[1].normal.z=n.m[11]-n.m[10];t[1].d=n.m[15]-n.m[14];t[1].normalize();t[2].normal.x=n.m[3]+n.m[0];t[2].normal.y=n.m[7]+n.m[4];t[2].normal.z=n.m[11]+n.m[8];t[2].d=n.m[15]+n.m[12];t[2].normalize();t[3].normal.x=n.m[3]-n.m[0];t[3].normal.y=n.m[7]-n.m[4];t[3].normal.z=n.m[11]-n.m[8];t[3].d=n.m[15]-n.m[12];t[3].normalize();t[4].normal.x=n.m[3]-n.m[1];t[4].normal.y=n.m[7]-n.m[5];t[4].normal.z=n.m[11]-n.m[9];t[4].d=n.m[15]-n.m[13];t[4].normalize();t[5].normal.x=n.m[3]+n.m[1];t[5].normal.y=n.m[7]+n.m[5];t[5].normal.z=n.m[11]+n.m[9];t[5].d=n.m[15]+n.m[13];t[5].normalize()},n}();n.Frustum=v;y=function(){function r(n,t,i){void 0===i&&(i=Number.MAX_VALUE);this.origin=n;this.direction=t;this.length=i}return r.prototype.intersectsBoxMinMax=function(n,t){var u,r,i,o,f=0,e=Number.MAX_VALUE;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<n.x||this.origin.x>t.x)return!1}else if(u=1/this.direction.x,r=(n.x-this.origin.x)*u,i=(t.x-this.origin.x)*u,i===-(1/0)&&(i=1/0),r>i&&(o=r,r=i,i=o),f=Math.max(r,f),e=Math.min(i,e),f>e)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<n.y||this.origin.y>t.y)return!1}else if(u=1/this.direction.y,r=(n.y-this.origin.y)*u,i=(t.y-this.origin.y)*u,i===-(1/0)&&(i=1/0),r>i&&(o=r,r=i,i=o),f=Math.max(r,f),e=Math.min(i,e),f>e)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<n.z||this.origin.z>t.z)return!1}else if(u=1/this.direction.z,r=(n.z-this.origin.z)*u,i=(t.z-this.origin.z)*u,i===-(1/0)&&(i=1/0),r>i&&(o=r,r=i,i=o),f=Math.max(r,f),e=Math.min(i,e),f>e)return!1;return!0},r.prototype.intersectsBox=function(n){return this.intersectsBoxMinMax(n.minimum,n.maximum)},r.prototype.intersectsSphere=function(n){var i=n.center.x-this.origin.x,r=n.center.y-this.origin.y,u=n.center.z-this.origin.z,f=i*i+r*r+u*u,e=n.radius*n.radius,t,o;return e>=f?!0:(t=i*this.direction.x+r*this.direction.y+u*this.direction.z,0>t)?!1:(o=f-t*t,e>=o)},r.prototype.intersectsTriangle=function(i,r,u){var s,e,f,o,h;return(this._edge1||(this._edge1=t.Zero(),this._edge2=t.Zero(),this._pvec=t.Zero(),this._tvec=t.Zero(),this._qvec=t.Zero()),r.subtractToRef(i,this._edge1),u.subtractToRef(i,this._edge2),t.CrossToRef(this.direction,this._edge2,this._pvec),s=t.Dot(this._edge1,this._pvec),0===s)?null:(e=1/s,this.origin.subtractToRef(i,this._tvec),f=t.Dot(this._tvec,this._pvec)*e,0>f||f>1)?null:(t.CrossToRef(this._tvec,this._edge1,this._qvec),o=t.Dot(this.direction,this._qvec)*e,0>o||f+o>1)?null:(h=t.Dot(this._edge2,this._qvec)*e,h>this.length?null:new n.IntersectionInfo(f,o,h))},r.CreateNew=function(n,i,u,f,e,o,s){var h=t.Unproject(new t(n,i,0),u,f,e,o,s),l=t.Unproject(new t(n,i,1),u,f,e,o,s),c=l.subtract(h);return c.normalize(),new r(h,c)},r.CreateNewFromTo=function(n,t,u){void 0===u&&(u=i.Identity());var f=t.subtract(n),e=Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z);return f.normalize(),r.Transform(new r(n,f,e),u)},r.Transform=function(n,i){var u=t.TransformCoordinates(n.origin,i),f=t.TransformNormal(n.direction,i);return new r(u,f,n.length)},r}();n.Ray=y,function(n){n[n.LOCAL=0]="LOCAL";n[n.WORLD=1]="WORLD"}(n.Space||(n.Space={}));o=(n.Space,function(){function n(){}return n.X=new t(1,0,0),n.Y=new t(0,1,0),n.Z=new t(0,0,1),n}());n.Axis=o;p=function(){function n(){}return n.interpolate=function(n,t,i,r,u){for(var o=1-3*r+3*t,s=3*r-6*t,h=3*t,f=n,c=0;5>c;c++){var e=f*f,l=e*f,a=o*l+s*e+h*f,v=1/(3*o*e+2*s*f+h);f-=(a-n)*v;f=Math.min(1,Math.max(0,f))}return 3*Math.pow(1-f,2)*f*i+3*(1-f)*Math.pow(f,2)*u+Math.pow(f,3)},n}();n.BezierCurve=p,function(n){n[n.CW=0]="CW";n[n.CCW=1]="CCW"}(n.Orientation||(n.Orientation={}));e=n.Orientation;f=function(){function n(n){var t=this;this.degrees=function(){return 180*t._radians/Math.PI};this.radians=function(){return t._radians};this._radians=n;this._radians<0&&(this._radians+=2*Math.PI)}return n.BetweenTwoPoints=function(t,i){var r=i.subtract(t),u=Math.atan2(r.y,r.x);return new n(u)},n.FromRadians=function(t){return new n(t)},n.FromDegrees=function(t){return new n(t*Math.PI/180)},n}();n.Angle=f;c=function(){function n(n,t,i){this.startPoint=n;this.midPoint=t;this.endPoint=i;var h=Math.pow(t.x,2)+Math.pow(t.y,2),c=(Math.pow(n.x,2)+Math.pow(n.y,2)-h)/2,l=(h-Math.pow(i.x,2)-Math.pow(i.y,2))/2,a=(n.x-t.x)*(t.y-i.y)-(t.x-i.x)*(n.y-t.y);this.centerPoint=new r((c*(t.y-i.y)-l*(n.y-t.y))/a,((n.x-t.x)*l-(t.x-i.x)*c)/a);this.radius=this.centerPoint.subtract(this.startPoint).length();this.startAngle=f.BetweenTwoPoints(this.centerPoint,this.startPoint);var s=this.startAngle.degrees(),u=f.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),o=f.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-s>180&&(u-=360);-180>u-s&&(u+=360);o-u>180&&(o-=360);-180>o-u&&(o+=360);this.orientation=0>u-s?e.CW:e.CCW;this.angle=f.FromDegrees(this.orientation===e.CW?s-o:o-s)}return n}();n.Arc2=c;w=function(){function n(n){this.path=n;this._onchange=[];this.value=0;this.animations=[]}return n.prototype.getPoint=function(){var n=this.path.getPointAtLengthPosition(this.value);return new t(n.x,0,n.y)},n.prototype.moveAhead=function(n){return void 0===n&&(n=.002),this.move(n),this},n.prototype.moveBack=function(n){return void 0===n&&(n=.002),this.move(-n),this},n.prototype.move=function(n){if(Math.abs(n)>1)throw"step size should be less than 1.";return this.value+=n,this.ensureLimits(),this.raiseOnChange(),this},n.prototype.ensureLimits=function(){for(;this.value>1;)this.value-=1;for(;this.value<0;)this.value+=1;return this},n.prototype.markAsDirty=function(){return this.ensureLimits(),this.raiseOnChange(),this},n.prototype.raiseOnChange=function(){var n=this;return this._onchange.forEach(function(t){return t(n)}),this},n.prototype.onchange=function(n){return this._onchange.push(n),this},n}();n.PathCursor=w;b=function(){function t(n,t){this._points=[];this._length=0;this.closed=!1;this._points.push(new r(n,t))}return t.prototype.addLineTo=function(t,i){if(closed)return n.Tools.Error("cannot add lines to closed paths"),this;var u=new r(t,i),f=this._points[this._points.length-1];return this._points.push(u),this._length+=u.subtract(f).length(),this},t.prototype.addArcTo=function(t,i,u,f,o){var h,a,v,y;if(void 0===o&&(o=36),closed)return n.Tools.Error("cannot add arcs to closed paths"),this;var p=this._points[this._points.length-1],w=new r(t,i),b=new r(u,f),s=new c(p,w,b),l=s.angle.radians()/o;for(s.orientation===e.CW&&(l*=-1),h=s.startAngle.radians()+l,a=0;o>a;a++)v=Math.cos(h)*s.radius+s.centerPoint.x,y=Math.sin(h)*s.radius+s.centerPoint.y,this.addLineTo(v,y),h+=l;return this},t.prototype.close=function(){return this.closed=!0,this},t.prototype.length=function(){var n=this._length,t,i;return this.closed||(t=this._points[this._points.length-1],i=this._points[0],n+=i.subtract(t).length()),n},t.prototype.getPoints=function(){return this._points},t.prototype.getPointAtLengthPosition=function(t){var o,s;if(0>t||t>1)return n.Tools.Error("normalized length position should be between 0 and 1."),r.Zero();for(var f=t*this.length(),i=0,u=0;u<this._points.length;u++){var l=(u+1)%this._points.length,e=this._points[u],a=this._points[l],h=a.subtract(e),c=h.length()+i;if(f>=i&&c>=f)return o=h.normalize(),s=f-i,new r(e.x+o.x*s,e.y+o.y*s);i=c}return n.Tools.Error("internal error"),r.Zero()},t.StartingAt=function(n,i){return new t(n,i)},t}();n.Path2=b;k=function(){function i(n,t,i){this.path=n;this._curve=[];this._distances=[];this._tangents=[];this._normals=[];this._binormals=[];for(var r=0;r<n.length;r++)this._curve[r]=n[r].clone();this._raw=i||!1;this._compute(t)}return i.prototype.getCurve=function(){return this._curve},i.prototype.getTangents=function(){return this._tangents},i.prototype.getNormals=function(){return this._normals},i.prototype.getBinormals=function(){return this._binormals},i.prototype.getDistances=function(){return this._distances},i.prototype.update=function(n,t){for(var i=0;i<n.length;i++)this._curve[i].x=n[i].x,this._curve[i].y=n[i].y,this._curve[i].z=n[i].z;return this._compute(t),this},i.prototype._compute=function(n){var r=this._curve.length,u,o,f,s,e,h,i;for(this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[r-1]=this._curve[r-1].subtract(this._curve[r-2]),this._raw||this._tangents[r-1].normalize(),u=this._tangents[0],o=this._normalVector(this._curve[0],u,n),this._normals[0]=o,this._raw||this._normals[0].normalize(),this._binormals[0]=t.Cross(u,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0,i=1;r>i;i++)f=this._getLastNonNullVector(i),r-1>i&&(s=this._getFirstNonNullVector(i),this._tangents[i]=f.add(s),this._tangents[i].normalize()),this._distances[i]=this._distances[i-1]+f.length(),e=this._tangents[i],h=this._binormals[i-1],this._normals[i]=t.Cross(h,e),this._raw||this._normals[i].normalize(),this._binormals[i]=t.Cross(e,this._normals[i]),this._raw||this._binormals[i].normalize()},i.prototype._getFirstNonNullVector=function(n){for(var t=1,i=this._curve[n+t].subtract(this._curve[n]);0===i.length()&&n+t+1<this._curve.length;)t++,i=this._curve[n+t].subtract(this._curve[n]);return i},i.prototype._getLastNonNullVector=function(n){for(var t=1,i=this._curve[n].subtract(this._curve[n-t]);0===i.length()&&n>t+1;)t++,i=this._curve[n].subtract(this._curve[n-t]);return i},i.prototype._normalVector=function(i,r,u){var f,e;return void 0===u||null===u?(n.Tools.WithinEpsilon(r.y,1,n.Engine.Epsilon)?n.Tools.WithinEpsilon(r.x,1,n.Engine.Epsilon)?n.Tools.WithinEpsilon(r.z,1,n.Engine.Epsilon)||(e=new t(0,0,1)):e=new t(1,0,0):e=new t(0,-1,0),f=t.Cross(r,e)):(f=t.Cross(r,u),t.CrossToRef(f,r,f)),f.normalize(),f},i}();n.Path3D=k;d=function(){function n(n){this._length=0;this._points=n;this._length=this._computeLength(n)}return n.CreateQuadraticBezier=function(i,r,u,f){f=f>2?f:3;for(var s=[],o=function(n,t,i,r){return(1-n)*(1-n)*t+2*n*(1-n)*i+n*n*r},e=0;f>=e;e++)s.push(new t(o(e/f,i.x,r.x,u.x),o(e/f,i.y,r.y,u.y),o(e/f,i.z,r.z,u.z)));return new n(s)},n.CreateCubicBezier=function(i,r,u,f,e){e=e>3?e:4;for(var h=[],s=function(n,t,i,r,u){return(1-n)*(1-n)*(1-n)*t+3*n*(1-n)*(1-n)*i+3*n*n*(1-n)*r+n*n*n*u},o=0;e>=o;o++)h.push(new t(s(o/e,i.x,r.x,u.x,f.x),s(o/e,i.y,r.y,u.y,f.y),s(o/e,i.z,r.z,u.z,f.z)));return new n(h)},n.CreateHermiteSpline=function(i,r,u,f,e){for(var s=[],h=1/e,o=0;e>=o;o++)s.push(t.Hermite(i,r,u,f,o*h));return new n(s)},n.prototype.getPoints=function(){return this._points},n.prototype.length=function(){return this._length},n.prototype["continue"]=function(t){for(var f=this._points[this._points.length-1],u=this._points.slice(),i=t.getPoints(),r=1;r<i.length;r++)u.push(i[r].subtract(i[0]).add(f));return new n(u)},n.prototype._computeLength=function(n){for(var i=0,t=1;t<n.length;t++)i+=n[t].subtract(n[t-1]).length();return i},n}();n.Curve3=d;g=function(){function n(n,i){void 0===n&&(n=t.Zero());void 0===i&&(i=t.Up());this.position=n;this.normal=i}return n.prototype.clone=function(){return new n(this.position.clone(),this.normal.clone())},n}();n.PositionNormalVertex=g;nt=function(){function n(n,i,u){void 0===n&&(n=t.Zero());void 0===i&&(i=t.Up());void 0===u&&(u=r.Zero());this.position=n;this.normal=i;this.uv=u}return n.prototype.clone=function(){return new n(this.position.clone(),this.normal.clone(),this.uv.clone())},n}();n.PositionNormalTextureVertex=nt;var it=i.prototype.multiplyToArray,rt=i.prototype.invertToRef,ut=i.LookAtLHToRef,ft=t.TransformCoordinatesToRef,et=t.TransformCoordinatesFromFloatsToRef,ot=function(){function n(){}return Object.defineProperty(n,"IsEnabled",{get:function(){return n._isEnabled},enumerable:!0,configurable:!0}),n.DisableSIMD=function(){i.prototype.multiplyToArray=it;i.prototype.invertToRef=rt;i.LookAtLHToRef=ut;t.TransformCoordinatesToRef=ft;t.TransformCoordinatesFromFloatsToRef=et;n._isEnabled=!1},n.EnableSIMD=function(){void 0!==window.SIMD&&(i.prototype.multiplyToArray=i.prototype.multiplyToArraySIMD,i.prototype.invertToRef=i.prototype.invertToRefSIMD,i.LookAtLHToRef=i.LookAtLHToRefSIMD,t.TransformCoordinatesToRef=t.TransformCoordinatesToRefSIMD,t.TransformCoordinatesFromFloatsToRef=t.TransformCoordinatesFromFloatsToRefSIMD,Object.defineProperty(t.prototype,"x",{get:function(){return this._data[0]},set:function(n){this._data||(this._data=new Float32Array(3));this._data[0]=n}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._data[1]},set:function(n){this._data[1]=n}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._data[2]},set:function(n){this._data[2]=n}}),n._isEnabled=!0)},n._isEnabled=!1,n}();n.SIMDHelper=ot}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,i){this.idbFactory=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;this.callbackManifestChecked=i;this.currentSceneUrl=t.ReturnFullUrlLocation(n);this.db=null;this.enableSceneOffline=!1;this.enableTexturesOffline=!1;this.manifestVersionFound=0;this.mustUpdateRessources=!1;this.hasReachedQuota=!1;t.IDBStorageEnabled?this.checkManifestFile():this.callbackManifestChecked(!0)}return t.prototype.checkManifestFile=function(){function u(){r.enableSceneOffline=!1;r.enableTexturesOffline=!1;r.callbackManifestChecked(!1)}var i=this,r=this,f=this.currentSceneUrl+".manifest",t=new XMLHttpRequest,e=f+(null==f.match(/\?/)?"?":"&")+(new Date).getTime();t.open("GET",e,!0);t.addEventListener("load",function(){if(200===t.status||n.Tools.ValidateXHRData(t,1))try{var r=JSON.parse(t.response);i.enableSceneOffline=r.enableSceneOffline;i.enableTexturesOffline=r.enableTexturesOffline;r.version&&!isNaN(parseInt(r.version))&&(i.manifestVersionFound=r.version);i.callbackManifestChecked&&i.callbackManifestChecked(!0)}catch(f){u()}else u()},!1);t.addEventListener("error",function(){u()},!1);try{t.send()}catch(o){n.Tools.Error("Error on XHR send request.");r.callbackManifestChecked(!1)}},t.prototype.openAsync=function(t,i){function f(){e.isSupported=!1;i&&i()}var u=this,e=this,r;this.idbFactory&&(this.enableSceneOffline||this.enableTexturesOffline)?this.db?t&&t():(this.hasReachedQuota=!1,this.isSupported=!0,r=this.idbFactory.open("babylonjs",1),r.onerror=function(){f()},r.onblocked=function(){n.Tools.Error("IDB request blocked. Please reload the page.");f()},r.onsuccess=function(){u.db=r.result;t()},r.onupgradeneeded=function(t){u.db=t.target.result;try{u.db.createObjectStore("scenes",{keyPath:"sceneUrl"});u.db.createObjectStore("versions",{keyPath:"sceneUrl"});u.db.createObjectStore("textures",{keyPath:"textureUrl"})}catch(i){n.Tools.Error("Error while creating object stores. Exception: "+i.message);f()}}):(this.isSupported=!1,i&&i())},t.prototype.loadImageFromDB=function(n,i){var r=this,u=t.ReturnFullUrlLocation(n),f=function(){r.hasReachedQuota||null===r.db?i.src=n:r._saveImageIntoDBAsync(u,i)};this.mustUpdateRessources?f():this._loadImageFromDBAsync(u,i,f)},t.prototype._loadImageFromDBAsync=function(t,i,r){var f,u,e;this.isSupported&&null!==this.db?(u=this.db.transaction(["textures"]),u.onabort=function(){i.src=t},u.oncomplete=function(){var u,e;f?(e=window.URL||window.webkitURL,u=e.createObjectURL(f.data,{oneTimeOnly:!0}),i.onerror=function(){n.Tools.Error("Error loading image from blob URL: "+u+" switching back to web url: "+t);i.src=t},i.src=u):r()},e=u.objectStore("textures").get(t),e.onsuccess=function(n){f=n.target.result},e.onerror=function(){n.Tools.Error("Error loading texture "+t+" from DB.");i.src=t}):(n.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i.src=t)},t.prototype._saveImageIntoDBAsync=function(i,r){var o=this,e,f,u;this.isSupported?(e=function(){var n,t;if(f){t=window.URL||window.webkitURL;try{n=t.createObjectURL(f,{oneTimeOnly:!0})}catch(i){n=t.createObjectURL(f)}}r.src=n},t.IsUASupportingBlobStorage?(u=new XMLHttpRequest,u.open("GET",i,!0),u.responseType="blob",u.addEventListener("load",function(){var n,h,s;if(200===u.status){f=u.response;n=o.db.transaction(["textures"],"readwrite");n.onabort=function(n){try{n.srcElement.error&&"QuotaExceededError"===n.srcElement.error.name&&(this.hasReachedQuota=!0)}catch(t){}e()};n.oncomplete=function(){e()};h={textureUrl:i,data:f};try{s=n.objectStore("textures").put(h);s.onsuccess=function(){};s.onerror=function(){e()}}catch(c){25===c.code&&(t.IsUASupportingBlobStorage=!1);r.src=i}}else r.src=i},!1),u.addEventListener("error",function(){n.Tools.Error("Error in XHR request in BABYLON.Database.");r.src=i},!1),u.send()):r.src=i):(n.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),r.src=i)},t.prototype._checkVersionFromDB=function(n,t){var i=this,r=function(){i._saveVersionIntoDBAsync(n,t)};this._loadVersionFromDBAsync(n,t,r)},t.prototype._loadVersionFromDBAsync=function(t,i,r){var e=this,u,f,o;if(this.isSupported)try{f=this.db.transaction(["versions"]);f.oncomplete=function(){u?e.manifestVersionFound>u.data?(e.mustUpdateRessources=!0,r()):i(u.data):(e.mustUpdateRessources=!0,r())};f.onabort=function(){i(-1)};o=f.objectStore("versions").get(t);o.onsuccess=function(n){u=n.target.result};o.onerror=function(){n.Tools.Error("Error loading version for scene "+t+" from DB.");i(-1)}}catch(s){n.Tools.Error("Error while accessing 'versions' object store (READ OP). Exception: "+s.message);i(-1)}else n.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i(-1)},t.prototype._saveVersionIntoDBAsync=function(t,i){var f=this,r,e,u;if(this.isSupported&&!this.hasReachedQuota)try{r=this.db.transaction(["versions"],"readwrite");r.onabort=function(n){try{n.srcElement.error&&"QuotaExceededError"===n.srcElement.error.name&&(f.hasReachedQuota=!0)}catch(t){}i(-1)};r.oncomplete=function(){i(f.manifestVersionFound)};e={sceneUrl:t,data:this.manifestVersionFound};u=r.objectStore("versions").put(e);u.onsuccess=function(){};u.onerror=function(){n.Tools.Error("Error in DB add version request in BABYLON.Database.")}}catch(o){n.Tools.Error("Error while accessing 'versions' object store (WRITE OP). Exception: "+o.message);i(-1)}else i(-1)},t.prototype.loadFileFromDB=function(n,i,r,u,f){var e=this,o=t.ReturnFullUrlLocation(n),s=function(){e._saveFileIntoDBAsync(o,i,r)};this._checkVersionFromDB(o,function(n){-1!==n?e.mustUpdateRessources?e._saveFileIntoDBAsync(o,i,r,f):e._loadFileFromDBAsync(o,i,s,f):u()})},t.prototype._loadFileFromDBAsync=function(t,i,r){var f,e,u,o;this.isSupported?(f=-1!==t.indexOf(".babylon")?"scenes":"textures",u=this.db.transaction([f]),u.oncomplete=function(){e?i(e.data):r()},u.onabort=function(){r()},o=u.objectStore(f).get(t),o.onsuccess=function(n){e=n.target.result},o.onerror=function(){n.Tools.Error("Error loading file "+t+" from DB.");r()}):(n.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i())},t.prototype._saveFileIntoDBAsync=function(t,i,r,u){var s=this,o,e,f;this.isSupported?(o=-1!==t.indexOf(".babylon")?"scenes":"textures",f=new XMLHttpRequest,f.open("GET",t,!0),u&&(f.responseType="arraybuffer"),f.onprogress=r,f.addEventListener("load",function(){var r,c,h;if(200===f.status||n.Tools.ValidateXHRData(f,u?6:1))if(e=u?f.response:f.responseText,s.hasReachedQuota)i(e);else{r=s.db.transaction([o],"readwrite");r.onabort=function(n){try{n.srcElement.error&&"QuotaExceededError"===n.srcElement.error.name&&(this.hasReachedQuota=!0)}catch(t){}i(e)};r.oncomplete=function(){i(e)};c="scenes"===o?{sceneUrl:t,data:e,version:s.manifestVersionFound}:{textureUrl:t,data:e};try{h=r.objectStore(o).put(c);h.onsuccess=function(){};h.onerror=function(){n.Tools.Error("Error in DB add file request in BABYLON.Database.")}}catch(l){i(e)}}else i()},!1),f.addEventListener("error",function(){n.Tools.Error("error on XHR request.");i()},!1),f.send()):(n.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i())},t.IsUASupportingBlobStorage=!0,t.IDBStorageEnabled=!0,t.parseURL=function(n){var t=document.createElement("a");t.href=n;var i=n.substring(0,n.lastIndexOf("#")),r=n.substring(i.lastIndexOf("/")+1,n.length);return n.substring(0,n.indexOf(r,0))},t.ReturnFullUrlLocation=function(n){return-1===n.indexOf("http:/")?t.parseURL(window.location.href)+n:n},t}();n.Database=t}(BABYLON||(BABYLON={}));!function(n){var t;!function(t){var i=function(){function t(){}return t.GetTGAHeader=function(n){var t=0;return{id_length:n[t++],colormap_type:n[t++],image_type:n[t++],colormap_index:n[t++]|n[t++]<<8,colormap_length:n[t++]|n[t++]<<8,colormap_size:n[t++],origin:[n[t++]|n[t++]<<8,n[t++]|n[t++]<<8],width:n[t++]|n[t++]<<8,height:n[t++]|n[t++]<<8,pixel_size:n[t++],flags:n[t++]}},t.UploadContent=function(i,r){var e,u,c,it,o,l,g,s,f,h,nt,a,v,y,p,w,b,rt,ut;if(r.length<19)return void n.Tools.Error("Unable to load TGA file - Not enough data to contain header");if(e=18,u=t.GetTGAHeader(r),u.id_length+e>r.length)return void n.Tools.Error("Unable to load TGA file - Not enough data");e+=u.id_length;var k=!1,d=!1,ft=!1,tt=!1;switch(u.image_type){case t._TYPE_RLE_INDEXED:k=!0;case t._TYPE_INDEXED:d=!0;break;case t._TYPE_RLE_RGB:k=!0;case t._TYPE_RGB:ft=!0;break;case t._TYPE_RLE_GREY:k=!0;case t._TYPE_GREY:tt=!0}if(o=(15&u.flags,u.pixel_size>>3),l=u.width*u.height*o,d&&(it=r.subarray(e,e+=u.colormap_length*(u.colormap_size>>3))),k)for(c=new Uint8Array(l),h=0,nt=new Uint8Array(o);l>e&&l>h;)if(g=r[e++],s=(127&g)+1,128&g){for(f=0;o>f;++f)nt[f]=r[e++];for(f=0;s>f;++f)c.set(nt,h+f*o);h+=o*s}else{for(s*=o,f=0;s>f;++f)c[h+f]=r[e++];h+=s}else c=r.subarray(e,e+=d?u.width*u.height:l);switch((u.flags&t._ORIGIN_MASK)>>t._ORIGIN_SHIFT){default:case t._ORIGIN_UL:a=0;y=1;b=u.width;v=0;p=1;w=u.height;break;case t._ORIGIN_BL:a=0;y=1;b=u.width;v=u.height-1;p=-1;w=-1;break;case t._ORIGIN_UR:a=u.width-1;y=-1;b=-1;v=0;p=1;w=u.height;break;case t._ORIGIN_BR:a=u.width-1;y=-1;b=-1;v=u.height-1;p=-1;w=-1}rt="_getImageData"+(tt?"Grey":"")+u.pixel_size+"bits";ut=t[rt](u,it,c,v,p,w,a,y,b);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,u.width,u.height,0,i.RGBA,i.UNSIGNED_BYTE,ut)},t._getImageData8bits=function(n,t,i,r,u,f,e,o,s){for(var v,h,w=i,y=t,l=n.width,b=n.height,p=0,a=new Uint8Array(l*b*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,p++)v=w[p],a[4*(h+l*c)+3]=255,a[4*(h+l*c)+2]=y[3*v+0],a[4*(h+l*c)+1]=y[3*v+1],a[4*(h+l*c)+0]=y[3*v+2];return a},t._getImageData16bits=function(n,t,i,r,u,f,e,o,s){for(var l,h,p=i,a=n.width,w=n.height,y=0,v=new Uint8Array(a*w*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,y+=2)l=p[y+0]+(p[y+1]<<8),v[4*(h+a*c)+0]=(31744&l)>>7,v[4*(h+a*c)+1]=(992&l)>>2,v[4*(h+a*c)+2]=(31&l)>>3,v[4*(h+a*c)+3]=32768&l?0:255;return v},t._getImageData24bits=function(n,t,i,r,u,f,e,o,s){for(var h,y=i,l=n.width,p=n.height,v=0,a=new Uint8Array(l*p*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,v+=3)a[4*(h+l*c)+3]=255,a[4*(h+l*c)+2]=y[v+0],a[4*(h+l*c)+1]=y[v+1],a[4*(h+l*c)+0]=y[v+2];return a},t._getImageData32bits=function(n,t,i,r,u,f,e,o,s){for(var h,y=i,l=n.width,p=n.height,a=0,v=new Uint8Array(l*p*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,a+=4)v[4*(h+l*c)+2]=y[a+0],v[4*(h+l*c)+1]=y[a+1],v[4*(h+l*c)+0]=y[a+2],v[4*(h+l*c)+3]=y[a+3];return v},t._getImageDataGrey8bits=function(n,t,i,r,u,f,e,o,s){for(var v,h,p=i,l=n.width,w=n.height,y=0,a=new Uint8Array(l*w*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,y++)v=p[y],a[4*(h+l*c)+0]=v,a[4*(h+l*c)+1]=v,a[4*(h+l*c)+2]=v,a[4*(h+l*c)+3]=255;return a},t._getImageDataGrey16bits=function(n,t,i,r,u,f,e,o,s){for(var h,y=i,l=n.width,p=n.height,a=0,v=new Uint8Array(l*p*4),c=r;c!==f;c+=u)for(h=e;h!==s;h+=o,a+=2)v[4*(h+l*c)+0]=y[a+0],v[4*(h+l*c)+1]=y[a+0],v[4*(h+l*c)+2]=y[a+0],v[4*(h+l*c)+3]=y[a+1];return v},t._TYPE_NO_DATA=0,t._TYPE_INDEXED=1,t._TYPE_RGB=2,t._TYPE_GREY=3,t._TYPE_RLE_INDEXED=9,t._TYPE_RLE_RGB=10,t._TYPE_RLE_GREY=11,t._ORIGIN_MASK=48,t._ORIGIN_SHIFT=4,t._ORIGIN_BL=0,t._ORIGIN_BR=1,t._ORIGIN_UL=2,t._ORIGIN_UR=3,t}();t.TGATools=i}(t=n.Internals||(n.Internals={}))}(BABYLON||(BABYLON={}));!function(n){var t;!function(t){function i(n){return n.charCodeAt(0)+(n.charCodeAt(1)<<8)+(n.charCodeAt(2)<<16)+(n.charCodeAt(3)<<24)}function y(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)}var p=542327876,u=131072,f=512,e=4,o=64,s=131072,w=i("DXT1"),b=i("DXT3"),k=i("DXT5"),h=31,d=0,g=1,c=2,l=3,a=4,v=7,r=20,nt=21,tt=22,it=28,rt=function(){function t(){}return t.GetDDSInfo=function(n){var t=new Int32Array(n,0,h),i=1;return t[c]&u&&(i=Math.max(1,t[v])),{width:t[a],height:t[l],mipmapCount:i,isFourCC:(t[r]&e)===e,isRGB:(t[r]&o)===o,isLuminance:(t[r]&s)===s,isCube:(t[it]&f)===f}},t.GetRGBAArrayBuffer=function(n,t,i,r,u){for(var h,o,f=new Uint8Array(r),s=new Uint8Array(u),e=0,c=t-1;c>=0;c--)for(h=0;n>h;h++)o=i+4*(h+c*n),f[e+2]=s[o],f[e+1]=s[o+1],f[e]=s[o+2],f[e+3]=s[o+3],e+=4;return f},t.GetRGBArrayBuffer=function(n,t,i,r,u){for(var o,s,f=new Uint8Array(r),h=new Uint8Array(u),e=0,c=t-1;c>=0;c--)for(o=0;n>o;o++)s=i+3*(o+c*n),f[e+2]=h[s],f[e+1]=h[s+1],f[e]=h[s+2],e+=3;return f},t.GetLuminanceArrayBuffer=function(n,t,i,r,u){for(var f,h,o=new Uint8Array(r),c=new Uint8Array(u),s=0,e=t-1;e>=0;e--)for(f=0;n>f;f++)h=i+(f+e*n),o[s]=c[h],s++;return o},t.UploadDDSLevels=function(i,r,f,e,o,s){var pt,ct,lt,it,rt,ut,st,ft,vt,ot,et=new Int32Array(f,0,h),wt,at,ht;if(et[d]!=p)return void n.Tools.Error("Invalid magic number in DDS header");if(!e.isFourCC&&!e.isRGB&&!e.isLuminance)return void n.Tools.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(e.isFourCC)switch(pt=et[nt]){case w:ct=8;lt=r.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case b:ct=16;lt=r.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case k:ct=16;lt=r.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return void console.error("Unsupported FourCC code:",y(pt))}for(vt=1,et[c]&u&&o!==!1&&(vt=Math.max(1,et[v])),wt=et[tt],at=0;s>at;at++)for(ht=1==s?i.TEXTURE_2D:i.TEXTURE_CUBE_MAP_POSITIVE_X+at,it=et[a],rt=et[l],st=et[g]+4,ot=0;vt>ot;++ot){if(e.isRGB)24==wt?(ut=it*rt*3,ft=t.GetRGBArrayBuffer(it,rt,st,ut,f),i.texImage2D(ht,ot,i.RGB,it,rt,0,i.RGB,i.UNSIGNED_BYTE,ft)):(ut=it*rt*4,ft=t.GetRGBAArrayBuffer(it,rt,st,ut,f),i.texImage2D(ht,ot,i.RGBA,it,rt,0,i.RGBA,i.UNSIGNED_BYTE,ft));else if(e.isLuminance){var yt=i.getParameter(i.UNPACK_ALIGNMENT),bt=it,kt=Math.floor((it+yt-1)/yt)*yt;ut=kt*(rt-1)+bt;ft=t.GetLuminanceArrayBuffer(it,rt,st,ut,f);i.texImage2D(ht,ot,i.LUMINANCE,it,rt,0,i.LUMINANCE,i.UNSIGNED_BYTE,ft)}else ut=Math.max(4,it)/4*Math.max(4,rt)/4*ct,ft=new Uint8Array(f,st,ut),i.compressedTexImage2D(ht,ot,lt,it,rt,0,ft);st+=ut;it*=.5;rt*=.5;it=Math.max(1,it);rt=Math.max(1,rt)}},t}();t.DDSTools=rt}(t=n.Internals||(n.Internals={}))}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(t){this.length=0;this._duplicateId=0;this.data=new Array(t);this._id=n._GlobalId++}return n.prototype.push=function(n){this.data[this.length++]=n;this.length>this.data.length&&(this.data.length*=2);n.__smartArrayFlags||(n.__smartArrayFlags={});n.__smartArrayFlags[this._id]=this._duplicateId},n.prototype.pushNoDuplicate=function(n){n.__smartArrayFlags&&n.__smartArrayFlags[this._id]===this._duplicateId||this.push(n)},n.prototype.sort=function(n){this.data.sort(n)},n.prototype.reset=function(){this.length=0;this._duplicateId++},n.prototype.concat=function(n){if(0!==n.length){this.length+n.length>this.data.length&&(this.data.length=2*(this.length+n.length));for(var t=0;t<n.length;t++)this.data[this.length++]=(n.data||n)[t]}},n.prototype.concatWithNoDuplicate=function(n){var t,i;if(0!==n.length)for(this.length+n.length>this.data.length&&(this.data.length=2*(this.length+n.length)),t=0;t<n.length;t++)i=(n.data||n)[t],this.pushNoDuplicate(i)},n.prototype.indexOf=function(n){var t=this.data.indexOf(n);return t>=this.length?-1:t},n._GlobalId=0,n}();n.SmartArray=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n){void 0===n&&(n=10);this.count=0;this._initialCapacity=n;this.items={};this._keys=new Array(this._initialCapacity)}return n.prototype.add=function(n,t){return void 0!=this.items[n]?-1:(this.items[n]=t,this._keys[this.count++]=n,this.count>this._keys.length&&(this._keys.length*=2),this.count)},n.prototype.remove=function(n){return void 0==this.items[n]?-1:this.removeItemOfIndex(this.indexOf(n))},n.prototype.removeItemOfIndex=function(n){if(!(n<this.count&&n>-1))return-1;for(delete this.items[this._keys[n]];n<this.count;)this._keys[n]=this._keys[n+1],n++;return--this.count},n.prototype.indexOf=function(n){for(var t=0;t!==this.count;t++)if(this._keys[t]===n)return t;return-1},n.prototype.item=function(n){return this.items[n]},n.prototype.getAllKeys=function(){if(this.count>0){for(var t=new Array(this.count),n=0;n<this.count;n++)t[n]=this._keys[n];return t}return void 0},n.prototype.getKeyByIndex=function(n){if(n<this.count&&n>-1)return this._keys[n]},n.prototype.getItemByIndex=function(n){if(n<this.count&&n>-1)return this.items[this._keys[n]]},n.prototype.empty=function(){this.count>0&&(this.count=0,this.items={},this._keys=new Array(this._initialCapacity))},n.prototype.forEach=function(n){for(var t in this.items)this.items.hasOwnProperty(t)&&n(this.items[t])},n}();n.SmartCollection=t}(BABYLON||(BABYLON={}));!function(n){var t,i=function(t,i){return t?t instanceof n.Mesh?null:t instanceof n.SubMesh?t.clone(i):t.clone?t.clone():null:null},u=function(){function r(){}return r.ToHex=function(n){var t=n.toString(16);return 15>=n?("0"+t).toUpperCase():t.toUpperCase()},r.SetImmediate=function(n){window.setImmediate?window.setImmediate(n):setTimeout(n,1)},r.IsExponantOfTwo=function(n){var t=1;do t*=2;while(n>t);return t===n},r.GetExponantOfTwo=function(n,t){var i=1;do i*=2;while(n>i);return i>t&&(i=t),i},r.GetFilename=function(n){var t=n.lastIndexOf("/");return 0>t?n:n.substring(t+1)},r.GetDOMTextContent=function(n){for(var i="",t=n.firstChild;t;)3===t.nodeType&&(i+=t.textContent),t=t.nextSibling;return i},r.ToDegrees=function(n){return 180*n/Math.PI},r.ToRadians=function(n){return n*Math.PI/180},r.ExtractMinAndMaxIndexed=function(t,i,r,u){for(var s,e=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),o=new n.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),f=r;r+u>f;f++)s=new n.Vector3(t[3*i[f]],t[3*i[f]+1],t[3*i[f]+2]),e=n.Vector3.Minimize(s,e),o=n.Vector3.Maximize(s,o);return{minimum:e,maximum:o}},r.ExtractMinAndMax=function(t,i,r){for(var o,f=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e=new n.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),u=i;i+r>u;u++)o=new n.Vector3(t[3*u],t[3*u+1],t[3*u+2]),f=n.Vector3.Minimize(o,f),e=n.Vector3.Maximize(o,e);return{minimum:f,maximum:e}},r.MakeArray=function(n,t){if(t===!0||void 0!==n&&null!=n)return Array.isArray(n)?n:[n]},r.GetPointerPrefix=function(){var n="pointer";return navigator.pointerEnabled||(n="mouse"),n},r.QueueNewFrame=function(n){window.requestAnimationFrame?window.requestAnimationFrame(n):window.msRequestAnimationFrame?window.msRequestAnimationFrame(n):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(n):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(n):window.oRequestAnimationFrame?window.oRequestAnimationFrame(n):window.setTimeout(n,16)},r.RequestFullscreen=function(n){n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.mozRequestFullScreen&&n.mozRequestFullScreen()},r.ExitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msCancelFullScreen&&document.msCancelFullScreen()},r.CleanUrl=function(n){return n.replace(/#/gm,"%23")},r.LoadImage=function(t,i,u,f){var e,o,c,s,h;if(t=r.CleanUrl(t),e=new Image,"data:"!==t.substr(0,5)&&(e.crossOrigin="anonymous"),e.onload=function(){i(e)},e.onerror=function(){r.Error("Error while trying to load texture: "+t);e.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z";i(e)},o=function(){e.src=t},c=function(){f.loadImageFromDB(t,e)},f&&f.enableTexturesOffline&&n.Database.IsUASupportingBlobStorage)f.openAsync(c,o);else if(-1===t.indexOf("file:"))o();else try{h=t.substring(5);try{s=URL.createObjectURL(n.FilesInput.FilesTextures[h],{oneTimeOnly:!0})}catch(l){s=URL.createObjectURL(n.FilesInput.FilesTextures[h])}e.src=s}catch(a){e.src=null}return e},r.LoadFile=function(t,i,u,f,e,o){var s,h,c;t=r.CleanUrl(t);s=function(){var n=new XMLHttpRequest,f=r.BaseUrl+t;n.open("GET",f,!0);e&&(n.responseType="arraybuffer");n.onprogress=u;n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||r.ValidateXHRData(n,e?6:1))i(e?n.response:n.responseText);else{if(!o)throw new Error("Error status: "+n.status+" - Unable to load "+f);o()}};n.send(null)};h=function(){f.loadFileFromDB(t,i,u,s,e)};-1!==t.indexOf("file:")?(c=t.substring(5),r.ReadFile(n.FilesInput.FilesToLoad[c],i,u,!0)):f&&f.enableSceneOffline?f.openAsync(h,s):s()},r.ReadFileAsDataURL=function(n,t,i){var r=new FileReader;r.onload=function(n){t(n.target.result)};r.onprogress=i;r.readAsDataURL(n)},r.ReadFile=function(n,t,i,u){var f=new FileReader;f.onerror=function(){r.Log("Error while reading file: "+n.name);t(JSON.stringify({autoClear:!0,clearColor:[1,0,0],ambientColor:[0,0,0],gravity:[0,-9.807,0],meshes:[],cameras:[],lights:[]}))};f.onload=function(n){t(n.target.result)};f.onprogress=i;u?f.readAsArrayBuffer(n):f.readAsText(n)},r.Clamp=function(n,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),Math.min(i,Math.max(t,n))},r.Sign=function(n){return n=+n,0===n||isNaN(n)?n:n>0?1:-1},r.Format=function(n,t){return void 0===t&&(t=2),n.toFixed(t)},r.CheckExtends=function(n,t,i){n.x<t.x&&(t.x=n.x);n.y<t.y&&(t.y=n.y);n.z<t.z&&(t.z=n.z);n.x>i.x&&(i.x=n.x);n.y>i.y&&(i.y=n.y);n.z>i.z&&(i.z=n.z)},r.WithinEpsilon=function(n,t,i){void 0===i&&(i=1401298e-51);var r=n-t;return r>=-i&&i>=r},r.DeepCopy=function(n,t,r,u){var f,e,s,o,h;for(f in n)if(("_"!==f[0]||u&&-1!==u.indexOf(f))&&(!r||-1===r.indexOf(f))&&(e=n[f],s=typeof e,"function"!==s))if("object"===s)if(e instanceof Array){if(t[f]=[],e.length>0)if("object"==typeof e[0])for(o=0;o<e.length;o++)h=i(e[o],t),-1===t[f].indexOf(h)&&t[f].push(h);else t[f]=e.slice(0)}else t[f]=i(e,t);else t[f]=e},r.IsEmpty=function(n){for(var t in n)return!1;return!0},r.RegisterTopRootEvents=function(n){for(var t,i=0;i<n.length;i++){t=n[i];window.addEventListener(t.name,t.handler,!1);try{window.parent&&window.parent.addEventListener(t.name,t.handler,!1)}catch(r){}}},r.UnregisterTopRootEvents=function(n){for(var t,i=0;i<n.length;i++){t=n[i];window.removeEventListener(t.name,t.handler);try{window.parent&&window.parent.removeEventListener(t.name,t.handler)}catch(r){}}},r.DumpFramebuffer=function(n,i,r,u){for(var s,c,f,e,k,a,v,l=4*n,d=i/2,o=r.readPixels(0,0,n,i),h=0;d>h;h++)for(s=0;l>s;s++){var y=s+h*l,g=i-h-1,p=s+g*l,nt=o[y];o[y]=o[p];o[p]=nt}t||(t=document.createElement("canvas"));t.width=n;t.height=i;var w=t.getContext("2d"),b=w.createImageData(n,i),tt=b.data;tt.set(o);w.putImageData(b,0,0);c=t.toDataURL();u?u(c):"download"in document.createElement("a")?(f=window.document.createElement("a"),f.href=c,e=new Date,k=e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()+"_"+e.getHours()+"-"+("0"+e.getMinutes()).slice(-2),f.setAttribute("download","screenshot_"+k+".png"),window.document.body.appendChild(f),f.addEventListener("click",function(){f.parentElement.removeChild(f)}),f.click()):(a=window.open(""),v=a.document.createElement("img"),v.src=c,a.document.body.appendChild(v))},r.CreateScreenshot=function(t,i,u,f){var e,o,s=i.getScene(),c=null,h;if(s.activeCamera!==i&&(c=s.activeCamera,s.activeCamera=i),u.precision)e=Math.round(t.getRenderWidth()*u.precision),o=Math.round(e/t.getAspectRatio(i)),u={width:e,height:o};else if(u.width&&u.height)e=u.width,o=u.height;else if(u.width&&!u.height)e=u.width,o=Math.round(e/t.getAspectRatio(i)),u={width:e,height:o};else if(u.height&&!u.width)o=u.height,e=Math.round(o*t.getAspectRatio(i)),u={width:e,height:o};else{if(isNaN(u))return void r.Error("Invalid 'size' parameter !");o=u;e=u}h=new n.RenderTargetTexture("screenShot",u,s,!1,!1);h.renderList=s.meshes;h.onAfterRender=function(){r.DumpFramebuffer(e,o,t,f)};s.incrementRenderId();h.render(!0);h.dispose();c&&(s.activeCamera=c)},r.ValidateXHRData=function(t,i){var r,u;void 0===i&&(i=7);try{if(1&i){if(t.responseText&&t.responseText.length>0)return!0;if(1===i)return!1}if(2&i){if(r=n.Internals.TGATools.GetTGAHeader(t.response),r.width&&r.height&&r.width>0&&r.height>0)return!0;if(2===i)return!1}if(4&i)return u=new Uint8Array(t.response,0,3),68===u[0]&&68===u[1]&&83===u[2]?!0:!1}catch(f){}return!1},Object.defineProperty(r,"NoneLogLevel",{get:function(){return r._NoneLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"MessageLogLevel",{get:function(){return r._MessageLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"WarningLogLevel",{get:function(){return r._WarningLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"ErrorLogLevel",{get:function(){return r._ErrorLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"AllLogLevel",{get:function(){return r._MessageLogLevel|r._WarningLogLevel|r._ErrorLogLevel},enumerable:!0,configurable:!0}),r._AddLogEntry=function(n){r._LogCache=n+r._LogCache;r.OnNewCacheEntry&&r.OnNewCacheEntry(n)},r._FormatMessage=function(n){var t=function(n){return 10>n?"0"+n:""+n},i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+n},r._LogDisabled=function(){},r._LogEnabled=function(n){var t=r._FormatMessage(n),i;console.log("BJS - "+t);i="<div style='color:white'>"+t+"<\/div><br>";r._AddLogEntry(i)},r._WarnDisabled=function(){},r._WarnEnabled=function(n){var t=r._FormatMessage(n),i;console.warn("BJS - "+t);i="<div style='color:orange'>"+t+"<\/div><br>";r._AddLogEntry(i)},r._ErrorDisabled=function(){},r._ErrorEnabled=function(n){var t,i;r.errorsCount++;t=r._FormatMessage(n);console.error("BJS - "+t);i="<div style='color:red'>"+t+"<\/div><br>";r._AddLogEntry(i)},Object.defineProperty(r,"LogCache",{get:function(){return r._LogCache},enumerable:!0,configurable:!0}),r.ClearLogCache=function(){r._LogCache="";r.errorsCount=0},Object.defineProperty(r,"LogLevels",{set:function(n){r.Log=(n&r.MessageLogLevel)===r.MessageLogLevel?r._LogEnabled:r._LogDisabled;r.Warn=(n&r.WarningLogLevel)===r.WarningLogLevel?r._WarnEnabled:r._WarnDisabled;r.Error=(n&r.ErrorLogLevel)===r.ErrorLogLevel?r._ErrorEnabled:r._ErrorDisabled},enumerable:!0,configurable:!0}),Object.defineProperty(r,"PerformanceNoneLogLevel",{get:function(){return r._PerformanceNoneLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"PerformanceUserMarkLogLevel",{get:function(){return r._PerformanceUserMarkLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"PerformanceConsoleLogLevel",{get:function(){return r._PerformanceConsoleLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(r,"PerformanceLogLevel",{set:function(n){return(n&r.PerformanceUserMarkLogLevel)===r.PerformanceUserMarkLogLevel?(r.StartPerformanceCounter=r._StartUserMark,void(r.EndPerformanceCounter=r._EndUserMark)):(n&r.PerformanceConsoleLogLevel)===r.PerformanceConsoleLogLevel?(r.StartPerformanceCounter=r._StartPerformanceConsole,void(r.EndPerformanceCounter=r._EndPerformanceConsole)):(r.StartPerformanceCounter=r._StartPerformanceCounterDisabled,void(r.EndPerformanceCounter=r._EndPerformanceCounterDisabled))},enumerable:!0,configurable:!0}),r._StartPerformanceCounterDisabled=function(){},r._EndPerformanceCounterDisabled=function(){},r._StartUserMark=function(n,t){void 0===t&&(t=!0);t&&r._performance.mark&&r._performance.mark(n+"-Begin")},r._EndUserMark=function(n,t){void 0===t&&(t=!0);t&&r._performance.mark&&(r._performance.mark(n+"-End"),r._performance.measure(n,n+"-Begin",n+"-End"))},r._StartPerformanceConsole=function(n,t){void 0===t&&(t=!0);t&&(r._StartUserMark(n,t),console.time&&console.time(n))},r._EndPerformanceConsole=function(n,t){void 0===t&&(t=!0);t&&(r._EndUserMark(n,t),console.time&&console.timeEnd(n))},Object.defineProperty(r,"Now",{get:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},enumerable:!0,configurable:!0}),r.GetFps=function(){return r.Warn("Tools.GetFps() is deprecated. Please use engine.getFps() instead"),0},r.BaseUrl="",r._NoneLogLevel=0,r._MessageLogLevel=1,r._WarningLogLevel=2,r._ErrorLogLevel=4,r._LogCache="",r.errorsCount=0,r.Log=r._LogEnabled,r.Warn=r._WarnEnabled,r.Error=r._ErrorEnabled,r._PerformanceNoneLogLevel=0,r._PerformanceUserMarkLogLevel=1,r._PerformanceConsoleLogLevel=2,r._performance=window.performance,r.StartPerformanceCounter=r._StartPerformanceCounterDisabled,r.EndPerformanceCounter=r._EndPerformanceCounterDisabled,r}(),r;n.Tools=u;r=function(){function n(n,t,i,r){void 0===r&&(r=0);this.iterations=n;this._fn=t;this._successCallback=i;this.index=r-1;this._done=!1}return n.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},n.prototype.breakLoop=function(){this._done=!0;this._successCallback()},n.Run=function(t,i,r,u){void 0===u&&(u=0);var f=new n(t,i,r,u);return f.executeNext(),f},n.SyncAsyncForLoop=function(t,i,r,u,f,e){void 0===e&&(e=0);n.Run(Math.ceil(t/i),function(n){f&&f()?n.breakLoop():setTimeout(function(){for(var e,u=0;i>u;++u){if(e=n.index*i+u,e>=t)break;if(r(e),f&&f()){n.breakLoop();break}}n.executeNext()},e)},u)},n}();n.AsyncLoop=r}(BABYLON||(BABYLON={}));!function(n){var f=function(){function n(){this._isDepthTestDirty=!1;this._isDepthMaskDirty=!1;this._isDepthFuncDirty=!1;this._isCullFaceDirty=!1;this._isCullDirty=!1;this._isZOffsetDirty=!1}return Object.defineProperty(n.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"zOffset",{get:function(){return this._zOffset},set:function(n){this._zOffset!==n&&(this._zOffset=n,this._isZOffsetDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cullFace",{get:function(){return this._cullFace},set:function(n){this._cullFace!==n&&(this._cullFace=n,this._isCullFaceDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cull",{get:function(){return this._cull},set:function(n){this._cull!==n&&(this._cull=n,this._isCullDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(n){this._depthFunc!==n&&(this._depthFunc=n,this._isDepthFuncDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"depthMask",{get:function(){return this._depthMask},set:function(n){this._depthMask!==n&&(this._depthMask=n,this._isDepthMaskDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"depthTest",{get:function(){return this._depthTest},set:function(n){this._depthTest!==n&&(this._depthTest=n,this._isDepthTestDirty=!0)},enumerable:!0,configurable:!0}),n.prototype.reset=function(){this._depthMask=!0;this._depthTest=!0;this._depthFunc=null;this._cull=null;this._cullFace=null;this._zOffset=0;this._isDepthTestDirty=!0;this._isDepthMaskDirty=!0;this._isDepthFuncDirty=!1;this._isCullFaceDirty=!1;this._isCullDirty=!1;this._isZOffsetDirty=!1},n.prototype.apply=function(n){this.isDirty&&(this._isCullDirty&&(this.cull?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(n.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(n.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(n.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset?(n.enable(n.POLYGON_OFFSET_FILL),n.polygonOffset(this.zOffset,0)):n.disable(n.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1))},n}(),i,u;n._DepthCullingState=f;i=function(){function n(){this._isAlphaBlendDirty=!1;this._isBlendFunctionParametersDirty=!1;this._alphaBlend=!1;this._blendFunctionParameters=new Array(4)}return Object.defineProperty(n.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(n){this._alphaBlend!==n&&(this._alphaBlend=n,this._isAlphaBlendDirty=!0)},enumerable:!0,configurable:!0}),n.prototype.setAlphaBlendFunctionParameters=function(n,t,i,r){(this._blendFunctionParameters[0]!==n||this._blendFunctionParameters[1]!==t||this._blendFunctionParameters[2]!==i||this._blendFunctionParameters[3]!==r)&&(this._blendFunctionParameters[0]=n,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=r,this._isBlendFunctionParametersDirty=!0)},n.prototype.reset=function(){this._alphaBlend=!1;this._blendFunctionParameters[0]=null;this._blendFunctionParameters[1]=null;this._blendFunctionParameters[2]=null;this._blendFunctionParameters[3]=null;this._isAlphaBlendDirty=!0;this._isBlendFunctionParametersDirty=!1},n.prototype.apply=function(n){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?n.enable(n.BLEND):n.disable(n.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(n.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1))},n}();n._AlphaState=i;var e=function(n,t,i,r){var u=n.createShader("vertex"===i?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(n.shaderSource(u,(r?r+"\n":"")+t),n.compileShader(u),!n.getShaderParameter(u,n.COMPILE_STATUS))throw new Error(n.getShaderInfoLog(u));return u},s=function(n,t){var i=n.UNSIGNED_BYTE;return t===u.TEXTURETYPE_FLOAT&&(i=n.FLOAT),i},t=function(t,i,r){var u=r.NEAREST,f=r.NEAREST;return t===n.Texture.BILINEAR_SAMPLINGMODE?(u=r.LINEAR,f=i?r.LINEAR_MIPMAP_NEAREST:r.LINEAR):t===n.Texture.TRILINEAR_SAMPLINGMODE?(u=r.LINEAR,f=i?r.LINEAR_MIPMAP_LINEAR:r.LINEAR):t===n.Texture.NEAREST_SAMPLINGMODE&&(u=r.NEAREST,f=i?r.NEAREST_MIPMAP_LINEAR:r.NEAREST),{min:f,mag:u}},r=function(i,r,u,f,e,o,s,h,c,l){var v;void 0===l&&(l=n.Texture.TRILINEAR_SAMPLINGMODE);var a=u.getEngine(),y=n.Tools.GetExponantOfTwo(f,a.getCaps().maxTextureSize),p=n.Tools.GetExponantOfTwo(e,a.getCaps().maxTextureSize);r.bindTexture(r.TEXTURE_2D,i);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,void 0===o?1:o?1:0);i._baseWidth=f;i._baseHeight=e;i._width=y;i._height=p;i.isReady=!0;c(y,p);v=t(l,!s,r);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,v.mag);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,v.min);s||h||r.generateMipmap(r.TEXTURE_2D);r.bindTexture(r.TEXTURE_2D,null);a._activeTexturesCache=[];u._removePendingData(i)},h=function(t,i,r,u,f){var o=function(){r[i]=e;r._internalCount++;u._removePendingData(e);6===r._internalCount&&f(r)},s=function(){u._removePendingData(e)},e=n.Tools.LoadImage(t,o,s,u.database);u._addPendingData(e)},c=function(n,t,i,r){var f=[],u;for(f._internalCount=0,u=0;6>u;u++)h(n+r[u],u,f,t,i)},o=function(){function n(){}return n}();n.EngineCapabilities=o;u=function(){function u(t,r,e){var s=this,h,c;this.isFullscreen=!1;this.isPointerLock=!1;this.cullBackFaces=!0;this.renderEvenInBackground=!0;this.enableOfflineSupport=!0;this.scenes=[];this._windowIsBackground=!1;this._loadingDivBackgroundColor="black";this._drawCalls=0;this._renderingQueueLaunched=!1;this._activeRenderLoops=[];this.fpsRange=60;this.previousFramesDuration=[];this.fps=60;this.deltaTime=0;this._depthCullingState=new f;this._alphaState=new i;this._alphaMode=u.ALPHA_DISABLE;this._loadedTexturesCache=[];this._activeTexturesCache=[];this._compiledEffects={};this._uintIndicesCurrentlySet=!1;this._renderingCanvas=t;e=e||{};e.antialias=r;void 0===e.preserveDrawingBuffer&&(e.preserveDrawingBuffer=!1);try{this._gl=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(l){throw new Error("WebGL not supported");}if(!this._gl)throw new Error("WebGL not supported");this._onBlur=function(){s._windowIsBackground=!0};this._onFocus=function(){s._windowIsBackground=!1};window.addEventListener("blur",this._onBlur);window.addEventListener("focus",this._onFocus);this._hardwareScalingLevel=1/(window.devicePixelRatio||1);this.resize();this._caps=new o;this._caps.maxTexturesImageUnits=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS);this._caps.maxTextureSize=this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE);this._caps.maxCubemapTextureSize=this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE);this._caps.maxRenderTextureSize=this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE);this._glVersion=this._gl.getParameter(this._gl.VERSION);h=this._gl.getExtension("WEBGL_debug_renderer_info");(null!=h&&(this._glRenderer=this._gl.getParameter(h.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(h.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor="Unknown vendor"),this._glRenderer||(this._glRenderer="Unknown renderer"),this._caps.standardDerivatives=null!==this._gl.getExtension("OES_standard_derivatives"),this._caps.s3tc=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._caps.textureFloat=null!==this._gl.getExtension("OES_texture_float"),this._caps.textureAnisotropicFilterExtension=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.instancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._caps.uintIndices=null!==this._gl.getExtension("OES_element_index_uint"),this._caps.highPrecisionShaderSupported=!0,this._gl.getShaderPrecisionFormat)&&(c=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT),this._caps.highPrecisionShaderSupported=0!=c.precision);this.setDepthBuffer(!0);this.setDepthFunctionToLessOrEqual();this.setDepthWrite(!0);this._onFullscreenChange=function(){void 0!==document.fullscreen?s.isFullscreen=document.fullscreen:void 0!==document.mozFullScreen?s.isFullscreen=document.mozFullScreen:void 0!==document.webkitIsFullScreen?s.isFullscreen=document.webkitIsFullScreen:void 0!==document.msIsFullScreen&&(s.isFullscreen=document.msIsFullScreen);s.isFullscreen&&s._pointerLockRequested&&(t.requestPointerLock=t.requestPointerLock||t.msRequestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock&&t.requestPointerLock())};document.addEventListener("fullscreenchange",this._onFullscreenChange,!1);document.addEventListener("mozfullscreenchange",this._onFullscreenChange,!1);document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1);document.addEventListener("msfullscreenchange",this._onFullscreenChange,!1);this._onPointerLockChange=function(){s.isPointerLock=document.mozPointerLockElement===t||document.webkitPointerLockElement===t||document.msPointerLockElement===t||document.pointerLockElement===t};document.addEventListener("pointerlockchange",this._onPointerLockChange,!1);document.addEventListener("mspointerlockchange",this._onPointerLockChange,!1);document.addEventListener("mozpointerlockchange",this._onPointerLockChange,!1);document.addEventListener("webkitpointerlockchange",this._onPointerLockChange,!1);u.audioEngine||(u.audioEngine=new n.AudioEngine);n.Tools.Log("Babylon.js engine (v"+u.Version+") launched")}return Object.defineProperty(u,"ALPHA_DISABLE",{get:function(){return u._ALPHA_DISABLE},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_ONEONE",{get:function(){return u._ALPHA_ONEONE},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_ADD",{get:function(){return u._ALPHA_ADD},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_COMBINE",{get:function(){return u._ALPHA_COMBINE},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_SUBTRACT",{get:function(){return u._ALPHA_SUBTRACT},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_MULTIPLY",{get:function(){return u._ALPHA_MULTIPLY},enumerable:!0,configurable:!0}),Object.defineProperty(u,"ALPHA_MAXIMIZED",{get:function(){return u._ALPHA_MAXIMIZED},enumerable:!0,configurable:!0}),Object.defineProperty(u,"DELAYLOADSTATE_NONE",{get:function(){return u._DELAYLOADSTATE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(u,"DELAYLOADSTATE_LOADED",{get:function(){return u._DELAYLOADSTATE_LOADED},enumerable:!0,configurable:!0}),Object.defineProperty(u,"DELAYLOADSTATE_LOADING",{get:function(){return u._DELAYLOADSTATE_LOADING},enumerable:!0,configurable:!0}),Object.defineProperty(u,"DELAYLOADSTATE_NOTLOADED",{get:function(){return u._DELAYLOADSTATE_NOTLOADED},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTUREFORMAT_ALPHA",{get:function(){return u._TEXTUREFORMAT_ALPHA},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTUREFORMAT_LUMINANCE",{get:function(){return u._TEXTUREFORMAT_LUMINANCE},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTUREFORMAT_LUMINANCE_ALPHA",{get:function(){return u._TEXTUREFORMAT_LUMINANCE_ALPHA},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTUREFORMAT_RGB",{get:function(){return u._TEXTUREFORMAT_RGB},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTUREFORMAT_RGBA",{get:function(){return u._TEXTUREFORMAT_RGBA},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTURETYPE_UNSIGNED_INT",{get:function(){return u._TEXTURETYPE_UNSIGNED_INT},enumerable:!0,configurable:!0}),Object.defineProperty(u,"TEXTURETYPE_FLOAT",{get:function(){return u._TEXTURETYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(u,"Version",{get:function(){return"2.2.0"},enumerable:!0,configurable:!0}),u.prototype._prepareWorkingCanvas=function(){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"),this._workingContext=this._workingCanvas.getContext("2d"))},u.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},u.prototype.getAspectRatio=function(n){var t=n.viewport;return this.getRenderWidth()*t.width/(this.getRenderHeight()*t.height)},u.prototype.getRenderWidth=function(){return this._currentRenderTarget?this._currentRenderTarget._width:this._renderingCanvas.width},u.prototype.getRenderHeight=function(){return this._currentRenderTarget?this._currentRenderTarget._height:this._renderingCanvas.height},u.prototype.getRenderingCanvas=function(){return this._renderingCanvas},u.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas.getBoundingClientRect()},u.prototype.setHardwareScalingLevel=function(n){this._hardwareScalingLevel=n;this.resize()},u.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},u.prototype.getLoadedTexturesCache=function(){return this._loadedTexturesCache},u.prototype.getCaps=function(){return this._caps},Object.defineProperty(u.prototype,"drawCalls",{get:function(){return this._drawCalls},enumerable:!0,configurable:!0}),u.prototype.resetDrawCalls=function(){this._drawCalls=0},u.prototype.setDepthFunctionToGreater=function(){this._depthCullingState.depthFunc=this._gl.GREATER},u.prototype.setDepthFunctionToGreaterOrEqual=function(){this._depthCullingState.depthFunc=this._gl.GEQUAL},u.prototype.setDepthFunctionToLess=function(){this._depthCullingState.depthFunc=this._gl.LESS},u.prototype.setDepthFunctionToLessOrEqual=function(){this._depthCullingState.depthFunc=this._gl.LEQUAL},u.prototype.stopRenderLoop=function(n){if(!n)return void(this._activeRenderLoops=[]);var t=this._activeRenderLoops.indexOf(n);t>=0&&this._activeRenderLoops.splice(t,1)},u.prototype._renderLoop=function(){var u=this,i=!0,t,r;if(!this.renderEvenInBackground&&this._windowIsBackground&&(i=!1),i){for(this.beginFrame(),t=0;t<this._activeRenderLoops.length;t++)r=this._activeRenderLoops[t],r();this.endFrame()}this._activeRenderLoops.length>0?n.Tools.QueueNewFrame(function(){u._renderLoop()}):this._renderingQueueLaunched=!1},u.prototype.runRenderLoop=function(t){var i=this;-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,n.Tools.QueueNewFrame(function(){i._renderLoop()})))},u.prototype.switchFullscreen=function(t){this.isFullscreen?n.Tools.ExitFullscreen():(this._pointerLockRequested=t,n.Tools.RequestFullscreen(this._renderingCanvas))},u.prototype.clear=function(n,t,i){this.applyStates();this._gl.clearColor(n.r,n.g,n.b,void 0!==n.a?n.a:1);this._depthCullingState.depthMask&&this._gl.clearDepth(1);var r=0;t&&(r|=this._gl.COLOR_BUFFER_BIT);i&&this._depthCullingState.depthMask&&(r|=this._gl.DEPTH_BUFFER_BIT);this._gl.clear(r)},u.prototype.setViewport=function(n,t,i){var r=t||(navigator.isCocoonJS?window.innerWidth:this._renderingCanvas.width),u=i||(navigator.isCocoonJS?window.innerHeight:this._renderingCanvas.height),f=n.x||0,e=n.y||0;this._cachedViewport=n;this._gl.viewport(f*r,e*u,r*n.width,u*n.height)},u.prototype.setDirectViewport=function(n,t,i,r){this._cachedViewport=null;this._gl.viewport(n,t,i,r)},u.prototype.beginFrame=function(){this._measureFps()},u.prototype.endFrame=function(){},u.prototype.resize=function(){var n=navigator.isCocoonJS?window.innerWidth:this._renderingCanvas.clientWidth,t=navigator.isCocoonJS?window.innerHeight:this._renderingCanvas.clientHeight;this.setSize(n/this._hardwareScalingLevel,t/this._hardwareScalingLevel)},u.prototype.setSize=function(n,t){var i,u,r,f;for(this._renderingCanvas.width=n,this._renderingCanvas.height=t,i=0;i<this.scenes.length;i++)for(u=this.scenes[i],r=0;r<u.cameras.length;r++)f=u.cameras[r],f._currentRenderId=0},u.prototype.bindFramebuffer=function(n){this._currentRenderTarget=n;var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,n._framebuffer);this._gl.viewport(0,0,n._width,n._height);this.wipeCaches()},u.prototype.unBindFramebuffer=function(n){if(this._currentRenderTarget=null,n.generateMipMaps){var t=this._gl;t.bindTexture(t.TEXTURE_2D,n);t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)}this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)},u.prototype.flushFramebuffer=function(){this._gl.flush()},u.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget=null;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null);this.setViewport(this._cachedViewport);this.wipeCaches()},u.prototype._resetVertexBufferBinding=function(){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);this._cachedVertexBuffers=null},u.prototype.createVertexBuffer=function(n){var t=this._gl.createBuffer();return this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(n),this._gl.STATIC_DRAW),this._resetVertexBufferBinding(),t.references=1,t},u.prototype.createDynamicVertexBuffer=function(n){var t=this._gl.createBuffer();return this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t),this._gl.bufferData(this._gl.ARRAY_BUFFER,n,this._gl.DYNAMIC_DRAW),this._resetVertexBufferBinding(),t.references=1,t},u.prototype.updateDynamicVertexBuffer=function(n,t,i){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n);void 0===i&&(i=0);t instanceof Float32Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,t):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(t));this._resetVertexBufferBinding()},u.prototype._resetIndexBufferBinding=function(){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,null);this._cachedIndexBuffer=null},u.prototype.createIndexBuffer=function(n){var t=this._gl.createBuffer(),u,i,r;if(this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t),i=!1,this._caps.uintIndices){for(r=0;r<n.length;r++)if(n[r]>65535){i=!0;break}u=i?new Uint32Array(n):new Uint16Array(n)}else u=new Uint16Array(n);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,u,this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),t.references=1,t.is32Bits=i,t},u.prototype.bindBuffers=function(n,t,i,r,u){var e,f,o;if(this._cachedVertexBuffers!==n||this._cachedEffectForVertexBuffers!==u)for(this._cachedVertexBuffers=n,this._cachedEffectForVertexBuffers=u,this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n),e=0,f=0;f<i.length;f++)o=u.getAttributeLocation(f),o>=0&&this._gl.vertexAttribPointer(o,i[f],this._gl.FLOAT,!1,r,e),e+=4*i[f];this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t),this._uintIndicesCurrentlySet=t.is32Bits)},u.prototype.bindMultiBuffers=function(n,t,i){var f,r,e,u,o;if(this._cachedVertexBuffers!==n||this._cachedEffectForVertexBuffers!==i)for(this._cachedVertexBuffers=n,this._cachedEffectForVertexBuffers=i,f=i.getAttributesNames(),r=0;r<f.length;r++)if(e=i.getAttributeLocation(r),e>=0){if(u=n[f[r]],!u)continue;o=u.getStrideSize();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,u.getBuffer());this._gl.vertexAttribPointer(e,o,this._gl.FLOAT,!1,4*o,0)}null!=t&&this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t),this._uintIndicesCurrentlySet=t.is32Bits)},u.prototype._releaseBuffer=function(n){return n.references--,0===n.references?(this._gl.deleteBuffer(n),!0):!1},u.prototype.createInstancesBuffer=function(n){var t=this._gl.createBuffer();return t.capacity=n,this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t),this._gl.bufferData(this._gl.ARRAY_BUFFER,n,this._gl.DYNAMIC_DRAW),t},u.prototype.deleteInstancesBuffer=function(n){this._gl.deleteBuffer(n)},u.prototype.updateAndBindInstancesBuffer=function(n,t,i){var r,u;for(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),r=0;4>r;r++)u=i[r],this._gl.enableVertexAttribArray(u),this._gl.vertexAttribPointer(u,4,this._gl.FLOAT,!1,64,16*r),this._caps.instancedArrays.vertexAttribDivisorANGLE(u,1)},u.prototype.unBindInstancesBuffer=function(n,t){var i,r;for(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n),i=0;4>i;i++)r=t[i],this._gl.disableVertexAttribArray(r),this._caps.instancedArrays.vertexAttribDivisorANGLE(r,0)},u.prototype.applyStates=function(){this._depthCullingState.apply(this._gl);this._alphaState.apply(this._gl)},u.prototype.draw=function(n,t,i,r){this.applyStates();this._drawCalls++;var u=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,f=this._uintIndicesCurrentlySet?4:2;return r?void this._caps.instancedArrays.drawElementsInstancedANGLE(n?this._gl.TRIANGLES:this._gl.LINES,i,u,t*f,r):void this._gl.drawElements(n?this._gl.TRIANGLES:this._gl.LINES,i,u,t*f)},u.prototype.drawPointClouds=function(n,t,i){return this.applyStates(),this._drawCalls++,i?void this._caps.instancedArrays.drawArraysInstancedANGLE(this._gl.POINTS,n,t,i):void this._gl.drawArrays(this._gl.POINTS,n,t)},u.prototype._releaseEffect=function(n){this._compiledEffects[n._key]&&(delete this._compiledEffects[n._key],n.getProgram()&&this._gl.deleteProgram(n.getProgram()))},u.prototype.createEffect=function(t,i,r,u,f,e,o,s){var l=t.vertexElement||t.vertex||t,a=t.fragmentElement||t.fragment||t,h=l+"+"+a+"@"+f,c;return this._compiledEffects[h]?this._compiledEffects[h]:(c=new n.Effect(t,i,r,u,this,f,e,o,s),c._key=h,this._compiledEffects[h]=c,c)},u.prototype.createEffectForParticles=function(n,t,i,r,u,f,e){return void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===r&&(r=""),this.createEffect({vertex:"particles",fragmentElement:n},["position","color","options"],["view","projection"].concat(t),["diffuseSampler"].concat(i),r,u,f,e)},u.prototype.createShaderProgram=function(n,t,i){var f=e(this._gl,n,"vertex",i),o=e(this._gl,t,"fragment",i),r=this._gl.createProgram(),s,u;if(this._gl.attachShader(r,f),this._gl.attachShader(r,o),this._gl.linkProgram(r),s=this._gl.getProgramParameter(r,this._gl.LINK_STATUS),!s&&(u=this._gl.getProgramInfoLog(r),u))throw new Error(u);return this._gl.deleteShader(f),this._gl.deleteShader(o),r},u.prototype.getUniforms=function(n,t){for(var r=[],i=0;i<t.length;i++)r.push(this._gl.getUniformLocation(n,t[i]));return r},u.prototype.getAttributes=function(n,t){for(var i=[],r=0;r<t.length;r++)try{i.push(this._gl.getAttribLocation(n,t[r]))}catch(u){i.push(-1)}return i},u.prototype.enableEffect=function(n){var t,u,i,r;if(!n||!n.getAttributesCount()||this._currentEffect===n)return void(n&&n.onBind&&n.onBind(n));this._vertexAttribArrays=this._vertexAttribArrays||[];this._gl.useProgram(n.getProgram());for(t in this._vertexAttribArrays)t>this._gl.VERTEX_ATTRIB_ARRAY_ENABLED||!this._vertexAttribArrays[t]||(this._vertexAttribArrays[t]=!1,this._gl.disableVertexAttribArray(t));for(u=n.getAttributesCount(),i=0;u>i;i++)r=n.getAttributeLocation(i),r>=0&&(this._vertexAttribArrays[r]=!0,this._gl.enableVertexAttribArray(r));this._currentEffect=n;n.onBind&&n.onBind(n)},u.prototype.setArray=function(n,t){n&&this._gl.uniform1fv(n,t)},u.prototype.setArray2=function(n,t){n&&t.length%2==0&&this._gl.uniform2fv(n,t)},u.prototype.setArray3=function(n,t){n&&t.length%3==0&&this._gl.uniform3fv(n,t)},u.prototype.setArray4=function(n,t){n&&t.length%4==0&&this._gl.uniform4fv(n,t)},u.prototype.setMatrices=function(n,t){n&&this._gl.uniformMatrix4fv(n,!1,t)},u.prototype.setMatrix=function(n,t){n&&this._gl.uniformMatrix4fv(n,!1,t.toArray())},u.prototype.setMatrix3x3=function(n,t){n&&this._gl.uniformMatrix3fv(n,!1,t)},u.prototype.setMatrix2x2=function(n,t){n&&this._gl.uniformMatrix2fv(n,!1,t)},u.prototype.setFloat=function(n,t){n&&this._gl.uniform1f(n,t)},u.prototype.setFloat2=function(n,t,i){n&&this._gl.uniform2f(n,t,i)},u.prototype.setFloat3=function(n,t,i,r){n&&this._gl.uniform3f(n,t,i,r)},u.prototype.setBool=function(n,t){n&&this._gl.uniform1i(n,t)},u.prototype.setFloat4=function(n,t,i,r,u){n&&this._gl.uniform4f(n,t,i,r,u)},u.prototype.setColor3=function(n,t){n&&this._gl.uniform3f(n,t.r,t.g,t.b)},u.prototype.setColor4=function(n,t,i){n&&this._gl.uniform4f(n,t.r,t.g,t.b,i)},u.prototype.setState=function(n,t,i){void 0===t&&(t=0);(this._depthCullingState.cull!==n||i)&&(n?(this._depthCullingState.cullFace=this.cullBackFaces?this._gl.BACK:this._gl.FRONT,this._depthCullingState.cull=!0):this._depthCullingState.cull=!1);this._depthCullingState.zOffset=t},u.prototype.setDepthBuffer=function(n){this._depthCullingState.depthTest=n},u.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask},u.prototype.setDepthWrite=function(n){this._depthCullingState.depthMask=n},u.prototype.setColorWrite=function(n){this._gl.colorMask(n,n,n,n)},u.prototype.setAlphaMode=function(n){if(this._alphaMode!=n){switch(n){case u.ALPHA_DISABLE:this.setDepthWrite(!0);this._alphaState.alphaBlend=!1;break;case u.ALPHA_COMBINE:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case u.ALPHA_ONEONE:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case u.ALPHA_ADD:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case u.ALPHA_SUBTRACT:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case u.ALPHA_MULTIPLY:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case u.ALPHA_MAXIMIZED:this.setDepthWrite(!1);this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0}this._alphaMode=n}},u.prototype.getAlphaMode=function(){return this._alphaMode},u.prototype.setAlphaTesting=function(n){this._alphaTest=n},u.prototype.getAlphaTesting=function(){return this._alphaTest},u.prototype.wipeCaches=function(){this._activeTexturesCache=[];this._currentEffect=null;this._depthCullingState.reset();this._alphaState.reset();this._cachedVertexBuffers=null;this._cachedIndexBuffer=null;this._cachedEffectForVertexBuffers=null},u.prototype.setSamplingMode=function(t,i){var r=this._gl,u,f;r.bindTexture(r.TEXTURE_2D,t);u=r.NEAREST;f=r.NEAREST;i===n.Texture.BILINEAR_SAMPLINGMODE?(u=r.LINEAR,f=r.LINEAR):i===n.Texture.TRILINEAR_SAMPLINGMODE&&(u=r.LINEAR,f=r.LINEAR_MIPMAP_LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,u);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,f);r.bindTexture(r.TEXTURE_2D,null);t.samplingMode=i},u.prototype.createTexture=function(t,i,u,f,e,o,s,h){var c=this,p,l,a,w,k,d,y,v,b;return void 0===e&&(e=n.Texture.TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),void 0===h&&(h=null),l=this._gl.createTexture(),a=!1,("data:"===t.substr(0,5)&&(a=!0),a)?(w=t,a=w.split(":"),t=w,p=a[1].substr(a[1].length-4,4).toLowerCase()):p=t.substr(t.length-4,4).toLowerCase(),k=this.getCaps().s3tc&&".dds"===p,d=".tga"===p,f._addPendingData(l),l.url=t,l.noMipmap=i,l.references=1,l.samplingMode=e,this._loadedTexturesCache.push(l),y=function(){f._removePendingData(l);s&&s()},d?(v=function(t){var s=new Uint8Array(t),h=n.Internals.TGATools.GetTGAHeader(s);r(l,c._gl,f,h.width,h.height,u,i,!1,function(){n.Internals.TGATools.UploadContent(c._gl,s);o&&o()},e)},a instanceof Array?v(h):n.Tools.LoadFile(t,function(n){v(n)},y,f.database,!0)):k?(v=function(t){var s=n.Internals.DDSTools.GetDDSInfo(t),h=(s.isRGB||s.isLuminance||s.mipmapCount>1)&&!i&&s.width>>s.mipmapCount-1==1;r(l,c._gl,f,s.width,s.height,u,!h,s.isFourCC,function(){n.Internals.DDSTools.UploadDDSLevels(c._gl,c.getCaps().s3tc,t,s,h,1);o&&o()},e)},a instanceof Array?v(h):n.Tools.LoadFile(t,function(n){v(n)},y,f.database,!0)):(b=function(t){r(l,c._gl,f,t.width,t.height,u,i,!1,function(i,r){var u=t.width===i&&t.height===r;u||(c._prepareWorkingCanvas(),c._workingCanvas.width=i,c._workingCanvas.height=r,e===n.Texture.NEAREST_SAMPLINGMODE&&(c._workingContext.imageSmoothingEnabled=!1,c._workingContext.mozImageSmoothingEnabled=!1,c._workingContext.oImageSmoothingEnabled=!1,c._workingContext.webkitImageSmoothingEnabled=!1,c._workingContext.msImageSmoothingEnabled=!1),c._workingContext.drawImage(t,0,0,t.width,t.height,0,0,i,r),e===n.Texture.NEAREST_SAMPLINGMODE&&(c._workingContext.imageSmoothingEnabled=!0,c._workingContext.mozImageSmoothingEnabled=!0,c._workingContext.oImageSmoothingEnabled=!0,c._workingContext.webkitImageSmoothingEnabled=!0,c._workingContext.msImageSmoothingEnabled=!0));c._gl.texImage2D(c._gl.TEXTURE_2D,0,c._gl.RGBA,c._gl.RGBA,c._gl.UNSIGNED_BYTE,u?t:c._workingCanvas);o&&o()},e)},a instanceof Array?n.Tools.LoadImage(h,b,y,f.database):n.Tools.LoadImage(t,b,y,f.database)),l},u.prototype.updateRawTexture=function(n,t,i,r,f){void 0===f&&(f=null);var e=this._gl.RGBA;switch(i){case u.TEXTUREFORMAT_ALPHA:e=this._gl.ALPHA;break;case u.TEXTUREFORMAT_LUMINANCE:e=this._gl.LUMINANCE;break;case u.TEXTUREFORMAT_LUMINANCE_ALPHA:e=this._gl.LUMINANCE_ALPHA;break;case u.TEXTUREFORMAT_RGB:e=this._gl.RGB;break;case u.TEXTUREFORMAT_RGBA:e=this._gl.RGBA}this._gl.bindTexture(this._gl.TEXTURE_2D,n);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,void 0===r?1:r?1:0);f?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[f],n._width,n._height,0,t):this._gl.texImage2D(this._gl.TEXTURE_2D,0,e,n._width,n._height,0,e,this._gl.UNSIGNED_BYTE,t);n.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._activeTexturesCache=[];n.isReady=!0},u.prototype.createRawTexture=function(n,i,r,u,f,e,o,s){var h,c;return void 0===s&&(s=null),h=this._gl.createTexture(),h._baseWidth=i,h._baseHeight=r,h._width=i,h._height=r,h.references=1,this.updateRawTexture(h,n,u,e,s),this._gl.bindTexture(this._gl.TEXTURE_2D,h),c=t(o,f,this._gl),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,c.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,c.min),this._gl.bindTexture(this._gl.TEXTURE_2D,null),h.samplingMode=o,this._loadedTexturesCache.push(h),h},u.prototype.createDynamicTexture=function(t,i,r,u,f){void 0===f&&(f=!0);var e=this._gl.createTexture();return e._baseWidth=t,e._baseHeight=i,f&&(t=n.Tools.GetExponantOfTwo(t,this._caps.maxTextureSize),i=n.Tools.GetExponantOfTwo(i,this._caps.maxTextureSize)),this._activeTexturesCache=[],e._width=t,e._height=i,e.isReady=!1,e.generateMipMaps=r,e.references=1,e.samplingMode=u,this.updateTextureSamplingMode(u,e),this._loadedTexturesCache.push(e),e},u.prototype.updateTextureSamplingMode=function(n,i){var r=t(n,i.generateMipMaps,this._gl);this._gl.bindTexture(this._gl.TEXTURE_2D,i);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,r.mag);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,r.min);this._gl.bindTexture(this._gl.TEXTURE_2D,null)},u.prototype.updateDynamicTexture=function(n,t,i){this._gl.bindTexture(this._gl.TEXTURE_2D,n);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,i?1:0);this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);n.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._activeTexturesCache=[];n.isReady=!0},u.prototype.updateVideoTexture=function(n,t,i){if(!n._isDisabled){this._gl.bindTexture(this._gl.TEXTURE_2D,n);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,i?0:1);try{void 0===this._videoTextureSupported&&(this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t),this._videoTextureSupported=0!==this._gl.getError()?!1:!0);this._videoTextureSupported?this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t):(n._workingCanvas||(n._workingCanvas=document.createElement("canvas"),n._workingContext=n._workingCanvas.getContext("2d"),n._workingCanvas.width=n._width,n._workingCanvas.height=n._height),n._workingContext.drawImage(t,0,0,t.videoWidth,t.videoHeight,0,0,n._width,n._height),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,n._workingCanvas));n.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._activeTexturesCache=[];n.isReady=!0}catch(r){n._isDisabled=!0}}},u.prototype.createRenderTargetTexture=function(i,r){var h=!1,c=!0,o=u.TEXTURETYPE_UNSIGNED_INT,l=n.Texture.TRILINEAR_SAMPLINGMODE,f,e,a,p;void 0!==r&&(h=void 0===r.generateMipMaps?r:r.generateMipmaps,c=void 0===r.generateDepthBuffer?!0:r.generateDepthBuffer,o=void 0===r.type?o:r.type,void 0!==r.samplingMode&&(l=r.samplingMode),o===u.TEXTURETYPE_FLOAT&&(l=n.Texture.NEAREST_SAMPLINGMODE));f=this._gl;e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);var v=i.width||i,y=i.height||i,w=t(l,h,f);return o!==u.TEXTURETYPE_FLOAT||this._caps.textureFloat||(o=u.TEXTURETYPE_UNSIGNED_INT,n.Tools.Warn("Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type")),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,w.mag),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,w.min),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,v,y,0,f.RGBA,s(f,o),null),c&&(a=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,a),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,v,y)),p=f.createFramebuffer(),f.bindFramebuffer(f.FRAMEBUFFER,p),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,e,0),c&&f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,a),h&&this._gl.generateMipmap(this._gl.TEXTURE_2D),f.bindTexture(f.TEXTURE_2D,null),f.bindRenderbuffer(f.RENDERBUFFER,null),f.bindFramebuffer(f.FRAMEBUFFER,null),e._framebuffer=p,c&&(e._depthBuffer=a),e._width=v,e._height=y,e.isReady=!0,e.generateMipMaps=h,e.references=1,e.samplingMode=l,this._activeTexturesCache=[],this._loadedTexturesCache.push(e),e},u.prototype.createCubeTexture=function(t,i,r,u){var o=this,f=this._gl,e=f.createTexture(),s,h;return e.isCube=!0,e.url=t,e.references=1,this._loadedTexturesCache.push(e),s=t.substr(t.length-4,4).toLowerCase(),h=this.getCaps().s3tc&&".dds"===s,h?n.Tools.LoadFile(t,function(t){var i=n.Internals.DDSTools.GetDDSInfo(t),r=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&!u;f.bindTexture(f.TEXTURE_CUBE_MAP,e);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,1);n.Internals.DDSTools.UploadDDSLevels(o._gl,o.getCaps().s3tc,t,i,r,6);u||i.isFourCC||1!==i.mipmapCount||f.generateMipmap(f.TEXTURE_CUBE_MAP);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,r?f.LINEAR_MIPMAP_LINEAR:f.LINEAR);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindTexture(f.TEXTURE_CUBE_MAP,null);o._activeTexturesCache=[];e._width=i.width;e._height=i.height;e.isReady=!0},null,null,!0):c(t,i,function(t){var r=n.Tools.GetExponantOfTwo(t[0].width,o._caps.maxCubemapTextureSize),s=r,h,i;for(o._prepareWorkingCanvas(),o._workingCanvas.width=r,o._workingCanvas.height=s,h=[f.TEXTURE_CUBE_MAP_POSITIVE_X,f.TEXTURE_CUBE_MAP_POSITIVE_Y,f.TEXTURE_CUBE_MAP_POSITIVE_Z,f.TEXTURE_CUBE_MAP_NEGATIVE_X,f.TEXTURE_CUBE_MAP_NEGATIVE_Y,f.TEXTURE_CUBE_MAP_NEGATIVE_Z],f.bindTexture(f.TEXTURE_CUBE_MAP,e),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,0),i=0;i<h.length;i++)o._workingContext.drawImage(t[i],0,0,t[i].width,t[i].height,0,0,r,s),f.texImage2D(h[i],0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,o._workingCanvas);u||f.generateMipmap(f.TEXTURE_CUBE_MAP);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,u?f.LINEAR:f.LINEAR_MIPMAP_LINEAR);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindTexture(f.TEXTURE_CUBE_MAP,null);o._activeTexturesCache=[];e._width=r;e._height=s;e.isReady=!0},r),e},u.prototype._releaseTexture=function(n){var i=this._gl,t,r;for(n._framebuffer&&i.deleteFramebuffer(n._framebuffer),n._depthBuffer&&i.deleteRenderbuffer(n._depthBuffer),i.deleteTexture(n),t=0;t<this._caps.maxTexturesImageUnits;t++)this._gl.activeTexture(this._gl["TEXTURE"+t]),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null),this._activeTexturesCache[t]=null;r=this._loadedTexturesCache.indexOf(n);-1!==r&&this._loadedTexturesCache.splice(r,1)},u.prototype.bindSamplers=function(n){var i,t,r;for(this._gl.useProgram(n.getProgram()),i=n.getSamplers(),t=0;t<i.length;t++)r=n.getUniform(i[t]),this._gl.uniform1i(r,t);this._currentEffect=null},u.prototype._bindTexture=function(n,t){this._gl.activeTexture(this._gl["TEXTURE"+n]);this._gl.bindTexture(this._gl.TEXTURE_2D,t);this._activeTexturesCache[n]=null},u.prototype.setTextureFromPostProcess=function(n,t){this._bindTexture(n,t._textures.data[t._currentRenderTextureInd])},u.prototype.setTexture=function(t,i){var r,f;if(!(0>t)){if(!i||!i.isReady())return void(null!=this._activeTexturesCache[t]&&(this._gl.activeTexture(this._gl["TEXTURE"+t]),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null),this._activeTexturesCache[t]=null));if(i instanceof n.VideoTexture)i.update()&&(this._activeTexturesCache[t]=null);else if(i.delayLoadState===u.DELAYLOADSTATE_NOTLOADED)return void i.delayLoad();if(this._activeTexturesCache[t]!==i)if(this._activeTexturesCache[t]=i,r=i.getInternalTexture(),this._gl.activeTexture(this._gl["TEXTURE"+t]),r.isCube)(this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,r),r._cachedCoordinatesMode!==i.coordinatesMode)&&(r._cachedCoordinatesMode=i.coordinatesMode,f=i.coordinatesMode!==n.Texture.CUBIC_MODE&&i.coordinatesMode!==n.Texture.SKYBOX_MODE?this._gl.REPEAT:this._gl.CLAMP_TO_EDGE,this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_WRAP_S,f),this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_WRAP_T,f)),this._setAnisotropicLevel(this._gl.TEXTURE_CUBE_MAP,i);else{if(this._gl.bindTexture(this._gl.TEXTURE_2D,r),r._cachedWrapU!==i.wrapU)switch(r._cachedWrapU=i.wrapU,i.wrapU){case n.Texture.WRAP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.REPEAT);break;case n.Texture.CLAMP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE);break;case n.Texture.MIRROR_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.MIRRORED_REPEAT)}if(r._cachedWrapV!==i.wrapV)switch(r._cachedWrapV=i.wrapV,i.wrapV){case n.Texture.WRAP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.REPEAT);break;case n.Texture.CLAMP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);break;case n.Texture.MIRROR_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.MIRRORED_REPEAT)}this._setAnisotropicLevel(this._gl.TEXTURE_2D,i)}}},u.prototype._setAnisotropicLevel=function(t,i){var u=this._caps.textureAnisotropicFilterExtension,r=i.anisotropicFilteringLevel;i.getInternalTexture().samplingMode===n.Texture.NEAREST_SAMPLINGMODE&&(r=1);u&&i._cachedAnisotropicFilteringLevel!==r&&(this._gl.texParameterf(t,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r,this._caps.maxAnisotropy)),i._cachedAnisotropicFilteringLevel=r)},u.prototype.readPixels=function(n,t,i,r){var u=new Uint8Array(r*i*4);return this._gl.readPixels(n,t,i,r,this._gl.RGBA,this._gl.UNSIGNED_BYTE,u),u},u.prototype.dispose=function(){var t,n;for(this.hideLoadingUI(),this.stopRenderLoop();this.scenes.length;)this.scenes[0].dispose();u.audioEngine.dispose();for(t in this._compiledEffects)this._gl.deleteProgram(this._compiledEffects[t]._program);for(n in this._vertexAttribArrays)n>this._gl.VERTEX_ATTRIB_ARRAY_ENABLED||!this._vertexAttribArrays[n]||this._gl.disableVertexAttribArray(n);this._gl=null;window.removeEventListener("blur",this._onBlur);window.removeEventListener("focus",this._onFocus);document.removeEventListener("fullscreenchange",this._onFullscreenChange);document.removeEventListener("mozfullscreenchange",this._onFullscreenChange);document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange);document.removeEventListener("msfullscreenchange",this._onFullscreenChange);document.removeEventListener("pointerlockchange",this._onPointerLockChange);document.removeEventListener("mspointerlockchange",this._onPointerLockChange);document.removeEventListener("mozpointerlockchange",this._onPointerLockChange);document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)},u.prototype.displayLoadingUI=function(){var i=this,n,r,u,t;this._loadingDiv=document.createElement("div");this._loadingDiv.style.opacity="0";this._loadingDiv.style.transition="opacity 1.5s ease";this._loadingTextDiv=document.createElement("div");this._loadingTextDiv.style.position="absolute";this._loadingTextDiv.style.left="0";this._loadingTextDiv.style.top="50%";this._loadingTextDiv.style.marginTop="80px";this._loadingTextDiv.style.width="100%";this._loadingTextDiv.style.height="20px";this._loadingTextDiv.style.fontFamily="Arial";this._loadingTextDiv.style.fontSize="14px";this._loadingTextDiv.style.color="white";this._loadingTextDiv.style.textAlign="center";this._loadingTextDiv.innerHTML="Loading";this._loadingDiv.appendChild(this._loadingTextDiv);n=new Image;n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAARbSURBVHhe7Z09aFNRFMc716kuLrq4FdyLq4Wi4CAoRQcR0UJBUBdRiuLSIYMo6CA4FF2sgw6CFAdFUOpSQYcWO4hD26UQCfXrIQrx/JJzw1OSWq3NPeL/B4Fy+0jg/HO+7j3vpUcI8b/Q39+/49ihfWdPHT94Yf/e3Se3bd263f8lus218TPn6vV6Ya8Wi/MzNRNmj18iusX9W1evmP1/EKNEIVG6CMbG6E3bt+fT++pHha8NoHdT72bLE8NDg7tGU64gLLndV4Wc4m8j/pS+vr4tGB/DT16v3Fyr8dvBe/jbit8BL0AES9LX1iPAz+BR/hFiLVCynj95dPzNy6fv3IZ/k4L3948Sq7FzYGBg4vLFGxitabuOFCbWNKGrMnbiUuo18KaV6tIHv6YtvL9/nOgE31jCktmrY7k6+/zhE4yP4Vf7hiNqh/BWWEl8mzDol4p22Lf7cIdvdUMEvv0Y2S9fE5S1hLzpqTsPkiep//gFGPnR3Yl7GL5p/xYFBrTwM+iXio3GqpwDGL5p/xYNIX7XG8Q6IJRgdIzf1KBBgafII7oMidhyQtVFaMA2Bt7il4huQRhaXphbcR2g4RXqBzKAGHiCCwGFVUAj/m/RTRDj29cvn10I0PZ3LghH5f4CL1EFlQmqqXK3jDDKFxmhQ3Yt6oQseUZGKmMnTpsOqc8o1F9kBOMjQlOLeqEeIyOc6JV6jYLJD/+XyIFvnzdgl9aXRQ5I2qZDK1SpospMqaoqON/wZZGDciLnMMiXRS7IF4hhqMTNTdk7CFu+LHLhR7BQqBvPDJUUQqCGvCMATHUgBmhWNgApmdOda9YpM+VwRYfuyyIXDK8hBlilNerLIheMZCKGwlUAyru6GlwOgPUbRxADdJ9FAChxXY864viyyEXqPxhc0M2TAfAbatSdRyHtXymhByEdRnE3ky+JnHAIhSA0h74kckETmHoQbSgGwJrCIRMEPSRIBCRIMAhZaYhaggQhJXUJEoRU9mofKwh+F22dLRRfEjlJM7w6KQwCoQpBOKTyJZETjmwRxKqtGV8SOSkNOGjKPQppBEgDDkFgpxdBVGkFgaYQQXRIFQSObk0P5ZFIpAZRHXsQ0r0hCluBWKkuvVbYCkQaCdL5ehBScudJP4yY+rLISdps1NBDEJKXMMmoSfggWC4ZQRR17oFYXph7hSiquIKQ+hJGTX1J5MYSPD/GVdNzsgLBwZVCVyAQAkF0ohiI/c1fS6tNXq9UfEnkhudmIQolsS+J3Hh/UtNDzQLhj42VKJFInqLwFYiUU5ToA+HdfI0JevUpQUAIn+vSz2lHIuUV/dJOIHhOY/IWVWGBIHQtzs88s9zyWBuTgcBLzGOmeNnfF/QslSDgMeQW85i3DOQxuipxAkCyZ8SIm4Omp+7MMlCB59j6sKZcMoM4iIEoeI2J9AKxrFobZx0v4vYInuHFS4J1GQRCAGaLEYQXfyMML5XSQgghhBBCCCH+cXp6vgNhKpSKX/XdOAAAAABJRU5ErkJggg==";n.style.position="absolute";n.style.left="50%";n.style.top="50%";n.style.marginLeft="-50px";n.style.marginTop="-50px";n.style.transition="transform 1.0s ease";n.style.webkitTransition="-webkit-transform 1.0s ease";r=360;u=function(){r+=360;n.style.transform="rotateZ("+r+"deg)";n.style.webkitTransform="rotateZ("+r+"deg)"};n.addEventListener("transitionend",u);n.addEventListener("webkitTransitionEnd",u);this._loadingDiv.appendChild(n);t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAYJSURBVHhe7Zy/qx1FFMff/2Av2Nvbi4WFiiAEY/OQ2IgQsbCJQoqkCAgpFLXyoZURLfwBIiIpgqZJoYQYlWelNsIrNOxDJcrzfHe+G97dnTl75u7euzv7zgcWHrlnZmfOmXPmzI/NjuM4juM4juM4juM4juM4juM4juM4juM45fPic08/uHf5/CvffH7lnT8PfrtxdHS0n3p+/fHGl5+89/prr5599iEWd8bg0rkXHoFyqehKnlxQpjYSDHTm9JMPsGrHylOPPXofvICKXMcIGtXdf/76AYbm6xyNW9e/eAtKC7rbKLXnvHHx5Sf4auc4Ek7OQkFU1Dap/vv37k/wSjblZANFiFIGzw98hhizwqBgs04mCBdQRNCHidoAEtY+lLIvtSdoGFeyql2ZH57HBH4sE7O+o/r9l+8/ZXUni68+2jsHBQQ9qNRGeP/tSxdSYQX/roUcpL4/f3vtM9TD+jTq92n1LQ7jxF1hhGPtwWL3gGccy8JuS1r8sVWBGXNVdSKMYjBGPUJjCzooiGuSpnwlnnOGP2dhHRSLNgpHp2oMKIriK8TmG4Qh/rwW8D6pps9b9im+LDDipXOqMVJrAngBfg9i98gevWKA+/nnCod3Dr5GfaHaDgidVym6HKRjGIkpqthcAVKGxNqBImbEo66kjCih8AOpNmkUmbMuUrR8kEqiU6FvHZLGAPJ71JCYSyhiBqmwFE2GoD6jLGIfDHtG6EzoU4dK21PCqIRMEF0FGRjFzGDtIkXVAdATvsqfT9CJ0JcOFdYiFIsiMlqYy1YOFpQo2OddqBtyEaq9y+efoVh5oPHoROjLKn0j3JIE5Ka8UqZRtGrMnneX6yVofOhDh94MSbznTcpqmDOt1vyQzOgaJAF4F3JBfIXesrNEGWWmjIX7UBZ6jRJbBMLg/DmJiKUGVHleIpnVNTa+jakzkAviJqLhi4MC9XQGBrZeKJZESSrKy7ik0VGFWhQBRDTHIACKQ5l9nAjy75gya4a2w+Jhs0FJdc0xX/GwUbAqFBkZi7QpJ2w16WUbjFyK9MJF3KaoEM74KhVtLrQOrsmRxkbdHEqmSC/c+EuGnIFkjW7Ih2Kr4CCMIvNG2hrrgLpCjiFloooYCjyYrzCRyvhyBthkIPuQtsZGdnbMTezyDiU71KTC5zr7aVsHbsz2tllrEkS5UHwU1tq1HbtPW4UbeB0O7xx8R5EsMJql+BheUmHjkNVmIRP7LutoM3+D4O4tG7vCkNO9ESZ4lL3J6rKRMPx4qKbD/A0icf8CG7tC7kTahnMTwleuYSrsS7GatRAvfZh1tTm5BmmQCdZ8a0Sefe28xUrRBkmFLKy8KTIKUDRX0Y1xagPgwbaIdeFnQULmKak3xvwNMkVGgok/N5XNoehJvejRlCDl9escI28dJU0tZ++nBTJE9mEF647x5Ehbo4s5hDOKFIU0PdofeA5F5k1q63zIWmQqNI/P3ZubjFTqKxQ3jyjHAOX0RdlgVO9hzRFpczRcjZ3Gbxxpc7Qj6+5pTYF2OFXawNI+yDGf1k2NcvOlzBQeDQ/t7zD7DsEDpJ2xATXaNtDWUS4IzP4DS2ljajAVu57SUkYw245ptxZxA5JiZaJ0DswudGn3kYUy54426EjoT4dZfYbccxC2nI92cDkZHQr96jD4AGkMDKeSy/COBsRe6VTSKFN6irLeaCh3IteQjt1E5+oudsG/b/2DfZ5AqsYo8vMDK9LB1HzSsLWvlGThdxXvC6+NsqyPPWP0pMINtbdsajfVeC6f/GZ+cdAofQoB1d+Hf9waY98I7+RXWab3Lt4zYkjHtTnlOLXHYMsCh1zWeQYehu1zfNPOOiys/d91LAKEBSgh6MJMbSA82AaHofDgAIwbgvVvlLNS11nModMm4UZergLHZBZrodmBuA3lBB1thdorSjkOmATMDwg/UBQVtglqQyx6fbEJ+H3IWIapjYAjAfeIgeCMHldueJvFaqDaAHhwf8qNsEEQ1iQbOoUUGIbCLRc8+Bvfp4jyd2FEijuO4ziO4ziO4ziO4ziO4ziO4ziO4ziOUzw7O/8D0P7rcZ/GEboAAAAASUVORK5CYII=";t.style.position="absolute";t.style.left="50%";t.style.top="50%";t.style.marginLeft="-50px";t.style.marginTop="-50px";this._loadingDiv.appendChild(t);this._resizeLoadingUI=function(){var n=i.getRenderingCanvasClientRect();i._loadingDiv.style.position="absolute";i._loadingDiv.style.left=n.left+"px";i._loadingDiv.style.top=n.top+"px";i._loadingDiv.style.width=n.width+"px";i._loadingDiv.style.height=n.height+"px"};this._resizeLoadingUI();window.addEventListener("resize",this._resizeLoadingUI);this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor;document.body.appendChild(this._loadingDiv);setTimeout(function(){i._loadingDiv.style.opacity="1";n.style.transform="rotateZ(360deg)";n.style.webkitTransform="rotateZ(360deg)"},0)},Object.defineProperty(u.prototype,"loadingUIText",{set:function(n){this._loadingDiv&&(this._loadingTextDiv.innerHTML=n)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"loadingUIBackgroundColor",{get:function(){return this._loadingDivBackgroundColor},set:function(n){this._loadingDivBackgroundColor=n;this._loadingDiv&&(this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor)},enumerable:!0,configurable:!0}),u.prototype.hideLoadingUI=function(){var n=this,t;this._loadingDiv&&(t=function(){n._loadingDiv&&(document.body.removeChild(n._loadingDiv),window.removeEventListener("resize",n._resizeLoadingUI),n._loadingDiv=null)},this._loadingDiv.style.opacity="0",this._loadingDiv.addEventListener("transitionend",t))},u.prototype.getFps=function(){return this.fps},u.prototype.getDeltaTime=function(){return this.deltaTime},u.prototype._measureFps=function(){var t,r,i;if(this.previousFramesDuration.push(n.Tools.Now),t=this.previousFramesDuration.length,t>=2&&(this.deltaTime=this.previousFramesDuration[t-1]-this.previousFramesDuration[t-2]),t>=this.fpsRange){for(t>this.fpsRange&&(this.previousFramesDuration.splice(0,1),t=this.previousFramesDuration.length),r=0,i=0;t-1>i;i++)r+=this.previousFramesDuration[i+1]-this.previousFramesDuration[i];this.fps=1e3/(r/(t-1))}},u.isSupported=function(){try{if(navigator.isCocoonJS)return!0;var n=document.createElement("canvas"),t=n.getContext("webgl")||n.getContext("experimental-webgl");return null!=t&&!!window.WebGLRenderingContext}catch(i){return!1}},u._ALPHA_DISABLE=0,u._ALPHA_ADD=1,u._ALPHA_COMBINE=2,u._ALPHA_SUBTRACT=3,u._ALPHA_MULTIPLY=4,u._ALPHA_MAXIMIZED=5,u._ALPHA_ONEONE=6,u._DELAYLOADSTATE_NONE=0,u._DELAYLOADSTATE_LOADED=1,u._DELAYLOADSTATE_LOADING=2,u._DELAYLOADSTATE_NOTLOADED=4,u._TEXTUREFORMAT_ALPHA=0,u._TEXTUREFORMAT_LUMINANCE=1,u._TEXTUREFORMAT_LUMINANCE_ALPHA=2,u._TEXTUREFORMAT_RGB=4,u._TEXTUREFORMAT_RGBA=5,u._TEXTURETYPE_UNSIGNED_INT=0,u._TEXTURETYPE_FLOAT=1,u.Epsilon=.001,u.CollisionsEpsilon=.001,u.CodeRepository="src/",u.ShadersRepository="src/Shaders/",u}();n.Engine=u}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t){this.state="";this.animations=[];this._childrenFlag=-1;this._isEnabled=!0;this._isReady=!0;this._currentRenderId=-1;this._parentRenderId=-1;this.name=n;this.id=n;this._scene=t;this._initCache()}return t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._scene.getEngine()},t.prototype.getWorldMatrix=function(){return n.Matrix.Identity()},t.prototype._initCache=function(){this._cache={};this._cache.parent=void 0},t.prototype.updateCache=function(n){(n||!this.isSynchronized())&&(this._cache.parent=this.parent,this._updateCache())},t.prototype._updateCache=function(){},t.prototype._isSynchronized=function(){return!0},t.prototype._markSyncedWithParent=function(){this._parentRenderId=this.parent._currentRenderId},t.prototype.isSynchronizedWithParent=function(){return this.parent?this._parentRenderId!==this.parent._currentRenderId?!1:this.parent.isSynchronized():!0},t.prototype.isSynchronized=function(n){var t=this.hasNewParent();return t=t||!this.isSynchronizedWithParent(),t=t||!this._isSynchronized(),n&&this.updateCache(!0),!t},t.prototype.hasNewParent=function(n){return this._cache.parent===this.parent?!1:(n&&(this._cache.parent=this.parent),!0)},t.prototype.isReady=function(){return this._isReady},t.prototype.isEnabled=function(){return this._isEnabled?this.parent?this.parent.isEnabled():!0:!1},t.prototype.setEnabled=function(n){this._isEnabled=n},t.prototype.isDescendantOf=function(n){return this.parent?this.parent===n?!0:this.parent.isDescendantOf(n):!1},t.prototype._getDescendants=function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],r.isDescendantOf(this)&&t.push(r)},t.prototype.getDescendants=function(){var n=[];return this._getDescendants(this._scene.meshes,n),this._getDescendants(this._scene.lights,n),this._getDescendants(this._scene.cameras,n),n},t.prototype._setReady=function(n){if(n!=this._isReady){if(!n)return void(this._isReady=!1);this._isReady=!0;this.onReady&&this.onReady(this)}},t}();n.Node=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t,i,r,u,f,e,o){this._engine=n;this._canvas=i;this._currentScene=t;this._sceneLoadedCallback=r;this._progressCallback=u;this._additionnalRenderLoopLogicCallback=f;this._textureLoadingCallback=e;this._startingProcessingFilesCallback=o}return t.prototype.monitorElementForDragNDrop=function(n){var t=this;n&&(this._elementToMonitor=n,this._elementToMonitor.addEventListener("dragenter",function(n){t.drag(n)},!1),this._elementToMonitor.addEventListener("dragover",function(n){t.drag(n)},!1),this._elementToMonitor.addEventListener("drop",function(n){t.drop(n)},!1))},t.prototype.renderFunction=function(){if(this._additionnalRenderLoopLogicCallback&&this._additionnalRenderLoopLogicCallback(),this._currentScene){if(this._textureLoadingCallback){var n=this._currentScene.getWaitingItemsCount();n>0&&this._textureLoadingCallback(n)}this._currentScene.render()}},t.prototype.drag=function(n){n.stopPropagation();n.preventDefault()},t.prototype.drop=function(n){n.stopPropagation();n.preventDefault();this.loadFiles(n)},t.prototype.loadFiles=function(n){if(this._startingProcessingFilesCallback&&this._startingProcessingFilesCallback(),n&&n.dataTransfer&&n.dataTransfer.files&&(this._filesToLoad=n.dataTransfer.files),n&&n.target&&n.target.files&&(this._filesToLoad=n.target.files),this._filesToLoad&&this._filesToLoad.length>0){for(var i=0;i<this._filesToLoad.length;i++)switch(this._filesToLoad[i].type){case"image/jpeg":case"image/png":case"image/bmp":t.FilesTextures[this._filesToLoad[i].name]=this._filesToLoad[i];break;case"image/targa":case"image/vnd.ms-dds":case"audio/wav":case"audio/x-wav":case"audio/mp3":case"audio/mpeg":case"audio/mpeg3":case"audio/x-mpeg-3":case"audio/ogg":t.FilesToLoad[this._filesToLoad[i].name]=this._filesToLoad[i];break;default:-1!==this._filesToLoad[i].name.indexOf(".babylon")&&-1===this._filesToLoad[i].name.indexOf(".manifest")&&-1===this._filesToLoad[i].name.indexOf(".incremental")&&-1===this._filesToLoad[i].name.indexOf(".babylonmeshdata")&&-1===this._filesToLoad[i].name.indexOf(".babylongeometrydata")&&-1===this._filesToLoad[i].name.indexOf(".babylonbinarymeshdata")&&-1===this._filesToLoad[i].name.indexOf(".binary.babylon")&&(this._sceneFileToLoad=this._filesToLoad[i])}this.reload()}},t.prototype.reload=function(){var i=this,t=this;this._sceneFileToLoad?(this._currentScene&&(n.Tools.errorsCount>0&&(n.Tools.ClearLogCache(),n.Tools.Log("Babylon.js engine (v"+n.Engine.Version+") launched")),this._engine.stopRenderLoop(),this._currentScene.dispose()),n.SceneLoader.Load("file:",this._sceneFileToLoad,this._engine,function(n){t._currentScene=n;t._currentScene.executeWhenReady(function(){t._currentScene.activeCamera&&0!==t._currentScene.lights.length||t._currentScene.createDefaultCameraOrLight();t._currentScene.activeCamera.attachControl(t._canvas);t._sceneLoadedCallback&&t._sceneLoadedCallback(i._sceneFileToLoad,t._currentScene);t._engine.runRenderLoop(function(){t.renderFunction()})})},function(n){i._progressCallback&&i._progressCallback(n)})):n.Tools.Error("Please provide a valid .babylon file.")},t.FilesTextures=[],t.FilesToLoad=[],t}();n.FilesInput=t}(BABYLON||(BABYLON={}));!function(n){var i=function(){function n(n,t,i){this.bu=n;this.bv=t;this.distance=i;this.faceId=0;this.subMeshId=0}return n}(),t;n.IntersectionInfo=i;t=function(){function t(){this.hit=!1;this.distance=0;this.pickedPoint=null;this.pickedMesh=null;this.bu=0;this.bv=0;this.faceId=-1;this.subMeshId=0}return t.prototype.getNormal=function(t,i){var u,r;if(void 0===t&&(t=!1),void 0===i&&(i=!0),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.VertexBuffer.NormalKind))return null;if(r=this.pickedMesh.getIndices(),i){var s=this.pickedMesh.getVerticesData(n.VertexBuffer.NormalKind),f=n.Vector3.FromArray(s,3*r[3*this.faceId]),e=n.Vector3.FromArray(s,3*r[3*this.faceId+1]),o=n.Vector3.FromArray(s,3*r[3*this.faceId+2]);f=f.scale(this.bu);e=e.scale(this.bv);o=o.scale(1-this.bu-this.bv);u=new n.Vector3(f.x+e.x+o.x,f.y+e.y+o.y,f.z+e.z+o.z)}else{var h=this.pickedMesh.getVerticesData(n.VertexBuffer.PositionKind),l=n.Vector3.FromArray(h,3*r[3*this.faceId]),c=n.Vector3.FromArray(h,3*r[3*this.faceId+1]),a=n.Vector3.FromArray(h,3*r[3*this.faceId+2]),v=l.subtract(c),y=a.subtract(c);u=n.Vector3.Cross(v,y)}return t&&(u=n.Vector3.TransformNormal(u,this.pickedMesh.getWorldMatrix())),n.Vector3.Normalize(u)},t.prototype.getTextureCoordinates=function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.VertexBuffer.UVKind))return null;var u=this.pickedMesh.getIndices(),f=this.pickedMesh.getVerticesData(n.VertexBuffer.UVKind),t=n.Vector2.FromArray(f,2*u[3*this.faceId]),i=n.Vector2.FromArray(f,2*u[3*this.faceId+1]),r=n.Vector2.FromArray(f,2*u[3*this.faceId+2]);return t=t.scale(1-this.bu-this.bv),i=i.scale(this.bu),r=r.scale(this.bv),new n.Vector2(t.x+i.x+r.x,t.y+i.y+r.y)},t}();n.PickingInfo=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){this.minimum=t;this.maximum=i;this._tempRadiusVector=n.Vector3.Zero();var r=n.Vector3.Distance(t,i);this.center=n.Vector3.Lerp(t,i,.5);this.radius=.5*r;this.centerWorld=n.Vector3.Zero();this._update(n.Matrix.Identity())}return t.prototype._update=function(t){n.Vector3.TransformCoordinatesToRef(this.center,t,this.centerWorld);n.Vector3.TransformNormalFromFloatsToRef(1,1,1,t,this._tempRadiusVector);this.radiusWorld=Math.max(Math.abs(this._tempRadiusVector.x),Math.abs(this._tempRadiusVector.y),Math.abs(this._tempRadiusVector.z))*this.radius},t.prototype.isInFrustum=function(n){for(var t=0;6>t;t++)if(n[t].dotCoordinate(this.centerWorld)<=-this.radiusWorld)return!1;return!0},t.prototype.intersectsPoint=function(t){var i=this.centerWorld.x-t.x,r=this.centerWorld.y-t.y,u=this.centerWorld.z-t.z,f=Math.sqrt(i*i+r*r+u*u);return Math.abs(this.radiusWorld-f)<n.Engine.Epsilon?!1:!0},t.Intersects=function(n,t){var i=n.centerWorld.x-t.centerWorld.x,r=n.centerWorld.y-t.centerWorld.y,u=n.centerWorld.z-t.centerWorld.z,f=Math.sqrt(i*i+r*r+u*u);return n.radiusWorld+t.radiusWorld<f?!1:!0},t}();n.BoundingSphere=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){this.minimum=t;this.maximum=i;this.vectors=[];this.vectorsWorld=[];this.vectors.push(this.minimum.clone());this.vectors.push(this.maximum.clone());this.vectors.push(this.minimum.clone());this.vectors[2].x=this.maximum.x;this.vectors.push(this.minimum.clone());this.vectors[3].y=this.maximum.y;this.vectors.push(this.minimum.clone());this.vectors[4].z=this.maximum.z;this.vectors.push(this.maximum.clone());this.vectors[5].z=this.minimum.z;this.vectors.push(this.maximum.clone());this.vectors[6].x=this.minimum.x;this.vectors.push(this.maximum.clone());this.vectors[7].y=this.minimum.y;this.center=this.maximum.add(this.minimum).scale(.5);this.extendSize=this.maximum.subtract(this.minimum).scale(.5);this.directions=[n.Vector3.Zero(),n.Vector3.Zero(),n.Vector3.Zero()];for(var r=0;r<this.vectors.length;r++)this.vectorsWorld[r]=n.Vector3.Zero();this.minimumWorld=n.Vector3.Zero();this.maximumWorld=n.Vector3.Zero();this._update(n.Matrix.Identity())}return t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(t){var r,i;for(n.Vector3.FromFloatsToRef(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.minimumWorld),n.Vector3.FromFloatsToRef(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.maximumWorld),r=0;r<this.vectors.length;r++)i=this.vectorsWorld[r],n.Vector3.TransformCoordinatesToRef(this.vectors[r],t,i),i.x<this.minimumWorld.x&&(this.minimumWorld.x=i.x),i.y<this.minimumWorld.y&&(this.minimumWorld.y=i.y),i.z<this.minimumWorld.z&&(this.minimumWorld.z=i.z),i.x>this.maximumWorld.x&&(this.maximumWorld.x=i.x),i.y>this.maximumWorld.y&&(this.maximumWorld.y=i.y),i.z>this.maximumWorld.z&&(this.maximumWorld.z=i.z);this.maximumWorld.addToRef(this.minimumWorld,this.center);this.center.scaleInPlace(.5);n.Vector3.FromFloatArrayToRef(t.m,0,this.directions[0]);n.Vector3.FromFloatArrayToRef(t.m,4,this.directions[1]);n.Vector3.FromFloatArrayToRef(t.m,8,this.directions[2]);this._worldMatrix=t},t.prototype.isInFrustum=function(n){return t.IsInFrustum(this.vectorsWorld,n)},t.prototype.isCompletelyInFrustum=function(n){return t.IsCompletelyInFrustum(this.vectorsWorld,n)},t.prototype.intersectsPoint=function(t){var i=-n.Engine.Epsilon;return this.maximumWorld.x-t.x<i||i>t.x-this.minimumWorld.x?!1:this.maximumWorld.y-t.y<i||i>t.y-this.minimumWorld.y?!1:this.maximumWorld.z-t.z<i||i>t.z-this.minimumWorld.z?!1:!0},t.prototype.intersectsSphere=function(n){return t.IntersectsSphere(this.minimumWorld,this.maximumWorld,n.centerWorld,n.radiusWorld)},t.prototype.intersectsMinMax=function(n,t){return this.maximumWorld.x<n.x||this.minimumWorld.x>t.x?!1:this.maximumWorld.y<n.y||this.minimumWorld.y>t.y?!1:this.maximumWorld.z<n.z||this.minimumWorld.z>t.z?!1:!0},t.Intersects=function(n,t){return n.maximumWorld.x<t.minimumWorld.x||n.minimumWorld.x>t.maximumWorld.x?!1:n.maximumWorld.y<t.minimumWorld.y||n.minimumWorld.y>t.maximumWorld.y?!1:n.maximumWorld.z<t.minimumWorld.z||n.minimumWorld.z>t.maximumWorld.z?!1:!0},t.IntersectsSphere=function(t,i,r,u){var f=n.Vector3.Clamp(r,t,i),e=n.Vector3.DistanceSquared(r,f);return u*u>=e},t.IsCompletelyInFrustum=function(n,t){for(var r,i=0;6>i;i++)for(r=0;8>r;r++)if(t[i].dotCoordinate(n[r])<0)return!1;return!0},t.IsInFrustum=function(n,t){for(var u,r,i=0;6>i;i++){for(u=8,r=0;8>r&&t[i].dotCoordinate(n[r])<0;r++)--u;if(0===u)return!1}return!0},t}();n.BoundingBox=t}(BABYLON||(BABYLON={}));!function(n){var i=function(t,i){var r=n.Vector3.Dot(i.center,t),f=Math.abs(n.Vector3.Dot(i.directions[0],t))*i.extendSize.x,e=Math.abs(n.Vector3.Dot(i.directions[1],t))*i.extendSize.y,o=Math.abs(n.Vector3.Dot(i.directions[2],t))*i.extendSize.z,u=f+e+o;return{min:r-u,max:r+u}},r=function(n,t,i,r){return!(n>r||i>t)},t=function(n,t,u){var f=i(n,t),e=i(n,u);return r(f.min,f.max,e.min,e.max)},u=function(){function i(t,i){this.minimum=t;this.maximum=i;this.boundingBox=new n.BoundingBox(t,i);this.boundingSphere=new n.BoundingSphere(t,i)}return i.prototype._update=function(n){this.boundingBox._update(n);this.boundingSphere._update(n)},i.prototype.isInFrustum=function(n){return this.boundingSphere.isInFrustum(n)?this.boundingBox.isInFrustum(n):!1},i.prototype.isCompletelyInFrustum=function(n){return this.boundingBox.isCompletelyInFrustum(n)},i.prototype._checkCollision=function(n){return n._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)},i.prototype.intersectsPoint=function(n){return this.boundingSphere.centerWorld&&this.boundingSphere.intersectsPoint(n)&&this.boundingBox.intersectsPoint(n)?!0:!1},i.prototype.intersects=function(i,r){if(!this.boundingSphere.centerWorld||!i.boundingSphere.centerWorld||!n.BoundingSphere.Intersects(this.boundingSphere,i.boundingSphere)||!n.BoundingBox.Intersects(this.boundingBox,i.boundingBox))return!1;if(!r)return!0;var u=this.boundingBox,f=i.boundingBox;return t(u.directions[0],u,f)&&t(u.directions[1],u,f)&&t(u.directions[2],u,f)&&t(f.directions[0],u,f)&&t(f.directions[1],u,f)&&t(f.directions[2],u,f)&&t(n.Vector3.Cross(u.directions[0],f.directions[0]),u,f)&&t(n.Vector3.Cross(u.directions[0],f.directions[1]),u,f)&&t(n.Vector3.Cross(u.directions[0],f.directions[2]),u,f)&&t(n.Vector3.Cross(u.directions[1],f.directions[0]),u,f)&&t(n.Vector3.Cross(u.directions[1],f.directions[1]),u,f)&&t(n.Vector3.Cross(u.directions[1],f.directions[2]),u,f)&&t(n.Vector3.Cross(u.directions[2],f.directions[0]),u,f)&&t(n.Vector3.Cross(u.directions[2],f.directions[1]),u,f)&&t(n.Vector3.Cross(u.directions[2],f.directions[2]),u,f)?!0:!1},i}();n.BoundingInfo=u}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(r,u){var f=this;t.call(this,r,u);this.definedFacingForward=!0;this.position=new n.Vector3(0,0,0);this.rotation=new n.Vector3(0,0,0);this.scaling=new n.Vector3(1,1,1);this.billboardMode=i.BILLBOARDMODE_NONE;this.visibility=1;this.alphaIndex=Number.MAX_VALUE;this.infiniteDistance=!1;this.isVisible=!0;this.isPickable=!0;this.showBoundingBox=!1;this.showSubMeshesBoundingBox=!1;this.onDispose=null;this.isBlocker=!1;this.renderingGroupId=0;this.receiveShadows=!1;this.renderOutline=!1;this.outlineColor=n.Color3.Red();this.outlineWidth=.02;this.renderOverlay=!1;this.overlayColor=n.Color3.Red();this.overlayAlpha=.5;this.hasVertexAlpha=!1;this.useVertexColors=!0;this.applyFog=!0;this.computeBonesUsingShaders=!0;this.useOctreeForRenderingSelection=!0;this.useOctreeForPicking=!0;this.useOctreeForCollisions=!0;this.layerMask=268435455;this.alwaysSelectAsActiveMesh=!1;this._physicImpostor=n.PhysicsEngine.NoImpostor;this._checkCollisions=!1;this.ellipsoid=new n.Vector3(.5,1,.5);this.ellipsoidOffset=new n.Vector3(0,0,0);this._collider=new n.Collider;this._oldPositionForCollisions=new n.Vector3(0,0,0);this._diffPositionForCollisions=new n.Vector3(0,0,0);this._newPositionForCollisions=new n.Vector3(0,0,0);this.edgesWidth=1;this.edgesColor=new n.Color4(1,0,0,1);this._localScaling=n.Matrix.Zero();this._localRotation=n.Matrix.Zero();this._localTranslation=n.Matrix.Zero();this._localBillboard=n.Matrix.Zero();this._localPivotScaling=n.Matrix.Zero();this._localPivotScalingRotation=n.Matrix.Zero();this._localWorld=n.Matrix.Zero();this._worldMatrix=n.Matrix.Zero();this._rotateYByPI=n.Matrix.RotationY(Math.PI);this._absolutePosition=n.Vector3.Zero();this._collisionsTransformMatrix=n.Matrix.Zero();this._collisionsScalingMatrix=n.Matrix.Zero();this._isDirty=!1;this._pivotMatrix=n.Matrix.Identity();this._isDisposed=!1;this._renderId=0;this._intersectionsInProgress=[];this._onAfterWorldMatrixUpdate=[];this._isWorldMatrixFrozen=!1;this._onCollisionPositionChange=function(t,i,r){void 0===r&&(r=null);f.getScene().workerCollisions&&i.multiplyInPlace(f._collider.radius);i.subtractToRef(f._oldPositionForCollisions,f._diffPositionForCollisions);f._diffPositionForCollisions.length()>n.Engine.CollisionsEpsilon&&f.position.addInPlace(f._diffPositionForCollisions);f.onCollide&&r&&f.onCollide(r)};u.addMesh(this)}return __extends(i,t),Object.defineProperty(i,"BILLBOARDMODE_NONE",{get:function(){return i._BILLBOARDMODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_X",{get:function(){return i._BILLBOARDMODE_X},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_Y",{get:function(){return i._BILLBOARDMODE_Y},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_Z",{get:function(){return i._BILLBOARDMODE_Z},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_ALL",{get:function(){return i._BILLBOARDMODE_ALL},enumerable:!0,configurable:!0}),i.prototype.disableEdgesRendering=function(){void 0!==this._edgesRenderer&&(this._edgesRenderer.dispose(),this._edgesRenderer=void 0)},i.prototype.enableEdgesRendering=function(t,i){void 0===t&&(t=.95);void 0===i&&(i=!1);this.disableEdgesRendering();this._edgesRenderer=new n.EdgesRenderer(this,t,i)},Object.defineProperty(i.prototype,"isBlocked",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.getLOD=function(){return this},i.prototype.getTotalVertices=function(){return 0},i.prototype.getIndices=function(){return null},i.prototype.getVerticesData=function(){return null},i.prototype.isVerticesDataPresent=function(){return!1},i.prototype.getBoundingInfo=function(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfo||this._updateBoundingInfo(),this._boundingInfo)},Object.defineProperty(i.prototype,"useBones",{get:function(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(n.VertexBuffer.MatricesIndicesKind)&&this.isVerticesDataPresent(n.VertexBuffer.MatricesWeightsKind)},enumerable:!0,configurable:!0}),i.prototype._preActivate=function(){},i.prototype._activate=function(n){this._renderId=n},i.prototype.getWorldMatrix=function(){return this._masterMesh?this._masterMesh.getWorldMatrix():(this._currentRenderId!==this.getScene().getRenderId()&&this.computeWorldMatrix(),this._worldMatrix)},Object.defineProperty(i.prototype,"worldMatrixFromCache",{get:function(){return this._worldMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"absolutePosition",{get:function(){return this._absolutePosition},enumerable:!0,configurable:!0}),i.prototype.freezeWorldMatrix=function(){this._isWorldMatrixFrozen=!1;this.computeWorldMatrix(!0);this._isWorldMatrixFrozen=!0},i.prototype.unfreezeWorldMatrix=function(){this._isWorldMatrixFrozen=!1;this.computeWorldMatrix(!0)},Object.defineProperty(i.prototype,"isWorldMatrixFrozen",{get:function(){return this._isWorldMatrixFrozen},enumerable:!0,configurable:!0}),i.prototype.rotate=function(t,i,r){var f,u;(t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=n.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation=n.Vector3.Zero()),r&&r!==n.Space.LOCAL)?(this.parent&&(f=this.parent.getWorldMatrix().clone(),f.invert(),t=n.Vector3.TransformNormal(t,f)),u=n.Quaternion.RotationAxis(t,i),this.rotationQuaternion=u.multiply(this.rotationQuaternion)):(u=n.Quaternion.RotationAxis(t,i),this.rotationQuaternion=this.rotationQuaternion.multiply(u))},i.prototype.translate=function(t,i,r){var u=t.scale(i),f;r&&r!==n.Space.LOCAL?this.setAbsolutePosition(this.getAbsolutePosition().add(u)):(f=this.getPositionExpressedInLocalSpace().add(u),this.setPositionWithLocalVector(f))},i.prototype.getAbsolutePosition=function(){return this.computeWorldMatrix(),this._absolutePosition},i.prototype.setAbsolutePosition=function(t){var i,r,u,f,e;if(t){if(void 0===t.x){if(arguments.length<3)return;i=arguments[0];r=arguments[1];u=arguments[2]}else i=t.x,r=t.y,u=t.z;this.parent?(f=this.parent.getWorldMatrix().clone(),f.invert(),e=new n.Vector3(i,r,u),this.position=n.Vector3.TransformCoordinates(e,f)):(this.position.x=i,this.position.y=r,this.position.z=u)}},i.prototype.movePOV=function(n,t,i){this.position.addInPlace(this.calcMovePOV(n,t,i))},i.prototype.calcMovePOV=function(t,i,r){var e=new n.Matrix,o=this.rotationQuaternion?this.rotationQuaternion:n.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),u,f;return o.toRotationMatrix(e),u=n.Vector3.Zero(),f=this.definedFacingForward?-1:1,n.Vector3.TransformCoordinatesFromFloatsToRef(t*f,i,r*f,e,u),u},i.prototype.rotatePOV=function(n,t,i){this.rotation.addInPlace(this.calcRotatePOV(n,t,i))},i.prototype.calcRotatePOV=function(t,i,r){var u=this.definedFacingForward?1:-1;return new n.Vector3(t*u,i,r*u)},i.prototype.setPivotMatrix=function(n){this._pivotMatrix=n;this._cache.pivotMatrixUpdated=!0},i.prototype.getPivotMatrix=function(){return this._pivotMatrix},i.prototype._isSynchronized=function(){if(this._isDirty||this.billboardMode!==i.BILLBOARDMODE_NONE||this._cache.pivotMatrixUpdated||this.infiniteDistance||!this._cache.position.equals(this.position))return!1;if(this.rotationQuaternion){if(!this._cache.rotationQuaternion.equals(this.rotationQuaternion))return!1}else if(!this._cache.rotation.equals(this.rotation))return!1;return this._cache.scaling.equals(this.scaling)?!0:!1},i.prototype._initCache=function(){t.prototype._initCache.call(this);this._cache.localMatrixUpdated=!1;this._cache.position=n.Vector3.Zero();this._cache.scaling=n.Vector3.Zero();this._cache.rotation=n.Vector3.Zero();this._cache.rotationQuaternion=new n.Quaternion(0,0,0,0)},i.prototype.markAsDirty=function(n){"rotation"===n&&(this.rotationQuaternion=null);this._currentRenderId=Number.MAX_VALUE;this._isDirty=!0},i.prototype._updateBoundingInfo=function(){this._boundingInfo=this._boundingInfo||new n.BoundingInfo(this.absolutePosition,this.absolutePosition);this._boundingInfo._update(this.worldMatrixFromCache);this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)},i.prototype._updateSubMeshesBoundingInfo=function(n){var t,i;if(this.subMeshes)for(t=0;t<this.subMeshes.length;t++)i=this.subMeshes[t],i.updateBoundingInfo(n)},i.prototype.computeWorldMatrix=function(t){var s,f,e,r,u,o;if(this._isWorldMatrixFrozen||!t&&(this._currentRenderId===this.getScene().getRenderId()||this.isSynchronized(!0)))return this._worldMatrix;for((this._cache.position.copyFrom(this.position),this._cache.scaling.copyFrom(this.scaling),this._cache.pivotMatrixUpdated=!1,this._currentRenderId=this.getScene().getRenderId(),this._isDirty=!1,n.Matrix.ScalingToRef(this.scaling.x,this.scaling.y,this.scaling.z,this._localScaling),this.rotationQuaternion?(this.rotationQuaternion.toRotationMatrix(this._localRotation),this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)):(n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._localRotation),this._cache.rotation.copyFrom(this.rotation)),this.infiniteDistance&&!this.parent)?(s=this.getScene().activeCamera,s&&(f=s.getWorldMatrix(),e=new n.Vector3(f.m[12],f.m[13],f.m[14]),n.Matrix.TranslationToRef(this.position.x+e.x,this.position.y+e.y,this.position.z+e.z,this._localTranslation))):n.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._localTranslation),(this._pivotMatrix.multiplyToRef(this._localScaling,this._localPivotScaling),this._localPivotScaling.multiplyToRef(this._localRotation,this._localPivotScalingRotation),this.billboardMode!==i.BILLBOARDMODE_NONE&&this.getScene().activeCamera)&&(r=this.position.clone(),u=this.getScene().activeCamera.globalPosition.clone(),this.parent&&this.parent.position&&(r.addInPlace(this.parent.position),n.Matrix.TranslationToRef(r.x,r.y,r.z,this._localTranslation)),(this.billboardMode&i.BILLBOARDMODE_ALL)!=i.BILLBOARDMODE_ALL&&(this.billboardMode&i.BILLBOARDMODE_X&&(u.x=r.x+n.Engine.Epsilon),this.billboardMode&i.BILLBOARDMODE_Y&&(u.y=r.y+.001),this.billboardMode&i.BILLBOARDMODE_Z&&(u.z=r.z+.001)),n.Matrix.LookAtLHToRef(r,u,n.Vector3.Up(),this._localBillboard),this._localBillboard.m[12]=this._localBillboard.m[13]=this._localBillboard.m[14]=0,this._localBillboard.invert(),this._localPivotScalingRotation.multiplyToRef(this._localBillboard,this._localWorld),this._rotateYByPI.multiplyToRef(this._localWorld,this._localPivotScalingRotation)),this._localPivotScalingRotation.multiplyToRef(this._localTranslation,this._localWorld),this.parent&&this.parent.getWorldMatrix&&this.billboardMode===i.BILLBOARDMODE_NONE?(this._markSyncedWithParent(),this._meshToBoneReferal?(this._localMeshReferalTransform||(this._localMeshReferalTransform=n.Matrix.Zero()),this._localWorld.multiplyToRef(this.parent.getWorldMatrix(),this._localMeshReferalTransform),this._localMeshReferalTransform.multiplyToRef(this._meshToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localWorld.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix)):this._worldMatrix.copyFrom(this._localWorld),this._updateBoundingInfo(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),o=0;o<this._onAfterWorldMatrixUpdate.length;o++)this._onAfterWorldMatrixUpdate[o](this);return this._worldMatrix},i.prototype.registerAfterWorldMatrixUpdate=function(n){this._onAfterWorldMatrixUpdate.push(n)},i.prototype.unregisterAfterWorldMatrixUpdate=function(n){var t=this._onAfterWorldMatrixUpdate.indexOf(n);t>-1&&this._onAfterWorldMatrixUpdate.splice(t,1)},i.prototype.setPositionWithLocalVector=function(t){this.computeWorldMatrix();this.position=n.Vector3.TransformNormal(t,this._localWorld)},i.prototype.getPositionExpressedInLocalSpace=function(){this.computeWorldMatrix();var t=this._localWorld.clone();return t.invert(),n.Vector3.TransformNormal(this.position,t)},i.prototype.locallyTranslate=function(t){this.computeWorldMatrix(!0);this.position=n.Vector3.TransformCoordinates(t,this._localWorld)},i.prototype.lookAt=function(t,i,r,u){i=i||0;r=r||0;u=u||0;var f=t.subtract(this.position),e=-Math.atan2(f.z,f.x)-Math.PI/2,o=Math.sqrt(f.x*f.x+f.z*f.z),s=Math.atan2(f.y,o);this.rotationQuaternion=n.Quaternion.RotationYawPitchRoll(e+i,s+r,u)},i.prototype.attachToBone=function(n,t){this._meshToBoneReferal=t;this.parent=n},i.prototype.detachFromBone=function(){this._meshToBoneReferal=null;this.parent=null},i.prototype.isInFrustum=function(n){return this._boundingInfo.isInFrustum(n)},i.prototype.isCompletelyInFrustum=function(t){t||(t=this.getScene().activeCamera);var i=t.getViewMatrix().multiply(t.getProjectionMatrix());return this._boundingInfo.isCompletelyInFrustum(n.Frustum.GetPlanes(i))?!0:!1},i.prototype.intersectsMesh=function(n,t){return this._boundingInfo&&n._boundingInfo?this._boundingInfo.intersects(n._boundingInfo,t):!1},i.prototype.intersectsPoint=function(n){return this._boundingInfo?this._boundingInfo.intersectsPoint(n):!1},i.prototype.setPhysicsState=function(t,i){var r=this.getScene().getPhysicsEngine();if(r)return t=t||n.PhysicsEngine.NoImpostor,t.impostor&&(i=t,t=t.impostor),t===n.PhysicsEngine.NoImpostor?void r._unregisterMesh(this):(i?(i.mass||0===i.mass||(i.mass=0),i.friction||0===i.friction||(i.friction=.2),i.restitution||0===i.restitution||(i.restitution=.2)):i={mass:0,friction:.2,restitution:.2},this._physicImpostor=t,this._physicsMass=i.mass,this._physicsFriction=i.friction,this._physicRestitution=i.restitution,r._registerMesh(this,t,i))},i.prototype.getPhysicsImpostor=function(){return this._physicImpostor?this._physicImpostor:n.PhysicsEngine.NoImpostor},i.prototype.getPhysicsMass=function(){return this._physicsMass?this._physicsMass:0},i.prototype.getPhysicsFriction=function(){return this._physicsFriction?this._physicsFriction:0},i.prototype.getPhysicsRestitution=function(){return this._physicRestitution?this._physicRestitution:0},i.prototype.getPositionInCameraSpace=function(t){return t||(t=this.getScene().activeCamera),n.Vector3.TransformCoordinates(this.absolutePosition,t.getViewMatrix())},i.prototype.getDistanceToCamera=function(n){return n||(n=this.getScene().activeCamera),this.absolutePosition.subtract(n.position).length()},i.prototype.applyImpulse=function(n,t){this._physicImpostor&&this.getScene().getPhysicsEngine()._applyImpulse(this,n,t)},i.prototype.setPhysicsLinkWith=function(n,t,i,r){this._physicImpostor&&this.getScene().getPhysicsEngine()._createLink(this,n,t,i,r)},i.prototype.updatePhysicsBodyPosition=function(){this._physicImpostor&&this.getScene().getPhysicsEngine()._updateBodyPosition(this)},Object.defineProperty(i.prototype,"checkCollisions",{get:function(){return this._checkCollisions},set:function(n){this._checkCollisions=n;this.getScene().workerCollisions&&this.getScene().collisionCoordinator.onMeshUpdated(this)},enumerable:!0,configurable:!0}),i.prototype.moveWithCollisions=function(n){var t=this.getAbsolutePosition();t.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPositionForCollisions);this._oldPositionForCollisions.addInPlace(this.ellipsoidOffset);this._collider.radius=this.ellipsoid;this.getScene().collisionCoordinator.getNewPosition(this._oldPositionForCollisions,n,this._collider,3,this,this._onCollisionPositionChange,this.uniqueId)},i.prototype.createOrUpdateSubmeshesOctree=function(t,i){void 0===t&&(t=64);void 0===i&&(i=2);this._submeshesOctree||(this._submeshesOctree=new n.Octree(n.Octree.CreationFuncForSubMeshes,t,i));this.computeWorldMatrix(!0);var r=this.getBoundingInfo().boundingBox;return this._submeshesOctree.update(r.minimumWorld,r.maximumWorld,this.subMeshes),this._submeshesOctree},i.prototype._collideForSubMesh=function(t,i,r){if(this._generatePointsArray(),!t._lastColliderWorldVertices||!t._lastColliderTransformMatrix.equals(i)){t._lastColliderTransformMatrix=i.clone();t._lastColliderWorldVertices=[];t._trianglePlanes=[];for(var f=t.verticesStart,e=t.verticesStart+t.verticesCount,u=f;e>u;u++)t._lastColliderWorldVertices.push(n.Vector3.TransformCoordinates(this._positions[u],i))}r._collide(t._trianglePlanes,t._lastColliderWorldVertices,this.getIndices(),t.indexStart,t.indexStart+t.indexCount,t.verticesStart,!!t.getMaterial());r.collisionFound&&(r.collidedMesh=this)},i.prototype._processCollisionsForSubMeshes=function(n,t){var i,r,o,f,u,e;for(this._submeshesOctree&&this.useOctreeForCollisions?(o=n.velocityWorldLength+Math.max(n.radius.x,n.radius.y,n.radius.z),f=this._submeshesOctree.intersects(n.basePointWorld,o),r=f.length,i=f.data):(i=this.subMeshes,r=i.length),u=0;r>u;u++)e=i[u],r>1&&!e._checkCollision(n)||this._collideForSubMesh(e,t,n)},i.prototype._checkCollision=function(t){this._boundingInfo._checkCollision(t)&&(n.Matrix.ScalingToRef(1/t.radius.x,1/t.radius.y,1/t.radius.z,this._collisionsScalingMatrix),this.worldMatrixFromCache.multiplyToRef(this._collisionsScalingMatrix,this._collisionsTransformMatrix),this._processCollisionsForSubMeshes(t,this._collisionsTransformMatrix))},i.prototype._generatePointsArray=function(){return!1},i.prototype.intersects=function(t,i){var r=new n.PickingInfo,e,o,u,v,h,f,c,s,w,a;if(!(this.subMeshes&&this._boundingInfo&&t.intersectsSphere(this._boundingInfo.boundingSphere)&&t.intersectsBox(this._boundingInfo.boundingBox))||!this._generatePointsArray())return r;for(u=null,this._submeshesOctree&&this.useOctreeForPicking?(v=n.Ray.Transform(t,this.getWorldMatrix()),h=this._submeshesOctree.intersectsRay(v),o=h.length,e=h.data):(e=this.subMeshes,o=e.length),f=0;o>f;f++)if(c=e[f],(!(o>1)||c.canIntersects(t))&&(s=c.intersects(t,this._positions,this.getIndices(),i),s&&(i||!u||s.distance<u.distance)&&(u=s,u.subMeshId=f,i)))break;if(u){var y=this.getWorldMatrix(),p=n.Vector3.TransformCoordinates(t.origin,y),l=t.direction.clone();return l=l.scale(u.distance),w=n.Vector3.TransformNormal(l,y),a=p.add(w),r.hit=!0,r.distance=n.Vector3.Distance(p,a),r.pickedPoint=a,r.pickedMesh=this,r.bu=u.bu,r.bv=u.bv,r.faceId=u.faceId,r.subMeshId=u.subMeshId,r}return r},i.prototype.clone=function(){return null},i.prototype.releaseSubMeshes=function(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=[]},i.prototype.dispose=function(t){var i,f,e,r,u;for(this.getPhysicsImpostor()!==n.PhysicsEngine.NoImpostor&&this.setPhysicsState(n.PhysicsEngine.NoImpostor),i=0;i<this._intersectionsInProgress.length;i++)f=this._intersectionsInProgress[i],e=f._intersectionsInProgress.indexOf(this),f._intersectionsInProgress.splice(e,1);if(this._intersectionsInProgress=[],this._edgesRenderer&&(this._edgesRenderer.dispose(),this._edgesRenderer=null),this.releaseSubMeshes(),this.getScene().removeMesh(this),t)for(i=0;i<this.getScene().meshes.length;i++)r=this.getScene().meshes[i],r.parent===this&&(r.parent=null,r.computeWorldMatrix(!0));else{for(i=0;i<this.getScene().particleSystems.length;i++)this.getScene().particleSystems[i].emitter===this&&(this.getScene().particleSystems[i].dispose(),i--);for(u=this.getScene().meshes.slice(0),i=0;i<u.length;i++)u[i].parent===this&&u[i].dispose()}this._onAfterWorldMatrixUpdate=[];this._isDisposed=!0;this.onDispose&&this.onDispose()},i._BILLBOARDMODE_NONE=0,i._BILLBOARDMODE_X=1,i._BILLBOARDMODE_Y=2,i._BILLBOARDMODE_Z=4,i._BILLBOARDMODE_ALL=7,i}(n.Node);n.AbstractMesh=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.diffuse=new n.Color3(1,1,1);this.specular=new n.Color3(1,1,1);this.intensity=1;this.range=Number.MAX_VALUE;this.includeOnlyWithLayerMask=0;this.includedOnlyMeshes=[];this.excludedMeshes=[];this.excludeWithLayerMask=0;this._excludedMeshesIds=[];this._includedOnlyMeshesIds=[];r.addLight(this)}return __extends(i,t),i.prototype.getShadowGenerator=function(){return this._shadowGenerator},i.prototype.getAbsolutePosition=function(){return n.Vector3.Zero()},i.prototype.transferToEffect=function(){},i.prototype._getWorldMatrix=function(){return n.Matrix.Identity()},i.prototype.canAffectMesh=function(n){return n?this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(n)?!1:this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(n)?!1:0!==this.includeOnlyWithLayerMask&&0==(this.includeOnlyWithLayerMask&n.layerMask)?!1:0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&n.layerMask?!1:!0:!0},i.prototype.getWorldMatrix=function(){this._currentRenderId=this.getScene().getRenderId();var t=this._getWorldMatrix();return this.parent&&this.parent.getWorldMatrix?(this._parentedWorldMatrix||(this._parentedWorldMatrix=n.Matrix.Identity()),t.multiplyToRef(this.parent.getWorldMatrix(),this._parentedWorldMatrix),this._markSyncedWithParent(),this._parentedWorldMatrix):t},i.prototype.dispose=function(){this._shadowGenerator&&(this._shadowGenerator.dispose(),this._shadowGenerator=null);this.getScene().removeLight(this)},i}(n.Node);n.Light=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r){t.call(this,n,r);this.position=i}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this._transformedPosition?this._transformedPosition:this.position},i.prototype.transferToEffect=function(t,i){return this.parent&&this.parent.getWorldMatrix?(this._transformedPosition||(this._transformedPosition=n.Vector3.Zero()),n.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this._transformedPosition),void t.setFloat4(i,this._transformedPosition.x,this._transformedPosition.y,this._transformedPosition.z,0)):void t.setFloat4(i,this.position.x,this.position.y,this.position.z,0)},i.prototype.getShadowGenerator=function(){return null},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=n.Matrix.Identity()),n.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i}(n.Light);n.PointLight=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r,u,f,e){t.call(this,n,e);this.position=i;this.direction=r;this.angle=u;this.exponent=f}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this.transformedPosition?this.transformedPosition:this.position},i.prototype.setShadowProjectionMatrix=function(t){var i=this.getScene().activeCamera;n.Matrix.PerspectiveFovLHToRef(this.angle,1,i.minZ,i.maxZ,t)},i.prototype.supportsVSM=function(){return!0},i.prototype.needRefreshPerFrame=function(){return!1},i.prototype.setDirectionToTarget=function(t){return this.direction=n.Vector3.Normalize(t.subtract(this.position)),this.direction},i.prototype.computeTransformedPosition=function(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=n.Vector3.Zero()),n.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),!0):!1},i.prototype.transferToEffect=function(t,i,r){var u;this.parent&&this.parent.getWorldMatrix?(this._transformedDirection||(this._transformedDirection=n.Vector3.Zero()),this.computeTransformedPosition(),n.Vector3.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this._transformedDirection),t.setFloat4(i,this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z,this.exponent),u=n.Vector3.Normalize(this._transformedDirection)):(t.setFloat4(i,this.position.x,this.position.y,this.position.z,this.exponent),u=n.Vector3.Normalize(this.direction));t.setFloat4(r,u.x,u.y,u.z,Math.cos(.5*this.angle))},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=n.Matrix.Identity()),n.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i}(n.Light);n.SpotLight=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u){t.call(this,i,u);this.direction=r;this.groundColor=new n.Color3(0,0,0)}return __extends(i,t),i.prototype.setDirectionToTarget=function(t){return this.direction=n.Vector3.Normalize(t.subtract(n.Vector3.Zero())),this.direction},i.prototype.getShadowGenerator=function(){return null},i.prototype.transferToEffect=function(t,i,r){var u=n.Vector3.Normalize(this.direction);t.setFloat4(i,u.x,u.y,u.z,0);t.setColor3(r,this.groundColor.scale(this.intensity))},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=n.Matrix.Identity()),this._worldMatrix},i}(n.Light);n.HemisphericLight=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r){t.call(this,n,r);this.direction=i;this.shadowOrthoScale=.5;this.position=i.scale(-1)}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this.transformedPosition?this.transformedPosition:this.position},i.prototype.setDirectionToTarget=function(t){return this.direction=n.Vector3.Normalize(t.subtract(this.position)),this.direction},i.prototype.setShadowProjectionMatrix=function(t,i,r){for(var l,a,v,h,y,p,f=Number.MAX_VALUE,e=Number.MIN_VALUE,o=Number.MIN_VALUE,s=Number.MAX_VALUE,u=n.Vector3.Zero(),w=this.getScene().activeCamera,c=0;c<r.length;c++)if(l=r[c],l&&(a=l.getBoundingInfo(),a))for(v=a.boundingBox,h=0;h<v.vectorsWorld.length;h++)n.Vector3.TransformCoordinatesToRef(v.vectorsWorld[h],i,u),u.x<f&&(f=u.x),u.y<s&&(s=u.y),u.x>e&&(e=u.x),u.y>o&&(o=u.y);y=e-f;p=o-s;n.Matrix.OrthoOffCenterLHToRef(f-y*this.shadowOrthoScale,e+y*this.shadowOrthoScale,s-p*this.shadowOrthoScale,o+p*this.shadowOrthoScale,-w.maxZ,w.maxZ,t)},i.prototype.supportsVSM=function(){return!0},i.prototype.needRefreshPerFrame=function(){return!0},i.prototype.computeTransformedPosition=function(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=n.Vector3.Zero()),n.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),!0):!1},i.prototype.transferToEffect=function(t,i){return this.parent&&this.parent.getWorldMatrix?(this._transformedDirection||(this._transformedDirection=n.Vector3.Zero()),n.Vector3.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this._transformedDirection),void t.setFloat4(i,this._transformedDirection.x,this._transformedDirection.y,this._transformedDirection.z,1)):void t.setFloat4(i,this.direction.x,this.direction.y,this.direction.z,1)},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=n.Matrix.Identity()),n.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i}(n.Light);n.DirectionalLight=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(i,r){var u=this,f;this._filter=t.FILTER_NONE;this.blurScale=2;this._blurBoxOffset=0;this._bias=5e-5;this._lightDirection=n.Vector3.Zero();this._darkness=0;this._transparencyShadow=!1;this._viewMatrix=n.Matrix.Zero();this._projectionMatrix=n.Matrix.Zero();this._transformMatrix=n.Matrix.Zero();this._worldViewProjection=n.Matrix.Zero();this._light=r;this._scene=r.getScene();this._mapSize=i;r._shadowGenerator=this;this._shadowMap=new n.RenderTargetTexture(r.name+"_shadowMap",i,this._scene,!1);this._shadowMap.wrapU=n.Texture.CLAMP_ADDRESSMODE;this._shadowMap.wrapV=n.Texture.CLAMP_ADDRESSMODE;this._shadowMap.anisotropicFilteringLevel=1;this._shadowMap.updateSamplingMode(n.Texture.NEAREST_SAMPLINGMODE);this._shadowMap.renderParticles=!1;this._shadowMap.onAfterUnbind=function(){u.useBlurVarianceShadowMap&&(u._shadowMap2||(u._shadowMap2=new n.RenderTargetTexture(r.name+"_shadowMap",i,u._scene,!1),u._shadowMap2.wrapU=n.Texture.CLAMP_ADDRESSMODE,u._shadowMap2.wrapV=n.Texture.CLAMP_ADDRESSMODE,u._shadowMap2.updateSamplingMode(n.Texture.TRILINEAR_SAMPLINGMODE),u._downSamplePostprocess=new n.PassPostProcess("downScale",1/u.blurScale,null,n.Texture.BILINEAR_SAMPLINGMODE,u._scene.getEngine()),u._downSamplePostprocess.onApply=function(n){n.setTexture("textureSampler",u._shadowMap)},u.blurBoxOffset=1),u._scene.postProcessManager.directRender([u._downSamplePostprocess,u._boxBlurPostprocess],u._shadowMap2.getInternalTexture()))};f=function(t){var i=t.getRenderingMesh(),h=u._scene,e=h.getEngine(),r,o,f,s;e.setState(t.getMaterial().backFaceCulling);r=i._getInstancesRenderList(t._id);r.mustReturn||(o=null!==e.getCaps().instancedArrays&&null!==r.visibleInstances[t._id],u.isReady(t,o)?(e.enableEffect(u._effect),i._bind(t,u._effect,n.Material.TriangleFillMode),f=t.getMaterial(),(u._effect.setMatrix("viewProjection",u.getTransformMatrix()),f&&f.needAlphaTesting())&&(s=f.getAlphaTestTexture(),u._effect.setTexture("diffuseSampler",s),u._effect.setMatrix("diffuseMatrix",s.getTextureMatrix())),i.useBones&&i.computeBonesUsingShaders&&u._effect.setMatrices("mBones",i.skeleton.getTransformMatrices()),i._processRendering(t,u._effect,n.Material.TriangleFillMode,r,o,function(n,t){return u._effect.setMatrix("world",t)})):u._shadowMap.resetRefreshCounter())};this._shadowMap.customRenderFunction=function(n,t,i){for(var r=0;r<n.length;r++)f(n.data[r]);for(r=0;r<t.length;r++)f(t.data[r]);if(u._transparencyShadow)for(r=0;r<i.length;r++)f(i.data[r])};this._shadowMap.onClear=function(t){u.useBlurVarianceShadowMap||u.useVarianceShadowMap?t.clear(new n.Color4(0,0,0,0),!0,!0):t.clear(new n.Color4(1,1,1,1),!0,!0)}}return Object.defineProperty(t,"FILTER_NONE",{get:function(){return t._FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_VARIANCESHADOWMAP",{get:function(){return t._FILTER_VARIANCESHADOWMAP},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_POISSONSAMPLING",{get:function(){return t._FILTER_POISSONSAMPLING},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_BLURVARIANCESHADOWMAP",{get:function(){return t._FILTER_BLURVARIANCESHADOWMAP},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bias",{get:function(){return this._bias},set:function(n){this._bias=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blurBoxOffset",{get:function(){return this._blurBoxOffset},set:function(t){var i=this;this._blurBoxOffset!==t&&(this._blurBoxOffset=t,this._boxBlurPostprocess&&this._boxBlurPostprocess.dispose(),this._boxBlurPostprocess=new n.PostProcess("DepthBoxBlur","depthBoxBlur",["screenSize","boxOffset"],[],1/this.blurScale,null,n.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,"#define OFFSET "+t),this._boxBlurPostprocess.onApply=function(n){n.setFloat2("screenSize",i._mapSize/i.blurScale,i._mapSize/i.blurScale)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this._filter},set:function(t){this._filter!==t&&(this._filter=t,this.useVarianceShadowMap||this.useBlurVarianceShadowMap?(this._shadowMap.anisotropicFilteringLevel=16,this._shadowMap.updateSamplingMode(n.Texture.BILINEAR_SAMPLINGMODE)):(this._shadowMap.anisotropicFilteringLevel=1,this._shadowMap.updateSamplingMode(n.Texture.NEAREST_SAMPLINGMODE)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useVarianceShadowMap",{get:function(){return this.filter===t.FILTER_VARIANCESHADOWMAP&&this._light.supportsVSM()},set:function(n){this.filter=n?t.FILTER_VARIANCESHADOWMAP:t.FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usePoissonSampling",{get:function(){return this.filter===t.FILTER_POISSONSAMPLING||!this._light.supportsVSM()&&(this.filter===t.FILTER_VARIANCESHADOWMAP||this.filter===t.FILTER_BLURVARIANCESHADOWMAP)},set:function(n){this.filter=n?t.FILTER_POISSONSAMPLING:t.FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBlurVarianceShadowMap",{get:function(){return this.filter===t.FILTER_BLURVARIANCESHADOWMAP&&this._light.supportsVSM()},set:function(n){this.filter=n?t.FILTER_BLURVARIANCESHADOWMAP:t.FILTER_NONE},enumerable:!0,configurable:!0}),t.prototype.isReady=function(t,i){var u=[],e;(this.useVarianceShadowMap||this.useBlurVarianceShadowMap)&&u.push("#define VSM");var r=[n.VertexBuffer.PositionKind],f=t.getMesh(),o=t.getMaterial();return o&&o.needAlphaTesting()&&(u.push("#define ALPHATEST"),f.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(r.push(n.VertexBuffer.UVKind),u.push("#define UV1")),f.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(r.push(n.VertexBuffer.UV2Kind),u.push("#define UV2"))),f.useBones&&f.computeBonesUsingShaders&&(r.push(n.VertexBuffer.MatricesIndicesKind),r.push(n.VertexBuffer.MatricesWeightsKind),u.push("#define BONES"),u.push("#define BonesPerMesh "+(f.skeleton.bones.length+1))),i&&(u.push("#define INSTANCES"),r.push("world0"),r.push("world1"),r.push("world2"),r.push("world3")),e=u.join("\n"),this._cachedDefines!==e&&(this._cachedDefines=e,this._effect=this._scene.getEngine().createEffect("shadowMap",r,["world","mBones","viewProjection","diffuseMatrix"],["diffuseSampler"],e)),this._effect.isReady()},t.prototype.getShadowMap=function(){return this._shadowMap},t.prototype.getShadowMapForRendering=function(){return this._shadowMap2?this._shadowMap2:this._shadowMap},t.prototype.getLight=function(){return this._light},t.prototype.getTransformMatrix=function(){var i=this._scene,t;return this._currentRenderID===i.getRenderId()?this._transformMatrix:(this._currentRenderID=i.getRenderId(),t=this._light.position,n.Vector3.NormalizeToRef(this._light.direction,this._lightDirection),1==Math.abs(n.Vector3.Dot(this._lightDirection,n.Vector3.Up()))&&(this._lightDirection.z=1e-13),this._light.computeTransformedPosition()&&(t=this._light.transformedPosition),!this._light.needRefreshPerFrame()&&this._cachedPosition&&this._cachedDirection&&t.equals(this._cachedPosition)&&this._lightDirection.equals(this._cachedDirection)||(this._cachedPosition=t.clone(),this._cachedDirection=this._lightDirection.clone(),n.Matrix.LookAtLHToRef(t,this._light.position.add(this._lightDirection),n.Vector3.Up(),this._viewMatrix),this._light.setShadowProjectionMatrix(this._projectionMatrix,this._viewMatrix,this.getShadowMap().renderList),this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)),this._transformMatrix)},t.prototype.getDarkness=function(){return this._darkness},t.prototype.setDarkness=function(n){this._darkness=n>=1?1:0>=n?0:n},t.prototype.setTransparencyShadow=function(n){this._transparencyShadow=n},t.prototype._packHalf=function(t){var i=255*t,r=i-Math.floor(i);return new n.Vector2(t-r/255,r)},t.prototype.dispose=function(){this._shadowMap.dispose();this._shadowMap2&&this._shadowMap2.dispose();this._downSamplePostprocess&&this._downSamplePostprocess.dispose();this._boxBlurPostprocess&&this._boxBlurPostprocess.dispose()},t._FILTER_NONE=0,t._FILTER_VARIANCESHADOWMAP=1,t._FILTER_POISSONSAMPLING=2,t._FILTER_BLURVARIANCESHADOWMAP=3,t}();n.ShadowGenerator=t}(BABYLON||(BABYLON={}));!function(n){var i=function(n,t,i,r){return n.x>i.x+r?!1:i.x-r>t.x?!1:n.y>i.y+r?!1:i.y-r>t.y?!1:n.z>i.z+r?!1:i.z-r>t.z?!1:!0},t=function(n,t,i,r){var o=t*t-4*n*i,u={root:0,found:!1},h;if(0>o)return u;var s=Math.sqrt(o),f=(-t-s)/(2*n),e=(-t+s)/(2*n);return f>e&&(h=e,e=f,f=h),f>0&&r>f?(u.root=f,u.found=!0,u):e>0&&r>e?(u.root=e,u.found=!0,u):u},r=function(){function r(){this.radius=new n.Vector3(1,1,1);this.retry=0;this.basePointWorld=n.Vector3.Zero();this.velocityWorld=n.Vector3.Zero();this.normalizedVelocity=n.Vector3.Zero();this._collisionPoint=n.Vector3.Zero();this._planeIntersectionPoint=n.Vector3.Zero();this._tempVector=n.Vector3.Zero();this._tempVector2=n.Vector3.Zero();this._tempVector3=n.Vector3.Zero();this._tempVector4=n.Vector3.Zero();this._edge=n.Vector3.Zero();this._baseToVertex=n.Vector3.Zero();this._destinationPoint=n.Vector3.Zero();this._slidePlaneNormal=n.Vector3.Zero();this._displacementVector=n.Vector3.Zero()}return r.prototype._initialize=function(t,i,r){this.velocity=i;n.Vector3.NormalizeToRef(i,this.normalizedVelocity);this.basePoint=t;t.multiplyToRef(this.radius,this.basePointWorld);i.multiplyToRef(this.radius,this.velocityWorld);this.velocityWorldLength=this.velocityWorld.length();this.epsilon=r;this.collisionFound=!1},r.prototype._checkPointInTriangle=function(t,i,r,u,f){i.subtractToRef(t,this._tempVector);r.subtractToRef(t,this._tempVector2);n.Vector3.CrossToRef(this._tempVector,this._tempVector2,this._tempVector4);var e=n.Vector3.Dot(this._tempVector4,f);return 0>e?!1:(u.subtractToRef(t,this._tempVector3),n.Vector3.CrossToRef(this._tempVector2,this._tempVector3,this._tempVector4),e=n.Vector3.Dot(this._tempVector4,f),0>e?!1:(n.Vector3.CrossToRef(this._tempVector3,this._tempVector,this._tempVector4),e=n.Vector3.Dot(this._tempVector4,f),e>=0))},r.prototype._canDoCollision=function(t,r,u,f){var o=n.Vector3.Distance(this.basePointWorld,t),e=Math.max(this.radius.x,this.radius.y,this.radius.z);return o>this.velocityWorldLength+e+r?!1:i(u,f,this.basePointWorld,this.velocityWorldLength+e)?!0:!1},r.prototype._testTriangle=function(i,r,u,f,e,o){var v,ut=!1,d,tt,it,g,ft,b,h,nt,k,y,rt;if(r||(r=[]),r[i]||(r[i]=new n.Plane(0,0,0,0),r[i].copyFromPoints(u,f,e)),d=r[i],o||d.isFrontFacingTo(this.normalizedVelocity,0)){if(tt=d.signedDistanceTo(this.basePoint),it=n.Vector3.Dot(d.normal,this.velocity),0==it){if(Math.abs(tt)>=1)return;ut=!0;v=0}else{if(v=(-1-tt)/it,g=(1-tt)/it,v>g&&(ft=g,g=v,v=ft),v>1||0>g)return;0>v&&(v=0);v>1&&(v=1)}if(this._collisionPoint.copyFromFloats(0,0,0),b=!1,h=1,ut||(this.basePoint.subtractToRef(d.normal,this._planeIntersectionPoint),this.velocity.scaleToRef(v,this._tempVector),this._planeIntersectionPoint.addInPlace(this._tempVector),this._checkPointInTriangle(this._planeIntersectionPoint,u,f,e,d.normal)&&(b=!0,h=v,this._collisionPoint.copyFrom(this._planeIntersectionPoint))),!b){nt=this.velocity.lengthSquared();k=nt;this.basePoint.subtractToRef(u,this._tempVector);var p=2*n.Vector3.Dot(this.velocity,this._tempVector),w=this._tempVector.lengthSquared()-1,s=t(k,p,w,h);s.found&&(h=s.root,b=!0,this._collisionPoint.copyFrom(u));this.basePoint.subtractToRef(f,this._tempVector);p=2*n.Vector3.Dot(this.velocity,this._tempVector);w=this._tempVector.lengthSquared()-1;s=t(k,p,w,h);s.found&&(h=s.root,b=!0,this._collisionPoint.copyFrom(f));this.basePoint.subtractToRef(e,this._tempVector);p=2*n.Vector3.Dot(this.velocity,this._tempVector);w=this._tempVector.lengthSquared()-1;s=t(k,p,w,h);s.found&&(h=s.root,b=!0,this._collisionPoint.copyFrom(e));f.subtractToRef(u,this._edge);u.subtractToRef(this.basePoint,this._baseToVertex);var c=this._edge.lengthSquared(),l=n.Vector3.Dot(this._edge,this.velocity),a=n.Vector3.Dot(this._edge,this._baseToVertex);(k=c*-nt+l*l,p=2*c*n.Vector3.Dot(this.velocity,this._baseToVertex)-2*l*a,w=c*(1-this._baseToVertex.lengthSquared())+a*a,s=t(k,p,w,h),s.found)&&(y=(l*s.root-a)/c,y>=0&&1>=y&&(h=s.root,b=!0,this._edge.scaleInPlace(y),u.addToRef(this._edge,this._collisionPoint)));e.subtractToRef(f,this._edge);f.subtractToRef(this.basePoint,this._baseToVertex);c=this._edge.lengthSquared();l=n.Vector3.Dot(this._edge,this.velocity);a=n.Vector3.Dot(this._edge,this._baseToVertex);k=c*-nt+l*l;p=2*c*n.Vector3.Dot(this.velocity,this._baseToVertex)-2*l*a;w=c*(1-this._baseToVertex.lengthSquared())+a*a;s=t(k,p,w,h);s.found&&(y=(l*s.root-a)/c,y>=0&&1>=y&&(h=s.root,b=!0,this._edge.scaleInPlace(y),f.addToRef(this._edge,this._collisionPoint)));u.subtractToRef(e,this._edge);e.subtractToRef(this.basePoint,this._baseToVertex);c=this._edge.lengthSquared();l=n.Vector3.Dot(this._edge,this.velocity);a=n.Vector3.Dot(this._edge,this._baseToVertex);k=c*-nt+l*l;p=2*c*n.Vector3.Dot(this.velocity,this._baseToVertex)-2*l*a;w=c*(1-this._baseToVertex.lengthSquared())+a*a;s=t(k,p,w,h);s.found&&(y=(l*s.root-a)/c,y>=0&&1>=y&&(h=s.root,b=!0,this._edge.scaleInPlace(y),e.addToRef(this._edge,this._collisionPoint)))}b&&(rt=h*this.velocity.length(),(!this.collisionFound||rt<this.nearestDistance)&&(this.intersectionPoint?this.intersectionPoint.copyFrom(this._collisionPoint):this.intersectionPoint=this._collisionPoint.clone(),this.nearestDistance=rt,this.collisionFound=!0))}},r.prototype._collide=function(n,t,i,r,u,f,e){for(var o=r;u>o;o+=3){var s=t[i[o]-f],h=t[i[o+1]-f],c=t[i[o+2]-f];this._testTriangle(o,n,c,h,s,e)}},r.prototype._getResponse=function(t,i){t.addToRef(i,this._destinationPoint);i.scaleInPlace(this.nearestDistance/i.length());this.basePoint.addToRef(i,t);t.subtractToRef(this.intersectionPoint,this._slidePlaneNormal);this._slidePlaneNormal.normalize();this._slidePlaneNormal.scaleToRef(this.epsilon,this._displacementVector);t.addInPlace(this._displacementVector);this.intersectionPoint.addInPlace(this._displacementVector);this._slidePlaneNormal.scaleInPlace(n.Plane.SignedDistanceToPlaneFromPositionAndNormal(this.intersectionPoint,this._slidePlaneNormal,this._destinationPoint));this._destinationPoint.subtractInPlace(this._slidePlaneNormal);this._destinationPoint.subtractToRef(this.intersectionPoint,i)},r}();n.Collider=r}(BABYLON||(BABYLON={}));!function(n){var t,i,r,u;n.CollisionWorker="",function(n){n[n.INIT=0]="INIT";n[n.UPDATE=1]="UPDATE";n[n.COLLIDE=2]="COLLIDE"}(n.WorkerTaskType||(n.WorkerTaskType={}));t=n.WorkerTaskType;!function(n){n[n.SUCCESS=0]="SUCCESS";n[n.UNKNOWN_ERROR=1]="UNKNOWN_ERROR"}(n.WorkerReplyType||(n.WorkerReplyType={}));i=n.WorkerReplyType;r=function(){function r(){var u=this;this._scaledPosition=n.Vector3.Zero();this._scaledVelocity=n.Vector3.Zero();this.onMeshUpdated=function(n){u._addUpdateMeshesList[n.uniqueId]=r.SerializeMesh(n)};this.onGeometryUpdated=function(n){u._addUpdateGeometriesList[n.id]=r.SerializeGeometry(n)};this._afterRender=function(){var n;if(u._init&&!(0==u._toRemoveGeometryArray.length&&0==u._toRemoveMeshesArray.length&&0==Object.keys(u._addUpdateGeometriesList).length&&0==Object.keys(u._addUpdateMeshesList).length||u._runningUpdated>4)){++u._runningUpdated;var f={updatedMeshes:u._addUpdateMeshesList,updatedGeometries:u._addUpdateGeometriesList,removedGeometries:u._toRemoveGeometryArray,removedMeshes:u._toRemoveMeshesArray},i={payload:f,taskType:t.UPDATE},r=[];for(n in f.updatedGeometries)f.updatedGeometries.hasOwnProperty(n)&&(r.push(i.payload.updatedGeometries[n].indices.buffer),r.push(i.payload.updatedGeometries[n].normals.buffer),r.push(i.payload.updatedGeometries[n].positions.buffer));u._worker.postMessage(i,r);u._addUpdateMeshesList={};u._addUpdateGeometriesList={};u._toRemoveGeometryArray=[];u._toRemoveMeshesArray=[]}};this._onMessageFromWorker=function(r){var e=r.data,f;if(e.error!=i.SUCCESS)return void n.Tools.Warn("error returned from worker!");switch(e.taskType){case t.INIT:u._init=!0;u._scene.meshes.forEach(function(n){u.onMeshAdded(n)});u._scene.getGeometries().forEach(function(n){u.onGeometryAdded(n)});break;case t.UPDATE:u._runningUpdated--;break;case t.COLLIDE:if(u._runningCollisionTask=!1,f=e.payload,!u._collisionsCallbackArray[f.collisionId])return;u._collisionsCallbackArray[f.collisionId](f.collisionId,n.Vector3.FromArray(f.newPosition),u._scene.getMeshByUniqueID(f.collidedMeshUniqueId));u._collisionsCallbackArray[f.collisionId]=void 0}};this._collisionsCallbackArray=[];this._init=!1;this._runningUpdated=0;this._runningCollisionTask=!1;this._addUpdateMeshesList={};this._addUpdateGeometriesList={};this._toRemoveGeometryArray=[];this._toRemoveMeshesArray=[]}return r.prototype.getNewPosition=function(n,i,r,u,f,e,o){if(this._init&&!this._collisionsCallbackArray[o]&&!this._collisionsCallbackArray[o+1e5]){n.divideToRef(r.radius,this._scaledPosition);i.divideToRef(r.radius,this._scaledVelocity);this._collisionsCallbackArray[o]=e;var s={collider:{position:this._scaledPosition.asArray(),velocity:this._scaledVelocity.asArray(),radius:r.radius.asArray()},collisionId:o,excludedMeshUniqueId:f?f.uniqueId:null,maximumRetry:u},h={payload:s,taskType:t.COLLIDE};this._worker.postMessage(h)}},r.prototype.init=function(i){var r,u;this._scene=i;this._scene.registerAfterRender(this._afterRender);r=n.WorkerIncluded?n.Engine.CodeRepository+"Collisions/babylon.collisionWorker.js":URL.createObjectURL(new Blob([n.CollisionWorker],{type:"application/javascript"}));this._worker=new Worker(r);this._worker.onmessage=this._onMessageFromWorker;u={payload:{},taskType:t.INIT};this._worker.postMessage(u)},r.prototype.destroy=function(){this._scene.unregisterAfterRender(this._afterRender);this._worker.terminate()},r.prototype.onMeshAdded=function(n){n.registerAfterWorldMatrixUpdate(this.onMeshUpdated);this.onMeshUpdated(n)},r.prototype.onMeshRemoved=function(n){this._toRemoveMeshesArray.push(n.uniqueId)},r.prototype.onGeometryAdded=function(n){n.onGeometryUpdated=this.onGeometryUpdated;this.onGeometryUpdated(n)},r.prototype.onGeometryDeleted=function(n){this._toRemoveGeometryArray.push(n.id)},r.SerializeMesh=function(t){var r=[],i;return t.subMeshes&&(r=t.subMeshes.map(function(n,t){return{position:t,verticesStart:n.verticesStart,verticesCount:n.verticesCount,indexStart:n.indexStart,indexCount:n.indexCount,hasMaterial:!!n.getMaterial(),sphereCenter:n.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:n.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:n.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:n.getBoundingInfo().boundingBox.maximumWorld.asArray()}})),i=null,t instanceof n.Mesh?i=t.geometry?t.geometry.id:null:t instanceof n.InstancedMesh&&(i=t.sourceMesh.geometry?t.sourceMesh.geometry.id:null),{uniqueId:t.uniqueId,id:t.id,name:t.name,geometryId:i,sphereCenter:t.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:t.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:t.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:t.getBoundingInfo().boundingBox.maximumWorld.asArray(),worldMatrixFromCache:t.worldMatrixFromCache.asArray(),subMeshes:r,checkCollisions:t.checkCollisions}},r.SerializeGeometry=function(t){return{id:t.id,positions:new Float32Array(t.getVerticesData(n.VertexBuffer.PositionKind)||[]),normals:new Float32Array(t.getVerticesData(n.VertexBuffer.NormalKind)||[]),indices:new Int32Array(t.getIndices()||[])}},r}();n.CollisionCoordinatorWorker=r;u=function(){function t(){this._scaledPosition=n.Vector3.Zero();this._scaledVelocity=n.Vector3.Zero();this._finalPosition=n.Vector3.Zero()}return t.prototype.getNewPosition=function(n,t,i,r,u,f,e){n.divideToRef(i.radius,this._scaledPosition);t.divideToRef(i.radius,this._scaledVelocity);i.collidedMesh=null;i.retry=0;i.initialVelocity=this._scaledVelocity;i.initialPosition=this._scaledPosition;this._collideWithWorld(this._scaledPosition,this._scaledVelocity,i,r,this._finalPosition,u);this._finalPosition.multiplyInPlace(i.radius);f(e,this._finalPosition,i.collidedMesh)},t.prototype.init=function(n){this._scene=n},t.prototype.destroy=function(){},t.prototype.onMeshAdded=function(){},t.prototype.onMeshUpdated=function(){},t.prototype.onMeshRemoved=function(){},t.prototype.onGeometryAdded=function(){},t.prototype.onGeometryUpdated=function(){},t.prototype.onGeometryDeleted=function(){},t.prototype._collideWithWorld=function(t,i,r,u,f,e){var h,s,o;if(void 0===e&&(e=null),h=10*n.Engine.CollisionsEpsilon,r.retry>=u)return void f.copyFrom(t);for(r._initialize(t,i,h),s=0;s<this._scene.meshes.length;s++)o=this._scene.meshes[s],o.isEnabled()&&o.checkCollisions&&o.subMeshes&&o!==e&&o._checkCollision(r);return r.collisionFound?((0!==i.x||0!==i.y||0!==i.z)&&r._getResponse(t,i),i.length()<=h?void f.copyFrom(t):(r.retry++,void this._collideWithWorld(t,i,r,u,f,e))):void t.addToRef(i,f)},t}();n.CollisionCoordinatorLegacy=u}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){this.compensateDistorsion=!0}return Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.hResolution/(2*this.vResolution)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatioFov",{get:function(){return 2*Math.atan(this.postProcessScaleFactor*this.vScreenSize/(2*this.eyeToScreenDistance))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftHMatrix",{get:function(){var t=this.hScreenSize/4-this.lensSeparationDistance/2,i=4*t/this.hScreenSize;return n.Matrix.Translation(i,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightHMatrix",{get:function(){var t=this.hScreenSize/4-this.lensSeparationDistance/2,i=4*t/this.hScreenSize;return n.Matrix.Translation(-i,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftPreViewMatrix",{get:function(){return n.Matrix.Translation(.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightPreViewMatrix",{get:function(){return n.Matrix.Translation(-.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),t.GetDefault=function(){var n=new t;return n.hResolution=1280,n.vResolution=800,n.hScreenSize=.149759993,n.vScreenSize=.0935999975,n.vScreenCenter=.0467999987,n.eyeToScreenDistance=.0410000011,n.lensSeparationDistance=.063500002,n.interpupillaryDistance=.064000003,n.distortionK=[1,.219999999,.239999995,0],n.chromaAbCorrection=[.995999992,-.00400000019,1.01400006,0],n.postProcessScaleFactor=1.7146055078084119,n.lensCenterOffset=.151976421,n},t}(),i;n.VRCameraMetrics=t;i=function(i){function r(t,u,f){i.call(this,t,f);this.position=u;this.upVector=n.Vector3.Up();this.orthoLeft=null;this.orthoRight=null;this.orthoBottom=null;this.orthoTop=null;this.fov=.8;this.minZ=1;this.maxZ=1e4;this.inertia=.9;this.mode=r.PERSPECTIVE_CAMERA;this.isIntermediate=!1;this.viewport=new n.Viewport(0,0,1,1);this.layerMask=268435455;this.fovMode=r.FOVMODE_VERTICAL_FIXED;this.cameraRigMode=r.RIG_MODE_NONE;this._rigCameras=[];this._computedViewMatrix=n.Matrix.Identity();this._projectionMatrix=new n.Matrix;this._postProcesses=[];this._postProcessesTakenIndices=[];this._activeMeshes=new n.SmartArray(256);this._globalPosition=n.Vector3.Zero();f.addCamera(this);f.activeCamera||(f.activeCamera=this)}return __extends(r,i),Object.defineProperty(r,"PERSPECTIVE_CAMERA",{get:function(){return r._PERSPECTIVE_CAMERA},enumerable:!0,configurable:!0}),Object.defineProperty(r,"ORTHOGRAPHIC_CAMERA",{get:function(){return r._ORTHOGRAPHIC_CAMERA},enumerable:!0,configurable:!0}),Object.defineProperty(r,"FOVMODE_VERTICAL_FIXED",{get:function(){return r._FOVMODE_VERTICAL_FIXED},enumerable:!0,configurable:!0}),Object.defineProperty(r,"FOVMODE_HORIZONTAL_FIXED",{get:function(){return r._FOVMODE_HORIZONTAL_FIXED},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_NONE",{get:function(){return r._RIG_MODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_STEREOSCOPIC_ANAGLYPH",{get:function(){return r._RIG_MODE_STEREOSCOPIC_ANAGLYPH},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL",{get:function(){return r._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED",{get:function(){return r._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_STEREOSCOPIC_OVERUNDER",{get:function(){return r._RIG_MODE_STEREOSCOPIC_OVERUNDER},enumerable:!0,configurable:!0}),Object.defineProperty(r,"RIG_MODE_VR",{get:function(){return r._RIG_MODE_VR},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"globalPosition",{get:function(){return this._globalPosition},enumerable:!0,configurable:!0}),r.prototype.getActiveMeshes=function(){return this._activeMeshes},r.prototype.isActiveMesh=function(n){return-1!==this._activeMeshes.indexOf(n)},r.prototype._initCache=function(){i.prototype._initCache.call(this);this._cache.position=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.upVector=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.mode=void 0;this._cache.minZ=void 0;this._cache.maxZ=void 0;this._cache.fov=void 0;this._cache.aspectRatio=void 0;this._cache.orthoLeft=void 0;this._cache.orthoRight=void 0;this._cache.orthoBottom=void 0;this._cache.orthoTop=void 0;this._cache.renderWidth=void 0;this._cache.renderHeight=void 0},r.prototype._updateCache=function(n){n||i.prototype._updateCache.call(this);var t=this.getEngine();this._cache.position.copyFrom(this.position);this._cache.upVector.copyFrom(this.upVector);this._cache.mode=this.mode;this._cache.minZ=this.minZ;this._cache.maxZ=this.maxZ;this._cache.fov=this.fov;this._cache.aspectRatio=t.getAspectRatio(this);this._cache.orthoLeft=this.orthoLeft;this._cache.orthoRight=this.orthoRight;this._cache.orthoBottom=this.orthoBottom;this._cache.orthoTop=this.orthoTop;this._cache.renderWidth=t.getRenderWidth();this._cache.renderHeight=t.getRenderHeight()},r.prototype._updateFromScene=function(){this.updateCache();this._update()},r.prototype._isSynchronized=function(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()},r.prototype._isSynchronizedViewMatrix=function(){return i.prototype._isSynchronized.call(this)?this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent():!1},r.prototype._isSynchronizedProjectionMatrix=function(){var t=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ,n;return t?(n=this.getEngine(),this.mode===r.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.aspectRatio===n.getAspectRatio(this):this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===n.getRenderWidth()&&this._cache.renderHeight===n.getRenderHeight()):!1},r.prototype.attachControl=function(){},r.prototype.detachControl=function(){},r.prototype._update=function(){this.cameraRigMode!==r.RIG_MODE_NONE&&this._updateRigCameras();this._checkInputs()},r.prototype._checkInputs=function(){},r.prototype.attachPostProcess=function(t,i){var u,e,r,f,o;if(void 0===i&&(i=null),!t.isReusable()&&this._postProcesses.indexOf(t)>-1)return n.Tools.Error("You're trying to reuse a post process not defined as reusable."),0;if(null==i||0>i)return this._postProcesses.push(t),this._postProcessesTakenIndices.push(this._postProcesses.length-1),this._postProcesses.length-1;if(u=0,this._postProcesses[i]){for(e=this._postProcesses.length-1,r=e;r>=i+1;--r)this._postProcesses[r+1]=this._postProcesses[r];u=1}for(r=0;r<this._postProcessesTakenIndices.length;++r)if(!(this._postProcessesTakenIndices[r]<i)){for(e=this._postProcessesTakenIndices.length-1,f=e;f>=r;--f)this._postProcessesTakenIndices[f+1]=this._postProcessesTakenIndices[f]+u;this._postProcessesTakenIndices[r]=i;break}return u||-1!=this._postProcessesTakenIndices.indexOf(i)||this._postProcessesTakenIndices.push(i),o=i+u,this._postProcesses[o]=t,o},r.prototype.detachPostProcess=function(n,t){var u,f,e,i,r;if(void 0===t&&(t=null),u=[],t)for(t=t instanceof Array?t:[t],i=0;i<t.length;i++)f=this._postProcesses[t[i]],f===n?(delete this._postProcesses[t[i]],r=this._postProcessesTakenIndices.indexOf(t[i]),this._postProcessesTakenIndices.splice(r,1)):u.push(i);else for(e=this._postProcesses.length,i=0;e>i;i++)this._postProcesses[i]===n&&(delete this._postProcesses[i],r=this._postProcessesTakenIndices.indexOf(i),this._postProcessesTakenIndices.splice(r,1));return u},r.prototype.getWorldMatrix=function(){this._worldMatrix||(this._worldMatrix=n.Matrix.Identity());var t=this.getViewMatrix();return t.invertToRef(this._worldMatrix),this._worldMatrix},r.prototype._getViewMatrix=function(){return n.Matrix.Identity()},r.prototype.getViewMatrix=function(t){return this._computedViewMatrix=this._computeViewMatrix(t),!t&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this.parent&&this.parent.getWorldMatrix?(this._worldMatrix||(this._worldMatrix=n.Matrix.Identity()),this._computedViewMatrix.invertToRef(this._worldMatrix),this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._computedViewMatrix),this._globalPosition.copyFromFloats(this._computedViewMatrix.m[12],this._computedViewMatrix.m[13],this._computedViewMatrix.m[14]),this._computedViewMatrix.invert(),this._markSyncedWithParent()):this._globalPosition.copyFrom(this.position),this._currentRenderId=this.getScene().getRenderId(),this._computedViewMatrix)},r.prototype._computeViewMatrix=function(n){return!n&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._computedViewMatrix)},r.prototype.getProjectionMatrix=function(t){var i,u,f;return!t&&this._isSynchronizedProjectionMatrix()?this._projectionMatrix:(i=this.getEngine(),this.mode===r.PERSPECTIVE_CAMERA)?(this.minZ<=0&&(this.minZ=.1),n.Matrix.PerspectiveFovLHToRef(this.fov,i.getAspectRatio(this),this.minZ,this.maxZ,this._projectionMatrix,this.fovMode),this._projectionMatrix):(u=i.getRenderWidth()/2,f=i.getRenderHeight()/2,n.Matrix.OrthoOffCenterLHToRef(this.orthoLeft||-u,this.orthoRight||u,this.orthoBottom||-f,this.orthoTop||f,this.minZ,this.maxZ,this._projectionMatrix),this._projectionMatrix)},r.prototype.dispose=function(){for(this.getScene().removeCamera(this);this._rigCameras.length>0;)this._rigCameras.pop().dispose();for(var n=0;n<this._postProcessesTakenIndices.length;++n)this._postProcesses[this._postProcessesTakenIndices[n]].dispose(this)},r.prototype.setCameraRigMode=function(i,u){for(var f,e;this._rigCameras.length>0;)this._rigCameras.pop().dispose();switch(this.cameraRigMode=i,this._cameraRigParams={},this.cameraRigMode){case r.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case r.RIG_MODE_STEREOSCOPIC_OVERUNDER:this._cameraRigParams.interaxialDistance=u.interaxialDistance||.0637;this._cameraRigParams.stereoHalfAngle=n.Tools.ToRadians(this._cameraRigParams.interaxialDistance/.0637);this._rigCameras.push(this.createRigCamera(this.name+"_L",0));this._rigCameras.push(this.createRigCamera(this.name+"_R",1))}f=[];switch(this.cameraRigMode){case r.RIG_MODE_STEREOSCOPIC_ANAGLYPH:f.push(new n.PassPostProcess(this.name+"_passthru",1,this._rigCameras[0]));this._rigCameras[0].isIntermediate=!0;f.push(new n.AnaglyphPostProcess(this.name+"_anaglyph",1,this._rigCameras[1]));f[1].onApply=function(n){n.setTextureFromPostProcess("leftSampler",f[0])};break;case r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case r.RIG_MODE_STEREOSCOPIC_OVERUNDER:var s=this.cameraRigMode===r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL||this.cameraRigMode===r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED,o=this.cameraRigMode===r.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:0,h=1-o;f.push(new n.PassPostProcess(this.name+"_passthru",1,this._rigCameras[o]));this._rigCameras[o].isIntermediate=!0;f.push(new n.StereoscopicInterlacePostProcess(this.name+"_stereoInterlace",this._rigCameras[h],f[0],s));break;case r.RIG_MODE_VR:this._rigCameras.push(this.createRigCamera(this.name+"_L",0));this._rigCameras.push(this.createRigCamera(this.name+"_R",1));e=u.vrCameraMetrics||t.GetDefault();this._rigCameras[0]._cameraRigParams.vrMetrics=e;this._rigCameras[0].viewport=new n.Viewport(0,0,.5,1);this._rigCameras[0]._cameraRigParams.vrWorkMatrix=new n.Matrix;this._rigCameras[0]._cameraRigParams.vrHMatrix=e.leftHMatrix;this._rigCameras[0]._cameraRigParams.vrPreViewMatrix=e.leftPreViewMatrix;this._rigCameras[0].getProjectionMatrix=this._rigCameras[0]._getVRProjectionMatrix;e.compensateDistorsion&&f.push(new n.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Left",this._rigCameras[0],!1,e));this._rigCameras[1]._cameraRigParams.vrMetrics=this._rigCameras[0]._cameraRigParams.vrMetrics;this._rigCameras[1].viewport=new n.Viewport(.5,0,.5,1);this._rigCameras[1]._cameraRigParams.vrWorkMatrix=new n.Matrix;this._rigCameras[1]._cameraRigParams.vrHMatrix=e.rightHMatrix;this._rigCameras[1]._cameraRigParams.vrPreViewMatrix=e.rightPreViewMatrix;this._rigCameras[1].getProjectionMatrix=this._rigCameras[1]._getVRProjectionMatrix;e.compensateDistorsion&&f.push(new n.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Right",this._rigCameras[1],!0,e))}this._update()},r.prototype._getVRProjectionMatrix=function(){return n.Matrix.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix},r.prototype.setCameraRigParameter=function(t,i){this._cameraRigParams[t]=i;"interaxialDistance"===t&&(this._cameraRigParams.stereoHalfAngle=n.Tools.ToRadians(i/.0637))},r.prototype.createRigCamera=function(){return null},r.prototype._updateRigCameras=function(){for(var n=0;n<this._rigCameras.length;n++)this._rigCameras[n].minZ=this.minZ,this._rigCameras[n].maxZ=this.maxZ,this._rigCameras[n].fov=this.fov;this.cameraRigMode===r.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)},r._PERSPECTIVE_CAMERA=0,r._ORTHOGRAPHIC_CAMERA=1,r._FOVMODE_VERTICAL_FIXED=0,r._FOVMODE_HORIZONTAL_FIXED=1,r._RIG_MODE_NONE=0,r._RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,r._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,r._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,r._RIG_MODE_STEREOSCOPIC_OVERUNDER=13,r._RIG_MODE_VR=20,r}(n.Node);n.Camera=i}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u){t.call(this,i,r,u);this.cameraDirection=new n.Vector3(0,0,0);this.cameraRotation=new n.Vector2(0,0);this.rotation=new n.Vector3(0,0,0);this.speed=2;this.noRotationConstraint=!1;this.lockedTarget=null;this._currentTarget=n.Vector3.Zero();this._viewMatrix=n.Matrix.Zero();this._camMatrix=n.Matrix.Zero();this._cameraTransformMatrix=n.Matrix.Zero();this._cameraRotationMatrix=n.Matrix.Zero();this._referencePoint=new n.Vector3(0,0,1);this._transformedReferencePoint=n.Vector3.Zero();this._lookAtTemp=n.Matrix.Zero();this._tempMatrix=n.Matrix.Zero()}return __extends(i,t),i.prototype.getFrontPosition=function(n){var t=this.getTarget().subtract(this.position);return t.normalize(),t.scaleInPlace(n),this.globalPosition.add(t)},i.prototype._getLockedTargetPosition=function(){return this.lockedTarget?this.lockedTarget.position||this.lockedTarget:null},i.prototype._initCache=function(){t.prototype._initCache.call(this);this._cache.lockedTarget=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.rotation=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},i.prototype._updateCache=function(n){n||t.prototype._updateCache.call(this);var i=this._getLockedTargetPosition();i?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(i):this._cache.lockedTarget=i.clone():this._cache.lockedTarget=null;this._cache.rotation.copyFrom(this.rotation)},i.prototype._isSynchronizedViewMatrix=function(){if(!t.prototype._isSynchronizedViewMatrix.call(this))return!1;var n=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(n):!n)&&this._cache.rotation.equals(this.rotation)},i.prototype._computeLocalCameraSpeed=function(){var n=this.getEngine();return this.speed*(n.getDeltaTime()/(10*n.getFps()))},i.prototype.setTarget=function(t){this.upVector.normalize();n.Matrix.LookAtLHToRef(this.position,t,this.upVector,this._camMatrix);this._camMatrix.invert();this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);var i=t.subtract(this.position);this.rotation.y=i.x>=0?-Math.atan(i.z/i.x)+Math.PI/2:-Math.atan(i.z/i.x)-Math.PI/2;this.rotation.z=-Math.acos(n.Vector3.Dot(new n.Vector3(0,1,0),this.upVector));isNaN(this.rotation.x)&&(this.rotation.x=0);isNaN(this.rotation.y)&&(this.rotation.y=0);isNaN(this.rotation.z)&&(this.rotation.z=0)},i.prototype.getTarget=function(){return this._currentTarget},i.prototype._decideIfNeedsToMove=function(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},i.prototype._updatePosition=function(){this.position.addInPlace(this.cameraDirection)},i.prototype._checkInputs=function(){var r=this._decideIfNeedsToMove(),u=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0,i;(r&&this._updatePosition(),u&&(this.rotation.x+=this.cameraRotation.x,this.rotation.y+=this.cameraRotation.y,!this.noRotationConstraint))&&(i=Math.PI/2*.95,this.rotation.x>i&&(this.rotation.x=i),this.rotation.x<-i&&(this.rotation.x=-i));r&&(Math.abs(this.cameraDirection.x)<n.Engine.Epsilon&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<n.Engine.Epsilon&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<n.Engine.Epsilon&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia));u&&(Math.abs(this.cameraRotation.x)<n.Engine.Epsilon&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<n.Engine.Epsilon&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia));t.prototype._checkInputs.call(this)},i.prototype._getViewMatrix=function(){return this.lockedTarget?this._currentTarget.copyFrom(this._getLockedTargetPosition()):(0!==this.upVector.x||1!==this.upVector.y||0!==this.upVector.z?(n.Matrix.LookAtLHToRef(n.Vector3.Zero(),this._referencePoint,this.upVector,this._lookAtTemp),n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix),this._lookAtTemp.multiplyToRef(this._cameraRotationMatrix,this._tempMatrix),this._lookAtTemp.invert(),this._tempMatrix.multiplyToRef(this._lookAtTemp,this._cameraRotationMatrix)):n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix),n.Vector3.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget)),n.Matrix.LookAtLHToRef(this.position,this._currentTarget,this.upVector,this._viewMatrix),this._viewMatrix},i.prototype._getVRViewMatrix=function(){return n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix),n.Vector3.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),n.Vector3.TransformNormalToRef(this.upVector,this._cameraRotationMatrix,this._cameraRigParams.vrActualUp),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),n.Matrix.LookAtLHToRef(this.position,this._currentTarget,this._cameraRigParams.vrActualUp,this._cameraRigParams.vrWorkMatrix),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._viewMatrix),this._viewMatrix},i.prototype.createRigCamera=function(t){if(this.cameraRigMode!==n.Camera.RIG_MODE_NONE){var r=new i(t,this.position.clone(),this.getScene());return this.cameraRigMode===n.Camera.RIG_MODE_VR&&(r._cameraRigParams={},r._cameraRigParams.vrActualUp=new n.Vector3(0,0,0),r._getViewMatrix=r._getVRViewMatrix),r}return null},i.prototype._updateRigCameras=function(){switch(this.cameraRigMode){case n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:case n.Camera.RIG_MODE_VR:var i=this._rigCameras[0],r=this._rigCameras[1];this.cameraRigMode===n.Camera.RIG_MODE_VR?(i.rotation.x=r.rotation.x=this.rotation.x,i.rotation.y=r.rotation.y=this.rotation.y,i.rotation.z=r.rotation.z=this.rotation.z,i.position.copyFrom(this.position),r.position.copyFrom(this.position)):(this._getRigCamPosition(-this._cameraRigParams.stereoHalfAngle,i.position),this._getRigCamPosition(this._cameraRigParams.stereoHalfAngle,r.position),i.setTarget(this.getTarget()),r.setTarget(this.getTarget()))}t.prototype._updateRigCameras.call(this)},i.prototype._getRigCamPosition=function(t,i){this._rigCamTransformMatrix||(this._rigCamTransformMatrix=new n.Matrix);var r=this.getTarget();n.Matrix.Translation(-r.x,-r.y,-r.z).multiplyToRef(n.Matrix.RotationY(t),this._rigCamTransformMatrix);this._rigCamTransformMatrix=this._rigCamTransformMatrix.multiply(n.Matrix.Translation(r.x,r.y,r.z));n.Vector3.TransformCoordinatesToRef(this.position,this._rigCamTransformMatrix,i)},i}(n.Camera);n.TargetCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u){var f=this;t.call(this,i,r,u);this.ellipsoid=new n.Vector3(.5,1,.5);this.keysUp=[38];this.keysDown=[40];this.keysLeft=[37];this.keysRight=[39];this.checkCollisions=!1;this.applyGravity=!1;this.angularSensibility=2e3;this._keys=[];this._collider=new n.Collider;this._needMoveForGravity=!1;this._oldPosition=n.Vector3.Zero();this._diffPosition=n.Vector3.Zero();this._newPosition=n.Vector3.Zero();this._onCollisionPositionChange=function(t,i,r){void 0===r&&(r=null);f.getScene().workerCollisions&&i.multiplyInPlace(f._collider.radius);var u=function(t){f._newPosition.copyFrom(t);f._newPosition.subtractToRef(f._oldPosition,f._diffPosition);f.position.clone();f._diffPosition.length()>n.Engine.CollisionsEpsilon&&(f.position.addInPlace(f._diffPosition),f.onCollide&&r&&f.onCollide(r))};u(i)}}return __extends(i,t),i.prototype.attachControl=function(t,i){var u,r=this,f=this.getEngine();this._attachedElement||(this._attachedElement=t,void 0===this._onMouseDown&&(this._onMouseDown=function(n){u={x:n.clientX,y:n.clientY};i||n.preventDefault()},this._onMouseUp=function(n){u=null;i||n.preventDefault()},this._onMouseOut=function(n){u=null;r._keys=[];i||n.preventDefault()},this._onMouseMove=function(n){if(u||f.isPointerLock){var t,e;f.isPointerLock?(t=n.movementX||n.mozMovementX||n.webkitMovementX||n.msMovementX||0,e=n.movementY||n.mozMovementY||n.webkitMovementY||n.msMovementY||0):(t=n.clientX-u.x,e=n.clientY-u.y);r.cameraRotation.y+=t/r.angularSensibility;r.cameraRotation.x+=e/r.angularSensibility;u={x:n.clientX,y:n.clientY};i||n.preventDefault()}},this._onKeyDown=function(n){if(-1!==r.keysUp.indexOf(n.keyCode)||-1!==r.keysDown.indexOf(n.keyCode)||-1!==r.keysLeft.indexOf(n.keyCode)||-1!==r.keysRight.indexOf(n.keyCode)){var t=r._keys.indexOf(n.keyCode);-1===t&&r._keys.push(n.keyCode);i||n.preventDefault()}},this._onKeyUp=function(n){if(-1!==r.keysUp.indexOf(n.keyCode)||-1!==r.keysDown.indexOf(n.keyCode)||-1!==r.keysLeft.indexOf(n.keyCode)||-1!==r.keysRight.indexOf(n.keyCode)){var t=r._keys.indexOf(n.keyCode);t>=0&&r._keys.splice(t,1);i||n.preventDefault()}},this._onLostFocus=function(){r._keys=[]},this._reset=function(){r._keys=[];u=null;r.cameraDirection=new n.Vector3(0,0,0);r.cameraRotation=new n.Vector2(0,0)}),t.addEventListener("mousedown",this._onMouseDown,!1),t.addEventListener("mouseup",this._onMouseUp,!1),t.addEventListener("mouseout",this._onMouseOut,!1),t.addEventListener("mousemove",this._onMouseMove,!1),n.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]))},i.prototype.detachControl=function(t){this._attachedElement==t&&(t.removeEventListener("mousedown",this._onMouseDown),t.removeEventListener("mouseup",this._onMouseUp),t.removeEventListener("mouseout",this._onMouseOut),t.removeEventListener("mousemove",this._onMouseMove),n.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]),this._attachedElement=null,this._reset&&this._reset())},i.prototype._collideWithWorld=function(t){var i;i=this.parent?n.Vector3.TransformCoordinates(this.position,this.parent.getWorldMatrix()):this.position;i.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPosition);this._collider.radius=this.ellipsoid;this.applyGravity&&t.addInPlace(this.getScene().gravity);this.getScene().collisionCoordinator.getNewPosition(this._oldPosition,t,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)},i.prototype._checkInputs=function(){var u,i,r;for(this._localDirection||(this._localDirection=n.Vector3.Zero(),this._transformedDirection=n.Vector3.Zero()),u=0;u<this._keys.length;u++)i=this._keys[u],r=this._computeLocalCameraSpeed(),-1!==this.keysLeft.indexOf(i)?this._localDirection.copyFromFloats(-r,0,0):-1!==this.keysUp.indexOf(i)?this._localDirection.copyFromFloats(0,0,r):-1!==this.keysRight.indexOf(i)?this._localDirection.copyFromFloats(r,0,0):-1!==this.keysDown.indexOf(i)&&this._localDirection.copyFromFloats(0,0,-r),this.getViewMatrix().invertToRef(this._cameraTransformMatrix),n.Vector3.TransformNormalToRef(this._localDirection,this._cameraTransformMatrix,this._transformedDirection),this.cameraDirection.addInPlace(this._transformedDirection);t.prototype._checkInputs.call(this)},i.prototype._decideIfNeedsToMove=function(){return this._needMoveForGravity||Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},i.prototype._updatePosition=function(){this.checkCollisions&&this.getScene().collisionsEnabled?this._collideWithWorld(this.cameraDirection):this.position.addInPlace(this.cameraDirection)},i}(n.TargetCamera);n.FreeCamera=t}(BABYLON||(BABYLON={}));!function(n){var i=function(t){function i(n,i,r){t.call(this,n,i,r);this.radius=12;this.rotationOffset=0;this.heightOffset=4;this.cameraAcceleration=.05;this.maxCameraSpeed=20}return __extends(i,t),i.prototype.getRadians=function(n){return n*Math.PI/180},i.prototype.follow=function(t){var e,f;if(t){t.rotationQuaternion?(f=new n.Matrix,t.rotationQuaternion.toRotationMatrix(f),e=Math.atan2(f.m[8],f.m[10])):e=t.rotation.y;var o=this.getRadians(this.rotationOffset)+e,s=t.position.x+Math.sin(o)*this.radius,h=t.position.z+Math.cos(o)*this.radius,c=s-this.position.x,l=t.position.y+this.heightOffset-this.position.y,a=h-this.position.z,i=c*this.cameraAcceleration*2,r=l*this.cameraAcceleration,u=a*this.cameraAcceleration*2;(i>this.maxCameraSpeed||i<-this.maxCameraSpeed)&&(i=1>i?-this.maxCameraSpeed:this.maxCameraSpeed);(r>this.maxCameraSpeed||r<-this.maxCameraSpeed)&&(r=1>r?-this.maxCameraSpeed:this.maxCameraSpeed);(u>this.maxCameraSpeed||u<-this.maxCameraSpeed)&&(u=1>u?-this.maxCameraSpeed:this.maxCameraSpeed);this.position=new n.Vector3(this.position.x+i,this.position.y+r,this.position.z+u);this.setTarget(t.position)}},i.prototype._checkInputs=function(){t.prototype._checkInputs.call(this);this.follow(this.target)},i}(n.TargetCamera),t;n.FollowCamera=i;t=function(t){function i(i,r,u,f,e,o){t.call(this,i,n.Vector3.Zero(),o);this.alpha=r;this.beta=u;this.radius=f;this.target=e;this._cartesianCoordinates=n.Vector3.Zero();this.follow()}return __extends(i,t),i.prototype.follow=function(){this._cartesianCoordinates.x=this.radius*Math.cos(this.alpha)*Math.cos(this.beta);this._cartesianCoordinates.y=this.radius*Math.sin(this.beta);this._cartesianCoordinates.z=this.radius*Math.sin(this.alpha)*Math.cos(this.beta);this.position=this.target.position.add(this._cartesianCoordinates);this.setTarget(this.target.position)},i.prototype._checkInputs=function(){t.prototype._checkInputs.call(this);this.follow()},i}(n.TargetCamera);n.ArcFollowCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r){t.call(this,n,i,r);this._offsetX=null;this._offsetY=null;this._pointerCount=0;this._pointerPressed=[];this.angularSensibility=2e5;this.moveSensibility=500}return __extends(i,t),i.prototype.attachControl=function(t,i){var u,r=this;this._attachedCanvas||(this._attachedCanvas=t,void 0===this._onPointerDown&&(this._onPointerDown=function(n){i||n.preventDefault();r._pointerPressed.push(n.pointerId);1===r._pointerPressed.length&&(u={x:n.clientX,y:n.clientY})},this._onPointerUp=function(n){i||n.preventDefault();var t=r._pointerPressed.indexOf(n.pointerId);-1!==t&&(r._pointerPressed.splice(t,1),0==t&&(u=null,r._offsetX=null,r._offsetY=null))},this._onPointerMove=function(n){if(i||n.preventDefault(),u){var t=r._pointerPressed.indexOf(n.pointerId);0==t&&(r._offsetX=n.clientX-u.x,r._offsetY=-(n.clientY-u.y))}},this._onLostFocus=function(){r._offsetX=null;r._offsetY=null}),t.addEventListener("pointerdown",this._onPointerDown),t.addEventListener("pointerup",this._onPointerUp),t.addEventListener("pointerout",this._onPointerUp),t.addEventListener("pointermove",this._onPointerMove),n.Tools.RegisterTopRootEvents([{name:"blur",handler:this._onLostFocus}]))},i.prototype.detachControl=function(t){this._attachedCanvas==t&&(t.removeEventListener("pointerdown",this._onPointerDown),t.removeEventListener("pointerup",this._onPointerUp),t.removeEventListener("pointerout",this._onPointerUp),t.removeEventListener("pointermove",this._onPointerMove),n.Tools.UnregisterTopRootEvents([{name:"blur",handler:this._onLostFocus}]),this._attachedCanvas=null)},i.prototype._checkInputs=function(){if(this._offsetX)if(this.cameraRotation.y+=this._offsetX/this.angularSensibility,this._pointerPressed.length>1)this.cameraRotation.x+=-this._offsetY/this.angularSensibility;else{var i=this._computeLocalCameraSpeed(),r=new n.Vector3(0,0,i*this._offsetY/this.moveSensibility);n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,0,this._cameraRotationMatrix);this.cameraDirection.addInPlace(n.Vector3.TransformCoordinates(r,this._cameraRotationMatrix))}t.prototype._checkInputs.call(this)},i}(n.FreeCamera);n.TouchCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=n.Tools.GetPointerPrefix(),i=function(i){function r(t,r,u,f,e,o){var s=this;i.call(this,t,n.Vector3.Zero(),o);this.alpha=r;this.beta=u;this.radius=f;this.target=e;this.inertialAlphaOffset=0;this.inertialBetaOffset=0;this.inertialRadiusOffset=0;this.lowerAlphaLimit=null;this.upperAlphaLimit=null;this.lowerBetaLimit=.01;this.upperBetaLimit=Math.PI;this.lowerRadiusLimit=null;this.upperRadiusLimit=null;this.angularSensibilityX=1e3;this.angularSensibilityY=1e3;this.wheelPrecision=3;this.pinchPrecision=2;this.panningSensibility=50;this.inertialPanningX=0;this.inertialPanningY=0;this.keysUp=[38];this.keysDown=[40];this.keysLeft=[37];this.keysRight=[39];this.zoomOnFactor=1;this.targetScreenOffset=n.Vector2.Zero();this.pinchInwards=!0;this.allowUpsideDown=!0;this._keys=[];this._viewMatrix=new n.Matrix;this._isRightClick=!1;this._isCtrlPushed=!1;this.checkCollisions=!1;this.collisionRadius=new n.Vector3(.5,.5,.5);this._collider=new n.Collider;this._previousPosition=n.Vector3.Zero();this._collisionVelocity=n.Vector3.Zero();this._newPosition=n.Vector3.Zero();this._onCollisionPositionChange=function(t,i,r){var u;void 0===r&&(r=null);s.getScene().workerCollisions&&s.checkCollisions&&i.multiplyInPlace(s._collider.radius);r?(s.setPosition(s.position),s.onCollide&&s.onCollide(r)):s._previousPosition.copyFrom(s.position);var o=Math.cos(s.alpha),h=Math.sin(s.alpha),c=Math.cos(s.beta),f=Math.sin(s.beta),e=s._getTargetPosition();e.addToRef(new n.Vector3(s.radius*o*f,s.radius*c,s.radius*h*f),s._newPosition);s.position.copyFrom(s._newPosition);u=s.upVector;s.allowUpsideDown&&s.beta<0&&(u=u.clone(),u=u.negate());n.Matrix.LookAtLHToRef(s.position,e,u,s._viewMatrix);s._viewMatrix.m[12]+=s.targetScreenOffset.x;s._viewMatrix.m[13]+=s.targetScreenOffset.y;s._collisionTriggered=!1};this.target||(this.target=n.Vector3.Zero());this.getViewMatrix()}return __extends(r,i),Object.defineProperty(r.prototype,"angularSensibility",{get:function(){return n.Tools.Warn("Warning: angularSensibility is deprecated, use angularSensibilityX and angularSensibilityY instead."),Math.max(this.angularSensibilityX,this.angularSensibilityY)},set:function(t){n.Tools.Warn("Warning: angularSensibility is deprecated, use angularSensibilityX and angularSensibilityY instead.");this.angularSensibilityX=t;this.angularSensibilityY=t},enumerable:!0,configurable:!0}),r.prototype._getTargetPosition=function(){return this.target.position||this.target},r.prototype._initCache=function(){i.prototype._initCache.call(this);this._cache.target=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.alpha=void 0;this._cache.beta=void 0;this._cache.radius=void 0;this._cache.targetScreenOffset=void 0},r.prototype._updateCache=function(n){n||i.prototype._updateCache.call(this);this._cache.target.copyFrom(this._getTargetPosition());this._cache.alpha=this.alpha;this._cache.beta=this.beta;this._cache.radius=this.radius;this._cache.targetScreenOffset=this.targetScreenOffset.clone()},r.prototype._isSynchronizedViewMatrix=function(){return i.prototype._isSynchronizedViewMatrix.call(this)?this._cache.target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset):!1},r.prototype.attachControl=function(i,r,u){var f=this,o,s,e,h;void 0===u&&(u=!0);s=0;e=new n.SmartCollection;this._attachedElement||(this._attachedElement=i,h=this.getEngine(),void 0===this._onPointerDown&&(this._onPointerDown=function(n){f._isRightClick=2===n.button?!0:!1;e.add(n.pointerId,{x:n.clientX,y:n.clientY,type:n.pointerType});o=e.item(n.pointerId);r||n.preventDefault()},this._onPointerUp=function(n){o=null;s=0;e.empty();r||n.preventDefault()},this._onContextMenu=function(n){n.preventDefault()},this._onPointerMove=function(n){var i,h;switch(r||n.preventDefault(),e.count){case 1:f._isCtrlPushed&&u||!u&&f._isRightClick?(f.inertialPanningX+=-(n.clientX-o.x)/f.panningSensibility,f.inertialPanningY+=(n.clientY-o.y)/f.panningSensibility):(i=n.clientX-o.x,h=n.clientY-o.y,f.inertialAlphaOffset-=i/f.angularSensibilityX,f.inertialBetaOffset-=h/f.angularSensibilityY);o.x=n.clientX;o.y=n.clientY;break;case 2:e.item(n.pointerId).x=n.clientX;e.item(n.pointerId).y=n.clientY;var a=f.pinchInwards?1:-1,c=e.getItemByIndex(0).x-e.getItemByIndex(1).x,l=e.getItemByIndex(0).y-e.getItemByIndex(1).y,t=c*c+l*l;if(0===s)return void(s=t);t!==s&&(f.inertialRadiusOffset+=(t-s)/(f.pinchPrecision*f.wheelPrecision*((f.angularSensibilityX+f.angularSensibilityY)/2)*a),s=t);break;default:e.item(n.pointerId)&&(e.item(n.pointerId).x=n.clientX,e.item(n.pointerId).y=n.clientY)}},this._onMouseMove=function(n){if(h.isPointerLock){var t=n.movementX||n.mozMovementX||n.webkitMovementX||n.msMovementX||0,i=n.movementY||n.mozMovementY||n.webkitMovementY||n.msMovementY||0;f.inertialAlphaOffset-=t/f.angularSensibilityX;f.inertialBetaOffset-=i/f.angularSensibilityY;r||n.preventDefault()}},this._wheel=function(n){var t=0;n.wheelDelta?t=n.wheelDelta/(40*f.wheelPrecision):n.detail&&(t=-n.detail/f.wheelPrecision);t&&(f.inertialRadiusOffset+=t);n.preventDefault&&(r||n.preventDefault())},this._onKeyDown=function(n){if(f._isCtrlPushed=n.ctrlKey,-1!==f.keysUp.indexOf(n.keyCode)||-1!==f.keysDown.indexOf(n.keyCode)||-1!==f.keysLeft.indexOf(n.keyCode)||-1!==f.keysRight.indexOf(n.keyCode)){var t=f._keys.indexOf(n.keyCode);-1===t&&f._keys.push(n.keyCode);n.preventDefault&&(r||n.preventDefault())}},this._onKeyUp=function(n){if(f._isCtrlPushed=n.ctrlKey,-1!==f.keysUp.indexOf(n.keyCode)||-1!==f.keysDown.indexOf(n.keyCode)||-1!==f.keysLeft.indexOf(n.keyCode)||-1!==f.keysRight.indexOf(n.keyCode)){var t=f._keys.indexOf(n.keyCode);t>=0&&f._keys.splice(t,1);n.preventDefault&&(r||n.preventDefault())}},this._onLostFocus=function(){f._keys=[];e.empty();s=0;o=null},this._onGestureStart=function(n){void 0!==window.MSGesture&&(f._MSGestureHandler||(f._MSGestureHandler=new MSGesture,f._MSGestureHandler.target=i),f._MSGestureHandler.addPointer(n.pointerId))},this._onGesture=function(n){f.radius*=n.scale;n.preventDefault&&(r||(n.stopPropagation(),n.preventDefault()))},this._reset=function(){f._keys=[];f.inertialAlphaOffset=0;f.inertialBetaOffset=0;f.inertialRadiusOffset=0;e.empty();s=0;o=null}),u||i.addEventListener("contextmenu",this._onContextMenu,!1),i.addEventListener(t+"down",this._onPointerDown,!1),i.addEventListener(t+"up",this._onPointerUp,!1),i.addEventListener(t+"out",this._onPointerUp,!1),i.addEventListener(t+"move",this._onPointerMove,!1),i.addEventListener("mousemove",this._onMouseMove,!1),i.addEventListener("MSPointerDown",this._onGestureStart,!1),i.addEventListener("MSGestureChange",this._onGesture,!1),i.addEventListener("mousewheel",this._wheel,!1),i.addEventListener("DOMMouseScroll",this._wheel,!1),n.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]))},r.prototype.detachControl=function(i){this._attachedElement===i&&(i.removeEventListener("contextmenu",this._onContextMenu),i.removeEventListener(t+"down",this._onPointerDown),i.removeEventListener(t+"up",this._onPointerUp),i.removeEventListener(t+"out",this._onPointerUp),i.removeEventListener(t+"move",this._onPointerMove),i.removeEventListener("mousemove",this._onMouseMove),i.removeEventListener("MSPointerDown",this._onGestureStart),i.removeEventListener("MSGestureChange",this._onGesture),i.removeEventListener("mousewheel",this._wheel),i.removeEventListener("DOMMouseScroll",this._wheel),n.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]),this._MSGestureHandler=null,this._attachedElement=null,this._reset&&this._reset())},r.prototype._checkInputs=function(){var r,t;if(!this._collisionTriggered){for(r=0;r<this._keys.length;r++)t=this._keys[r],-1!==this.keysLeft.indexOf(t)?this.inertialAlphaOffset-=.01:-1!==this.keysUp.indexOf(t)?this.inertialBetaOffset-=.01:-1!==this.keysRight.indexOf(t)?this.inertialAlphaOffset+=.01:-1!==this.keysDown.indexOf(t)&&(this.inertialBetaOffset+=.01);(0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!=this.inertialRadiusOffset)&&(this.alpha+=this.beta<=0?-this.inertialAlphaOffset:this.inertialAlphaOffset,this.beta+=this.inertialBetaOffset,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<n.Engine.Epsilon&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<n.Engine.Epsilon&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<n.Engine.Epsilon&&(this.inertialRadiusOffset=0));(0!==this.inertialPanningX||0!==this.inertialPanningY)&&(this._localDirection||(this._localDirection=n.Vector3.Zero(),this._transformedDirection=n.Vector3.Zero()),this.inertialPanningX*=this.inertia,this.inertialPanningY*=this.inertia,Math.abs(this.inertialPanningX)<n.Engine.Epsilon&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<n.Engine.Epsilon&&(this.inertialPanningY=0),this._localDirection.copyFromFloats(this.inertialPanningX,this.inertialPanningY,0),this._viewMatrix.invertToRef(this._cameraTransformMatrix),n.Vector3.TransformNormalToRef(this._localDirection,this._cameraTransformMatrix,this._transformedDirection),this.target.addInPlace(this._transformedDirection));this._checkLimits();i.prototype._checkInputs.call(this)}},r.prototype._checkLimits=function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit);null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit);this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit);this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit);this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit);this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit)},r.prototype.setPosition=function(n){var t=n.subtract(this._getTargetPosition());this.radius=t.length();this.alpha=Math.acos(t.x/Math.sqrt(Math.pow(t.x,2)+Math.pow(t.z,2)));t.z<0&&(this.alpha=2*Math.PI-this.alpha);this.beta=Math.acos(t.y/this.radius);this._checkLimits()},r.prototype.setTarget=function(n){this.target=n},r.prototype._getViewMatrix=function(){var u=Math.cos(this.alpha),f=Math.sin(this.alpha),e=Math.cos(this.beta),i=Math.sin(this.beta),r=this._getTargetPosition(),t;return(r.addToRef(new n.Vector3(this.radius*u*i,this.radius*e,this.radius*f*i),this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions)?(this._collider.radius=this.collisionRadius,this._newPosition.subtractToRef(this.position,this._collisionVelocity),this._collisionTriggered=!0,this.getScene().collisionCoordinator.getNewPosition(this.position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)):(this.position.copyFrom(this._newPosition),t=this.upVector,this.allowUpsideDown&&this.beta<0&&(t=t.clone(),t=t.negate()),n.Matrix.LookAtLHToRef(this.position,r,t,this._viewMatrix),this._viewMatrix.m[12]+=this.targetScreenOffset.x,this._viewMatrix.m[13]+=this.targetScreenOffset.y),this._viewMatrix},r.prototype.zoomOn=function(t,i){void 0===i&&(i=!1);t=t||this.getScene().meshes;var r=n.Mesh.MinMax(t),u=n.Vector3.Distance(r.min,r.max);this.radius=u*this.zoomOnFactor;this.focusOn({min:r.min,max:r.max,distance:u},i)},r.prototype.focusOn=function(t,i){void 0===i&&(i=!1);var r,u;void 0===t.min?(r=t||this.getScene().meshes,r=n.Mesh.MinMax(r),u=n.Vector3.Distance(r.min,r.max)):(r=t,u=t.distance);this.target=n.Mesh.Center(r);i||(this.maxZ=2*u)},r.prototype.createRigCamera=function(t,i){switch(this.cameraRigMode){case n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:case n.Camera.RIG_MODE_VR:var u=this._cameraRigParams.stereoHalfAngle*(0===i?1:-1);return new r(t,this.alpha+u,this.beta,this.radius,this.target,this.getScene())}},r.prototype._updateRigCameras=function(){switch(this.cameraRigMode){case n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:case n.Camera.RIG_MODE_VR:var t=this._rigCameras[0],r=this._rigCameras[1];t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle;r.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;t.beta=r.beta=this.beta;t.radius=r.radius=this.radius}i.prototype._updateRigCameras.call(this)},r}(n.TargetCamera);n.ArcRotateCamera=i}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r){var u=this;t.call(this,n,i,r);this._offsetX=null;this._offsetY=null;this._orientationGamma=0;this._orientationBeta=0;this._initialOrientationGamma=0;this._initialOrientationBeta=0;this.angularSensibility=1e4;this.moveSensibility=50;window.addEventListener("resize",function(){u._initialOrientationGamma=null},!1)}return __extends(i,t),i.prototype.attachControl=function(n){var t=this;this._attachedCanvas||(this._attachedCanvas=n,this._orientationChanged||(this._orientationChanged=function(n){t._initialOrientationGamma||(t._initialOrientationGamma=n.gamma,t._initialOrientationBeta=n.beta);t._orientationGamma=n.gamma;t._orientationBeta=n.beta;t._offsetY=t._initialOrientationBeta-t._orientationBeta;t._offsetX=t._initialOrientationGamma-t._orientationGamma}),window.addEventListener("deviceorientation",this._orientationChanged))},i.prototype.detachControl=function(n){this._attachedCanvas==n&&(window.removeEventListener("deviceorientation",this._orientationChanged),this._attachedCanvas=null,this._orientationGamma=0,this._orientationBeta=0,this._initialOrientationGamma=0,this._initialOrientationBeta=0)},i.prototype._checkInputs=function(){if(this._offsetX){this.cameraRotation.y-=this._offsetX/this.angularSensibility;var i=this._computeLocalCameraSpeed(),r=new n.Vector3(0,0,i*this._offsetY/this.moveSensibility);n.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,0,this._cameraRotationMatrix);this.cameraDirection.addInPlace(n.Vector3.TransformCoordinates(r,this._cameraRotationMatrix));t.prototype._checkInputs.call(this)}},i}(n.FreeCamera);n.DeviceOrientationCamera=t}(BABYLON||(BABYLON={}));!function(n){var o=function(){function n(n){var t=this;this.babylonGamepads=[];this.oneGamepadConnected=!1;this.isMonitoring=!1;this.gamepadEventSupported="GamepadEvent"in window;this.gamepadSupportAvailable=navigator.getGamepads||!!navigator.webkitGetGamepads||!!navigator.msGetGamepads||!!navigator.webkitGamepads;this.buttonADataURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAA9aSURBVHja7FtpbBzneX7m3otcihSpm9Z9UJalxPKhVLZlp6ktNzEaxE0CtAnQAgnSoPWPBi3syuiPwordFi5Qt2haFygCoylSV4Vby6os1I3kOLYrS65kXXQoypJJSaFEUTyXy925+rzfzC6HFFlL1kpAIe7i5czO7H7zPs97ft8MtTAMcSu/dNzirxkCZgiYIWCGgBkCZgi4hV/mDR5fSxAt+0ZiX0ucDxMSTJLK+f83BFSA6TFgK75OclshouKBFbA+xaV4k7Z+fD6sNRlmjYFXQMu4NiUVS/oHe5/ecnHo3MYxd7QthN9UcsdW6FqEPwgDOFbqpAajL2VlTrTULzj4Ow8+s4+nipSxWMoxIUkyrl/pGswFtIR7WzHgDCX77K7vfHNkbOA+AryjYZadb27OIJdzCNZBKmXw4kbk35qPsTEfJbeEkZESentHMdBfGtY142gu1bDvqV/925f4tQJlNCaj4hXX7RHXS0AFuJEAXvfHr/zmk67vPjir0V68aFEe8xtuQ6O1FHlrEXLmHBiaDUtzYBlpNYjrF+GFZfhhCcPeBQy53ehzT+H8QBe6uwfRf7l8xjKsvX/y5X98jl8fThDhJ4i46QQkrS5I6v7oX7/++77vPtLUlFnZtnIRlubvxRxnHbJmE79sxD/SqG0oZk8MFarRqufUkQAFrxcXSkfx0eB+nOggKX2jHYZhvf79r/z4L2IiipO84aYRkASfefnAX695p3P3c9mM/UufuaMVdzRvxVx7A0xaWdOMqVULJ6Z3TZv6KmHo0ztK6CkfxpHe3Th0pAuF0fLbn1u+9cmv3vW77bE3fGoSPi0BVfAvvPEHm9rPv//iooWz5m9Z/wCWZx+Go9UrN48QTD9IGMZ1cJIzTPisRQclPMrhME4W9mDfB2+i+2z/+TXz7/z2E7/85+9OIuGGE6BV3H77zm/d33nx6Ktr18zFg2t+DQude2n1tLJ8tcJ90vDhpG5Am7qTkJAQErywiLOld7G3/d9xvL0Hy1vWPbbtS3//00Q4hDeaAFXintrx1fu7+jp2r13bgofX/gaazbVkJQdLT9P6VqRFDSu2hIgXlBUBLgtCr3cce47/CMePX0Rr08qtzz7+8k8TpfKGtcKq1jPZre7oObyjdWkGd628l7AXwvMCeL7HjO6qrS8S1E5kTE9tfbiur665ccU9EB1EF9Ep0WXesEZIJb9j5/b/XUtzNrt29Rw0og2lchmBVqLo8LSAHlCixbTpddGm8Y7pjkttCCUP+JQy3FiatNuxdvUx9F4ayopO/OL9sQeEN4oA/eHn577oWPbGVes11PsrUBxjDafze1Te1VzouqnK2TgmLQljQqmrnAsT+iaPVb5b2co7EC+QhBgUeM1R1AcrsGp9Jy6+4W8U3fZ8r+e3EnOI2uaAX3l+zgNB4O9rW5/B8tY5WGo9BtOrJ4uMfUl+uj0B8HTmPXj8Pex86xVEnTDBBSE2r78fX9i09RPyZfT2A5ceIMSPwDOH8JH7Kk5+fAHtR0Zh6MZ9e7534Wc3wgO0sXLhD9OpFOa0egjGMhguD8BgTJooMfPbV1h/umz25ondcFP90IzY2iTgrfY9uH31aqSc9CeSEHkBEyITv28M8XMGc2/z0HGCpWCs8BS/9sWrDYOrJuCBZ+vu5sUfXbicia5kYGzUw4DWTwJKbApSjHuTBBjT2H68zg0MD4KlEwabZi0Y7wd85u/3O9/B6sVrPlEXeiF9nMmRxPt6Qf4y/HyIbh3HwkdF1zefGt5fUwK8wP2WAGwh02MFE/5ogYr3Qg/STL0W3d8aB1ppa+Pw0uI2Tz6/134Mg+UoIGZlZ2HMLaJYHkPICr6//RBamvPj/UA4dYKsegGrXqAXMaqNsDT6SreOY5Gu/FptCeBFN+caAphGiKFiGaOjA3AJHoGt6r7GgNbjqjo5yQkBUVHQ8PaJExjiaZ2yue12nO27gCNdHSptvf/xGdw11I2UZSmvCIJgQiJMhoEfeqpNDvUSRvUB5hMX9fUecg0aBi+Hm2uaAz633bmbm1VN8+h07LfKJdkOkQB2fL4BTlsj8No4YLG2putMSjwjp3QNvZdH8YsiExV501isFjU30lpF7D8dVfCA8sFHp7BuWYtaIwiCsCrCSDVhh9IX8k0CoHsoMQ84FrfFAE3zQAK0VaLzO9tK79XKAxSj+aYALt3XLfNipZD1v492YexrE/sP0zBgUIQIoYaflAXbz16CzyY6YKqYl8uheTarRioD7xAxCQHUpv18L1Yud+Iloujtk4zQo9WZcKURqjbHclzKvj0Gvcw8UA6oY2WqonSuGQGb5I+TJgEFEsB4daXzc0eopabcX13W0BXwgAnRZL4Q62s8ppnR/pFz/QjF+tRvxeIsY/cizGwRt83P4czACL8HdA1JUivCNGVogvdkNkgaGDNe4CvXFyJ8n+B5XGLJ1FmJXJ53AzjZKgGbatkKL5c/liNWIPO8uM/4VO2uKCQZjLmBqQAGJ4EmI8NMabDTOuyUobYXmPlCEpiqA1IkYdWSBpjpEDl6wsrF9aAjqHNOPXDyXAGprAknY5B0btOGGk/GlfE1taqofCNuuYNIJ+omOiZ1rpUHtEYWjkpWoP5EWV2sb5isA7aIQTHHxaIniNADui8PIs0Eb6SY/Z0UQc+j+mXYuoM7Vy/Age7zkBUyCZGLhRLSOYcWpfXFA1wPhqup8JNKq5UkKeoqSHxPLSoqnUQtw5ioc60IyE/VkOji8mYE2nZELNgCXLaOkGDFJBg4OzCMDEcxCfAzS1pQX5fHSNDLClLGwmwzls6vQ09hGFJYegdZ1hha2bqIBNelB5Qjog02TzpFNVEquYpMuTSYr/lcQPKPJHoRQ8W1GYO3lDgpO9pPWTEZEQGnuodg5Hyk66Lyd8fKOQQ6gqyWict7GeuWz8HQyWEFw+bB7ksF3Nk2V1nfpZTLQqSLslzXlDmHpsQ1osVoy/Solwf/GpdErpaAQUqjWxL2GWcWaSfAMIis7RBwiuCdtD1OgmNHBJCg7r4uZBnbdjaaq+3YewB+USYicY8juYPnMtloqdCjG3f39eO+3JKIAFadSiiZigBdgdcqItMxsmZbIbvUIKlzzQjoEgLGRjU2KTp8AjRCkzEnAG0mtQh8Ku0oAqok8JzP+Lw0MkB3jpKjKpapaL5WKZxafDdBqoC6O8LtyMAQhoZdzG7MwLU8FUYKPINcl+qimismRj26v2I71I3jDxfdpM41I6CTsmG4X0djKyc8RYu9t0Vl2QJbBJ5xFPiICJIg1hdhR3fs5HnWeldleZXABLA98b7Y5HtjkgwNEtbTN4iFC5oI3I1CTsAbsfVjAizJB3Qbx9HphRp6eqr3TDprSYA0FI/3ntOxbpUNM2OjpEcE6HYEWkhIKw+ICeBxi+T09F1WZU+iJq2n8fRDf4Ymu3XSrcOIgg8H9uOFn31fNUVC0oddZ7B5YxtDwlTgo66SEici2fokwCJjju0hw7J54WypQsB7tSRAza+H+nld30Y+m2b7SS+Qn9PKFl1egRciHIfWpxC8x+7tdA97+3zUcNyWX4Ci/THOoD2x/hmlQTox+3gDjWYeg/4gmF853xjBpUsjaGnJR24fu36FNzX5pmfY7EPStlSLIgb6gwk616QRYk8tS88/l/2PT/loyqbQkEmhPpNGNp1CmvtieQHvONGtL4sdy9Hjp5kkpTWmSzM7L529hErHs0cCpt2qW00BymDV3JXSU8HkAXKIjtNnedxS48m4Mr5cR9YlMrx+XTqNRmbP2ZkMOjvHKir/PNa5pouiitFjH44iZ6YwO5tFAy+eo6SdpOUJyhBQTJR+HT9HYLJaFve0PqQmTQLaVOCdmIRIWE+wrmWTzG8iAugF7qgWjSWkGbYa32EjJQTkGFv5dBZNJKCeHdb77UPXZP1rWhKLZ4Rqjv2Fz86lLMNlpusCY9BnqTNUIyTgrVhhs7rVq2KoW2TSxWlXLOCqWX4svmpzZdEjWvgQcdVWPnu+i4ClUS+HyLIFnsVf/9eBduw8eKYy2D1XMxO8Jg+IB9wl+3s/uAC3qKMpXY88m/ecnUHaSis3Na8Ab1UtaCh3j1y+sm8m9o0J+9Fv9MR4Zhw6DufTWasOebsOs+xZKHJOtvtQtertulrwV+0BtH5yWvyW7CxubsCTX9+KUQZ4ga7qmdGUFmrya8QWHwcxlReMF8Mw4QETrR8oy7tq2ivH5Tvya8n8aXZMGc4An/nRDpy52FfR8b5KCJCImt8YkYF/KDtnegfwz3sPodGajQajCTk9z/4mQ6iphMWv9AA9IeMWdyYdn+gBkVc5amwHWV6lHvVaI2YZzfinN95Ngv/htcT/p31CRNbdV8l8e++xD5HPNeHxhx5Bgf18kTN5T1kvjBfEjGjBJCai4gnjHqAnlvqS8e9NeujEjEul/NokDbai4V/2voafHD1S0evdWLeb8ojMNyly5fS//ffbcD0L33j4K4RX4rtMh/UUGLXmr6BWXN9MEFAhYfzmZ6hcXI+TpISRH8061Ui68gTWGUJP4aU9P8ZrB39S+Xkx1ummPSMkbebnJcxU1jm4D5eGhvB7j32HJcpUJHhxLIfxTZpxwGa8eKrHC51a9Tmp+N5P1RsQ01cJAwEflHw8/+pfYn/HgaQ+n7/a1vd6k+BUS2XvVD401TXhu488gQ0r71QUuLJsrWT8mSYtfkBMm0BAmFhNrgDX4oRqqeaJMw4c6TyIv/qPP0Xf8KUJ6sXuP1XluuEEyGsD5TXKgsqBNQvW4RtbnkDb4ttJQlGt/IQqLMJE7tWqOSBZCSrL6dFSqq3AnzhzDC/tewHt5w4nr3suvgN0+P8o3TeegFe3vYDHtj+xhLt/Q3kkeW5d693YuuHXsWHZPcixW4tCwo+trVU9QEs8G6HFqW5kdBiHTu3H64dfxpGuK8r665Tv7tz2D6e/tP23cT0E1OA5QR2iiIbs1i9u/9qTPPC12CtwlIofjZVvW/BZ3LVsC5bPW4u5DQuxaPay2NpRIuy61IkLA+dw8hdHceDUPpw49z9TXUysvWPXtl3bQ4yQtMJ1a18DAsbvRO/atvM5DXXPPbp9yzP8+GXBXTkngKYBdTWvE5RXdm87+HQEfLh2T57UIAdM95Js9+04LKSDbLzG31+Omxpx9xfxKR6AukkhMP0aKuUHsag5VEzE3fGSddsUVu6KFzIE+H/iJry0mX+bu8VfMwTMEDBDwAwBMwTMEHALv/5XgAEASpR5N6rB30UAAAAASUVORK5CYII=";this._callbackGamepadConnected=n;this.gamepadSupportAvailable?(this.gamepadEventSupported?(window.addEventListener("gamepadconnected",function(n){t._onGamepadConnected(n)},!1),window.addEventListener("gamepaddisconnected",function(n){t._onGamepadDisconnected(n)},!1)):this._startMonitoringGamepads(),this.oneGamepadConnected||this._insertGamepadDOMInstructions()):this._insertGamepadDOMNotSupported()}return n.prototype._insertGamepadDOMInstructions=function(){var i,t;n.gamepadDOMInfo=document.createElement("div");i=document.createElement("img");i.src=this.buttonADataURL;t=document.createElement("span");t.innerHTML="<strong>to activate gamepad<\/strong>";n.gamepadDOMInfo.appendChild(i);n.gamepadDOMInfo.appendChild(t);n.gamepadDOMInfo.style.position="absolute";n.gamepadDOMInfo.style.width="100%";n.gamepadDOMInfo.style.height="48px";n.gamepadDOMInfo.style.bottom="0px";n.gamepadDOMInfo.style.backgroundColor="rgba(1, 1, 1, 0.15)";n.gamepadDOMInfo.style.textAlign="center";n.gamepadDOMInfo.style.zIndex="10";i.style.position="relative";i.style.bottom="8px";t.style.position="relative";t.style.fontSize="32px";t.style.bottom="32px";t.style.color="green";document.body.appendChild(n.gamepadDOMInfo)},n.prototype._insertGamepadDOMNotSupported=function(){n.gamepadDOMInfo=document.createElement("div");var t=document.createElement("span");t.innerHTML="<strong>gamepad not supported<\/strong>";n.gamepadDOMInfo.appendChild(t);n.gamepadDOMInfo.style.position="absolute";n.gamepadDOMInfo.style.width="100%";n.gamepadDOMInfo.style.height="40px";n.gamepadDOMInfo.style.bottom="0px";n.gamepadDOMInfo.style.backgroundColor="rgba(1, 1, 1, 0.15)";n.gamepadDOMInfo.style.textAlign="center";n.gamepadDOMInfo.style.zIndex="10";t.style.position="relative";t.style.fontSize="32px";t.style.color="red";document.body.appendChild(n.gamepadDOMInfo)},n.prototype.dispose=function(){n.gamepadDOMInfo&&document.body.removeChild(n.gamepadDOMInfo)},n.prototype._onGamepadConnected=function(n){var t=this._addNewGamepad(n.gamepad);this._callbackGamepadConnected&&this._callbackGamepadConnected(t);this._startMonitoringGamepads()},n.prototype._addNewGamepad=function(t){this.oneGamepadConnected||(this.oneGamepadConnected=!0,n.gamepadDOMInfo&&(document.body.removeChild(n.gamepadDOMInfo),n.gamepadDOMInfo=null));var i;return i=-1!==t.id.search("Xbox 360")||-1!==t.id.search("xinput")?new f(t.id,t.index,t):new u(t.id,t.index,t),this.babylonGamepads.push(i),i},n.prototype._onGamepadDisconnected=function(n){for(var t in this.babylonGamepads)if(this.babylonGamepads[t].index==n.gamepad.index){this.babylonGamepads.splice(t,1);break}0==this.babylonGamepads.length&&this._stopMonitoringGamepads()},n.prototype._startMonitoringGamepads=function(){this.isMonitoring||(this.isMonitoring=!0,this._checkGamepadsStatus())},n.prototype._stopMonitoringGamepads=function(){this.isMonitoring=!1},n.prototype._checkGamepadsStatus=function(){var n=this,t;this._updateGamepadObjects();for(t in this.babylonGamepads)this.babylonGamepads[t].update();this.isMonitoring&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){n._checkGamepadsStatus()}):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(function(){n._checkGamepadsStatus()}):window.webkitRequestAnimationFrame&&window.webkitRequestAnimationFrame(function(){n._checkGamepadsStatus()}))},n.prototype._updateGamepadObjects=function(){for(var i,t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],n=0;n<t.length;n++)t[n]&&(t[n].index in this.babylonGamepads?this.babylonGamepads[n].browserGamepad=t[n]:(i=this._addNewGamepad(t[n]),this._callbackGamepadConnected&&this._callbackGamepadConnected(i)))},n}(),e,r,u,t,i,f;n.Gamepads=o;e=function(){function n(n,t){this.x=n;this.y=t}return n}();n.StickValues=e;r=function(){function n(n,t,i){this.id=n;this.index=t;this.browserGamepad=i;this.browserGamepad.axes.length>=2&&(this._leftStick={x:this.browserGamepad.axes[0],y:this.browserGamepad.axes[1]});this.browserGamepad.axes.length>=4&&(this._rightStick={x:this.browserGamepad.axes[2],y:this.browserGamepad.axes[3]})}return n.prototype.onleftstickchanged=function(n){this._onleftstickchanged=n},n.prototype.onrightstickchanged=function(n){this._onrightstickchanged=n},Object.defineProperty(n.prototype,"leftStick",{get:function(){return this._leftStick},set:function(n){this._onleftstickchanged&&(this._leftStick.x!==n.x||this._leftStick.y!==n.y)&&this._onleftstickchanged(n);this._leftStick=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightStick",{get:function(){return this._rightStick},set:function(n){this._onrightstickchanged&&(this._rightStick.x!==n.x||this._rightStick.y!==n.y)&&this._onrightstickchanged(n);this._rightStick=n},enumerable:!0,configurable:!0}),n.prototype.update=function(){this._leftStick&&(this.leftStick={x:this.browserGamepad.axes[0],y:this.browserGamepad.axes[1]});this._rightStick&&(this.rightStick={x:this.browserGamepad.axes[2],y:this.browserGamepad.axes[3]})},n}();n.Gamepad=r;u=function(n){function t(t,i,r){n.call(this,t,i,r);this.id=t;this.index=i;this.gamepad=r;this._buttons=new Array(r.buttons.length)}return __extends(t,n),t.prototype.onbuttondown=function(n){this._onbuttondown=n},t.prototype.onbuttonup=function(n){this._onbuttonup=n},t.prototype._setButtonValue=function(n,t,i){return n!==t&&(this._onbuttondown&&1===n&&this._onbuttondown(i),this._onbuttonup&&0===n&&this._onbuttonup(i)),n},t.prototype.update=function(){n.prototype.update.call(this);for(var t=0;t<this._buttons.length;t++)this._buttons[t]=this._setButtonValue(this.gamepad.buttons[t].value,this._buttons[t],t)},t}(r);n.GenericPad=u,function(n){n[n.A=0]="A";n[n.B=1]="B";n[n.X=2]="X";n[n.Y=3]="Y";n[n.Start=4]="Start";n[n.Back=5]="Back";n[n.LB=6]="LB";n[n.RB=7]="RB";n[n.LeftStick=8]="LeftStick";n[n.RightStick=9]="RightStick"}(n.Xbox360Button||(n.Xbox360Button={}));t=n.Xbox360Button;!function(n){n[n.Up=0]="Up";n[n.Down=1]="Down";n[n.Left=2]="Left";n[n.Right=3]="Right"}(n.Xbox360Dpad||(n.Xbox360Dpad={}));i=n.Xbox360Dpad;f=function(n){function r(){n.apply(this,arguments);this._leftTrigger=0;this._rightTrigger=0;this._buttonA=0;this._buttonB=0;this._buttonX=0;this._buttonY=0;this._buttonBack=0;this._buttonStart=0;this._buttonLB=0;this._buttonRB=0;this._buttonLeftStick=0;this._buttonRightStick=0;this._dPadUp=0;this._dPadDown=0;this._dPadLeft=0;this._dPadRight=0}return __extends(r,n),r.prototype.onlefttriggerchanged=function(n){this._onlefttriggerchanged=n},r.prototype.onrighttriggerchanged=function(n){this._onrighttriggerchanged=n},Object.defineProperty(r.prototype,"leftTrigger",{get:function(){return this._leftTrigger},set:function(n){this._onlefttriggerchanged&&this._leftTrigger!==n&&this._onlefttriggerchanged(n);this._leftTrigger=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rightTrigger",{get:function(){return this._rightTrigger},set:function(n){this._onrighttriggerchanged&&this._rightTrigger!==n&&this._onrighttriggerchanged(n);this._rightTrigger=n},enumerable:!0,configurable:!0}),r.prototype.onbuttondown=function(n){this._onbuttondown=n},r.prototype.onbuttonup=function(n){this._onbuttonup=n},r.prototype.ondpaddown=function(n){this._ondpaddown=n},r.prototype.ondpadup=function(n){this._ondpadup=n},r.prototype._setButtonValue=function(n,t,i){return n!==t&&(this._onbuttondown&&1===n&&this._onbuttondown(i),this._onbuttonup&&0===n&&this._onbuttonup(i)),n},r.prototype._setDPadValue=function(n,t,i){return n!==t&&(this._ondpaddown&&1===n&&this._ondpaddown(i),this._ondpadup&&0===n&&this._ondpadup(i)),n},Object.defineProperty(r.prototype,"buttonA",{get:function(){return this._buttonA},set:function(n){this._buttonA=this._setButtonValue(n,this._buttonA,t.A)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonB",{get:function(){return this._buttonB},set:function(n){this._buttonB=this._setButtonValue(n,this._buttonB,t.B)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonX",{get:function(){return this._buttonX},set:function(n){this._buttonX=this._setButtonValue(n,this._buttonX,t.X)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonY",{get:function(){return this._buttonY},set:function(n){this._buttonY=this._setButtonValue(n,this._buttonY,t.Y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonStart",{get:function(){return this._buttonStart},set:function(n){this._buttonStart=this._setButtonValue(n,this._buttonStart,t.Start)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonBack",{get:function(){return this._buttonBack},set:function(n){this._buttonBack=this._setButtonValue(n,this._buttonBack,t.Back)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonLB",{get:function(){return this._buttonLB},set:function(n){this._buttonLB=this._setButtonValue(n,this._buttonLB,t.LB)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonRB",{get:function(){return this._buttonRB},set:function(n){this._buttonRB=this._setButtonValue(n,this._buttonRB,t.RB)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonLeftStick",{get:function(){return this._buttonLeftStick},set:function(n){this._buttonLeftStick=this._setButtonValue(n,this._buttonLeftStick,t.LeftStick)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buttonRightStick",{get:function(){return this._buttonRightStick},set:function(n){this._buttonRightStick=this._setButtonValue(n,this._buttonRightStick,t.RightStick)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dPadUp",{get:function(){return this._dPadUp},set:function(n){this._dPadUp=this._setDPadValue(n,this._dPadUp,i.Up)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dPadDown",{get:function(){return this._dPadDown},set:function(n){this._dPadDown=this._setDPadValue(n,this._dPadDown,i.Down)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dPadLeft",{get:function(){return this._dPadLeft},set:function(n){this._dPadLeft=this._setDPadValue(n,this._dPadLeft,i.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dPadRight",{get:function(){return this._dPadRight},set:function(n){this._dPadRight=this._setDPadValue(n,this._dPadRight,i.Right)},enumerable:!0,configurable:!0}),r.prototype.update=function(){n.prototype.update.call(this);this.buttonA=this.browserGamepad.buttons[0].value;this.buttonB=this.browserGamepad.buttons[1].value;this.buttonX=this.browserGamepad.buttons[2].value;this.buttonY=this.browserGamepad.buttons[3].value;this.buttonLB=this.browserGamepad.buttons[4].value;this.buttonRB=this.browserGamepad.buttons[5].value;this.leftTrigger=this.browserGamepad.buttons[6].value;this.rightTrigger=this.browserGamepad.buttons[7].value;this.buttonBack=this.browserGamepad.buttons[8].value;this.buttonStart=this.browserGamepad.buttons[9].value;this.buttonLeftStick=this.browserGamepad.buttons[10].value;this.buttonRightStick=this.browserGamepad.buttons[11].value;this.dPadUp=this.browserGamepad.buttons[12].value;this.dPadDown=this.browserGamepad.buttons[13].value;this.dPadLeft=this.browserGamepad.buttons[14].value;this.dPadRight=this.browserGamepad.buttons[15].value},r}(r);n.Xbox360Pad=f}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u){var f=this;t.call(this,i,r,u);this.angularSensibility=200;this.moveSensibility=75;this._gamepads=new n.Gamepads(function(n){f._onNewGameConnected(n)})}return __extends(i,t),i.prototype._onNewGameConnected=function(n){0===n.index&&(this._gamepad=n)},i.prototype._checkInputs=function(){if(this._gamepad){var i=this._gamepad.leftStick,u=i.x/this.moveSensibility,f=i.y/this.moveSensibility;i.x=Math.abs(u)>.005?0+u:0;i.y=Math.abs(f)>.005?0+f:0;var r=this._gamepad.rightStick,e=r.x/this.angularSensibility,o=r.y/this.angularSensibility;r.x=Math.abs(e)>.001?0+e:0;r.y=Math.abs(o)>.001?0+o:0;var h=n.Matrix.RotationYawPitchRoll(this.rotation.y,this.rotation.x,0),s=50*this._computeLocalCameraSpeed(),c=n.Vector3.TransformCoordinates(new n.Vector3(i.x*s,0,-i.y*s),h);this.cameraDirection=this.cameraDirection.add(c);this.cameraRotation=this.cameraRotation.add(new n.Vector2(r.y,r.x))}t.prototype._checkInputs.call(this)},i.prototype.dispose=function(){this._gamepads.dispose();t.prototype.dispose.call(this)},i}(n.FreeCamera);n.GamepadCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n){this._renderingGroups=[];this._scene=n}return t.prototype._renderParticles=function(t,i){var r;if(0!==this._scene._activeParticleSystems.length){for(var f=this._scene.activeCamera,e=n.Tools.Now,u=0;u<this._scene._activeParticleSystems.length;u++)r=this._scene._activeParticleSystems.data[u],r.renderingGroupId===t&&0!=(f.layerMask&r.layerMask)&&(this._clearDepthBuffer(),r.emitter.position&&i&&-1===i.indexOf(r.emitter)||(this._scene._activeParticles+=r.render()));this._scene._particlesDuration+=n.Tools.Now-e}},t.prototype._renderSprites=function(t){var i;if(this._scene.spritesEnabled&&0!==this._scene.spriteManagers.length){for(var u=this._scene.activeCamera,f=n.Tools.Now,r=0;r<this._scene.spriteManagers.length;r++)i=this._scene.spriteManagers[r],i.renderingGroupId===t&&0!=(u.layerMask&i.layerMask)&&(this._clearDepthBuffer(),i.render());this._scene._spritesDuration+=n.Tools.Now-f}},t.prototype._clearDepthBuffer=function(){this._depthBufferAlreadyCleaned||(this._scene.getEngine().clear(0,!1,!0),this._depthBufferAlreadyCleaned=!0)},t.prototype.render=function(n,i,r,u){for(var e,o,f=0;f<t.MAX_RENDERINGGROUPS;f++)this._depthBufferAlreadyCleaned=!1,e=this._renderingGroups[f],o=!1,e&&(this._clearDepthBuffer(),e.render(n)||(this._renderingGroups.splice(f,1),o=!0)),u&&this._renderSprites(f),r&&this._renderParticles(f,i),o&&f--},t.prototype.reset=function(){this._renderingGroups.forEach(function(n){n&&n.prepare()})},t.prototype.dispatch=function(t){var r=t.getMesh(),i=r.renderingGroupId||0;this._renderingGroups[i]||(this._renderingGroups[i]=new n.RenderingGroup(i,this._scene));this._renderingGroups[i].dispatch(t)},t.MAX_RENDERINGGROUPS=4,t}();n.RenderingManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){this.index=t;this._opaqueSubMeshes=new n.SmartArray(256);this._transparentSubMeshes=new n.SmartArray(256);this._alphaTestSubMeshes=new n.SmartArray(256);this._scene=i}return t.prototype.render=function(t){var i,r,u,f;if(t)return t(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes),!0;if(0===this._opaqueSubMeshes.length&&0===this._alphaTestSubMeshes.length&&0===this._transparentSubMeshes.length)return!1;for(u=this._scene.getEngine(),i=0;i<this._opaqueSubMeshes.length;i++)r=this._opaqueSubMeshes.data[i],r.render(!1);for(u.setAlphaTesting(!0),i=0;i<this._alphaTestSubMeshes.length;i++)r=this._alphaTestSubMeshes.data[i],r.render(!1);if(u.setAlphaTesting(!1),this._transparentSubMeshes.length){for(i=0;i<this._transparentSubMeshes.length;i++)r=this._transparentSubMeshes.data[i],r._alphaIndex=r.getMesh().alphaIndex,r._distanceToCamera=r.getBoundingInfo().boundingSphere.centerWorld.subtract(this._scene.activeCamera.globalPosition).length();for(f=this._transparentSubMeshes.data.slice(0,this._transparentSubMeshes.length),f.sort(function(n,t){return n._alphaIndex>t._alphaIndex?1:n._alphaIndex<t._alphaIndex?-1:n._distanceToCamera<t._distanceToCamera?1:n._distanceToCamera>t._distanceToCamera?-1:0}),i=0;i<f.length;i++)r=f[i],r.render(!0);u.setAlphaMode(n.Engine.ALPHA_DISABLE)}return!0},t.prototype.prepare=function(){this._opaqueSubMeshes.reset();this._transparentSubMeshes.reset();this._alphaTestSubMeshes.reset()},t.prototype.dispatch=function(n){var t=n.getMaterial(),i=n.getMesh();t.needAlphaBlending()||i.visibility<1||i.hasVertexAlpha?this._transparentSubMeshes.push(n):t.needAlphaTesting()?this._alphaTestSubMeshes.push(n):this._opaqueSubMeshes.push(n)},t}();n.RenderingGroup=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(i){this.autoClear=!0;this.clearColor=new n.Color3(.2,.2,.3);this.ambientColor=new n.Color3(0,0,0);this.forceWireframe=!1;this.forcePointsCloud=!1;this.forceShowBoundingBoxes=!1;this.animationsEnabled=!0;this.cameraToUseForPointers=null;this.fogEnabled=!0;this.fogMode=t.FOGMODE_NONE;this.fogColor=new n.Color3(.2,.2,.3);this.fogDensity=.1;this.fogStart=0;this.fogEnd=1e3;this.shadowsEnabled=!0;this.lightsEnabled=!0;this.lights=[];this.cameras=[];this.activeCameras=[];this.meshes=[];this._geometries=[];this.materials=[];this.multiMaterials=[];this.defaultMaterial=new n.StandardMaterial("default material",this);this.texturesEnabled=!0;this.textures=[];this.particlesEnabled=!0;this.particleSystems=[];this.spritesEnabled=!0;this.spriteManagers=[];this.layers=[];this.skeletonsEnabled=!0;this.skeletons=[];this.lensFlaresEnabled=!0;this.lensFlareSystems=[];this.collisionsEnabled=!0;this.gravity=new n.Vector3(0,-9.807,0);this.postProcessesEnabled=!0;this.renderTargetsEnabled=!0;this.dumpNextRenderTargets=!1;this.customRenderTargets=[];this.importedMeshesFiles=[];this._actionManagers=[];this._meshesForIntersections=new n.SmartArray(256);this.proceduralTexturesEnabled=!0;this._proceduralTextures=[];this.soundTracks=[];this._audioEnabled=!0;this._headphone=!1;this._totalVertices=0;this._activeIndices=0;this._activeParticles=0;this._lastFrameDuration=0;this._evaluateActiveMeshesDuration=0;this._renderTargetsDuration=0;this._particlesDuration=0;this._renderDuration=0;this._spritesDuration=0;this._animationRatio=0;this._renderId=0;this._executeWhenReadyTimeoutId=-1;this._toBeDisposed=new n.SmartArray(256);this._onReadyCallbacks=[];this._pendingData=[];this._onBeforeRenderCallbacks=[];this._onAfterRenderCallbacks=[];this._activeMeshes=new n.SmartArray(256);this._processedMaterials=new n.SmartArray(256);this._renderTargets=new n.SmartArray(256);this._activeParticleSystems=new n.SmartArray(256);this._activeSkeletons=new n.SmartArray(32);this._softwareSkinnedMeshes=new n.SmartArray(32);this._activeBones=0;this._activeAnimatables=[];this._transformMatrix=n.Matrix.Zero();this._edgesRenderers=new n.SmartArray(16);this._uniqueIdCounter=0;this._engine=i;i.scenes.push(this);this._renderingManager=new n.RenderingManager(this);this.postProcessManager=new n.PostProcessManager(this);this.postProcessRenderPipelineManager=new n.PostProcessRenderPipelineManager;this._boundingBoxRenderer=new n.BoundingBoxRenderer(this);this._outlineRenderer=new n.OutlineRenderer(this);this.attachControl();this._debugLayer=new n.DebugLayer(this);this.mainSoundTrack=new n.SoundTrack(this,{mainTrack:!0});this.simplificationQueue=new n.SimplificationQueue;this.workerCollisions=!1}return Object.defineProperty(t,"FOGMODE_NONE",{get:function(){return t._FOGMODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FOGMODE_EXP",{get:function(){return t._FOGMODE_EXP},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FOGMODE_EXP2",{get:function(){return t._FOGMODE_EXP2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FOGMODE_LINEAR",{get:function(){return t._FOGMODE_LINEAR},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugLayer",{get:function(){return this._debugLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workerCollisions",{get:function(){return this._workerCollisions},set:function(t){t=t&&!!Worker;this._workerCollisions=t;this.collisionCoordinator&&this.collisionCoordinator.destroy();this.collisionCoordinator=t?new n.CollisionCoordinatorWorker:new n.CollisionCoordinatorLegacy;this.collisionCoordinator.init(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SelectionOctree",{get:function(){return this._selectionOctree},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"meshUnderPointer",{get:function(){return this._meshUnderPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerX",{get:function(){return this._pointerX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerY",{get:function(){return this._pointerY},enumerable:!0,configurable:!0}),t.prototype.getCachedMaterial=function(){return this._cachedMaterial},t.prototype.getBoundingBoxRenderer=function(){return this._boundingBoxRenderer},t.prototype.getOutlineRenderer=function(){return this._outlineRenderer},t.prototype.getEngine=function(){return this._engine},t.prototype.getTotalVertices=function(){return this._totalVertices},t.prototype.getActiveIndices=function(){return this._activeIndices},t.prototype.getActiveParticles=function(){return this._activeParticles},t.prototype.getActiveBones=function(){return this._activeBones},t.prototype.getLastFrameDuration=function(){return this._lastFrameDuration},t.prototype.getEvaluateActiveMeshesDuration=function(){return this._evaluateActiveMeshesDuration},t.prototype.getActiveMeshes=function(){return this._activeMeshes},t.prototype.getRenderTargetsDuration=function(){return this._renderTargetsDuration},t.prototype.getRenderDuration=function(){return this._renderDuration},t.prototype.getParticlesDuration=function(){return this._particlesDuration},t.prototype.getSpritesDuration=function(){return this._spritesDuration},t.prototype.getAnimationRatio=function(){return this._animationRatio},t.prototype.getRenderId=function(){return this._renderId},t.prototype.incrementRenderId=function(){this._renderId++},t.prototype._updatePointerPosition=function(n){var t=this._engine.getRenderingCanvasClientRect();this._pointerX=n.clientX-t.left;this._pointerY=n.clientY-t.top;this.cameraToUseForPointers&&(this._pointerX=this._pointerX-this.cameraToUseForPointers.viewport.x*this._engine.getRenderWidth(),this._pointerY=this._pointerY-this.cameraToUseForPointers.viewport.y*this._engine.getRenderHeight())},t.prototype.attachControl=function(){var t=this,i;this._onPointerMove=function(n){var r=t._engine.getRenderingCanvas(),i;t._updatePointerPosition(n);i=t.pick(t._pointerX,t._pointerY,function(n){return n.isPickable&&n.isVisible&&n.isReady()},!1,t.cameraToUseForPointers);i.hit?(t._meshUnderPointer=i.pickedMesh,t.setPointerOverMesh(i.pickedMesh),r.style.cursor=t._meshUnderPointer.actionManager&&t._meshUnderPointer.actionManager.hasPointerTriggers?"pointer":""):(t.setPointerOverMesh(null),r.style.cursor="",t._meshUnderPointer=null)};this._onPointerDown=function(i){var u=null,r;if(t.onPointerDown||(u=function(n){return n.isPickable&&n.isVisible&&n.isReady()&&n.actionManager&&n.actionManager.hasPickTriggers}),t._updatePointerPosition(i),r=t.pick(t._pointerX,t._pointerY,u,!1,t.cameraToUseForPointers),r.hit&&r.pickedMesh.actionManager){switch(i.button){case 0:r.pickedMesh.actionManager.processTrigger(n.ActionManager.OnLeftPickTrigger,n.ActionEvent.CreateNew(r.pickedMesh,i));break;case 1:r.pickedMesh.actionManager.processTrigger(n.ActionManager.OnCenterPickTrigger,n.ActionEvent.CreateNew(r.pickedMesh,i));break;case 2:r.pickedMesh.actionManager.processTrigger(n.ActionManager.OnRightPickTrigger,n.ActionEvent.CreateNew(r.pickedMesh,i))}r.pickedMesh.actionManager.processTrigger(n.ActionManager.OnPickTrigger,n.ActionEvent.CreateNew(r.pickedMesh,i))}t.onPointerDown&&t.onPointerDown(i,r)};this._onPointerUp=function(i){var u=null,r;t.onPointerUp||(u=function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.actionManager&&t.actionManager.hasSpecificTrigger(n.ActionManager.OnPickUpTrigger)});t._updatePointerPosition(i);r=t.pick(t._pointerX,t._pointerY,u,!1,t.cameraToUseForPointers);r.hit&&r.pickedMesh.actionManager&&r.pickedMesh.actionManager.processTrigger(n.ActionManager.OnPickUpTrigger,n.ActionEvent.CreateNew(r.pickedMesh,i));t.onPointerUp&&t.onPointerUp(i,r)};this._onKeyDown=function(i){t.actionManager&&t.actionManager.processTrigger(n.ActionManager.OnKeyDownTrigger,n.ActionEvent.CreateNewFromScene(t,i))};this._onKeyUp=function(i){t.actionManager&&t.actionManager.processTrigger(n.ActionManager.OnKeyUpTrigger,n.ActionEvent.CreateNewFromScene(t,i))};i=n.Tools.GetPointerPrefix();this._engine.getRenderingCanvas().addEventListener(i+"move",this._onPointerMove,!1);this._engine.getRenderingCanvas().addEventListener(i+"down",this._onPointerDown,!1);this._engine.getRenderingCanvas().addEventListener(i+"up",this._onPointerUp,!1);this._engine.getRenderingCanvas().addEventListener("mousewheel",this._onPointerMove,!1);this._engine.getRenderingCanvas().addEventListener("DOMMouseScroll",this._onPointerMove,!1);n.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp}])},t.prototype.detachControl=function(){var t=n.Tools.GetPointerPrefix();this._engine.getRenderingCanvas().removeEventListener(t+"move",this._onPointerMove);this._engine.getRenderingCanvas().removeEventListener(t+"down",this._onPointerDown);this._engine.getRenderingCanvas().removeEventListener(t+"up",this._onPointerUp);this._engine.getRenderingCanvas().removeEventListener("mousewheel",this._onPointerMove);this._engine.getRenderingCanvas().removeEventListener("DOMMouseScroll",this._onPointerMove);n.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp}])},t.prototype.isReady=function(){var t,u,i,r;if(this._pendingData.length>0)return!1;for(t=0;t<this._geometries.length;t++)if(u=this._geometries[t],u.delayLoadState===n.Engine.DELAYLOADSTATE_LOADING)return!1;for(t=0;t<this.meshes.length;t++)if((i=this.meshes[t],!i.isReady())||(r=i.material,r&&!r.isReady(i)))return!1;return!0},t.prototype.resetCachedMaterial=function(){this._cachedMaterial=null},t.prototype.registerBeforeRender=function(n){this._onBeforeRenderCallbacks.push(n)},t.prototype.unregisterBeforeRender=function(n){var t=this._onBeforeRenderCallbacks.indexOf(n);t>-1&&this._onBeforeRenderCallbacks.splice(t,1)},t.prototype.registerAfterRender=function(n){this._onAfterRenderCallbacks.push(n)},t.prototype.unregisterAfterRender=function(n){var t=this._onAfterRenderCallbacks.indexOf(n);t>-1&&this._onAfterRenderCallbacks.splice(t,1)},t.prototype._addPendingData=function(n){this._pendingData.push(n)},t.prototype._removePendingData=function(n){var t=this._pendingData.indexOf(n);-1!==t&&this._pendingData.splice(t,1)},t.prototype.getWaitingItemsCount=function(){return this._pendingData.length},t.prototype.executeWhenReady=function(n){var t=this;this._onReadyCallbacks.push(n);-1===this._executeWhenReadyTimeoutId&&(this._executeWhenReadyTimeoutId=setTimeout(function(){t._checkIsReady()},150))},t.prototype._checkIsReady=function(){var n=this;return this.isReady()?(this._onReadyCallbacks.forEach(function(n){n()}),this._onReadyCallbacks=[],void(this._executeWhenReadyTimeoutId=-1)):void(this._executeWhenReadyTimeoutId=setTimeout(function(){n._checkIsReady()},150))},t.prototype.beginAnimation=function(t,i,r,u,f,e,o){if(void 0===f&&(f=1),this.stopAnimation(t),o||(o=new n.Animatable(this,t,i,r,u,f,e)),t.animations&&o.appendAnimations(t,t.animations),t.getAnimatables)for(var h=t.getAnimatables(),s=0;s<h.length;s++)this.beginAnimation(h[s],i,r,u,f,e,o);return o},t.prototype.beginDirectAnimation=function(t,i,r,u,f,e,o){void 0===e&&(e=1);return new n.Animatable(this,t,r,u,f,e,o,i)},t.prototype.getAnimatableByTarget=function(n){for(var t=0;t<this._activeAnimatables.length;t++)if(this._activeAnimatables[t].target===n)return this._activeAnimatables[t];return null},t.prototype.stopAnimation=function(n){var t=this.getAnimatableByTarget(n);t&&t.stop()},t.prototype._animate=function(){if(this.animationsEnabled){this._animationStartDate||(this._animationStartDate=n.Tools.Now);for(var i=n.Tools.Now,r=i-this._animationStartDate,t=0;t<this._activeAnimatables.length;t++)this._activeAnimatables[t]._animate(r)}},t.prototype.getViewMatrix=function(){return this._viewMatrix},t.prototype.getProjectionMatrix=function(){return this._projectionMatrix},t.prototype.getTransformMatrix=function(){return this._transformMatrix},t.prototype.setTransformMatrix=function(n,t){this._viewMatrix=n;this._projectionMatrix=t;this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)},t.prototype.addMesh=function(n){n.uniqueId=this._uniqueIdCounter++;var t=this.meshes.push(n);this.collisionCoordinator.onMeshAdded(n);this.onNewMeshAdded&&this.onNewMeshAdded(n,t,this)},t.prototype.removeMesh=function(n){var t=this.meshes.indexOf(n);return-1!==t&&this.meshes.splice(t,1),this.collisionCoordinator.onMeshRemoved(n),this.onMeshRemoved&&this.onMeshRemoved(n),t},t.prototype.removeLight=function(n){var t=this.lights.indexOf(n);return-1!==t&&this.lights.splice(t,1),this.onLightRemoved&&this.onLightRemoved(n),t},t.prototype.removeCamera=function(n){var t=this.cameras.indexOf(n),i;return-1!==t&&this.cameras.splice(t,1),i=this.activeCameras.indexOf(n),-1!==i&&this.activeCameras.splice(i,1),this.activeCamera===n&&(this.activeCamera=this.cameras.length>0?this.cameras[0]:null),this.onCameraRemoved&&this.onCameraRemoved(n),t},t.prototype.addLight=function(n){n.uniqueId=this._uniqueIdCounter++;var t=this.lights.push(n);this.onNewLightAdded&&this.onNewLightAdded(n,t,this)},t.prototype.addCamera=function(n){n.uniqueId=this._uniqueIdCounter++;var t=this.cameras.push(n);this.onNewCameraAdded&&this.onNewCameraAdded(n,t,this)},t.prototype.setActiveCameraByID=function(n){var t=this.getCameraByID(n);return t?(this.activeCamera=t,t):null},t.prototype.setActiveCameraByName=function(n){var t=this.getCameraByName(n);return t?(this.activeCamera=t,t):null},t.prototype.getMaterialByID=function(n){for(var t=0;t<this.materials.length;t++)if(this.materials[t].id===n)return this.materials[t];return null},t.prototype.getMaterialByName=function(n){for(var t=0;t<this.materials.length;t++)if(this.materials[t].name===n)return this.materials[t];return null},t.prototype.getLensFlareSystemByName=function(n){for(var t=0;t<this.lensFlareSystems.length;t++)if(this.lensFlareSystems[t].name===n)return this.lensFlareSystems[t];return null},t.prototype.getCameraByID=function(n){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].id===n)return this.cameras[t];return null},t.prototype.getCameraByUniqueID=function(n){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].uniqueId===n)return this.cameras[t];return null},t.prototype.getCameraByName=function(n){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].name===n)return this.cameras[t];return null},t.prototype.getLightByName=function(n){for(var t=0;t<this.lights.length;t++)if(this.lights[t].name===n)return this.lights[t];return null},t.prototype.getLightByID=function(n){for(var t=0;t<this.lights.length;t++)if(this.lights[t].id===n)return this.lights[t];return null},t.prototype.getLightByUniqueID=function(n){for(var t=0;t<this.lights.length;t++)if(this.lights[t].uniqueId===n)return this.lights[t];return null},t.prototype.getGeometryByID=function(n){for(var t=0;t<this._geometries.length;t++)if(this._geometries[t].id===n)return this._geometries[t];return null},t.prototype.pushGeometry=function(n,t){return!t&&this.getGeometryByID(n.id)?!1:(this._geometries.push(n),this.collisionCoordinator.onGeometryAdded(n),this.onGeometryAdded&&this.onGeometryAdded(n),!0)},t.prototype.removeGeometry=function(n){var t=this._geometries.indexOf(n);return t>-1?(this._geometries.splice(t,1),this.collisionCoordinator.onGeometryDeleted(n),this.onGeometryRemoved&&this.onGeometryRemoved(n),!0):!1},t.prototype.getGeometries=function(){return this._geometries},t.prototype.getMeshByID=function(n){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].id===n)return this.meshes[t];return null},t.prototype.getMeshByUniqueID=function(n){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].uniqueId===n)return this.meshes[t];return null},t.prototype.getLastMeshByID=function(n){for(var t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===n)return this.meshes[t];return null},t.prototype.getLastEntryByID=function(n){for(var t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===n)return this.meshes[t];for(t=this.cameras.length-1;t>=0;t--)if(this.cameras[t].id===n)return this.cameras[t];for(t=this.lights.length-1;t>=0;t--)if(this.lights[t].id===n)return this.lights[t];return null},t.prototype.getNodeByID=function(n){var i=this.getMeshByID(n),t;return i?i:(t=this.getLightByID(n),t?t:this.getCameraByID(n))},t.prototype.getNodeByName=function(n){var i=this.getMeshByName(n),t;return i?i:(t=this.getLightByName(n),t?t:this.getCameraByName(n))},t.prototype.getMeshByName=function(n){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].name===n)return this.meshes[t];return null},t.prototype.getSoundByName=function(n){for(var i,t=0;t<this.mainSoundTrack.soundCollection.length;t++)if(this.mainSoundTrack.soundCollection[t].name===n)return this.mainSoundTrack.soundCollection[t];for(i=0;i<this.soundTracks.length;i++)for(t=0;t<this.soundTracks[i].soundCollection.length;t++)if(this.soundTracks[i].soundCollection[t].name===n)return this.soundTracks[i].soundCollection[t];return null},t.prototype.getLastSkeletonByID=function(n){for(var t=this.skeletons.length-1;t>=0;t--)if(this.skeletons[t].id===n)return this.skeletons[t];return null},t.prototype.getSkeletonById=function(n){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].id===n)return this.skeletons[t];return null},t.prototype.getSkeletonByName=function(n){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].name===n)return this.skeletons[t];return null},t.prototype.isActiveMesh=function(n){return-1!==this._activeMeshes.indexOf(n)},t.prototype._evaluateSubMesh=function(n,t){if(t.alwaysSelectAsActiveMesh||1===t.subMeshes.length||n.isInFrustum(this._frustumPlanes)){var i=n.getMaterial();t.showSubMeshesBoundingBox&&this._boundingBoxRenderer.renderList.push(n.getBoundingInfo().boundingBox);i&&(i.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(i)&&(this._processedMaterials.push(i),this._renderTargets.concat(i.getRenderTargetTextures())),this._activeIndices+=n.indexCount,this._renderingManager.dispatch(n))}},t.prototype._evaluateActiveMeshes=function(){var f,e,o,r,t,s,h,u,i;for(this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._boundingBoxRenderer.reset(),this._edgesRenderers.reset(),this._frustumPlanes?n.Frustum.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=n.Frustum.GetPlanes(this._transformMatrix),this._selectionOctree?(o=this._selectionOctree.select(this._frustumPlanes),f=o.data,e=o.length):(e=this.meshes.length,f=this.meshes),r=0;e>r;r++)t=f[r],!t.isBlocked&&(this._totalVertices+=t.getTotalVertices(),t.isReady()&&t.isEnabled())&&(t.computeWorldMatrix(),t.actionManager&&t.actionManager.hasSpecificTriggers([n.ActionManager.OnIntersectionEnterTrigger,n.ActionManager.OnIntersectionExitTrigger])&&this._meshesForIntersections.pushNoDuplicate(t),s=t.getLOD(this.activeCamera),s&&(t._preActivate(),(t.alwaysSelectAsActiveMesh||t.isVisible&&t.visibility>0&&0!=(t.layerMask&this.activeCamera.layerMask)&&t.isInFrustum(this._frustumPlanes))&&(this._activeMeshes.push(t),this.activeCamera._activeMeshes.push(t),t._activate(this._renderId),this._activeMesh(s))));if(h=n.Tools.Now,this.particlesEnabled){for(n.Tools.StartPerformanceCounter("Particles",this.particleSystems.length>0),u=0;u<this.particleSystems.length;u++)i=this.particleSystems[u],i.isStarted()&&(!i.emitter.position||i.emitter&&i.emitter.isEnabled())&&(this._activeParticleSystems.push(i),i.animate());n.Tools.EndPerformanceCounter("Particles",this.particleSystems.length>0)}this._particlesDuration+=n.Tools.Now-h},t.prototype._activeMesh=function(n){var r,t,u,i,f;if(n.skeleton&&this.skeletonsEnabled&&(this._activeSkeletons.pushNoDuplicate(n.skeleton),n.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(n)),(n.showBoundingBox||this.forceShowBoundingBoxes)&&this._boundingBoxRenderer.renderList.push(n.getBoundingInfo().boundingBox),n._edgesRenderer&&this._edgesRenderers.push(n._edgesRenderer),n&&n.subMeshes)for(n._submeshesOctree&&n.useOctreeForRenderingSelection?(u=n._submeshesOctree.select(this._frustumPlanes),r=u.length,t=u.data):(t=n.subMeshes,r=t.length),i=0;r>i;i++)f=t[i],this._evaluateSubMesh(f,n)},t.prototype.updateTransformMatrix=function(n){this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(n))},t.prototype._renderForCamera=function(t){var r=this._engine,v,e,y,o,l,p,s,f,w,i,u,b,h,c,a;if(this.activeCamera=t,!this.activeCamera)throw new Error("Active camera not set");for(n.Tools.StartPerformanceCounter("Rendering camera "+this.activeCamera.name),r.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,this.updateTransformMatrix(),this.beforeCameraRender&&this.beforeCameraRender(this.activeCamera),v=n.Tools.Now,n.Tools.StartPerformanceCounter("Active meshes evaluation"),this._evaluateActiveMeshes(),this._evaluateActiveMeshesDuration+=n.Tools.Now-v,n.Tools.EndPerformanceCounter("Active meshes evaluation"),e=0;e<this._activeSkeletons.length;e++)y=this._activeSkeletons.data[e],y.prepare();for(o=0;o<this._softwareSkinnedMeshes.length;o++)l=this._softwareSkinnedMeshes.data[o],l.applySkeleton(l.skeleton);if(p=n.Tools.Now,this.renderTargetsEnabled){for(n.Tools.StartPerformanceCounter("Render targets",this._renderTargets.length>0),s=0;s<this._renderTargets.length;s++)f=this._renderTargets.data[s],f._shouldRender()&&(this._renderId++,w=f.activeCamera&&f.activeCamera!==this.activeCamera,f.render(w,this.dumpNextRenderTargets));n.Tools.EndPerformanceCounter("Render targets",this._renderTargets.length>0);this._renderId++}if(this._renderTargets.length>0&&r.restoreDefaultFramebuffer(),this._renderTargetsDuration+=n.Tools.Now-p,this.postProcessManager._prepareFrame(),b=n.Tools.Now,this.layers.length){for(r.setDepthBuffer(!1),i=0;i<this.layers.length;i++)u=this.layers[i],u.isBackground&&u.render();r.setDepthBuffer(!0)}for(n.Tools.StartPerformanceCounter("Main render"),this._renderingManager.render(null,null,!0,!0),n.Tools.EndPerformanceCounter("Main render"),this._boundingBoxRenderer.render(),h=0;h<this._edgesRenderers.length;h++)this._edgesRenderers.data[h].render();if(this.lensFlaresEnabled){for(n.Tools.StartPerformanceCounter("Lens flares",this.lensFlareSystems.length>0),c=0;c<this.lensFlareSystems.length;c++)a=this.lensFlareSystems[c],0!=(t.layerMask&a.layerMask)&&a.render();n.Tools.EndPerformanceCounter("Lens flares",this.lensFlareSystems.length>0)}if(this.layers.length){for(r.setDepthBuffer(!1),i=0;i<this.layers.length;i++)u=this.layers[i],u.isBackground||u.render();r.setDepthBuffer(!0)}this._renderDuration+=n.Tools.Now-b;this.postProcessManager._finalizeFrame(t.isIntermediate);this.activeCamera._updateFromScene();this._renderTargets.reset();this.afterCameraRender&&this.afterCameraRender(this.activeCamera);n.Tools.EndPerformanceCounter("Rendering camera "+this.activeCamera.name)},t.prototype._processSubCameras=function(t){if(t.cameraRigMode===n.Camera.RIG_MODE_NONE)return void this._renderForCamera(t);for(var i=0;i<t._rigCameras.length;i++)this._renderForCamera(t._rigCameras[i]);this.activeCamera=t;this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix());this.activeCamera._updateFromScene()},t.prototype._checkIntersections=function(){for(var t,f,i,u=0;u<this._meshesForIntersections.length;u++)for(t=this._meshesForIntersections.data[u],f=0;f<t.actionManager.actions.length;f++)if(i=t.actionManager.actions[f],i.trigger===n.ActionManager.OnIntersectionEnterTrigger||i.trigger===n.ActionManager.OnIntersectionExitTrigger){var e=i.getTriggerParameter(),r=e instanceof n.AbstractMesh?e:e.mesh,s=r.intersectsMesh(t,e.usePreciseIntersection),o=t._intersectionsInProgress.indexOf(r);s&&-1===o?i.trigger===n.ActionManager.OnIntersectionEnterTrigger?(i._executeCurrent(n.ActionEvent.CreateNew(t,null,r)),t._intersectionsInProgress.push(r)):i.trigger===n.ActionManager.OnIntersectionExitTrigger&&t._intersectionsInProgress.push(r):!s&&o>-1&&(i.trigger===n.ActionManager.OnIntersectionExitTrigger&&i._executeCurrent(n.ActionEvent.CreateNew(t,null,r)),t.actionManager.hasSpecificTrigger(n.ActionManager.OnIntersectionExitTrigger)&&i.trigger!==n.ActionManager.OnIntersectionExitTrigger||t._intersectionsInProgress.splice(o,1))}},t.prototype.render=function(){var w=n.Tools.Now,i,c,f,e,o,l,s,a,r,p,h,u;for(this._particlesDuration=0,this._spritesDuration=0,this._activeParticles=0,this._renderDuration=0,this._renderTargetsDuration=0,this._evaluateActiveMeshesDuration=0,this._totalVertices=0,this._activeIndices=0,this._activeBones=0,this.getEngine().resetDrawCalls(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),n.Tools.StartPerformanceCounter("Scene rendering"),this.actionManager&&this.actionManager.processTrigger(n.ActionManager.OnEveryFrameTrigger,null),this.simplificationQueue.running||this.simplificationQueue.executeNext(),this.beforeRender&&this.beforeRender(),i=0;i<this._onBeforeRenderCallbacks.length;i++)this._onBeforeRenderCallbacks[i]();c=Math.max(t.MinDeltaTime,Math.min(this._engine.getDeltaTime(),t.MaxDeltaTime));this._animationRatio=.06*c;this._animate();this._physicsEngine&&(n.Tools.StartPerformanceCounter("Physics"),this._physicsEngine._runOneStep(c/1e3),n.Tools.EndPerformanceCounter("Physics"));var b=n.Tools.Now,v=this.getEngine(),y=this.activeCamera;if(this.renderTargetsEnabled){for(n.Tools.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),f=0;f<this.customRenderTargets.length;f++)if(e=this.customRenderTargets[f],e._shouldRender()){if(this._renderId++,this.activeCamera=e.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");v.setViewport(this.activeCamera.viewport);this.updateTransformMatrix();e.render(y!==this.activeCamera,this.dumpNextRenderTargets)}n.Tools.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0);this._renderId++}if(this.customRenderTargets.length>0&&v.restoreDefaultFramebuffer(),this._renderTargetsDuration+=n.Tools.Now-b,this.activeCamera=y,this.proceduralTexturesEnabled){for(n.Tools.StartPerformanceCounter("Procedural textures",this._proceduralTextures.length>0),o=0;o<this._proceduralTextures.length;o++)l=this._proceduralTextures[o],l._shouldRender()&&l.render();n.Tools.EndPerformanceCounter("Procedural textures",this._proceduralTextures.length>0)}if(this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,!0),this.shadowsEnabled)for(s=0;s<this.lights.length;s++)a=this.lights[s],r=a.getShadowGenerator(),a.isEnabled()&&r&&-1!==r.getShadowMap().getScene().textures.indexOf(r.getShadowMap())&&this._renderTargets.push(r.getShadowMap());if(this._depthRenderer&&this._renderTargets.push(this._depthRenderer.getDepthMap()),this.postProcessRenderPipelineManager.update(),this.activeCameras.length>0)for(p=this._renderId,h=0;h<this.activeCameras.length;h++)this._renderId=p,this._processSubCameras(this.activeCameras[h]);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera)}for(this._checkIntersections(),this._updateAudioParameters(),this.afterRender&&this.afterRender(),i=0;i<this._onAfterRenderCallbacks.length;i++)this._onAfterRenderCallbacks[i]();for(u=0;u<this._toBeDisposed.length;u++)this._toBeDisposed.data[u].dispose(),this._toBeDisposed[u]=null;this._toBeDisposed.reset();this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1);n.Tools.EndPerformanceCounter("Scene rendering");this._lastFrameDuration=n.Tools.Now-w},t.prototype._updateAudioParameters=function(){var i,f,o,u,t,r,e;if(this.audioEnabled&&(0!==this.mainSoundTrack.soundCollection.length||0!==this.soundTracks.length)&&(f=n.Engine.audioEngine,i=this.activeCameras.length>0?this.activeCameras[0]:this.activeCamera,i&&f.canUseWebAudio)){for(f.audioContext.listener.setPosition(i.position.x,i.position.y,i.position.z),o=n.Matrix.Invert(i.getViewMatrix()),u=n.Vector3.TransformNormal(new n.Vector3(0,0,-1),o),u.normalize(),f.audioContext.listener.setOrientation(u.x,u.y,u.z,0,1,0),t=0;t<this.mainSoundTrack.soundCollection.length;t++)r=this.mainSoundTrack.soundCollection[t],r.useCustomAttenuation&&r.updateDistanceFromListener();for(t=0;t<this.soundTracks.length;t++)for(e=0;e<this.soundTracks[t].soundCollection.length;e++)r=this.soundTracks[t].soundCollection[e],r.useCustomAttenuation&&r.updateDistanceFromListener()}},Object.defineProperty(t.prototype,"audioEnabled",{get:function(){return this._audioEnabled},set:function(n){this._audioEnabled=n;this._audioEnabled?this._enableAudio():this._disableAudio()},enumerable:!0,configurable:!0}),t.prototype._disableAudio=function(){for(var t,n=0;n<this.mainSoundTrack.soundCollection.length;n++)this.mainSoundTrack.soundCollection[n].pause();for(n=0;n<this.soundTracks.length;n++)for(t=0;t<this.soundTracks[n].soundCollection.length;t++)this.soundTracks[n].soundCollection[t].pause()},t.prototype._enableAudio=function(){for(var t,n=0;n<this.mainSoundTrack.soundCollection.length;n++)this.mainSoundTrack.soundCollection[n].isPaused&&this.mainSoundTrack.soundCollection[n].play();for(n=0;n<this.soundTracks.length;n++)for(t=0;t<this.soundTracks[n].soundCollection.length;t++)this.soundTracks[n].soundCollection[t].isPaused&&this.soundTracks[n].soundCollection[t].play()},Object.defineProperty(t.prototype,"headphone",{get:function(){return this._headphone},set:function(n){this._headphone=n;this._headphone?this._switchAudioModeForHeadphones():this._switchAudioModeForNormalSpeakers()},enumerable:!0,configurable:!0}),t.prototype._switchAudioModeForHeadphones=function(){this.mainSoundTrack.switchPanningModelToHRTF();for(var n=0;n<this.soundTracks.length;n++)this.soundTracks[n].switchPanningModelToHRTF()},t.prototype._switchAudioModeForNormalSpeakers=function(){this.mainSoundTrack.switchPanningModelToEqualPower();for(var n=0;n<this.soundTracks.length;n++)this.soundTracks[n].switchPanningModelToEqualPower()},t.prototype.enableDepthRenderer=function(){return this._depthRenderer?this._depthRenderer:(this._depthRenderer=new n.DepthRenderer(this),this._depthRenderer)},t.prototype.disableDepthRenderer=function(){this._depthRenderer&&(this._depthRenderer.dispose(),this._depthRenderer=null)},t.prototype.dispose=function(){this.beforeRender=null;this.afterRender=null;this.skeletons=[];this._boundingBoxRenderer.dispose();this._depthRenderer&&this._depthRenderer.dispose();this.debugLayer.hide();this.onDispose&&this.onDispose();this._onBeforeRenderCallbacks=[];this._onAfterRenderCallbacks=[];this.detachControl();this.disposeSounds();for(var t=this._engine.getRenderingCanvas(),n=0;n<this.cameras.length;n++)this.cameras[n].detachControl(t);for(;this.lights.length;)this.lights[0].dispose();for(;this.meshes.length;)this.meshes[0].dispose(!0);for(;this.cameras.length;)this.cameras[0].dispose();for(;this.materials.length;)this.materials[0].dispose();for(;this.particleSystems.length;)this.particleSystems[0].dispose();for(;this.spriteManagers.length;)this.spriteManagers[0].dispose();for(;this.layers.length;)this.layers[0].dispose();for(;this.textures.length;)this.textures[0].dispose();this.postProcessManager.dispose();this._physicsEngine&&this.disablePhysicsEngine();n=this._engine.scenes.indexOf(this);n>-1&&this._engine.scenes.splice(n,1);this._engine.wipeCaches()},t.prototype.disposeSounds=function(){this.mainSoundTrack.dispose();for(var n=0;n<this.soundTracks.length;n++)this.soundTracks[n].dispose()},t.prototype.getWorldExtends=function(){for(var t,f,e,i=new n.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new n.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),u=0;u<this.meshes.length;u++)t=this.meshes[u],t.computeWorldMatrix(!0),f=t.getBoundingInfo().boundingBox.minimumWorld,e=t.getBoundingInfo().boundingBox.maximumWorld,n.Tools.CheckExtends(f,i,r),n.Tools.CheckExtends(e,i,r);return{min:i,max:r}},t.prototype.createOrUpdateSelectionOctree=function(t,i){void 0===t&&(t=64);void 0===i&&(i=2);this._selectionOctree||(this._selectionOctree=new n.Octree(n.Octree.CreationFuncForMeshes,t,i));var r=this.getWorldExtends();return this._selectionOctree.update(r.min,r.max,this.meshes),this._selectionOctree},t.prototype.createPickingRay=function(t,i,r,u){var o=this._engine,e,f;if(!u){if(!this.activeCamera)throw new Error("Active camera not set");u=this.activeCamera}return e=u.viewport,f=e.toGlobal(o),t=t/this._engine.getHardwareScalingLevel()-f.x,i=i/this._engine.getHardwareScalingLevel()-(this._engine.getRenderHeight()-f.y-f.height),n.Ray.CreateNew(t,i,f.width,f.height,r?r:n.Matrix.Identity(),u.getViewMatrix(),u.getProjectionMatrix())},t.prototype._internalPick=function(t,i,r){for(var u,f=null,e=0;e<this.meshes.length;e++){if(u=this.meshes[e],i){if(!i(u))continue}else if(!u.isEnabled()||!u.isVisible||!u.isPickable)continue;var s=u.getWorldMatrix(),h=t(s),o=u.intersects(h,r);if(o&&o.hit&&(r||null==f||!(o.distance>=f.distance))&&(f=o,r))break}return f||new n.PickingInfo},t.prototype.pick=function(n,t,i,r,u){var f=this;return this._internalPick(function(i){return f.createPickingRay(n,t,i,u)},i,r)},t.prototype.pickWithRay=function(t,i,r){var u=this;return this._internalPick(function(i){return u._pickWithRayInverseMatrix||(u._pickWithRayInverseMatrix=n.Matrix.Identity()),i.invertToRef(u._pickWithRayInverseMatrix),n.Ray.Transform(t,u._pickWithRayInverseMatrix)},i,r)},t.prototype.setPointerOverMesh=function(t){this._pointerOverMesh!==t&&(this._pointerOverMesh&&this._pointerOverMesh.actionManager&&this._pointerOverMesh.actionManager.processTrigger(n.ActionManager.OnPointerOutTrigger,n.ActionEvent.CreateNew(this._pointerOverMesh)),this._pointerOverMesh=t,this._pointerOverMesh&&this._pointerOverMesh.actionManager&&this._pointerOverMesh.actionManager.processTrigger(n.ActionManager.OnPointerOverTrigger,n.ActionEvent.CreateNew(this._pointerOverMesh)))},t.prototype.getPointerOverMesh=function(){return this._pointerOverMesh},t.prototype.getPhysicsEngine=function(){return this._physicsEngine},t.prototype.enablePhysics=function(t,i){return this._physicsEngine?!0:(this._physicsEngine=new n.PhysicsEngine(i),this._physicsEngine.isSupported()?(this._physicsEngine._initialize(t),!0):(this._physicsEngine=null,!1))},t.prototype.disablePhysicsEngine=function(){this._physicsEngine&&(this._physicsEngine.dispose(),this._physicsEngine=void 0)},t.prototype.isPhysicsEnabled=function(){return void 0!==this._physicsEngine},t.prototype.setGravity=function(n){this._physicsEngine&&this._physicsEngine._setGravity(n)},t.prototype.createCompoundImpostor=function(n,t){var i,r;if(n.parts&&(t=n,n=n.parts),!this._physicsEngine)return null;for(i=0;i<n.length;i++)r=n[i].mesh,r._physicImpostor=n[i].impostor,r._physicsMass=t.mass/n.length,r._physicsFriction=t.friction,r._physicRestitution=t.restitution;return this._physicsEngine._registerMeshesAsCompound(n,t)},t.prototype.deleteCompoundImpostor=function(t){for(var r,i=0;i<t.parts.length;i++)r=t.parts[i].mesh,r._physicImpostor=n.PhysicsEngine.NoImpostor,this._physicsEngine._unregisterMesh(r)},t.prototype.createDefaultCameraOrLight=function(){if(0===this.lights.length&&new n.HemisphericLight("default light",n.Vector3.Up(),this),!this.activeCamera){var i=new n.FreeCamera("default camera",n.Vector3.Zero(),this),t=this.getWorldExtends(),r=t.min.add(t.max.subtract(t.min).scale(.5));i.position=new n.Vector3(r.x,r.y,t.min.z-(t.max.z-t.min.z));i.setTarget(r);this.activeCamera=i}},t.prototype._getByTags=function(t,i,r){var f,e,u;if(void 0===i)return t;f=[];r=r||function(){};for(e in t)u=t[e],n.Tags.MatchesQuery(u,i)&&(f.push(u),r(u));return f},t.prototype.getMeshesByTags=function(n,t){return this._getByTags(this.meshes,n,t)},t.prototype.getCamerasByTags=function(n,t){return this._getByTags(this.cameras,n,t)},t.prototype.getLightsByTags=function(n,t){return this._getByTags(this.lights,n,t)},t.prototype.getMaterialByTags=function(n,t){return this._getByTags(this.materials,n,t).concat(this._getByTags(this.multiMaterials,n,t))},t._FOGMODE_NONE=0,t._FOGMODE_EXP=1,t._FOGMODE_EXP2=2,t._FOGMODE_LINEAR=3,t.MinDeltaTime=1,t.MaxDeltaTime=1e3,t}();n.Scene=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(i,r,u,f,e,o){if(this._engine=i instanceof n.Mesh?i.getScene().getEngine():i,this._updatable=f,this._data=r,e||this.create(),this._kind=u,o)return void(this._strideSize=o);switch(u){case t.PositionKind:this._strideSize=3;break;case t.NormalKind:this._strideSize=3;break;case t.UVKind:case t.UV2Kind:case t.UV3Kind:case t.UV4Kind:case t.UV5Kind:case t.UV6Kind:this._strideSize=2;break;case t.ColorKind:this._strideSize=4;break;case t.MatricesIndicesKind:this._strideSize=4;break;case t.MatricesWeightsKind:this._strideSize=4}}return t.prototype.isUpdatable=function(){return this._updatable},t.prototype.getData=function(){return this._data},t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStrideSize=function(){return this._strideSize},t.prototype.create=function(n){(n||!this._buffer)&&(n=n||this._data,this._buffer||(this._buffer=this._updatable?this._engine.createDynamicVertexBuffer(4*n.length):this._engine.createVertexBuffer(n)),this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,n),this._data=n))},t.prototype.update=function(n){this.create(n)},t.prototype.updateDirectly=function(n,t){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,n,t),this._data=null)},t.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},Object.defineProperty(t,"PositionKind",{get:function(){return t._PositionKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NormalKind",{get:function(){return t._NormalKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UVKind",{get:function(){return t._UVKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV2Kind",{get:function(){return t._UV2Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV3Kind",{get:function(){return t._UV3Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV4Kind",{get:function(){return t._UV4Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV5Kind",{get:function(){return t._UV5Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV6Kind",{get:function(){return t._UV6Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ColorKind",{get:function(){return t._ColorKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesIndicesKind",{get:function(){return t._MatricesIndicesKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesWeightsKind",{get:function(){return t._MatricesWeightsKind},enumerable:!0,configurable:!0}),t._PositionKind="position",t._NormalKind="normal",t._UVKind="uv",t._UV2Kind="uv2",t._UV3Kind="uv3",t._UV4Kind="uv4",t._UV5Kind="uv5",t._UV6Kind="uv6",t._ColorKind="color",t._MatricesIndicesKind="matricesIndices",t._MatricesWeightsKind="matricesWeights",t}();n.VertexBuffer=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i){t.call(this,n,i.getScene());i.instances.push(this);this._sourceMesh=i;this.position.copyFrom(i.position);this.rotation.copyFrom(i.rotation);this.scaling.copyFrom(i.scaling);i.rotationQuaternion&&(this.rotationQuaternion=i.rotationQuaternion.clone());this.infiniteDistance=i.infiniteDistance;this.setPivotMatrix(i.getPivotMatrix());this.refreshBoundingInfo();this._syncSubMeshes()}return __extends(i,t),Object.defineProperty(i.prototype,"receiveShadows",{get:function(){return this._sourceMesh.receiveShadows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"material",{get:function(){return this._sourceMesh.material},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibility",{get:function(){return this._sourceMesh.visibility},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skeleton",{get:function(){return this._sourceMesh.skeleton},enumerable:!0,configurable:!0}),i.prototype.getTotalVertices=function(){return this._sourceMesh.getTotalVertices()},Object.defineProperty(i.prototype,"sourceMesh",{get:function(){return this._sourceMesh},enumerable:!0,configurable:!0}),i.prototype.getVerticesData=function(n){return this._sourceMesh.getVerticesData(n)},i.prototype.isVerticesDataPresent=function(n){return this._sourceMesh.isVerticesDataPresent(n)},i.prototype.getIndices=function(){return this._sourceMesh.getIndices()},Object.defineProperty(i.prototype,"_positions",{get:function(){return this._sourceMesh._positions},enumerable:!0,configurable:!0}),i.prototype.refreshBoundingInfo=function(){var i=this._sourceMesh.getVerticesData(n.VertexBuffer.PositionKind),t;i&&(t=n.Tools.ExtractMinAndMax(i,0,this._sourceMesh.getTotalVertices()),this._boundingInfo=new n.BoundingInfo(t.minimum,t.maximum));this._updateBoundingInfo()},i.prototype._preActivate=function(){this._currentLOD&&this._currentLOD._preActivate()},i.prototype._activate=function(n){this._currentLOD&&this._currentLOD._registerInstanceForRenderId(this,n)},i.prototype.getLOD=function(){return this._currentLOD=this.sourceMesh.getLOD(this.getScene().activeCamera,this.getBoundingInfo().boundingSphere),this._currentLOD===this.sourceMesh?this:this._currentLOD},i.prototype._syncSubMeshes=function(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(var n=0;n<this._sourceMesh.subMeshes.length;n++)this._sourceMesh.subMeshes[n].clone(this,this._sourceMesh)},i.prototype._generatePointsArray=function(){return this._sourceMesh._generatePointsArray()},i.prototype.clone=function(t,i,r){var u=this._sourceMesh.createInstance(t),f,e;if(n.Tools.DeepCopy(this,u,["name"],[]),this.refreshBoundingInfo(),i&&(u.parent=i),!r)for(f=0;f<this.getScene().meshes.length;f++)e=this.getScene().meshes[f],e.parent===this&&e.clone(e.name,u);return u.computeWorldMatrix(!0),u},i.prototype.dispose=function(n){var i=this._sourceMesh.instances.indexOf(this);this._sourceMesh.instances.splice(i,1);t.prototype.dispose.call(this,n)},i}(n.AbstractMesh);n.InstancedMesh=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(){this.mustReturn=!1;this.visibleInstances=[];this.renderSelf=[]}return n}(),i;n._InstancesBatch=t;i=function(i){function r(u,f,e,o,s){var h,c,l;if(void 0===e&&(e=null),i.call(this,u,f),this.delayLoadState=n.Engine.DELAYLOADSTATE_NONE,this.instances=[],this._LODLevels=[],this._onBeforeRenderCallbacks=[],this._onAfterRenderCallbacks=[],this._visibleInstances={},this._renderIdForInstances=[],this._batchCache=new t,this._instancesBufferSize=2048,this._sideOrientation=r._DEFAULTSIDE,this._areNormalsFrozen=!1,o){if(o._geometry&&o._geometry.applyToMesh(this),n.Tools.DeepCopy(o,this,["name","material","skeleton","instances"],[]),this.id=u+"."+o.id,this.material=o.material,!s)for(h=0;h<f.meshes.length;h++)c=f.meshes[h],c.parent===o&&c.clone(u+"."+c.name,this,s);for(h=0;h<f.particleSystems.length;h++)l=f.particleSystems[h],l.emitter===o&&l.clone(l.name,this);this.computeWorldMatrix(!0)}null!==e&&(this.parent=e)}return __extends(r,i),Object.defineProperty(r,"FRONTSIDE",{get:function(){return r._FRONTSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"BACKSIDE",{get:function(){return r._BACKSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"DOUBLESIDE",{get:function(){return r._DOUBLESIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"DEFAULTSIDE",{get:function(){return r._DEFAULTSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"NO_CAP",{get:function(){return r._NO_CAP},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_START",{get:function(){return r._CAP_START},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_END",{get:function(){return r._CAP_END},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_ALL",{get:function(){return r._CAP_ALL},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasLODLevels",{get:function(){return this._LODLevels.length>0},enumerable:!0,configurable:!0}),r.prototype._sortLODLevels=function(){this._LODLevels.sort(function(n,t){return n.distance<t.distance?1:n.distance>t.distance?-1:0})},r.prototype.addLODLevel=function(t,i){if(i&&i._masterMesh)return n.Tools.Warn("You cannot use a mesh as LOD level twice"),this;var r=new n.Internals.MeshLODLevel(t,i);return this._LODLevels.push(r),i&&(i._masterMesh=this),this._sortLODLevels(),this},r.prototype.getLODLevelAtDistance=function(n){for(var i,t=0;t<this._LODLevels.length;t++)if(i=this._LODLevels[t],i.distance===n)return i.mesh;return null},r.prototype.removeLODLevel=function(n){for(var t=0;t<this._LODLevels.length;t++)this._LODLevels[t].mesh===n&&(this._LODLevels.splice(t,1),n&&(n._masterMesh=null));return this._sortLODLevels(),this},r.prototype.getLOD=function(n,t){var r,u,i;if(!this._LODLevels||0===this._LODLevels.length)return this;if(r=(t?t:this.getBoundingInfo().boundingSphere).centerWorld.subtract(n.position).length(),this._LODLevels[this._LODLevels.length-1].distance>r)return this.onLODLevelSelection&&this.onLODLevelSelection(r,this,this._LODLevels[this._LODLevels.length-1].mesh),this;for(u=0;u<this._LODLevels.length;u++)if(i=this._LODLevels[u],i.distance<r)return i.mesh&&(i.mesh._preActivate(),i.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)),this.onLODLevelSelection&&this.onLODLevelSelection(r,this,i.mesh),i.mesh;return this.onLODLevelSelection&&this.onLODLevelSelection(r,this,this),this},Object.defineProperty(r.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),r.prototype.getTotalVertices=function(){return this._geometry?this._geometry.getTotalVertices():0},r.prototype.getVerticesData=function(n,t){return this._geometry?this._geometry.getVerticesData(n,t):null},r.prototype.getVertexBuffer=function(n){if(this._geometry)return this._geometry.getVertexBuffer(n)},r.prototype.isVerticesDataPresent=function(n){return this._geometry?this._geometry.isVerticesDataPresent(n):this._delayInfo?-1!==this._delayInfo.indexOf(n):!1},r.prototype.getVerticesDataKinds=function(){var n,t;if(!this._geometry){if(n=[],this._delayInfo)for(t in this._delayInfo)n.push(t);return n}return this._geometry.getVerticesDataKinds()},r.prototype.getTotalIndices=function(){return this._geometry?this._geometry.getTotalIndices():0},r.prototype.getIndices=function(n){return this._geometry?this._geometry.getIndices(n):[]},Object.defineProperty(r.prototype,"isBlocked",{get:function(){return null!==this._masterMesh&&void 0!==this._masterMesh},enumerable:!0,configurable:!0}),r.prototype.isReady=function(){return this.delayLoadState===n.Engine.DELAYLOADSTATE_LOADING?!1:i.prototype.isReady.call(this)},r.prototype.isDisposed=function(){return this._isDisposed},Object.defineProperty(r.prototype,"sideOrientation",{get:function(){return this._sideOrientation},set:function(n){this._sideOrientation=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"areNormalsFrozen",{get:function(){return this._areNormalsFrozen},enumerable:!0,configurable:!0}),r.prototype.freezeNormals=function(){this._areNormalsFrozen=!0},r.prototype.unfreezeNormals=function(){this._areNormalsFrozen=!1},r.prototype._preActivate=function(){var n=this.getScene().getRenderId();this._preActivateId!==n&&(this._preActivateId=n,this._visibleInstances=null)},r.prototype._registerInstanceForRenderId=function(n,t){this._visibleInstances||(this._visibleInstances={},this._visibleInstances.defaultRenderId=t,this._visibleInstances.selfDefaultRenderId=this._renderId);this._visibleInstances[t]||(this._visibleInstances[t]=[]);this._visibleInstances[t].push(n)},r.prototype.refreshBoundingInfo=function(){var r=this.getVerticesData(n.VertexBuffer.PositionKind),i,t;if(r&&(i=n.Tools.ExtractMinAndMax(r,0,this.getTotalVertices()),this._boundingInfo=new n.BoundingInfo(i.minimum,i.maximum)),this.subMeshes)for(t=0;t<this.subMeshes.length;t++)this.subMeshes[t].refreshBoundingInfo();this._updateBoundingInfo()},r.prototype._createGlobalSubMesh=function(){var t=this.getTotalVertices();return t&&this.getIndices()?(this.releaseSubMeshes(),new n.SubMesh(0,0,t,0,this.getTotalIndices(),this)):null},r.prototype.subdivide=function(t){var f;if(!(1>t)){for(var u=this.getTotalIndices(),i=u/t|0,r=0;i%3!=0;)i++;for(this.releaseSubMeshes(),f=0;t>f&&!(r>=u);f++)n.SubMesh.CreateFromIndices(0,r,Math.min(i,u-r),this),r+=i;this.synchronizeInstances()}},r.prototype.setVerticesData=function(t,i,r,u){var e,f,o;t instanceof Array&&(e=i,i=t,t=e,n.Tools.Warn("Deprecated usage of setVerticesData detected (since v1.12). Current signature is setVerticesData(kind, data, updatable)."));this._geometry?this._geometry.setVerticesData(t,i,r,u):(f=new n.VertexData,f.set(i,t),o=this.getScene(),new n.Geometry(n.Geometry.RandomId(),o,f,r,this))},r.prototype.updateVerticesData=function(n,t,i,r){this._geometry&&(r?(this.makeGeometryUnique(),this.updateVerticesData(n,t,i,!1)):this._geometry.updateVerticesData(n,t,i))},r.prototype.updateVerticesDataDirectly=function(n,t,i,r){this._geometry&&(r?(this.makeGeometryUnique(),this.updateVerticesDataDirectly(n,t,i,!1)):this._geometry.updateVerticesDataDirectly(n,t,i))},r.prototype.updateMeshPositions=function(t,i){var r,f,u;void 0===i&&(i=!0);r=this.getVerticesData(n.VertexBuffer.PositionKind);(t(r),this.updateVerticesData(n.VertexBuffer.PositionKind,r,!1,!1),i)&&(f=this.getIndices(),u=this.getVerticesData(n.VertexBuffer.NormalKind),n.VertexData.ComputeNormals(r,f,u),this.updateVerticesData(n.VertexBuffer.NormalKind,u,!1,!1))},r.prototype.makeGeometryUnique=function(){if(this._geometry){var t=this._geometry.copy(n.Geometry.RandomId());t.applyToMesh(this)}},r.prototype.setIndices=function(t,i){var r,u;this._geometry?this._geometry.setIndices(t,i):(r=new n.VertexData,r.indices=t,u=this.getScene(),new n.Geometry(n.Geometry.RandomId(),u,r,!1,this))},r.prototype._bind=function(t,i,r){var u,f=this.getScene().getEngine();switch(r){case n.Material.PointFillMode:u=null;break;case n.Material.WireFrameFillMode:u=t.getLinesIndexBuffer(this.getIndices(),f);break;default:case n.Material.TriangleFillMode:u=this._geometry.getIndexBuffer()}f.bindMultiBuffers(this._geometry.getVertexBuffers(),u,i)},r.prototype._draw=function(t,i,r){if(this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){var u=this.getScene().getEngine();switch(i){case n.Material.PointFillMode:u.drawPointClouds(t.verticesStart,t.verticesCount,r);break;case n.Material.WireFrameFillMode:u.draw(!1,0,t.linesIndexCount,r);break;default:u.draw(!0,t.indexStart,t.indexCount,r)}}},r.prototype.registerBeforeRender=function(n){this._onBeforeRenderCallbacks.push(n)},r.prototype.unregisterBeforeRender=function(n){var t=this._onBeforeRenderCallbacks.indexOf(n);t>-1&&this._onBeforeRenderCallbacks.splice(t,1)},r.prototype.registerAfterRender=function(n){this._onAfterRenderCallbacks.push(n)},r.prototype.unregisterAfterRender=function(n){var t=this._onAfterRenderCallbacks.indexOf(n);t>-1&&this._onAfterRenderCallbacks.splice(t,1)},r.prototype._getInstancesRenderList=function(n){var r=this.getScene(),t,i;if(this._batchCache.mustReturn=!1,this._batchCache.renderSelf[n]=this.isEnabled()&&this.isVisible,this._batchCache.visibleInstances[n]=null,this._visibleInstances){if(t=r.getRenderId(),this._batchCache.visibleInstances[n]=this._visibleInstances[t],i=this._renderId,!this._batchCache.visibleInstances[n]&&this._visibleInstances.defaultRenderId&&(this._batchCache.visibleInstances[n]=this._visibleInstances[this._visibleInstances.defaultRenderId],t=Math.max(this._visibleInstances.defaultRenderId,t),i=Math.max(this._visibleInstances.selfDefaultRenderId,t)),this._batchCache.visibleInstances[n]&&this._batchCache.visibleInstances[n].length){if(this._renderIdForInstances[n]===t)return this._batchCache.mustReturn=!0,this._batchCache;t!==i&&(this._batchCache.renderSelf[n]=!1)}this._renderIdForInstances[n]=t}return this._batchCache},r.prototype._renderWithInstances=function(n,t,i,r,u){for(var o,h,f=i.visibleInstances[n._id],l=f.length+1,a=64*l;this._instancesBufferSize<a;)this._instancesBufferSize*=2;(!this._worldMatricesInstancesBuffer||this._worldMatricesInstancesBuffer.capacity<this._instancesBufferSize)&&(this._worldMatricesInstancesBuffer&&u.deleteInstancesBuffer(this._worldMatricesInstancesBuffer),this._worldMatricesInstancesBuffer=u.createInstancesBuffer(this._instancesBufferSize),this._worldMatricesInstancesArray=new Float32Array(this._instancesBufferSize/4));var e=0,s=0,v=this.getWorldMatrix();if(i.renderSelf[n._id]&&(v.copyToArray(this._worldMatricesInstancesArray,e),e+=16,s++),f)for(o=0;o<f.length;o++)h=f[o],h.getWorldMatrix().copyToArray(this._worldMatricesInstancesArray,e),e+=16,s++;var y=r.getAttributeLocationByName("world0"),p=r.getAttributeLocationByName("world1"),w=r.getAttributeLocationByName("world2"),b=r.getAttributeLocationByName("world3"),c=[y,p,w,b];u.updateAndBindInstancesBuffer(this._worldMatricesInstancesBuffer,this._worldMatricesInstancesArray,c);this._draw(n,t,s);u.unBindInstancesBuffer(this._worldMatricesInstancesBuffer,c)},r.prototype._processRendering=function(n,t,i,r,u,f){var h=this.getScene(),c=h.getEngine(),e,o,s;if(u)this._renderWithInstances(n,i,r,t,c);else if(r.renderSelf[n._id]&&(f&&f(!1,this.getWorldMatrix()),this._draw(n,i)),r.visibleInstances[n._id])for(e=0;e<r.visibleInstances[n._id].length;e++)o=r.visibleInstances[n._id][e],s=o.getWorldMatrix(),f&&f(!0,s),this._draw(n,i)},r.prototype.render=function(t,i){var o=this.getScene(),e=this._getInstancesRenderList(t._id),f,s,h,c,a,v;if(!e.mustReturn&&this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){for(f=0;f<this._onBeforeRenderCallbacks.length;f++)this._onBeforeRenderCallbacks[f](this);var r=o.getEngine(),l=null!==r.getCaps().instancedArrays&&null!==e.visibleInstances[t._id]&&void 0!==e.visibleInstances[t._id],u=t.getMaterial();if(u&&u.isReady(this,l))for(s=r.getDepthWrite(),this.renderOutline&&(r.setDepthWrite(!1),o.getOutlineRenderer().render(t,e),r.setDepthWrite(s)),u._preBind(),h=u.getEffect(),c=o.forcePointsCloud?n.Material.PointFillMode:o.forceWireframe?n.Material.WireFrameFillMode:u.fillMode,this._bind(t,h,c),a=this.getWorldMatrix(),(u.bind(a,this),i&&r.setAlphaMode(u.alphaMode),this._processRendering(t,h,c,e,l,function(n,t){n&&u.bindOnlyWorldMatrix(t)}),u.unbind(),this.renderOutline&&s&&(r.setDepthWrite(!0),r.setColorWrite(!1),o.getOutlineRenderer().render(t,e),r.setColorWrite(!0)),this.renderOverlay)&&(v=r.getAlphaMode(),r.setAlphaMode(n.Engine.ALPHA_COMBINE),o.getOutlineRenderer().render(t,e,!0),r.setAlphaMode(v)),f=0;f<this._onAfterRenderCallbacks.length;f++)this._onAfterRenderCallbacks[f](this)}},r.prototype.getEmittedParticleSystems=function(){for(var i,t=[],n=0;n<this.getScene().particleSystems.length;n++)i=this.getScene().particleSystems[n],i.emitter===this&&t.push(i);return t},r.prototype.getHierarchyEmittedParticleSystems=function(){var i=[],r=this.getDescendants(),n,t;for(r.push(this),n=0;n<this.getScene().particleSystems.length;n++)t=this.getScene().particleSystems[n],-1!==r.indexOf(t.emitter)&&i.push(t);return i},r.prototype.getChildren=function(){for(var i,t=[],n=0;n<this.getScene().meshes.length;n++)i=this.getScene().meshes[n],i.parent===this&&t.push(i);return t},r.prototype._checkDelayState=function(){var t=this,r=this,i=this.getScene(),u;this._geometry?this._geometry.load(i):r.delayLoadState===n.Engine.DELAYLOADSTATE_NOTLOADED&&(r.delayLoadState=n.Engine.DELAYLOADSTATE_LOADING,i._addPendingData(r),u=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata"),n.Tools.LoadFile(this.delayLoadingFile,function(r){r instanceof ArrayBuffer?t._delayLoadingFunction(r,t):t._delayLoadingFunction(JSON.parse(r),t);t.delayLoadState=n.Engine.DELAYLOADSTATE_LOADED;i._removePendingData(t)},function(){},i.database,u))},r.prototype.isInFrustum=function(t){return this.delayLoadState===n.Engine.DELAYLOADSTATE_LOADING?!1:i.prototype.isInFrustum.call(this,t)?(this._checkDelayState(),!0):!1},r.prototype.setMaterialByID=function(n){for(var r=this.getScene().materials,i,t=0;t<r.length;t++)if(r[t].id===n)return void(this.material=r[t]);for(i=this.getScene().multiMaterials,t=0;t<i.length;t++)if(i[t].id===n)return void(this.material=i[t])},r.prototype.getAnimatables=function(){var n=[];return this.material&&n.push(this.material),this.skeleton&&n.push(this.skeleton),n},r.prototype.bakeTransformIntoVertices=function(t){if(this.isVerticesDataPresent(n.VertexBuffer.PositionKind)){this._resetPointsArrayCache();for(var r=this.getVerticesData(n.VertexBuffer.PositionKind),u=[],i=0;i<r.length;i+=3)n.Vector3.TransformCoordinates(n.Vector3.FromArray(r,i),t).toArray(u,i);if(this.setVerticesData(n.VertexBuffer.PositionKind,u,this.getVertexBuffer(n.VertexBuffer.PositionKind).isUpdatable()),this.isVerticesDataPresent(n.VertexBuffer.NormalKind)){for(r=this.getVerticesData(n.VertexBuffer.NormalKind),u=[],i=0;i<r.length;i+=3)n.Vector3.TransformNormal(n.Vector3.FromArray(r,i),t).normalize().toArray(u,i);this.setVerticesData(n.VertexBuffer.NormalKind,u,this.getVertexBuffer(n.VertexBuffer.NormalKind).isUpdatable());t.m[0]*t.m[5]*t.m[10]<0&&this.flipFaces()}}},r.prototype.bakeCurrentTransformIntoVertices=function(){this.bakeTransformIntoVertices(this.computeWorldMatrix(!0));this.scaling.copyFromFloats(1,1,1);this.position.copyFromFloats(0,0,0);this.rotation.copyFromFloats(0,0,0);this.rotationQuaternion&&(this.rotationQuaternion=n.Quaternion.Identity());this._worldMatrix=n.Matrix.Identity()},r.prototype._resetPointsArrayCache=function(){this._positions=null},r.prototype._generatePointsArray=function(){var t,i;if(this._positions)return!0;if(this._positions=[],t=this.getVerticesData(n.VertexBuffer.PositionKind),!t)return!1;for(i=0;i<t.length;i+=3)this._positions.push(n.Vector3.FromArray(t,i));return!0},r.prototype.clone=function(n,t,i){return new r(n,this.getScene(),t,this,i)},r.prototype.dispose=function(n){for(this._geometry&&this._geometry.releaseForMesh(this,!0),this._worldMatricesInstancesBuffer&&(this.getEngine().deleteInstancesBuffer(this._worldMatricesInstancesBuffer),this._worldMatricesInstancesBuffer=null);this.instances.length;)this.instances[0].dispose();i.prototype.dispose.call(this,n)},r.prototype.applyDisplacementMap=function(t,i,r,u){var f=this,e=this.getScene(),o=function(n){var t=document.createElement("canvas"),s=t.getContext("2d"),e=n.width,o=n.height,h;t.width=e;t.height=o;s.drawImage(n,0,0);h=s.getImageData(0,0,e,o).data;f.applyDisplacementMapFromBuffer(h,e,o,i,r);u&&u(f)};n.Tools.LoadImage(t,o,function(){},e.database)},r.prototype.applyDisplacementMapFromBuffer=function(t,i,r,u,f){if(!this.isVerticesDataPresent(n.VertexBuffer.PositionKind)||!this.isVerticesDataPresent(n.VertexBuffer.NormalKind)||!this.isVerticesDataPresent(n.VertexBuffer.UVKind))return void n.Tools.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing");for(var o=this.getVerticesData(n.VertexBuffer.PositionKind),c=this.getVerticesData(n.VertexBuffer.NormalKind),v=this.getVerticesData(n.VertexBuffer.UVKind),s=n.Vector3.Zero(),h=n.Vector3.Zero(),l=n.Vector2.Zero(),e=0;e<o.length;e+=3){n.Vector3.FromArrayToRef(o,e,s);n.Vector3.FromArrayToRef(c,e,h);n.Vector2.FromArrayToRef(v,e/3*2,l);var y=Math.abs(l.x)*i%i|0,p=Math.abs(l.y)*r%r|0,a=4*(y+p*i),w=t[a]/255,b=t[a+1]/255,k=t[a+2]/255,d=.3*w+.59*b+.11*k;h.normalize();h.scaleInPlace(u+(f-u)*d);s=s.add(h);s.toArray(o,e)}n.VertexData.ComputeNormals(o,this.getIndices(),c);this.updateVerticesData(n.VertexBuffer.PositionKind,o);this.updateVerticesData(n.VertexBuffer.NormalKind,c)},r.prototype.convertToFlatShadedMesh=function(){for(var i,u=this.getVerticesDataKinds(),s=[],w=[],h=[],b=!1,v,g,y,c,o,l,a,f,r=0;r<u.length;r++)i=u[r],v=this.getVertexBuffer(i),i!==n.VertexBuffer.NormalKind?(s[i]=v,w[i]=s[i].getData(),h[i]=[]):(b=v.isUpdatable(),u.splice(r,1),r--);for(var k=this.subMeshes.slice(0),e=this.getIndices(),d=this.getTotalIndices(),t=0;d>t;t++)for(g=e[t],r=0;r<u.length;r++)for(i=u[r],y=s[i].getStrideSize(),c=0;y>c;c++)h[i].push(w[i][g*y+c]);for(o=[],l=h[n.VertexBuffer.PositionKind],t=0;d>t;t+=3){e[t]=t;e[t+1]=t+1;e[t+2]=t+2;for(var it=n.Vector3.FromArray(l,3*t),nt=n.Vector3.FromArray(l,3*(t+1)),rt=n.Vector3.FromArray(l,3*(t+2)),ut=it.subtract(nt),ft=rt.subtract(nt),p=n.Vector3.Normalize(n.Vector3.Cross(ut,ft)),tt=0;3>tt;tt++)o.push(p.x),o.push(p.y),o.push(p.z)}for(this.setIndices(e),this.setVerticesData(n.VertexBuffer.NormalKind,o,b),r=0;r<u.length;r++)i=u[r],this.setVerticesData(i,h[i],s[i].isUpdatable());for(this.releaseSubMeshes(),a=0;a<k.length;a++)f=k[a],new n.SubMesh(f.materialIndex,f.indexStart,f.indexCount,f.indexStart,f.indexCount,this);this.synchronizeInstances()},r.prototype.flipFaces=function(t){var i,r,u;if(void 0===t&&(t=!1),r=n.VertexData.ExtractFromMesh(this),t&&this.isVerticesDataPresent(n.VertexBuffer.NormalKind))for(i=0;i<r.normals.length;i++)r.normals[i]*=-1;for(i=0;i<r.indices.length;i+=3)u=r.indices[i+1],r.indices[i+1]=r.indices[i+2],r.indices[i+2]=u;r.applyToMesh(this)},r.prototype.createInstance=function(t){return new n.InstancedMesh(t,this)},r.prototype.synchronizeInstances=function(){for(var t,n=0;n<this.instances.length;n++)t=this.instances[n],t._syncSubMeshes()},r.prototype.simplify=function(t,i,r,u){void 0===i&&(i=!0);void 0===r&&(r=n.SimplificationType.QUADRATIC);this.getScene().simplificationQueue.addTask({settings:t,parallelProcessing:i,mesh:this,simplificationType:r,successCallback:u})},r.prototype.optimizeIndices=function(t){for(var e,u=this,i=this.getIndices(),o=this.getVerticesData(n.VertexBuffer.PositionKind),r=[],f=0;f<o.length;f+=3)r.push(n.Vector3.FromArray(o,f));e=[];n.AsyncLoop.SyncAsyncForLoop(r.length,40,function(n){for(var u,i=r.length-1-n,f=r[i],t=0;i>t;++t)if(u=r[t],f.equals(u)){e[i]=t;break}},function(){for(var r,n=0;n<i.length;++n)i[n]=e[i[n]]||i[n];r=u.subMeshes.slice(0);u.setIndices(i);u.subMeshes=r;t&&t(u)})},r.CreateRibbon=function(t,i,u,f,e,o,s,h,c){var k,w,d,l,y,b;if(void 0===h&&(h=r.DEFAULTSIDE),void 0===c&&(c=null),c){if(k=function(n){for(var o,u,s,f,e=i[0].length,t=0,l=c.sideOrientation===r.DOUBLESIDE?2:1,h=1;l>=h;h++)for(o=0;o<i.length;o++){for(u=i[o],s=u.length,e=s>e?e:s,f=0;e>f;)n[t]=u[f].x,n[t+1]=u[f].y,n[t+2]=u[f].z,f++,t+=3;c._closePath&&(n[t]=u[0].x,n[t+1]=u[0].y,n[t+2]=u[0].z,t+=3)}},w=c.getVerticesData(n.VertexBuffer.PositionKind),k(w),c.updateVerticesData(n.VertexBuffer.PositionKind,w,!1,!1),!c.areNormalsFrozen){if(d=c.getIndices(),l=c.getVerticesData(n.VertexBuffer.NormalKind),n.VertexData.ComputeNormals(w,d,l),c._closePath)for(var a=0,v=0,p=0;p<i.length;p++)a=3*c._idx[p],v=p+1<i.length?3*(c._idx[p+1]-1):l.length-3,l[a]=.5*(l[a]+l[v]),l[a+1]=.5*(l[a+1]+l[v+1]),l[a+2]=.5*(l[a+2]+l[v+2]),l[v]=l[a],l[v+1]=l[a+1],l[v+2]=l[a+2];c.updateVerticesData(n.VertexBuffer.NormalKind,l,!1,!1)}return c}return y=new r(t,o),y.sideOrientation=h,b=n.VertexData.CreateRibbon(i,u,f,e,h),f&&(y._idx=b._idx),y._closePath=f,b.applyToMesh(y,s),y},r.CreateDisc=function(t,i,u,f,e,o){void 0===o&&(o=r.DEFAULTSIDE);var s=new r(t,f),h=n.VertexData.CreateDisc(i,u,o);return h.applyToMesh(s,e),s},r.CreateBox=function(t,i,u,f,e){void 0===e&&(e=r.DEFAULTSIDE);f=f||i.updatable;var o=new r(t,u),s=n.VertexData.CreateBox(i,e);return s.applyToMesh(o,f),o},r.CreateSphere=function(t,i,u,f,e,o){var h,s,c;return(void 0===o&&(o=r.DEFAULTSIDE),u instanceof n.Scene)?(f=u,e=i.updatable):(h=i,i={segments:h,diameterX:u,diameterY:u,diameterZ:u,sideOrientation:o}),s=new r(t,f),c=n.VertexData.CreateSphere(i),c.applyToMesh(s,e),s},r.CreateCylinder=function(t,i,u,f,e,o,s,h,c){void 0===c&&(c=r.DEFAULTSIDE);void 0!==s&&s instanceof n.Scene||(void 0!==s&&(h=s),s=o,o=1);var l=new r(t,s),a=n.VertexData.CreateCylinder(i,u,f,e,o,c);return a.applyToMesh(l,h),l},r.CreateTorus=function(t,i,u,f,e,o,s){void 0===s&&(s=r.DEFAULTSIDE);var h=new r(t,e),c=n.VertexData.CreateTorus(i,u,f,s);return c.applyToMesh(h,o),h},r.CreateTorusKnot=function(t,i,u,f,e,o,s,h,c,l){void 0===l&&(l=r.DEFAULTSIDE);var a=new r(t,h),v=n.VertexData.CreateTorusKnot(i,u,f,e,o,s,l);return v.applyToMesh(a,c),a},r.CreateLines=function(t,i,r,u,f){var o,e,s;return(void 0===f&&(f=null),f)?(o=function(n){for(var r=0,t=0;t<i.length;t++)n[r]=i[t].x,n[r+1]=i[t].y,n[r+2]=i[t].z,r+=3},f.updateMeshPositions(o,!1),f):(e=new n.LinesMesh(t,r),s=n.VertexData.CreateLines(i),s.applyToMesh(e,u),e)},r.CreateDashedLines=function(t,i,r,u,f,e,o,s){var c,h,l;return(void 0===s&&(s=null),s)?(c=function(t){for(var f=n.Vector3.Zero(),v=t.length/6,l=0,a=0,o=0,h=0,e=0,u=0,r=0,c=0,r=0;r<i.length-1;r++)i[r+1].subtractToRef(i[r],f),l+=f.length();for(o=l/v,h=s.dashSize*o/(s.dashSize+s.gapSize),r=0;r<i.length-1;r++)for(i[r+1].subtractToRef(i[r],f),a=Math.floor(f.length()/o),f.normalize(),c=0;a>c&&u<t.length;)e=o*c,t[u]=i[r].x+e*f.x,t[u+1]=i[r].y+e*f.y,t[u+2]=i[r].z+e*f.z,t[u+3]=i[r].x+(e+h)*f.x,t[u+4]=i[r].y+(e+h)*f.y,t[u+5]=i[r].z+(e+h)*f.z,u+=6,c++;for(;u<t.length;)t[u]=i[r].x,t[u+1]=i[r].y,t[u+2]=i[r].z,u+=3},s.updateMeshPositions(c,!1),s):(h=new n.LinesMesh(t,e),l=n.VertexData.CreateDashedLines(i,r,u,f),l.applyToMesh(h,o),h.dashSize=r,h.gapSize=u,h)},r.ExtrudeShape=function(n,t,i,u,f,e,o,s,h,c){void 0===h&&(h=r.DEFAULTSIDE);void 0===c&&(c=null);u=u||1;f=f||0;return r._ExtrudeShapeGeneric(n,t,i,u,f,null,null,!1,!1,e,!1,o,s,h,c)},r.ExtrudeShapeCustom=function(n,t,i,u,f,e,o,s,h,c,l,a){void 0===l&&(l=r.DEFAULTSIDE);void 0===a&&(a=null);return r._ExtrudeShapeGeneric(n,t,i,null,null,u,f,e,o,s,!0,h,c,l,a)},r._ExtrudeShapeGeneric=function(t,i,u,f,e,o,s,h,c,l,a,v,y,p,w){var d,b,g=function(t,i,u,f,e,o,s,h,c,l){for(var y,p=u.getTangents(),g=u.getNormals(),nt=u.getBinormals(),w=u.getDistances(),b=0,tt=function(){return e},it=function(){return o},rt=l?h:it,ut=l?s:tt,k=0,a=0;a<i.length;a++){for(var d=[],ft=rt(a,w[a]),et=ut(a,w[a]),v=0;v<t.length;v++){var ot=n.Matrix.RotationAxis(p[a],b),st=p[a].scale(t[v].z).add(g[a].scale(t[v].x)).add(nt[a].scale(t[v].y)),ht=n.Vector3.TransformCoordinates(st,ot).scaleInPlace(et).add(i[a]);d.push(ht)}f[k]=d;b+=ft;k++}y=function(t){for(var u=Array(),r=n.Vector3.Zero(),i=0;i<t.length;i++)r.addInPlace(t[i]);for(r.scaleInPlace(1/t.length),i=0;i<t.length;i++)u.push(r);return u};switch(c){case r.CAP_START:f.unshift(y(f[0]));break;case r.CAP_END:f.push(y(f[f.length-1]));break;case r.CAP_ALL:f.unshift(y(f[0]));f.push(y(f[f.length-1]))}return f},nt,k;return w?(d=w.path3D.update(u),b=g(i,u,w.path3D,w.pathArray,f,e,o,s,w.cap,a),w=r.CreateRibbon(null,b,null,null,null,null,null,null,w)):(d=new n.Path3D(u),nt=[],l=0>l||l>3?0:l,b=g(i,u,d,nt,f,e,o,s,l,a),k=r.CreateRibbon(t,b,h,c,0,v,y,p),k.pathArray=b,k.path3D=d,k.cap=l,k)},r.CreateLathe=function(t,i,u,f,e,o,s){var v,y,l,c;void 0===s&&(s=r.DEFAULTSIDE);u=u||1;f=f||60*u;for(var p=2*Math.PI,a=[],h=0;0===i[h].x;)h++;for(v=i[h],h=0;h<i.length;h++)a.push(i[h].subtract(v));for(l=p/f,c=[],h=0;f>h;h++)y=new n.Vector3(Math.cos(h*l)*u,0,Math.sin(h*l)*u),c.push(y);c.push(c[0]);var w=function(){return 1},b=function(){return 0};return r.ExtrudeShapeCustom(t,a,c,w,b,!0,!1,r.NO_CAP,e,o,s)},r.CreatePlane=function(t,i,u,f,e){void 0===e&&(e=r.DEFAULTSIDE);var o=new r(t,u),s=n.VertexData.CreatePlane(i,e);return s.applyToMesh(o,f||i.updatable),o},r.CreateGround=function(t,i,r,u,f,e){var s,o,h;return r instanceof n.Scene?(f=r,e=i.updatable):(s=i,i={width:s,height:r,subdivisions:u}),o=new n.GroundMesh(t,f),o._setReady(!1),o._subdivisions=i.subdivisions||1,h=n.VertexData.CreateGround(i),h.applyToMesh(o,e||i.updatable),o._setReady(!0),o},r.CreateTiledGround=function(t,i,u,f,e,o,s,h,c){var l=new r(t,h),a=n.VertexData.CreateTiledGround(i,u,f,e,o,s);return a.applyToMesh(l,c),l},r.CreateGroundFromHeightMap=function(t,i,r,u,f,e,o,s,h,c){var l=new n.GroundMesh(t,s),a;return l._subdivisions=f,l._setReady(!1),a=function(t){var i=document.createElement("canvas"),v=i.getContext("2d"),s=t.width,a=t.height,y,p;i.width=s;i.height=a;v.drawImage(t,0,0);y=v.getImageData(0,0,s,a).data;p=n.VertexData.CreateGroundFromHeightMap(r,u,f,e,o,y,s,a);p.applyToMesh(l,h);l._setReady(!0);c&&c(l)},n.Tools.LoadImage(i,a,function(){},s.database),l},r.CreateTube=function(t,i,u,f,e,o,s,h,c,l){var v,y,p,w,a;return(void 0===c&&(c=r.DEFAULTSIDE),void 0===l&&(l=null),p=function(t,i,u,f,e,o,s){for(var l,c,a,v,y,p,w,k=i.getTangents(),d=i.getNormals(),g=i.getDistances(),nt=2*Math.PI,tt=nt/e,it=function(){return f},rt=o||it,b=0,h=0;h<t.length;h++){for(v=rt(h,g[h]),a=Array(),y=d[h],l=0;e>l;l++)w=n.Matrix.RotationAxis(k[h],tt*l),p=n.Vector3.TransformCoordinates(y,w).scaleInPlace(v).add(t[h]),a.push(p);u[b]=a;b++}c=function(n,i){for(var r=Array(),u=0;n>u;u++)r.push(t[i]);return r};switch(s){case r.CAP_START:u.unshift(c(e+1,0));break;case r.CAP_END:u.push(c(e+1,t.length-1));break;case r.CAP_ALL:u.unshift(c(e+1,0));u.push(c(e+1,t.length-1))}return u},l)?(v=l.path3D.update(i),y=p(i,v,l.pathArray,u,l.tessellation,e,l.cap),l=r.CreateRibbon(null,y,null,null,null,null,null,null,l)):(v=new n.Path3D(i),w=[],o=0>o||o>3?0:o,y=p(i,v,w,u,f,e,o),a=r.CreateRibbon(t,y,!1,!0,0,s,h,c),a.pathArray=y,a.path3D=v,a.tessellation=f,a.cap=o,a)},r.CreateDecal=function(t,i,u,f,e,o){var s,p,a,v;void 0===o&&(o=0);var d=i.getIndices(),w=i.getVerticesData(n.VertexBuffer.PositionKind),b=i.getVerticesData(n.VertexBuffer.NormalKind);if(!f){var it=new n.Vector3(0,0,1),g=i.getScene().activeCamera,rt=n.Vector3.TransformCoordinates(it,g.getWorldMatrix());f=g.globalPosition.subtract(rt)}var nt=-Math.atan2(f.z,f.x)-Math.PI/2,ut=Math.sqrt(f.x*f.x+f.z*f.z),tt=Math.atan2(f.y,ut),ft=n.Matrix.RotationYawPitchRoll(nt,tt,o).multiply(n.Matrix.Translation(u.x,u.y,u.z)),et=n.Matrix.Invert(ft),ot=i.getWorldMatrix(),st=ot.multiply(et),h=new n.VertexData;h.indices=[];h.positions=[];h.normals=[];h.uvs=[];for(var y=0,k=function(t){var i=d[t],r=new n.PositionNormalVertex;return r.position=new n.Vector3(w[3*i],w[3*i+1],w[3*i+2]),r.position=n.Vector3.TransformCoordinates(r.position,st),r.normal=new n.Vector3(b[3*i],b[3*i+1],b[3*i+2]),r},c=function(t,i){if(0===t.length)return t;for(var l=.5*Math.abs(n.Vector3.Dot(e,i)),h=function(t,r){var u=n.Vector3.GetClipFactor(t.position,r.position,i,l);return new n.PositionNormalVertex(n.Vector3.Lerp(t.position,r.position,u),n.Vector3.Lerp(t.normal,r.normal,u))},u=[],r=0;r<t.length;r+=3){var a,v,y,f,o,s,c,p=0,w=n.Vector3.Dot(t[r].position,i)-l,b=n.Vector3.Dot(t[r+1].position,i)-l,k=n.Vector3.Dot(t[r+2].position,i)-l;switch(a=w>0,v=b>0,y=k>0,p=(a?1:0)+(v?1:0)+(y?1:0)){case 0:u.push(t[r]);u.push(t[r+1]);u.push(t[r+2]);break;case 1:if(a&&(f=t[r+1],o=t[r+2],s=h(t[r],f),c=h(t[r],o)),v){f=t[r];o=t[r+2];s=h(t[r+1],f);c=h(t[r+1],o);u.push(s);u.push(o.clone());u.push(f.clone());u.push(o.clone());u.push(s.clone());u.push(c);break}y&&(f=t[r],o=t[r+1],s=h(t[r+2],f),c=h(t[r+2],o));u.push(f.clone());u.push(o.clone());u.push(s);u.push(c);u.push(s.clone());u.push(o.clone());break;case 2:a||(f=t[r].clone(),o=h(f,t[r+1]),s=h(f,t[r+2]),u.push(f),u.push(o),u.push(s));v||(f=t[r+1].clone(),o=h(f,t[r+2]),s=h(f,t[r]),u.push(f),u.push(o),u.push(s));y||(f=t[r+2].clone(),o=h(f,t[r]),s=h(f,t[r+1]),u.push(f),u.push(o),u.push(s))}}return u},l=0;l<d.length;l+=3)if(s=[],s.push(k(l)),s.push(k(l+1)),s.push(k(l+2)),s=c(s,new n.Vector3(1,0,0)),s=c(s,new n.Vector3(-1,0,0)),s=c(s,new n.Vector3(0,1,0)),s=c(s,new n.Vector3(0,-1,0)),s=c(s,new n.Vector3(0,0,1)),s=c(s,new n.Vector3(0,0,-1)),0!==s.length)for(p=0;p<s.length;p++)a=s[p],h.indices.push(y),a.position.toArray(h.positions,3*y),a.normal.toArray(h.normals,3*y),h.uvs.push(.5+a.position.x/e.x),h.uvs.push(.5+a.position.y/e.y),y++;return v=new r(t,i.getScene()),h.applyToMesh(v),v.position=u.clone(),v.rotation=new n.Vector3(tt,nt,o),v},r.prototype.applySkeleton=function(t){var e;if(!this.isVerticesDataPresent(n.VertexBuffer.PositionKind)||!this.isVerticesDataPresent(n.VertexBuffer.NormalKind)||!this.isVerticesDataPresent(n.VertexBuffer.MatricesIndicesKind)||!this.isVerticesDataPresent(n.VertexBuffer.MatricesWeightsKind))return this;this._sourcePositions||(e=this.getVerticesData(n.VertexBuffer.PositionKind),this._sourcePositions=new Float32Array(e),this.getVertexBuffer(n.VertexBuffer.PositionKind).isUpdatable()||this.setVerticesData(n.VertexBuffer.PositionKind,e,!0));this._sourceNormals||(e=this.getVerticesData(n.VertexBuffer.NormalKind),this._sourceNormals=new Float32Array(e),this.getVertexBuffer(n.VertexBuffer.NormalKind).isUpdatable()||this.setVerticesData(n.VertexBuffer.NormalKind,e,!0));for(var l=this.getVerticesData(n.VertexBuffer.PositionKind),a=this.getVerticesData(n.VertexBuffer.NormalKind),o=this.getVerticesData(n.VertexBuffer.MatricesIndicesKind),s=this.getVerticesData(n.VertexBuffer.MatricesWeightsKind),h=t.getTransformMatrices(),c=n.Vector3.Zero(),f=new n.Matrix,r=new n.Matrix,i=0;i<l.length;i+=3){var u=i/3*4,v=s[u],y=s[u+1],p=s[u+2],w=s[u+3];v>0&&(n.Matrix.FromFloat32ArrayToRefScaled(h,16*o[u],v,r),f.addToSelf(r));y>0&&(n.Matrix.FromFloat32ArrayToRefScaled(h,16*o[u+1],y,r),f.addToSelf(r));p>0&&(n.Matrix.FromFloat32ArrayToRefScaled(h,16*o[u+2],p,r),f.addToSelf(r));w>0&&(n.Matrix.FromFloat32ArrayToRefScaled(h,16*o[u+3],w,r),f.addToSelf(r));n.Vector3.TransformCoordinatesFromFloatsToRef(this._sourcePositions[i],this._sourcePositions[i+1],this._sourcePositions[i+2],f,c);c.toArray(l,i);n.Vector3.TransformNormalFromFloatsToRef(this._sourceNormals[i],this._sourceNormals[i+1],this._sourceNormals[i+2],f,c);c.toArray(a,i);f.reset()}return this.updateVerticesData(n.VertexBuffer.PositionKind,l),this.updateVerticesData(n.VertexBuffer.NormalKind,a),this},r.MinMax=function(n){var i=null,r=null,u,f,t;for(u in n)f=n[u],t=f.getBoundingInfo().boundingBox,i?(i.MinimizeInPlace(t.minimumWorld),r.MaximizeInPlace(t.maximumWorld)):(i=t.minimumWorld,r=t.maximumWorld);return{min:i,max:r}},r.Center=function(t){var i=void 0!==t.min?t:r.MinMax(t);return n.Vector3.Center(i.min,i.max)},r.MergeMeshes=function(t,i,u,f){var e,c,s,h,o;if(void 0===i&&(i=!0),!u)for(c=0,e=0;e<t.length;e++)if(t[e]&&(c+=t[e].getTotalVertices(),c>65536))return n.Tools.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null;for(e=0;e<t.length;e++)t[e]&&(t[e].computeWorldMatrix(!0),h=n.VertexData.ExtractFromMesh(t[e],!0),h.transform(t[e].getWorldMatrix()),s?s.merge(h):(s=h,o=t[e]));if(f||(f=new r(o.name+"_merged",o.getScene())),s.applyToMesh(f),f.material=o.material,f.checkCollisions=o.checkCollisions,i)for(e=0;e<t.length;e++)t[e]&&t[e].dispose();return f},r._FRONTSIDE=0,r._BACKSIDE=1,r._DOUBLESIDE=2,r._DEFAULTSIDE=0,r._NO_CAP=0,r._CAP_START=1,r._CAP_END=2,r._CAP_ALL=3,r}(n.AbstractMesh);n.Mesh=i}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t,i,r,u,f,e,o){void 0===o&&(o=!0);this.materialIndex=n;this.verticesStart=t;this.verticesCount=i;this.indexStart=r;this.indexCount=u;this._renderId=0;this._mesh=f;this._renderingMesh=e||f;f.subMeshes.push(this);this._trianglePlanes=[];this._id=f.subMeshes.length-1;o&&(this.refreshBoundingInfo(),f.computeWorldMatrix(!0))}return t.prototype.getBoundingInfo=function(){return this._boundingInfo},t.prototype.getMesh=function(){return this._mesh},t.prototype.getRenderingMesh=function(){return this._renderingMesh},t.prototype.getMaterial=function(){var t=this._renderingMesh.material,i;return t&&t instanceof n.MultiMaterial?(i=t,i.getSubMaterial(this.materialIndex)):t?t:this._mesh.getScene().defaultMaterial},t.prototype.refreshBoundingInfo=function(){var t=this._renderingMesh.getVerticesData(n.VertexBuffer.PositionKind),i,r;if(!t)return void(this._boundingInfo=this._mesh._boundingInfo);r=this._renderingMesh.getIndices();i=0===this.indexStart&&this.indexCount===r.length?n.Tools.ExtractMinAndMax(t,this.verticesStart,this.verticesCount):n.Tools.ExtractMinAndMaxIndexed(t,r,this.indexStart,this.indexCount);this._boundingInfo=new n.BoundingInfo(i.minimum,i.maximum)},t.prototype._checkCollision=function(n){return this._boundingInfo._checkCollision(n)},t.prototype.updateBoundingInfo=function(n){this._boundingInfo||this.refreshBoundingInfo();this._boundingInfo._update(n)},t.prototype.isInFrustum=function(n){return this._boundingInfo.isInFrustum(n)},t.prototype.render=function(n){this._renderingMesh.render(this,n)},t.prototype.getLinesIndexBuffer=function(n,t){if(!this._linesIndexBuffer){for(var r=[],i=this.indexStart;i<this.indexStart+this.indexCount;i+=3)r.push(n[i],n[i+1],n[i+1],n[i+2],n[i+2],n[i]);this._linesIndexBuffer=t.createIndexBuffer(r);this.linesIndexCount=r.length}return this._linesIndexBuffer},t.prototype.canIntersects=function(n){return n.intersectsBox(this._boundingInfo.boundingBox)},t.prototype.intersects=function(n,t,i,r){for(var f=null,u=this.indexStart;u<this.indexStart+this.indexCount;u+=3){var o=t[i[u]],s=t[i[u+1]],h=t[i[u+2]],e=n.intersectsTriangle(o,s,h);if(e){if(e.distance<0)continue;if((r||!f||e.distance<f.distance)&&(f=e,f.faceId=u/3,r))break}}return f},t.prototype.clone=function(i,r){var u=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,i,r,!1);return u._boundingInfo=new n.BoundingInfo(this._boundingInfo.minimum,this._boundingInfo.maximum),u},t.prototype.dispose=function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var n=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(n,1)},t.CreateFromIndices=function(n,i,r,u,f){var o=Number.MAX_VALUE,h=-Number.MAX_VALUE,c,s,e;for(f=f||u,c=f.getIndices(),s=i;i+r>s;s++)e=c[s],o>e&&(o=e),e>h&&(h=e);return new t(n,o,h-o+1,i,r,u,f)},t}();n.SubMesh=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){this.delayLoadState=n.Engine.DELAYLOADSTATE_NONE;this.hasAlpha=!1;this.getAlphaFromRGB=!1;this.level=1;this.isCube=!1;this.isRenderTarget=!1;this.animations=[];this.coordinatesIndex=0;this.coordinatesMode=n.Texture.EXPLICIT_MODE;this.wrapU=n.Texture.WRAP_ADDRESSMODE;this.wrapV=n.Texture.WRAP_ADDRESSMODE;this.anisotropicFilteringLevel=4;this._scene=t;this._scene.textures.push(this)}return t.prototype.getScene=function(){return this._scene},t.prototype.getTextureMatrix=function(){return null},t.prototype.getReflectionTextureMatrix=function(){return null},t.prototype.getInternalTexture=function(){return this._texture},t.prototype.isReady=function(){return this.delayLoadState===n.Engine.DELAYLOADSTATE_NOTLOADED?!0:this._texture?this._texture.isReady:!1},t.prototype.getSize=function(){return this._texture._width?{width:this._texture._width,height:this._texture._height}:this._texture._size?{width:this._texture._size,height:this._texture._size}:{width:0,height:0}},t.prototype.getBaseSize=function(){return this.isReady()?this._texture._size?{width:this._texture._size,height:this._texture._size}:{width:this._texture._baseWidth,height:this._texture._baseHeight}:{width:0,height:0}},t.prototype.scale=function(){},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._removeFromCache=function(n,t){for(var u,r=this._scene.getEngine().getLoadedTexturesCache(),i=0;i<r.length;i++)if(u=r[i],u.url===n&&u.noMipmap===t)return void r.splice(i,1)},t.prototype._getFromCache=function(n,t,i){for(var r,f=this._scene.getEngine().getLoadedTexturesCache(),u=0;u<f.length;u++)if(r=f[u],r.url===n&&r.noMipmap===t&&(!i||i===r.samplingMode))return r.references++,r;return null},t.prototype.delayLoad=function(){},t.prototype.releaseInternalTexture=function(){var n,t;this._texture&&(n=this._scene.getEngine().getLoadedTexturesCache(),(this._texture.references--,0===this._texture.references)&&(t=n.indexOf(this._texture),n.splice(t,1),this._scene.getEngine()._releaseTexture(this._texture),delete this._texture))},t.prototype.clone=function(){return null},t.prototype.dispose=function(){var n=this._scene.textures.indexOf(this);n>=0&&this._scene.textures.splice(n,1);void 0!==this._texture&&(this.releaseInternalTexture(),this.onDispose&&this.onDispose())},t}();n.BaseTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(r,u,f,e,o,s,h,c,l){void 0===o&&(o=i.TRILINEAR_SAMPLINGMODE);void 0===s&&(s=null);void 0===h&&(h=null);void 0===c&&(c=null);void 0===l&&(l=!1);t.call(this,u);this.uOffset=0;this.vOffset=0;this.uScale=1;this.vScale=1;this.uAng=0;this.vAng=0;this.wAng=0;this.name=r;this.url=r;this._noMipmap=f;this._invertY=e;this._samplingMode=o;this._buffer=c;this._deleteBuffer=l;r&&(this._texture=this._getFromCache(r,f,o),this._texture?n.Tools.SetImmediate(function(){s&&s()}):u.useDelayedTextureLoading?this.delayLoadState=n.Engine.DELAYLOADSTATE_NOTLOADED:(this._texture=u.getEngine().createTexture(r,f,e,u,this._samplingMode,s,h,this._buffer),l&&delete this._buffer))}return __extends(i,t),i.prototype.delayLoad=function(){this.delayLoadState===n.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=n.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap,this._samplingMode),this._texture||(this._texture=this.getScene().getEngine().createTexture(this.url,this._noMipmap,this._invertY,this.getScene(),this._samplingMode,null,null,this._buffer),this._deleteBuffer&&delete this._buffer))},i.prototype.updateSamplingMode=function(n){this._texture&&this.getScene().getEngine().updateTextureSamplingMode(n,this._texture)},i.prototype._prepareRowForTextureGeneration=function(t,i,r,u){t-=this.uOffset+.5;i-=this.vOffset+.5;r-=.5;n.Vector3.TransformCoordinatesFromFloatsToRef(t,i,r,this._rowGenerationMatrix,u);u.x*=this.uScale;u.y*=this.vScale;u.x+=.5;u.y+=.5;u.z+=.5},i.prototype.getTextureMatrix=function(){return this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng?this._cachedTextureMatrix:(this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedTextureMatrix||(this._cachedTextureMatrix=n.Matrix.Zero(),this._rowGenerationMatrix=new n.Matrix,this._t0=n.Vector3.Zero(),this._t1=n.Vector3.Zero(),this._t2=n.Vector3.Zero()),n.Matrix.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),n.Matrix.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix.m[0]=this._t1.x,this._cachedTextureMatrix.m[1]=this._t1.y,this._cachedTextureMatrix.m[2]=this._t1.z,this._cachedTextureMatrix.m[4]=this._t2.x,this._cachedTextureMatrix.m[5]=this._t2.y,this._cachedTextureMatrix.m[6]=this._t2.z,this._cachedTextureMatrix.m[8]=this._t0.x,this._cachedTextureMatrix.m[9]=this._t0.y,this._cachedTextureMatrix.m[10]=this._t0.z,this._cachedTextureMatrix)},i.prototype.getReflectionTextureMatrix=function(){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode)return this._cachedTextureMatrix;switch(this._cachedTextureMatrix||(this._cachedTextureMatrix=n.Matrix.Zero(),this._projectionModeMatrix=n.Matrix.Zero()),this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case i.SPHERICAL_MODE:n.Matrix.IdentityToRef(this._cachedTextureMatrix);this._cachedTextureMatrix[0]=-.5*this.uScale;this._cachedTextureMatrix[5]=-.5*this.vScale;this._cachedTextureMatrix[12]=.5+this.uOffset;this._cachedTextureMatrix[13]=.5+this.vOffset;break;case i.PLANAR_MODE:n.Matrix.IdentityToRef(this._cachedTextureMatrix);this._cachedTextureMatrix[0]=this.uScale;this._cachedTextureMatrix[5]=this.vScale;this._cachedTextureMatrix[12]=this.uOffset;this._cachedTextureMatrix[13]=this.vOffset;break;case i.PROJECTION_MODE:n.Matrix.IdentityToRef(this._projectionModeMatrix);this._projectionModeMatrix.m[0]=.5;this._projectionModeMatrix.m[5]=-.5;this._projectionModeMatrix.m[10]=0;this._projectionModeMatrix.m[12]=.5;this._projectionModeMatrix.m[13]=.5;this._projectionModeMatrix.m[14]=1;this._projectionModeMatrix.m[15]=1;this.getScene().getProjectionMatrix().multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:n.Matrix.IdentityToRef(this._cachedTextureMatrix)}return this._cachedTextureMatrix},i.prototype.clone=function(){var n=new i(this._texture.url,this.getScene(),this._noMipmap,this._invertY,this._samplingMode);return n.hasAlpha=this.hasAlpha,n.level=this.level,n.wrapU=this.wrapU,n.wrapV=this.wrapV,n.coordinatesIndex=this.coordinatesIndex,n.coordinatesMode=this.coordinatesMode,n.uOffset=this.uOffset,n.vOffset=this.vOffset,n.uScale=this.uScale,n.vScale=this.vScale,n.uAng=this.uAng,n.vAng=this.vAng,n.wAng=this.wAng,n},i.CreateFromBase64String=function(n,t,r,u,f,e,o,s){return void 0===e&&(e=i.TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),new i("data:"+t,r,u,f,e,o,s,n)},i.NEAREST_SAMPLINGMODE=1,i.BILINEAR_SAMPLINGMODE=2,i.TRILINEAR_SAMPLINGMODE=3,i.EXPLICIT_MODE=0,i.SPHERICAL_MODE=1,i.PLANAR_MODE=2,i.CUBIC_MODE=3,i.PROJECTION_MODE=4,i.SKYBOX_MODE=5,i.CLAMP_ADDRESSMODE=0,i.WRAP_ADDRESSMODE=1,i.MIRROR_ADDRESSMODE=2,i}(n.BaseTexture);n.Texture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){t.call(this,r);this.coordinatesMode=n.Texture.CUBIC_MODE;this.name=i;this.url=i;this._noMipmap=f;this.hasAlpha=!1;this._texture=this._getFromCache(i,f);u||(u=["_px.jpg","_py.jpg","_pz.jpg","_nx.jpg","_ny.jpg","_nz.jpg"]);this._extensions=u;this._texture||(r.useDelayedTextureLoading?this.delayLoadState=n.Engine.DELAYLOADSTATE_NOTLOADED:this._texture=r.getEngine().createCubeTexture(i,r,u,f));this.isCube=!0;this._textureMatrix=n.Matrix.Identity()}return __extends(i,t),i.prototype.clone=function(){var n=new i(this.url,this.getScene(),this._extensions,this._noMipmap);return n.level=this.level,n.wrapU=this.wrapU,n.wrapV=this.wrapV,n.coordinatesIndex=this.coordinatesIndex,n.coordinatesMode=this.coordinatesMode,n},i.prototype.delayLoad=function(){this.delayLoadState===n.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=n.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||(this._texture=this.getScene().getEngine().createCubeTexture(this.url,this.getScene(),this._extensions)))},i.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix},i}(n.BaseTexture);n.CubeTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o){void 0===e&&(e=!0);void 0===o&&(o=n.Engine.TEXTURETYPE_UNSIGNED_INT);t.call(this,null,u,!f);this.renderList=[];this.renderParticles=!0;this.renderSprites=!1;this.coordinatesMode=n.Texture.PROJECTION_MODE;this._currentRefreshId=-1;this._refreshRate=1;this.name=i;this.isRenderTarget=!0;this._size=r;this._generateMipMaps=f;this._doNotChangeAspectRatio=e;this._texture=u.getEngine().createRenderTargetTexture(r,{generateMipMaps:f,type:o});this._renderingManager=new n.RenderingManager(u)}return __extends(i,t),i.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(i.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(n){this._refreshRate=n;this.resetRefreshCounter()},enumerable:!0,configurable:!0}),i.prototype._shouldRender=function(){return-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},i.prototype.isReady=function(){return this.getScene().renderTargetsEnabled?t.prototype.isReady.call(this):!1},i.prototype.getRenderSize=function(){return this._size},Object.defineProperty(i.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.scale=function(n){var t=this._size*n;this.resize(t,this._generateMipMaps)},i.prototype.resize=function(n,t){this.releaseInternalTexture();this._texture=this.getScene().getEngine().createRenderTargetTexture(n,t)},i.prototype.render=function(t,i){var r=this.getScene(),f=r.getEngine(),e,l,o,s,u,h,c;if(this._waitingRenderList){for(this.renderList=[],e=0;e<this._waitingRenderList.length;e++)l=this._waitingRenderList[e],this.renderList.push(r.getMeshByID(l));delete this._waitingRenderList}if(!this.renderList||0!==this.renderList.length){for(t&&r.postProcessManager._prepareFrame(this._texture)||f.bindFramebuffer(this._texture),this._renderingManager.reset(),o=this.renderList?this.renderList:r.getActiveMeshes().data,s=0;s<o.length;s++)if(u=o[s],u){if(!u.isReady()){this.resetRefreshCounter();continue}if(u.isEnabled()&&u.isVisible&&u.subMeshes&&0!=(u.layerMask&r.activeCamera.layerMask))for(u._activate(r.getRenderId()),h=0;h<u.subMeshes.length;h++)c=u.subMeshes[h],r._activeIndices+=c.indexCount,this._renderingManager.dispatch(c)}this.onBeforeRender&&this.onBeforeRender();this.onClear?this.onClear(f):f.clear(r.clearColor,!0,!0);this._doNotChangeAspectRatio||r.updateTransformMatrix(!0);this._renderingManager.render(this.customRenderFunction,o,this.renderParticles,this.renderSprites);t&&r.postProcessManager._finalizeFrame(!1,this._texture);this._doNotChangeAspectRatio||r.updateTransformMatrix(!0);this.onAfterRender&&this.onAfterRender();i&&n.Tools.DumpFramebuffer(this._size,this._size,f);f.unBindFramebuffer(this._texture);this.onAfterUnbind&&this.onAfterUnbind()}},i.prototype.clone=function(){var t=this.getSize(),n=new i(this.name,t.width,this.getScene(),this._generateMipMaps);return n.hasAlpha=this.hasAlpha,n.level=this.level,n.coordinatesMode=this.coordinatesMode,n.renderList=this.renderList.slice(0),n},i}(n.Texture);n.RenderTargetTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){var s,o;void 0===e&&(e=!0);n.call(this,null,u,!e);this.isEnabled=!0;this._currentRefreshId=-1;this._refreshRate=1;this._vertexDeclaration=[2];this._vertexStrideSize=8;this._uniforms=[];this._samplers=[];this._textures=[];this._floats=[];this._floatsArrays={};this._colors3=[];this._colors4=[];this._vectors2=[];this._vectors3=[];this._matrices=[];this._fallbackTextureUsed=!1;u._proceduralTextures.push(this);this.name=t;this.isRenderTarget=!0;this._size=i;this._generateMipMaps=e;this.setFragment(r);this._fallbackTexture=f;this._texture=u.getEngine().createRenderTargetTexture(i,e);s=[];s.push(1,1);s.push(-1,1);s.push(-1,-1);s.push(1,-1);this._vertexBuffer=u.getEngine().createVertexBuffer(s);o=[];o.push(0);o.push(1);o.push(2);o.push(0);o.push(2);o.push(3);this._indexBuffer=u.getEngine().createIndexBuffer(o)}return __extends(t,n),t.prototype.reset=function(){if(void 0!==this._effect){var n=this.getScene().getEngine();n._releaseEffect(this._effect)}},t.prototype.isReady=function(){var t,n=this,i=this.getScene().getEngine();return this._fragment?this._fallbackTextureUsed?!0:(t=void 0!==this._fragment.fragmentElement?{vertex:"procedural",fragmentElement:this._fragment.fragmentElement}:{vertex:"procedural",fragment:this._fragment},this._effect=i.createEffect(t,["position"],this._uniforms,this._samplers,"",null,null,function(){n.releaseInternalTexture();n._fallbackTexture&&(n._texture=n._fallbackTexture._texture,n._texture.references++);n._fallbackTextureUsed=!0}),this._effect.isReady()):!1},t.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},t.prototype.setFragment=function(n){this._fragment=n},Object.defineProperty(t.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(n){this._refreshRate=n;this.resetRefreshCounter()},enumerable:!0,configurable:!0}),t.prototype._shouldRender=function(){return this.isEnabled&&this.isReady()&&this._texture?this._fallbackTextureUsed?!1:-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1):!1},t.prototype.getRenderSize=function(){return this._size},t.prototype.resize=function(n,t){this._fallbackTextureUsed||(this.releaseInternalTexture(),this._texture=this.getScene().getEngine().createRenderTargetTexture(n,t))},t.prototype._checkUniform=function(n){-1===this._uniforms.indexOf(n)&&this._uniforms.push(n)},t.prototype.setTexture=function(n,t){return-1===this._samplers.indexOf(n)&&this._samplers.push(n),this._textures[n]=t,this},t.prototype.setFloat=function(n,t){return this._checkUniform(n),this._floats[n]=t,this},t.prototype.setFloats=function(n,t){return this._checkUniform(n),this._floatsArrays[n]=t,this},t.prototype.setColor3=function(n,t){return this._checkUniform(n),this._colors3[n]=t,this},t.prototype.setColor4=function(n,t){return this._checkUniform(n),this._colors4[n]=t,this},t.prototype.setVector2=function(n,t){return this._checkUniform(n),this._vectors2[n]=t,this},t.prototype.setVector3=function(n,t){return this._checkUniform(n),this._vectors3[n]=t,this},t.prototype.setMatrix=function(n,t){return this._checkUniform(n),this._matrices[n]=t,this},t.prototype.render=function(){var r=this.getScene(),t=r.getEngine(),n,i;t.bindFramebuffer(this._texture);t.clear(r.clearColor,!0,!0);t.enableEffect(this._effect);t.setState(!1);for(n in this._textures)this._effect.setTexture(n,this._textures[n]);for(n in this._floats)this._effect.setFloat(n,this._floats[n]);for(n in this._floatsArrays)this._effect.setArray(n,this._floatsArrays[n]);for(n in this._colors3)this._effect.setColor3(n,this._colors3[n]);for(n in this._colors4)i=this._colors4[n],this._effect.setFloat4(n,i.r,i.g,i.b,i.a);for(n in this._vectors2)this._effect.setVector2(n,this._vectors2[n]);for(n in this._vectors3)this._effect.setVector3(n,this._vectors3[n]);for(n in this._matrices)this._effect.setMatrix(n,this._matrices[n]);t.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,this._effect);t.draw(!0,0,6);t.unBindFramebuffer(this._texture)},t.prototype.clone=function(){var i=this.getSize(),n=new t(this.name,i.width,this._fragment,this.getScene(),this._fallbackTexture,this._generateMipMaps);return n.hasAlpha=this.hasAlpha,n.level=this.level,n.coordinatesMode=this.coordinatesMode,n},t.prototype.dispose=function(){var t=this.getScene()._proceduralTextures.indexOf(this);t>=0&&this.getScene()._proceduralTextures.splice(t,1);n.prototype.dispose.call(this)},t}(n.Texture);n.ProceduralTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){var e=this;t.call(this,i,r,u,f,!0);this.mirrorPlane=new n.Plane(0,1,0,1);this._transformMatrix=n.Matrix.Zero();this._mirrorMatrix=n.Matrix.Zero();this.onBeforeRender=function(){n.Matrix.ReflectionToRef(e.mirrorPlane,e._mirrorMatrix);e._savedViewMatrix=u.getViewMatrix();e._mirrorMatrix.multiplyToRef(e._savedViewMatrix,e._transformMatrix);u.setTransformMatrix(e._transformMatrix,u.getProjectionMatrix());u.clipPlane=e.mirrorPlane;u.getEngine().cullBackFaces=!1};this.onAfterRender=function(){u.setTransformMatrix(e._savedViewMatrix,u.getProjectionMatrix());u.getEngine().cullBackFaces=!0;delete u.clipPlane}}return __extends(i,t),i.prototype.clone=function(){var t=this.getSize(),n=new i(this.name,t.width,this.getScene(),this._generateMipMaps);return n.hasAlpha=this.hasAlpha,n.level=this.level,n.mirrorPlane=this.mirrorPlane.clone(),n.renderList=this.renderList.slice(0),n},i}(n.RenderTargetTexture);n.MirrorTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e){void 0===e&&(e=n.Texture.TRILINEAR_SAMPLINGMODE);t.call(this,null,u,!f);this.name=i;this.wrapU=n.Texture.CLAMP_ADDRESSMODE;this.wrapV=n.Texture.CLAMP_ADDRESSMODE;this._generateMipMaps=f;r.getContext?(this._canvas=r,this._texture=u.getEngine().createDynamicTexture(r.width,r.height,f,e)):(this._canvas=document.createElement("canvas"),this._texture=r.width?u.getEngine().createDynamicTexture(r.width,r.height,f,e):u.getEngine().createDynamicTexture(r,r,f,e));var o=this.getSize();this._canvas.width=o.width;this._canvas.height=o.height;this._context=this._canvas.getContext("2d")}return __extends(i,t),Object.defineProperty(i.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.scale=function(n){var t=this.getSize();t.width*=n;t.height*=n;this._canvas.width=t.width;this._canvas.height=t.height;this.releaseInternalTexture();this._texture=this.getScene().getEngine().createDynamicTexture(t.width,t.height,this._generateMipMaps,this._samplingMode)},i.prototype.getContext=function(){return this._context},i.prototype.clear=function(){var n=this.getSize();this._context.fillRect(0,0,n.width,n.height)},i.prototype.update=function(n){this.getScene().getEngine().updateDynamicTexture(this._texture,this._canvas,void 0===n?!0:n)},i.prototype.drawText=function(n,t,i,r,u,f,e,o){var s,h;void 0===o&&(o=!0);s=this.getSize();(f&&(this._context.fillStyle=f,this._context.fillRect(0,0,s.width,s.height)),this._context.font=r,null===t)&&(h=this._context.measureText(n),t=(s.width-h.width)/2);this._context.fillStyle=u;this._context.fillText(n,t,i);o&&this.update(e)},i.prototype.clone=function(){var t=this.getSize(),n=new i(this.name,t.width,this.getScene(),this._generateMipMaps);return n.hasAlpha=this.hasAlpha,n.level=this.level,n.wrapU=this.wrapU,n.wrapV=this.wrapV,n},i}(n.Texture);n.DynamicTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o){var s=this;void 0===f&&(f=!1);void 0===e&&(e=!1);void 0===o&&(o=n.Texture.TRILINEAR_SAMPLINGMODE);t.call(this,null,u,!f,e);this._autoLaunch=!0;this.name=i;this.video=document.createElement("video");this.video.autoplay=!1;this.video.loop=!0;this.video.addEventListener("canplaythrough",function(){n.Tools.IsExponantOfTwo(s.video.videoWidth)&&n.Tools.IsExponantOfTwo(s.video.videoHeight)?(s.wrapU=n.Texture.WRAP_ADDRESSMODE,s.wrapV=n.Texture.WRAP_ADDRESSMODE):(s.wrapU=n.Texture.CLAMP_ADDRESSMODE,s.wrapV=n.Texture.CLAMP_ADDRESSMODE,f=!1);s._texture=u.getEngine().createDynamicTexture(s.video.videoWidth,s.video.videoHeight,f,o,!1);s._texture.isReady=!0});r.forEach(function(n){var t=document.createElement("source");t.src=n;s.video.appendChild(t)});this._lastUpdate=n.Tools.Now}return __extends(i,t),i.prototype.update=function(){this._autoLaunch&&(this._autoLaunch=!1,this.video.play());var t=n.Tools.Now;return t-this._lastUpdate<15||this.video.readyState!==this.video.HAVE_ENOUGH_DATA?!1:(this._lastUpdate=t,this.getScene().getEngine().updateVideoTexture(this._texture,this.video,this._invertY),!0)},i}(n.Texture);n.VideoTexture=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r,u,f,e){t.call(this,n,r,null,u,f,e);this._animate=!0;this._time=0;this._texturePath=i;this.loadJson(i);this.refreshRate=1}return __extends(i,t),i.prototype.loadJson=function(t){function u(){n.Tools.Log("No config file found in "+t+" trying to use ShadersStore or DOM element");try{f.setFragment(f._texturePath)}catch(i){n.Tools.Error("No json or ShaderStore or DOM element found for CustomProceduralTexture")}}var i=this,f=this,e=t+"/config.json",r=new XMLHttpRequest;r.open("GET",e,!0);r.addEventListener("load",function(){if(200===r.status||n.Tools.ValidateXHRData(r,1))try{i._config=JSON.parse(r.response);i.updateShaderUniforms();i.updateTextures();i.setFragment(i._texturePath+"/custom");i._animate=i._config.animate;i.refreshRate=i._config.refreshrate}catch(t){u()}else u()},!1);r.addEventListener("error",function(){u()},!1);try{r.send()}catch(o){n.Tools.Error("CustomProceduralTexture: Error on XHR send request.")}},i.prototype.isReady=function(){var n,i;if(!t.prototype.isReady.call(this))return!1;for(n in this._textures)if(i=this._textures[n],!i.isReady())return!1;return!0},i.prototype.render=function(n){this._animate&&(this._time+=.03*this.getScene().getAnimationRatio(),this.updateShaderUniforms());t.prototype.render.call(this,n)},i.prototype.updateTextures=function(){for(var t=0;t<this._config.sampler2Ds.length;t++)this.setTexture(this._config.sampler2Ds[t].sample2Dname,new n.Texture(this._texturePath+"/"+this._config.sampler2Ds[t].textureRelativeUrl,this.getScene()))},i.prototype.updateShaderUniforms=function(){var i,t;if(this._config)for(i=0;i<this._config.uniforms.length;i++){t=this._config.uniforms[i];switch(t.type){case"float":this.setFloat(t.name,t.value);break;case"color3":this.setColor3(t.name,new n.Color3(t.r,t.g,t.b));break;case"color4":this.setColor4(t.name,new n.Color4(t.r,t.g,t.b,t.a));break;case"vector2":this.setVector2(t.name,new n.Vector2(t.x,t.y));break;case"vector3":this.setVector3(t.name,new n.Vector3(t.x,t.y,t.z))}}this.setFloat("time",this._time)},Object.defineProperty(i.prototype,"animate",{get:function(){return this._animate},set:function(n){this._animate=n},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.CustomProceduralTexture=t}(BABYLON||(BABYLON={}));!function(n){var o=function(t){function i(i,r,u,f,e){t.call(this,i,r,"wood",u,f,e);this._ampScale=100;this._woodColor=new n.Color3(.32,.17,.09);this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setFloat("ampScale",this._ampScale);this.setColor3("woodColor",this._woodColor)},Object.defineProperty(i.prototype,"ampScale",{get:function(){return this._ampScale},set:function(n){this._ampScale=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"woodColor",{get:function(){return this._woodColor},set:function(n){this._woodColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture),t,i,r,u,f,e;n.WoodProceduralTexture=o;t=function(t){function i(r,u,f,e,o){t.call(this,r,u,"fire",f,e,o);this._time=0;this._speed=new n.Vector2(.5,.3);this._autoGenerateTime=!0;this._alphaThreshold=.5;this._fireColors=i.RedFireColors;this.updateShaderUniforms();this.refreshRate=1}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setFloat("time",this._time);this.setVector2("speed",this._speed);this.setColor3("c1",this._fireColors[0]);this.setColor3("c2",this._fireColors[1]);this.setColor3("c3",this._fireColors[2]);this.setColor3("c4",this._fireColors[3]);this.setColor3("c5",this._fireColors[4]);this.setColor3("c6",this._fireColors[5]);this.setFloat("alphaThreshold",this._alphaThreshold)},i.prototype.render=function(n){this._autoGenerateTime&&(this._time+=.03*this.getScene().getAnimationRatio(),this.updateShaderUniforms());t.prototype.render.call(this,n)},Object.defineProperty(i,"PurpleFireColors",{get:function(){return[new n.Color3(.5,0,1),new n.Color3(.9,0,1),new n.Color3(.2,0,1),new n.Color3(1,.9,1),new n.Color3(.1,.1,1),new n.Color3(.9,.9,1)]},enumerable:!0,configurable:!0}),Object.defineProperty(i,"GreenFireColors",{get:function(){return[new n.Color3(.5,1,0),new n.Color3(.5,1,0),new n.Color3(.3,.4,0),new n.Color3(.5,1,0),new n.Color3(.2,0,0),new n.Color3(.5,1,0)]},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RedFireColors",{get:function(){return[new n.Color3(.5,0,.1),new n.Color3(.9,0,0),new n.Color3(.2,0,0),new n.Color3(1,.9,0),new n.Color3(.1,.1,.1),new n.Color3(.9,.9,.9)]},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BlueFireColors",{get:function(){return[new n.Color3(.1,0,.5),new n.Color3(0,0,.5),new n.Color3(.1,0,.2),new n.Color3(0,0,1),new n.Color3(.1,.2,.3),new n.Color3(0,.2,.9)]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fireColors",{get:function(){return this._fireColors},set:function(n){this._fireColors=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"time",{get:function(){return this._time},set:function(n){this._time=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"speed",{get:function(){return this._speed},set:function(n){this._speed=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alphaThreshold",{get:function(){return this._alphaThreshold},set:function(n){this._alphaThreshold=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.FireProceduralTexture=t;i=function(t){function i(i,r,u,f,e){t.call(this,i,r,"cloud",u,f,e);this._skyColor=new n.Color4(.15,.68,1,1);this._cloudColor=new n.Color4(1,1,1,1);this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setColor4("skyColor",this._skyColor);this.setColor4("cloudColor",this._cloudColor)},Object.defineProperty(i.prototype,"skyColor",{get:function(){return this._skyColor},set:function(n){this._skyColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cloudColor",{get:function(){return this._cloudColor},set:function(n){this._cloudColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.CloudProceduralTexture=i;r=function(t){function i(i,r,u,f,e){t.call(this,i,r,"grass",u,f,e);this._herb1=new n.Color3(.29,.38,.02);this._herb2=new n.Color3(.36,.49,.09);this._herb3=new n.Color3(.51,.6,.28);this._groundColor=new n.Color3(1,1,1);this._grassColors=[new n.Color3(.29,.38,.02),new n.Color3(.36,.49,.09),new n.Color3(.51,.6,.28)];this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setColor3("herb1Color",this._grassColors[0]);this.setColor3("herb2Color",this._grassColors[1]);this.setColor3("herb3Color",this._grassColors[2]);this.setColor3("groundColor",this._groundColor)},Object.defineProperty(i.prototype,"grassColors",{get:function(){return this._grassColors},set:function(n){this._grassColors=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"groundColor",{get:function(){return this._groundColor},set:function(n){this.groundColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.GrassProceduralTexture=r;u=function(t){function i(i,r,u,f,e){t.call(this,i,r,"road",u,f,e);this._roadColor=new n.Color3(.53,.53,.53);this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setColor3("roadColor",this._roadColor)},Object.defineProperty(i.prototype,"roadColor",{get:function(){return this._roadColor},set:function(n){this._roadColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.RoadProceduralTexture=u;f=function(t){function i(i,r,u,f,e){t.call(this,i,r,"brick",u,f,e);this._numberOfBricksHeight=15;this._numberOfBricksWidth=5;this._jointColor=new n.Color3(.72,.72,.72);this._brickColor=new n.Color3(.77,.47,.4);this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setFloat("numberOfBricksHeight",this._numberOfBricksHeight);this.setFloat("numberOfBricksWidth",this._numberOfBricksWidth);this.setColor3("brickColor",this._brickColor);this.setColor3("jointColor",this._jointColor)},Object.defineProperty(i.prototype,"numberOfBricksHeight",{get:function(){return this._numberOfBricksHeight},set:function(n){this._numberOfBricksHeight=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"numberOfBricksWidth",{get:function(){return this._numberOfBricksWidth},set:function(n){this._numberOfBricksWidth=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"jointColor",{get:function(){return this._jointColor},set:function(n){this._jointColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"brickColor",{get:function(){return this._brickColor},set:function(n){this._brickColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.BrickProceduralTexture=f;e=function(t){function i(i,r,u,f,e){t.call(this,i,r,"marble",u,f,e);this._numberOfTilesHeight=3;this._numberOfTilesWidth=3;this._amplitude=9;this._marbleColor=new n.Color3(.77,.47,.4);this._jointColor=new n.Color3(.72,.72,.72);this.updateShaderUniforms();this.refreshRate=0}return __extends(i,t),i.prototype.updateShaderUniforms=function(){this.setFloat("numberOfTilesHeight",this._numberOfTilesHeight);this.setFloat("numberOfTilesWidth",this._numberOfTilesWidth);this.setFloat("amplitude",this._amplitude);this.setColor3("marbleColor",this._marbleColor);this.setColor3("jointColor",this._jointColor)},Object.defineProperty(i.prototype,"numberOfTilesHeight",{get:function(){return this._numberOfTilesHeight},set:function(n){this._numberOfTilesHeight=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"numberOfTilesWidth",{get:function(){return this._numberOfTilesWidth},set:function(n){this._numberOfTilesWidth=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"jointColor",{get:function(){return this._jointColor},set:function(n){this._jointColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"marbleColor",{get:function(){return this._marbleColor},set:function(n){this._marbleColor=n;this.updateShaderUniforms()},enumerable:!0,configurable:!0}),i}(n.ProceduralTexture);n.MarbleProceduralTexture=e}(BABYLON||(BABYLON={}));!function(n){var i=function(){function n(){this._defines={};this._currentRank=32;this._maxRank=-1}return n.prototype.addFallback=function(n,t){this._defines[n]||(n<this._currentRank&&(this._currentRank=n),n>this._maxRank&&(this._maxRank=n),this._defines[n]=[]);this._defines[n].push(t)},Object.defineProperty(n.prototype,"isMoreFallbacks",{get:function(){return this._currentRank<=this._maxRank},enumerable:!0,configurable:!0}),n.prototype.reduce=function(n){for(var i=this._defines[this._currentRank],t=0;t<i.length;t++)n=n.replace("#define "+i[t],"");return this._currentRank++,n},n}(),t;n.EffectFallbacks=i;t=function(){function t(n,t,i,r,u,f,e,o,s){var l=this,h,c;this._isReady=!1;this._compilationError="";this._valueCache=[];this._engine=u;this.name=n;this.defines=f;this._uniformsNames=i.concat(r);this._samplers=r;this._attributesNames=t;this.onError=s;this.onCompiled=o;n.vertexElement?(h=document.getElementById(n.vertexElement),h||(h=n.vertexElement)):h=n.vertex||n;n.fragmentElement?(c=document.getElementById(n.fragmentElement),c||(c=n.fragmentElement)):c=n.fragment||n;this._loadVertexShader(h,function(n){l._loadFragmentShader(c,function(i){l._prepareEffect(n,i,t,f,e)})})}return t.prototype.isReady=function(){return this._isReady},t.prototype.getProgram=function(){return this._program},t.prototype.getAttributesNames=function(){return this._attributesNames},t.prototype.getAttributeLocation=function(n){return this._attributes[n]},t.prototype.getAttributeLocationByName=function(n){var t=this._attributesNames.indexOf(n);return this._attributes[t]},t.prototype.getAttributesCount=function(){return this._attributes.length},t.prototype.getUniformIndex=function(n){return this._uniformsNames.indexOf(n)},t.prototype.getUniform=function(n){return this._uniforms[this._uniformsNames.indexOf(n)]},t.prototype.getSamplers=function(){return this._samplers},t.prototype.getCompilationError=function(){return this._compilationError},t.prototype._loadVertexShader=function(i,r){var u,f;if(i instanceof HTMLElement)return u=n.Tools.GetDOMTextContent(i),void r(u);if(t.ShadersStore[i+"VertexShader"])return void r(t.ShadersStore[i+"VertexShader"]);f="."===i[0]||"/"===i[0]?i:n.Engine.ShadersRepository+i;n.Tools.LoadFile(f+".vertex.fx",r)},t.prototype._loadFragmentShader=function(i,r){var u,f;if(i instanceof HTMLElement)return u=n.Tools.GetDOMTextContent(i),void r(u);if(t.ShadersStore[i+"PixelShader"])return void r(t.ShadersStore[i+"PixelShader"]);if(t.ShadersStore[i+"FragmentShader"])return void r(t.ShadersStore[i+"FragmentShader"]);f="."===i[0]||"/"===i[0]?i:n.Engine.ShadersRepository+i;n.Tools.LoadFile(f+".fragment.fx",r)},t.prototype._prepareEffect=function(t,i,r,u,f){var e,o,h;try{for(e=this._engine,e.getCaps().highPrecisionShaderSupported||(t=t.replace("precision highp float","precision mediump float"),i=i.replace("precision highp float","precision mediump float")),this._program=e.createShaderProgram(t,i,u),this._uniforms=e.getUniforms(this._program,this._uniformsNames),this._attributes=e.getAttributes(this._program,r),o=0;o<this._samplers.length;o++)h=this.getUniform(this._samplers[o]),null==h&&(this._samplers.splice(o,1),o--);e.bindSamplers(this);this._isReady=!0;this.onCompiled&&this.onCompiled(this)}catch(s){if(-1!==s.message.indexOf("highp"))return t=t.replace("precision highp float","precision mediump float"),i=i.replace("precision highp float","precision mediump float"),void this._prepareEffect(t,i,r,u,f);f&&f.isMoreFallbacks?(u=f.reduce(u),this._prepareEffect(t,i,r,u,f)):(n.Tools.Error("Unable to compile effect: "),this.name.vertexElement?(n.Tools.Error("Vertex shader:"+this.name.vertexElement),n.Tools.Error("Fragment shader:"+this.name.fragmentElement)):this.name.vertex?(n.Tools.Error("Vertex shader:"+this.name.vertex),n.Tools.Error("Fragment shader:"+this.name.fragment)):(n.Tools.Error("Vertex shader:"+this.name),n.Tools.Error("Fragment shader:"+this.name)),n.Tools.Error("Defines: "+u),n.Tools.Error("Error: "+s.message),this._compilationError=s.message,this.onError&&this.onError(this,this._compilationError))}},t.prototype._bindTexture=function(n,t){this._engine._bindTexture(this._samplers.indexOf(n),t)},t.prototype.setTexture=function(n,t){this._engine.setTexture(this._samplers.indexOf(n),t)},t.prototype.setTextureFromPostProcess=function(n,t){this._engine.setTextureFromPostProcess(this._samplers.indexOf(n),t)},t.prototype._cacheFloat2=function(n,t,i){return this._valueCache[n]?(this._valueCache[n][0]=t,void(this._valueCache[n][1]=i)):void(this._valueCache[n]=[t,i])},t.prototype._cacheFloat3=function(n,t,i,r){return this._valueCache[n]?(this._valueCache[n][0]=t,this._valueCache[n][1]=i,void(this._valueCache[n][2]=r)):void(this._valueCache[n]=[t,i,r])},t.prototype._cacheFloat4=function(n,t,i,r,u){return this._valueCache[n]?(this._valueCache[n][0]=t,this._valueCache[n][1]=i,this._valueCache[n][2]=r,void(this._valueCache[n][3]=u)):void(this._valueCache[n]=[t,i,r,u])},t.prototype.setArray=function(n,t){return this._engine.setArray(this.getUniform(n),t),this},t.prototype.setArray2=function(n,t){return this._engine.setArray2(this.getUniform(n),t),this},t.prototype.setArray3=function(n,t){return this._engine.setArray3(this.getUniform(n),t),this},t.prototype.setArray4=function(n,t){return this._engine.setArray4(this.getUniform(n),t),this},t.prototype.setMatrices=function(n,t){return this._engine.setMatrices(this.getUniform(n),t),this},t.prototype.setMatrix=function(n,t){return this._engine.setMatrix(this.getUniform(n),t),this},t.prototype.setMatrix3x3=function(n,t){return this._engine.setMatrix3x3(this.getUniform(n),t),this},t.prototype.setMatrix2x2=function(n,t){return this._engine.setMatrix2x2(this.getUniform(n),t),this},t.prototype.setFloat=function(n,t){return this._valueCache[n]&&this._valueCache[n]===t?this:(this._valueCache[n]=t,this._engine.setFloat(this.getUniform(n),t),this)},t.prototype.setBool=function(n,t){return this._valueCache[n]&&this._valueCache[n]===t?this:(this._valueCache[n]=t,this._engine.setBool(this.getUniform(n),t?1:0),this)},t.prototype.setVector2=function(n,t){return this._valueCache[n]&&this._valueCache[n][0]===t.x&&this._valueCache[n][1]===t.y?this:(this._cacheFloat2(n,t.x,t.y),this._engine.setFloat2(this.getUniform(n),t.x,t.y),this)},t.prototype.setFloat2=function(n,t,i){return this._valueCache[n]&&this._valueCache[n][0]===t&&this._valueCache[n][1]===i?this:(this._cacheFloat2(n,t,i),this._engine.setFloat2(this.getUniform(n),t,i),this)},t.prototype.setVector3=function(n,t){return this._valueCache[n]&&this._valueCache[n][0]===t.x&&this._valueCache[n][1]===t.y&&this._valueCache[n][2]===t.z?this:(this._cacheFloat3(n,t.x,t.y,t.z),this._engine.setFloat3(this.getUniform(n),t.x,t.y,t.z),this)},t.prototype.setFloat3=function(n,t,i,r){return this._valueCache[n]&&this._valueCache[n][0]===t&&this._valueCache[n][1]===i&&this._valueCache[n][2]===r?this:(this._cacheFloat3(n,t,i,r),this._engine.setFloat3(this.getUniform(n),t,i,r),this)},t.prototype.setVector4=function(n,t){return this._valueCache[n]&&this._valueCache[n][0]===t.x&&this._valueCache[n][1]===t.y&&this._valueCache[n][2]===t.z&&this._valueCache[n][3]===t.w?this:(this._cacheFloat4(n,t.x,t.y,t.z,t.w),this._engine.setFloat4(this.getUniform(n),t.x,t.y,t.z,t.w),this)},t.prototype.setFloat4=function(n,t,i,r,u){return this._valueCache[n]&&this._valueCache[n][0]===t&&this._valueCache[n][1]===i&&this._valueCache[n][2]===r&&this._valueCache[n][3]===u?this:(this._cacheFloat4(n,t,i,r,u),this._engine.setFloat4(this.getUniform(n),t,i,r,u),this)},t.prototype.setColor3=function(n,t){return this._valueCache[n]&&this._valueCache[n][0]===t.r&&this._valueCache[n][1]===t.g&&this._valueCache[n][2]===t.b?this:(this._cacheFloat3(n,t.r,t.g,t.b),this._engine.setColor3(this.getUniform(n),t),this)},t.prototype.setColor4=function(n,t,i){return this._valueCache[n]&&this._valueCache[n][0]===t.r&&this._valueCache[n][1]===t.g&&this._valueCache[n][2]===t.b&&this._valueCache[n][3]===i?this:(this._cacheFloat4(n,t.r,t.g,t.b,i),this._engine.setColor4(this.getUniform(n),t,i),this)},t.ShadersStore={},t}();n.Effect=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(i,r,u){this.name=i;this.checkReadyOnEveryCall=!0;this.checkReadyOnlyOnce=!1;this.state="";this.alpha=1;this.backFaceCulling=!0;this.alphaMode=n.Engine.ALPHA_COMBINE;this.disableDepthWrite=!1;this._wasPreviouslyReady=!1;this._fillMode=t.TriangleFillMode;this.pointSize=1;this.zOffset=0;this.id=i;this._scene=r;u||r.materials.push(this)}return Object.defineProperty(t,"TriangleFillMode",{get:function(){return t._TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WireFrameFillMode",{get:function(){return t._WireFrameFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointFillMode",{get:function(){return t._PointFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wireframe",{get:function(){return this._fillMode===t.WireFrameFillMode},set:function(n){this._fillMode=n?t.WireFrameFillMode:t.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointsCloud",{get:function(){return this._fillMode===t.PointFillMode},set:function(n){this._fillMode=n?t.PointFillMode:t.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this._fillMode},set:function(n){this._fillMode=n},enumerable:!0,configurable:!0}),t.prototype.isReady=function(){return!0},t.prototype.getEffect=function(){return this._effect},t.prototype.getScene=function(){return this._scene},t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.trackCreation=function(){},t.prototype._preBind=function(){var n=this._scene.getEngine();n.enableEffect(this._effect);n.setState(this.backFaceCulling,this.zOffset)},t.prototype.bind=function(n,t){if(this._scene._cachedMaterial=this,this.onBind&&this.onBind(this,t),this.disableDepthWrite){var i=this._scene.getEngine();this._cachedDepthWriteState=i.getDepthWrite();i.setDepthWrite(!1)}},t.prototype.bindOnlyWorldMatrix=function(){},t.prototype.unbind=function(){if(this.disableDepthWrite){var n=this._scene.getEngine();n.setDepthWrite(this._cachedDepthWriteState)}},t.prototype.clone=function(){return null},t.prototype.dispose=function(n){var t=this._scene.materials.indexOf(this);this._scene.materials.splice(t,1);n&&this._effect&&(this._scene.getEngine()._releaseEffect(this._effect),this._effect=null);this.onDispose&&this.onDispose()},t._TriangleFillMode=0,t._WireFrameFillMode=1,t._PointFillMode=2,t}();n.Material=t}(BABYLON||(BABYLON={}));!function(n){var t=4,u=function(){function t(){this.isEnabled=!0;this.leftColor=n.Color3.White();this.rightColor=n.Color3.Black();this.bias=0;this.power=1}return t}(),i,r;n.FresnelParameters=u;i=function(){function n(){this.DIFFUSE=!1;this.AMBIENT=!1;this.OPACITY=!1;this.OPACITYRGB=!1;this.REFLECTION=!1;this.EMISSIVE=!1;this.SPECULAR=!1;this.BUMP=!1;this.SPECULAROVERALPHA=!1;this.CLIPPLANE=!1;this.ALPHATEST=!1;this.ALPHAFROMDIFFUSE=!1;this.POINTSIZE=!1;this.FOG=!1;this.LIGHT0=!1;this.LIGHT1=!1;this.LIGHT2=!1;this.LIGHT3=!1;this.SPOTLIGHT0=!1;this.SPOTLIGHT1=!1;this.SPOTLIGHT2=!1;this.SPOTLIGHT3=!1;this.HEMILIGHT0=!1;this.HEMILIGHT1=!1;this.HEMILIGHT2=!1;this.HEMILIGHT3=!1;this.POINTDIRLIGHT0=!1;this.POINTDIRLIGHT1=!1;this.POINTDIRLIGHT2=!1;this.POINTDIRLIGHT3=!1;this.SPECULARTERM=!1;this.SHADOW0=!1;this.SHADOW1=!1;this.SHADOW2=!1;this.SHADOW3=!1;this.SHADOWS=!1;this.SHADOWVSM0=!1;this.SHADOWVSM1=!1;this.SHADOWVSM2=!1;this.SHADOWVSM3=!1;this.SHADOWPCF0=!1;this.SHADOWPCF1=!1;this.SHADOWPCF2=!1;this.SHADOWPCF3=!1;this.DIFFUSEFRESNEL=!1;this.OPACITYFRESNEL=!1;this.REFLECTIONFRESNEL=!1;this.EMISSIVEFRESNEL=!1;this.FRESNEL=!1;this.NORMAL=!1;this.UV1=!1;this.UV2=!1;this.VERTEXCOLOR=!1;this.VERTEXALPHA=!1;this.BONES=!1;this.BONES4=!1;this.BonesPerMesh=0;this.INSTANCES=!1;this.GLOSSINESS=!1;this.ROUGHNESS=!1;this.EMISSIVEASILLUMINATION=!1;this.REFLECTIONFRESNELFROMSPECULAR=!1;this._keys=Object.keys(this)}return n.prototype.isEqual=function(n){for(var i,t=0;t<this._keys.length;t++)if(i=this._keys[t],this[i]!==n[i])return!1;return!0},n.prototype.cloneTo=function(n){for(var i,t=0;t<this._keys.length;t++)i=this._keys[t],n[i]=this[i]},n.prototype.reset=function(){for(var t,n=0;n<this._keys.length;n++)t=this._keys[n],this[t]="BonesPerMesh"!==t?!1:0},n.prototype.toString=function(){for(var n,t="",i=0;i<this._keys.length;i++)n=this._keys[i],"BonesPerMesh"===n&&this[n]>0?t+="#define BonesPerMesh "+this[n]+"\n":this[n]&&(t+="#define "+n+"\n");return t},n}();r=function(r){function u(t,u){var f=this;r.call(this,t,u);this.ambientColor=new n.Color3(0,0,0);this.diffuseColor=new n.Color3(1,1,1);this.specularColor=new n.Color3(1,1,1);this.specularPower=64;this.emissiveColor=new n.Color3(0,0,0);this.useAlphaFromDiffuseTexture=!1;this.useEmissiveAsIllumination=!1;this.useReflectionFresnelFromSpecular=!1;this.useSpecularOverAlpha=!0;this.fogEnabled=!0;this.roughness=0;this.useGlossinessFromSpecularMapAlpha=!1;this._renderTargets=new n.SmartArray(16);this._worldViewProjectionMatrix=n.Matrix.Zero();this._globalAmbientColor=new n.Color3(0,0,0);this._scaledDiffuse=new n.Color3;this._scaledSpecular=new n.Color3;this._defines=new i;this._cachedDefines=new i;this._cachedDefines.BonesPerMesh=-1;this.getRenderTargetTextures=function(){return f._renderTargets.reset(),f.reflectionTexture&&f.reflectionTexture.isRenderTarget&&f._renderTargets.push(f.reflectionTexture),f._renderTargets}}return __extends(u,r),u.prototype.needAlphaBlending=function(){return this.alpha<1||null!=this.opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled},u.prototype.needAlphaTesting=function(){return null!=this.diffuseTexture&&this.diffuseTexture.hasAlpha},u.prototype._shouldUseAlphaFromDiffuseTexture=function(){return null!=this.diffuseTexture&&this.diffuseTexture.hasAlpha&&this.useAlphaFromDiffuseTexture},u.prototype.getAlphaTestTexture=function(){return this.diffuseTexture},u.prototype.isReady=function(i,r){var e,v,s,y,w,p,b,d,l,o,f,h,k,g;if(this.checkReadyOnlyOnce&&this._wasPreviouslyReady||(e=this.getScene(),!this.checkReadyOnEveryCall&&this._renderId===e.getRenderId()))return!0;var nt=e.getEngine(),a=!1,c=!1;if(this._defines.reset(),e.texturesEnabled){if(this.diffuseTexture&&u.DiffuseTextureEnabled){if(!this.diffuseTexture.isReady())return!1;c=!0;this._defines.DIFFUSE=!0}if(this.ambientTexture&&u.AmbientTextureEnabled){if(!this.ambientTexture.isReady())return!1;c=!0;this._defines.AMBIENT=!0}if(this.opacityTexture&&u.OpacityTextureEnabled){if(!this.opacityTexture.isReady())return!1;c=!0;this._defines.OPACITY=!0;this.opacityTexture.getAlphaFromRGB&&(this._defines.OPACITYRGB=!0)}if(this.reflectionTexture&&u.ReflectionTextureEnabled){if(!this.reflectionTexture.isReady())return!1;a=!0;c=!0;this._defines.REFLECTION=!0;this.roughness>0&&(this._defines.ROUGHNESS=!0)}if(this.emissiveTexture&&u.EmissiveTextureEnabled){if(!this.emissiveTexture.isReady())return!1;c=!0;this._defines.EMISSIVE=!0}if(this.specularTexture&&u.SpecularTextureEnabled){if(!this.specularTexture.isReady())return!1;c=!0;this._defines.SPECULAR=!0;this._defines.GLOSSINESS=this.useGlossinessFromSpecularMapAlpha}}if(e.getEngine().getCaps().standardDerivatives&&this.bumpTexture&&u.BumpTextureEnabled){if(!this.bumpTexture.isReady())return!1;c=!0;this._defines.BUMP=!0}if(e.clipPlane&&(this._defines.CLIPPLANE=!0),nt.getAlphaTesting()&&(this._defines.ALPHATEST=!0),this._shouldUseAlphaFromDiffuseTexture()&&(this._defines.ALPHAFROMDIFFUSE=!0),this.useEmissiveAsIllumination&&(this._defines.EMISSIVEASILLUMINATION=!0),this.useReflectionFresnelFromSpecular&&(this._defines.REFLECTIONFRESNELFROMSPECULAR=!0),(this.pointsCloud||e.forcePointsCloud)&&(this._defines.POINTSIZE=!0),e.fogEnabled&&i&&i.applyFog&&e.fogMode!==n.Scene.FOGMODE_NONE&&this.fogEnabled&&(this._defines.FOG=!0),f=0,e.lightsEnabled)for(v=0;v<e.lights.length;v++)if(s=e.lights[v],s.isEnabled()){if(s._excludedMeshesIds.length>0){for(y=0;y<s._excludedMeshesIds.length;y++)w=e.getMeshByID(s._excludedMeshesIds[y]),w&&s.excludedMeshes.push(w);s._excludedMeshesIds=[]}if(s._includedOnlyMeshesIds.length>0){for(p=0;p<s._includedOnlyMeshesIds.length;p++)b=e.getMeshByID(s._includedOnlyMeshesIds[p]),b&&s.includedOnlyMeshes.push(b);s._includedOnlyMeshesIds=[]}if(s.canAffectMesh(i)&&(a=!0,this._defines["LIGHT"+f]=!0,(d=s instanceof n.SpotLight?"SPOTLIGHT"+f:s instanceof n.HemisphericLight?"HEMILIGHT"+f:"POINTDIRLIGHT"+f,this._defines[d]=!0,s.specular.equalsFloats(0,0,0)||(this._defines.SPECULARTERM=!0),e.shadowsEnabled)&&(l=s.getShadowGenerator(),i&&i.receiveShadows&&l&&(this._defines["SHADOW"+f]=!0,this._defines.SHADOWS=!0,(l.useVarianceShadowMap||l.useBlurVarianceShadowMap)&&(this._defines["SHADOWVSM"+f]=!0),l.usePoissonSampling&&(this._defines["SHADOWPCF"+f]=!0))),f++,f===t))break}if(u.FresnelEnabled&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled||this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled||this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled||this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled)&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(this._defines.DIFFUSEFRESNEL=!0),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&(this._defines.OPACITYFRESNEL=!0),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(this._defines.REFLECTIONFRESNEL=!0),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._defines.EMISSIVEFRESNEL=!0),a=!0,this._defines.FRESNEL=!0),this._defines.SPECULARTERM&&this.useSpecularOverAlpha&&(this._defines.SPECULAROVERALPHA=!0),i&&(a&&i.isVerticesDataPresent(n.VertexBuffer.NormalKind)&&(this._defines.NORMAL=!0),c&&(i.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(this._defines.UV1=!0),i.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(this._defines.UV2=!0)),i.useVertexColors&&i.isVerticesDataPresent(n.VertexBuffer.ColorKind)&&(this._defines.VERTEXCOLOR=!0,i.hasVertexAlpha&&(this._defines.VERTEXALPHA=!0)),i.useBones&&i.computeBonesUsingShaders&&(this._defines.BONES=!0,this._defines.BonesPerMesh=i.skeleton.bones.length+1,this._defines.BONES4=!0),r&&(this._defines.INSTANCES=!0)),!this._defines.isEqual(this._cachedDefines)){for(this._defines.cloneTo(this._cachedDefines),e.resetCachedMaterial(),o=new n.EffectFallbacks,this._defines.REFLECTION&&o.addFallback(0,"REFLECTION"),this._defines.SPECULAR&&o.addFallback(0,"SPECULAR"),this._defines.BUMP&&o.addFallback(0,"BUMP"),this._defines.SPECULAROVERALPHA&&o.addFallback(0,"SPECULAROVERALPHA"),this._defines.FOG&&o.addFallback(1,"FOG"),f=0;t>f;f++)this._defines["LIGHT"+f]&&(f>0&&o.addFallback(f,"LIGHT"+f),this._defines["SHADOW"+f]&&o.addFallback(0,"SHADOW"+f),this._defines["SHADOWPCF"+f]&&o.addFallback(0,"SHADOWPCF"+f),this._defines["SHADOWVSM"+f]&&o.addFallback(0,"SHADOWVSM"+f));this._defines.SPECULARTERM&&o.addFallback(0,"SPECULARTERM");this._defines.DIFFUSEFRESNEL&&o.addFallback(1,"DIFFUSEFRESNEL");this._defines.OPACITYFRESNEL&&o.addFallback(2,"OPACITYFRESNEL");this._defines.REFLECTIONFRESNEL&&o.addFallback(3,"REFLECTIONFRESNEL");this._defines.EMISSIVEFRESNEL&&o.addFallback(4,"EMISSIVEFRESNEL");this._defines.FRESNEL&&o.addFallback(4,"FRESNEL");this._defines.BONES4&&o.addFallback(0,"BONES4");h=[n.VertexBuffer.PositionKind];this._defines.NORMAL&&h.push(n.VertexBuffer.NormalKind);this._defines.UV1&&h.push(n.VertexBuffer.UVKind);this._defines.UV2&&h.push(n.VertexBuffer.UV2Kind);this._defines.VERTEXCOLOR&&h.push(n.VertexBuffer.ColorKind);this._defines.BONES&&(h.push(n.VertexBuffer.MatricesIndicesKind),h.push(n.VertexBuffer.MatricesWeightsKind));this._defines.INSTANCES&&(h.push("world0"),h.push("world1"),h.push("world2"),h.push("world3"));k="default";e.getEngine().getCaps().standardDerivatives||(k="legacydefault");g=this._defines.toString();this._effect=e.getEngine().createEffect(k,h,["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","vLightData0","vLightDiffuse0","vLightSpecular0","vLightDirection0","vLightGround0","lightMatrix0","vLightData1","vLightDiffuse1","vLightSpecular1","vLightDirection1","vLightGround1","lightMatrix1","vLightData2","vLightDiffuse2","vLightSpecular2","vLightDirection2","vLightGround2","lightMatrix2","vLightData3","vLightDiffuse3","vLightSpecular3","vLightDirection3","vLightGround3","lightMatrix3","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","mBones","vClipPlane","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","shadowsInfo0","shadowsInfo1","shadowsInfo2","shadowsInfo3","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","roughness"],["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","shadowSampler0","shadowSampler1","shadowSampler2","shadowSampler3"],g,o,this.onCompiled,this.onError)}return this._effect.isReady()?(this._renderId=e.getRenderId(),this._wasPreviouslyReady=!0,!0):!1},u.prototype.unbind=function(){this.reflectionTexture&&this.reflectionTexture.isRenderTarget&&this._effect.setTexture("reflection2DSampler",null);r.prototype.unbind.call(this)},u.prototype.bindOnlyWorldMatrix=function(n){this._effect.setMatrix("world",n)},u.prototype.bind=function(i,f){var e=this.getScene(),c,s,l,o,h;if((this.bindOnlyWorldMatrix(i),this._effect.setMatrix("viewProjection",e.getTransformMatrix()),f&&f.useBones&&f.computeBonesUsingShaders&&this._effect.setMatrices("mBones",f.skeleton.getTransformMatrices()),e.getCachedMaterial()!==this)&&((u.FresnelEnabled&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(this._effect.setColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),this._effect.setColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&this._effect.setColor4("opacityParts",new n.Color3(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(this._effect.setColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),this._effect.setColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._effect.setColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),this._effect.setColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),this.diffuseTexture&&u.DiffuseTextureEnabled&&(this._effect.setTexture("diffuseSampler",this.diffuseTexture),this._effect.setFloat2("vDiffuseInfos",this.diffuseTexture.coordinatesIndex,this.diffuseTexture.level),this._effect.setMatrix("diffuseMatrix",this.diffuseTexture.getTextureMatrix())),this.ambientTexture&&u.AmbientTextureEnabled&&(this._effect.setTexture("ambientSampler",this.ambientTexture),this._effect.setFloat2("vAmbientInfos",this.ambientTexture.coordinatesIndex,this.ambientTexture.level),this._effect.setMatrix("ambientMatrix",this.ambientTexture.getTextureMatrix())),this.opacityTexture&&u.OpacityTextureEnabled&&(this._effect.setTexture("opacitySampler",this.opacityTexture),this._effect.setFloat2("vOpacityInfos",this.opacityTexture.coordinatesIndex,this.opacityTexture.level),this._effect.setMatrix("opacityMatrix",this.opacityTexture.getTextureMatrix())),this.reflectionTexture&&u.ReflectionTextureEnabled&&(this.reflectionTexture.isCube?(this._effect.setTexture("reflectionCubeSampler",this.reflectionTexture),this._defines.ROUGHNESS&&this._effect.setFloat("roughness",this.roughness)):this._effect.setTexture("reflection2DSampler",this.reflectionTexture),this._effect.setMatrix("reflectionMatrix",this.reflectionTexture.getReflectionTextureMatrix()),this._effect.setFloat3("vReflectionInfos",this.reflectionTexture.coordinatesMode,this.reflectionTexture.level,this.reflectionTexture.isCube?1:0)),this.emissiveTexture&&u.EmissiveTextureEnabled&&(this._effect.setTexture("emissiveSampler",this.emissiveTexture),this._effect.setFloat2("vEmissiveInfos",this.emissiveTexture.coordinatesIndex,this.emissiveTexture.level),this._effect.setMatrix("emissiveMatrix",this.emissiveTexture.getTextureMatrix())),this.specularTexture&&u.SpecularTextureEnabled&&(this._effect.setTexture("specularSampler",this.specularTexture),this._effect.setFloat2("vSpecularInfos",this.specularTexture.coordinatesIndex,this.specularTexture.level),this._effect.setMatrix("specularMatrix",this.specularTexture.getTextureMatrix())),this.bumpTexture&&e.getEngine().getCaps().standardDerivatives&&u.BumpTextureEnabled&&(this._effect.setTexture("bumpSampler",this.bumpTexture),this._effect.setFloat2("vBumpInfos",this.bumpTexture.coordinatesIndex,1/this.bumpTexture.level),this._effect.setMatrix("bumpMatrix",this.bumpTexture.getTextureMatrix())),e.clipPlane)&&(c=e.clipPlane,this._effect.setFloat4("vClipPlane",c.normal.x,c.normal.y,c.normal.z,c.d)),this.pointsCloud&&this._effect.setFloat("pointSize",this.pointSize),e.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),this._scaledSpecular.r=this.specularColor.r*n.Tools.Clamp(1-this.emissiveColor.r),this._scaledSpecular.g=this.specularColor.g*n.Tools.Clamp(1-this.emissiveColor.g),this._scaledSpecular.b=this.specularColor.b*n.Tools.Clamp(1-this.emissiveColor.b),this._effect.setVector3("vEyePosition",e.activeCamera.position),this._effect.setColor3("vAmbientColor",this._globalAmbientColor),this._defines.SPECULARTERM&&this._effect.setColor4("vSpecularColor",this._scaledSpecular,this.specularPower),this._effect.setColor3("vEmissiveColor",this.emissiveColor)),this._scaledDiffuse.r=this.diffuseColor.r*n.Tools.Clamp(1-this.emissiveColor.r),this._scaledDiffuse.g=this.diffuseColor.g*n.Tools.Clamp(1-this.emissiveColor.g),this._scaledDiffuse.b=this.diffuseColor.b*n.Tools.Clamp(1-this.emissiveColor.b),this._effect.setColor4("vDiffuseColor",this._scaledDiffuse,this.alpha*f.visibility),e.lightsEnabled)for(s=0,l=0;l<e.lights.length;l++)if(o=e.lights[l],o.isEnabled()&&o.canAffectMesh(f)&&((o instanceof n.PointLight?o.transferToEffect(this._effect,"vLightData"+s):o instanceof n.DirectionalLight?o.transferToEffect(this._effect,"vLightData"+s):o instanceof n.SpotLight?o.transferToEffect(this._effect,"vLightData"+s,"vLightDirection"+s):o instanceof n.HemisphericLight&&o.transferToEffect(this._effect,"vLightData"+s,"vLightGround"+s),o.diffuse.scaleToRef(o.intensity,this._scaledDiffuse),this._effect.setColor4("vLightDiffuse"+s,this._scaledDiffuse,o.range),this._defines.SPECULARTERM&&(o.specular.scaleToRef(o.intensity,this._scaledSpecular),this._effect.setColor3("vLightSpecular"+s,this._scaledSpecular)),e.shadowsEnabled)&&(h=o.getShadowGenerator(),f.receiveShadows&&h&&(this._effect.setMatrix("lightMatrix"+s,h.getTransformMatrix()),this._effect.setTexture("shadowSampler"+s,h.getShadowMapForRendering()),this._effect.setFloat3("shadowsInfo"+s,h.getDarkness(),h.getShadowMap().getSize().width,h.bias))),s++,s===t))break;(e.fogEnabled&&f.applyFog&&e.fogMode!==n.Scene.FOGMODE_NONE||this.reflectionTexture)&&this._effect.setMatrix("view",e.getViewMatrix());e.fogEnabled&&f.applyFog&&e.fogMode!==n.Scene.FOGMODE_NONE&&(this._effect.setFloat4("vFogInfos",e.fogMode,e.fogStart,e.fogEnd,e.fogDensity),this._effect.setColor3("vFogColor",e.fogColor));r.prototype.bind.call(this,i,f)},u.prototype.getAnimatables=function(){var n=[];return this.diffuseTexture&&this.diffuseTexture.animations&&this.diffuseTexture.animations.length>0&&n.push(this.diffuseTexture),this.ambientTexture&&this.ambientTexture.animations&&this.ambientTexture.animations.length>0&&n.push(this.ambientTexture),this.opacityTexture&&this.opacityTexture.animations&&this.opacityTexture.animations.length>0&&n.push(this.opacityTexture),this.reflectionTexture&&this.reflectionTexture.animations&&this.reflectionTexture.animations.length>0&&n.push(this.reflectionTexture),this.emissiveTexture&&this.emissiveTexture.animations&&this.emissiveTexture.animations.length>0&&n.push(this.emissiveTexture),this.specularTexture&&this.specularTexture.animations&&this.specularTexture.animations.length>0&&n.push(this.specularTexture),this.bumpTexture&&this.bumpTexture.animations&&this.bumpTexture.animations.length>0&&n.push(this.bumpTexture),n},u.prototype.dispose=function(n){this.diffuseTexture&&this.diffuseTexture.dispose();this.ambientTexture&&this.ambientTexture.dispose();this.opacityTexture&&this.opacityTexture.dispose();this.reflectionTexture&&this.reflectionTexture.dispose();this.emissiveTexture&&this.emissiveTexture.dispose();this.specularTexture&&this.specularTexture.dispose();this.bumpTexture&&this.bumpTexture.dispose();r.prototype.dispose.call(this,n)},u.prototype.clone=function(n){var t=new u(n,this.getScene());return t.checkReadyOnEveryCall=this.checkReadyOnEveryCall,t.alpha=this.alpha,t.fillMode=this.fillMode,t.backFaceCulling=this.backFaceCulling,this.diffuseTexture&&this.diffuseTexture.clone&&(t.diffuseTexture=this.diffuseTexture.clone()),this.ambientTexture&&this.ambientTexture.clone&&(t.ambientTexture=this.ambientTexture.clone()),this.opacityTexture&&this.opacityTexture.clone&&(t.opacityTexture=this.opacityTexture.clone()),this.reflectionTexture&&this.reflectionTexture.clone&&(t.reflectionTexture=this.reflectionTexture.clone()),this.emissiveTexture&&this.emissiveTexture.clone&&(t.emissiveTexture=this.emissiveTexture.clone()),this.specularTexture&&this.specularTexture.clone&&(t.specularTexture=this.specularTexture.clone()),this.bumpTexture&&this.bumpTexture.clone&&(t.bumpTexture=this.bumpTexture.clone()),t.ambientColor=this.ambientColor.clone(),t.diffuseColor=this.diffuseColor.clone(),t.specularColor=this.specularColor.clone(),t.specularPower=this.specularPower,t.emissiveColor=this.emissiveColor.clone(),t},u.DiffuseTextureEnabled=!0,u.AmbientTextureEnabled=!0,u.OpacityTextureEnabled=!0,u.ReflectionTextureEnabled=!0,u.EmissiveTextureEnabled=!0,u.SpecularTextureEnabled=!0,u.BumpTextureEnabled=!0,u.FresnelEnabled=!0,u}(n.Material);n.StandardMaterial=r}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i){n.call(this,t,i,!0);this.subMaterials=[];i.multiMaterials.push(this)}return __extends(t,n),t.prototype.getSubMaterial=function(n){return 0>n||n>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[n]},t.prototype.isReady=function(n){for(var i,t=0;t<this.subMaterials.length;t++)if(i=this.subMaterials[t],i&&!this.subMaterials[t].isReady(n))return!1;return!0},t.prototype.clone=function(n){for(var u,r=new t(n,this.getScene()),i=0;i<this.subMaterials.length;i++)u=this.subMaterials[i],r.subMaterials.push(u);return r},t}(n.Material);n.MultiMaterial=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){}return Object.defineProperty(t,"ForceFullSceneLoadingForIncremental",{get:function(){return t._ForceFullSceneLoadingForIncremental},set:function(n){t._ForceFullSceneLoadingForIncremental=n},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShowLoadingScreen",{get:function(){return t._ShowLoadingScreen},set:function(n){t._ShowLoadingScreen=n},enumerable:!0,configurable:!0}),t._getPluginForFilename=function(n){var f=n.lastIndexOf("."),i=n.indexOf("?"),u,t,r;for(-1===i&&(i=n.length),u=n.substring(f,i).toLowerCase(),t=0;t<this._registeredPlugins.length;t++)if(r=this._registeredPlugins[t],-1!==r.extensions.indexOf(u))return r;return this._registeredPlugins[this._registeredPlugins.length-1]},t.RegisterPlugin=function(n){n.extensions=n.extensions.toLowerCase();t._registeredPlugins.push(n)},t.ImportMesh=function(i,r,u,f,e,o,s){var h,c,l;if(u.substr&&"/"===u.substr(0,1))return void n.Tools.Error("Wrong sceneFilename parameter");h={};f._addPendingData(h);c=function(){f.database=l;var a=t._getPluginForFilename(u),c=function(n){var t=[],o=[],c=[];try{if(!a.importMesh(i,f,n,r,t,o,c))return s&&s(f,"Unable to import meshes from "+r+u),void f._removePendingData(h)}catch(l){return s&&s(f,"Unable to import meshes from "+r+u+" (Exception: "+l+")"),void f._removePendingData(h)}e&&(f.importedMeshesFiles.push(r+u),e(t,o,c),f._removePendingData(h))};return u.substr&&"data:"===u.substr(0,5)?void c(u.substr(5)):void n.Tools.LoadFile(r+u,function(n){c(n)},o,l)};f.getEngine().enableOfflineSupport?l=new n.Database(r+u,c):c(!0)},t.Load=function(i,r,u,f,e,o){t.Append(i,r,new n.Scene(u),f,e,o)},t.Append=function(i,r,u,f,e,o){var c,a,s,h,l;return r.substr&&"/"===r.substr(0,1)?void n.Tools.Error("Wrong sceneFilename parameter"):(a=this._getPluginForFilename(r.name||r),s={},u._addPendingData(s),t.ShowLoadingScreen&&u.getEngine().displayLoadingUI(),h=function(n){return u.database=c,a.load(u,n,i)?(f&&f(u),u._removePendingData(s),void(t.ShowLoadingScreen&&u.executeWhenReady(function(){u.getEngine().hideLoadingUI()}))):(o&&o(u),u._removePendingData(s),void u.getEngine().hideLoadingUI())},l=function(){n.Tools.LoadFile(i+r,h,e,c)},r.substr&&"data:"===r.substr(0,5)?void h(r.substr(5)):void(-1===i.indexOf("file:")?u.getEngine().enableOfflineSupport?c=new n.Database(i+r,l):l(!0):n.Tools.ReadFile(r,h,e)))},t._ForceFullSceneLoadingForIncremental=!1,t._ShowLoadingScreen=!0,t._registeredPlugins=[],t}();n.SceneLoader=t}(BABYLON||(BABYLON={}));!function(n){var t;!function(){var f=function(n,t){var r,i,u;if(n.length===3*t){for(r=[],i=0;i<n.length;i+=3)u=i/3*4,r[u]=n[i],r[u+1]=n[i+1],r[u+2]=n[i+2],r[u+3]=1;return r}return n},it=function(t,i,r){var u=null;return!i.name&&!i.extensions||i.isRenderTarget||(u=new n.CubeTexture(t+i.name,r,i.extensions),u.name=i.name,u.hasAlpha=i.hasAlpha,u.level=i.level,u.coordinatesMode=i.coordinatesMode),u},i=function(t,i,u){var f,e,o;if(i.isCube)return it(t,i,u);if(!i.name&&!i.isRenderTarget)return null;if(i.mirrorPlane?(f=new n.MirrorTexture(i.name,i.renderTargetSize,u),f._waitingRenderList=i.renderList,f.mirrorPlane=n.Plane.FromArray(i.mirrorPlane)):i.isRenderTarget?(f=new n.RenderTargetTexture(i.name,i.renderTargetSize,u),f._waitingRenderList=i.renderList):f=i.base64String?n.Texture.CreateFromBase64String(i.base64String,i.name,u):new n.Texture(t+i.name,u),f.name=i.name,f.hasAlpha=i.hasAlpha,f.getAlphaFromRGB=i.getAlphaFromRGB,f.level=i.level,f.coordinatesIndex=i.coordinatesIndex,f.coordinatesMode=i.coordinatesMode,f.uOffset=i.uOffset,f.vOffset=i.vOffset,f.uScale=i.uScale,f.vScale=i.vScale,f.uAng=i.uAng,f.vAng=i.vAng,f.wAng=i.wAng,f.wrapU=i.wrapU,f.wrapV=i.wrapV,i.animations)for(e=0;e<i.animations.length;e++)o=i.animations[e],f.animations.push(r(o));return f},e=function(t,i){for(var u,o,s,f=new n.Skeleton(t.name,t.id,i),e=0;e<t.bones.length;e++)u=t.bones[e],o=null,u.parentBoneIndex>-1&&(o=f.bones[u.parentBoneIndex]),s=new n.Bone(u.name,f,o,n.Matrix.FromArray(u.matrix)),u.animation&&s.animations.push(r(u.animation));return f},u=function(t){var i=new n.FresnelParameters;return i.isEnabled=t.isEnabled,i.leftColor=n.Color3.FromArray(t.leftColor),i.rightColor=n.Color3.FromArray(t.rightColor),i.bias=t.bias,i.power=t.power||1,i},o=function(t,r,f){var e;return e=new n.StandardMaterial(t.name,r),e.ambientColor=n.Color3.FromArray(t.ambient),e.diffuseColor=n.Color3.FromArray(t.diffuse),e.specularColor=n.Color3.FromArray(t.specular),e.specularPower=t.specularPower,e.emissiveColor=n.Color3.FromArray(t.emissive),e.useReflectionFresnelFromSpecular=t.useReflectionFresnelFromSpecular,e.useEmissiveAsIllumination=t.useEmissiveAsIllumination,e.alpha=t.alpha,e.id=t.id,t.disableDepthWrite&&(e.disableDepthWrite=t.disableDepthWrite),n.Tags.AddTagsTo(e,t.tags),e.backFaceCulling=t.backFaceCulling,e.wireframe=t.wireframe,t.diffuseTexture&&(e.diffuseTexture=i(f,t.diffuseTexture,r)),t.diffuseFresnelParameters&&(e.diffuseFresnelParameters=u(t.diffuseFresnelParameters)),t.ambientTexture&&(e.ambientTexture=i(f,t.ambientTexture,r)),t.opacityTexture&&(e.opacityTexture=i(f,t.opacityTexture,r)),t.opacityFresnelParameters&&(e.opacityFresnelParameters=u(t.opacityFresnelParameters)),t.reflectionTexture&&(e.reflectionTexture=i(f,t.reflectionTexture,r)),t.reflectionFresnelParameters&&(e.reflectionFresnelParameters=u(t.reflectionFresnelParameters)),t.emissiveTexture&&(e.emissiveTexture=i(f,t.emissiveTexture,r)),t.emissiveFresnelParameters&&(e.emissiveFresnelParameters=u(t.emissiveFresnelParameters)),t.specularTexture&&(e.specularTexture=i(f,t.specularTexture,r)),t.bumpTexture&&(e.bumpTexture=i(f,t.bumpTexture,r)),t.checkReadyOnlyOnce&&(e.checkReadyOnlyOnce=t.checkReadyOnlyOnce),e},s=function(n,t,i,r){for(var f,u=0;u<t.materials.length;u++)if(f=t.materials[u],f.id===n)return o(f,i,r);return null},h=function(t,i){var r=new n.MultiMaterial(t.name,i),u,f;for(r.id=t.id,n.Tags.AddTagsTo(r,t.tags),u=0;u<t.materials.length;u++)f=t.materials[u],r.subMaterials.push(f?i.getMaterialByID(f):null);return r},rt=function(t,i,r){var o=i.getLastEntryByID(t.emitterId),e=new n.LensFlareSystem("lensFlareSystem#"+t.emitterId,o,i),f,u;for(e.borderLimit=t.borderLimit,f=0;f<t.flares.length;f++)u=t.flares[f],new n.LensFlare(u.size,u.position,n.Color3.FromArray(u.color),r+u.textureName,e);return e},c=function(t,i,r){var f=i.getLastMeshByID(t.emitterId),u=new n.ParticleSystem("particles#"+f.name,t.capacity,i);return t.textureName&&(u.particleTexture=new n.Texture(r+t.textureName,i),u.particleTexture.name=t.textureName),u.minAngularSpeed=t.minAngularSpeed,u.maxAngularSpeed=t.maxAngularSpeed,u.minSize=t.minSize,u.maxSize=t.maxSize,u.minLifeTime=t.minLifeTime,u.maxLifeTime=t.maxLifeTime,u.emitter=f,u.emitRate=t.emitRate,u.minEmitBox=n.Vector3.FromArray(t.minEmitBox),u.maxEmitBox=n.Vector3.FromArray(t.maxEmitBox),u.gravity=n.Vector3.FromArray(t.gravity),u.direction1=n.Vector3.FromArray(t.direction1),u.direction2=n.Vector3.FromArray(t.direction2),u.color1=n.Color4.FromArray(t.color1),u.color2=n.Color4.FromArray(t.color2),u.colorDead=n.Color4.FromArray(t.colorDead),u.updateSpeed=t.updateSpeed,u.targetStopDuration=t.targetStopFrame,u.textureMask=n.Color4.FromArray(t.textureMask),u.blendMode=t.blendMode,u.start(),u},ut=function(t,i){for(var f,e=i.getLightByID(t.lightId),r=new n.ShadowGenerator(t.mapSize,e),u=0;u<t.renderList.length;u++)f=i.getMeshByID(t.renderList[u]),r.getShadowMap().renderList.push(f);return t.usePoissonSampling?r.usePoissonSampling=!0:t.useVarianceShadowMap?r.useVarianceShadowMap=!0:t.useBlurVarianceShadowMap&&(r.useBlurVarianceShadowMap=!0,t.blurScale&&(r.blurScale=t.blurScale),t.blurBoxOffset&&(r.blurBoxOffset=t.blurBoxOffset)),void 0!==t.bias&&(r.bias=t.bias),r},r=function(t){for(var r,i,f=new n.Animation(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),o=t.dataType,e=[],u=0;u<t.keys.length;u++){i=t.keys[u];switch(o){case n.Animation.ANIMATIONTYPE_FLOAT:r=i.values[0];break;case n.Animation.ANIMATIONTYPE_QUATERNION:r=n.Quaternion.FromArray(i.values);break;case n.Animation.ANIMATIONTYPE_MATRIX:r=n.Matrix.FromArray(i.values);break;case n.Animation.ANIMATIONTYPE_VECTOR3:default:r=n.Vector3.FromArray(i.values)}e.push({frame:i.frame,value:r})}return f.setKeys(e),f},ft=function(t,i){var u,f,e;switch(t.type){case 0:u=new n.PointLight(t.name,n.Vector3.FromArray(t.position),i);break;case 1:u=new n.DirectionalLight(t.name,n.Vector3.FromArray(t.direction),i);u.position=n.Vector3.FromArray(t.position);break;case 2:u=new n.SpotLight(t.name,n.Vector3.FromArray(t.position),n.Vector3.FromArray(t.direction),t.angle,t.exponent,i);break;case 3:u=new n.HemisphericLight(t.name,n.Vector3.FromArray(t.direction),i);u.groundColor=n.Color3.FromArray(t.groundColor)}if(u.id=t.id,n.Tags.AddTagsTo(u,t.tags),void 0!==t.intensity&&(u.intensity=t.intensity),t.range&&(u.range=t.range),u.diffuse=n.Color3.FromArray(t.diffuse),u.specular=n.Color3.FromArray(t.specular),t.excludedMeshesIds&&(u._excludedMeshesIds=t.excludedMeshesIds),t.parentId&&(u._waitingParentId=t.parentId),t.includedOnlyMeshesIds&&(u._includedOnlyMeshesIds=t.includedOnlyMeshesIds),t.animations)for(f=0;f<t.animations.length;f++)e=t.animations[f],u.animations.push(r(e));t.autoAnimate&&i.beginAnimation(u,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,1)},et=function(t,i){var u,f=n.Vector3.FromArray(t.position),e=t.lockedTargetId?i.getLastMeshByID(t.lockedTargetId):null,o,a,s,v;if("AnaglyphArcRotateCamera"===t.type||"ArcRotateCamera"===t.type){var h=t.alpha,c=t.beta,l=t.radius;"AnaglyphArcRotateCamera"===t.type?(o=t.interaxial_distance,u=new n.AnaglyphArcRotateCamera(t.name,h,c,l,e,o,i)):u=new n.ArcRotateCamera(t.name,h,c,l,e,i)}else"AnaglyphFreeCamera"===t.type?(o=t.interaxial_distance,u=new n.AnaglyphFreeCamera(t.name,f,o,i)):"DeviceOrientationCamera"===t.type?u=new n.DeviceOrientationCamera(t.name,f,i):"FollowCamera"===t.type?(u=new n.FollowCamera(t.name,f,i),u.heightOffset=t.heightOffset,u.radius=t.radius,u.rotationOffset=t.rotationOffset,e&&(u.target=e)):u="GamepadCamera"===t.type?new n.GamepadCamera(t.name,f,i):"TouchCamera"===t.type?new n.TouchCamera(t.name,f,i):"VirtualJoysticksCamera"===t.type?new n.VirtualJoysticksCamera(t.name,f,i):"WebVRFreeCamera"===t.type?new n.WebVRFreeCamera(t.name,f,i):"VRDeviceOrientationFreeCamera"===t.type?new n.VRDeviceOrientationFreeCamera(t.name,f,i):new n.FreeCamera(t.name,f,i);if(t.cameraRigMode&&(a=t.interaxial_distance?{interaxialDistance:t.interaxial_distance}:{},u.setCameraRigMode(t.cameraRigMode,a)),e&&u instanceof n.FreeCamera&&(u.lockedTarget=e),u.id=t.id,n.Tags.AddTagsTo(u,t.tags),t.parentId&&(u._waitingParentId=t.parentId),t.target?u.setTarget?u.setTarget(n.Vector3.FromArray(t.target)):u.target=n.Vector3.FromArray(t.target):u.rotation=n.Vector3.FromArray(t.rotation),u.fov=t.fov,u.minZ=t.minZ,u.maxZ=t.maxZ,u.speed=t.speed,u.inertia=t.inertia,u.checkCollisions=t.checkCollisions,u.applyGravity=t.applyGravity,t.ellipsoid&&(u.ellipsoid=n.Vector3.FromArray(t.ellipsoid)),t.animations)for(s=0;s<t.animations.length;s++)v=t.animations[s],u.animations.push(r(v));return t.autoAnimate&&i.beginAnimation(u,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,1),u.layerMask=t.layerMask&&!isNaN(t.layerMask)?Math.abs(parseInt(t.layerMask)):268435455,u},t=function(n,t){var i=n.id;return t.getGeometryByID(i)},l=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Box(i.id,r,i.size,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},a=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Sphere(i.id,r,i.segments,i.diameter,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},v=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Cylinder(i.id,r,i.height,i.diameterTop,i.diameterBottom,i.tessellation,i.subdivisions,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},y=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Torus(i.id,r,i.diameter,i.thickness,i.tessellation,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},p=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Ground(i.id,r,i.width,i.height,i.subdivisions,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},w=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.Plane(i.id,r,i.size,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},b=function(i,r){if(t(i,r))return null;var u=new n.Geometry.Primitives.TorusKnot(i.id,r,i.radius,i.tube,i.radialSegments,i.tubularSegments,i.p,i.q,i.canBeRegenerated,null);return n.Tags.AddTagsTo(u,i.tags),r.pushGeometry(u,!0),u},k=function(i,r,u){if(t(i,r))return null;var f=new n.Geometry(i.id,r);return n.Tags.AddTagsTo(f,i.tags),i.delayLoadingFile?(f.delayLoadState=n.Engine.DELAYLOADSTATE_NOTLOADED,f.delayLoadingFile=u+i.delayLoadingFile,f._boundingInfo=new n.BoundingInfo(n.Vector3.FromArray(i.boundingBoxMinimum),n.Vector3.FromArray(i.boundingBoxMaximum)),f._delayInfo=[],i.hasUVs&&f._delayInfo.push(n.VertexBuffer.UVKind),i.hasUVs2&&f._delayInfo.push(n.VertexBuffer.UV2Kind),i.hasUVs3&&f._delayInfo.push(n.VertexBuffer.UV3Kind),i.hasUVs4&&f._delayInfo.push(n.VertexBuffer.UV4Kind),i.hasUVs5&&f._delayInfo.push(n.VertexBuffer.UV5Kind),i.hasUVs6&&f._delayInfo.push(n.VertexBuffer.UV6Kind),i.hasColors&&f._delayInfo.push(n.VertexBuffer.ColorKind),i.hasMatricesIndices&&f._delayInfo.push(n.VertexBuffer.MatricesIndicesKind),i.hasMatricesWeights&&f._delayInfo.push(n.VertexBuffer.MatricesWeightsKind),f._delayLoadingFunction=nt):nt(i,f),r.pushGeometry(f,!0),f},d=function(t,i,u){var f=new n.Mesh(t.name,i),o,h,c,e,s;if(f.id=t.id,n.Tags.AddTagsTo(f,t.tags),f.position=n.Vector3.FromArray(t.position),t.rotationQuaternion?f.rotationQuaternion=n.Quaternion.FromArray(t.rotationQuaternion):t.rotation&&(f.rotation=n.Vector3.FromArray(t.rotation)),f.scaling=n.Vector3.FromArray(t.scaling),t.localMatrix?f.setPivotMatrix(n.Matrix.FromArray(t.localMatrix)):t.pivotMatrix&&f.setPivotMatrix(n.Matrix.FromArray(t.pivotMatrix)),f.setEnabled(t.isEnabled),f.isVisible=t.isVisible,f.infiniteDistance=t.infiniteDistance,f.showBoundingBox=t.showBoundingBox,f.showSubMeshesBoundingBox=t.showSubMeshesBoundingBox,void 0!==t.applyFog&&(f.applyFog=t.applyFog),void 0!==t.pickable&&(f.isPickable=t.pickable),void 0!==t.alphaIndex&&(f.alphaIndex=t.alphaIndex),f.receiveShadows=t.receiveShadows,f.billboardMode=t.billboardMode,void 0!==t.visibility&&(f.visibility=t.visibility),f.checkCollisions=t.checkCollisions,f._shouldGenerateFlatShading=t.useFlatShading,t.freezeWorldMatrix&&(f._waitingFreezeWorldMatrix=t.freezeWorldMatrix),t.parentId&&(f._waitingParentId=t.parentId),void 0!==t.actions&&(f._waitingActions=t.actions),f.hasVertexAlpha=t.hasVertexAlpha,t.delayLoadingFile?(f.delayLoadState=n.Engine.DELAYLOADSTATE_NOTLOADED,f.delayLoadingFile=u+t.delayLoadingFile,f._boundingInfo=new n.BoundingInfo(n.Vector3.FromArray(t.boundingBoxMinimum),n.Vector3.FromArray(t.boundingBoxMaximum)),t._binaryInfo&&(f._binaryInfo=t._binaryInfo),f._delayInfo=[],t.hasUVs&&f._delayInfo.push(n.VertexBuffer.UVKind),t.hasUVs2&&f._delayInfo.push(n.VertexBuffer.UV2Kind),t.hasUVs3&&f._delayInfo.push(n.VertexBuffer.UV3Kind),t.hasUVs4&&f._delayInfo.push(n.VertexBuffer.UV4Kind),t.hasUVs5&&f._delayInfo.push(n.VertexBuffer.UV5Kind),t.hasUVs6&&f._delayInfo.push(n.VertexBuffer.UV6Kind),t.hasColors&&f._delayInfo.push(n.VertexBuffer.ColorKind),t.hasMatricesIndices&&f._delayInfo.push(n.VertexBuffer.MatricesIndicesKind),t.hasMatricesWeights&&f._delayInfo.push(n.VertexBuffer.MatricesWeightsKind),f._delayLoadingFunction=tt,n.SceneLoader.ForceFullSceneLoadingForIncremental&&f._checkDelayState()):tt(t,f),t.materialId?f.setMaterialByID(t.materialId):f.material=null,t.skeletonId>-1&&(f.skeleton=i.getLastSkeletonByID(t.skeletonId)),t.physicsImpostor&&(i.isPhysicsEnabled()||i.enablePhysics(),f.setPhysicsState({impostor:t.physicsImpostor,mass:t.physicsMass,friction:t.physicsFriction,restitution:t.physicsRestitution})),t.animations)for(o=0;o<t.animations.length;o++)h=t.animations[o],f.animations.push(r(h));if(t.autoAnimate&&i.beginAnimation(f,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,1),f.layerMask=t.layerMask&&!isNaN(t.layerMask)?Math.abs(parseInt(t.layerMask)):268435455,t.instances)for(c=0;c<t.instances.length;c++)if(e=t.instances[c],s=f.createInstance(e.name),n.Tags.AddTagsTo(s,e.tags),s.position=n.Vector3.FromArray(e.position),e.rotationQuaternion?s.rotationQuaternion=n.Quaternion.FromArray(e.rotationQuaternion):e.rotation&&(s.rotation=n.Vector3.FromArray(e.rotation)),s.scaling=n.Vector3.FromArray(e.scaling),s.checkCollisions=f.checkCollisions,t.animations)for(o=0;o<t.animations.length;o++)h=t.animations[o],s.animations.push(r(h));return f},g=function(t,i,r){var f=new n.ActionManager(r),h,u,c,l,e;null===i?r.actionManager=f:i.actionManager=f;for(var a=function(t,i){var r=Object.create(n[t].prototype);return r.constructor.apply(r,i),r},v=function(t,i,r,u){var s,e,f;if(null===u)return s=parseFloat(i),"true"===i||"false"===i?"true"===i:isNaN(s)?i:s;for(var h=u.split("."),o=i.split(","),f=0;f<h.length;f++)r=r[h[f]];if("boolean"==typeof r)return"true"===o[0];if("string"==typeof r)return o[0];for(e=[],f=0;f<o.length;f++)e.push(parseFloat(o[f]));return r instanceof n.Vector3?n.Vector3.FromArray(e):r instanceof n.Vector4?n.Vector4.FromArray(e):r instanceof n.Color3?n.Color3.FromArray(e):r instanceof n.Color4?n.Color4.FromArray(e):parseFloat(o[0])},o=function(t,i,u,e,s){var b,w,nt,y,l;if(void 0===s&&(s=null),!t.detached){var h=[],k=null,d=null,tt=t.combine&&t.combine.length>0;if(h.push(2===t.type?f:i),tt){for(b=[],w=0;w<t.combine.length;w++)o(t.combine[w],n.ActionManager.NothingTrigger,u,e,b);h.push(b)}else for(l=0;l<t.properties.length;l++){var c=t.properties[l].value,p=t.properties[l].name,g=t.properties[l].targetType;"target"===p?c=k=null!==g&&"SceneProperties"===g?r:r.getNodeByName(c):"parent"===p?c=r.getNodeByName(c):"sound"===p?c=r.getSoundByName(c):"propertyPath"!==p?c=2===t.type&&"operator"===p?n.ValueCondition[c]:v(p,c,k,"value"===p?d:null):d=c;h.push(c)}for((h.push(null===s?u:null),"InterpolateValueAction"===t.name)&&(nt=h[h.length-2],h[h.length-1]=nt,h[h.length-2]=u),y=a(t.name,h),null===s?y instanceof n.Condition?(u=y,y=e):(u=null,e?e.then(y):f.registerAction(y)):s.push(y),l=0;l<t.children.length;l++)o(t.children[l],i,u,y,null)}},s=0;s<t.children.length;s++)for(u=t.children[s],u.properties.length>0?(c=u.properties[0].value,l=null===u.properties[0].targetType?c:r.getMeshByName(c),h={trigger:n.ActionManager[u.name],parameter:l}):h=n.ActionManager[u.name],e=0;e<u.children.length;e++)u.detached||o(u.children[e],h,null,null)},ot=function(t,i,r){var e=t.name,h=r+e,c={autoplay:t.autoplay,loop:t.loop,volume:t.volume,spatialSound:t.spatialSound,maxDistance:t.maxDistance,rolloffFactor:t.rolloffFactor,refDistance:t.refDistance,distanceModel:t.distanceModel,playbackRate:t.playbackRate},u=new n.Sound(e,h,i,function(){i._removePendingData(u)},c),o,s,f;(i._addPendingData(u),t.position)&&(o=n.Vector3.FromArray(t.position),u.setPosition(o));t.isDirectional&&(u.setDirectionalCone(t.coneInnerAngle||360,t.coneOuterAngle||360,t.coneOuterGain||0),t.localDirectionToMesh)&&(s=n.Vector3.FromArray(t.localDirectionToMesh),u.setLocalDirectionToMesh(s));t.connectedMeshId&&(f=i.getMeshByID(t.connectedMeshId),f&&u.attachToMesh(f))},st=function(n,t,i){t=t instanceof Array?t:[t];for(var r in t)if(n.name===t[r])return i.push(n.id),!0;return n.parentId&&-1!==i.indexOf(n.parentId)?(i.push(n.id),!0):!1},nt=function(t,i){var r=new n.VertexData,u=t.positions,e,o,s,h,c,l,a,v,y,p,w;u&&r.set(u,n.VertexBuffer.PositionKind);e=t.normals;e&&r.set(e,n.VertexBuffer.NormalKind);o=t.uvs;o&&r.set(o,n.VertexBuffer.UVKind);s=t.uv2s;s&&r.set(s,n.VertexBuffer.UV2Kind);h=t.uv3s;h&&r.set(h,n.VertexBuffer.UV3Kind);c=t.uv4s;c&&r.set(c,n.VertexBuffer.UV4Kind);l=t.uv5s;l&&r.set(l,n.VertexBuffer.UV5Kind);a=t.uv6s;a&&r.set(a,n.VertexBuffer.UV6Kind);v=t.colors;v&&r.set(f(v,u.length/3),n.VertexBuffer.ColorKind);y=t.matricesIndices;y&&r.set(y,n.VertexBuffer.MatricesIndicesKind);p=t.matricesWeights;p&&r.set(p,n.VertexBuffer.MatricesWeightsKind);w=t.indices;w&&(r.indices=w);i.setAllVerticesData(r,t.updatable)},tt=function(t,i){var l=i.getScene(),v=t.geometryId,a,r,y,p,w,b,k,d,g,nt,tt,it,rt,ut,e,o,u,h,c,s;if(v)a=l.getGeometryByID(v),a&&a.applyToMesh(i);else if(t instanceof ArrayBuffer){if(r=i._binaryInfo,r.positionsAttrDesc&&r.positionsAttrDesc.count>0&&(y=new Float32Array(t,r.positionsAttrDesc.offset,r.positionsAttrDesc.count),i.setVerticesData(n.VertexBuffer.PositionKind,y,!1)),r.normalsAttrDesc&&r.normalsAttrDesc.count>0&&(p=new Float32Array(t,r.normalsAttrDesc.offset,r.normalsAttrDesc.count),i.setVerticesData(n.VertexBuffer.NormalKind,p,!1)),r.uvsAttrDesc&&r.uvsAttrDesc.count>0&&(w=new Float32Array(t,r.uvsAttrDesc.offset,r.uvsAttrDesc.count),i.setVerticesData(n.VertexBuffer.UVKind,w,!1)),r.uvs2AttrDesc&&r.uvs2AttrDesc.count>0&&(b=new Float32Array(t,r.uvs2AttrDesc.offset,r.uvs2AttrDesc.count),i.setVerticesData(n.VertexBuffer.UV2Kind,b,!1)),r.uvs3AttrDesc&&r.uvs3AttrDesc.count>0&&(k=new Float32Array(t,r.uvs3AttrDesc.offset,r.uvs3AttrDesc.count),i.setVerticesData(n.VertexBuffer.UV3Kind,k,!1)),r.uvs4AttrDesc&&r.uvs4AttrDesc.count>0&&(d=new Float32Array(t,r.uvs4AttrDesc.offset,r.uvs4AttrDesc.count),i.setVerticesData(n.VertexBuffer.UV4Kind,d,!1)),r.uvs5AttrDesc&&r.uvs5AttrDesc.count>0&&(g=new Float32Array(t,r.uvs5AttrDesc.offset,r.uvs5AttrDesc.count),i.setVerticesData(n.VertexBuffer.UV5Kind,g,!1)),r.uvs6AttrDesc&&r.uvs6AttrDesc.count>0&&(nt=new Float32Array(t,r.uvs6AttrDesc.offset,r.uvs6AttrDesc.count),i.setVerticesData(n.VertexBuffer.UV6Kind,nt,!1)),r.colorsAttrDesc&&r.colorsAttrDesc.count>0&&(tt=new Float32Array(t,r.colorsAttrDesc.offset,r.colorsAttrDesc.count),i.setVerticesData(n.VertexBuffer.ColorKind,tt,!1,r.colorsAttrDesc.stride)),r.matricesIndicesAttrDesc&&r.matricesIndicesAttrDesc.count>0&&(it=new Int32Array(t,r.matricesIndicesAttrDesc.offset,r.matricesIndicesAttrDesc.count),i.setVerticesData(n.VertexBuffer.MatricesIndicesKind,it,!1)),r.matricesWeightsAttrDesc&&r.matricesWeightsAttrDesc.count>0&&(rt=new Float32Array(t,r.matricesWeightsAttrDesc.offset,r.matricesWeightsAttrDesc.count),i.setVerticesData(n.VertexBuffer.MatricesWeightsKind,rt,!1)),r.indicesAttrDesc&&r.indicesAttrDesc.count>0&&(ut=new Int32Array(t,r.indicesAttrDesc.offset,r.indicesAttrDesc.count),i.setIndices(ut)),r.subMeshesAttrDesc&&r.subMeshesAttrDesc.count>0)for(e=new Int32Array(t,r.subMeshesAttrDesc.offset,5*r.subMeshesAttrDesc.count),i.subMeshes=[],u=0;u<r.subMeshesAttrDesc.count;u++){var ft=e[5*u+0],et=e[5*u+1],ot=e[5*u+2],st=e[5*u+3],ht=e[5*u+4];new n.SubMesh(ft,et,ot,st,ht,i)}}else if(t.positions&&t.normals&&t.indices){if(i.setVerticesData(n.VertexBuffer.PositionKind,t.positions,!1),i.setVerticesData(n.VertexBuffer.NormalKind,t.normals,!1),t.uvs&&i.setVerticesData(n.VertexBuffer.UVKind,t.uvs,!1),t.uvs2&&i.setVerticesData(n.VertexBuffer.UV2Kind,t.uvs2,!1),t.uvs3&&i.setVerticesData(n.VertexBuffer.UV3Kind,t.uvs3,!1),t.uvs4&&i.setVerticesData(n.VertexBuffer.UV4Kind,t.uvs4,!1),t.uvs5&&i.setVerticesData(n.VertexBuffer.UV5Kind,t.uvs5,!1),t.uvs6&&i.setVerticesData(n.VertexBuffer.UV6Kind,t.uvs6,!1),t.colors&&i.setVerticesData(n.VertexBuffer.ColorKind,f(t.colors,t.positions.length/3),!1),t.matricesIndices)if(t.matricesIndices._isExpanded)delete t.matricesIndices._isExpanded,i.setVerticesData(n.VertexBuffer.MatricesIndicesKind,t.matricesIndices,!1);else{for(o=[],u=0;u<t.matricesIndices.length;u++)h=t.matricesIndices[u],o.push(255&h),o.push((65280&h)>>8),o.push((16711680&h)>>16),o.push(h>>24);i.setVerticesData(n.VertexBuffer.MatricesIndicesKind,o,!1)}t.matricesWeights&&i.setVerticesData(n.VertexBuffer.MatricesWeightsKind,t.matricesWeights,!1);i.setIndices(t.indices)}if(t.subMeshes)for(i.subMeshes=[],c=0;c<t.subMeshes.length;c++)s=t.subMeshes[c],new n.SubMesh(s.materialIndex,s.verticesStart,s.verticesCount,s.indexStart,s.indexCount,i);i._shouldGenerateFlatShading&&(i.convertToFlatShadedMesh(),delete i._shouldGenerateFlatShading);i.computeWorldMatrix(!0);l._selectionOctree&&l._selectionOctree.addMesh(i)};n.SceneLoader.RegisterPlugin({extensions:".babylon",importMesh:function(t,i,r,u,f,o,g){for(var tt,et,ot,ht,ut,ct,vt,bt,lt,at,kt,rt,yt,nt=JSON.parse(r),pt=[],ft=[],wt=[],it=0;it<nt.meshes.length;it++)if(tt=nt.meshes[it],!t||st(tt,t,wt)){if((t instanceof Array&&delete t[t.indexOf(tt.name)],tt.geometryId&&nt.geometries)&&(et=!1,["boxes","spheres","cylinders","toruses","grounds","planes","torusKnots","vertexData"].forEach(function(n){!et&&nt.geometries[n]&&nt.geometries[n]instanceof Array&&nt.geometries[n].forEach(function(t){if(t.id==tt.geometryId){switch(n){case"boxes":l(t,i);break;case"spheres":a(t,i);break;case"cylinders":v(t,i);break;case"toruses":y(t,i);break;case"grounds":p(t,i);break;case"planes":w(t,i);break;case"torusKnots":b(t,i);break;case"vertexData":k(t,i,u)}et=!0}})}),et||n.Tools.Warn("Geometry not found for mesh "+tt.id)),tt.materialId){if(ot=-1!==ft.indexOf(tt.materialId),!ot&&nt.multiMaterials)for(ht=0;ht<nt.multiMaterials.length;ht++)if(ut=nt.multiMaterials[ht],ut.id==tt.materialId){for(ct=0;ct<ut.materials.length;ct++)vt=ut.materials[ct],ft.push(vt),s(vt,nt,i,u);ft.push(ut.id);h(ut,i);ot=!0;break}ot||(ft.push(tt.materialId),s(tt.materialId,nt,i,u)||n.Tools.Warn("Material not found for mesh "+tt.id))}if(tt.skeletonId>-1&&i.skeletons&&(bt=pt.indexOf(tt.skeletonId)>-1,!bt))for(lt=0;lt<nt.skeletons.length;lt++)at=nt.skeletons[lt],at.id===tt.skeletonId&&(g.push(e(at,i)),pt.push(at.id));kt=d(tt,i,u);f.push(kt)}for(it=0;it<i.meshes.length;it++)rt=i.meshes[it],rt._waitingParentId&&(rt.parent=i.getLastEntryByID(rt._waitingParentId),rt._waitingParentId=void 0);for(it=0;it<i.meshes.length;it++)rt=i.meshes[it],rt._waitingFreezeWorldMatrix&&(rt.freezeWorldMatrix(),rt._waitingFreezeWorldMatrix=void 0);if(nt.particleSystems)for(it=0;it<nt.particleSystems.length;it++)yt=nt.particleSystems[it],-1!==wt.indexOf(yt.emitterId)&&o.push(c(yt,i,u));return!0},load:function(t,i,r){var f=JSON.parse(i),u,kt,dt,gt,ni,s,st,ti,ht,ii,ct,ri,lt,ui,at,fi,vt,ei,yt,oi,pt,si,hi,ci,tt,it,bt,nt,wt,li,ai,vi;for(t.useDelayedTextureLoading=f.useDelayedTextureLoading&&!n.SceneLoader.ForceFullSceneLoadingForIncremental,t.autoClear=f.autoClear,t.clearColor=n.Color3.FromArray(f.clearColor),t.ambientColor=n.Color3.FromArray(f.ambientColor),t.gravity=n.Vector3.FromArray(f.gravity),f.fogMode&&0!==f.fogMode&&(t.fogMode=f.fogMode,t.fogColor=n.Color3.FromArray(f.fogColor),t.fogStart=f.fogStart,t.fogEnd=f.fogEnd,t.fogDensity=f.fogDensity),u=0;u<f.lights.length;u++)kt=f.lights[u],ft(kt,t);if(f.materials)for(u=0;u<f.materials.length;u++)dt=f.materials[u],o(dt,t,r);if(f.multiMaterials)for(u=0;u<f.multiMaterials.length;u++)gt=f.multiMaterials[u],h(gt,t);if(f.skeletons)for(u=0;u<f.skeletons.length;u++)ni=f.skeletons[u],e(ni,t);if(s=f.geometries,s){if(st=s.boxes,st)for(u=0;u<st.length;u++)ti=st[u],l(ti,t);if(ht=s.spheres,ht)for(u=0;u<ht.length;u++)ii=ht[u],a(ii,t);if(ct=s.cylinders,ct)for(u=0;u<ct.length;u++)ri=ct[u],v(ri,t);if(lt=s.toruses,lt)for(u=0;u<lt.length;u++)ui=lt[u],y(ui,t);if(at=s.grounds,at)for(u=0;u<at.length;u++)fi=at[u],p(fi,t);if(vt=s.planes,vt)for(u=0;u<vt.length;u++)ei=vt[u],w(ei,t);if(yt=s.torusKnots,yt)for(u=0;u<yt.length;u++)oi=yt[u],b(oi,t);if(pt=s.vertexData,pt)for(u=0;u<pt.length;u++)si=pt[u],k(si,t,r)}for(u=0;u<f.meshes.length;u++)hi=f.meshes[u],d(hi,t,r);for(u=0;u<f.cameras.length;u++)ci=f.cameras[u],et(ci,t);for(f.activeCameraID&&t.setActiveCameraByID(f.activeCameraID),u=0;u<t.cameras.length;u++)tt=t.cameras[u],tt._waitingParentId&&(tt.parent=t.getLastEntryByID(tt._waitingParentId),tt._waitingParentId=void 0);for(u=0;u<t.lights.length;u++)it=t.lights[u],it._waitingParentId&&(it.parent=t.getLastEntryByID(it._waitingParentId),it._waitingParentId=void 0);if(f.sounds)for(u=0;u<f.sounds.length;u++)bt=f.sounds[u],n.Engine.audioEngine.canUseWebAudio?ot(bt,t,r):new n.Sound(bt.name,null,t);for(u=0;u<t.meshes.length;u++)nt=t.meshes[u],nt._waitingParentId&&(nt.parent=t.getLastEntryByID(nt._waitingParentId),nt._waitingParentId=void 0),nt._waitingActions&&(g(nt._waitingActions,nt,t),nt._waitingActions=void 0);for(u=0;u<t.meshes.length;u++)wt=t.meshes[u],wt._waitingFreezeWorldMatrix&&(wt.freezeWorldMatrix(),wt._waitingFreezeWorldMatrix=void 0);if(f.particleSystems)for(u=0;u<f.particleSystems.length;u++)li=f.particleSystems[u],c(li,t,r);if(f.lensFlareSystems)for(u=0;u<f.lensFlareSystems.length;u++)ai=f.lensFlareSystems[u],rt(ai,t,r);if(f.shadowGenerators)for(u=0;u<f.shadowGenerators.length;u++)vi=f.shadowGenerators[u],ut(vi,t);return f.actions&&g(f.actions,null,t),!0}})}(t=n.Internals||(n.Internals={}))}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f,e,o){void 0===o&&(o=n.Texture.TRILINEAR_SAMPLINGMODE);this.name=t;this.cellSize=u;this.sprites=[];this.renderingGroupId=0;this.layerMask=268435455;this.fogEnabled=!0;this._vertexDeclaration=[4,4,4,4];this._vertexStrideSize=64;this._capacity=r;this._spriteTexture=new n.Texture(i,f,!0,!1,o);this._spriteTexture.wrapU=n.Texture.CLAMP_ADDRESSMODE;this._spriteTexture.wrapV=n.Texture.CLAMP_ADDRESSMODE;this._epsilon=void 0===e?.01:e;this._scene=f;this._scene.spriteManagers.push(this);this._vertexBuffer=f.getEngine().createDynamicVertexBuffer(r*this._vertexStrideSize*4);for(var s=[],h=0,c=0;r>c;c++)s.push(h),s.push(h+1),s.push(h+2),s.push(h),s.push(h+2),s.push(h+3),h+=4;this._indexBuffer=f.getEngine().createIndexBuffer(s);this._vertices=new Float32Array(r*this._vertexStrideSize);this._effectBase=this._scene.getEngine().createEffect("sprites",["position","options","cellInfo","color"],["view","projection","textureInfos","alphaTest"],["diffuseSampler"],"");this._effectFog=this._scene.getEngine().createEffect("sprites",["position","options","cellInfo","color"],["view","projection","textureInfos","alphaTest","vFogInfos","vFogColor"],["diffuseSampler"],"#define FOG")}return t.prototype._appendSpriteVertex=function(n,t,i,r,u){var f=16*n,e;0===i?i=this._epsilon:1===i&&(i=1-this._epsilon);0===r?r=this._epsilon:1===r&&(r=1-this._epsilon);this._vertices[f]=t.position.x;this._vertices[f+1]=t.position.y;this._vertices[f+2]=t.position.z;this._vertices[f+3]=t.angle;this._vertices[f+4]=t.width;this._vertices[f+5]=t.height;this._vertices[f+6]=i;this._vertices[f+7]=r;this._vertices[f+8]=t.invertU?1:0;this._vertices[f+9]=t.invertV?1:0;e=t.cellIndex/u>>0;this._vertices[f+10]=t.cellIndex-e*u;this._vertices[f+11]=e;this._vertices[f+12]=t.color.r;this._vertices[f+13]=t.color.g;this._vertices[f+14]=t.color.b;this._vertices[f+15]=t.color.a},t.prototype.render=function(){var r,t,h;if(this._effectBase.isReady()&&this._effectFog.isReady()&&this._spriteTexture&&this._spriteTexture.isReady()){for(var i=this._scene.getEngine(),e=this._spriteTexture.getBaseSize(),c=i.getDeltaTime(),o=Math.min(this._capacity,this.sprites.length),u=e.width/this.cellSize,f=0,s=0;o>s;s++)r=this.sprites[s],r&&(r._animate(c),this._appendSpriteVertex(f++,r,0,0,u),this._appendSpriteVertex(f++,r,1,0,u),this._appendSpriteVertex(f++,r,1,1,u),this._appendSpriteVertex(f++,r,0,1,u));i.updateDynamicVertexBuffer(this._vertexBuffer,this._vertices);t=this._effectBase;this._scene.fogEnabled&&this._scene.fogMode!==n.Scene.FOGMODE_NONE&&this.fogEnabled&&(t=this._effectFog);i.enableEffect(t);h=this._scene.getViewMatrix();t.setTexture("diffuseSampler",this._spriteTexture);t.setMatrix("view",h);t.setMatrix("projection",this._scene.getProjectionMatrix());t.setFloat2("textureInfos",this.cellSize/e.width,this.cellSize/e.height);this._scene.fogEnabled&&this._scene.fogMode!==n.Scene.FOGMODE_NONE&&this.fogEnabled&&(t.setFloat4("vFogInfos",this._scene.fogMode,this._scene.fogStart,this._scene.fogEnd,this._scene.fogDensity),t.setColor3("vFogColor",this._scene.fogColor));i.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,t);i.setDepthFunctionToLessOrEqual();t.setBool("alphaTest",!0);i.setColorWrite(!1);i.draw(!0,0,6*o);i.setColorWrite(!0);t.setBool("alphaTest",!1);i.setAlphaMode(n.Engine.ALPHA_COMBINE);i.draw(!0,0,6*o);i.setAlphaMode(n.Engine.ALPHA_DISABLE)}},t.prototype.dispose=function(){this._vertexBuffer&&(this._scene.getEngine()._releaseBuffer(this._vertexBuffer),this._vertexBuffer=null);this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);this._spriteTexture&&(this._spriteTexture.dispose(),this._spriteTexture=null);var n=this._scene.spriteManagers.indexOf(this);this._scene.spriteManagers.splice(n,1);this.onDispose&&this.onDispose()},t}();n.SpriteManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){this.name=t;this.color=new n.Color4(1,1,1,1);this.width=1;this.height=1;this.angle=0;this.cellIndex=0;this.invertU=0;this.invertV=0;this.animations=[];this._animationStarted=!1;this._loopAnimation=!1;this._fromIndex=0;this._toIndex=0;this._delay=0;this._direction=1;this._frameCount=0;this._time=0;this._manager=i;this._manager.sprites.push(this);this.position=n.Vector3.Zero()}return Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(n){this.width=n;this.height=n},enumerable:!0,configurable:!0}),t.prototype.playAnimation=function(n,t,i,r){this._fromIndex=n;this._toIndex=t;this._loopAnimation=i;this._delay=r;this._animationStarted=!0;this._direction=t>n?1:-1;this.cellIndex=n;this._time=0},t.prototype.stopAnimation=function(){this._animationStarted=!1},t.prototype._animate=function(n){this._animationStarted&&(this._time+=n,this._time>this._delay&&(this._time=this._time%this._delay,this.cellIndex+=this._direction,this.cellIndex==this._toIndex&&(this._loopAnimation?this.cellIndex=this._fromIndex:(this._animationStarted=!1,this.disposeWhenFinishedAnimating&&this.dispose()))))},t.prototype.dispose=function(){for(var n=0;n<this._manager.sprites.length;n++)this._manager.sprites[n]==this&&this._manager.sprites.splice(n,1)},t}();n.Sprite=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f){var o,e;this.name=t;this._vertexDeclaration=[2];this._vertexStrideSize=8;this.texture=i?new n.Texture(i,r,!0):null;this.isBackground=void 0===u?!0:u;this.color=void 0===f?new n.Color4(1,1,1,1):f;this._scene=r;this._scene.layers.push(this);o=[];o.push(1,1);o.push(-1,1);o.push(-1,-1);o.push(1,-1);this._vertexBuffer=r.getEngine().createVertexBuffer(o);e=[];e.push(0);e.push(1);e.push(2);e.push(0);e.push(2);e.push(3);this._indexBuffer=r.getEngine().createIndexBuffer(e);this._effect=this._scene.getEngine().createEffect("layer",["position"],["textureMatrix","color"],["textureSampler"],"")}return t.prototype.render=function(){if(this._effect.isReady()&&this.texture&&this.texture.isReady()){var t=this._scene.getEngine();t.enableEffect(this._effect);t.setState(!1);this._effect.setTexture("textureSampler",this.texture);this._effect.setMatrix("textureMatrix",this.texture.getTextureMatrix());this._effect.setFloat4("color",this.color.r,this.color.g,this.color.b,this.color.a);t.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,this._effect);t.setAlphaMode(n.Engine.ALPHA_COMBINE);t.draw(!0,0,6);t.setAlphaMode(n.Engine.ALPHA_DISABLE)}},t.prototype.dispose=function(){this._vertexBuffer&&(this._scene.getEngine()._releaseBuffer(this._vertexBuffer),this._vertexBuffer=null);this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);this.texture&&(this.texture.dispose(),this.texture=null);var n=this._scene.layers.indexOf(this);this._scene.layers.splice(n,1);this.onDispose&&this.onDispose()},t}();n.Layer=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){this.position=n.Vector3.Zero();this.direction=n.Vector3.Zero();this.color=new n.Color4(0,0,0,0);this.colorStep=new n.Color4(0,0,0,0);this.lifeTime=1;this.age=0;this.size=0;this.angle=0;this.angularSpeed=0}return t.prototype.copyTo=function(n){n.position.copyFrom(this.position);n.direction.copyFrom(this.direction);n.color.copyFrom(this.color);n.colorStep.copyFrom(this.colorStep);n.lifeTime=this.lifeTime;n.age=this.age;n.size=this.size;n.angle=this.angle;n.angularSpeed=this.angularSpeed},t}();n.Particle=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n,t){if(n===t)return n;var i=Math.random();return i*(t-n)+n},i=function(){function i(r,u,f,e){var o=this;this.name=r;this.renderingGroupId=0;this.emitter=null;this.emitRate=10;this.manualEmitCount=-1;this.updateSpeed=.01;this.targetStopDuration=0;this.disposeOnStop=!1;this.minEmitPower=1;this.maxEmitPower=1;this.minLifeTime=1;this.maxLifeTime=1;this.minSize=1;this.maxSize=1;this.minAngularSpeed=0;this.maxAngularSpeed=0;this.layerMask=268435455;this.blendMode=i.BLENDMODE_ONEONE;this.forceDepthWrite=!1;this.gravity=n.Vector3.Zero();this.direction1=new n.Vector3(0,1,0);this.direction2=new n.Vector3(0,1,0);this.minEmitBox=new n.Vector3(-.5,-.5,-.5);this.maxEmitBox=new n.Vector3(.5,.5,.5);this.color1=new n.Color4(1,1,1,1);this.color2=new n.Color4(1,1,1,1);this.colorDead=new n.Color4(0,0,0,1);this.textureMask=new n.Color4(1,1,1,1);this.particles=[];this._vertexDeclaration=[3,4,4];this._vertexStrideSize=44;this._stockParticles=[];this._newPartsExcess=0;this._scaledColorStep=new n.Color4(0,0,0,0);this._colorDiff=new n.Color4(0,0,0,0);this._scaledDirection=n.Vector3.Zero();this._scaledGravity=n.Vector3.Zero();this._currentRenderId=-1;this._started=!1;this._stopped=!1;this._actualFrame=0;this.id=r;this._capacity=u;this._scene=f;this._customEffect=e;f.particleSystems.push(this);this._vertexBuffer=f.getEngine().createDynamicVertexBuffer(u*this._vertexStrideSize*4);for(var s=[],h=0,c=0;u>c;c++)s.push(h),s.push(h+1),s.push(h+2),s.push(h),s.push(h+2),s.push(h+3),h+=4;this._indexBuffer=f.getEngine().createIndexBuffer(s);this._vertices=new Float32Array(u*this._vertexStrideSize);this.startDirectionFunction=function(i,r,u){var f=t(o.direction1.x,o.direction2.x),e=t(o.direction1.y,o.direction2.y),s=t(o.direction1.z,o.direction2.z);n.Vector3.TransformNormalFromFloatsToRef(f*i,e*i,s*i,r,u)};this.startPositionFunction=function(i,r){var u=t(o.minEmitBox.x,o.maxEmitBox.x),f=t(o.minEmitBox.y,o.maxEmitBox.y),e=t(o.minEmitBox.z,o.maxEmitBox.z);n.Vector3.TransformCoordinatesFromFloatsToRef(u,f,e,i,r)};this.updateFunction=function(n){for(var t,i=0;i<n.length;i++)t=n[i],t.age+=o._scaledUpdateSpeed,t.age>=t.lifeTime?(o.recycleParticle(t),i--):(t.colorStep.scaleToRef(o._scaledUpdateSpeed,o._scaledColorStep),t.color.addInPlace(o._scaledColorStep),t.color.a<0&&(t.color.a=0),t.angle+=t.angularSpeed*o._scaledUpdateSpeed,t.direction.scaleToRef(o._scaledUpdateSpeed,o._scaledDirection),t.position.addInPlace(o._scaledDirection),o.gravity.scaleToRef(o._scaledUpdateSpeed,o._scaledGravity),t.direction.addInPlace(o._scaledGravity))}}return i.prototype.recycleParticle=function(n){var t=this.particles.pop();t!==n&&(t.copyTo(n),this._stockParticles.push(t))},i.prototype.getCapacity=function(){return this._capacity},i.prototype.isAlive=function(){return this._alive},i.prototype.isStarted=function(){return this._started},i.prototype.start=function(){this._started=!0;this._stopped=!1;this._actualFrame=0},i.prototype.stop=function(){this._stopped=!0},i.prototype._appendParticleVertex=function(n,t,i,r){var u=11*n;this._vertices[u]=t.position.x;this._vertices[u+1]=t.position.y;this._vertices[u+2]=t.position.z;this._vertices[u+3]=t.color.r;this._vertices[u+4]=t.color.g;this._vertices[u+5]=t.color.b;this._vertices[u+6]=t.color.a;this._vertices[u+7]=t.angle;this._vertices[u+8]=t.size;this._vertices[u+9]=i;this._vertices[u+10]=r},i.prototype._update=function(i){var u,f,r,e,o;for(this._alive=this.particles.length>0,this.updateFunction(this.particles),u=this.emitter.position?this.emitter.getWorldMatrix():n.Matrix.Translation(this.emitter.x,this.emitter.y,this.emitter.z),f=0;i>f&&this.particles.length!==this._capacity;f++)0!==this._stockParticles.length?(r=this._stockParticles.pop(),r.age=0):r=new n.Particle,this.particles.push(r),e=t(this.minEmitPower,this.maxEmitPower),this.startDirectionFunction(e,u,r.direction),r.lifeTime=t(this.minLifeTime,this.maxLifeTime),r.size=t(this.minSize,this.maxSize),r.angularSpeed=t(this.minAngularSpeed,this.maxAngularSpeed),this.startPositionFunction(u,r.position),o=t(0,1),n.Color4.LerpToRef(this.color1,this.color2,o,r.color),this.colorDead.subtractToRef(r.color,this._colorDiff),this._colorDiff.scaleToRef(1/r.lifeTime,r.colorStep)},i.prototype._getEffect=function(){var t,n;return this._customEffect?this._customEffect:(t=[],this._scene.clipPlane&&t.push("#define CLIPPLANE"),n=t.join("\n"),this._cachedDefines!==n&&(this._cachedDefines=n,this._effect=this._scene.getEngine().createEffect("particles",["position","color","options"],["invView","view","projection","vClipPlane","textureMask"],["diffuseSampler"],n)),this._effect)},i.prototype.animate=function(){var f,r,n,t,u,i,e;if(this._started&&(f=this._getEffect(),this.emitter&&f.isReady()&&this.particleTexture&&this.particleTexture.isReady()&&this._currentRenderId!==this._scene.getRenderId())){for(this._currentRenderId=this._scene.getRenderId(),this._scaledUpdateSpeed=this.updateSpeed*this._scene.getAnimationRatio(),this.manualEmitCount>-1?(r=this.manualEmitCount,this.manualEmitCount=0):r=this.emitRate,n=r*this._scaledUpdateSpeed>>0,this._newPartsExcess+=r*this._scaledUpdateSpeed-n,this._newPartsExcess>1&&(n+=this._newPartsExcess>>0,this._newPartsExcess-=this._newPartsExcess>>0),this._alive=!1,this._stopped?n=0:(this._actualFrame+=this._scaledUpdateSpeed,this.targetStopDuration&&this._actualFrame>=this.targetStopDuration&&this.stop()),this._update(n),this._stopped&&(this._alive||(this._started=!1,this.disposeOnStop&&this._scene._toBeDisposed.push(this))),t=0,u=0;u<this.particles.length;u++)i=this.particles[u],this._appendParticleVertex(t++,i,0,0),this._appendParticleVertex(t++,i,1,0),this._appendParticleVertex(t++,i,1,1),this._appendParticleVertex(t++,i,0,1);e=this._scene.getEngine();e.updateDynamicVertexBuffer(this._vertexBuffer,this._vertices)}},i.prototype.render=function(){var t=this._getEffect(),r,f,u,e;return(this.emitter&&t.isReady()&&this.particleTexture&&this.particleTexture.isReady()&&this.particles.length)?(r=this._scene.getEngine(),r.enableEffect(t),r.setState(!1),f=this._scene.getViewMatrix(),(t.setTexture("diffuseSampler",this.particleTexture),t.setMatrix("view",f),t.setMatrix("projection",this._scene.getProjectionMatrix()),t.setFloat4("textureMask",this.textureMask.r,this.textureMask.g,this.textureMask.b,this.textureMask.a),this._scene.clipPlane)&&(u=this._scene.clipPlane,e=f.clone(),e.invert(),t.setMatrix("invView",e),t.setFloat4("vClipPlane",u.normal.x,u.normal.y,u.normal.z,u.d)),r.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,t),r.setAlphaMode(this.blendMode===i.BLENDMODE_ONEONE?n.Engine.ALPHA_ONEONE:n.Engine.ALPHA_COMBINE),this.forceDepthWrite&&r.setDepthWrite(!0),r.draw(!0,0,6*this.particles.length),r.setAlphaMode(n.Engine.ALPHA_DISABLE),this.particles.length):0},i.prototype.dispose=function(){this._vertexBuffer&&(this._scene.getEngine()._releaseBuffer(this._vertexBuffer),this._vertexBuffer=null);this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);this.particleTexture&&(this.particleTexture.dispose(),this.particleTexture=null);var n=this._scene.particleSystems.indexOf(this);this._scene.particleSystems.splice(n,1);this.onDispose&&this.onDispose()},i.prototype.clone=function(t,r){var u=new i(t,this._capacity,this._scene);return n.Tools.DeepCopy(this,u,["particles"],["_vertexDeclaration","_vertexStrideSize"]),void 0===r&&(r=this.emitter),u.emitter=r,this.particleTexture&&(u.particleTexture=new n.Texture(this.particleTexture.url,this._scene)),u.start(),u},i.BLENDMODE_ONEONE=0,i.BLENDMODE_STANDARD=1,i}();n.ParticleSystem=i}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,i,r,u,f){this.name=n;this.targetProperty=i;this.framePerSecond=r;this.dataType=u;this.loopMode=f;this._offsetsCache={};this._highLimitsCache={};this._stopped=!1;this.allowMatricesInterpolation=!1;this.targetPropertyPath=i.split(".");this.dataType=u;this.loopMode=void 0===f?t.ANIMATIONLOOPMODE_CYCLE:f}return t.CreateAndStartAnimation=function(i,r,u,f,e,o,s,h,c){var l=void 0,a,v;return(!isNaN(parseFloat(o))&&isFinite(o)?l=t.ANIMATIONTYPE_FLOAT:o instanceof n.Quaternion?l=t.ANIMATIONTYPE_QUATERNION:o instanceof n.Vector3?l=t.ANIMATIONTYPE_VECTOR3:o instanceof n.Vector2?l=t.ANIMATIONTYPE_VECTOR2:o instanceof n.Color3&&(l=t.ANIMATIONTYPE_COLOR3),void 0==l)?null:(a=new t(i,u,f,l,h),v=[],v.push({frame:0,value:o}),v.push({frame:e,value:s}),a.setKeys(v),void 0!==c&&a.setEasingFunction(c),r.animations.push(a),r.getScene().beginAnimation(r,0,e,1===a.loopMode))},t.prototype.reset=function(){this._offsetsCache={};this._highLimitsCache={};this.currentFrame=0},t.prototype.isStopped=function(){return this._stopped},t.prototype.getKeys=function(){return this._keys},t.prototype.getEasingFunction=function(){return this._easingFunction},t.prototype.setEasingFunction=function(n){this._easingFunction=n},t.prototype.floatInterpolateFunction=function(n,t,i){return n+(t-n)*i},t.prototype.quaternionInterpolateFunction=function(t,i,r){return n.Quaternion.Slerp(t,i,r)},t.prototype.vector3InterpolateFunction=function(t,i,r){return n.Vector3.Lerp(t,i,r)},t.prototype.vector2InterpolateFunction=function(t,i,r){return n.Vector2.Lerp(t,i,r)},t.prototype.color3InterpolateFunction=function(t,i,r){return n.Color3.Lerp(t,i,r)},t.prototype.matrixInterpolateFunction=function(t,i,r){var u=new n.Vector3(0,0,0),f=new n.Quaternion,e=new n.Vector3(0,0,0);t.decompose(u,f,e);var o=new n.Vector3(0,0,0),s=new n.Quaternion,h=new n.Vector3(0,0,0);i.decompose(o,s,h);var c=this.vector3InterpolateFunction(u,o,r),l=this.quaternionInterpolateFunction(f,s,r),a=this.vector3InterpolateFunction(e,h,r);return n.Matrix.Compose(c,l,a)},t.prototype.clone=function(){var n=new t(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);return n.setKeys(this._keys),n},t.prototype.setKeys=function(n){this._keys=n.slice(0);this._offsetsCache={};this._highLimitsCache={}},t.prototype._getKeyValue=function(n){return"function"==typeof n?n():n},t.prototype._interpolate=function(n,i,r,u,f){var c,h,l;if(r===t.ANIMATIONLOOPMODE_CONSTANT&&i>0)return f.clone?f.clone():f;if(this.currentFrame=n,c=Math.max(0,Math.min(this._keys.length-1,Math.floor(this._keys.length*(n-this._keys[0].frame)/(this._keys[this._keys.length-1].frame-this._keys[0].frame))-1)),this._keys[c].frame>=n)for(;c-1>=0&&this._keys[c].frame>=n;)c--;for(h=c;h<this._keys.length;h++)if(this._keys[h+1].frame>=n){var o=this._getKeyValue(this._keys[h].value),s=this._getKeyValue(this._keys[h+1].value),e=(n-this._keys[h].frame)/(this._keys[h+1].frame-this._keys[h].frame);switch(null!=this._easingFunction&&(e=this._easingFunction.ease(e)),this.dataType){case t.ANIMATIONTYPE_FLOAT:switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.floatInterpolateFunction(o,s,e);case t.ANIMATIONLOOPMODE_RELATIVE:return u*i+this.floatInterpolateFunction(o,s,e)}break;case t.ANIMATIONTYPE_QUATERNION:l=null;switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:l=this.quaternionInterpolateFunction(o,s,e);break;case t.ANIMATIONLOOPMODE_RELATIVE:l=this.quaternionInterpolateFunction(o,s,e).add(u.scale(i))}return l;case t.ANIMATIONTYPE_VECTOR3:switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.vector3InterpolateFunction(o,s,e);case t.ANIMATIONLOOPMODE_RELATIVE:return this.vector3InterpolateFunction(o,s,e).add(u.scale(i))}case t.ANIMATIONTYPE_VECTOR2:switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.vector2InterpolateFunction(o,s,e);case t.ANIMATIONLOOPMODE_RELATIVE:return this.vector2InterpolateFunction(o,s,e).add(u.scale(i))}case t.ANIMATIONTYPE_COLOR3:switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.color3InterpolateFunction(o,s,e);case t.ANIMATIONLOOPMODE_RELATIVE:return this.color3InterpolateFunction(o,s,e).add(u.scale(i))}case t.ANIMATIONTYPE_MATRIX:switch(r){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:if(this.allowMatricesInterpolation)return this.matrixInterpolateFunction(o,s,e);case t.ANIMATIONLOOPMODE_RELATIVE:return o}}break}return this._getKeyValue(this._keys[this._keys.length-1].value)},t.prototype.animate=function(i,r,u,f,e){var l,b,o,c,h,a,v;if(!this.targetPropertyPath||this.targetPropertyPath.length<1)return this._stopped=!0,!1;l=!0;0!==this._keys[0].frame&&(b={frame:0,value:this._keys[0].value},this._keys.splice(0,0,b));(r<this._keys[0].frame||r>this._keys[this._keys.length-1].frame)&&(r=this._keys[0].frame);(u<this._keys[0].frame||u>this._keys[this._keys.length-1].frame)&&(u=this._keys[this._keys.length-1].frame);var s,y=u-r,p=i*this.framePerSecond*e/1e3,w=0;if(p>y&&!f)l=!1,w=this._getKeyValue(this._keys[this._keys.length-1].value);else if(this.loopMode!==t.ANIMATIONLOOPMODE_CYCLE){if(o=u.toString()+r.toString(),!this._offsetsCache[o]){c=this._interpolate(r,0,t.ANIMATIONLOOPMODE_CYCLE);h=this._interpolate(u,0,t.ANIMATIONLOOPMODE_CYCLE);switch(this.dataType){case t.ANIMATIONTYPE_FLOAT:this._offsetsCache[o]=h-c;break;case t.ANIMATIONTYPE_QUATERNION:this._offsetsCache[o]=h.subtract(c);break;case t.ANIMATIONTYPE_VECTOR3:this._offsetsCache[o]=h.subtract(c);case t.ANIMATIONTYPE_VECTOR2:this._offsetsCache[o]=h.subtract(c);case t.ANIMATIONTYPE_COLOR3:this._offsetsCache[o]=h.subtract(c)}this._highLimitsCache[o]=h}w=this._highLimitsCache[o];s=this._offsetsCache[o]}if(void 0===s)switch(this.dataType){case t.ANIMATIONTYPE_FLOAT:s=0;break;case t.ANIMATIONTYPE_QUATERNION:s=new n.Quaternion(0,0,0,0);break;case t.ANIMATIONTYPE_VECTOR3:s=n.Vector3.Zero();break;case t.ANIMATIONTYPE_VECTOR2:s=n.Vector2.Zero();break;case t.ANIMATIONTYPE_COLOR3:s=n.Color3.Black()}var d=p/y>>0,g=l?r+p%y:u,k=this._interpolate(g,d,this.loopMode,s,w);if(this.targetPropertyPath.length>1){for(a=this._target[this.targetPropertyPath[0]],v=1;v<this.targetPropertyPath.length-1;v++)a=a[this.targetPropertyPath[v]];a[this.targetPropertyPath[this.targetPropertyPath.length-1]]=k}else this._target[this.targetPropertyPath[0]]=k;return this._target.markAsDirty&&this._target.markAsDirty(this.targetProperty),l||(this._stopped=!0),l},Object.defineProperty(t,"ANIMATIONTYPE_FLOAT",{get:function(){return t._ANIMATIONTYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR3",{get:function(){return t._ANIMATIONTYPE_VECTOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR2",{get:function(){return t._ANIMATIONTYPE_VECTOR2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_QUATERNION",{get:function(){return t._ANIMATIONTYPE_QUATERNION},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_MATRIX",{get:function(){return t._ANIMATIONTYPE_MATRIX},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_COLOR3",{get:function(){return t._ANIMATIONTYPE_COLOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_RELATIVE",{get:function(){return t._ANIMATIONLOOPMODE_RELATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CYCLE",{get:function(){return t._ANIMATIONLOOPMODE_CYCLE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CONSTANT",{get:function(){return t._ANIMATIONLOOPMODE_CONSTANT},enumerable:!0,configurable:!0}),t._ANIMATIONTYPE_FLOAT=0,t._ANIMATIONTYPE_VECTOR3=1,t._ANIMATIONTYPE_QUATERNION=2,t._ANIMATIONTYPE_MATRIX=3,t._ANIMATIONTYPE_COLOR3=4,t._ANIMATIONTYPE_VECTOR2=5,t._ANIMATIONLOOPMODE_RELATIVE=0,t._ANIMATIONLOOPMODE_CYCLE=1,t._ANIMATIONLOOPMODE_CONSTANT=2,t}();n.Animation=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n,t,i,r,u,f,e,o){void 0===i&&(i=0);void 0===r&&(r=100);void 0===u&&(u=!1);void 0===f&&(f=1);this.target=t;this.fromFrame=i;this.toFrame=r;this.loopAnimation=u;this.speedRatio=f;this.onAnimationEnd=e;this._animations=[];this._paused=!1;this.animationStarted=!1;o&&this.appendAnimations(t,o);this._scene=n;n._activeAnimatables.push(this)}return n.prototype.appendAnimations=function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],r._target=n,this._animations.push(r)},n.prototype.getAnimationByTargetProperty=function(n){for(var i=this._animations,t=0;t<i.length;t++)if(i[t].targetProperty===n)return i[t];return null},n.prototype.reset=function(){for(var t=this._animations,n=0;n<t.length;n++)t[n].reset();this._localDelayOffset=null;this._pausedDelay=null},n.prototype.pause=function(){this._paused||(this._paused=!0)},n.prototype.restart=function(){this._paused=!1},n.prototype.stop=function(){var n=this._scene._activeAnimatables.indexOf(this);n>-1&&this._scene._activeAnimatables.splice(n,1);this.onAnimationEnd&&this.onAnimationEnd()},n.prototype._animate=function(n){var u,f;if(this._paused)return this._pausedDelay||(this._pausedDelay=n),!0;this._localDelayOffset?this._pausedDelay&&(this._localDelayOffset+=n-this._pausedDelay,this._pausedDelay=null):this._localDelayOffset=n;for(var t=!1,r=this._animations,i=0;i<r.length;i++)u=r[i],f=u.animate(n-this._localDelayOffset,this.fromFrame,this.toFrame,this.loopAnimation,this.speedRatio),t=t||f;return t||(i=this._scene._activeAnimatables.indexOf(this),this._scene._activeAnimatables.splice(i,1)),!t&&this.onAnimationEnd&&this.onAnimationEnd(),t},n}();n.Animatable=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(){this._easingMode=n.EASINGMODE_EASEIN}return Object.defineProperty(n,"EASINGMODE_EASEIN",{get:function(){return n._EASINGMODE_EASEIN},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EASINGMODE_EASEOUT",{get:function(){return n._EASINGMODE_EASEOUT},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EASINGMODE_EASEINOUT",{get:function(){return n._EASINGMODE_EASEINOUT},enumerable:!0,configurable:!0}),n.prototype.setEasingMode=function(n){var t=Math.min(Math.max(n,0),2);this._easingMode=t},n.prototype.getEasingMode=function(){return this._easingMode},n.prototype.easeInCore=function(){throw new Error("You must implement this method");},n.prototype.ease=function(t){switch(this._easingMode){case n.EASINGMODE_EASEIN:return this.easeInCore(t);case n.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)},n._EASINGMODE_EASEIN=0,n._EASINGMODE_EASEOUT=1,n._EASINGMODE_EASEINOUT=2,n}(),i,r,u,f,e,o,s,h,c,l,a,v;n.EasingFunction=t;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return n=Math.max(0,Math.min(1,n)),1-Math.sqrt(1-n*n)},t}(t);n.CircleEase=i;r=function(n){function t(t){void 0===t&&(t=1);n.call(this);this.amplitude=t}return __extends(t,n),t.prototype.easeInCore=function(n){var t=Math.max(0,this.amplitude);return Math.pow(n,3)-n*t*Math.sin(3.1415926535897931*n)},t}(t);n.BackEase=r;u=function(n){function t(t,i){void 0===t&&(t=3);void 0===i&&(i=2);n.call(this);this.bounces=t;this.bounciness=i}return __extends(t,n),t.prototype.easeInCore=function(n){var e=Math.max(0,this.bounces),t=this.bounciness;1>=t&&(t=1.001);var o=Math.pow(t,e),r=1-t,u=(1-o)/r+.5*o,l=n*u,a=Math.log(-l*(1-t)+1)/Math.log(t),f=Math.floor(a),v=f+1,s=(1-Math.pow(t,f))/(r*u),y=(1-Math.pow(t,v))/(r*u),h=.5*(s+y),c=n-h,i=h-s;return-Math.pow(1/t,e-f)/(i*i)*(c-i)*(c+i)},t}(t);n.BounceEase=u;f=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return n*n*n},t}(t);n.CubicEase=f;e=function(n){function t(t,i){void 0===t&&(t=3);void 0===i&&(i=3);n.call(this);this.oscillations=t;this.springiness=i}return __extends(t,n),t.prototype.easeInCore=function(n){var i,r=Math.max(0,this.oscillations),t=Math.max(0,this.springiness);return i=0==t?n:(Math.exp(t*n)-1)/(Math.exp(t)-1),i*Math.sin((6.2831853071795862*r+1.5707963267948966)*n)},t}(t);n.ElasticEase=e;o=function(n){function t(t){void 0===t&&(t=2);n.call(this);this.exponent=t}return __extends(t,n),t.prototype.easeInCore=function(n){return this.exponent<=0?n:(Math.exp(this.exponent*n)-1)/(Math.exp(this.exponent)-1)},t}(t);n.ExponentialEase=o;s=function(n){function t(t){void 0===t&&(t=2);n.call(this);this.power=t}return __extends(t,n),t.prototype.easeInCore=function(n){var t=Math.max(0,this.power);return Math.pow(n,t)},t}(t);n.PowerEase=s;h=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return n*n},t}(t);n.QuadraticEase=h;c=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return n*n*n*n},t}(t);n.QuarticEase=c;l=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return n*n*n*n*n},t}(t);n.QuinticEase=l;a=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.easeInCore=function(n){return 1-Math.sin(1.5707963267948966*(1-n))},t}(t);n.SineEase=a;v=function(t){function i(n,i,r,u){void 0===n&&(n=0);void 0===i&&(i=0);void 0===r&&(r=1);void 0===u&&(u=1);t.call(this);this.x1=n;this.y1=i;this.x2=r;this.y2=u}return __extends(i,t),i.prototype.easeInCore=function(t){return n.BezierCurve.interpolate(t,this.x1,this.y1,this.x2,this.y2)},i}(t);n.BezierCurveEase=v}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r){void 0===r&&(r=2);this.maxDepth=r;this.dynamicContent=[];this._maxBlockCapacity=i||64;this._selectionContent=new n.SmartArray(1024);this._creationFunc=t}return t.prototype.update=function(n,i,r){t._CreateBlocks(n,i,r,this._maxBlockCapacity,0,this.maxDepth,this,this._creationFunc)},t.prototype.addMesh=function(n){for(var i,t=0;t<this.blocks.length;t++)i=this.blocks[t],i.addEntry(n)},t.prototype.select=function(n,t){var i,r;for(this._selectionContent.reset(),i=0;i<this.blocks.length;i++)r=this.blocks[i],r.select(n,this._selectionContent,t);return t?this._selectionContent.concat(this.dynamicContent):this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t.prototype.intersects=function(n,t,i){var r,u;for(this._selectionContent.reset(),r=0;r<this.blocks.length;r++)u=this.blocks[r],u.intersects(n,t,this._selectionContent,i);return i?this._selectionContent.concat(this.dynamicContent):this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t.prototype.intersectsRay=function(n){var t,i;for(this._selectionContent.reset(),t=0;t<this.blocks.length;t++)i=this.blocks[t],i.intersectsRay(n,this._selectionContent);return this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t._CreateBlocks=function(t,i,r,u,f,e,o,s){var a,h,c,l;for(o.blocks=[],a=new n.Vector3((i.x-t.x)/2,(i.y-t.y)/2,(i.z-t.z)/2),h=0;2>h;h++)for(c=0;2>c;c++)for(l=0;2>l;l++){var y=t.add(a.multiplyByFloats(h,c,l)),p=t.add(a.multiplyByFloats(h+1,c+1,l+1)),v=new n.OctreeBlock(y,p,u,f+1,e,s);v.addEntries(r);o.blocks.push(v)}},t.CreationFuncForMeshes=function(n,t){!n.isBlocked&&n.getBoundingInfo().boundingBox.intersectsMinMax(t.minPoint,t.maxPoint)&&t.entries.push(n)},t.CreationFuncForSubMeshes=function(n,t){n.getBoundingInfo().boundingBox.intersectsMinMax(t.minPoint,t.maxPoint)&&t.entries.push(n)},t}();n.Octree=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t,i,r,u,f){this.entries=[];this._boundingVectors=[];this._capacity=i;this._depth=r;this._maxDepth=u;this._creationFunc=f;this._minPoint=n;this._maxPoint=t;this._boundingVectors.push(n.clone());this._boundingVectors.push(t.clone());this._boundingVectors.push(n.clone());this._boundingVectors[2].x=t.x;this._boundingVectors.push(n.clone());this._boundingVectors[3].y=t.y;this._boundingVectors.push(n.clone());this._boundingVectors[4].z=t.z;this._boundingVectors.push(t.clone());this._boundingVectors[5].z=n.z;this._boundingVectors.push(t.clone());this._boundingVectors[6].x=n.x;this._boundingVectors.push(t.clone());this._boundingVectors[7].y=n.y}return Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minPoint",{get:function(){return this._minPoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPoint",{get:function(){return this._maxPoint},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(n){var t,i;if(this.blocks)for(t=0;t<this.blocks.length;t++)i=this.blocks[t],i.addEntry(n);else this._creationFunc(n,this),this.entries.length>this.capacity&&this._depth<this._maxDepth&&this.createInnerBlocks()},t.prototype.addEntries=function(n){for(var i,t=0;t<n.length;t++)i=n[t],this.addEntry(i)},t.prototype.select=function(t,i,r){var u,f;if(n.BoundingBox.IsInFrustum(this._boundingVectors,t)){if(this.blocks){for(u=0;u<this.blocks.length;u++)f=this.blocks[u],f.select(t,i,r);return}r?i.concat(this.entries):i.concatWithNoDuplicate(this.entries)}},t.prototype.intersects=function(t,i,r,u){var f,e;if(n.BoundingBox.IntersectsSphere(this._minPoint,this._maxPoint,t,i)){if(this.blocks){for(f=0;f<this.blocks.length;f++)e=this.blocks[f],e.intersects(t,i,r,u);return}u?r.concat(this.entries):r.concatWithNoDuplicate(this.entries)}},t.prototype.intersectsRay=function(n,t){var i,r;if(n.intersectsBoxMinMax(this._minPoint,this._maxPoint)){if(this.blocks){for(i=0;i<this.blocks.length;i++)r=this.blocks[i],r.intersectsRay(n,t);return}t.concatWithNoDuplicate(this.entries)}},t.prototype.createInnerBlocks=function(){n.Octree._CreateBlocks(this._minPoint,this._maxPoint,this.entries,this._capacity,this._depth,this._maxDepth,this,this._creationFunc)},t}();n.OctreeBlock=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){t.call(this,i,r.getScene());this.name=i;this.children=[];this.animations=[];this._worldTransform=new n.Matrix;this._absoluteTransform=new n.Matrix;this._invertedAbsoluteTransform=new n.Matrix;this._skeleton=r;this._matrix=f;this._baseMatrix=f;r.bones.push(this);u?(this._parent=u,u.children.push(this)):this._parent=null;this._updateDifferenceMatrix()}return __extends(i,t),i.prototype.getParent=function(){return this._parent},i.prototype.getLocalMatrix=function(){return this._matrix},i.prototype.getBaseMatrix=function(){return this._baseMatrix},i.prototype.getWorldMatrix=function(){return this._worldTransform},i.prototype.getInvertedAbsoluteTransform=function(){return this._invertedAbsoluteTransform},i.prototype.getAbsoluteMatrix=function(){for(var t=this._matrix.clone(),n=this._parent;n;)t=t.multiply(n.getLocalMatrix()),n=n.getParent();return t},i.prototype.updateMatrix=function(n){this._matrix=n;this._skeleton._markAsDirty();this._updateDifferenceMatrix()},i.prototype._updateDifferenceMatrix=function(){this._parent?this._matrix.multiplyToRef(this._parent._absoluteTransform,this._absoluteTransform):this._absoluteTransform.copyFrom(this._matrix);this._absoluteTransform.invertToRef(this._invertedAbsoluteTransform);for(var n=0;n<this.children.length;n++)this.children[n]._updateDifferenceMatrix()},i.prototype.markAsDirty=function(){this._currentRenderId++;this._skeleton._markAsDirty()},i}(n.Node);n.Bone=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r){this.name=t;this.id=i;this.bones=[];this._isDirty=!0;this._identity=n.Matrix.Identity();this.bones=[];this._scene=r;r.skeletons.push(this);this.prepare();this._isDirty=!0}return t.prototype.getTransformMatrices=function(){return this._transformMatrices},t.prototype.getScene=function(){return this._scene},t.prototype._markAsDirty=function(){this._isDirty=!0},t.prototype.prepare=function(){var t,n,i;if(this._isDirty){for(this._transformMatrices&&this._transformMatrices.length===16*(this.bones.length+1)||(this._transformMatrices=new Float32Array(16*(this.bones.length+1))),t=0;t<this.bones.length;t++)n=this.bones[t],i=n.getParent(),i?n.getLocalMatrix().multiplyToRef(i.getWorldMatrix(),n.getWorldMatrix()):n.getWorldMatrix().copyFrom(n.getLocalMatrix()),n.getInvertedAbsoluteTransform().multiplyToArray(n.getWorldMatrix(),this._transformMatrices,16*t);this._identity.copyToArray(this._transformMatrices,16*this.bones.length);this._isDirty=!1;this._scene._activeBones+=this.bones.length}},t.prototype.getAnimatables=function(){if(!this._animatables||this._animatables.length!==this.bones.length){this._animatables=[];for(var n=0;n<this.bones.length;n++)this._animatables.push(this.bones[n])}return this._animatables},t.prototype.clone=function(i,r){for(var u,o,s,h,f=new t(i,r||i,this._scene),e=0;e<this.bones.length;e++)u=this.bones[e],o=null,u.getParent()&&(s=this.bones.indexOf(u.getParent()),o=f.bones[s]),h=new n.Bone(u.name,f,o,u.getBaseMatrix()),n.Tools.DeepCopy(u.animations,h.animations);return f},t}();n.Skeleton=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f,e,o,s,h,c,l){void 0===o&&(o=n.Texture.NEAREST_SAMPLINGMODE);void 0===l&&(l=n.Engine.TEXTURETYPE_UNSIGNED_INT);this.name=t;this.width=-1;this.height=-1;this._reusable=!1;this._textures=new n.SmartArray(2);this._currentRenderTextureInd=0;null!=e?(this._camera=e,this._scene=e.getScene(),e.attachPostProcess(this),this._engine=this._scene.getEngine()):this._engine=s;this._renderRatio=f;this.renderTargetSamplingMode=o?o:n.Texture.NEAREST_SAMPLINGMODE;this._reusable=h||!1;this._textureType=l;u=u||[];u.push("textureSampler");this._effect=this._engine.createEffect({vertex:"postprocess",fragment:i},["position"],r||[],u,void 0!==c?c:"")}return t.prototype.isReusable=function(){return this._reusable},t.prototype.activate=function(t,i){var f;t=t||this._camera;var e=t.getScene(),o=t.getEngine().getCaps().maxTextureSize,r=(i?i._width:this._engine.getRenderingCanvas().width)*this._renderRatio|0,u=(i?i._height:this._engine.getRenderingCanvas().height)*this._renderRatio|0;if(r=this._renderRatio.width||n.Tools.GetExponantOfTwo(r,o),u=this._renderRatio.height||n.Tools.GetExponantOfTwo(u,o),this.width!==r||this.height!==u){if(this._textures.length>0){for(f=0;f<this._textures.length;f++)this._engine._releaseTexture(this._textures.data[f]);this._textures.reset()}this.width=r;this.height=u;this._textures.push(this._engine.createRenderTargetTexture({width:this.width,height:this.height},{generateMipMaps:!1,generateDepthBuffer:t._postProcesses.indexOf(this)===t._postProcessesTakenIndices[0],samplingMode:this.renderTargetSamplingMode,type:this._textureType}));this._reusable&&this._textures.push(this._engine.createRenderTargetTexture({width:this.width,height:this.height},{generateMipMaps:!1,generateDepthBuffer:t._postProcesses.indexOf(this)===t._postProcessesTakenIndices[0],samplingMode:this.renderTargetSamplingMode,type:this._textureType}));this.onSizeChanged&&this.onSizeChanged()}this._engine.bindFramebuffer(this._textures.data[this._currentRenderTextureInd]);this.onActivate&&this.onActivate(t);this.clearColor?this._engine.clear(this.clearColor,!0,!0):this._engine.clear(e.clearColor,e.autoClear||e.forceWireframe,!0);this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2)},t.prototype.apply=function(){return this._effect.isReady()?(this._engine.enableEffect(this._effect),this._engine.setState(!1),this._engine.setAlphaMode(n.Engine.ALPHA_DISABLE),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._effect._bindTexture("textureSampler",this._textures.data[this._currentRenderTextureInd]),this.onApply&&this.onApply(this._effect),this._effect):null},t.prototype.dispose=function(n){var t,i;if(n=n||this._camera,this._textures.length>0){for(t=0;t<this._textures.length;t++)this._engine._releaseTexture(this._textures.data[t]);this._textures.reset()}n&&(n.detachPostProcess(this),i=n._postProcesses.indexOf(this),i===n._postProcessesTakenIndices[0]&&n._postProcessesTakenIndices.length>0&&(this._camera._postProcesses[n._postProcessesTakenIndices[0]].width=-1))},t}();n.PostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n){this._vertexDeclaration=[2];this._vertexStrideSize=8;this._scene=n}return n.prototype._prepareBuffers=function(){var t,n;this._vertexBuffer||(t=[],t.push(1,1),t.push(-1,1),t.push(-1,-1),t.push(1,-1),this._vertexBuffer=this._scene.getEngine().createVertexBuffer(t),n=[],n.push(0),n.push(1),n.push(2),n.push(0),n.push(2),n.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(n))},n.prototype._prepareFrame=function(n){var t=this._scene.activeCamera._postProcesses,i=this._scene.activeCamera._postProcessesTakenIndices;return 0!==i.length&&this._scene.postProcessesEnabled?(t[this._scene.activeCamera._postProcessesTakenIndices[0]].activate(this._scene.activeCamera,n),!0):!1},n.prototype.directRender=function(n,t){for(var u,f,i=this._scene.getEngine(),r=0;r<n.length;r++)r<n.length-1?n[r+1].activate(this._scene.activeCamera,t):t?i.bindFramebuffer(t):i.restoreDefaultFramebuffer(),u=n[r],f=u.apply(),f&&(u.onBeforeRender&&u.onBeforeRender(f),this._prepareBuffers(),i.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,f),i.draw(!0,0,6),u.onAfterRender&&u.onAfterRender(f));i.setDepthBuffer(!0);i.setDepthWrite(!0)},n.prototype._finalizeFrame=function(n,t,i){var u,r,f,e,o;if(i=i||this._scene.activeCamera._postProcesses,u=this._scene.activeCamera._postProcessesTakenIndices,0!==u.length&&this._scene.postProcessesEnabled){for(r=this._scene.getEngine(),f=0;f<u.length&&(f<u.length-1?i[u[f+1]].activate(this._scene.activeCamera):t?r.bindFramebuffer(t):r.restoreDefaultFramebuffer(),!n);f++)e=i[u[f]],o=e.apply(),o&&(e.onBeforeRender&&e.onBeforeRender(o),this._prepareBuffers(),r.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,o),r.draw(!0,0,6),e.onAfterRender&&e.onAfterRender(o));r.setDepthBuffer(!0);r.setDepthWrite(!0)}},n.prototype.dispose=function(){this._vertexBuffer&&(this._scene.getEngine()._releaseBuffer(this._vertexBuffer),this._vertexBuffer=null);this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)},n}();n.PostProcessManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,"pass",null,null,i,r,u,f,e)}return __extends(t,n),t}(n.PostProcess);n.PassPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o,s,h){var c=this;void 0===o&&(o=n.Texture.BILINEAR_SAMPLINGMODE);t.call(this,i,"blur",["screenSize","direction","blurWidth"],null,f,e,o,s,h);this.direction=r;this.blurWidth=u;this.onApply=function(n){n.setFloat2("screenSize",c.width,c.height);n.setVector2("direction",c.direction);n.setFloat("blurWidth",c.blurWidth)}}return __extends(i,t),i}(n.PostProcess);n.BlurPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o,s,h,c,l){var a=this;t.call(this,i,"refraction",["baseColor","depth","colorLevel"],["refractionSampler"],o,s,h,c,l);this.color=u;this.depth=f;this.colorLevel=e;this.onActivate=function(t){a._refRexture=a._refRexture||new n.Texture(r,t.getScene())};this.onApply=function(n){n.setColor3("baseColor",a.color);n.setFloat("depth",a.depth);n.setFloat("colorLevel",a.colorLevel);n.setTexture("refractionSampler",a._refRexture)}}return __extends(i,t),i.prototype.dispose=function(n){this._refRexture&&this._refRexture.dispose();t.prototype.dispose.call(this,n)},i}(n.PostProcess);n.RefractionPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,"blackAndWhite",null,null,i,r,u,f,e)}return __extends(t,n),t}(n.PostProcess);n.BlackAndWhitePostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e,o){var s=this;n.call(this,t,"convolution",["kernel","screenSize"],null,r,u,f,e,o);this.kernel=i;this.onApply=function(n){n.setFloat2("screenSize",s.width,s.height);n.setArray("kernel",s.kernel)}}return __extends(t,n),t.EdgeDetect0Kernel=[1,0,-1,0,0,0,-1,0,1],t.EdgeDetect1Kernel=[0,1,0,1,-4,1,0,1,0],t.EdgeDetect2Kernel=[-1,-1,-1,-1,8,-1,-1,-1,-1],t.SharpenKernel=[0,-1,0,-1,5,-1,0,-1,0],t.EmbossKernel=[-2,-1,0,-1,1,1,0,1,2],t.GaussianKernel=[0,1,0,1,1,1,0,1,0],t}(n.PostProcess);n.ConvolutionPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e,o){var s=this;n.call(this,t,"filter",["kernelMatrix"],null,r,u,f,e,o);this.kernelMatrix=i;this.onApply=function(n){n.setMatrix("kernelMatrix",s.kernelMatrix)}}return __extends(t,n),t}(n.PostProcess);n.FilterPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){var o=this;n.call(this,t,"fxaa",["texelSize"],null,i,r,u,f,e);this.onSizeChanged=function(){o.texelWidth=1/o.width;o.texelHeight=1/o.height};this.onApply=function(n){n.setFloat2("texelSize",o.texelWidth,o.texelHeight)}}return __extends(t,n),t}(n.PostProcess);n.FxaaPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e){var o=this;t.call(this,i,"stereoscopicInterlace",["stepSize"],["camASampler"],1,r,e,r.getScene().getEngine(),!1,f?"#define IS_STEREOSCOPIC_HORIZ 1":void 0);this._stepSize=new n.Vector2(1/this.width,1/this.height);this.onSizeChanged=function(){o._stepSize=new n.Vector2(1/o.width,1/o.height)};this.onApply=function(n){n.setTextureFromPostProcess("camASampler",u);n.setFloat2("stepSize",o._stepSize.x,o._stepSize.y)}}return __extends(i,t),i}(n.PostProcess);n.StereoscopicInterlacePostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f){this.size=t;this.position=i;this.dispose=function(){this.texture&&this.texture.dispose();var n=this._system.lensFlares.indexOf(this);this._system.lensFlares.splice(n,1)};this.color=r||new n.Color3(1,1,1);this.texture=u?new n.Texture(u,f.getScene(),!0):null;this._system=f;f.lensFlares.push(this)}return t}();n.LensFlare=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t,i){var u,r;this.name=n;this.lensFlares=[];this.borderLimit=300;this.layerMask=268435455;this._vertexDeclaration=[2];this._vertexStrideSize=8;this._isEnabled=!0;this._scene=i;this._emitter=t;i.lensFlareSystems.push(this);this.meshesSelectionPredicate=function(n){return n.material&&n.isVisible&&n.isEnabled()&&n.isBlocker&&0!=(n.layerMask&i.activeCamera.layerMask)};u=[];u.push(1,1);u.push(-1,1);u.push(-1,-1);u.push(1,-1);this._vertexBuffer=i.getEngine().createVertexBuffer(u);r=[];r.push(0);r.push(1);r.push(2);r.push(0);r.push(2);r.push(3);this._indexBuffer=i.getEngine().createIndexBuffer(r);this._effect=this._scene.getEngine().createEffect("lensFlare",["position"],["color","viewportMatrix"],["textureSampler"],"")}return Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(n){this._isEnabled=n},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEmitter=function(){return this._emitter},t.prototype.setEmitter=function(n){this._emitter=n},t.prototype.getEmitterPosition=function(){return this._emitter.getAbsolutePosition?this._emitter.getAbsolutePosition():this._emitter.position},t.prototype.computeEffectivePosition=function(t){var i=this.getEmitterPosition();return i=n.Vector3.Project(i,n.Matrix.Identity(),this._scene.getTransformMatrix(),t),this._positionX=i.x,this._positionY=i.y,i=n.Vector3.TransformCoordinates(this.getEmitterPosition(),this._scene.getViewMatrix()),i.z>0&&this._positionX>t.x&&this._positionX<t.x+t.width&&this._positionY>t.y&&this._positionY<t.y+t.height?!0:!1},t.prototype._isVisible=function(){var r,i;if(!this._isEnabled)return!1;var u=this.getEmitterPosition(),t=u.subtract(this._scene.activeCamera.position),f=t.length();return t.normalize(),r=new n.Ray(this._scene.activeCamera.position,t),i=this._scene.pickWithRay(r,this.meshesSelectionPredicate,!0),!i.hit||i.distance>f},t.prototype.render=function(){var o,s,f,u,e;if(!this._effect.isReady())return!1;var i=this._scene.getEngine(),l=this._scene.activeCamera.viewport,t=l.toGlobal(i);if(!this.computeEffectivePosition(t)||!this._isVisible()||(o=this._positionX<this.borderLimit+t.x?this.borderLimit+t.x-this._positionX:this._positionX>t.x+t.width-this.borderLimit?this._positionX-t.x-t.width+this.borderLimit:0,s=this._positionY<this.borderLimit+t.y?this.borderLimit+t.y-this._positionY:this._positionY>t.y+t.height-this.borderLimit?this._positionY-t.y-t.height+this.borderLimit:0,f=o>s?o:s,f>this.borderLimit&&(f=this.borderLimit),u=1-f/this.borderLimit,0>u))return!1;u>1&&(u=1);var h=t.x+t.width/2,c=t.y+t.height/2,a=h-this._positionX,v=c-this._positionY;for(i.enableEffect(this._effect),i.setState(!1),i.setDepthBuffer(!1),i.setAlphaMode(n.Engine.ALPHA_ONEONE),i.bindBuffers(this._vertexBuffer,this._indexBuffer,this._vertexDeclaration,this._vertexStrideSize,this._effect),e=0;e<this.lensFlares.length;e++){var r=this.lensFlares[e],y=h-a*r.position,p=c-v*r.position,w=r.size,b=r.size*i.getAspectRatio(this._scene.activeCamera),k=2*(y/t.width)-1,d=1-2*(p/t.height),g=n.Matrix.FromValues(w/2,0,0,0,0,b/2,0,0,0,0,1,0,k,d,0,1);this._effect.setMatrix("viewportMatrix",g);this._effect.setTexture("textureSampler",r.texture);this._effect.setFloat4("color",r.color.r*u,r.color.g*u,r.color.b*u,1);i.draw(!0,0,6)}return i.setDepthBuffer(!0),i.setAlphaMode(n.Engine.ALPHA_DISABLE),!0},t.prototype.dispose=function(){for(this._vertexBuffer&&(this._scene.getEngine()._releaseBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);this.lensFlares.length;)this.lensFlares[0].dispose();var n=this._scene.lensFlareSystems.indexOf(this);this._scene.lensFlareSystems.splice(n,1)},t}();n.LensFlareSystem=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){this._registeredMeshes=[];this._physicsMaterials=[];this.updateBodyPosition=function(n){for(var r,t,u,i=0;i<this._registeredMeshes.length;i++)if(r=this._registeredMeshes[i],r.mesh===n||r.mesh===n.parent)return t=r.body,u=n.getBoundingInfo().boundingBox.center,t.position.set(u.x,u.z,u.y),t.quaternion.x=n.rotationQuaternion.x,t.quaternion.z=n.rotationQuaternion.y,t.quaternion.y=n.rotationQuaternion.z,void(t.quaternion.w=-n.rotationQuaternion.w)}}return t.prototype.initialize=function(n){void 0===n&&(n=10);this._world=new CANNON.World;this._world.broadphase=new CANNON.NaiveBroadphase;this._world.solver.iterations=n},t.prototype._checkWithEpsilon=function(t){return t<n.PhysicsEngine.Epsilon?n.PhysicsEngine.Epsilon:t},t.prototype.runOneStep=function(t){var r,i;for(this._world.step(t),r=0;r<this._registeredMeshes.length;r++)if(i=this._registeredMeshes[r],!i.isChild){var f=i.body.position.x,e=i.body.position.y,o=i.body.position.z,u=i.delta;u?(i.mesh.position.x=f+u.x,i.mesh.position.y=o+u.y,i.mesh.position.z=e+u.z):(i.mesh.position.x=f,i.mesh.position.y=o,i.mesh.position.z=e);i.mesh.rotationQuaternion||(i.mesh.rotationQuaternion=new n.Quaternion(0,0,0,1));i.mesh.rotationQuaternion.x=i.body.quaternion.x;i.mesh.rotationQuaternion.y=i.body.quaternion.z;i.mesh.rotationQuaternion.z=i.body.quaternion.y;i.mesh.rotationQuaternion.w=-i.body.quaternion.w}},t.prototype.setGravity=function(n){this._world.gravity.set(n.x,n.z,n.y)},t.prototype.registerMesh=function(t,i,r){var e,o;switch(this.unregisterMesh(t),t.computeWorldMatrix(!0),i){case n.PhysicsEngine.SphereImpostor:var u=t.getBoundingInfo().boundingBox,s=u.maximumWorld.x-u.minimumWorld.x,h=u.maximumWorld.y-u.minimumWorld.y,c=u.maximumWorld.z-u.minimumWorld.z;return this._createSphere(Math.max(this._checkWithEpsilon(s),this._checkWithEpsilon(h),this._checkWithEpsilon(c))/2,t,r);case n.PhysicsEngine.BoxImpostor:u=t.getBoundingInfo().boundingBox;var l=u.minimumWorld,a=u.maximumWorld,f=a.subtract(l).scale(.5);return this._createBox(this._checkWithEpsilon(f.x),this._checkWithEpsilon(f.y),this._checkWithEpsilon(f.z),t,r);case n.PhysicsEngine.PlaneImpostor:return this._createPlane(t,r);case n.PhysicsEngine.MeshImpostor:return e=t.getVerticesData(n.VertexBuffer.PositionKind),o=t.getIndices(),this._createConvexPolyhedron(e,o,t,r)}return null},t.prototype._createSphere=function(n,t,i){var r=new CANNON.Sphere(n);return i?this._createRigidBodyFromShape(r,t,i.mass,i.friction,i.restitution):r},t.prototype._createBox=function(n,t,i,r,u){var f=new CANNON.Box(new CANNON.Vec3(n,i,t));return u?this._createRigidBodyFromShape(f,r,u.mass,u.friction,u.restitution):f},t.prototype._createPlane=function(n,t){var i=new CANNON.Plane;return t?this._createRigidBodyFromShape(i,n,t.mass,t.friction,t.restitution):i},t.prototype._createConvexPolyhedron=function(t,i,r,u){var h=[],c=[],f,o,e,s;for(r.computeWorldMatrix(!0),f=0;f<t.length;f+=3)o=n.Vector3.Zero(),n.Vector3.TransformNormalFromFloatsToRef(t[f],t[f+1],t[f+2],r.getWorldMatrix(),o),h.push(new CANNON.Vec3(o.x,o.z,o.y));for(e=0;e<i.length;e+=3)c.push([i[e],i[e+2],i[e+1]]);return s=new CANNON.ConvexPolyhedron(h,c),u?this._createRigidBodyFromShape(s,r,u.mass,u.friction,u.restitution):s},t.prototype._addMaterial=function(n,t){for(var r,u,f,i=0;i<this._physicsMaterials.length;i++)if(r=this._physicsMaterials[i],r.friction===n&&r.restitution===t)return r;for(u=new CANNON.Material,u.friction=n,u.restitution=t,this._physicsMaterials.push(u),i=0;i<this._physicsMaterials.length;i++)r=this._physicsMaterials[i],f=new CANNON.ContactMaterial(r,u,r.friction*u.friction,r.restitution*u.restitution),f.contactEquationStiffness=1e10,f.contactEquationRegularizationTime=10,this._world.addContactMaterial(f);return u},t.prototype._createRigidBodyFromShape=function(t,i,r,u,f){var o=null;i.rotationQuaternion&&(o=i.rotationQuaternion.clone(),i.rotationQuaternion=new n.Quaternion(0,0,0,1));var s=i.getBoundingInfo().boundingBox,c=i.position.subtract(s.center),h=this._addMaterial(u,f),e=new CANNON.RigidBody(r,t,h);return o&&(e.quaternion.x=o.x,e.quaternion.z=o.y,e.quaternion.y=o.z,e.quaternion.w=-o.w),e.position.set(s.center.x,s.center.z,s.center.y),this._world.add(e),this._registeredMeshes.push({mesh:i,body:e,material:h,delta:c}),e},t.prototype.registerMeshesAsCompound=function(n,t){for(var r,f,o,e,u=new CANNON.Compound,i=0;i<n.length;i++)r=n[i].mesh,f=this.registerMesh(r,n[i].impostor),0==i?u.addChild(f,new CANNON.Vec3(0,0,0)):u.addChild(f,new CANNON.Vec3(r.position.x,r.position.z,r.position.y));return o=n[0].mesh,e=this._createRigidBodyFromShape(u,o,t.mass,t.friction,t.restitution),e.parts=n,e},t.prototype._unbindBody=function(n){for(var i,t=0;t<this._registeredMeshes.length;t++)i=this._registeredMeshes[t],i.body===n&&(i.body=null,i.delta=0)},t.prototype.unregisterMesh=function(n){for(var i,t=0;t<this._registeredMeshes.length;t++)if(i=this._registeredMeshes[t],i.mesh===n)return i.body&&(this._world.remove(i.body),this._unbindBody(i.body)),void this._registeredMeshes.splice(t,1)},t.prototype.applyImpulse=function(n,t,i){for(var u,f=new CANNON.Vec3(i.x,i.z,i.y),e=new CANNON.Vec3(t.x,t.z,t.y),r=0;r<this._registeredMeshes.length;r++)if(u=this._registeredMeshes[r],u.mesh===n)return void u.body.applyImpulse(e,f)},t.prototype.createLink=function(n,t,i,r){for(var u,s,f=null,e=null,o=0;o<this._registeredMeshes.length;o++)u=this._registeredMeshes[o],u.mesh===n?f=u.body:u.mesh===t&&(e=u.body);return!f||!e?!1:(s=new CANNON.PointToPointConstraint(f,new CANNON.Vec3(i.x,i.z,i.y),e,new CANNON.Vec3(r.x,r.z,r.y)),this._world.addConstraint(s),!0)},t.prototype.dispose=function(){for(;this._registeredMeshes.length;)this.unregisterMesh(this._registeredMeshes[0].mesh)},t.prototype.isSupported=function(){return void 0!==window.CANNON},t}();n.CannonJSPlugin=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){this._registeredMeshes=[];this.updateBodyPosition=function(n){for(var t,i,u,f,e,r=0;r<this._registeredMeshes.length;r++){if(t=this._registeredMeshes[r],t.mesh===n||t.mesh===n.parent)return i=t.body.body,n.computeWorldMatrix(!0),u=n.getBoundingInfo().boundingBox.center,i.setPosition(new OIMO.Vec3(u.x,u.y,u.z)),i.setRotation(new OIMO.Vec3(n.rotation.x,n.rotation.y,n.rotation.z)),void(i.sleeping=!1);if(t.mesh.parent===n)return n.computeWorldMatrix(!0),t.mesh.computeWorldMatrix(!0),f=t.mesh.getAbsolutePosition(),e=n.rotation,i=t.body.body,i.setPosition(new OIMO.Vec3(f.x,f.y,f.z)),i.setRotation(new OIMO.Vec3(e.x,e.y,e.z)),void(i.sleeping=!1)}}}return t.prototype._checkWithEpsilon=function(t){return t<n.PhysicsEngine.Epsilon?n.PhysicsEngine.Epsilon:t},t.prototype.initialize=function(){this._world=new OIMO.World;this._world.clear()},t.prototype.setGravity=function(n){this._world.gravity=n},t.prototype.registerMesh=function(t,i,r){var e=null,f,u,o,s;this.unregisterMesh(t);t.computeWorldMatrix(!0);f=null;t.rotationQuaternion&&(f=t.rotationQuaternion.clone(),t.rotationQuaternion=new n.Quaternion(0,0,0,1),t.computeWorldMatrix(!0));u=t.getBoundingInfo().boundingBox;o=t.position.subtract(u.center);f&&(s=new n.Matrix,f.toRotationMatrix(s),o=n.Vector3.TransformCoordinates(o,s));switch(i){case n.PhysicsEngine.SphereImpostor:var c=u.maximumWorld.x-u.minimumWorld.x,l=u.maximumWorld.y-u.minimumWorld.y,a=u.maximumWorld.z-u.minimumWorld.z,v=Math.max(this._checkWithEpsilon(c),this._checkWithEpsilon(l),this._checkWithEpsilon(a))/2;e=new OIMO.Body({type:"sphere",size:[v],pos:[u.center.x,u.center.y,u.center.z],rot:[t.rotation.x/OIMO.TO_RAD,t.rotation.y/OIMO.TO_RAD,t.rotation.z/OIMO.TO_RAD],move:0!=r.mass,config:[r.mass,r.friction,r.restitution],world:this._world});break;case n.PhysicsEngine.PlaneImpostor:case n.PhysicsEngine.CylinderImpostor:case n.PhysicsEngine.BoxImpostor:var y=u.minimumWorld,p=u.maximumWorld,h=p.subtract(y),w=this._checkWithEpsilon(h.x),b=this._checkWithEpsilon(h.y),k=this._checkWithEpsilon(h.z);e=new OIMO.Body({type:"box",size:[w,b,k],pos:[u.center.x,u.center.y,u.center.z],rot:[t.rotation.x/OIMO.TO_RAD,t.rotation.y/OIMO.TO_RAD,t.rotation.z/OIMO.TO_RAD],move:0!=r.mass,config:[r.mass,r.friction,r.restitution],world:this._world})}return f&&(e.body.orientation=new OIMO.Quat(f.w,f.x,f.y,f.z),e.body.syncShapes()),this._registeredMeshes.push({mesh:t,body:e,delta:o}),e},t.prototype.registerMeshesAsCompound=function(n,t){for(var c,i,o,s=[],r=[],u=[],f=[],h=n[0].mesh,e=0;e<n.length;e++)c=n[e],i=this._createBodyAsCompound(c,t,h),s.push(i.type),r.push.apply(r,i.size),u.push.apply(u,i.pos),f.push.apply(f,i.rot);return o=new OIMO.Body({type:s,size:r,pos:u,rot:f,move:0!=t.mass,config:[t.mass,t.friction,t.restitution],world:this._world}),this._registeredMeshes.push({mesh:h,body:o}),o},t.prototype._createBodyAsCompound=function(t){var u=null,i=t.mesh;switch(i.computeWorldMatrix(),t.impostor){case n.PhysicsEngine.SphereImpostor:var r=i.getBoundingInfo().boundingBox,o=r.maximumWorld.x-r.minimumWorld.x,s=r.maximumWorld.y-r.minimumWorld.y,h=r.maximumWorld.z-r.minimumWorld.z,c=Math.max(this._checkWithEpsilon(o),this._checkWithEpsilon(s),this._checkWithEpsilon(h))/2;u={type:"sphere",size:[c,-1,-1],pos:[i.position.x,i.position.y,i.position.z],rot:[i.rotation.x/OIMO.TO_RAD,i.rotation.y/OIMO.TO_RAD,i.rotation.z/OIMO.TO_RAD]};break;case n.PhysicsEngine.PlaneImpostor:case n.PhysicsEngine.BoxImpostor:r=i.getBoundingInfo().boundingBox;var l=r.minimumWorld,a=r.maximumWorld,f=a.subtract(l),v=this._checkWithEpsilon(f.x),y=this._checkWithEpsilon(f.y),p=this._checkWithEpsilon(f.z),e=i.position;u={type:"box",size:[v,y,p],pos:[e.x,e.y,e.z],rot:[i.rotation.x/OIMO.TO_RAD,i.rotation.y/OIMO.TO_RAD,i.rotation.z/OIMO.TO_RAD]}}return u},t.prototype.unregisterMesh=function(n){for(var t,i=0;i<this._registeredMeshes.length;i++)if(t=this._registeredMeshes[i],t.mesh===n||t.mesh===n.parent)return t.body&&(this._world.removeRigidBody(t.body.body),this._unbindBody(t.body)),void this._registeredMeshes.splice(i,1)},t.prototype._unbindBody=function(n){for(var i,t=0;t<this._registeredMeshes.length;t++)i=this._registeredMeshes[t],i.body===n&&(i.body=null)},t.prototype.applyImpulse=function(n,t,i){for(var r,f,u=0;u<this._registeredMeshes.length;u++)if(r=this._registeredMeshes[u],r.mesh===n||r.mesh===n.parent)return f=r.body.body.massInfo.mass,void r.body.body.applyImpulse(i.scale(OIMO.INV_SCALE),t.scale(OIMO.INV_SCALE*f))},t.prototype.createLink=function(n,t,i,r,u){for(var f,e=null,o=null,s=0;s<this._registeredMeshes.length;s++)f=this._registeredMeshes[s],f.mesh===n?e=f.body.body:f.mesh===t&&(o=f.body.body);return e&&o?(u||(u={}),new OIMO.Link({type:u.type,body1:e,body2:o,min:u.min,max:u.max,axe1:u.axe1,axe2:u.axe2,pos1:[i.x,i.y,i.z],pos2:[r.x,r.y,r.z],collision:u.collision,spring:u.spring,world:this._world}),!0):!1},t.prototype.dispose=function(){for(this._world.clear();this._registeredMeshes.length;)this.unregisterMesh(this._registeredMeshes[0].mesh)},t.prototype.isSupported=function(){return void 0!==OIMO},t.prototype._getLastShape=function(n){for(var t=n.shapes;t.next;)t=t.next;return t},t.prototype.runOneStep=function(){var o,r,e,i;for(this._world.step(),r=this._registeredMeshes.length;r--;){var u=this._registeredMeshes[r].body.body,t=this._registeredMeshes[r].mesh,f=this._registeredMeshes[r].delta;if(!u.sleeping)if(u.shapes.next)e=this._getLastShape(u),t.position.x=e.position.x*OIMO.WORLD_SCALE,t.position.y=e.position.y*OIMO.WORLD_SCALE,t.position.z=e.position.z*OIMO.WORLD_SCALE,i=n.Matrix.FromArray(u.getMatrix()),t.rotationQuaternion||(t.rotationQuaternion=new n.Quaternion(0,0,0,1)),t.rotationQuaternion.fromRotationMatrix(i),t.computeWorldMatrix();else{o=u.getMatrix();i=n.Matrix.FromArray(o);var s=i.m[12],h=i.m[13],c=i.m[14];f?(t.position.x=s+f.x,t.position.y=h+f.y,t.position.z=c+f.z):(t.position.x=s,t.position.y=h,t.position.z=c);t.rotationQuaternion||(t.rotationQuaternion=new n.Quaternion(0,0,0,1));n.Quaternion.FromRotationMatrixToRef(i,t.rotationQuaternion);t.computeWorldMatrix()}}},t}();n.OimoJSPlugin=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){this._currentPlugin=t||new n.OimoJSPlugin}return t.prototype._initialize=function(n){this._currentPlugin.initialize();this._setGravity(n)},t.prototype._runOneStep=function(n){n>.1?n=.1:0>=n&&(n=1/60);this._currentPlugin.runOneStep(n)},t.prototype._setGravity=function(t){this.gravity=t||new n.Vector3(0,-9.807,0);this._currentPlugin.setGravity(this.gravity)},t.prototype._registerMesh=function(n,t,i){return this._currentPlugin.registerMesh(n,t,i)},t.prototype._registerMeshesAsCompound=function(n,t){return this._currentPlugin.registerMeshesAsCompound(n,t)},t.prototype._unregisterMesh=function(n){this._currentPlugin.unregisterMesh(n)},t.prototype._applyImpulse=function(n,t,i){this._currentPlugin.applyImpulse(n,t,i)},t.prototype._createLink=function(n,t,i,r,u){return this._currentPlugin.createLink(n,t,i,r,u)},t.prototype._updateBodyPosition=function(n){this._currentPlugin.updateBodyPosition(n)},t.prototype.dispose=function(){this._currentPlugin.dispose()},t.prototype.isSupported=function(){return this._currentPlugin.isSupported()},t.NoImpostor=0,t.SphereImpostor=1,t.BoxImpostor=2,t.PlaneImpostor=3,t.MeshImpostor=4,t.CapsuleImpostor=5,t.ConeImpostor=6,t.CylinderImpostor=7,t.ConvexHullImpostor=8,t.Epsilon=.001,t}();n.PhysicsEngine=t}(BABYLON||(BABYLON={}));!function(n){var o,nt=function(t){var i={},u,r,f;return(i.name=t.name,i.id=t.id,i.tags=n.Tags.GetTags(t),t instanceof n.PointLight)?(i.type=0,i.position=t.position.asArray()):t instanceof n.DirectionalLight?(i.type=1,u=t,i.position=u.position.asArray(),i.direction=u.direction.asArray()):t instanceof n.SpotLight?(i.type=2,r=t,i.position=r.position.asArray(),i.direction=r.position.asArray(),i.angle=r.angle,i.exponent=r.exponent):t instanceof n.HemisphericLight&&(i.type=3,f=t,i.direction=f.direction.asArray(),i.groundColor=f.groundColor.asArray()),t.intensity&&(i.intensity=t.intensity),i.range=t.range,i.diffuse=t.diffuse.asArray(),i.specular=t.specular.asArray(),i},r=function(n){var t={};return t.isEnabled=n.isEnabled,t.leftColor=n.leftColor,t.rightColor=n.rightColor,t.bias=n.bias,t.power=n.power,t},u=function(n,t){var i,r;if(n.animations)for(t.animations=[],i=0;i<n.animations.length;i++)r=n.animations[i],t.animations.push(o(r))},tt=function(t){var i={},r,f;return(i.name=t.name,i.tags=n.Tags.GetTags(t),i.id=t.id,i.position=t.position.asArray(),t.parent&&(i.parentId=t.parent.id),i.fov=t.fov,i.minZ=t.minZ,i.maxZ=t.maxZ,i.inertia=t.inertia,t instanceof n.FreeCamera?i.type="FreeCamera":t instanceof n.ArcRotateCamera?i.type="ArcRotateCamera":t instanceof n.AnaglyphArcRotateCamera?i.type="AnaglyphArcRotateCamera":t instanceof n.GamepadCamera?i.type="GamepadCamera":t instanceof n.AnaglyphFreeCamera?i.type="AnaglyphFreeCamera":t instanceof n.DeviceOrientationCamera?i.type="DeviceOrientationCamera":t instanceof n.FollowCamera?i.type="FollowCamera":t instanceof n.TouchCamera?i.type="TouchCamera":t instanceof n.VirtualJoysticksCamera?i.type="VirtualJoysticksCamera":t instanceof n.WebVRFreeCamera?i.type="WebVRFreeCamera":t instanceof n.VRDeviceOrientationFreeCamera&&(i.type="VRDeviceOrientationFreeCamera"),t instanceof n.ArcRotateCamera||t instanceof n.AnaglyphArcRotateCamera)?(r=t,i.alpha=r.alpha,i.beta=r.beta,i.radius=r.radius,r.target&&r.target.id&&(i.lockedTargetId=r.target.id)):t instanceof n.FollowCamera?(f=t,i.radius=f.radius,i.heightOffset=f.heightOffset,i.rotationOffset=f.rotationOffset):(t instanceof n.AnaglyphFreeCamera||t instanceof n.AnaglyphArcRotateCamera)&&void 0!==t._interaxialDistance&&(i.interaxial_distance=n.Tools.ToDegrees(t._interaxialDistance)),void 0!==t.speed&&(i.speed=t.speed),t.target&&t.target instanceof n.Vector3&&(i.target=t.target.asArray()),t.rotation&&t.rotation instanceof n.Vector3&&(i.rotation=t.rotation.asArray()),t.lockedTarget&&t.lockedTarget.id&&(i.lockedTargetId=t.lockedTarget.id),i.checkCollisions=t.checkCollisions||!1,i.applyGravity=t.applyGravity||!1,t.ellipsoid&&(i.ellipsoid=t.ellipsoid.asArray()),u(t,i),i.layerMask=t.layerMask,i},t,f,e,i;o=function(t){var i={},o,e,u,f,r;for(i.name=t.name,i.property=t.targetProperty,i.framePerSecond=t.framePerSecond,i.dataType=t.dataType,i.loopBehavior=t.loopMode,o=t.dataType,i.keys=[],e=t.getKeys(),u=0;u<e.length;u++){f=e[u];r={};switch(r.frame=f.frame,o){case n.Animation.ANIMATIONTYPE_FLOAT:r.values=[f.value];break;case n.Animation.ANIMATIONTYPE_QUATERNION:case n.Animation.ANIMATIONTYPE_MATRIX:case n.Animation.ANIMATIONTYPE_VECTOR3:r.values=f.value.asArray()}i.keys.push(r)}return i};f=function(t){var i={},r,u;for(i.name=t.name,i.id=t.id,i.tags=n.Tags.GetTags(t),i.materials=[],r=0;r<t.subMaterials.length;r++)u=t.subMaterials[r],i.materials.push(u?u.id:null);return i};e=function(i){var u={};return u.name=i.name,u.ambient=i.ambientColor.asArray(),u.diffuse=i.diffuseColor.asArray(),u.specular=i.specularColor.asArray(),u.specularPower=i.specularPower,u.emissive=i.emissiveColor.asArray(),u.useReflectionFresnelFromSpecular=u.useReflectionFresnelFromSpecular,u.useEmissiveAsIllumination=u.useEmissiveAsIllumination,u.alpha=i.alpha,u.id=i.id,u.tags=n.Tags.GetTags(i),u.backFaceCulling=i.backFaceCulling,i.diffuseTexture&&(u.diffuseTexture=t(i.diffuseTexture)),i.diffuseFresnelParameters&&(u.diffuseFresnelParameters=r(i.diffuseFresnelParameters)),i.ambientTexture&&(u.ambientTexture=t(i.ambientTexture)),i.opacityTexture&&(u.opacityTexture=t(i.opacityTexture)),i.opacityFresnelParameters&&(u.opacityFresnelParameters=r(i.opacityFresnelParameters)),i.reflectionTexture&&(u.reflectionTexture=t(i.reflectionTexture)),i.reflectionFresnelParameters&&(u.reflectionFresnelParameters=r(i.reflectionFresnelParameters)),i.emissiveTexture&&(u.emissiveTexture=t(i.emissiveTexture)),i.emissiveFresnelParameters&&(u.emissiveFresnelParameters=r(i.emissiveFresnelParameters)),i.specularTexture&&(u.specularTexture=t(i.specularTexture)),i.bumpTexture&&(u.bumpTexture=t(i.bumpTexture)),u};t=function(t){var i={},r,e,o,f;if(!t.name)return null;if(t instanceof n.CubeTexture)return i.name=t.name,i.hasAlpha=t.hasAlpha,i.isCube=!0,i.level=t.level,i.coordinatesMode=t.coordinatesMode,i;if(t instanceof n.MirrorTexture){for(e=t,i.renderTargetSize=e.getRenderSize(),i.renderList=[],r=0;r<e.renderList.length;r++)i.renderList.push(e.renderList[r].id);i.mirrorPlane=e.mirrorPlane.asArray()}else if(t instanceof n.RenderTargetTexture)for(o=t,i.renderTargetSize=o.getRenderSize(),i.renderList=[],r=0;r<o.renderList.length;r++)i.renderList.push(o.renderList[r].id);return f=t,i.name=t.name,i.hasAlpha=t.hasAlpha,i.level=t.level,i.coordinatesIndex=t.coordinatesIndex,i.coordinatesMode=t.coordinatesMode,i.uOffset=f.uOffset,i.vOffset=f.vOffset,i.uScale=f.uScale,i.vScale=f.vScale,i.uAng=f.uAng,i.vAng=f.vAng,i.wAng=f.wAng,i.wrapU=t.wrapU,i.wrapV=t.wrapV,u(t,i),i};var c,l,a,v,y,p,w,b,k=function(n){var i={},r,t,u;for(i.name=n.name,i.id=n.id,i.bones=[],r=0;r<n.bones.length;r++)t=n.bones[r],u={parentBoneIndex:t.getParent()?n.bones.indexOf(t.getParent()):-1,name:t.name,matrix:t.getLocalMatrix().toArray()},i.bones.push(u),t.animations&&t.animations.length>0&&(u.animation=o(t.animations[0]));return i},it=function(n){var t={};return t.emitterId=n.emitter.id,t.capacity=n.getCapacity(),n.particleTexture&&(t.textureName=n.particleTexture.name),t.minAngularSpeed=n.minAngularSpeed,t.maxAngularSpeed=n.maxAngularSpeed,t.minSize=n.minSize,t.maxSize=n.maxSize,t.minLifeTime=n.minLifeTime,t.maxLifeTime=n.maxLifeTime,t.emitRate=n.emitRate,t.minEmitBox=n.minEmitBox.asArray(),t.maxEmitBox=n.maxEmitBox.asArray(),t.gravity=n.gravity.asArray(),t.direction1=n.direction1.asArray(),t.direction2=n.direction2.asArray(),t.color1=n.color1.asArray(),t.color2=n.color2.asArray(),t.colorDead=n.colorDead.asArray(),t.updateSpeed=n.updateSpeed,t.targetStopDuration=n.targetStopDuration,t.textureMask=n.textureMask.asArray(),t.blendMode=n.blendMode,t},rt=function(t){var i={},u,r;for(i.emitterId=t.getEmitter().id,i.borderLimit=t.borderLimit,i.flares=[],u=0;u<t.lensFlares.length;u++)r=t.lensFlares[u],i.flares.push({size:r.size,position:r.position,color:r.color.asArray(),textureName:n.Tools.GetFilename(r.texture.name)});return i},ut=function(n){var t={},i=n.getShadowGenerator(),r,u;for(t.lightId=n.id,t.mapSize=i.getShadowMap().getRenderSize(),t.useVarianceShadowMap=i.useVarianceShadowMap,t.usePoissonSampling=i.usePoissonSampling,t.renderList=[],r=0;r<i.getShadowMap().renderList.length;r++)u=i.getShadowMap().renderList[r],t.renderList.push(u.id);return t},s=[],h=function(t,i){if(!s[t.id]){if(t instanceof n.Geometry.Primitives.Box)i.boxes.push(b(t));else if(t instanceof n.Geometry.Primitives.Sphere)i.spheres.push(w(t));else if(t instanceof n.Geometry.Primitives.Cylinder)i.cylinders.push(p(t));else if(t instanceof n.Geometry.Primitives.Torus)i.toruses.push(y(t));else if(t instanceof n.Geometry.Primitives.Ground)i.grounds.push(v(t));else if(t instanceof n.Geometry.Primitives.Plane)i.planes.push(a(t));else if(t instanceof n.Geometry.Primitives.TorusKnot)i.torusKnots.push(l(t));else{if(t instanceof n.Geometry.Primitives._Primitive)throw new Error("Unknown primitive type");i.vertexData.push(c(t))}s[t.id]=!0}},d=function(t){var i={};return i.id=t.id,n.Tags.HasTags(t)&&(i.tags=n.Tags.GetTags(t)),i};c=function(t){var i=d(t);return t.isVerticesDataPresent(n.VertexBuffer.PositionKind)&&(i.positions=t.getVerticesData(n.VertexBuffer.PositionKind)),t.isVerticesDataPresent(n.VertexBuffer.NormalKind)&&(i.normals=t.getVerticesData(n.VertexBuffer.NormalKind)),t.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(i.uvs=t.getVerticesData(n.VertexBuffer.UVKind)),t.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(i.uvs2=t.getVerticesData(n.VertexBuffer.UV2Kind)),t.isVerticesDataPresent(n.VertexBuffer.UV3Kind)&&(i.uvs3=t.getVerticesData(n.VertexBuffer.UV3Kind)),t.isVerticesDataPresent(n.VertexBuffer.UV4Kind)&&(i.uvs4=t.getVerticesData(n.VertexBuffer.UV4Kind)),t.isVerticesDataPresent(n.VertexBuffer.UV5Kind)&&(i.uvs5=t.getVerticesData(n.VertexBuffer.UV5Kind)),t.isVerticesDataPresent(n.VertexBuffer.UV6Kind)&&(i.uvs6=t.getVerticesData(n.VertexBuffer.UV6Kind)),t.isVerticesDataPresent(n.VertexBuffer.ColorKind)&&(i.colors=t.getVerticesData(n.VertexBuffer.ColorKind)),t.isVerticesDataPresent(n.VertexBuffer.MatricesIndicesKind)&&(i.matricesIndices=t.getVerticesData(n.VertexBuffer.MatricesIndicesKind),i.matricesIndices._isExpanded=!0),t.isVerticesDataPresent(n.VertexBuffer.MatricesWeightsKind)&&(i.matricesWeights=t.getVerticesData(n.VertexBuffer.MatricesWeightsKind)),i.indices=t.getIndices(),i};i=function(n){var t=d(n);return t.canBeRegenerated=n.canBeRegenerated(),t};b=function(n){var t=i(n);return t.size=n.size,t};w=function(n){var t=i(n);return t.segments=n.segments,t.diameter=n.diameter,t};p=function(n){var t=i(n);return t.height=n.height,t.diameterTop=n.diameterTop,t.diameterBottom=n.diameterBottom,t.tessellation=n.tessellation,t};y=function(n){var t=i(n);return t.diameter=n.diameter,t.thickness=n.thickness,t.tessellation=n.tessellation,t};v=function(n){var t=i(n);return t.width=n.width,t.height=n.height,t.subdivisions=n.subdivisions,t};a=function(n){var t=i(n);return t.size=n.size,t};l=function(n){var t=i(n);return t.radius=n.radius,t.tube=n.tube,t.radialSegments=n.radialSegments,t.tubularSegments=n.tubularSegments,t.p=n.p,t.q=n.q,t};var g=function(t,i){var r={},o,l,s,e,c,f,a;if(r.name=t.name,r.id=t.id,n.Tags.HasTags(t)&&(r.tags=n.Tags.GetTags(t)),r.position=t.position.asArray(),t.rotationQuaternion?r.rotationQuaternion=t.rotationQuaternion.asArray():t.rotation&&(r.rotation=t.rotation.asArray()),r.scaling=t.scaling.asArray(),r.localMatrix=t.getPivotMatrix().asArray(),r.isEnabled=t.isEnabled(),r.isVisible=t.isVisible,r.infiniteDistance=t.infiniteDistance,r.pickable=t.isPickable,r.receiveShadows=t.receiveShadows,r.billboardMode=t.billboardMode,r.visibility=t.visibility,r.checkCollisions=t.checkCollisions,t.parent&&(r.parentId=t.parent.id),o=t._geometry,o)for(l=o.id,r.geometryId=l,t.getScene().getGeometryByID(l)||h(o,i.geometries),r.subMeshes=[],s=0;s<t.subMeshes.length;s++)e=t.subMeshes[s],r.subMeshes.push({materialIndex:e.materialIndex,verticesStart:e.verticesStart,verticesCount:e.verticesCount,indexStart:e.indexStart,indexCount:e.indexCount});if(t.material?r.materialId=t.material.id:t.material=null,t.skeleton&&(r.skeletonId=t.skeleton.id),t.getPhysicsImpostor()!==n.PhysicsEngine.NoImpostor)switch(r.physicsMass=t.getPhysicsMass(),r.physicsFriction=t.getPhysicsFriction(),r.physicsRestitution=t.getPhysicsRestitution(),t.getPhysicsImpostor()){case n.PhysicsEngine.BoxImpostor:r.physicsImpostor=1;break;case n.PhysicsEngine.SphereImpostor:r.physicsImpostor=2}for(r.instances=[],c=0;c<t.instances.length;c++)f=t.instances[c],a={name:f.name,position:f.position,rotation:f.rotation,rotationQuaternion:f.rotationQuaternion,scaling:f.scaling},r.instances.push(a),u(f,a);return u(t,r),r.layerMask=t.layerMask,r},ft=function(t,i){if(t.delayLoadState===n.Engine.DELAYLOADSTATE_LOADED||t.delayLoadState===n.Engine.DELAYLOADSTATE_NONE){t.material&&(t.material instanceof n.StandardMaterial?(i.materials=i.materials||[],i.materials.some(function(n){return n.id===t.material.id})||i.materials.push(e(t.material))):t.material instanceof n.MultiMaterial&&(i.multiMaterials=i.multiMaterials||[],i.multiMaterials.some(function(n){return n.id===t.material.id})||i.multiMaterials.push(f(t.material))));var r=t._geometry;r&&(i.geometries||(i.geometries={},i.geometries.boxes=[],i.geometries.spheres=[],i.geometries.cylinders=[],i.geometries.toruses=[],i.geometries.grounds=[],i.geometries.planes=[],i.geometries.torusKnots=[],i.geometries.vertexData=[]),h(r,i.geometries));t.skeleton&&(i.skeletons=i.skeletons||[],i.skeletons.push(k(t.skeleton)));i.meshes=i.meshes||[];i.meshes.push(g(t,i))}},et=function(){function t(){}return t.Serialize=function(t){var i={},r,o,y,u,p,l,a,v,c;for(i.useDelayedTextureLoading=t.useDelayedTextureLoading,i.autoClear=t.autoClear,i.clearColor=t.clearColor.asArray(),i.ambientColor=t.ambientColor.asArray(),i.gravity=t.gravity.asArray(),t.fogMode&&0!==t.fogMode&&(i.fogMode=t.fogMode,i.fogColor=t.fogColor.asArray(),i.fogStart=t.fogStart,i.fogEnd=t.fogEnd,i.fogDensity=t.fogDensity),i.lights=[],r=0;r<t.lights.length;r++)o=t.lights[r],i.lights.push(nt(o));for(i.cameras=[],r=0;r<t.cameras.length;r++)y=t.cameras[r],i.cameras.push(tt(y));for(t.activeCamera&&(i.activeCameraID=t.activeCamera.id),i.materials=[],i.multiMaterials=[],r=0;r<t.materials.length;r++)u=t.materials[r],i.materials.push(e(u));for(i.multiMaterials=[],r=0;r<t.multiMaterials.length;r++)p=t.multiMaterials[r],i.multiMaterials.push(f(p));for(r=0;r<t.materials.length;r++)u=t.materials[r],u instanceof n.StandardMaterial?i.materials.push(e(u)):u instanceof n.MultiMaterial&&i.multiMaterials.push(f(u));for(i.skeletons=[],r=0;r<t.skeletons.length;r++)i.skeletons.push(k(t.skeletons[r]));for(i.geometries={},i.geometries.boxes=[],i.geometries.spheres=[],i.geometries.cylinders=[],i.geometries.toruses=[],i.geometries.grounds=[],i.geometries.planes=[],i.geometries.torusKnots=[],i.geometries.vertexData=[],s=[],l=t.getGeometries(),r=0;r<l.length;r++)a=l[r],a.isReady()&&h(a,i.geometries);for(i.meshes=[],r=0;r<t.meshes.length;r++)v=t.meshes[r],v instanceof n.Mesh&&(c=v,(c.delayLoadState===n.Engine.DELAYLOADSTATE_LOADED||c.delayLoadState===n.Engine.DELAYLOADSTATE_NONE)&&i.meshes.push(g(c,i)));for(i.particleSystems=[],r=0;r<t.particleSystems.length;r++)i.particleSystems.push(it(t.particleSystems[r]));for(i.lensFlareSystems=[],r=0;r<t.lensFlareSystems.length;r++)i.lensFlareSystems.push(rt(t.lensFlareSystems[r]));for(i.shadowGenerators=[],r=0;r<t.lights.length;r++)o=t.lights[r],o.getShadowGenerator()&&i.shadowGenerators.push(ut(o));return i},t.SerializeMesh=function(t,i,r){var f,u;if(void 0===i&&(i=!1),void 0===r&&(r=!1),f={},t=t instanceof Array?t:[t],i||r)for(u=0;u<t.length;++u)r&&t[u].getDescendants().forEach(function(i){i instanceof n.Mesh&&t.indexOf(i)<0&&t.push(i)}),i&&t[u].parent&&t.indexOf(t[u].parent)<0&&t.push(t[u].parent);return t.forEach(function(n){ft(n,f)}),f},t}();n.SceneSerializer=et}(BABYLON||(BABYLON={}));!function(n){var r=0,u=function(){function t(n,t,i){this.pos=n;this.normal=t;this.uv=i}return t.prototype.clone=function(){return new t(this.pos.clone(),this.normal.clone(),this.uv.clone())},t.prototype.flip=function(){this.normal=this.normal.scale(-1)},t.prototype.interpolate=function(i,r){return new t(n.Vector3.Lerp(this.pos,i.pos,r),n.Vector3.Lerp(this.normal,i.normal,r),n.Vector2.Lerp(this.uv,i.uv,r))},t}(),f=function(){function t(n,t){this.normal=n;this.w=t}return t.FromPoints=function(i,r,u){var e=u.subtract(i),o=r.subtract(i),f;return 0===e.lengthSquared()||0===o.lengthSquared()?null:(f=n.Vector3.Normalize(n.Vector3.Cross(e,o)),new t(f,n.Vector3.Dot(f,i)))},t.prototype.clone=function(){return new t(this.normal.clone(),this.w)},t.prototype.flip=function(){this.normal.scaleInPlace(-1);this.w=-this.w},t.prototype.splitPolygon=function(r,u,f,e,o){for(var l,k,a,v,d,c,g=0,w=1,y=2,nt=3,tt=0,b=[],s=0;s<r.vertices.length;s++)l=n.Vector3.Dot(this.normal,r.vertices[s].pos)-this.w,k=l<-t.EPSILON?y:l>t.EPSILON?w:g,tt|=k,b.push(k);switch(tt){case g:(n.Vector3.Dot(this.normal,r.plane.normal)>0?u:f).push(r);break;case w:e.push(r);break;case y:o.push(r);break;case nt:for(a=[],v=[],s=0;s<r.vertices.length;s++){var it=(s+1)%r.vertices.length,p=b[s],ut=b[it],h=r.vertices[s],rt=r.vertices[it];(p!=y&&a.push(h),p!=w&&v.push(p!=y?h.clone():h),(p|ut)==nt)&&(l=(this.w-n.Vector3.Dot(this.normal,h.pos))/n.Vector3.Dot(this.normal,rt.pos.subtract(h.pos)),d=h.interpolate(rt,l),a.push(d),v.push(d.clone()))}a.length>=3&&(c=new i(a,r.shared),c.plane&&e.push(c));v.length>=3&&(c=new i(v,r.shared),c.plane&&o.push(c))}},t.EPSILON=1e-5,t}(),i=function(){function n(n,t){this.vertices=n;this.shared=t;this.plane=f.FromPoints(n[0].pos,n[1].pos,n[2].pos)}return n.prototype.clone=function(){var t=this.vertices.map(function(n){return n.clone()});return new n(t,this.shared)},n.prototype.flip=function(){this.vertices.reverse().map(function(n){n.flip()});this.plane.flip()},n}(),t=function(){function n(n){this.plane=null;this.front=null;this.back=null;this.polygons=[];n&&this.build(n)}return n.prototype.clone=function(){var t=new n;return t.plane=this.plane&&this.plane.clone(),t.front=this.front&&this.front.clone(),t.back=this.back&&this.back.clone(),t.polygons=this.polygons.map(function(n){return n.clone()}),t},n.prototype.invert=function(){for(var t,n=0;n<this.polygons.length;n++)this.polygons[n].flip();this.plane&&this.plane.flip();this.front&&this.front.invert();this.back&&this.back.invert();t=this.front;this.front=this.back;this.back=t},n.prototype.clipPolygons=function(n){if(!this.plane)return n.slice();for(var t=[],i=[],r=0;r<n.length;r++)this.plane.splitPolygon(n[r],t,i,t,i);return this.front&&(t=this.front.clipPolygons(t)),i=this.back?this.back.clipPolygons(i):[],t.concat(i)},n.prototype.clipTo=function(n){this.polygons=n.clipPolygons(this.polygons);this.front&&this.front.clipTo(n);this.back&&this.back.clipTo(n)},n.prototype.allPolygons=function(){var n=this.polygons.slice();return this.front&&(n=n.concat(this.front.allPolygons())),this.back&&(n=n.concat(this.back.allPolygons())),n},n.prototype.build=function(t){if(t.length){this.plane||(this.plane=t[0].plane.clone());for(var i=[],r=[],u=0;u<t.length;u++)this.plane.splitPolygon(t[u],this.polygons,this.polygons,i,r);i.length&&(this.front||(this.front=new n),this.front.build(i));r.length&&(this.back||(this.back=new n),this.back.build(r))}},n}(),e=function(){function f(){this.polygons=[]}return f.FromMesh=function(t){var b,k,d,g,v,y,a,nt,tt,it,rt,ut=[],e,et,o,ot,st,c;if(!(t instanceof n.Mesh))throw"BABYLON.CSG: Wrong Mesh type, must be BABYLON.Mesh";t.computeWorldMatrix(!0);a=t.getWorldMatrix();nt=t.position.clone();tt=t.rotation.clone();t.rotationQuaternion&&(it=t.rotationQuaternion.clone());rt=t.scaling.clone();for(var s=t.getIndices(),p=t.getVerticesData(n.VertexBuffer.PositionKind),w=t.getVerticesData(n.VertexBuffer.NormalKind),ft=t.getVerticesData(n.VertexBuffer.UVKind),l=t.subMeshes,h=0,ht=l.length;ht>h;h++)for(e=l[h].indexStart,et=l[h].indexCount+l[h].indexStart;et>e;e+=3){for(y=[],o=0;3>o;o++)ot=new n.Vector3(w[3*s[e+o]],w[3*s[e+o]+1],w[3*s[e+o]+2]),d=new n.Vector2(ft[2*s[e+o]],ft[2*s[e+o]+1]),st=new n.Vector3(p[3*s[e+o]],p[3*s[e+o]+1],p[3*s[e+o]+2]),g=n.Vector3.TransformCoordinates(st,a),k=n.Vector3.TransformNormal(ot,a),b=new u(g,k,d),y.push(b);v=new i(y,{subMeshId:h,meshId:r,materialIndex:l[h].materialIndex});v.plane&&ut.push(v)}return c=f.FromPolygons(ut),c.matrix=a,c.position=nt,c.rotation=tt,c.scaling=rt,c.rotationQuaternion=it,r++,c},f.FromPolygons=function(n){var t=new f;return t.polygons=n,t},f.prototype.clone=function(){var n=new f;return n.polygons=this.polygons.map(function(n){return n.clone()}),n.copyTransformAttributes(this),n},f.prototype.toPolygons=function(){return this.polygons},f.prototype.union=function(n){var r=new t(this.clone().polygons),i=new t(n.clone().polygons);return r.clipTo(i),i.clipTo(r),i.invert(),i.clipTo(r),i.invert(),r.build(i.allPolygons()),f.FromPolygons(r.allPolygons()).copyTransformAttributes(this)},f.prototype.unionInPlace=function(n){var r=new t(this.polygons),i=new t(n.polygons);r.clipTo(i);i.clipTo(r);i.invert();i.clipTo(r);i.invert();r.build(i.allPolygons());this.polygons=r.allPolygons()},f.prototype.subtract=function(n){var i=new t(this.clone().polygons),r=new t(n.clone().polygons);return i.invert(),i.clipTo(r),r.clipTo(i),r.invert(),r.clipTo(i),r.invert(),i.build(r.allPolygons()),i.invert(),f.FromPolygons(i.allPolygons()).copyTransformAttributes(this)},f.prototype.subtractInPlace=function(n){var i=new t(this.polygons),r=new t(n.polygons);i.invert();i.clipTo(r);r.clipTo(i);r.invert();r.clipTo(i);r.invert();i.build(r.allPolygons());i.invert();this.polygons=i.allPolygons()},f.prototype.intersect=function(n){var i=new t(this.clone().polygons),r=new t(n.clone().polygons);return i.invert(),r.clipTo(i),r.invert(),i.clipTo(r),r.clipTo(i),i.build(r.allPolygons()),i.invert(),f.FromPolygons(i.allPolygons()).copyTransformAttributes(this)},f.prototype.intersectInPlace=function(n){var i=new t(this.polygons),r=new t(n.polygons);i.invert();r.clipTo(i);r.invert();i.clipTo(r);r.clipTo(i);i.build(r.allPolygons());i.invert();this.polygons=i.allPolygons()},f.prototype.inverse=function(){var n=this.clone();return n.inverseInPlace(),n},f.prototype.inverseInPlace=function(){this.polygons.map(function(n){n.flip()})},f.prototype.copyTransformAttributes=function(n){return this.matrix=n.matrix,this.position=n.position,this.rotation=n.rotation,this.scaling=n.scaling,this.rotationQuaternion=n.rotationQuaternion,this},f.prototype.buildMeshGeometry=function(t,i,r){var g=this.matrix.clone(),b,st,p,ht,l,e,k,d,rt,ut,ct;g.invert();var u,o,f,h=new n.Mesh(t,i),nt=[],ft=[],a=[],w=[],et=n.Vector3.Zero(),v=n.Vector3.Zero(),y=n.Vector2.Zero(),tt=this.polygons,c=[0,0,0],ot={},it=0,s={};for(r&&tt.sort(function(n,t){return n.shared.meshId===t.shared.meshId?n.shared.subMeshId-t.shared.subMeshId:n.shared.meshId-t.shared.meshId}),b=0,st=tt.length;st>b;b++)for(u=tt[b],s[u.shared.meshId]||(s[u.shared.meshId]={}),s[u.shared.meshId][u.shared.subMeshId]||(s[u.shared.meshId][u.shared.subMeshId]={indexStart:+(1/0),indexEnd:-(1/0),materialIndex:u.shared.materialIndex}),f=s[u.shared.meshId][u.shared.subMeshId],p=2,ht=u.vertices.length;ht>p;p++)for(c[0]=0,c[1]=p-1,c[2]=p,l=0;3>l;l++)et.copyFrom(u.vertices[c[l]].pos),v.copyFrom(u.vertices[c[l]].normal),y.copyFrom(u.vertices[c[l]].uv),e=n.Vector3.TransformCoordinates(et,g),k=n.Vector3.TransformNormal(v,g),o=ot[e.x+","+e.y+","+e.z],("undefined"==typeof o||a[3*o]!==k.x||a[3*o+1]!==k.y||a[3*o+2]!==k.z||w[2*o]!==y.x||w[2*o+1]!==y.y)&&(nt.push(e.x,e.y,e.z),w.push(y.x,y.y),a.push(v.x,v.y,v.z),o=ot[e.x+","+e.y+","+e.z]=nt.length/3-1),ft.push(o),f.indexStart=Math.min(it,f.indexStart),f.indexEnd=Math.max(it,f.indexEnd),it++;if(h.setVerticesData(n.VertexBuffer.PositionKind,nt),h.setVerticesData(n.VertexBuffer.NormalKind,a),h.setVerticesData(n.VertexBuffer.UVKind,w),h.setIndices(ft),r){rt=0;h.subMeshes.length=0;for(ut in s){d=-1;for(ct in s[ut])f=s[ut][ct],n.SubMesh.CreateFromIndices(f.materialIndex+rt,f.indexStart,f.indexEnd-f.indexStart+1,h),d=Math.max(f.materialIndex,d);rt+=++d}}return h},f.prototype.toMesh=function(n,t,i,r){var u=this.buildMeshGeometry(n,i,r);return u.material=t,u.position.copyFrom(this.position),u.rotation.copyFrom(this.rotation),this.rotationQuaternion&&(u.rotationQuaternion=this.rotationQuaternion.clone()),u.scaling.copyFrom(this.scaling),u.computeWorldMatrix(!0),u},f}();n.CSG=e}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){var e=this;t.call(this,i,"vrDistortionCorrection",["LensCenter","Scale","ScaleIn","HmdWarpParam"],null,f.postProcessScaleFactor,r,n.Texture.BILINEAR_SAMPLINGMODE,null,null);this._isRightEye=u;this._distortionFactors=f.distortionK;this._postProcessScaleFactor=f.postProcessScaleFactor;this._lensCenterOffset=f.lensCenterOffset;this.onSizeChanged=function(){e.aspectRatio=.5*e.width/e.height;e._scaleIn=new n.Vector2(2,2/e.aspectRatio);e._scaleFactor=new n.Vector2(.5*(1/e._postProcessScaleFactor),.5*(1/e._postProcessScaleFactor)*e.aspectRatio);e._lensCenter=new n.Vector2(e._isRightEye?.5-.5*e._lensCenterOffset:.5+.5*e._lensCenterOffset,.5)};this.onApply=function(n){n.setFloat2("LensCenter",e._lensCenter.x,e._lensCenter.y);n.setFloat2("Scale",e._scaleFactor.x,e._scaleFactor.y);n.setFloat2("ScaleIn",e._scaleIn.x,e._scaleIn.y);n.setFloat4("HmdWarpParam",e._distortionFactors[0],e._distortionFactors[1],e._distortionFactors[2],e._distortionFactors[3])}}return __extends(i,t),i}(n.PostProcess);n.VRDistortionCorrectionPostProcess=t}(BABYLON||(BABYLON={}));!function(n){!function(n){n[n.X=0]="X";n[n.Y=1]="Y";n[n.Z=2]="Z"}(n.JoystickAxis||(n.JoystickAxis={}));var t=n.JoystickAxis,i=function(){function i(r){var u=this;this._leftJoystick=r?!0:!1;this._joystickIndex=i._globalJoystickIndex;i._globalJoystickIndex++;this._axisTargetedByLeftAndRight=t.X;this._axisTargetedByUpAndDown=t.Y;this.reverseLeftRight=!1;this.reverseUpDown=!1;this._touches=new n.SmartCollection;this.deltaPosition=n.Vector3.Zero();this._joystickSensibility=25;this._inversedSensibility=1e3/this._joystickSensibility;this._rotationSpeed=25;this._inverseRotationSpeed=1e3/this._rotationSpeed;this._rotateOnAxisRelativeToMesh=!1;this._onResize=function(){i.vjCanvasWidth=window.innerWidth;i.vjCanvasHeight=window.innerHeight;i.vjCanvas.width=i.vjCanvasWidth;i.vjCanvas.height=i.vjCanvasHeight;i.halfWidth=i.vjCanvasWidth/2;i.halfHeight=i.vjCanvasHeight/2};i.vjCanvas||(window.addEventListener("resize",this._onResize,!1),i.vjCanvas=document.createElement("canvas"),i.vjCanvasWidth=window.innerWidth,i.vjCanvasHeight=window.innerHeight,i.vjCanvas.width=window.innerWidth,i.vjCanvas.height=window.innerHeight,i.vjCanvas.style.width="100%",i.vjCanvas.style.height="100%",i.vjCanvas.style.position="absolute",i.vjCanvas.style.backgroundColor="transparent",i.vjCanvas.style.top="0px",i.vjCanvas.style.left="0px",i.vjCanvas.style.zIndex="5",i.vjCanvas.style.msTouchAction="none",i.vjCanvasContext=i.vjCanvas.getContext("2d"),i.vjCanvasContext.strokeStyle="#ffffff",i.vjCanvasContext.lineWidth=2,document.body.appendChild(i.vjCanvas));i.halfWidth=i.vjCanvas.width/2;i.halfHeight=i.vjCanvas.height/2;this.pressed=!1;this._joystickColor="cyan";this._joystickPointerID=-1;this._joystickPointerPos=new n.Vector2(0,0);this._joystickPreviousPointerPos=new n.Vector2(0,0);this._joystickPointerStartPos=new n.Vector2(0,0);this._deltaJoystickVector=new n.Vector2(0,0);this._onPointerDownHandlerRef=function(n){u._onPointerDown(n)};this._onPointerMoveHandlerRef=function(n){u._onPointerMove(n)};this._onPointerOutHandlerRef=function(n){u._onPointerUp(n)};this._onPointerUpHandlerRef=function(n){u._onPointerUp(n)};i.vjCanvas.addEventListener("pointerdown",this._onPointerDownHandlerRef,!1);i.vjCanvas.addEventListener("pointermove",this._onPointerMoveHandlerRef,!1);i.vjCanvas.addEventListener("pointerup",this._onPointerUpHandlerRef,!1);i.vjCanvas.addEventListener("pointerout",this._onPointerUpHandlerRef,!1);i.vjCanvas.addEventListener("contextmenu",function(n){n.preventDefault()},!1);requestAnimationFrame(function(){u._drawVirtualJoystick()})}return i.prototype.setJoystickSensibility=function(n){this._joystickSensibility=n;this._inversedSensibility=1e3/this._joystickSensibility},i.prototype._onPointerDown=function(n){var t;n.preventDefault();t=this._leftJoystick===!0?n.clientX<i.halfWidth:n.clientX>i.halfWidth;t&&this._joystickPointerID<0?(this._joystickPointerID=n.pointerId,this._joystickPointerStartPos.x=n.clientX,this._joystickPointerStartPos.y=n.clientY,this._joystickPointerPos=this._joystickPointerStartPos.clone(),this._joystickPreviousPointerPos=this._joystickPointerStartPos.clone(),this._deltaJoystickVector.x=0,this._deltaJoystickVector.y=0,this.pressed=!0,this._touches.add(n.pointerId.toString(),n)):i._globalJoystickIndex<2&&this._action&&(this._action(),this._touches.add(n.pointerId.toString(),{x:n.clientX,y:n.clientY,prevX:n.clientX,prevY:n.clientY}))},i.prototype._onPointerMove=function(n){var u,i,f,r;if(this._joystickPointerID==n.pointerId){this._joystickPointerPos.x=n.clientX;this._joystickPointerPos.y=n.clientY;this._deltaJoystickVector=this._joystickPointerPos.clone();this._deltaJoystickVector=this._deltaJoystickVector.subtract(this._joystickPointerStartPos);u=this.reverseLeftRight?-1:1;i=u*this._deltaJoystickVector.x/this._inversedSensibility;switch(this._axisTargetedByLeftAndRight){case t.X:this.deltaPosition.x=Math.min(1,Math.max(-1,i));break;case t.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,i));break;case t.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,i))}f=this.reverseUpDown?1:-1;r=f*this._deltaJoystickVector.y/this._inversedSensibility;switch(this._axisTargetedByUpAndDown){case t.X:this.deltaPosition.x=Math.min(1,Math.max(-1,r));break;case t.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,r));break;case t.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,r))}}else this._touches.item(n.pointerId.toString())&&(this._touches.item(n.pointerId.toString()).x=n.clientX,this._touches.item(n.pointerId.toString()).y=n.clientY)},i.prototype._onPointerUp=function(n){if(this._joystickPointerID==n.pointerId)i.vjCanvasContext.clearRect(this._joystickPointerStartPos.x-63,this._joystickPointerStartPos.y-63,126,126),i.vjCanvasContext.clearRect(this._joystickPreviousPointerPos.x-41,this._joystickPreviousPointerPos.y-41,82,82),this._joystickPointerID=-1,this.pressed=!1;else{var t=this._touches.item(n.pointerId.toString());t&&i.vjCanvasContext.clearRect(t.prevX-43,t.prevY-43,86,86)}this._deltaJoystickVector.x=0;this._deltaJoystickVector.y=0;this._touches.remove(n.pointerId.toString())},i.prototype.setJoystickColor=function(n){this._joystickColor=n},i.prototype.setActionOnTouch=function(n){this._action=n},i.prototype.setAxisForLeftRight=function(n){switch(n){case t.X:case t.Y:case t.Z:this._axisTargetedByLeftAndRight=n;break;default:this._axisTargetedByLeftAndRight=t.X}},i.prototype.setAxisForUpDown=function(n){switch(n){case t.X:case t.Y:case t.Z:this._axisTargetedByUpAndDown=n;break;default:this._axisTargetedByUpAndDown=t.Y}},i.prototype._clearCanvas=function(){this._leftJoystick?i.vjCanvasContext.clearRect(0,0,i.vjCanvasWidth/2,i.vjCanvasHeight):i.vjCanvasContext.clearRect(i.vjCanvasWidth/2,0,i.vjCanvasWidth,i.vjCanvasHeight)},i.prototype._drawVirtualJoystick=function(){var n=this;this.pressed&&this._touches.forEach(function(t){t.pointerId===n._joystickPointerID?(i.vjCanvasContext.clearRect(n._joystickPointerStartPos.x-63,n._joystickPointerStartPos.y-63,126,126),i.vjCanvasContext.clearRect(n._joystickPreviousPointerPos.x-41,n._joystickPreviousPointerPos.y-41,82,82),i.vjCanvasContext.beginPath(),i.vjCanvasContext.lineWidth=6,i.vjCanvasContext.strokeStyle=n._joystickColor,i.vjCanvasContext.arc(n._joystickPointerStartPos.x,n._joystickPointerStartPos.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle=n._joystickColor,i.vjCanvasContext.lineWidth=2,i.vjCanvasContext.arc(n._joystickPointerStartPos.x,n._joystickPointerStartPos.y,60,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle=n._joystickColor,i.vjCanvasContext.arc(n._joystickPointerPos.x,n._joystickPointerPos.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),n._joystickPreviousPointerPos=n._joystickPointerPos.clone()):(i.vjCanvasContext.clearRect(t.prevX-43,t.prevY-43,86,86),i.vjCanvasContext.beginPath(),i.vjCanvasContext.fillStyle="white",i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle="red",i.vjCanvasContext.lineWidth=6,i.vjCanvasContext.arc(t.x,t.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),t.prevX=t.x,t.prevY=t.y)});requestAnimationFrame(function(){n._drawVirtualJoystick()})},i.prototype.releaseCanvas=function(){i.vjCanvas&&(i.vjCanvas.removeEventListener("pointerdown",this._onPointerDownHandlerRef),i.vjCanvas.removeEventListener("pointermove",this._onPointerMoveHandlerRef),i.vjCanvas.removeEventListener("pointerup",this._onPointerUpHandlerRef),i.vjCanvas.removeEventListener("pointerout",this._onPointerUpHandlerRef),window.removeEventListener("resize",this._onResize),document.body.removeChild(i.vjCanvas),i.vjCanvas=null)},i._globalJoystickIndex=0,i}();n.VirtualJoystick=i}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u){t.call(this,i,r,u);this._leftjoystick=new n.VirtualJoystick(!0);this._leftjoystick.setAxisForUpDown(n.JoystickAxis.Z);this._leftjoystick.setAxisForLeftRight(n.JoystickAxis.X);this._leftjoystick.setJoystickSensibility(.15);this._rightjoystick=new n.VirtualJoystick(!1);this._rightjoystick.setAxisForUpDown(n.JoystickAxis.X);this._rightjoystick.setAxisForLeftRight(n.JoystickAxis.Y);this._rightjoystick.reverseUpDown=!0;this._rightjoystick.setJoystickSensibility(.05);this._rightjoystick.setJoystickColor("yellow")}return __extends(i,t),i.prototype.getLeftJoystick=function(){return this._leftjoystick},i.prototype.getRightJoystick=function(){return this._rightjoystick},i.prototype._checkInputs=function(){var i=50*this._computeLocalCameraSpeed(),r=n.Matrix.RotationYawPitchRoll(this.rotation.y,this.rotation.x,0),u=n.Vector3.TransformCoordinates(new n.Vector3(this._leftjoystick.deltaPosition.x*i,this._leftjoystick.deltaPosition.y*i,this._leftjoystick.deltaPosition.z*i),r);this.cameraDirection=this.cameraDirection.add(u);this.cameraRotation=this.cameraRotation.addVector3(this._rightjoystick.deltaPosition);this._leftjoystick.pressed||(this._leftjoystick.deltaPosition=this._leftjoystick.deltaPosition.scale(.9));this._rightjoystick.pressed||(this._rightjoystick.deltaPosition=this._rightjoystick.deltaPosition.scale(.9));t.prototype._checkInputs.call(this)},i.prototype.dispose=function(){this._leftjoystick.releaseCanvas();t.prototype.dispose.call(this)},i}(n.FreeCamera);n.VirtualJoysticksCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){t.call(this,i,r);this._textures=[];this._floats=[];this._floatsArrays={};this._colors3=[];this._colors4=[];this._vectors2=[];this._vectors3=[];this._vectors4=[];this._matrices=[];this._matrices3x3=[];this._matrices2x2=[];this._cachedWorldViewMatrix=new n.Matrix;this._shaderPath=u;f.needAlphaBlending=f.needAlphaBlending||!1;f.needAlphaTesting=f.needAlphaTesting||!1;f.attributes=f.attributes||["position","normal","uv"];f.uniforms=f.uniforms||["worldViewProjection"];f.samplers=f.samplers||[];f.defines=f.defines||[];this._options=f}return __extends(i,t),i.prototype.needAlphaBlending=function(){return this._options.needAlphaBlending},i.prototype.needAlphaTesting=function(){return this._options.needAlphaTesting},i.prototype._checkUniform=function(n){-1===this._options.uniforms.indexOf(n)&&this._options.uniforms.push(n)},i.prototype.setTexture=function(n,t){return-1===this._options.samplers.indexOf(n)&&this._options.samplers.push(n),this._textures[n]=t,this},i.prototype.setFloat=function(n,t){return this._checkUniform(n),this._floats[n]=t,this},i.prototype.setFloats=function(n,t){return this._checkUniform(n),this._floatsArrays[n]=t,this},i.prototype.setColor3=function(n,t){return this._checkUniform(n),this._colors3[n]=t,this},i.prototype.setColor4=function(n,t){return this._checkUniform(n),this._colors4[n]=t,this},i.prototype.setVector2=function(n,t){return this._checkUniform(n),this._vectors2[n]=t,this},i.prototype.setVector3=function(n,t){return this._checkUniform(n),this._vectors3[n]=t,this},i.prototype.setVector4=function(n,t){return this._checkUniform(n),this._vectors4[n]=t,this},i.prototype.setMatrix=function(n,t){return this._checkUniform(n),this._matrices[n]=t,this},i.prototype.setMatrix3x3=function(n,t){return this._checkUniform(n),this._matrices3x3[n]=t,this},i.prototype.setMatrix2x2=function(n,t){return this._checkUniform(n),this._matrices2x2[n]=t,this},i.prototype.isReady=function(t,i){var u=this.getScene(),o=u.getEngine(),r,e,f,s,h;if(!this.checkReadyOnEveryCall&&this._renderId===u.getRenderId())return!0;for(r=[],e=new n.EffectFallbacks,i&&r.push("#define INSTANCES"),f=0;f<this._options.defines.length;f++)r.push(this._options.defines[f]);return t&&t.useBones&&t.computeBonesUsingShaders&&(r.push("#define BONES"),r.push("#define BonesPerMesh "+(t.skeleton.bones.length+1)),r.push("#define BONES4"),e.addFallback(0,"BONES4")),o.getAlphaTesting()&&r.push("#define ALPHATEST"),s=this._effect,h=r.join("\n"),this._effect=o.createEffect(this._shaderPath,this._options.attributes,this._options.uniforms,this._options.samplers,h,e,this.onCompiled,this.onError),this._effect.isReady()?(s!==this._effect&&u.resetCachedMaterial(),this._renderId=u.getRenderId(),!0):!1},i.prototype.bindOnlyWorldMatrix=function(n){var t=this.getScene();-1!==this._options.uniforms.indexOf("world")&&this._effect.setMatrix("world",n);-1!==this._options.uniforms.indexOf("worldView")&&(n.multiplyToRef(t.getViewMatrix(),this._cachedWorldViewMatrix),this._effect.setMatrix("worldView",this._cachedWorldViewMatrix));-1!==this._options.uniforms.indexOf("worldViewProjection")&&this._effect.setMatrix("worldViewProjection",n.multiply(t.getTransformMatrix()))},i.prototype.bind=function(n,i){var r,u;if(this.bindOnlyWorldMatrix(n),this.getScene().getCachedMaterial()!==this){-1!==this._options.uniforms.indexOf("view")&&this._effect.setMatrix("view",this.getScene().getViewMatrix());-1!==this._options.uniforms.indexOf("projection")&&this._effect.setMatrix("projection",this.getScene().getProjectionMatrix());-1!==this._options.uniforms.indexOf("viewProjection")&&this._effect.setMatrix("viewProjection",this.getScene().getTransformMatrix());i&&i.useBones&&i.computeBonesUsingShaders&&this._effect.setMatrices("mBones",i.skeleton.getTransformMatrices());for(r in this._textures)this._effect.setTexture(r,this._textures[r]);for(r in this._floats)this._effect.setFloat(r,this._floats[r]);for(r in this._floatsArrays)this._effect.setArray(r,this._floatsArrays[r]);for(r in this._colors3)this._effect.setColor3(r,this._colors3[r]);for(r in this._colors4)u=this._colors4[r],this._effect.setFloat4(r,u.r,u.g,u.b,u.a);for(r in this._vectors2)this._effect.setVector2(r,this._vectors2[r]);for(r in this._vectors3)this._effect.setVector3(r,this._vectors3[r]);for(r in this._vectors4)this._effect.setVector4(r,this._vectors4[r]);for(r in this._matrices)this._effect.setMatrix(r,this._matrices[r]);for(r in this._matrices3x3)this._effect.setMatrix3x3(r,this._matrices3x3[r]);for(r in this._matrices2x2)this._effect.setMatrix2x2(r,this._matrices2x2[r])}t.prototype.bind.call(this,n,i)},i.prototype.clone=function(n){return new i(n,this.getScene(),this._shaderPath,this._options)},i.prototype.dispose=function(n){for(var i in this._textures)this._textures[i].dispose();this._textures=[];t.prototype.dispose.call(this,n)},i}(n.Material);n.ShaderMaterial=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){}return t.prototype.set=function(t,i){switch(i){case n.VertexBuffer.PositionKind:this.positions=t;break;case n.VertexBuffer.NormalKind:this.normals=t;break;case n.VertexBuffer.UVKind:this.uvs=t;break;case n.VertexBuffer.UV2Kind:this.uvs2=t;break;case n.VertexBuffer.UV3Kind:this.uvs3=t;break;case n.VertexBuffer.UV4Kind:this.uvs4=t;break;case n.VertexBuffer.UV5Kind:this.uvs5=t;break;case n.VertexBuffer.UV6Kind:this.uvs6=t;break;case n.VertexBuffer.ColorKind:this.colors=t;break;case n.VertexBuffer.MatricesIndicesKind:this.matricesIndices=t;break;case n.VertexBuffer.MatricesWeightsKind:this.matricesWeights=t}},t.prototype.applyToMesh=function(n,t){this._applyTo(n,t)},t.prototype.applyToGeometry=function(n,t){this._applyTo(n,t)},t.prototype.updateMesh=function(n){this._update(n)},t.prototype.updateGeometry=function(n){this._update(n)},t.prototype._applyTo=function(t,i){this.positions&&t.setVerticesData(n.VertexBuffer.PositionKind,this.positions,i);this.normals&&t.setVerticesData(n.VertexBuffer.NormalKind,this.normals,i);this.uvs&&t.setVerticesData(n.VertexBuffer.UVKind,this.uvs,i);this.uvs2&&t.setVerticesData(n.VertexBuffer.UV2Kind,this.uvs2,i);this.uvs3&&t.setVerticesData(n.VertexBuffer.UV3Kind,this.uvs3,i);this.uvs4&&t.setVerticesData(n.VertexBuffer.UV4Kind,this.uvs4,i);this.uvs5&&t.setVerticesData(n.VertexBuffer.UV5Kind,this.uvs5,i);this.uvs6&&t.setVerticesData(n.VertexBuffer.UV6Kind,this.uvs6,i);this.colors&&t.setVerticesData(n.VertexBuffer.ColorKind,this.colors,i);this.matricesIndices&&t.setVerticesData(n.VertexBuffer.MatricesIndicesKind,this.matricesIndices,i);this.matricesWeights&&t.setVerticesData(n.VertexBuffer.MatricesWeightsKind,this.matricesWeights,i);this.indices&&t.setIndices(this.indices)},t.prototype._update=function(t,i,r){this.positions&&t.updateVerticesData(n.VertexBuffer.PositionKind,this.positions,i,r);this.normals&&t.updateVerticesData(n.VertexBuffer.NormalKind,this.normals,i,r);this.uvs&&t.updateVerticesData(n.VertexBuffer.UVKind,this.uvs,i,r);this.uvs2&&t.updateVerticesData(n.VertexBuffer.UV2Kind,this.uvs2,i,r);this.uvs3&&t.updateVerticesData(n.VertexBuffer.UV3Kind,this.uvs3,i,r);this.uvs4&&t.updateVerticesData(n.VertexBuffer.UV4Kind,this.uvs4,i,r);this.uvs5&&t.updateVerticesData(n.VertexBuffer.UV5Kind,this.uvs5,i,r);this.uvs6&&t.updateVerticesData(n.VertexBuffer.UV6Kind,this.uvs6,i,r);this.colors&&t.updateVerticesData(n.VertexBuffer.ColorKind,this.colors,i,r);this.matricesIndices&&t.updateVerticesData(n.VertexBuffer.MatricesIndicesKind,this.matricesIndices,i,r);this.matricesWeights&&t.updateVerticesData(n.VertexBuffer.MatricesWeightsKind,this.matricesWeights,i,r);this.indices&&t.setIndices(this.indices)},t.prototype.transform=function(t){var i,r=n.Vector3.Zero(),u,f;if(this.positions)for(u=n.Vector3.Zero(),i=0;i<this.positions.length;i+=3)n.Vector3.FromArrayToRef(this.positions,i,u),n.Vector3.TransformCoordinatesToRef(u,t,r),this.positions[i]=r.x,this.positions[i+1]=r.y,this.positions[i+2]=r.z;if(this.normals)for(f=n.Vector3.Zero(),i=0;i<this.normals.length;i+=3)n.Vector3.FromArrayToRef(this.normals,i,f),n.Vector3.TransformNormalToRef(f,t,r),this.normals[i]=r.x,this.normals[i+1]=r.y,this.normals[i+2]=r.z},t.prototype.merge=function(n){var t,i;if(n.indices)for(this.indices||(this.indices=[]),i=this.positions?this.positions.length/3:0,t=0;t<n.indices.length;t++)this.indices.push(n.indices[t]+i);if(n.positions)for(this.positions||(this.positions=[]),t=0;t<n.positions.length;t++)this.positions.push(n.positions[t]);if(n.normals)for(this.normals||(this.normals=[]),t=0;t<n.normals.length;t++)this.normals.push(n.normals[t]);if(n.uvs)for(this.uvs||(this.uvs=[]),t=0;t<n.uvs.length;t++)this.uvs.push(n.uvs[t]);if(n.uvs2)for(this.uvs2||(this.uvs2=[]),t=0;t<n.uvs2.length;t++)this.uvs2.push(n.uvs2[t]);if(n.uvs3)for(this.uvs3||(this.uvs3=[]),t=0;t<n.uvs3.length;t++)this.uvs3.push(n.uvs3[t]);if(n.uvs4)for(this.uvs4||(this.uvs4=[]),t=0;t<n.uvs4.length;t++)this.uvs4.push(n.uvs4[t]);if(n.uvs5)for(this.uvs5||(this.uvs5=[]),t=0;t<n.uvs5.length;t++)this.uvs5.push(n.uvs5[t]);if(n.uvs6)for(this.uvs6||(this.uvs6=[]),t=0;t<n.uvs6.length;t++)this.uvs6.push(n.uvs6[t]);if(n.matricesIndices)for(this.matricesIndices||(this.matricesIndices=[]),t=0;t<n.matricesIndices.length;t++)this.matricesIndices.push(n.matricesIndices[t]);if(n.matricesWeights)for(this.matricesWeights||(this.matricesWeights=[]),t=0;t<n.matricesWeights.length;t++)this.matricesWeights.push(n.matricesWeights[t]);if(n.colors)for(this.colors||(this.colors=[]),t=0;t<n.colors.length;t++)this.colors.push(n.colors[t])},t.ExtractFromMesh=function(n,i){return t._ExtractFrom(n,i)},t.ExtractFromGeometry=function(n,i){return t._ExtractFrom(n,i)},t._ExtractFrom=function(i,r){var u=new t;return i.isVerticesDataPresent(n.VertexBuffer.PositionKind)&&(u.positions=i.getVerticesData(n.VertexBuffer.PositionKind,r)),i.isVerticesDataPresent(n.VertexBuffer.NormalKind)&&(u.normals=i.getVerticesData(n.VertexBuffer.NormalKind,r)),i.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(u.uvs=i.getVerticesData(n.VertexBuffer.UVKind,r)),i.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(u.uvs2=i.getVerticesData(n.VertexBuffer.UV2Kind,r)),i.isVerticesDataPresent(n.VertexBuffer.UV3Kind)&&(u.uvs3=i.getVerticesData(n.VertexBuffer.UV3Kind,r)),i.isVerticesDataPresent(n.VertexBuffer.UV4Kind)&&(u.uvs4=i.getVerticesData(n.VertexBuffer.UV4Kind,r)),i.isVerticesDataPresent(n.VertexBuffer.UV5Kind)&&(u.uvs5=i.getVerticesData(n.VertexBuffer.UV5Kind,r)),i.isVerticesDataPresent(n.VertexBuffer.UV6Kind)&&(u.uvs6=i.getVerticesData(n.VertexBuffer.UV6Kind,r)),i.isVerticesDataPresent(n.VertexBuffer.ColorKind)&&(u.colors=i.getVerticesData(n.VertexBuffer.ColorKind,r)),i.isVerticesDataPresent(n.VertexBuffer.MatricesIndicesKind)&&(u.matricesIndices=i.getVerticesData(n.VertexBuffer.MatricesIndicesKind,r)),i.isVerticesDataPresent(n.VertexBuffer.MatricesWeightsKind)&&(u.matricesWeights=i.getVerticesData(n.VertexBuffer.MatricesWeightsKind,r)),u.indices=i.getIndices(r),u},t.CreateRibbon=function(i,r,u,f,e){var lt,pt,wt,c,it,bt,ot,b,y,st,ht,kt,dt,ni,ti,p,k,g;void 0===e&&(e=n.Mesh.DEFAULTSIDE);r=r||!1;u=u||!1;lt=Math.floor(i[0].length/2);f=f||lt;f=f>lt?lt:Math.floor(f);var d,o,s,a,ft=[],et=[],h=[],vt=[],at=[],yt=[],nt=[],tt=[],w=[],v=[];if(i.length<2){for(pt=[],wt=[],s=0;s<i[0].length-f;s++)pt.push(i[0][s]),wt.push(i[0][s+f]);i=[pt,wt]}for(bt=0,ot=u?1:0,d=i[0].length,o=0;o<i.length;o++){for(nt[o]=0,at[o]=[0],c=i[o],it=c.length,d=it>d?d:it,a=0;it>a;)ft.push(c[a].x,c[a].y,c[a].z),a>0&&(b=c[a].subtract(c[a-1]).length(),y=b+nt[o],at[o].push(y),nt[o]=y),a++;u&&(a--,ft.push(c[0].x,c[0].y,c[0].z),b=c[a].subtract(c[0]).length(),y=b+nt[o],at[o].push(y),nt[o]=y);w[o]=it+ot;v[o]=bt;bt+=it+ot}for(s=0;d+ot>s;s++){for(tt[s]=0,yt[s]=[0],o=0;o<i.length-1;o++)st=i[o],ht=i[o+1],s===d?(kt=st[0],dt=ht[0]):(kt=st[s],dt=ht[s]),b=dt.subtract(kt).length(),y=b+tt[s],yt[s].push(y),tt[s]=y;r&&(st=i[o],ht=i[0],b=ht[s].subtract(st[s]).length(),y=b+tt[s],tt[s]=y)}for(o=0;o<i.length;o++)for(s=0;d+ot>s;s++)ni=at[o][s]/nt[o],ti=yt[s][o]/tt[s],vt.push(ni,ti);o=0;for(var l=0,rt=w[o]-1,ut=w[o+1]-1,gt=ut>rt?rt:ut,ct=v[1]-v[0],ii=r?w.length:w.length-1;gt>=l&&ii>o;)et.push(l,l+ct,l+1),et.push(l+ct+1,l+1,l+ct),l+=1,l===gt&&(o++,o===w.length-1?(ct=v[0]-v[o],rt=w[o]-1,ut=w[0]-1):(ct=v[o+1]-v[o],rt=w[o]-1,ut=w[o+1]-1),l=v[o],gt=ut>rt?rt+l:ut+l);if(t.ComputeNormals(ft,et,h),u)for(p=0,k=0,o=0;o<i.length;o++)p=3*v[o],k=o+1<i.length?3*(v[o+1]-1):h.length-3,h[p]=.5*(h[p]+h[k]),h[p+1]=.5*(h[p+1]+h[k+1]),h[p+2]=.5*(h[p+2]+h[k+2]),h[k]=h[p],h[k+1]=h[p+1],h[k+2]=h[p+2];return t._ComputeSides(e,ft,et,h,vt),g=new t,g.indices=et,g.positions=ft,g.normals=h,g.uvs=vt,u&&(g._idx=v),g},t.CreateBox=function(i,r){var a,b,u,o,v,rt;void 0===r&&(r=n.Mesh.DEFAULTSIDE);var f,it=[new n.Vector3(0,0,1),new n.Vector3(0,0,-1),new n.Vector3(1,0,0),new n.Vector3(-1,0,0),new n.Vector3(0,1,0),new n.Vector3(0,-1,0)],h=[],c=[],y=[],p=[],g=1,nt=1,tt=1,s=i.faceUV||new Array(6),l=[];for(i.faceColors&&(f=i.faceColors),void 0!==i.width?(g=i.width||1,nt=i.height||1,tt=i.depth||1):(g=i||1,nt=i||1,tt=i||1),r=r||i.sideOrientation||n.Mesh.DEFAULTSIDE,a=0;6>a;a++)void 0===s[a]&&(s[a]=new n.Vector4(0,0,1,1)),f&&void 0===f[a]&&(f[a]=new n.Color4(1,1,1,1));for(b=new n.Vector3(g/2,nt/2,tt/2),u=0;u<it.length;u++){var e=it[u],k=new n.Vector3(e.y,e.z,e.x),d=n.Vector3.Cross(e,k),w=c.length/3;h.push(w);h.push(w+1);h.push(w+2);h.push(w);h.push(w+2);h.push(w+3);o=e.subtract(k).subtract(d).multiply(b);c.push(o.x,o.y,o.z);y.push(e.x,e.y,e.z);p.push(s[u].z,s[u].w);f&&l.push(f[u].r,f[u].g,f[u].b,f[u].a);o=e.subtract(k).add(d).multiply(b);c.push(o.x,o.y,o.z);y.push(e.x,e.y,e.z);p.push(s[u].x,s[u].w);f&&l.push(f[u].r,f[u].g,f[u].b,f[u].a);o=e.add(k).add(d).multiply(b);c.push(o.x,o.y,o.z);y.push(e.x,e.y,e.z);p.push(s[u].x,s[u].y);f&&l.push(f[u].r,f[u].g,f[u].b,f[u].a);o=e.add(k).subtract(d).multiply(b);c.push(o.x,o.y,o.z);y.push(e.x,e.y,e.z);p.push(s[u].z,s[u].y);f&&l.push(f[u].r,f[u].g,f[u].b,f[u].a)}return t._ComputeSides(r,c,h,y,p),v=new t,(v.indices=h,v.positions=c,v.normals=y,v.uvs=p,f)&&(rt=r===n.Mesh.DOUBLESIDE?l.concat(l):l,v.colors=rt),v},t.CreateSphere=function(i,r,u){var v,h,y,p,nt,f,s;void 0===u&&(u=n.Mesh.DEFAULTSIDE);i.segments?(v=i.segments||32,h=i.diameterX||1,y=i.diameterY||1,p=i.diameterZ||1):(v=i||32,h=r||1,y=h,p=h);u=u||i.sideOrientation||n.Mesh.DEFAULTSIDE;for(var rt=new n.Vector3(h/2,y/2,p/2),w=2+v,o=2*w,e=[],c=[],b=[],k=[],l=0;w>=l;l++){for(var tt=l/w,ut=tt*Math.PI,d=0;o>=d;d++){var it=d/o,ft=it*Math.PI*2,et=n.Matrix.RotationZ(-ut),ot=n.Matrix.RotationY(ft),st=n.Vector3.TransformCoordinates(n.Vector3.Up(),et),ht=n.Vector3.TransformCoordinates(st,ot),a=ht.multiply(rt),g=n.Vector3.Normalize(a);c.push(a.x,a.y,a.z);b.push(g.x,g.y,g.z);k.push(tt,it)}if(l>0)for(nt=c.length/3,f=nt-2*(o+1);nt>f+o+2;f++)e.push(f),e.push(f+1),e.push(f+o+1),e.push(f+o+1),e.push(f+1),e.push(f+o+2)}return t._ComputeSides(u,c,e,b,k),s=new t,s.indices=e,s.positions=c,s.normals=b,s.uvs=k,s},t.CreateCylinder=function(i,r,u,f,e,o){var g,y;void 0===e&&(e=1);void 0===o&&(o=n.Mesh.DEFAULTSIDE);for(var k,w,d,c,l=[],p=[],a=[],b=[],it=2*Math.PI/f,rt=(u-r)/2/i,v=n.Vector3.Zero(),s=n.Vector3.Zero(),h=0;e>=h;h++)for(w=h/e,d=(w*(r-u)+u)/2,c=0;f>=c;c++)k=c*it,v.x=Math.cos(-k)*d,v.y=-i/2+w*i,v.z=Math.sin(-k)*d,0===r&&h===e?(s.x=a[a.length-3*(f+1)],s.y=a[a.length-3*(f+1)+1],s.z=a[a.length-3*(f+1)+2]):(s.x=v.x,s.z=v.z,s.y=Math.sqrt(s.x*s.x+s.z*s.z)*rt,s.normalize()),p.push(v.x,v.y,v.z),a.push(s.x,s.y,s.z),b.push(c/f,1-w);for(h=0;e>h;h++)for(c=0;f>c;c++){var ut=h*(f+1)+c,nt=(h+1)*(f+1)+c,tt=h*(f+1)+(c+1),ft=(h+1)*(f+1)+(c+1);l.push(ut,nt,tt);l.push(ft,tt,nt)}return g=function(t){var y=t?r/2:u/2,h,v;if(0!==y){for(var c,s,o=p.length/3,k=new n.Vector3(0,t?i/2:-i/2,0),w=new n.Vector2(.5,.5),e=0;f>e;e++)c=2*Math.PI*e/f,s=new n.Vector3(Math.cos(-c),0,Math.sin(-c)),h=s.scale(y).add(k),v=new n.Vector2(s.x*w.x+.5,s.z*w.y+.5),p.push(h.x,h.y,h.z),a.push(0,t?1:-1,0),b.push(v.x,v.y);for(e=0;f-2>e;e++)t?(l.push(o),l.push(o+(e+2)%f),l.push(o+(e+1)%f)):(l.push(o),l.push(o+(e+1)%f),l.push(o+(e+2)%f))}},g(!0),g(!1),t._ComputeSides(o,p,l,a,b),y=new t,y.indices=l,y.positions=p,y.normals=a,y.uvs=b,y},t.CreateTorus=function(i,r,u,f){var e,o,v,y,l;void 0===f&&(f=n.Mesh.DEFAULTSIDE);var s=[],p=[],w=[],b=[];for(i=i||1,r=r||.5,u=u||16,e=u+1,o=0;u>=o;o++)for(var nt=o/u,tt=o*Math.PI*2/u-Math.PI/2,k=n.Matrix.Translation(i/2,0,0).multiply(n.Matrix.RotationY(tt)),h=0;u>=h;h++){var it=1-h/u,d=h*Math.PI*2/u+Math.PI,rt=Math.cos(d),ut=Math.sin(d),c=new n.Vector3(rt,ut,0),a=c.scale(r/2),g=new n.Vector2(nt,it);a=n.Vector3.TransformCoordinates(a,k);c=n.Vector3.TransformNormal(c,k);p.push(a.x,a.y,a.z);w.push(c.x,c.y,c.z);b.push(g.x,g.y);v=(o+1)%e;y=(h+1)%e;s.push(o*e+h);s.push(o*e+y);s.push(v*e+h);s.push(o*e+y);s.push(v*e+y);s.push(v*e+h)}return t._ComputeSides(f,p,s,w,b),l=new t,l.indices=s,l.positions=p,l.normals=w,l.uvs=b,l},t.CreateLines=function(n){for(var r,u=[],f=[],i=0;i<n.length;i++)f.push(n[i].x,n[i].y,n[i].z),i>0&&(u.push(i-1),u.push(i));return r=new t,r.indices=u,r.positions=f,r},t.CreateDashedLines=function(i,r,u,f){var l,a;r=r||3;u=u||1;f=f||200;for(var v=[],p=[],o=n.Vector3.Zero(),w=0,b=0,h=0,c=0,s=0,y=0,e=0,e=0;e<i.length-1;e++)i[e+1].subtractToRef(i[e],o),w+=o.length();for(h=w/f,c=r*h/(r+u),e=0;e<i.length-1;e++)for(i[e+1].subtractToRef(i[e],o),b=Math.floor(o.length()/h),o.normalize(),l=0;b>l;l++)s=h*l,v.push(i[e].x+s*o.x,i[e].y+s*o.y,i[e].z+s*o.z),v.push(i[e].x+(s+c)*o.x,i[e].y+(s+c)*o.y,i[e].z+(s+c)*o.z),p.push(y,y+1),y+=2;return a=new t,a.positions=v,a.indices=p,a},t.CreateGround=function(i,r,u){var f,e,h,o=[],a=[],v=[],y=[],c,l,s;for(i.width?(h=i.width||1,r=i.height||1,u=i.subdivisions||1):(h=i||1,r=r||1,u=u||1),f=0;u>=f;f++)for(e=0;u>=e;e++)c=new n.Vector3(e*h/u-h/2,0,(u-f)*r/u-r/2),l=new n.Vector3(0,1,0),a.push(c.x,c.y,c.z),v.push(l.x,l.y,l.z),y.push(e/u,1-f/u);for(f=0;u>f;f++)for(e=0;u>e;e++)o.push(e+1+(f+1)*(u+1)),o.push(e+1+f*(u+1)),o.push(e+f*(u+1)),o.push(e+(f+1)*(u+1)),o.push(e+1+(f+1)*(u+1)),o.push(e+f*(u+1));return s=new t,s.indices=o,s.positions=a,s.normals=v,s.uvs=y,s},t.CreateTiledGround=function(i,r,u,f,e,o){function k(t,i,r,u){var l=p.length/3,a=o.w+1,f,e,v;for(s=0;s<o.h;s++)for(h=0;h<o.w;h++)f=[l+h+s*a,l+(h+1)+s*a,l+(h+1)+(s+1)*a,l+h+(s+1)*a],c.push(f[1]),c.push(f[2]),c.push(f[3]),c.push(f[0]),c.push(f[1]),c.push(f[3]);for(e=n.Vector3.Zero(),v=new n.Vector3(0,1,0),s=0;s<=o.h;s++)for(e.z=s*(u-i)/o.h+i,h=0;h<=o.w;h++)e.x=h*(r-t)/o.w+t,e.y=0,p.push(e.x,e.y,e.z),w.push(v.x,v.y,v.z),b.push(h/o.w,s/o.h)}var y,l;void 0===e&&(e={w:1,h:1});void 0===o&&(o={w:1,h:1});var s,h,a,v,c=[],p=[],w=[],b=[];for(e.h=e.w<1?1:e.h,e.w=e.w<1?1:e.w,o.w=o.w<1?1:o.w,o.h=o.h<1?1:o.h,y={w:(u-i)/e.w,h:(f-r)/e.h},a=0;a<e.h;a++)for(v=0;v<e.w;v++)k(i+v*y.w,r+a*y.h,i+(v+1)*y.w,r+(a+1)*y.h);return l=new t,l.indices=c,l.positions=p,l.normals=w,l.uvs=b,l},t.CreateGroundFromHeightMap=function(i,r,u,f,e,o,s,h){for(var l,a=[],p=[],w=[],k=[],y,c=0;u>=c;c++)for(l=0;u>=l;l++){var v=new n.Vector3(l*i/u-i/2,0,(u-c)*r/u-r/2),d=(v.x+i/2)/i*(s-1)|0,g=(1-(v.z+r/2)/r)*(h-1)|0,b=4*(d+g*s),nt=o[b]/255,tt=o[b+1]/255,it=o[b+2]/255,rt=.3*nt+.59*tt+.11*it;v.y=f+(e-f)*rt;p.push(v.x,v.y,v.z);w.push(0,0,0);k.push(l/u,1-c/u)}for(c=0;u>c;c++)for(l=0;u>l;l++)a.push(l+1+(c+1)*(u+1)),a.push(l+1+c*(u+1)),a.push(l+c*(u+1)),a.push(l+(c+1)*(u+1)),a.push(l+1+(c+1)*(u+1)),a.push(l+c*(u+1));return t.ComputeNormals(p,a,w),y=new t,y.indices=a,y.positions=p,y.normals=w,y.uvs=k,y},t.CreatePlane=function(i,r){var h,c,s;void 0===r&&(r=n.Mesh.DEFAULTSIDE);var l,a,u=[],f=[],e=[],o=[];return i.width?(l=i.width||1,a=i.height||1,r=i.sideOrientation||n.Mesh.DEFAULTSIDE):(l=i||1,a=i||1),h=l/2,c=a/2,f.push(-h,-c,0),e.push(0,0,-1),o.push(0,0),f.push(h,-c,0),e.push(0,0,-1),o.push(1,0),f.push(h,c,0),e.push(0,0,-1),o.push(1,1),f.push(-h,c,0),e.push(0,0,-1),o.push(0,1),u.push(0),u.push(1),u.push(2),u.push(0),u.push(2),u.push(3),t._ComputeSides(r,f,u,e,o),s=new t,s.indices=u,s.positions=f,s.normals=e,s.uvs=o,s},t.CreateDisc=function(i,r,u){var a,s,p,h,o;void 0===u&&(u=n.Mesh.DEFAULTSIDE);var f=[],c=[],l=[],e=[];for(f.push(0,0,0),e.push(.5,.5),a=2*Math.PI/r,s=0;s<2*Math.PI;s+=a){var v=Math.cos(s),y=Math.sin(s),w=(v+1)/2,b=(1-y)/2;f.push(i*v,i*y,0);e.push(w,b)}for(f.push(f[3],f[4],f[5]),e.push(e[2],e[3]),p=f.length/3,h=1;p-1>h;h++)c.push(h+1,0,h);return t.ComputeNormals(f,c,l),t._ComputeSides(u,f,c,l,e),o=new t,o.indices=c,o.positions=f,o.normals=l,o.uvs=e,o},t.CreateTorusKnot=function(i,r,u,f,e,o,s){var h,c,d,y;void 0===s&&(s=n.Mesh.DEFAULTSIDE);var l=[],a=[],k=[],b=[];for(i=i||2,r=r||.5,u=u||32,f=f||32,e=e||2,o=o||3,d=function(t){var f=Math.cos(t),s=Math.sin(t),r=o/e*t,u=Math.cos(r),h=i*(2+u)*.5*f,c=i*(2+u)*s*.5,l=i*Math.sin(r)*.5;return new n.Vector3(h,c,l)},h=0;u>=h;h++){var st=h%u,tt=st/u*2*e*Math.PI,p=d(tt),it=d(tt+.01),rt=it.subtract(p),v=it.add(p),w=n.Vector3.Cross(rt,v);for(v=n.Vector3.Cross(w,rt),w.normalize(),v.normalize(),c=0;f>c;c++){var ht=c%f,ut=ht/f*2*Math.PI,g=-r*Math.cos(ut),nt=r*Math.sin(ut);a.push(p.x+g*v.x+nt*w.x);a.push(p.y+g*v.y+nt*w.y);a.push(p.z+g*v.z+nt*w.z);b.push(h/u);b.push(c/f)}}for(h=0;u>h;h++)for(c=0;f>c;c++){var ft=(c+1)%f,ct=h*f+c,et=(h+1)*f+c,lt=(h+1)*f+ft,ot=h*f+ft;l.push(ot);l.push(et);l.push(ct);l.push(ot);l.push(lt);l.push(et)}return t.ComputeNormals(a,l,k),t._ComputeSides(s,a,l,k,b),y=new t,y.indices=l,y.positions=a,y.normals=k,y.uvs=b,y},t.ComputeNormals=function(t,i,r){for(var u=0,c=n.Vector3.Zero(),l=n.Vector3.Zero(),f=n.Vector3.Zero(),h=n.Vector3.Zero(),a,u=0;u<t.length;u++)r[u]=0;for(a=i.length/3,u=0;a>u;u++){var o=i[3*u],e=i[3*u+1],s=i[3*u+2];c.x=t[3*o]-t[3*e];c.y=t[3*o+1]-t[3*e+1];c.z=t[3*o+2]-t[3*e+2];l.x=t[3*s]-t[3*e];l.y=t[3*s+1]-t[3*e+1];l.z=t[3*s+2]-t[3*e+2];n.Vector3.CrossToRef(c,l,f);f.normalize();r[3*o]+=f.x;r[3*o+1]+=f.y;r[3*o+2]+=f.z;r[3*e]+=f.x;r[3*e+1]+=f.y;r[3*e+2]+=f.z;r[3*s]+=f.x;r[3*s+1]+=f.y;r[3*s+2]+=f.z}for(u=0;u<r.length/3;u++)n.Vector3.FromFloatsToRef(r[3*u],r[3*u+1],r[3*u+2],h),h.normalize(),r[3*u]=h.x,r[3*u+1]=h.y,r[3*u+2]=h.z},t._ComputeSides=function(t,i,r,u,f){var e,o,s=r.length,l=u.length,p,y,h;switch(t=t||n.Mesh.DEFAULTSIDE){case n.Mesh.BACKSIDE:for(e=0;s>e;e+=3)p=r[e],r[e]=r[e+2],r[e+2]=p;for(o=0;l>o;o++)u[o]=-u[o];break;case n.Mesh.DOUBLESIDE:for(var a=i.length,v=a/3,c=0;a>c;c++)i[a+c]=i[c];for(e=0;s>e;e+=3)r[e+s]=r[e+2]+v,r[e+1+s]=r[e+1]+v,r[e+2+s]=r[e]+v;for(o=0;l>o;o++)u[l+o]=-u[o];for(y=f.length,h=0;y>h;h++)f[h+y]=f[h]}},t}();n.VertexData=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,"anaglyph",null,["leftSampler"],i,r,u,f,e)}return __extends(t,n),t}(n.PostProcess);n.AnaglyphPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){}return t.EnableFor=function(n){n._tags=n._tags||{};n.hasTags=function(){return t.HasTags(n)};n.addTags=function(i){return t.AddTagsTo(n,i)};n.removeTags=function(i){return t.RemoveTagsFrom(n,i)};n.matchesTagsQuery=function(i){return t.MatchesQuery(n,i)}},t.DisableFor=function(n){delete n._tags;delete n.hasTags;delete n.addTags;delete n.removeTags;delete n.matchesTagsQuery},t.HasTags=function(t){return t._tags?!n.Tools.IsEmpty(t._tags):!1},t.GetTags=function(n){return n._tags?n._tags:null},t.AddTagsTo=function(n,i){var r,u;if(i){r=i.split(" ");for(u in r)t._AddTagTo(n,r[u])}},t._AddTagTo=function(n,i){i=i.trim();""!==i&&"true"!==i&&"false"!==i&&(i.match(/[\s]/)||i.match(/^([!]|([|]|[&]){2})/)||(t.EnableFor(n),n._tags[i]=!0))},t.RemoveTagsFrom=function(n,i){var r,u;if(t.HasTags(n)){r=i.split(" ");for(u in r)t._RemoveTagFrom(n,r[u])}},t._RemoveTagFrom=function(n,t){delete n._tags[t]},t.MatchesQuery=function(i,r){return void 0===r?!0:""===r?t.HasTags(i):n.Internals.AndOrNotEvaluator.Eval(r,function(n){return t.HasTags(i)&&i._tags[n]})},t}();n.Tags=t}(BABYLON||(BABYLON={}));!function(n){var t;!function(n){var t=function(){function n(){}return n.Eval=function(t,i){return t=t.match(/\([^\(\)]*\)/g)?t.replace(/\([^\(\)]*\)/g,function(t){return t=t.slice(1,t.length-1),n._HandleParenthesisContent(t,i)}):n._HandleParenthesisContent(t,i),"true"===t?!0:"false"===t?!1:n.Eval(t,i)},n._HandleParenthesisContent=function(t,i){var f,s,h,r,e,o,u;i=i||function(n){return"true"===n?!0:!1};s=t.split("||");for(h in s){if(r=n._SimplifyNegation(s[h].trim()),e=r.split("&&"),e.length>1)for(o=0;o<e.length;++o)if(u=n._SimplifyNegation(e[o].trim()),f="true"!==u&&"false"!==u?"!"===u[0]?!i(u.substring(1)):i(u):"true"===u?!0:!1,!f){r="false";break}if(f||"true"===r){f=!0;break}f="true"!==r&&"false"!==r?"!"===r[0]?!i(r.substring(1)):i(r):"true"===r?!0:!1}return f?"true":"false"},n._SimplifyNegation=function(n){return n=n.replace(/^[\s!]+/,function(n){return n=n.replace(/[\s]/g,function(){return""}),n.length%2?"!":""}),n=n.trim(),"!true"===n?n="false":"!false"===n&&(n="true"),n},n}();n.AndOrNotEvaluator=t}(t=n.Internals||(n.Internals={}))}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f,e){this._enabled=!0;this._refCount=0;this._name=i;this._renderTexture=new n.RenderTargetTexture(i,r,t);this.setRenderList(u);this._renderTexture.onBeforeRender=f;this._renderTexture.onAfterRender=e;this._scene=t;this._renderList=u}return t.prototype._incRefCount=function(){return 0===this._refCount&&this._scene.customRenderTargets.push(this._renderTexture),++this._refCount},t.prototype._decRefCount=function(){return this._refCount--,this._refCount<=0&&this._scene.customRenderTargets.splice(this._scene.customRenderTargets.indexOf(this._renderTexture),1),this._refCount},t.prototype._update=function(){this.setRenderList(this._renderList)},t.prototype.setRenderList=function(n){this._renderTexture.renderList=n},t.prototype.getRenderTexture=function(){return this._renderTexture},t}();n.PostProcessRenderPass=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t,i,r){this._engine=n;this._name=t;this._singleInstance=r||!0;this._getPostProcess=i;this._cameras=[];this._indicesForCamera=[];this._postProcesses={};this._renderPasses={};this._renderEffectAsPasses={}}return t.prototype._update=function(){for(var n in this._renderPasses)this._renderPasses[n]._update()},t.prototype.addPass=function(n){this._renderPasses[n._name]=n;this._linkParameters()},t.prototype.removePass=function(n){delete this._renderPasses[n._name];this._linkParameters()},t.prototype.addRenderEffectAsPass=function(n){this._renderEffectAsPasses[n._name]=n;this._linkParameters()},t.prototype.getPass=function(n){for(var t in this._renderPasses)if(t===n)return this._renderPasses[n]},t.prototype.emptyPasses=function(){this._renderPasses={};this._linkParameters()},t.prototype._attachCameras=function(t){for(var u,r,i,o,s,e=n.Tools.MakeArray(t||this._cameras),f=0;f<e.length;f++){r=e[f];i=r.name;u=this._singleInstance?0:i;this._postProcesses[u]=this._postProcesses[u]||this._getPostProcess();o=r.attachPostProcess(this._postProcesses[u]);this._indicesForCamera[i]||(this._indicesForCamera[i]=[]);this._indicesForCamera[i].push(o);-1===this._cameras.indexOf(r)&&(this._cameras[i]=r);for(s in this._renderPasses)this._renderPasses[s]._incRefCount()}this._linkParameters()},t.prototype._detachCameras=function(t){for(var f,r,e,o,u=n.Tools.MakeArray(t||this._cameras),i=0;i<u.length;i++){f=u[i];r=f.name;f.detachPostProcess(this._postProcesses[this._singleInstance?0:r],this._indicesForCamera[r]);e=this._cameras.indexOf(r);this._indicesForCamera.splice(e,1);this._cameras.splice(e,1);for(o in this._renderPasses)this._renderPasses[o]._decRefCount()}},t.prototype._enable=function(t){for(var o,f=n.Tools.MakeArray(t||this._cameras),i=0;i<f.length;i++){for(var e=f[i],r=e.name,u=0;u<this._indicesForCamera[r].length;u++)void 0===e._postProcesses[this._indicesForCamera[r][u]]&&t[i].attachPostProcess(this._postProcesses[this._singleInstance?0:r],this._indicesForCamera[r][u]);for(o in this._renderPasses)this._renderPasses[o]._incRefCount()}},t.prototype._disable=function(t){for(var u,f,e,r=n.Tools.MakeArray(t||this._cameras),i=0;i<r.length;i++){u=r[i];f=u.Name;u.detachPostProcess(this._postProcesses[this._singleInstance?0:f],this._indicesForCamera[f]);for(e in this._renderPasses)this._renderPasses[e]._decRefCount()}},t.prototype.getPostProcess=function(n){return this._singleInstance?this._postProcesses[0]:this._postProcesses[n.name]},t.prototype._linkParameters=function(){var t=this;for(var n in this._postProcesses)this.applyParameters&&this.applyParameters(this._postProcesses[n]),this._postProcesses[n].onBeforeRender=function(n){t._linkTextures(n)}},t.prototype._linkTextures=function(n){var t,i;for(t in this._renderPasses)n.setTexture(t,this._renderPasses[t].getRenderTexture());for(i in this._renderEffectAsPasses)n.setTextureFromPostProcess(i+"Sampler",this._renderEffectAsPasses[i].getPostProcess())},t}();n.PostProcessRenderEffect=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n,t){this._engine=n;this._name=t;this._renderEffects={};this._renderEffectsForIsolatedPass={};this._cameras=[]}return t.prototype.addEffect=function(n){this._renderEffects[n._name]=n},t.prototype._enableEffect=function(t,i){var r=this._renderEffects[t];r&&r._enable(n.Tools.MakeArray(i||this._cameras))},t.prototype._disableEffect=function(t,i){var r=this._renderEffects[t];r&&r._disable(n.Tools.MakeArray(i||this._cameras))},t.prototype._attachCameras=function(t,i){for(var u,o,s,f=n.Tools.MakeArray(t||this._cameras),e=[],r=0;r<f.length;r++)u=f[r],o=u.name,-1===this._cameras.indexOf(u)?this._cameras[o]=u:i&&e.push(r);for(r=0;r<e.length;r++)t.splice(e[r],1);for(s in this._renderEffects)this._renderEffects[s]._attachCameras(f)},t.prototype._detachCameras=function(t){var r=n.Tools.MakeArray(t||this._cameras),u,i;for(u in this._renderEffects)this._renderEffects[u]._detachCameras(r);for(i=0;i<r.length;i++)this._cameras.splice(this._cameras.indexOf(r[i]),1)},t.prototype._enableDisplayOnlyPass=function(i,r){var c=this,s=n.Tools.MakeArray(r||this._cameras),f=null,e,o,h,u;for(e in this._renderEffects)if(f=this._renderEffects[e].getPass(i),null!=f)break;if(null!==f){for(e in this._renderEffects)this._renderEffects[e]._disable(s);for(f._name=t.PASS_SAMPLER_NAME,o=0;o<s.length;o++)h=s[o],u=h.name,this._renderEffectsForIsolatedPass[u]=this._renderEffectsForIsolatedPass[u]||new n.PostProcessRenderEffect(this._engine,t.PASS_EFFECT_NAME,function(){return new n.DisplayPassPostProcess(t.PASS_EFFECT_NAME,1,null,null,c._engine,!0)}),this._renderEffectsForIsolatedPass[u].emptyPasses(),this._renderEffectsForIsolatedPass[u].addPass(f),this._renderEffectsForIsolatedPass[u]._attachCameras(h)}},t.prototype._disableDisplayOnlyPass=function(i){for(var e,r,o,s=this,u=n.Tools.MakeArray(i||this._cameras),f=0;f<u.length;f++)e=u[f],r=e.name,this._renderEffectsForIsolatedPass[r]=this._renderEffectsForIsolatedPass[r]||new n.PostProcessRenderEffect(this._engine,t.PASS_EFFECT_NAME,function(){return new n.DisplayPassPostProcess(t.PASS_EFFECT_NAME,1,null,null,s._engine,!0)}),this._renderEffectsForIsolatedPass[r]._disable(e);for(o in this._renderEffects)this._renderEffects[o]._enable(u)},t.prototype._update=function(){var i,n,t;for(i in this._renderEffects)this._renderEffects[i]._update();for(n=0;n<this._cameras.length;n++)t=this._cameras[n].name,this._renderEffectsForIsolatedPass[t]&&this._renderEffectsForIsolatedPass[t]._update()},t.PASS_EFFECT_NAME="passEffect",t.PASS_SAMPLER_NAME="passSampler",t}();n.PostProcessRenderPipeline=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(){this._renderPipelines={}}return n.prototype.addPipeline=function(n){this._renderPipelines[n._name]=n},n.prototype.attachCamerasToRenderPipeline=function(n,t,i){var r=this._renderPipelines[n];r&&r._attachCameras(t,i)},n.prototype.detachCamerasFromRenderPipeline=function(n,t){var i=this._renderPipelines[n];i&&i._detachCameras(t)},n.prototype.enableEffectInPipeline=function(n,t,i){var r=this._renderPipelines[n];r&&r._enableEffect(t,i)},n.prototype.disableEffectInPipeline=function(n,t,i){var r=this._renderPipelines[n];r&&r._disableEffect(t,i)},n.prototype.enableDisplayOnlyPassInPipeline=function(n,t,i){var r=this._renderPipelines[n];r&&r._enableDisplayOnlyPass(t,i)},n.prototype.disableDisplayOnlyPassInPipeline=function(n,t){var i=this._renderPipelines[n];i&&i._disableDisplayOnlyPass(t)},n.prototype.update=function(){for(var n in this._renderPipelines)this._renderPipelines[n]._update()},n}();n.PostProcessRenderPipelineManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,"displayPass",["passSampler"],["passSampler"],i,r,u,f,e)}return __extends(t,n),t}(n.PostProcess);n.DisplayPassPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){this.frontColor=new n.Color3(1,1,1);this.backColor=new n.Color3(.1,.1,.1);this.showBackLines=!0;this.renderList=new n.SmartArray(32);this._scene=t}return t.prototype._prepareRessources=function(){if(!this._colorShader){this._colorShader=new n.ShaderMaterial("colorShader",this._scene,"color",{attributes:["position"],uniforms:["worldViewProjection","color"]});var t=this._scene.getEngine(),i=n.VertexData.CreateBox(1);this._vb=new n.VertexBuffer(t,i.positions,n.VertexBuffer.PositionKind,!1);this._ib=t.createIndexBuffer([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,7,1,6,2,5,3,4])}},t.prototype.reset=function(){this.renderList.reset()},t.prototype.render=function(){var t,i;if(0!==this.renderList.length&&(this._prepareRessources(),this._colorShader.isReady())){for(t=this._scene.getEngine(),t.setDepthWrite(!1),this._colorShader._preBind(),i=0;i<this.renderList.length;i++){var u=this.renderList.data[i],e=u.minimum,s=u.maximum,r=s.subtract(e),f=e.add(r.scale(.5)),o=n.Matrix.Scaling(r.x,r.y,r.z).multiply(n.Matrix.Translation(f.x,f.y,f.z)).multiply(u.getWorldMatrix());t.bindBuffers(this._vb.getBuffer(),this._ib,[3],12,this._colorShader.getEffect());this.showBackLines&&(t.setDepthFunctionToGreaterOrEqual(),this._scene.resetCachedMaterial(),this._colorShader.setColor4("color",this.backColor.toColor4()),this._colorShader.bind(o),t.draw(!1,0,24));t.setDepthFunctionToLess();this._scene.resetCachedMaterial();this._colorShader.setColor4("color",this.frontColor.toColor4());this._colorShader.bind(o);t.draw(!1,0,24)}this._colorShader.unbind();t.setDepthFunctionToLessOrEqual();t.setDepthWrite(!0)}},t.prototype.dispose=function(){this._colorShader&&(this._colorShader.dispose(),this._vb.dispose(),this._scene.getEngine()._releaseBuffer(this._ib))},t}();n.BoundingBoxRenderer=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n){this._actionManager=n}return n.prototype.isValid=function(){return!0},n.prototype._getProperty=function(n){return this._actionManager._getProperty(n)},n.prototype._getEffectiveTarget=function(n,t){return this._actionManager._getEffectiveTarget(n,t)},n}(),i,r,u;n.Condition=t;i=function(n){function t(i,r,u,f,e){void 0===e&&(e=t.IsEqual);n.call(this,i);this.propertyPath=u;this.value=f;this.operator=e;this._target=this._getEffectiveTarget(r,this.propertyPath);this._property=this._getProperty(this.propertyPath)}return __extends(t,n),Object.defineProperty(t,"IsEqual",{get:function(){return t._IsEqual},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsDifferent",{get:function(){return t._IsDifferent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsGreater",{get:function(){return t._IsGreater},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsLesser",{get:function(){return t._IsLesser},enumerable:!0,configurable:!0}),t.prototype.isValid=function(){switch(this.operator){case t.IsGreater:return this._target[this._property]>this.value;case t.IsLesser:return this._target[this._property]<this.value;case t.IsEqual:case t.IsDifferent:var n;return n=this.value.equals?this.value.equals(this._target[this._property]):this.value===this._target[this._property],this.operator===t.IsEqual?n:!n}return!1},t._IsEqual=0,t._IsDifferent=1,t._IsGreater=2,t._IsLesser=3,t}(t);n.ValueCondition=i;r=function(n){function t(t,i){n.call(this,t);this.predicate=i}return __extends(t,n),t.prototype.isValid=function(){return this.predicate()},t}(t);n.PredicateCondition=r;u=function(n){function t(t,i,r){n.call(this,t);this.value=r;this._target=i}return __extends(t,n),t.prototype.isValid=function(){return this._target.state===this.value},t}(t);n.StateCondition=u}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n,t){this.triggerOptions=n;n.parameter?(this.trigger=n.trigger,this._triggerParameter=n.parameter):this.trigger=n;this._nextActiveAction=this;this._condition=t}return n.prototype._prepare=function(){},n.prototype.getTriggerParameter=function(){return this._triggerParameter},n.prototype._executeCurrent=function(n){if(this._nextActiveAction._condition){var t=this._nextActiveAction._condition,i=this._actionManager.getScene().getRenderId();if(t._evaluationId===i){if(!t._currentResult)return}else{if(t._evaluationId=i,!t.isValid())return void(t._currentResult=!1);t._currentResult=!0}}this._nextActiveAction.execute(n);this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this},n.prototype.execute=function(){},n.prototype.then=function(n){return this._child=n,n._actionManager=this._actionManager,n._prepare(),n},n.prototype._getProperty=function(n){return this._actionManager._getProperty(n)},n.prototype._getEffectiveTarget=function(n,t){return this._actionManager._getEffectiveTarget(n,t)},n}();n.Action=t}(BABYLON||(BABYLON={}));!function(n){var i=function(){function n(n,t,i,r,u,f){this.source=n;this.pointerX=t;this.pointerY=i;this.meshUnderPointer=r;this.sourceEvent=u;this.additionalData=f}return n.CreateNew=function(t,i,r){var u=t.getScene();return new n(t,u.pointerX,u.pointerY,u.meshUnderPointer,i,r)},n.CreateNewFromScene=function(t,i){return new n(null,t.pointerX,t.pointerY,t.meshUnderPointer,i)},n}(),t;n.ActionEvent=i;t=function(){function t(n){this.actions=[];this._scene=n;n._actionManagers.push(this)}return Object.defineProperty(t,"NothingTrigger",{get:function(){return t._NothingTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickTrigger",{get:function(){return t._OnPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnLeftPickTrigger",{get:function(){return t._OnLeftPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnRightPickTrigger",{get:function(){return t._OnRightPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnCenterPickTrigger",{get:function(){return t._OnCenterPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPointerOverTrigger",{get:function(){return t._OnPointerOverTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPointerOutTrigger",{get:function(){return t._OnPointerOutTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnEveryFrameTrigger",{get:function(){return t._OnEveryFrameTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnIntersectionEnterTrigger",{get:function(){return t._OnIntersectionEnterTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnIntersectionExitTrigger",{get:function(){return t._OnIntersectionExitTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnKeyDownTrigger",{get:function(){return t._OnKeyDownTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnKeyUpTrigger",{get:function(){return t._OnKeyUpTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickUpTrigger",{get:function(){return t._OnPickUpTrigger},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=this._scene._actionManagers.indexOf(this);n>-1&&this._scene._actionManagers.splice(n,1)},t.prototype.getScene=function(){return this._scene},t.prototype.hasSpecificTriggers=function(n){for(var i,t=0;t<this.actions.length;t++)if(i=this.actions[t],n.indexOf(i.trigger)>-1)return!0;return!1},t.prototype.hasSpecificTrigger=function(n){for(var i,t=0;t<this.actions.length;t++)if(i=this.actions[t],i.trigger===n)return!0;return!1},Object.defineProperty(t.prototype,"hasPointerTriggers",{get:function(){for(var i,n=0;n<this.actions.length;n++)if((i=this.actions[n],i.trigger>=t._OnPickTrigger&&i.trigger<=t._OnPointerOutTrigger)||i.trigger==t._OnPickUpTrigger)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPickTriggers",{get:function(){for(var i,n=0;n<this.actions.length;n++)if(i=this.actions[n],i.trigger>=t._OnPickTrigger&&i.trigger<=t._OnCenterPickTrigger)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.registerAction=function(i){return i.trigger===t.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(n.Tools.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(i),i._actionManager=this,i._prepare(),i)},t.prototype.processTrigger=function(n,i){for(var u,f,e,o,r=0;r<this.actions.length;r++)if(u=this.actions[r],u.trigger===n){if((n===t.OnKeyUpTrigger||n===t.OnKeyDownTrigger)&&(f=u.getTriggerParameter(),f&&(e=i.sourceEvent.charCode?i.sourceEvent.charCode:i.sourceEvent.keyCode,o=String.fromCharCode(e).toLowerCase(),o!==f.toLowerCase())))continue;u._executeCurrent(i)}},t.prototype._getEffectiveTarget=function(n,t){for(var r=t.split("."),i=0;i<r.length-1;i++)n=n[r[i]];return n},t.prototype._getProperty=function(n){var t=n.split(".");return t[t.length-1]},t._NothingTrigger=0,t._OnPickTrigger=1,t._OnLeftPickTrigger=2,t._OnRightPickTrigger=3,t._OnCenterPickTrigger=4,t._OnPointerOverTrigger=5,t._OnPointerOutTrigger=6,t._OnEveryFrameTrigger=7,t._OnIntersectionEnterTrigger=8,t._OnIntersectionExitTrigger=9,t._OnKeyDownTrigger=10,t._OnKeyUpTrigger=11,t._OnPickUpTrigger=12,t}();n.ActionManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(n,i,r,u,f,e,o){void 0===f&&(f=1e3);t.call(this,n,e);this.propertyPath=r;this.value=u;this.duration=f;this.stopOtherAnimations=o;this._target=i}return __extends(i,t),i.prototype._prepare=function(){this._target=this._getEffectiveTarget(this._target,this.propertyPath);this._property=this._getProperty(this.propertyPath)},i.prototype.execute=function(){var t,r=this._actionManager.getScene(),u=[{frame:0,value:this._target[this._property]},{frame:100,value:this.value}],i;if("number"==typeof this.value)t=n.Animation.ANIMATIONTYPE_FLOAT;else if(this.value instanceof n.Color3)t=n.Animation.ANIMATIONTYPE_COLOR3;else if(this.value instanceof n.Vector3)t=n.Animation.ANIMATIONTYPE_VECTOR3;else if(this.value instanceof n.Matrix)t=n.Animation.ANIMATIONTYPE_MATRIX;else{if(!(this.value instanceof n.Quaternion))return void n.Tools.Warn("InterpolateValueAction: Unsupported type ("+typeof this.value+")");t=n.Animation.ANIMATIONTYPE_QUATERNION}i=new n.Animation("InterpolateValueAction",this._property,1e5/this.duration,t,n.Animation.ANIMATIONLOOPMODE_CONSTANT);i.setKeys(u);this.stopOtherAnimations&&r.stopAnimation(this._target);r.beginDirectAnimation(this._target,[i],0,100)},i}(n.Action);n.InterpolateValueAction=t}(BABYLON||(BABYLON={}));!function(n){var a=function(n){function t(t,i,r,u){n.call(this,t,u);this.propertyPath=r;this._target=i}return __extends(t,n),t.prototype._prepare=function(){this._target=this._getEffectiveTarget(this._target,this.propertyPath);this._property=this._getProperty(this.propertyPath)},t.prototype.execute=function(){this._target[this._property]=!this._target[this._property]},t}(n.Action),t,i,r,u,f,e,o,s,h,c,l;n.SwitchBooleanAction=a;t=function(n){function t(t,i,r,u){n.call(this,t,u);this.value=r;this._target=i}return __extends(t,n),t.prototype.execute=function(){this._target.state=this.value},t}(n.Action);n.SetStateAction=t;i=function(n){function t(t,i,r,u,f){n.call(this,t,f);this.propertyPath=r;this.value=u;this._target=i}return __extends(t,n),t.prototype._prepare=function(){this._target=this._getEffectiveTarget(this._target,this.propertyPath);this._property=this._getProperty(this.propertyPath)},t.prototype.execute=function(){this._target[this._property]=this.value},t}(n.Action);n.SetValueAction=i;r=function(t){function i(n,i,r,u,f){t.call(this,n,f);this.propertyPath=r;this.value=u;this._target=i}return __extends(i,t),i.prototype._prepare=function(){this._target=this._getEffectiveTarget(this._target,this.propertyPath);this._property=this._getProperty(this.propertyPath);"number"!=typeof this._target[this._property]&&n.Tools.Warn("Warning: IncrementValueAction can only be used with number values")},i.prototype.execute=function(){this._target[this._property]+=this.value},i}(n.Action);n.IncrementValueAction=r;u=function(n){function t(t,i,r,u,f,e){n.call(this,t,e);this.from=r;this.to=u;this.loop=f;this._target=i}return __extends(t,n),t.prototype._prepare=function(){},t.prototype.execute=function(){var n=this._actionManager.getScene();n.beginAnimation(this._target,this.from,this.to,this.loop)},t}(n.Action);n.PlayAnimationAction=u;f=function(n){function t(t,i,r){n.call(this,t,r);this._target=i}return __extends(t,n),t.prototype._prepare=function(){},t.prototype.execute=function(){var n=this._actionManager.getScene();n.stopAnimation(this._target)},t}(n.Action);n.StopAnimationAction=f;e=function(t){function i(i,r){void 0===i&&(i=n.ActionManager.NothingTrigger);t.call(this,i,r)}return __extends(i,t),i.prototype.execute=function(){},i}(n.Action);n.DoNothingAction=e;o=function(n){function t(t,i,r){n.call(this,t,r);this.children=i}return __extends(t,n),t.prototype._prepare=function(){for(var n=0;n<this.children.length;n++)this.children[n]._actionManager=this._actionManager,this.children[n]._prepare()},t.prototype.execute=function(n){for(var t=0;t<this.children.length;t++)this.children[t].execute(n)},t}(n.Action);n.CombineAction=o;s=function(n){function t(t,i,r){n.call(this,t,r);this.func=i}return __extends(t,n),t.prototype.execute=function(n){this.func(n)},t}(n.Action);n.ExecuteCodeAction=s;h=function(t){function i(n,i,r,u){t.call(this,n,u);this._target=i;this._parent=r}return __extends(i,t),i.prototype._prepare=function(){},i.prototype.execute=function(){if(this._target.parent!==this._parent){var t=this._parent.getWorldMatrix().clone();t.invert();this._target.position=n.Vector3.TransformCoordinates(this._target.position,t);this._target.parent=this._parent}},i}(n.Action);n.SetParentAction=h;c=function(n){function t(t,i,r){n.call(this,t,r);this._sound=i}return __extends(t,n),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._sound&&this._sound.play()},t}(n.Action);n.PlaySoundAction=c;l=function(n){function t(t,i,r){n.call(this,t,r);this._sound=i}return __extends(t,n),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._sound&&this._sound.stop()},t}(n.Action);n.StopSoundAction=l}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f){this.delayLoadState=n.Engine.DELAYLOADSTATE_NONE;this._totalVertices=0;this._indices=[];this._isDisposed=!1;this.id=t;this._engine=i.getEngine();this._meshes=[];this._scene=i;r?this.setAllVerticesData(r,u):(this._totalVertices=0,this._indices=[]);f&&(this.applyToMesh(f),f.computeWorldMatrix(!0))}return t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._engine},t.prototype.isReady=function(){return this.delayLoadState===n.Engine.DELAYLOADSTATE_LOADED||this.delayLoadState===n.Engine.DELAYLOADSTATE_NONE},t.prototype.setAllVerticesData=function(n,t){n.applyToGeometry(this,t);this.notifyUpdate()},t.prototype.setVerticesData=function(t,i,r,u){var f;if(this._vertexBuffers=this._vertexBuffers||{},this._vertexBuffers[t]&&this._vertexBuffers[t].dispose(),this._vertexBuffers[t]=new n.VertexBuffer(this._engine,i,t,r,0===this._meshes.length,u),t===n.VertexBuffer.PositionKind){u=this._vertexBuffers[t].getStrideSize();this._totalVertices=i.length/u;for(var o=n.Tools.ExtractMinAndMax(i,0,this._totalVertices),s=this._meshes,h=s.length,e=0;h>e;e++)f=s[e],f._resetPointsArrayCache(),f._boundingInfo=new n.BoundingInfo(o.minimum,o.maximum),f._createGlobalSubMesh(),f.computeWorldMatrix(!0)}this.notifyUpdate(t)},t.prototype.updateVerticesDataDirectly=function(n,t,i){var r=this.getVertexBuffer(n);r&&(r.updateDirectly(t,i),this.notifyUpdate(n))},t.prototype.updateVerticesData=function(t,i,r){var e=this.getVertexBuffer(t),o,h,u,f,l;if(e){if(e.update(i),t===n.VertexBuffer.PositionKind){h=e.getStrideSize();this._totalVertices=i.length/h;r&&(o=n.Tools.ExtractMinAndMax(i,0,this._totalVertices));for(var c=this._meshes,a=c.length,s=0;a>s;s++)if(u=c[s],u._resetPointsArrayCache(),r)for(u._boundingInfo=new n.BoundingInfo(o.minimum,o.maximum),f=0;f<u.subMeshes.length;f++)l=u.subMeshes[f],l.refreshBoundingInfo()}this.notifyUpdate(t)}},t.prototype.getTotalVertices=function(){return this.isReady()?this._totalVertices:0},t.prototype.getVerticesData=function(n,t){var u=this.getVertexBuffer(n),i;if(!u)return null;if(i=u.getData(),t&&1!==this._meshes.length){for(var e=i.length,f=[],r=0;e>r;r++)f.push(i[r]);return f}return i},t.prototype.getVertexBuffer=function(n){return this.isReady()?this._vertexBuffers[n]:null},t.prototype.getVertexBuffers=function(){return this.isReady()?this._vertexBuffers:null},t.prototype.isVerticesDataPresent=function(n){return this._vertexBuffers?void 0!==this._vertexBuffers[n]:this._delayInfo?-1!==this._delayInfo.indexOf(n):!1},t.prototype.getVerticesDataKinds=function(){var t=[],n;if(!this._vertexBuffers&&this._delayInfo)for(n in this._delayInfo)t.push(n);else for(n in this._vertexBuffers)t.push(n);return t},t.prototype.setIndices=function(n,t){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer);this._indices=n;0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices));void 0!==t&&(this._totalVertices=t);for(var r=this._meshes,u=r.length,i=0;u>i;i++)r[i]._createGlobalSubMesh();this.notifyUpdate()},t.prototype.getTotalIndices=function(){return this.isReady()?this._indices.length:0},t.prototype.getIndices=function(n){var t;if(!this.isReady())return null;if(t=this._indices,n&&1!==this._meshes.length){for(var u=t.length,r=[],i=0;u>i;i++)r.push(t[i]);return r}return t},t.prototype.getIndexBuffer=function(){return this.isReady()?this._indexBuffer:null},t.prototype.releaseForMesh=function(n,t){var i=this._meshes,r=i.indexOf(n),u;if(-1!==r){for(u in this._vertexBuffers)this._vertexBuffers[u].dispose();this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer)&&(this._indexBuffer=null);i.splice(r,1);n._geometry=null;0===i.length&&t&&this.dispose()}},t.prototype.applyToMesh=function(n){var t,i;n._geometry!==this&&(t=n._geometry,t&&t.releaseForMesh(n),i=this._meshes,n._geometry=this,this._scene.pushGeometry(this),i.push(n),this.isReady()?this._applyToMesh(n):n._boundingInfo=this._boundingInfo)},t.prototype._applyToMesh=function(t){var r=this._meshes.length,i,u;for(i in this._vertexBuffers)(1===r&&this._vertexBuffers[i].create(),this._vertexBuffers[i]._buffer.references=r,i===n.VertexBuffer.PositionKind)&&(t._resetPointsArrayCache(),u=n.Tools.ExtractMinAndMax(this._vertexBuffers[i].getData(),0,this._totalVertices),t._boundingInfo=new n.BoundingInfo(u.minimum,u.maximum),t._createGlobalSubMesh(),t._updateBoundingInfo());1===r&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices));this._indexBuffer&&(this._indexBuffer.references=r)},t.prototype.notifyUpdate=function(n){this.onGeometryUpdated&&this.onGeometryUpdated(this,n)},t.prototype.load=function(t,i){var r=this;if(this.delayLoadState!==n.Engine.DELAYLOADSTATE_LOADING){if(this.isReady())return void(i&&i());this.delayLoadState=n.Engine.DELAYLOADSTATE_LOADING;t._addPendingData(this);n.Tools.LoadFile(this.delayLoadingFile,function(u){r._delayLoadingFunction(JSON.parse(u),r);r.delayLoadState=n.Engine.DELAYLOADSTATE_LOADED;r._delayInfo=[];t._removePendingData(r);for(var e=r._meshes,o=e.length,f=0;o>f;f++)r._applyToMesh(e[f]);i&&i()},function(){},t.database)}},t.prototype.isDisposed=function(){return this._isDisposed},t.prototype.dispose=function(){for(var i=this._meshes,u=i.length,r,t=0;u>t;t++)this.releaseForMesh(i[t]);this._meshes=[];for(r in this._vertexBuffers)this._vertexBuffers[r].dispose();this._vertexBuffers=[];this._totalVertices=0;this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer);this._indexBuffer=null;this._indices=[];this.delayLoadState=n.Engine.DELAYLOADSTATE_NONE;this.delayLoadingFile=null;this._delayLoadingFunction=null;this._delayInfo=[];this._boundingInfo=null;this._scene.removeGeometry(this);this._isDisposed=!0},t.prototype.copy=function(i){var f=new n.VertexData,s,e,o,h,u,r,c;for(f.indices=[],s=this.getIndices(),e=0;e<s.length;e++)f.indices.push(s[e]);o=!1;h=!1;for(u in this._vertexBuffers)f.set(this.getVerticesData(u).slice(0),u),h||(o=this.getVertexBuffer(u).isUpdatable(),h=!o);r=new t(i,this._scene,f,o,null);r.delayLoadState=this.delayLoadState;r.delayLoadingFile=this.delayLoadingFile;r._delayLoadingFunction=this._delayLoadingFunction;for(u in this._delayInfo)r._delayInfo=r._delayInfo||[],r._delayInfo.push(u);return c=n.Tools.ExtractMinAndMax(this.getVerticesData(n.VertexBuffer.PositionKind),0,this.getTotalVertices()),r._boundingInfo=new n.BoundingInfo(c.minimum,c.maximum),r},t.ExtractFromMesh=function(n,t){var i=n._geometry;return i?i.copy(t):null},t.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"===n?t:3&t|8;return i.toString(16)})},t}();n.Geometry=t;!function(t){var i;!function(i){var r=function(n){function t(t,i,r,u,f){this._beingRegenerated=!0;this._canBeRegenerated=u;n.call(this,t,i,r,!1,f);this._beingRegenerated=!1}return __extends(t,n),t.prototype.canBeRegenerated=function(){return this._canBeRegenerated},t.prototype.regenerate=function(){this._canBeRegenerated&&(this._beingRegenerated=!0,this.setAllVerticesData(this._regenerateVertexData(),!1),this._beingRegenerated=!1)},t.prototype.asNewGeometry=function(t){return n.prototype.copy.call(this,t)},t.prototype.setAllVerticesData=function(t){this._beingRegenerated&&n.prototype.setAllVerticesData.call(this,t,!1)},t.prototype.setVerticesData=function(t,i){this._beingRegenerated&&n.prototype.setVerticesData.call(this,t,i,!1)},t.prototype._regenerateVertexData=function(){throw new Error("Abstract method");},t.prototype.copy=function(){throw new Error("Must be overriden in sub-classes.");},t}(t),u,f,e,o,s,h,c,l,a;i._Primitive=r;u=function(t){function i(i,r,u,f,e,o,s,h,c){void 0===c&&(c=n.Mesh.DEFAULTSIDE);this.pathArray=u;this.closeArray=f;this.closePath=e;this.offset=o;this.side=c;t.call(this,i,r,this._regenerateVertexData(),s,h)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateRibbon(this.pathArray,this.closeArray,this.closePath,this.offset,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.pathArray,this.closeArray,this.closePath,this.offset,this.canBeRegenerated(),null,this.side)},i}(r);i.Ribbon=u;f=function(t){function i(i,r,u,f,e,o){void 0===o&&(o=n.Mesh.DEFAULTSIDE);this.size=u;this.side=o;t.call(this,i,r,this._regenerateVertexData(),f,e)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateBox(this.size,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.size,this.canBeRegenerated(),null,this.side)},i}(r);i.Box=f;e=function(t){function i(i,r,u,f,e,o,s){void 0===s&&(s=n.Mesh.DEFAULTSIDE);this.segments=u;this.diameter=f;this.side=s;t.call(this,i,r,this._regenerateVertexData(),e,o)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateSphere(this.segments,this.diameter,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.segments,this.diameter,this.canBeRegenerated(),null,this.side)},i}(r);i.Sphere=e;o=function(t){function i(i,r,u,f,e,o,s,h,c,l){void 0===s&&(s=1);void 0===l&&(l=n.Mesh.DEFAULTSIDE);this.height=u;this.diameterTop=f;this.diameterBottom=e;this.tessellation=o;this.subdivisions=s;this.side=l;t.call(this,i,r,this._regenerateVertexData(),h,c)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateCylinder(this.height,this.diameterTop,this.diameterBottom,this.tessellation,this.subdivisions,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.height,this.diameterTop,this.diameterBottom,this.tessellation,this.subdivisions,this.canBeRegenerated(),null,this.side)},i}(r);i.Cylinder=o;s=function(t){function i(i,r,u,f,e,o,s,h){void 0===h&&(h=n.Mesh.DEFAULTSIDE);this.diameter=u;this.thickness=f;this.tessellation=e;this.side=h;t.call(this,i,r,this._regenerateVertexData(),o,s)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateTorus(this.diameter,this.thickness,this.tessellation,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.diameter,this.thickness,this.tessellation,this.canBeRegenerated(),null,this.side)},i}(r);i.Torus=s;h=function(t){function i(n,i,r,u,f,e,o){this.width=r;this.height=u;this.subdivisions=f;t.call(this,n,i,this._regenerateVertexData(),e,o)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateGround(this.width,this.height,this.subdivisions)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.width,this.height,this.subdivisions,this.canBeRegenerated(),null)},i}(r);i.Ground=h;c=function(t){function i(n,i,r,u,f,e,o,s,h,c){this.xmin=r;this.zmin=u;this.xmax=f;this.zmax=e;this.subdivisions=o;this.precision=s;t.call(this,n,i,this._regenerateVertexData(),h,c)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateTiledGround(this.xmin,this.zmin,this.xmax,this.zmax,this.subdivisions,this.precision)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.xmin,this.zmin,this.xmax,this.zmax,this.subdivisions,this.precision,this.canBeRegenerated(),null)},i}(r);i.TiledGround=c;l=function(t){function i(i,r,u,f,e,o){void 0===o&&(o=n.Mesh.DEFAULTSIDE);this.size=u;this.side=o;t.call(this,i,r,this._regenerateVertexData(),f,e)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreatePlane(this.size,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.size,this.canBeRegenerated(),null,this.side)},i}(r);i.Plane=l;a=function(t){function i(i,r,u,f,e,o,s,h,c,l,a){void 0===a&&(a=n.Mesh.DEFAULTSIDE);this.radius=u;this.tube=f;this.radialSegments=e;this.tubularSegments=o;this.p=s;this.q=h;this.side=a;t.call(this,i,r,this._regenerateVertexData(),c,l)}return __extends(i,t),i.prototype._regenerateVertexData=function(){return n.VertexData.CreateTorusKnot(this.radius,this.tube,this.radialSegments,this.tubularSegments,this.p,this.q,this.side)},i.prototype.copy=function(n){return new i(n,this.getScene(),this.radius,this.tube,this.radialSegments,this.tubularSegments,this.p,this.q,this.canBeRegenerated(),null,this.side)},i}(r);i.TorusKnot=a}(i=t.Primitives||(t.Primitives={}))}(t=n.Geometry||(n.Geometry={}))}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.generateOctree=!1;this._worldInverse=new n.Matrix}return __extends(i,t),Object.defineProperty(i.prototype,"subdivisions",{get:function(){return this._subdivisions},enumerable:!0,configurable:!0}),i.prototype.optimize=function(n,t){void 0===t&&(t=32);this._subdivisions=n;this.subdivide(this._subdivisions);this.createOrUpdateSubmeshesOctree(t)},i.prototype.getHeightAtCoordinates=function(t,i){var r=new n.Ray(new n.Vector3(t,this.getBoundingInfo().boundingBox.maximumWorld.y+1,i),new n.Vector3(0,-1,0)),u;return this.getWorldMatrix().invertToRef(this._worldInverse),r=n.Ray.Transform(r,this._worldInverse),u=this.intersects(r),u.hit?u.pickedPoint.y:0},i}(n.Mesh);n.GroundMesh=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e){void 0===u&&(u=null);t.call(this,i,r,u,f,e);this.color=new n.Color3(1,1,1);this.alpha=1;this._colorShader=new n.ShaderMaterial("colorShader",r,"color",{attributes:["position"],uniforms:["worldViewProjection","color"],needAlphaBlending:!0})}return __extends(i,t),Object.defineProperty(i.prototype,"material",{get:function(){return this._colorShader},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPickable",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"checkCollisions",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype._bind=function(){var t=this.getScene().getEngine(),i=this._geometry.getIndexBuffer();t.bindBuffers(this._geometry.getVertexBuffer(n.VertexBuffer.PositionKind).getBuffer(),i,[3],12,this._colorShader.getEffect());this._colorShader.setColor4("color",this.color.toColor4(this.alpha))},i.prototype._draw=function(n){if(this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){var t=this.getScene().getEngine();t.draw(!1,n.indexStart,n.indexCount)}},i.prototype.intersects=function(){return null},i.prototype.dispose=function(n){this._colorShader.dispose();t.prototype.dispose.call(this,n)},i.prototype.clone=function(n,t,r){return new i(n,this.getScene(),t,this,r)},i}(n.Mesh);n.LinesMesh=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n){this._scene=n}return t.prototype.render=function(t,i,r){var h=this,u,f,e;void 0===r&&(r=!1);var c=this._scene,o=this._scene.getEngine(),s=null!==o.getCaps().instancedArrays&&null!==i.visibleInstances[t._id]&&void 0!==i.visibleInstances[t._id];this.isReady(t,s)&&(u=t.getRenderingMesh(),f=t.getMaterial(),(o.enableEffect(this._effect),this._effect.setFloat("offset",r?0:u.outlineWidth),this._effect.setColor4("color",r?u.overlayColor:u.outlineColor,r?u.overlayAlpha:1),this._effect.setMatrix("viewProjection",c.getTransformMatrix()),u.useBones&&u.computeBonesUsingShaders&&this._effect.setMatrices("mBones",u.skeleton.getTransformMatrices()),u._bind(t,this._effect,n.Material.TriangleFillMode),f&&f.needAlphaTesting())&&(e=f.getAlphaTestTexture(),this._effect.setTexture("diffuseSampler",e),this._effect.setMatrix("diffuseMatrix",e.getTextureMatrix())),u._processRendering(t,this._effect,n.Material.TriangleFillMode,i,s,function(n,t){h._effect.setMatrix("world",t)}))},t.prototype.isReady=function(t,i){var u=[],r=[n.VertexBuffer.PositionKind,n.VertexBuffer.NormalKind],f=t.getMesh(),o=t.getMaterial(),e;return o&&o.needAlphaTesting()&&(u.push("#define ALPHATEST"),f.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(r.push(n.VertexBuffer.UVKind),u.push("#define UV1")),f.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(r.push(n.VertexBuffer.UV2Kind),u.push("#define UV2"))),f.useBones&&f.computeBonesUsingShaders&&(r.push(n.VertexBuffer.MatricesIndicesKind),r.push(n.VertexBuffer.MatricesWeightsKind),u.push("#define BONES"),u.push("#define BonesPerMesh "+(f.skeleton.bones.length+1))),i&&(u.push("#define INSTANCES"),r.push("world0"),r.push("world1"),r.push("world2"),r.push("world3")),e=u.join("\n"),this._cachedDefines!==e&&(this._cachedDefines=e,this._effect=this._scene.getEngine().createEffect("outline",r,["world","mBones","viewProjection","diffuseMatrix","offset","color"],["diffuseSampler"],e)),this._effect.isReady()},t}();n.OutlineRenderer=t}(BABYLON||(BABYLON={}));!function(n){var f=function(){function t(n,t,i,r){this.name=n;this.meshesNames=t;this.rootUrl=i;this.sceneFilename=r;this.isCompleted=!1}return t.prototype.run=function(t,i,r){var u=this;n.SceneLoader.ImportMesh(this.meshesNames,this.rootUrl,this.sceneFilename,t,function(n,t,r){u.loadedMeshes=n;u.loadedParticleSystems=t;u.loadedSkeletons=r;u.isCompleted=!0;u.onSuccess&&u.onSuccess(u);i()},null,function(){u.onError&&u.onError(u);r()})},t}(),t,i,r,u,e;n.MeshAssetTask=f;t=function(){function t(n,t){this.name=n;this.url=t;this.isCompleted=!1}return t.prototype.run=function(t,i,r){var u=this;n.Tools.LoadFile(this.url,function(n){u.text=n;u.isCompleted=!0;u.onSuccess&&u.onSuccess(u);i()},null,t.database,!1,function(){u.onError&&u.onError(u);r()})},t}();n.TextFileAssetTask=t;i=function(){function t(n,t){this.name=n;this.url=t;this.isCompleted=!1}return t.prototype.run=function(t,i,r){var u=this;n.Tools.LoadFile(this.url,function(n){u.data=n;u.isCompleted=!0;u.onSuccess&&u.onSuccess(u);i()},null,t.database,!0,function(){u.onError&&u.onError(u);r()})},t}();n.BinaryFileAssetTask=i;r=function(){function n(n,t){this.name=n;this.url=t;this.isCompleted=!1}return n.prototype.run=function(n,t,i){var r=this,u=new Image;u.onload=function(){r.image=u;r.isCompleted=!0;r.onSuccess&&r.onSuccess(r);t()};u.onerror=function(){r.onError&&r.onError(r);i()};u.src=this.url},n}();n.ImageAssetTask=r;u=function(){function t(t,i,r,u,f){void 0===f&&(f=n.Texture.TRILINEAR_SAMPLINGMODE);this.name=t;this.url=i;this.noMipmap=r;this.invertY=u;this.samplingMode=f;this.isCompleted=!1}return t.prototype.run=function(t,i,r){var u=this,f=function(){u.isCompleted=!0;u.onSuccess&&u.onSuccess(u);i()};this.texture=new n.Texture(this.url,t,this.noMipmap,this.invertY,this.samplingMode,f,r)},t}();n.TextureAssetTask=u;e=function(){function e(n){this._tasks=[];this._waitingTasksCount=0;this.useDefaultLoadingScreen=!0;this._scene=n}return e.prototype.addMeshTask=function(n,t,i,r){var u=new f(n,t,i,r);return this._tasks.push(u),u},e.prototype.addTextFileTask=function(n,i){var r=new t(n,i);return this._tasks.push(r),r},e.prototype.addBinaryFileTask=function(n,t){var r=new i(n,t);return this._tasks.push(r),r},e.prototype.addImageTask=function(n,t){var i=new r(n,t);return this._tasks.push(i),i},e.prototype.addTextureTask=function(t,i,r,f,e){void 0===e&&(e=n.Texture.TRILINEAR_SAMPLINGMODE);var o=new u(t,i,r,f,e);return this._tasks.push(o),o},e.prototype._decreaseWaitingTasksCount=function(){this._waitingTasksCount--;0===this._waitingTasksCount&&(this.onFinish&&this.onFinish(this._tasks),this._scene.getEngine().hideLoadingUI())},e.prototype._runTask=function(n){var t=this;n.run(this._scene,function(){t.onTaskSuccess&&t.onTaskSuccess(n);t._decreaseWaitingTasksCount()},function(){t.onTaskError&&t.onTaskError(n);t._decreaseWaitingTasksCount()})},e.prototype.reset=function(){return this._tasks=[],this},e.prototype.load=function(){var n,t;if(this._waitingTasksCount=this._tasks.length,0===this._waitingTasksCount)return this.onFinish&&this.onFinish(this._tasks),this;for(this.useDefaultLoadingScreen&&this._scene.getEngine().displayLoadingUI(),n=0;n<this._tasks.length;n++)t=this._tasks[n],this._runTask(t);return this},e}();n.AssetsManager=e}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){void 0===f&&(f=!0);t.call(this,i,r,u);this._alpha=0;this._beta=0;this._gamma=0;var e=n.VRCameraMetrics.GetDefault();e.compensateDistorsion=f;this.setCameraRigMode(n.Camera.RIG_MODE_VR,{vrCameraMetrics:e});this._deviceOrientationHandler=this._onOrientationEvent.bind(this)}return __extends(i,t),i.prototype._onOrientationEvent=function(n){this._alpha=0|+n.alpha;this._beta=0|+n.beta;this._gamma=0|+n.gamma;this._gamma=this._gamma<0?90+this._gamma:270-this._gamma;this.rotation.x=this._gamma/180*Math.PI;this.rotation.y=-this._alpha/180*Math.PI;this.rotation.z=this._beta/180*Math.PI},i.prototype.attachControl=function(n,i){t.prototype.attachControl.call(this,n,i);window.addEventListener("deviceorientation",this._deviceOrientationHandler)},i.prototype.detachControl=function(n){t.prototype.detachControl.call(this,n);window.removeEventListener("deviceorientation",this._deviceOrientationHandler)},i}(n.FreeCamera);n.VRDeviceOrientationFreeCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){void 0===f&&(f=!0);t.call(this,i,r,u);this._hmdDevice=null;this._sensorDevice=null;this._cacheState=null;this._cacheQuaternion=new n.Quaternion;this._cacheRotation=n.Vector3.Zero();this._vrEnabled=!1;var e=n.VRCameraMetrics.GetDefault();e.compensateDistorsion=f;this.setCameraRigMode(n.Camera.RIG_MODE_VR,{vrCameraMetrics:e});this._getWebVRDevices=this._getWebVRDevices.bind(this)}return __extends(i,t),i.prototype._getWebVRDevices=function(n){var i=n.length,t=0;for(this._sensorDevice=null,this._hmdDevice=null;i>t&&null===this._hmdDevice;)n[t]instanceof HMDVRDevice&&(this._hmdDevice=n[t]),t++;for(t=0;i>t&&null===this._sensorDevice;)n[t]instanceof PositionSensorVRDevice&&(!this._hmdDevice||n[t].hardwareUnitId===this._hmdDevice.hardwareUnitId)&&(this._sensorDevice=n[t]),t++;this._vrEnabled=this._sensorDevice&&this._hmdDevice?!0:!1},i.prototype._checkInputs=function(){this._vrEnabled&&(this._cacheState=this._sensorDevice.getState(),this._cacheQuaternion.copyFromFloats(this._cacheState.orientation.x,this._cacheState.orientation.y,this._cacheState.orientation.z,this._cacheState.orientation.w),this._cacheQuaternion.toEulerAnglesToRef(this._cacheRotation),this.rotation.x=-this._cacheRotation.z,this.rotation.y=-this._cacheRotation.y,this.rotation.z=this._cacheRotation.x);t.prototype._checkInputs.call(this)},i.prototype.attachControl=function(n,i){t.prototype.attachControl.call(this,n,i);navigator.getVRDevices?navigator.getVRDevices().then(this._getWebVRDevices):navigator.mozGetVRDevices&&navigator.mozGetVRDevices(this._getWebVRDevices)},i.prototype.detachControl=function(n){t.prototype.detachControl.call(this,n);this._vrEnabled=!1},i}(n.FreeCamera);n.WebVRFreeCamera=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n){void 0===n&&(n=0);this.priority=n;this.apply=function(){return!0}}return n}(),i,s,r,u,f,e,h,o,c,l;n.SceneOptimization=t;i=function(n){function t(t,i){var r=this;void 0===t&&(t=0);void 0===i&&(i=1024);n.call(this,t);this.priority=t;this.maximumSize=i;this.apply=function(n){for(var i,f,e,u=!0,t=0;t<n.textures.length;t++)i=n.textures[t],i.canRescale&&(f=i.getSize(),e=Math.max(f.width,f.height),e>r.maximumSize&&(i.scale(.5),u=!1));return u}}return __extends(t,n),t}(t);n.TextureOptimization=i;s=function(n){function t(t,i){var r=this;void 0===t&&(t=0);void 0===i&&(i=2);n.call(this,t);this.priority=t;this.maximumScale=i;this._currentScale=1;this.apply=function(n){return r._currentScale++,n.getEngine().setHardwareScalingLevel(r._currentScale),r._currentScale>=r.maximumScale}}return __extends(t,n),t}(t);n.HardwareScalingOptimization=s;r=function(n){function t(){n.apply(this,arguments);this.apply=function(n){return n.shadowsEnabled=!1,!0}}return __extends(t,n),t}(t);n.ShadowsOptimization=r;u=function(n){function t(){n.apply(this,arguments);this.apply=function(n){return n.postProcessesEnabled=!1,!0}}return __extends(t,n),t}(t);n.PostProcessesOptimization=u;f=function(n){function t(){n.apply(this,arguments);this.apply=function(n){return n.lensFlaresEnabled=!1,!0}}return __extends(t,n),t}(t);n.LensFlaresOptimization=f;e=function(n){function t(){n.apply(this,arguments);this.apply=function(n){return n.particlesEnabled=!1,!0}}return __extends(t,n),t}(t);n.ParticlesOptimization=e;h=function(n){function t(){n.apply(this,arguments);this.apply=function(n){return n.renderTargetsEnabled=!1,!0}}return __extends(t,n),t}(t);n.RenderTargetsOptimization=h;o=function(t){function i(){var r=this;t.apply(this,arguments);this._canBeMerged=function(t){if(!(t instanceof n.Mesh))return!1;var i=t;return i.isVisible&&i.isEnabled()?i.instances.length>0?!1:i.skeleton||i.hasLODLevels?!1:!0:!1};this.apply=function(t,u){for(var e,o,f,s,h=t.meshes.slice(0),l=h.length,c=0;l>c;c++)if(e=[],o=h[c],r._canBeMerged(o)){for(e.push(o),f=c+1;l>f;f++)s=h[f],r._canBeMerged(s)&&s.material===o.material&&s.checkCollisions===o.checkCollisions&&(e.push(s),l--,h.splice(f,1),f--);e.length<2||n.Mesh.MergeMeshes(e)}return void 0!=u?u&&t.createOrUpdateSelectionOctree():i.UpdateSelectionTree&&t.createOrUpdateSelectionOctree(),!0}}return __extends(i,t),Object.defineProperty(i,"UpdateSelectionTree",{get:function(){return i._UpdateSelectionTree},set:function(n){i._UpdateSelectionTree=n},enumerable:!0,configurable:!0}),i._UpdateSelectionTree=!1,i}(t);n.MergeMeshesOptimization=o;c=function(){function n(n,t){void 0===n&&(n=60);void 0===t&&(t=2e3);this.targetFrameRate=n;this.trackerDuration=t;this.optimizations=[]}return n.LowDegradationAllowed=function(t){var h=new n(t),s=0;return h.optimizations.push(new o(s)),h.optimizations.push(new r(s)),h.optimizations.push(new f(s)),s++,h.optimizations.push(new u(s)),h.optimizations.push(new e(s)),s++,h.optimizations.push(new i(s,1024)),h},n.ModerateDegradationAllowed=function(t){var l=new n(t),c=0;return l.optimizations.push(new o(c)),l.optimizations.push(new r(c)),l.optimizations.push(new f(c)),c++,l.optimizations.push(new u(c)),l.optimizations.push(new e(c)),c++,l.optimizations.push(new i(c,512)),c++,l.optimizations.push(new h(c)),c++,l.optimizations.push(new s(c,2)),l},n.HighDegradationAllowed=function(t){var l=new n(t),c=0;return l.optimizations.push(new o(c)),l.optimizations.push(new r(c)),l.optimizations.push(new f(c)),c++,l.optimizations.push(new u(c)),l.optimizations.push(new e(c)),c++,l.optimizations.push(new i(c,256)),c++,l.optimizations.push(new h(c)),c++,l.optimizations.push(new s(c,4)),l},n}();n.SceneOptimizerOptions=c;l=function(){function n(){}return n._CheckCurrentState=function(t,i,r,u,f){var s;if(t.getEngine().getFps()>=i.targetFrameRate)return void(u&&u());for(var e=!0,h=!0,o=0;o<i.optimizations.length;o++)s=i.optimizations[o],s.priority===r&&(h=!1,e=e&&s.apply(t));return h?void(f&&f()):(e&&r++,void t.executeWhenReady(function(){setTimeout(function(){n._CheckCurrentState(t,i,r,u,f)},i.trackerDuration)}))},n.OptimizeAsync=function(t,i,r,u){i||(i=c.ModerateDegradationAllowed());t.executeWhenReady(function(){setTimeout(function(){n._CheckCurrentState(t,i,0,r,u)},i.trackerDuration)})},n}();n.SceneOptimizer=l}(BABYLON||(BABYLON={}));!function(n){var t;!function(n){var t=function(){function n(n,t){this.distance=n;this.mesh=t}return n}();n.MeshLODLevel=t}(t=n.Internals||(n.Internals={}))}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){this._audioContext=null;this._audioContextInitialized=!1;this.canUseWebAudio=!1;this.WarnedWebAudioUnsupported=!1;("undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext)&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.canUseWebAudio=!0)}return Object.defineProperty(t.prototype,"audioContext",{get:function(){return this._audioContextInitialized||this._initializeAudioContext(),this._audioContext},enumerable:!0,configurable:!0}),t.prototype._initializeAudioContext=function(){try{this.canUseWebAudio&&(this._audioContext=new AudioContext,this.masterGain=this._audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this._audioContext.destination),this._audioContextInitialized=!0)}catch(t){this.canUseWebAudio=!1;n.Tools.Error("Web Audio: "+t.message)}},t.prototype.dispose=function(){this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser&&(this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser.dispose(),this.masterGain.disconnect(),this.masterGain.connect(this._audioContext.destination),this._connectedAnalyser=null),this.masterGain.gain.value=1);this.WarnedWebAudioUnsupported=!1},t.prototype.getGlobalVolume=function(){return this.canUseWebAudio&&this._audioContextInitialized?this.masterGain.gain.value:-1},t.prototype.setGlobalVolume=function(n){this.canUseWebAudio&&this._audioContextInitialized&&(this.masterGain.gain.value=n)},t.prototype.connectToAnalyser=function(n){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser=n,this.masterGain.disconnect(),this._connectedAnalyser.connectAudioNodes(this.masterGain,this._audioContext.destination))},t}();n.AudioEngine=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i,r,u,f){var e=this;this.autoplay=!1;this.loop=!1;this.useCustomAttenuation=!1;this.spatialSound=!1;this.refDistance=1;this.rolloffFactor=1;this.maxDistance=100;this.distanceModel="linear";this._panningModel="equalpower";this._playbackRate=1;this._startTime=0;this._startOffset=0;this._position=n.Vector3.Zero();this._localDirection=new n.Vector3(1,0,0);this._volume=1;this._isLoaded=!1;this._isReadyToPlay=!1;this.isPlaying=!1;this.isPaused=!1;this._isDirectional=!1;this._coneInnerAngle=360;this._coneOuterAngle=360;this._coneOuterGain=0;this._isOutputConnected=!1;this.name=t;this._scene=r;this._readyToPlayCallback=u;this._customAttenuationFunction=function(n,t,i){return i>t?n*(1-t/i):0};f&&(this.autoplay=f.autoplay||!1,this.loop=f.loop||!1,void 0!==f.volume&&(this._volume=f.volume),this.spatialSound=f.spatialSound||!1,this.maxDistance=f.maxDistance||100,this.useCustomAttenuation=f.useCustomAttenuation||!1,this.rolloffFactor=f.rolloffFactor||1,this.refDistance=f.refDistance||1,this.distanceModel=f.distanceModel||"linear",this._playbackRate=f.playbackRate||1);n.Engine.audioEngine.canUseWebAudio?(this._soundGain=n.Engine.audioEngine.audioContext.createGain(),this._soundGain.gain.value=this._volume,this._inputAudioNode=this._soundGain,this._ouputAudioNode=this._soundGain,this.spatialSound&&this._createSpatialParameters(),this._scene.mainSoundTrack.AddSound(this),i&&("string"==typeof i?n.Tools.LoadFile(i,function(n){e._soundLoaded(n)},null,null,!0):i instanceof ArrayBuffer?this._soundLoaded(i):n.Tools.Error("Parameter must be a URL to the sound or an ArrayBuffer of the sound."))):(this._scene.mainSoundTrack.AddSound(this),n.Engine.audioEngine.WarnedWebAudioUnsupported||(n.Tools.Error("Web Audio is not supported by your browser."),n.Engine.audioEngine.WarnedWebAudioUnsupported=!0),this._readyToPlayCallback&&window.setTimeout(function(){e._readyToPlayCallback()},1e3))}return t.prototype.dispose=function(){n.Engine.audioEngine.canUseWebAudio&&this._isReadyToPlay&&(this.isPlaying&&this.stop(),this._isReadyToPlay=!1,-1===this.soundTrackId?this._scene.mainSoundTrack.RemoveSound(this):this._scene.soundTracks[this.soundTrackId].RemoveSound(this),this._soundGain&&(this._soundGain.disconnect(),this._soundGain=null),this._soundPanner&&(this._soundPanner.disconnect(),this._soundPanner=null),this._soundSource&&(this._soundSource.disconnect(),this._soundSource=null),this._audioBuffer=null,this._connectedMesh&&(this._connectedMesh.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._connectedMesh=null))},t.prototype._soundLoaded=function(t){var i=this;this._isLoaded=!0;n.Engine.audioEngine.audioContext.decodeAudioData(t,function(n){i._audioBuffer=n;i._isReadyToPlay=!0;i.autoplay&&i.play();i._readyToPlayCallback&&i._readyToPlayCallback()},function(){n.Tools.Error("Error while decoding audio data for: "+i.name)})},t.prototype.setAudioBuffer=function(t){n.Engine.audioEngine.canUseWebAudio&&(this._audioBuffer=t,this._isReadyToPlay=!0)},t.prototype.updateOptions=function(n){n&&(this.loop=n.loop||this.loop,this.maxDistance=n.maxDistance||this.maxDistance,this.useCustomAttenuation=n.useCustomAttenuation||this.useCustomAttenuation,this.rolloffFactor=n.rolloffFactor||this.rolloffFactor,this.refDistance=n.refDistance||this.refDistance,this.distanceModel=n.distanceModel||this.distanceModel,this._playbackRate=n.playbackRate||this._playbackRate,this._updateSpatialParameters(),this.isPlaying&&(this._soundSource.playbackRate.value=this._playbackRate))},t.prototype._createSpatialParameters=function(){n.Engine.audioEngine.canUseWebAudio&&(this._scene.headphone&&(this._panningModel="HRTF"),this._soundPanner=n.Engine.audioEngine.audioContext.createPanner(),this._updateSpatialParameters(),this._soundPanner.connect(this._ouputAudioNode),this._inputAudioNode=this._soundPanner)},t.prototype._updateSpatialParameters=function(){this.spatialSound&&(this.useCustomAttenuation?(this._soundPanner.distanceModel="linear",this._soundPanner.maxDistance=Number.MAX_VALUE,this._soundPanner.refDistance=1,this._soundPanner.rolloffFactor=1,this._soundPanner.panningModel=this._panningModel):(this._soundPanner.distanceModel=this.distanceModel,this._soundPanner.maxDistance=this.maxDistance,this._soundPanner.refDistance=this.refDistance,this._soundPanner.rolloffFactor=this.rolloffFactor,this._soundPanner.panningModel=this._panningModel))},t.prototype.switchPanningModelToHRTF=function(){this._panningModel="HRTF";this._switchPanningModel()},t.prototype.switchPanningModelToEqualPower=function(){this._panningModel="equalpower";this._switchPanningModel()},t.prototype._switchPanningModel=function(){n.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&(this._soundPanner.panningModel=this._panningModel)},t.prototype.connectToSoundTrackAudioNode=function(t){n.Engine.audioEngine.canUseWebAudio&&(this._isOutputConnected&&this._ouputAudioNode.disconnect(),this._ouputAudioNode.connect(t),this._isOutputConnected=!0)},t.prototype.setDirectionalCone=function(t,i,r){return t>i?void n.Tools.Error("setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle."):(this._coneInnerAngle=t,this._coneOuterAngle=i,this._coneOuterGain=r,this._isDirectional=!0,void(this.isPlaying&&this.loop&&(this.stop(),this.play())))},t.prototype.setPosition=function(t){this._position=t;n.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z)},t.prototype.setLocalDirectionToMesh=function(t){this._localDirection=t;n.Engine.audioEngine.canUseWebAudio&&this._connectedMesh&&this.isPlaying&&this._updateDirection()},t.prototype._updateDirection=function(){var i=this._connectedMesh.getWorldMatrix(),t=n.Vector3.TransformNormal(this._localDirection,i);t.normalize();this._soundPanner.setOrientation(t.x,t.y,t.z)},t.prototype.updateDistanceFromListener=function(){if(n.Engine.audioEngine.canUseWebAudio&&this._connectedMesh&&this.useCustomAttenuation){var t=this._connectedMesh.getDistanceToCamera(this._scene.activeCamera);this._soundGain.gain.value=this._customAttenuationFunction(this._volume,t,this.maxDistance,this.refDistance,this.rolloffFactor)}},t.prototype.setAttenuationFunction=function(n){this._customAttenuationFunction=n},t.prototype.play=function(t){var r=this,i;if(this._isReadyToPlay&&this._scene.audioEnabled)try{i=t?n.Engine.audioEngine.audioContext.currentTime+t:n.Engine.audioEngine.audioContext.currentTime;this._soundSource||this.spatialSound&&(this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z),this._isDirectional&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle,this._soundPanner.coneOuterAngle=this._coneOuterAngle,this._soundPanner.coneOuterGain=this._coneOuterGain,this._connectedMesh?this._updateDirection():this._soundPanner.setOrientation(this._localDirection.x,this._localDirection.y,this._localDirection.z)));this._soundSource=n.Engine.audioEngine.audioContext.createBufferSource();this._soundSource.buffer=this._audioBuffer;this._soundSource.connect(this._inputAudioNode);this._soundSource.loop=this.loop;this._soundSource.playbackRate.value=this._playbackRate;this._startTime=i;this._soundSource.onended=function(){r._onended()};this._soundSource.start(this._startTime,this.isPaused?this._startOffset%this._soundSource.buffer.duration:0);this.isPlaying=!0;this.isPaused=!1}catch(u){n.Tools.Error("Error while trying to play audio: "+this.name+", "+u.message)}},t.prototype._onended=function(){this.isPlaying=!1;this.onended&&this.onended()},t.prototype.stop=function(t){if(this.isPlaying){var i=t?n.Engine.audioEngine.audioContext.currentTime+t:n.Engine.audioEngine.audioContext.currentTime;this._soundSource.stop(i);this.isPlaying=!1}},t.prototype.pause=function(){this.isPlaying&&(this.stop(0),this._startOffset+=n.Engine.audioEngine.audioContext.currentTime-this._startTime,this.isPaused=!0)},t.prototype.setVolume=function(t,i){n.Engine.audioEngine.canUseWebAudio&&(i?(this._soundGain.gain.linearRampToValueAtTime(this._volume,n.Engine.audioEngine.audioContext.currentTime),this._soundGain.gain.linearRampToValueAtTime(t,i)):this._soundGain.gain.value=t);this._volume=t},t.prototype.setPlaybackRate=function(n){this._playbackRate=n;this.isPlaying&&(this._soundSource.playbackRate.value=this._playbackRate)},t.prototype.getVolume=function(){return this._volume},t.prototype.attachToMesh=function(n){var t=this;this._connectedMesh=n;this.spatialSound||(this.spatialSound=!0,this._createSpatialParameters(),this.isPlaying&&this.loop&&(this.stop(),this.play()));this._onRegisterAfterWorldMatrixUpdate(this._connectedMesh);this._registerFunc=function(n){return t._onRegisterAfterWorldMatrixUpdate(n)};n.registerAfterWorldMatrixUpdate(this._registerFunc)},t.prototype._onRegisterAfterWorldMatrixUpdate=function(t){this.setPosition(t.getBoundingInfo().boundingSphere.centerWorld);n.Engine.audioEngine.canUseWebAudio&&this._isDirectional&&this.isPlaying&&this._updateDirection()},t}();n.Sound=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){this.id=-1;this._isMainTrack=!1;this._scene=t;this._audioEngine=n.Engine.audioEngine;this.soundCollection=[];this._audioEngine.canUseWebAudio&&(this._outputAudioNode=this._audioEngine.audioContext.createGain(),this._outputAudioNode.connect(this._audioEngine.masterGain),i&&(i.volume&&(this._outputAudioNode.gain.value=i.volume),i.mainTrack&&(this._isMainTrack=i.mainTrack)));this._isMainTrack||(this._scene.soundTracks.push(this),this.id=this._scene.soundTracks.length-1)}return t.prototype.dispose=function(){if(this._audioEngine.canUseWebAudio){for(this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this.soundCollection.length;)this.soundCollection[0].dispose();this._outputAudioNode&&this._outputAudioNode.disconnect();this._outputAudioNode=null}},t.prototype.AddSound=function(t){n.Engine.audioEngine.canUseWebAudio&&t.connectToSoundTrackAudioNode(this._outputAudioNode);t.soundTrackId&&(-1===t.soundTrackId?this._scene.mainSoundTrack.RemoveSound(t):this._scene.soundTracks[t.soundTrackId].RemoveSound(t));this.soundCollection.push(t);t.soundTrackId=this.id},t.prototype.RemoveSound=function(n){var t=this.soundCollection.indexOf(n);-1!==t&&this.soundCollection.splice(t,1)},t.prototype.setVolume=function(n){this._audioEngine.canUseWebAudio&&(this._outputAudioNode.gain.value=n)},t.prototype.switchPanningModelToHRTF=function(){if(n.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToHRTF()},t.prototype.switchPanningModelToEqualPower=function(){if(n.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToEqualPower()},t.prototype.connectToAnalyser=function(n){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this._connectedAnalyser=n;this._audioEngine.canUseWebAudio&&(this._outputAudioNode.disconnect(),this._connectedAnalyser.connectAudioNodes(this._outputAudioNode,this._audioEngine.masterGain))},t}();n.SoundTrack=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){var i=this;this._transformationMatrix=n.Matrix.Identity();this._enabled=!1;this._labelsEnabled=!1;this._displayStatistics=!0;this._displayTree=!1;this._displayLogs=!1;this._identityMatrix=n.Matrix.Identity();this.axisRatio=.02;this.accentColor="orange";this._scene=t;this._syncPositions=function(){var t=i._scene.getEngine(),n=t.getRenderingCanvasClientRect();i._showUI&&(i._statsDiv.style.left=n.width-410+"px",i._statsDiv.style.top=n.height-290+"px",i._statsDiv.style.width="400px",i._statsDiv.style.height="auto",i._statsSubsetDiv.style.maxHeight="240px",i._optionsDiv.style.left="0px",i._optionsDiv.style.top="10px",i._optionsDiv.style.width="200px",i._optionsDiv.style.height="auto",i._optionsSubsetDiv.style.maxHeight=n.height-225+"px",i._logDiv.style.left="0px",i._logDiv.style.top=n.height-170+"px",i._logDiv.style.width="600px",i._logDiv.style.height="160px",i._treeDiv.style.left=n.width-310+"px",i._treeDiv.style.top="10px",i._treeDiv.style.width="300px",i._treeDiv.style.height="auto",i._treeSubsetDiv.style.maxHeight=n.height-340+"px");i._globalDiv.style.left=n.left+"px";i._globalDiv.style.top=n.top+"px";i._drawingCanvas.style.left="0px";i._drawingCanvas.style.top="0px";i._drawingCanvas.style.width=t.getRenderWidth()+"px";i._drawingCanvas.style.height=t.getRenderHeight()+"px";var u=window.devicePixelRatio||1,r=i._drawingContext,f=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;i._ratio=u/f;i._drawingCanvas.width=t.getRenderWidth()*i._ratio;i._drawingCanvas.height=t.getRenderHeight()*i._ratio};this._onCanvasClick=function(n){i._clickPosition={x:n.clientX*i._ratio,y:n.clientY*i._ratio}};this._syncUI=function(){i._showUI&&(i._displayStatistics?(i._displayStats(),i._statsDiv.style.display=""):i._statsDiv.style.display="none",i._logDiv.style.display=i._displayLogs?"":"none",i._displayTree?(i._treeDiv.style.display="",i._needToRefreshMeshesTree&&(i._needToRefreshMeshesTree=!1,i._refreshMeshesTreeContent())):i._treeDiv.style.display="none")};this._syncData=function(){var h,e,c,u;if(i._labelsEnabled||!i._showUI){i._camera.getViewMatrix().multiplyToRef(i._camera.getProjectionMatrix(),i._transformationMatrix);i._drawingContext.clearRect(0,0,i._drawingCanvas.width,i._drawingCanvas.height);for(var s=i._scene.getEngine(),a=i._camera.viewport,o=a.toGlobal(s),l=i._camera.getActiveMeshes(),t=0;t<l.length;t++){var r=l.data[t],v=r.getBoundingInfo().boundingSphere.center,f=n.Vector3.Project(v,r.getWorldMatrix(),i._transformationMatrix,o);(r.renderOverlay||i.shouldDisplayAxis&&i.shouldDisplayAxis(r))&&i._renderAxis(f,r,o);(!i.shouldDisplayLabel||i.shouldDisplayLabel(r))&&i._renderLabel(r.name,f,12,function(){r.renderOverlay=!r.renderOverlay},function(){return r.renderOverlay?"red":"black"})}for(h=i._scene.cameras,t=0;t<h.length;t++)e=h[t],e!==i._camera&&(f=n.Vector3.Project(n.Vector3.Zero(),e.getWorldMatrix(),i._transformationMatrix,o),(!i.shouldDisplayLabel||i.shouldDisplayLabel(e))&&i._renderLabel(e.name,f,12,function(){i._camera.detachControl(s.getRenderingCanvas());i._camera=e;i._camera.attachControl(s.getRenderingCanvas())},function(){return"purple"}));for(c=i._scene.lights,t=0;t<c.length;t++)u=c[t],u.position&&(f=n.Vector3.Project(u.getAbsolutePosition(),i._identityMatrix,i._transformationMatrix,o),(!i.shouldDisplayLabel||i.shouldDisplayLabel(u))&&i._renderLabel(u.name,f,-20,function(){u.setEnabled(!u.isEnabled())},function(){return u.isEnabled()?"orange":"gray"}))}i._clickPosition=void 0}}return t.prototype._refreshMeshesTreeContent=function(){for(var t,i,n;this._treeSubsetDiv.hasChildNodes();)this._treeSubsetDiv.removeChild(this._treeSubsetDiv.lastChild);for(t=this._scene.meshes.slice(0,this._scene.meshes.length),t.sort(function(n,t){return n.name===t.name?0:n.name>t.name?1:-1}),i=0;i<t.length;i++)n=t[i],n.isEnabled()&&this._generateAdvancedCheckBox(this._treeSubsetDiv,n.name,n.getTotalVertices()+" verts",n.isVisible,function(n,t){t.isVisible=n.checked},n)},t.prototype._renderSingleAxis=function(n,t,i,r,u){this._drawingContext.beginPath();this._drawingContext.moveTo(n.x,n.y);this._drawingContext.lineTo(t.x,t.y);this._drawingContext.strokeStyle=u;this._drawingContext.lineWidth=4;this._drawingContext.stroke();this._drawingContext.font="normal 14px Segoe UI";this._drawingContext.fillStyle=u;this._drawingContext.fillText(r,i.x,i.y)},t.prototype._renderAxis=function(t,i,r){var u=i.getBoundingInfo().boundingSphere.center,f=i.getWorldMatrix(),l=n.Vector3.UnprojectFromTransform(t.add(new n.Vector3(this._drawingCanvas.width*this.axisRatio,0,0)),r.width,r.height,f,this._transformationMatrix),e=l.subtract(u).length(),a=n.Vector3.Project(u.add(new n.Vector3(e,0,0)),f,this._transformationMatrix,r),v=n.Vector3.Project(u.add(new n.Vector3(1.5*e,0,0)),f,this._transformationMatrix,r),o,s,h,c;this._renderSingleAxis(t,a,v,"x","#FF0000");o=n.Vector3.Project(u.add(new n.Vector3(0,e,0)),f,this._transformationMatrix,r);s=n.Vector3.Project(u.add(new n.Vector3(0,1.5*e,0)),f,this._transformationMatrix,r);this._renderSingleAxis(t,o,s,"y","#00FF00");h=n.Vector3.Project(u.add(new n.Vector3(0,0,e)),f,this._transformationMatrix,r);c=n.Vector3.Project(u.add(new n.Vector3(0,0,1.5*e)),f,this._transformationMatrix,r);this._renderSingleAxis(t,h,c,"z","#0000FF")},t.prototype._renderLabel=function(n,t,i,r,u){if(t.z>0&&t.z<1){this._drawingContext.font="normal 12px Segoe UI";var e=this._drawingContext.measureText(n),o=t.x-e.width/2,f=t.y,s=this._drawingCanvas.getBoundingClientRect();this._showUI&&this._isClickInsideRect(s.left*this._ratio+o-5,s.top*this._ratio+f-i-12,e.width+10,17)&&r();this._drawingContext.beginPath();this._drawingContext.rect(o-5,f-i-12,e.width+10,17);this._drawingContext.fillStyle=u();this._drawingContext.globalAlpha=.5;this._drawingContext.fill();this._drawingContext.globalAlpha=1;this._drawingContext.strokeStyle="#FFFFFF";this._drawingContext.lineWidth=1;this._drawingContext.stroke();this._drawingContext.fillStyle="#FFFFFF";this._drawingContext.fillText(n,o,f-i);this._drawingContext.beginPath();this._drawingContext.arc(t.x,f,5,0,2*Math.PI,!1);this._drawingContext.fill()}},t.prototype._isClickInsideRect=function(n,t,i,r){return this._clickPosition?this._clickPosition.x<n||this._clickPosition.x>n+i?!1:this._clickPosition.y<t||this._clickPosition.y>t+r?!1:!0:!1},t.prototype.isVisible=function(){return this._enabled},t.prototype.hide=function(){if(this._enabled){this._enabled=!1;var t=this._scene.getEngine();this._scene.unregisterBeforeRender(this._syncData);this._scene.unregisterAfterRender(this._syncUI);document.body.removeChild(this._globalDiv);window.removeEventListener("resize",this._syncPositions);this._scene.forceShowBoundingBoxes=!1;this._scene.forceWireframe=!1;n.StandardMaterial.DiffuseTextureEnabled=!0;n.StandardMaterial.AmbientTextureEnabled=!0;n.StandardMaterial.SpecularTextureEnabled=!0;n.StandardMaterial.EmissiveTextureEnabled=!0;n.StandardMaterial.BumpTextureEnabled=!0;n.StandardMaterial.OpacityTextureEnabled=!0;n.StandardMaterial.ReflectionTextureEnabled=!0;this._scene.shadowsEnabled=!0;this._scene.particlesEnabled=!0;this._scene.postProcessesEnabled=!0;this._scene.collisionsEnabled=!0;this._scene.lightsEnabled=!0;this._scene.texturesEnabled=!0;this._scene.lensFlaresEnabled=!0;this._scene.proceduralTexturesEnabled=!0;this._scene.renderTargetsEnabled=!0;t.getRenderingCanvas().removeEventListener("click",this._onCanvasClick)}},t.prototype.show=function(n,t){if(void 0===n&&(n=!0),void 0===t&&(t=null),!this._enabled){this._enabled=!0;this._camera=t?t:this._scene.activeCamera;this._showUI=n;var i=this._scene.getEngine();this._globalDiv=document.createElement("div");document.body.appendChild(this._globalDiv);this._generateDOMelements();window.addEventListener("resize",this._syncPositions);i.getRenderingCanvas().addEventListener("click",this._onCanvasClick);this._syncPositions();this._scene.registerBeforeRender(this._syncData);this._scene.registerAfterRender(this._syncUI)}},t.prototype._clearLabels=function(){var n,t;for(this._drawingContext.clearRect(0,0,this._drawingCanvas.width,this._drawingCanvas.height),n=0;n<this._scene.meshes.length;n++)t=this._scene.meshes[n],t.renderOverlay=!1},t.prototype._generateheader=function(n,t){var i=document.createElement("div");i.innerHTML=t+"&nbsp;";i.style.textAlign="right";i.style.width="100%";i.style.color="white";i.style.backgroundColor="Black";i.style.padding="5px 5px 4px 0px";i.style.marginLeft="-5px";i.style.fontWeight="bold";n.appendChild(i)},t.prototype._generateTexBox=function(n,t,i){var r=document.createElement("label");r.innerHTML=t;r.style.color=i;n.appendChild(r);n.appendChild(document.createElement("br"))},t.prototype._generateAdvancedCheckBox=function(n,t,i,r,u,f){var s,e;void 0===f&&(f=null);s=document.createElement("label");e=document.createElement("input");e.type="checkbox";e.checked=r;e.addEventListener("change",function(n){u(n.target,f)});s.appendChild(e);var h=document.createElement("span"),c=document.createElement("span"),o=document.createElement("span");o.style.cssFloat="right";c.innerHTML=t;o.innerHTML=i;o.style.fontSize="12px";o.style.maxWidth="200px";h.appendChild(c);h.appendChild(o);s.appendChild(h);n.appendChild(s);n.appendChild(document.createElement("br"))},t.prototype._generateCheckBox=function(n,t,i,r,u){void 0===u&&(u=null);var e=document.createElement("label"),f=document.createElement("input");f.type="checkbox";f.checked=i;f.addEventListener("change",function(n){r(n.target,u)});e.appendChild(f);e.appendChild(document.createTextNode(t));n.appendChild(e);n.appendChild(document.createElement("br"))},t.prototype._generateButton=function(n,t,i,r){void 0===r&&(r=null);var u=document.createElement("button");u.innerHTML=t;u.style.height="24px";u.style.color="#444444";u.style.border="1px solid white";u.className="debugLayerButton";u.addEventListener("click",function(n){i(n.target,r)});n.appendChild(u);n.appendChild(document.createElement("br"))},t.prototype._generateRadio=function(n,t,i,r,u,f){void 0===f&&(f=null);var o=document.createElement("label"),e=document.createElement("input");e.type="radio";e.name=i;e.checked=r;e.addEventListener("change",function(n){u(n.target,f)});o.appendChild(e);o.appendChild(document.createTextNode(t));n.appendChild(o);n.appendChild(document.createElement("br"))},t.prototype._generateDOMelements=function(){var t=this,i,r;(this._globalDiv.id="DebugLayer",this._globalDiv.style.position="absolute",this._globalDiv.style.fontFamily="Segoe UI, Arial",this._globalDiv.style.fontSize="14px",this._globalDiv.style.color="white",this._drawingCanvas=document.createElement("canvas"),this._drawingCanvas.id="DebugLayerDrawingCanvas",this._drawingCanvas.style.position="absolute",this._drawingCanvas.style.pointerEvents="none",this._drawingContext=this._drawingCanvas.getContext("2d"),this._globalDiv.appendChild(this._drawingCanvas),this._showUI)&&(i="rgba(128, 128, 128, 0.4)",r="rgb(180, 180, 180) solid 1px",this._statsDiv=document.createElement("div"),this._statsDiv.id="DebugLayerStats",this._statsDiv.style.border=r,this._statsDiv.style.position="absolute",this._statsDiv.style.background=i,this._statsDiv.style.padding="0px 0px 0px 5px",this._generateheader(this._statsDiv,"STATISTICS"),this._statsSubsetDiv=document.createElement("div"),this._statsSubsetDiv.style.paddingTop="5px",this._statsSubsetDiv.style.paddingBottom="5px",this._statsSubsetDiv.style.overflowY="auto",this._statsDiv.appendChild(this._statsSubsetDiv),this._treeDiv=document.createElement("div"),this._treeDiv.id="DebugLayerTree",this._treeDiv.style.border=r,this._treeDiv.style.position="absolute",this._treeDiv.style.background=i,this._treeDiv.style.padding="0px 0px 0px 5px",this._treeDiv.style.display="none",this._generateheader(this._treeDiv,"MESHES TREE"),this._treeSubsetDiv=document.createElement("div"),this._treeSubsetDiv.style.paddingTop="5px",this._treeSubsetDiv.style.paddingRight="5px",this._treeSubsetDiv.style.overflowY="auto",this._treeSubsetDiv.style.maxHeight="300px",this._treeDiv.appendChild(this._treeSubsetDiv),this._needToRefreshMeshesTree=!0,this._logDiv=document.createElement("div"),this._logDiv.style.border=r,this._logDiv.id="DebugLayerLogs",this._logDiv.style.position="absolute",this._logDiv.style.background=i,this._logDiv.style.padding="0px 0px 0px 5px",this._logDiv.style.display="none",this._generateheader(this._logDiv,"LOGS"),this._logSubsetDiv=document.createElement("div"),this._logSubsetDiv.style.height="127px",this._logSubsetDiv.style.paddingTop="5px",this._logSubsetDiv.style.overflowY="auto",this._logSubsetDiv.style.fontSize="12px",this._logSubsetDiv.style.fontFamily="consolas",this._logSubsetDiv.innerHTML=n.Tools.LogCache,this._logDiv.appendChild(this._logSubsetDiv),n.Tools.OnNewCacheEntry=function(n){t._logSubsetDiv.innerHTML=n+t._logSubsetDiv.innerHTML},this._optionsDiv=document.createElement("div"),this._optionsDiv.id="DebugLayerOptions",this._optionsDiv.style.border=r,this._optionsDiv.style.position="absolute",this._optionsDiv.style.background=i,this._optionsDiv.style.padding="0px 0px 0px 5px",this._optionsDiv.style.overflowY="auto",this._generateheader(this._optionsDiv,"OPTIONS"),this._optionsSubsetDiv=document.createElement("div"),this._optionsSubsetDiv.style.paddingTop="5px",this._optionsSubsetDiv.style.paddingBottom="5px",this._optionsSubsetDiv.style.overflowY="auto",this._optionsSubsetDiv.style.maxHeight="200px",this._optionsDiv.appendChild(this._optionsSubsetDiv),this._generateTexBox(this._optionsSubsetDiv,"<b>Windows:<\/b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Statistics",this._displayStatistics,function(n){t._displayStatistics=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Logs",this._displayLogs,function(n){t._displayLogs=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Meshes tree",this._displayTree,function(n){t._displayTree=n.checked;t._needToRefreshMeshesTree=!0}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>General:<\/b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Bounding boxes",this._scene.forceShowBoundingBoxes,function(n){t._scene.forceShowBoundingBoxes=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Clickable labels",this._labelsEnabled,function(n){t._labelsEnabled=n.checked;t._labelsEnabled||t._clearLabels()}),this._generateCheckBox(this._optionsSubsetDiv,"Generate user marks (F12)",n.Tools.PerformanceLogLevel===n.Tools.PerformanceUserMarkLogLevel,function(t){n.Tools.PerformanceLogLevel=t.checked?n.Tools.PerformanceUserMarkLogLevel:n.Tools.PerformanceNoneLogLevel}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Rendering mode:<\/b>",this.accentColor),this._generateRadio(this._optionsSubsetDiv,"Solid","renderMode",!this._scene.forceWireframe&&!this._scene.forcePointsCloud,function(n){n.checked&&(t._scene.forceWireframe=!1,t._scene.forcePointsCloud=!1)}),this._generateRadio(this._optionsSubsetDiv,"Wireframe","renderMode",this._scene.forceWireframe,function(n){n.checked&&(t._scene.forceWireframe=!0,t._scene.forcePointsCloud=!1)}),this._generateRadio(this._optionsSubsetDiv,"Point","renderMode",this._scene.forcePointsCloud,function(n){n.checked&&(t._scene.forceWireframe=!1,t._scene.forcePointsCloud=!0)}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Texture channels:<\/b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Diffuse",n.StandardMaterial.DiffuseTextureEnabled,function(t){n.StandardMaterial.DiffuseTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Ambient",n.StandardMaterial.AmbientTextureEnabled,function(t){n.StandardMaterial.AmbientTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Specular",n.StandardMaterial.SpecularTextureEnabled,function(t){n.StandardMaterial.SpecularTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Emissive",n.StandardMaterial.EmissiveTextureEnabled,function(t){n.StandardMaterial.EmissiveTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Bump",n.StandardMaterial.BumpTextureEnabled,function(t){n.StandardMaterial.BumpTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Opacity",n.StandardMaterial.OpacityTextureEnabled,function(t){n.StandardMaterial.OpacityTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Reflection",n.StandardMaterial.ReflectionTextureEnabled,function(t){n.StandardMaterial.ReflectionTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Fresnel",n.StandardMaterial.FresnelEnabled,function(t){n.StandardMaterial.FresnelEnabled=t.checked}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Options:<\/b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Animations",this._scene.animationsEnabled,function(n){t._scene.animationsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Collisions",this._scene.collisionsEnabled,function(n){t._scene.collisionsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Fog",this._scene.fogEnabled,function(n){t._scene.fogEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Lens flares",this._scene.lensFlaresEnabled,function(n){t._scene.lensFlaresEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Lights",this._scene.lightsEnabled,function(n){t._scene.lightsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Particles",this._scene.particlesEnabled,function(n){t._scene.particlesEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Post-processes",this._scene.postProcessesEnabled,function(n){t._scene.postProcessesEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Procedural textures",this._scene.proceduralTexturesEnabled,function(n){t._scene.proceduralTexturesEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Render targets",this._scene.renderTargetsEnabled,function(n){t._scene.renderTargetsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Shadows",this._scene.shadowsEnabled,function(n){t._scene.shadowsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Skeletons",this._scene.skeletonsEnabled,function(n){t._scene.skeletonsEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Sprites",this._scene.spritesEnabled,function(n){t._scene.spritesEnabled=n.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Textures",this._scene.texturesEnabled,function(n){t._scene.texturesEnabled=n.checked}),n.Engine.audioEngine.canUseWebAudio&&(this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Audio:<\/b>",this.accentColor),this._generateRadio(this._optionsSubsetDiv,"Headphones","panningModel",this._scene.headphone,function(n){n.checked&&(t._scene.headphone=!0)}),this._generateRadio(this._optionsSubsetDiv,"Normal Speakers","panningModel",!this._scene.headphone,function(n){n.checked&&(t._scene.headphone=!1)}),this._generateCheckBox(this._optionsSubsetDiv,"Disable audio",!this._scene.audioEnabled,function(n){t._scene.audioEnabled=!n.checked})),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Tools:<\/b>",this.accentColor),this._generateButton(this._optionsSubsetDiv,"Dump rendertargets",function(){t._scene.dumpNextRenderTargets=!0}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._globalDiv.appendChild(this._statsDiv),this._globalDiv.appendChild(this._logDiv),this._globalDiv.appendChild(this._optionsDiv),this._globalDiv.appendChild(this._treeDiv))},t.prototype._displayStats=function(){var t=this._scene,i=t.getEngine(),r=i.getGlInfo();this._statsSubsetDiv.innerHTML="Babylon.js v"+n.Engine.Version+" - <b>"+n.Tools.Format(i.getFps(),0)+" fps<\/b><br><br><div style='column-count: 2;-moz-column-count:2;-webkit-column-count:2'><b>Count<\/b><br>Total meshes: "+t.meshes.length+"<br>Total vertices: "+t.getTotalVertices()+"<br>Total materials: "+t.materials.length+"<br>Total textures: "+t.textures.length+"<br>Active meshes: "+t.getActiveMeshes().length+"<br>Active indices: "+t.getActiveIndices()+"<br>Active bones: "+t.getActiveBones()+"<br>Active particles: "+t.getActiveParticles()+"<br><b>Draw calls: "+i.drawCalls+"<\/b><br><br><b>Duration<\/b><br>Meshes selection:<\/i> "+n.Tools.Format(t.getEvaluateActiveMeshesDuration())+" ms<br>Render Targets: "+n.Tools.Format(t.getRenderTargetsDuration())+" ms<br>Particles: "+n.Tools.Format(t.getParticlesDuration())+" ms<br>Sprites: "+n.Tools.Format(t.getSpritesDuration())+" ms<br><br>Render: <b>"+n.Tools.Format(t.getRenderDuration())+" ms<\/b><br>Frame: "+n.Tools.Format(t.getLastFrameDuration())+" ms<br>Potential FPS: "+n.Tools.Format(1e3/t.getLastFrameDuration(),0)+"<br><br><\/div><div style='column-count: 2;-moz-column-count:2;-webkit-column-count:2'><b>Extensions<\/b><br>Std derivatives: "+(i.getCaps().standardDerivatives?"Yes":"No")+"<br>Compressed textures: "+(i.getCaps().s3tc?"Yes":"No")+"<br>Hardware instances: "+(i.getCaps().instancedArrays?"Yes":"No")+"<br>Texture float: "+(i.getCaps().textureFloat?"Yes":"No")+"<br>32bits indices: "+(i.getCaps().uintIndices?"Yes":"No")+"<br><b>Caps.<\/b><br>Max textures units: "+i.getCaps().maxTexturesImageUnits+"<br>Max textures size: "+i.getCaps().maxTextureSize+"<br>Max anisotropy: "+i.getCaps().maxAnisotropy+"<br><br><br><\/div><br><b>Info<\/b><br>"+r.version+"<br>"+r.renderer+"<br>";this.customStatsFunction&&(this._statsSubsetDiv.innerHTML+=this._statsSubsetDiv.innerHTML)},t}();n.DebugLayer=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o,s,h){void 0===o&&(o=!0);void 0===s&&(s=!1);void 0===h&&(h=n.Texture.TRILINEAR_SAMPLINGMODE);t.call(this,null,e,!o,s);this.format=f;this._texture=e.getEngine().createRawTexture(i,r,u,f,o,s,h);this.wrapU=n.Texture.CLAMP_ADDRESSMODE;this.wrapV=n.Texture.CLAMP_ADDRESSMODE}return __extends(i,t),i.prototype.update=function(n){this.getScene().getEngine().updateRawTexture(this._texture,n,this.format,this._invertY)},i.CreateLuminanceTexture=function(t,r,u,f,e,o,s){return void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===s&&(s=n.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,u,n.Engine.TEXTUREFORMAT_LUMINANCE,f,e,o,s)},i.CreateLuminanceAlphaTexture=function(t,r,u,f,e,o,s){return void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===s&&(s=n.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,u,n.Engine.TEXTUREFORMAT_LUMINANCE_ALPHA,f,e,o,s)},i.CreateAlphaTexture=function(t,r,u,f,e,o,s){return void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===s&&(s=n.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,u,n.Engine.TEXTUREFORMAT_ALPHA,f,e,o,s)},i.CreateRGBTexture=function(t,r,u,f,e,o,s){return void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===s&&(s=n.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,u,n.Engine.TEXTUREFORMAT_RGB,f,e,o,s)},i.CreateRGBATexture=function(t,r,u,f,e,o,s){return void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===s&&(s=n.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,u,n.Engine.TEXTUREFORMAT_RGBA,f,e,o,s)},i}(n.Texture);n.RawTexture=t}(BABYLON||(BABYLON={}));!function(n){var r=function(n){function t(t,i){n.call(this,t.x,t.y);this.index=i}return __extends(t,n),t}(n.Vector2),t=function(){function t(){this.elements=[]}return t.prototype.add=function(n){var i=this,t=[];return n.forEach(function(n){if(0===t.length||!n.equalsWithEpsilon(t[0])){var u=new r(n,i.elements.length);t.push(u);i.elements.push(u)}}),t},t.prototype.computeBounds=function(){var t=new n.Vector2(this.elements[0].x,this.elements[0].y),i=new n.Vector2(this.elements[0].x,this.elements[0].y);return this.elements.forEach(function(n){n.x<t.x?t.x=n.x:n.x>i.x&&(i.x=n.x);n.y<t.y?t.y=n.y:n.y>i.y&&(i.y=n.y)}),{min:t,max:i,width:i.x-t.x,height:i.y-t.y}},t}(),u=function(){function t(){}return t.Rectangle=function(t,i,r,u){return[new n.Vector2(t,i),new n.Vector2(r,i),new n.Vector2(r,u),new n.Vector2(t,u)]},t.Circle=function(t,i,r,u){void 0===i&&(i=0);void 0===r&&(r=0);void 0===u&&(u=32);for(var e=[],f=0,s=2*Math.PI/u,o=0;u>o;o++)e.push(new n.Vector2(i+Math.cos(f)*t,r+Math.sin(f)*t)),f-=s;return e},t.Parse=function(t){for(var r=t.split(/[^-+eE\.\d]+/).map(parseFloat).filter(function(n){return!isNaN(n)}),u=[],i=0;i<(2147483646&r.length);i+=2)u.push(new n.Vector2(r[i],r[i+1]));return u},t.StartingAt=function(t,i){return n.Path2.StartingAt(t,i)},t}(),i;n.Polygon=u;i=function(){function i(i,r,u){if(this._points=new t,this._outlinepoints=new t,this._holes=[],!("poly2tri"in window))throw"PolygonMeshBuilder cannot be used because poly2tri is not referenced";this._name=i;this._scene=u;var f;f=r instanceof n.Path2?r.getPoints():r;this._swctx=new poly2tri.SweepContext(this._points.add(f));this._outlinepoints.add(f)}return i.prototype.addHole=function(n){this._swctx.addHole(this._points.add(n));var i=new t;return i.add(n),this._holes.push(i),this},i.prototype.build=function(t,i){var v=this,u,h,l,a,c;void 0===t&&(t=!1);var e=new n.Mesh(this._name,this._scene),o=[],f=[],s=[],r=this._points.computeBounds();return this._points.elements.forEach(function(n){o.push(0,1,0);f.push(n.x,0,n.y);s.push((n.x-r.min.x)/r.width,(n.y-r.min.y)/r.height)}),u=[],(this._swctx.triangulate(),this._swctx.getTriangles().forEach(function(n){n.getPoints().forEach(function(n){u.push(n.index)})}),i>0)&&(h=f.length/3,this._points.elements.forEach(function(n){o.push(0,-1,0);f.push(n.x,-i,n.y);s.push(1-(n.x-r.min.x)/r.width,1-(n.y-r.min.y)/r.height)}),c=0,this._swctx.getTriangles().forEach(function(n){n.getPoints().forEach(function(n){switch(c){case 0:l=n;break;case 1:a=n;break;case 2:u.push(n.index+h);u.push(a.index+h);u.push(l.index+h);c=-1}c++})}),this.addSide(f,o,s,u,r,this._outlinepoints,i,!1),this._holes.forEach(function(n){v.addSide(f,o,s,u,r,n,i,!0)})),e.setVerticesData(n.VertexBuffer.PositionKind,f,t),e.setVerticesData(n.VertexBuffer.NormalKind,o,t),e.setVerticesData(n.VertexBuffer.UVKind,s,t),e.setIndices(u),e},i.prototype.addSide=function(t,i,r,u,f,e,o,s){for(var l,a,c=t.length/3,v=0,y=0;y<e.elements.length;y++){a=e.elements[y];l=y+1>e.elements.length-1?e.elements[0]:e.elements[y+1];t.push(a.x,0,a.y);t.push(a.x,-o,a.y);t.push(l.x,0,l.y);t.push(l.x,-o,l.y);var w=new n.Vector3(a.x,0,a.y),b=new n.Vector3(l.x,0,l.y),p=b.subtract(w),k=new n.Vector3(0,1,0),h=n.Vector3.Cross(p,k);h=h.normalize();r.push(v/f.width,0);r.push(v/f.width,1);v+=p.length();r.push(v/f.width,0);r.push(v/f.width,1);s?(i.push(h.x,h.y,h.z),i.push(h.x,h.y,h.z),i.push(h.x,h.y,h.z),i.push(h.x,h.y,h.z),u.push(c),u.push(c+2),u.push(c+1),u.push(c+1),u.push(c+2),u.push(c+3)):(i.push(-h.x,-h.y,-h.z),i.push(-h.x,-h.y,-h.z),i.push(-h.x,-h.y,-h.z),i.push(-h.x,-h.y,-h.z),u.push(c),u.push(c+1),u.push(c+2),u.push(c+1),u.push(c+3),u.push(c+2));c+=4}},i}();n.PolygonMeshBuilder=i}(BABYLON||(BABYLON={}));!function(n){var s=function(){function n(n,t,i){this.quality=n;this.distance=t;this.optimizeMesh=i}return n}(),e,o,i,r,t,u,f;n.SimplificationSettings=s;e=function(){function t(){this.running=!1;this._simplificationArray=[]}return t.prototype.addTask=function(n){this._simplificationArray.push(n)},t.prototype.executeNext=function(){var n=this._simplificationArray.pop();n?(this.running=!0,this.runSimplification(n)):this.running=!1},t.prototype.runSimplification=function(t){var i=this,r,u;t.parallelProcessing?t.settings.forEach(function(n){var r=i.getSimplifier(t);r.simplify(n,function(r){t.mesh.addLODLevel(n.distance,r);r.isVisible=!0;n.quality===t.settings[t.settings.length-1].quality&&t.successCallback&&t.successCallback();i.executeNext()})}):(r=this.getSimplifier(t),u=function(n,i){r.simplify(n,function(r){t.mesh.addLODLevel(n.distance,r);r.isVisible=!0;i()})},n.AsyncLoop.Run(t.settings.length,function(n){u(t.settings[n.index],function(){n.executeNext()})},function(){t.successCallback&&t.successCallback();i.executeNext()}))},t.prototype.getSimplifier=function(n){switch(n.simplificationType){case o.QUADRATIC:default:return new f(n.mesh)}},t}();n.SimplificationQueue=e,function(n){n[n.QUADRATIC=0]="QUADRATIC"}(n.SimplificationType||(n.SimplificationType={}));o=n.SimplificationType;i=function(){function n(n){this.vertices=n;this.error=new Array(4);this.deleted=!1;this.isDirty=!1;this.deletePending=!1;this.borderFactor=0}return n}();n.DecimationTriangle=i;r=function(){function n(n,i){this.position=n;this.id=i;this.isBorder=!0;this.q=new t;this.triangleCount=0;this.triangleStart=0;this.originalOffsets=[]}return n.prototype.updatePosition=function(n){this.position.copyFrom(n)},n}();n.DecimationVertex=r;t=function(){function n(n){this.data=new Array(10);for(var t=0;10>t;++t)this.data[t]=n&&n[t]?n[t]:0}return n.prototype.det=function(n,t,i,r,u,f,e,o,s){return this.data[n]*this.data[u]*this.data[s]+this.data[i]*this.data[r]*this.data[o]+this.data[t]*this.data[f]*this.data[e]-this.data[i]*this.data[u]*this.data[e]-this.data[n]*this.data[f]*this.data[o]-this.data[t]*this.data[r]*this.data[s]},n.prototype.addInPlace=function(n){for(var t=0;10>t;++t)this.data[t]+=n.data[t]},n.prototype.addArrayInPlace=function(n){for(var t=0;10>t;++t)this.data[t]+=n[t]},n.prototype.add=function(t){for(var r=new n,i=0;10>i;++i)r.data[i]=this.data[i]+t.data[i];return r},n.FromData=function(t,i,r,u){return new n(n.DataFromNumbers(t,i,r,u))},n.DataFromNumbers=function(n,t,i,r){return[n*n,n*t,n*i,n*r,t*t,t*i,t*r,i*i,i*r,r*r]},n}();n.QuadraticMatrix=t;u=function(){function n(n,t){this.vertexId=n;this.triangleId=t}return n}();n.Reference=u;f=function(){function f(t){this._mesh=t;this.initialized=!1;this.syncIterations=5e3;this.aggressiveness=7;this.decimationIterations=100;this.boundingBoxEpsilon=n.Engine.Epsilon}return f.prototype.simplify=function(t,i){var r=this;this.initDecimatedMesh();n.AsyncLoop.Run(this._mesh.subMeshes.length,function(n){r.initWithMesh(n.index,function(){r.runDecimation(t,n.index,function(){n.executeNext()})},t.optimizeMesh)},function(){setTimeout(function(){i(r._reconstructedMesh)},0)})},f.prototype.isTriangleOnBoundingBox=function(n){var i=this,t=0;return n.vertices.forEach(function(n){var f=0,r=n.position,u=i._mesh.getBoundingInfo().boundingBox;(u.maximum.x-r.x<i.boundingBoxEpsilon||r.x-u.minimum.x>i.boundingBoxEpsilon)&&++f;(u.maximum.y==r.y||r.y==u.minimum.y)&&++f;(u.maximum.z==r.z||r.z==u.minimum.z)&&++f;f>1&&++t}),t>1&&console.log(n,t),t>1},f.prototype.runDecimation=function(t,i,r){var u=this,e=~~(this.triangles.length*t.quality),f=0,o=this.triangles.length,s=function(t,i){setTimeout(function(){var r,s,h;for(t%5==0&&u.updateMesh(0===t),r=0;r<u.triangles.length;++r)u.triangles[r].isDirty=!1;s=1e-9*Math.pow(t+3,u.aggressiveness);h=function(t){var b=~~((u.triangles.length/2+t)%u.triangles.length),r=u.triangles[b],e,a,v,y,h,c;if(r&&!(r.error[3]>s||r.deleted||r.isDirty))for(e=0;3>e;++e)if(r.error[e]<s){var p=[],w=[],i=r.vertices[e],o=r.vertices[(e+1)%3];if(i.isBorder!==o.isBorder)continue;var l=n.Vector3.Zero(),k=n.Vector3.Zero(),d=n.Vector2.Zero(),g=new n.Color4(0,0,0,1);if(u.calculateError(i,o,l,k,d,g),a=[],u.isFlipped(i,o,l,p,r.borderFactor,a))continue;if(u.isFlipped(o,i,l,w,r.borderFactor,a))continue;if(p.indexOf(!0)<0||w.indexOf(!0)<0)continue;if(v=[],a.forEach(function(n){-1===v.indexOf(n)&&(n.deletePending=!0,v.push(n))}),v.length%2!=0)continue;if(i.q=o.q.add(i.q),i.updatePosition(l),y=u.references.length,f=u.updateTriangles(i,i,p,f),f=u.updateTriangles(i,o,w,f),h=u.references.length-y,h<=i.triangleCount){if(h)for(c=0;h>c;c++)u.references[i.triangleStart+c]=u.references[y+c]}else i.triangleStart=y;i.triangleCount=h;break}};n.AsyncLoop.SyncAsyncForLoop(u.triangles.length,u.syncIterations,h,i,function(){return e>=o-f})},0)};n.AsyncLoop.Run(this.decimationIterations,function(n){e>=o-f?n.breakLoop():s(n.index,function(){n.executeNext()})},function(){setTimeout(function(){u.reconstructMesh(i);r()},0)})},f.prototype.initWithMesh=function(t,u,f){var e=this;this.vertices=[];this.triangles=[];var c=this._mesh.getVerticesData(n.VertexBuffer.PositionKind),h=this._mesh.getIndices(),o=this._mesh.subMeshes[t],l=function(n){if(f)for(var t=0;t<e.vertices.length;++t)if(e.vertices[t].position.equals(n))return e.vertices[t];return null},s=[],a=function(t){var u=t+o.verticesStart,f=n.Vector3.FromArray(c,3*u),i=l(f)||new r(f,e.vertices.length);i.originalOffsets.push(u);i.id==e.vertices.length&&e.vertices.push(i);s.push(i.id)},v=o.verticesCount;n.AsyncLoop.SyncAsyncForLoop(v,this.syncIterations/4>>0,a,function(){var t=function(n){var u=o.indexStart/3+n,t=3*u,f=h[t+0],c=h[t+1],l=h[t+2],a=e.vertices[s[f-o.verticesStart]],v=e.vertices[s[c-o.verticesStart]],y=e.vertices[s[l-o.verticesStart]],r=new i([a,v,y]);r.originalOffset=t;e.triangles.push(r)};n.AsyncLoop.SyncAsyncForLoop(o.indexCount/3,e.syncIterations,t,function(){e.init(u)})})},f.prototype.init=function(i){var r=this,u=function(i){var u=r.triangles[i],f;for(u.normal=n.Vector3.Cross(u.vertices[1].position.subtract(u.vertices[0].position),u.vertices[2].position.subtract(u.vertices[0].position)).normalize(),f=0;3>f;f++)u.vertices[f].q.addArrayInPlace(t.DataFromNumbers(u.normal.x,u.normal.y,u.normal.z,-n.Vector3.Dot(u.normal,u.vertices[0].position)))};n.AsyncLoop.SyncAsyncForLoop(this.triangles.length,this.syncIterations,u,function(){var t=function(n){for(var t=r.triangles[n],i=0;3>i;++i)t.error[i]=r.calculateError(t.vertices[i],t.vertices[(i+1)%3]);t.error[3]=Math.min(t.error[0],t.error[1],t.error[2])};n.AsyncLoop.SyncAsyncForLoop(r.triangles.length,r.syncIterations,t,function(){r.initialized=!0;i()})})},f.prototype.reconstructMesh=function(t){for(var o=[],s,u,p,b,r,k,i=0;i<this.vertices.length;++i)this.vertices[i].triangleCount=0;for(i=0;i<this.triangles.length;++i)if(!this.triangles[i].deleted){for(r=this.triangles[i],s=0;3>s;++s)r.vertices[s].triangleCount=1;o.push(r)}var h=this._reconstructedMesh.getVerticesData(n.VertexBuffer.PositionKind)||[],c=this._reconstructedMesh.getVerticesData(n.VertexBuffer.NormalKind)||[],l=this._reconstructedMesh.getVerticesData(n.VertexBuffer.UVKind)||[],f=this._reconstructedMesh.getVerticesData(n.VertexBuffer.ColorKind)||[],v=this._mesh.getVerticesData(n.VertexBuffer.NormalKind),a=this._mesh.getVerticesData(n.VertexBuffer.UVKind),e=this._mesh.getVerticesData(n.VertexBuffer.ColorKind),y=0;for(i=0;i<this.vertices.length;++i)u=this.vertices[i],u.id=y,u.triangleCount&&u.originalOffsets.forEach(function(n){h.push(u.position.x);h.push(u.position.y);h.push(u.position.z);c.push(v[3*n]);c.push(v[3*n+1]);c.push(v[3*n+2]);a&&a.length?(l.push(a[2*n]),l.push(a[2*n+1])):e&&e.length&&(f.push(e[4*n]),f.push(e[4*n+1]),f.push(e[4*n+2]),f.push(e[4*n+3]));++y});var d=this._reconstructedMesh.getTotalIndices(),w=this._reconstructedMesh.getTotalVertices(),g=this._reconstructedMesh.subMeshes;for(this._reconstructedMesh.subMeshes=[],p=this._reconstructedMesh.getIndices(),b=this._mesh.getIndices(),i=0;i<o.length;++i)r=o[i],[0,1,2].forEach(function(n){var i=b[r.originalOffset+n],t=r.vertices[n].originalOffsets.indexOf(i);0>t&&(t=0);p.push(r.vertices[n].id+t+w)});this._reconstructedMesh.setIndices(p);this._reconstructedMesh.setVerticesData(n.VertexBuffer.PositionKind,h);this._reconstructedMesh.setVerticesData(n.VertexBuffer.NormalKind,c);l.length>0&&this._reconstructedMesh.setVerticesData(n.VertexBuffer.UVKind,l);f.length>0&&this._reconstructedMesh.setVerticesData(n.VertexBuffer.ColorKind,f);k=this._mesh.subMeshes[t];t>0&&(this._reconstructedMesh.subMeshes=[],g.forEach(function(t){new n.SubMesh(t.materialIndex,t.verticesStart,t.verticesCount,t.indexStart,t.indexCount,t.getMesh())}),new n.SubMesh(k.materialIndex,w,y,d,3*o.length,this._reconstructedMesh))},f.prototype.initDecimatedMesh=function(){this._reconstructedMesh=new n.Mesh(this._mesh.name+"Decimated",this._mesh.getScene());this._reconstructedMesh.material=this._mesh.material;this._reconstructedMesh.parent=this._mesh.parent;this._reconstructedMesh.isVisible=!1},f.prototype.isFlipped=function(t,i,r,u,f,e){for(var s,h,c,y,o=0;o<t.triangleCount;++o)if(s=this.triangles[this.references[t.triangleStart+o].triangleId],!s.deleted){var l=this.references[t.triangleStart+o].vertexId,a=s.vertices[(l+1)%3],v=s.vertices[(l+2)%3];if(a!==i&&v!==i){if((h=a.position.subtract(r),h=h.normalize(),c=v.position.subtract(r),c=c.normalize(),Math.abs(n.Vector3.Dot(h,c))>.999)||(y=n.Vector3.Cross(h,c).normalize(),u[o]=!1,n.Vector3.Dot(y,s.normal)<.2))return!0}else u[o]=!0,e.push(s)}return!1},f.prototype.updateTriangles=function(n,t,i,r){for(var e,u,o=r,f=0;f<t.triangleCount;++f)e=this.references[t.triangleStart+f],u=this.triangles[e.triangleId],u.deleted||(i[f]&&u.deletePending?(u.deleted=!0,o++):(u.vertices[e.vertexId]=n,u.isDirty=!0,u.error[0]=this.calculateError(u.vertices[0],u.vertices[1])+u.borderFactor/2,u.error[1]=this.calculateError(u.vertices[1],u.vertices[2])+u.borderFactor/2,u.error[2]=this.calculateError(u.vertices[2],u.vertices[0])+u.borderFactor/2,u.error[3]=Math.min(u.error[0],u.error[1],u.error[2]),this.references.push(e)));return o},f.prototype.identifyBorder=function(){for(var s,u,i,e,r=0;r<this.vertices.length;++r){for(var t=[],f=[],o=this.vertices[r],n=0;n<o.triangleCount;++n)for(s=this.triangles[this.references[o.triangleStart+n].triangleId],u=0;3>u;u++){for(i=0,e=s.vertices[u];i<t.length&&f[i]!==e.id;)++i;i===t.length?(t.push(1),f.push(e.id)):t[i]++}for(n=0;n<t.length;++n)this.vertices[f[n]].isBorder=1===t[n]?!0:!1}},f.prototype.updateMesh=function(n){var t,e,f,i,r,o,s;if(void 0===n&&(n=!1),!n){for(e=[],t=0;t<this.triangles.length;++t)this.triangles[t].deleted||e.push(this.triangles[t]);this.triangles=e}for(t=0;t<this.vertices.length;++t)this.vertices[t].triangleCount=0,this.vertices[t].triangleStart=0;for(t=0;t<this.triangles.length;++t)for(f=this.triangles[t],i=0;3>i;++i)r=f.vertices[i],r.triangleCount++;for(o=0,t=0;t<this.vertices.length;++t)this.vertices[t].triangleStart=o,o+=this.vertices[t].triangleCount,this.vertices[t].triangleCount=0;for(s=new Array(3*this.triangles.length),t=0;t<this.triangles.length;++t)for(f=this.triangles[t],i=0;3>i;++i)r=f.vertices[i],s[r.triangleStart+r.triangleCount]=new u(i,t),r.triangleCount++;this.references=s;n&&this.identifyBorder()},f.prototype.vertexError=function(n,t){var i=t.x,r=t.y,u=t.z;return n.data[0]*i*i+2*n.data[1]*i*r+2*n.data[2]*i*u+2*n.data[3]*i+n.data[4]*r*r+2*n.data[5]*r*u+2*n.data[6]*r+n.data[7]*u*u+2*n.data[8]*u+n.data[9]},f.prototype.calculateError=function(t,i,r){var u=t.q.add(i.q),c=t.isBorder&&i.isBorder,f=0,e=u.det(0,1,2,1,4,5,2,5,7);if(0===e||c){var o=t.position.add(i.position).divide(new n.Vector3(2,2,2)),s=this.vertexError(u,t.position),h=this.vertexError(u,i.position),l=this.vertexError(u,o);f=Math.min(s,h,l);f===s?r&&r.copyFrom(t.position):f===h?r&&r.copyFrom(i.position):r&&r.copyFrom(o)}else r||(r=n.Vector3.Zero()),r.x=-1/e*u.det(1,2,3,4,5,6,5,7,8),r.y=1/e*u.det(0,2,3,1,5,6,2,7,8),r.z=-1/e*u.det(0,1,3,1,4,6,2,5,8),f=this.vertexError(u,r);return f},f}();n.QuadraticErrorSimplification=f}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){this.SMOOTHING=.75;this.FFT_SIZE=512;this.BARGRAPHAMPLITUDE=256;this.DEBUGCANVASPOS={x:20,y:20};this.DEBUGCANVASSIZE={width:320,height:200};this._scene=t;this._audioEngine=n.Engine.audioEngine;this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser=this._audioEngine.audioContext.createAnalyser(),this._webAudioAnalyser.minDecibels=-140,this._webAudioAnalyser.maxDecibels=0,this._byteFreqs=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._byteTime=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._floatFreqs=new Float32Array(this._webAudioAnalyser.frequencyBinCount))}return t.prototype.getFrequencyBinCount=function(){return this._audioEngine.canUseWebAudio?this._webAudioAnalyser.frequencyBinCount:0},t.prototype.getByteFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteFrequencyData(this._byteFreqs)),this._byteFreqs},t.prototype.getByteTimeDomainData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteTimeDomainData(this._byteTime)),this._byteTime},t.prototype.getFloatFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getFloatFrequencyData(this._floatFreqs)),this._floatFreqs},t.prototype.drawDebugCanvas=function(){var u=this,t,n;if(this._audioEngine.canUseWebAudio&&(this._debugCanvas||(this._debugCanvas=document.createElement("canvas"),this._debugCanvas.width=this.DEBUGCANVASSIZE.width,this._debugCanvas.height=this.DEBUGCANVASSIZE.height,this._debugCanvas.style.position="absolute",this._debugCanvas.style.top=this.DEBUGCANVASPOS.y+"px",this._debugCanvas.style.left=this.DEBUGCANVASPOS.x+"px",this._debugCanvasContext=this._debugCanvas.getContext("2d"),document.body.appendChild(this._debugCanvas),this._registerFunc=function(){u.drawDebugCanvas()},this._scene.registerBeforeRender(this._registerFunc)),this._registerFunc))for(t=this.getByteFrequencyData(),this._debugCanvasContext.fillStyle="rgb(0, 0, 0)",this._debugCanvasContext.fillRect(0,0,this.DEBUGCANVASSIZE.width,this.DEBUGCANVASSIZE.height),n=0;n<this.getFrequencyBinCount();n++){var f=t[n],e=f/this.BARGRAPHAMPLITUDE,i=this.DEBUGCANVASSIZE.height*e,o=this.DEBUGCANVASSIZE.height-i-1,r=this.DEBUGCANVASSIZE.width/this.getFrequencyBinCount(),s=n/this.getFrequencyBinCount()*360;this._debugCanvasContext.fillStyle="hsl("+s+", 100%, 50%)";this._debugCanvasContext.fillRect(n*r,o,r,i)}},t.prototype.stopDebugCanvas=function(){this._debugCanvas&&(this._scene.unregisterBeforeRender(this._registerFunc),this._registerFunc=null,document.body.removeChild(this._debugCanvas),this._debugCanvas=null,this._debugCanvasContext=null)},t.prototype.connectAudioNodes=function(n,t){this._audioEngine.canUseWebAudio&&(n.connect(this._webAudioAnalyser),this._webAudioAnalyser.connect(t))},t.prototype.dispose=function(){this._audioEngine.canUseWebAudio&&this._webAudioAnalyser.disconnect()},t}();n.Analyser=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t,i){var r=this,u,f;void 0===i&&(i=n.Engine.TEXTURETYPE_FLOAT);this._viewMatrix=n.Matrix.Zero();this._projectionMatrix=n.Matrix.Zero();this._transformMatrix=n.Matrix.Zero();this._worldViewProjection=n.Matrix.Zero();this._scene=t;u=t.getEngine();this._depthMap=new n.RenderTargetTexture("depthMap",{width:u.getRenderWidth(),height:u.getRenderHeight()},this._scene,!1,!0,i);this._depthMap.wrapU=n.Texture.CLAMP_ADDRESSMODE;this._depthMap.wrapV=n.Texture.CLAMP_ADDRESSMODE;this._depthMap.refreshRate=1;this._depthMap.renderParticles=!1;this._depthMap.renderList=null;this._depthMap.onClear=function(t){t.clear(new n.Color4(1,1,1,1),!0,!0)};f=function(t){var i=t.getRenderingMesh(),e=r._scene,o=e.getEngine(),u,s,f,h;o.setState(t.getMaterial().backFaceCulling);u=i._getInstancesRenderList(t._id);u.mustReturn||(s=null!==o.getCaps().instancedArrays&&null!==u.visibleInstances[t._id],r.isReady(t,s)&&(o.enableEffect(r._effect),i._bind(t,r._effect,n.Material.TriangleFillMode),f=t.getMaterial(),(r._effect.setMatrix("viewProjection",e.getTransformMatrix()),r._effect.setFloat("far",e.activeCamera.maxZ),f&&f.needAlphaTesting())&&(h=f.getAlphaTestTexture(),r._effect.setTexture("diffuseSampler",h),r._effect.setMatrix("diffuseMatrix",h.getTextureMatrix())),i.useBones&&i.computeBonesUsingShaders&&r._effect.setMatrices("mBones",i.skeleton.getTransformMatrices()),i._processRendering(t,r._effect,n.Material.TriangleFillMode,u,s,function(n,t){return r._effect.setMatrix("world",t)})))};this._depthMap.customRenderFunction=function(n,t){for(var i=0;i<n.length;i++)f(n.data[i]);for(i=0;i<t.length;i++)f(t.data[i])}}return t.prototype.isReady=function(t,i){var u=[],r=[n.VertexBuffer.PositionKind],f=t.getMesh(),o=(f.getScene(),t.getMaterial()),e;return o&&o.needAlphaTesting()&&(u.push("#define ALPHATEST"),f.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(r.push(n.VertexBuffer.UVKind),u.push("#define UV1")),f.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(r.push(n.VertexBuffer.UV2Kind),u.push("#define UV2"))),f.useBones&&f.computeBonesUsingShaders&&(r.push(n.VertexBuffer.MatricesIndicesKind),r.push(n.VertexBuffer.MatricesWeightsKind),u.push("#define BONES"),u.push("#define BonesPerMesh "+(f.skeleton.bones.length+1))),i&&(u.push("#define INSTANCES"),r.push("world0"),r.push("world1"),r.push("world2"),r.push("world3")),e=u.join("\n"),this._cachedDefines!==e&&(this._cachedDefines=e,this._effect=this._scene.getEngine().createEffect("depth",r,["world","mBones","viewProjection","diffuseMatrix","far"],["diffuseSampler"],e)),this._effect.isReady()},t.prototype.getDepthMap=function(){return this._depthMap},t.prototype.dispose=function(){this._depthMap.dispose()},t}();n.DepthRenderer=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f){var e=this,o,s;t.call(this,r.getEngine(),i);this.SSAOOriginalSceneColorEffect="SSAOOriginalSceneColorEffect";this.SSAORenderEffect="SSAORenderEffect";this.SSAOBlurHRenderEffect="SSAOBlurHRenderEffect";this.SSAOBlurVRenderEffect="SSAOBlurVRenderEffect";this.SSAOCombineRenderEffect="SSAOCombineRenderEffect";this.totalStrength=1;this.radius=.0002;this.area=.0075;this.fallOff=.0002;this._firstUpdate=!0;this._scene=r;this._createRandomTexture();this._depthTexture=r.enableDepthRenderer().getDepthMap();o=u.ssaoRatio||u;s=u.combineRatio||u;this._originalColorPostProcess=new n.PassPostProcess("SSAOOriginalSceneColor",s,null,n.Texture.BILINEAR_SAMPLINGMODE,r.getEngine(),!1);this._createSSAOPostProcess(o);this._blurHPostProcess=new n.BlurPostProcess("SSAOBlurH",new n.Vector2(2,0),2,o,null,n.Texture.BILINEAR_SAMPLINGMODE,r.getEngine(),!1);this._blurVPostProcess=new n.BlurPostProcess("SSAOBlurV",new n.Vector2(0,2),2,o,null,n.Texture.BILINEAR_SAMPLINGMODE,r.getEngine(),!1);this._createSSAOCombinePostProcess(s);this.addEffect(new n.PostProcessRenderEffect(r.getEngine(),this.SSAOOriginalSceneColorEffect,function(){return e._originalColorPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(r.getEngine(),this.SSAORenderEffect,function(){return e._ssaoPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(r.getEngine(),this.SSAOBlurHRenderEffect,function(){return e._blurHPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(r.getEngine(),this.SSAOBlurVRenderEffect,function(){return e._blurVPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(r.getEngine(),this.SSAOCombineRenderEffect,function(){return e._ssaoCombinePostProcess},!0));r.postProcessRenderPipelineManager.addPipeline(this);f&&r.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(i,f)}return __extends(i,t),i.prototype.getBlurHPostProcess=function(){return this._blurHPostProcess},i.prototype.getBlurVPostProcess=function(){return this._blurVPostProcess},i.prototype.dispose=function(n){void 0===n&&(n=!1);this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras);this._originalColorPostProcess=void 0;this._ssaoPostProcess=void 0;this._blurHPostProcess=void 0;this._blurVPostProcess=void 0;this._ssaoCombinePostProcess=void 0;this._randomTexture.dispose();n&&this._scene.disableDepthRenderer()},i.prototype._createSSAOPostProcess=function(t){var i=this,r=[.5381,.1856,-.4319,.1379,.2486,.443,.3371,.5679,-.0057,-.6999,-.0451,-.0019,.0689,-.1598,-.8547,.056,.0069,-.1843,-.0146,.1402,.0762,.01,-.1924,-.0344,-.3577,-.5301,-.4358,-.3169,.1063,.0158,.0103,-.5869,.0046,-.0897,-.494,.3287,.7119,-.0154,-.0918,-.0533,.0596,-.5411,.0352,-.0631,.546,-.4776,.2847,-.0271],u=1/16;this._ssaoPostProcess=new n.PostProcess("ssao","ssao",["sampleSphere","samplesFactor","randTextureTiles","totalStrength","radius","area","fallOff"],["randomSampler"],t,null,n.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1);this._ssaoPostProcess.onApply=function(n){i._firstUpdate&&(n.setArray3("sampleSphere",r),n.setFloat("samplesFactor",u),n.setFloat("randTextureTiles",4/t),i._firstUpdate=!1);n.setFloat("totalStrength",i.totalStrength);n.setFloat("radius",i.radius);n.setFloat("area",i.area);n.setFloat("fallOff",i.fallOff);n.setTexture("textureSampler",i._depthTexture);n.setTexture("randomSampler",i._randomTexture)}},i.prototype._createSSAOCombinePostProcess=function(t){var i=this;this._ssaoCombinePostProcess=new n.PostProcess("ssaoCombine","ssaoCombine",[],["originalColor"],t,null,n.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1);this._ssaoCombinePostProcess.onApply=function(n){n.setTextureFromPostProcess("originalColor",i._originalColorPostProcess)}},i.prototype._createRandomTexture=function(){var r=512,i,t;this._randomTexture=new n.DynamicTexture("SSAORandomTexture",r,this._scene,!1,n.Texture.BILINEAR_SAMPLINGMODE);this._randomTexture.wrapU=n.Texture.WRAP_ADDRESSMODE;this._randomTexture.wrapV=n.Texture.WRAP_ADDRESSMODE;for(var e=this._randomTexture.getContext(),u=function(n,t){return Math.random()*(t-n)+n},f=0;r>f;f++)for(i=0;r>i;i++)t=n.Vector3.Zero(),t.x=Math.floor(255*u(0,1)),t.y=Math.floor(255*u(0,1)),t.z=Math.floor(255*u(0,1)),e.fillStyle="rgb("+t.x+", "+t.y+", "+t.z+")",e.fillRect(f,i,1,1);this._randomTexture.update(!1)},i}(n.PostProcessRenderPipeline);n.SSAORenderingPipeline=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(r,u,f,e,o,s,h,c,l){var a=this;void 0===o&&(o=100);void 0===s&&(s=n.Texture.BILINEAR_SAMPLINGMODE);t.call(this,r,"volumetricLightScattering",["decay","exposure","weight","meshPositionOnScreen","density"],["lightScatteringSampler"],u.postProcessRatio||u,f,s,h,c,"#define NUM_SAMPLES "+o);this._screenCoordinates=n.Vector2.Zero();this.useCustomMeshPosition=!1;this.invert=!0;this.useDiffuseColor=!1;this.excludedMeshes=[];this.exposure=.3;this.decay=.96815;this.weight=.58767;this.density=.926;l=null===f?l:f.getScene();this._viewPort=new n.Viewport(0,0,1,1).toGlobal(l.getEngine());this.mesh=null!==e?e:i.CreateDefaultMesh("VolumetricLightScatteringMesh",l);this._createPass(l,u.passRatio||u);this.onApply=function(n){a._updateMeshScreenCoordinates(l);n.setTexture("lightScatteringSampler",a._volumetricLightScatteringRTT);n.setFloat("exposure",a.exposure);n.setFloat("decay",a.decay);n.setFloat("weight",a.weight);n.setFloat("density",a.density);n.setVector2("meshPositionOnScreen",a._screenCoordinates)}}return __extends(i,t),i.prototype.isReady=function(t,i){var f=t.getMesh(),r=[],u=[n.VertexBuffer.PositionKind],e=t.getMaterial(),s=!1,o;return f===this.mesh&&(this.useDiffuseColor?r.push("#define DIFFUSE_COLOR_RENDER"):e&&r.push(void 0!==e.diffuseTexture?"#define BASIC_RENDER":"#define DIFFUSE_COLOR_RENDER"),r.push("#define NEED_UV"),s=!0),e&&(e.needAlphaTesting()&&r.push("#define ALPHATEST"),void 0!==e.opacityTexture&&(r.push("#define OPACITY"),e.opacityTexture.getAlphaFromRGB&&r.push("#define OPACITYRGB"),s||r.push("#define NEED_UV")),f.isVerticesDataPresent(n.VertexBuffer.UVKind)&&(u.push(n.VertexBuffer.UVKind),r.push("#define UV1")),f.isVerticesDataPresent(n.VertexBuffer.UV2Kind)&&(u.push(n.VertexBuffer.UV2Kind),r.push("#define UV2"))),f.useBones&&f.computeBonesUsingShaders&&(u.push(n.VertexBuffer.MatricesIndicesKind),u.push(n.VertexBuffer.MatricesWeightsKind),r.push("#define BONES"),r.push("#define BonesPerMesh "+(f.skeleton.bones.length+1))),i&&(r.push("#define INSTANCES"),u.push("world0"),u.push("world1"),u.push("world2"),u.push("world3")),o=r.join("\n"),this._cachedDefines!==o&&(this._cachedDefines=o,this._volumetricLightScatteringPass=f.getScene().getEngine().createEffect({vertexElement:"depth",fragmentElement:"volumetricLightScatteringPass"},u,["world","mBones","viewProjection","diffuseMatrix","opacityLevel","color"],["diffuseSampler","opacitySampler"],o)),this._volumetricLightScatteringPass.isReady()},i.prototype.setCustomMeshPosition=function(n){this._customMeshPosition=n},i.prototype.getCustomMeshPosition=function(){return this._customMeshPosition},i.prototype.dispose=function(n){var i=n.getScene().customRenderTargets.indexOf(this._volumetricLightScatteringRTT);-1!==i&&n.getScene().customRenderTargets.splice(i,1);this._volumetricLightScatteringRTT.dispose();t.prototype.dispose.call(this,n)},i.prototype.getPass=function(){return this._volumetricLightScatteringRTT},i.prototype._meshExcluded=function(n){return this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(n)?!0:!1},i.prototype._createPass=function(t,i){var r=this,f=t.getEngine(),e,u,o;this._volumetricLightScatteringRTT=new n.RenderTargetTexture("volumetricLightScatteringMap",{width:f.getRenderWidth()*i,height:f.getRenderHeight()*i},t,!1,!0,n.Engine.TEXTURETYPE_UNSIGNED_INT);this._volumetricLightScatteringRTT.wrapU=n.Texture.CLAMP_ADDRESSMODE;this._volumetricLightScatteringRTT.wrapV=n.Texture.CLAMP_ADDRESSMODE;this._volumetricLightScatteringRTT.renderList=null;this._volumetricLightScatteringRTT.renderParticles=!1;t.customRenderTargets.push(this._volumetricLightScatteringRTT);u=function(t){var i=t.getRenderingMesh(),s,e,o,h,u,f;r._meshExcluded(i)||(s=i.getScene(),e=s.getEngine(),e.setState(t.getMaterial().backFaceCulling),o=i._getInstancesRenderList(t._id),o.mustReturn||(h=null!==e.getCaps().instancedArrays&&null!==o.visibleInstances[t._id],r.isReady(t,h)&&(e.enableEffect(r._volumetricLightScatteringPass),i._bind(t,r._volumetricLightScatteringPass,n.Material.TriangleFillMode),u=t.getMaterial(),(r._volumetricLightScatteringPass.setMatrix("viewProjection",s.getTransformMatrix()),u&&(i===r.mesh||u.needAlphaTesting()||void 0!==u.opacityTexture))&&(f=u.getAlphaTestTexture(),(r.useDiffuseColor||void 0===f)&&i===r.mesh&&r._volumetricLightScatteringPass.setColor3("color",u.diffuseColor),(u.needAlphaTesting()||i===r.mesh&&f&&!r.useDiffuseColor)&&(r._volumetricLightScatteringPass.setTexture("diffuseSampler",f),f&&r._volumetricLightScatteringPass.setMatrix("diffuseMatrix",f.getTextureMatrix())),void 0!==u.opacityTexture&&(r._volumetricLightScatteringPass.setTexture("opacitySampler",u.opacityTexture),r._volumetricLightScatteringPass.setFloat("opacityLevel",u.opacityTexture.level))),i.useBones&&i.computeBonesUsingShaders&&r._volumetricLightScatteringPass.setMatrices("mBones",i.skeleton.getTransformMatrices()),i._processRendering(t,r._volumetricLightScatteringPass,n.Material.TriangleFillMode,o,h,function(n,t){return r._volumetricLightScatteringPass.setMatrix("world",t)}))))};o=new n.Color4(0,0,0,1);this._volumetricLightScatteringRTT.onBeforeRender=function(){e=t.clearColor;t.clearColor=o};this._volumetricLightScatteringRTT.onAfterRender=function(){t.clearColor=e};this._volumetricLightScatteringRTT.customRenderFunction=function(i,r,f){for(var s=t.getEngine(),o,h,e=0;e<i.length;e++)u(i.data[e]);for(s.setAlphaTesting(!0),e=0;e<r.length;e++)u(r.data[e]);if(s.setAlphaTesting(!1),f.length){for(e=0;e<f.length;e++)o=f.data[e],o._alphaIndex=o.getMesh().alphaIndex,o._distanceToCamera=o.getBoundingInfo().boundingSphere.centerWorld.subtract(t.activeCamera.position).length();for(h=f.data.slice(0,f.length),h.sort(function(n,t){return n._alphaIndex>t._alphaIndex?1:n._alphaIndex<t._alphaIndex?-1:n._distanceToCamera<t._distanceToCamera?1:n._distanceToCamera>t._distanceToCamera?-1:0}),s.setAlphaMode(n.Engine.ALPHA_COMBINE),e=0;e<h.length;e++)u(h[e]);s.setAlphaMode(n.Engine.ALPHA_DISABLE)}}},i.prototype._updateMeshScreenCoordinates=function(t){var r=t.getTransformMatrix(),i=n.Vector3.Project(this.useCustomMeshPosition?this._customMeshPosition:this.mesh.position,n.Matrix.Identity(),r,this._viewPort);this._screenCoordinates.x=i.x/this._viewPort.width;this._screenCoordinates.y=i.y/this._viewPort.height;this.invert&&(this._screenCoordinates.y=1-this._screenCoordinates.y)},i.CreateDefaultMesh=function(t,i){var r=n.Mesh.CreatePlane(t,1,i);return r.billboardMode=n.AbstractMesh.BILLBOARDMODE_ALL,r.material=new n.StandardMaterial(t+"Material",i),r},i}(n.PostProcess);n.VolumetricLightScatteringPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e){var o=this;void 0===f&&(f=1);t.call(this,u.getEngine(),i);this.LensChromaticAberrationEffect="LensChromaticAberrationEffect";this.HighlightsEnhancingEffect="HighlightsEnhancingEffect";this.LensDepthOfFieldEffect="LensDepthOfFieldEffect";this._scene=u;this._depthTexture=u.enableDepthRenderer().getDepthMap();r.grain_texture?this._grainTexture=r.grain_texture:this._createGrainTexture();this._edgeBlur=r.edge_blur?r.edge_blur:0;this._grainAmount=r.grain_amount?r.grain_amount:0;this._chromaticAberration=r.chromatic_aberration?r.chromatic_aberration:0;this._distortion=r.distortion?r.distortion:0;this._highlightsGain=void 0!==r.dof_gain?r.dof_gain:-1;this._highlightsThreshold=r.dof_threshold?r.dof_threshold:1;this._dofDistance=void 0!==r.dof_focus_distance?r.dof_focus_distance:-1;this._dofAperture=r.dof_aperture?r.dof_aperture:1;this._dofDarken=r.dof_darken?r.dof_darken:0;this._dofPentagon=void 0!==r.dof_pentagon?r.dof_pentagon:!0;this._blurNoise=void 0!==r.blur_noise?r.blur_noise:!0;this._createChromaticAberrationPostProcess(f);this._createHighlightsPostProcess(f);this._createDepthOfFieldPostProcess(f/4);this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),this.LensChromaticAberrationEffect,function(){return o._chromaticAberrationPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),this.HighlightsEnhancingEffect,function(){return o._highlightsPostProcess},!0));this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),this.LensDepthOfFieldEffect,function(){return o._depthOfFieldPostProcess},!0));-1==this._highlightsGain&&this._disableEffect(this.HighlightsEnhancingEffect,null);u.postProcessRenderPipelineManager.addPipeline(this);e&&u.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(i,e)}return __extends(i,t),i.prototype.setEdgeBlur=function(n){this._edgeBlur=n},i.prototype.disableEdgeBlur=function(){this._edgeBlur=0},i.prototype.setGrainAmount=function(n){this._grainAmount=n},i.prototype.disableGrain=function(){this._grainAmount=0},i.prototype.setChromaticAberration=function(n){this._chromaticAberration=n},i.prototype.disableChromaticAberration=function(){this._chromaticAberration=0},i.prototype.setEdgeDistortion=function(n){this._distortion=n},i.prototype.disableEdgeDistortion=function(){this._distortion=0},i.prototype.setFocusDistance=function(n){this._dofDistance=n},i.prototype.disableDepthOfField=function(){this._dofDistance=-1},i.prototype.setAperture=function(n){this._dofAperture=n},i.prototype.setDarkenOutOfFocus=function(n){this._dofDarken=n},i.prototype.enablePentagonBokeh=function(){this._dofPentagon=!0},i.prototype.disablePentagonBokeh=function(){this._dofPentagon=!1},i.prototype.enableNoiseBlur=function(){this._blurNoise=!0},i.prototype.disableNoiseBlur=function(){this._blurNoise=!1},i.prototype.setHighlightsGain=function(n){this._highlightsGain=n},i.prototype.setHighlightsThreshold=function(n){-1==this._highlightsGain&&(this._highlightsGain=1);this._highlightsThreshold=n},i.prototype.disableHighlights=function(){this._highlightsGain=-1},i.prototype.dispose=function(n){void 0===n&&(n=!1);this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras);this._chromaticAberrationPostProcess=void 0;this._highlightsPostProcess=void 0;this._depthOfFieldPostProcess=void 0;this._grainTexture.dispose();n&&this._scene.disableDepthRenderer()},i.prototype._createChromaticAberrationPostProcess=function(t){var i=this;this._chromaticAberrationPostProcess=new n.PostProcess("LensChromaticAberration","chromaticAberration",["chromatic_aberration","screen_width","screen_height"],[],t,null,n.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1);this._chromaticAberrationPostProcess.onApply=function(n){n.setFloat("chromatic_aberration",i._chromaticAberration);n.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width);n.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height)}},i.prototype._createHighlightsPostProcess=function(t){var i=this;this._highlightsPostProcess=new n.PostProcess("LensHighlights","lensHighlights",["pentagon","gain","threshold","screen_width","screen_height"],[],t,null,n.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1);this._highlightsPostProcess.onApply=function(n){n.setFloat("gain",i._highlightsGain);n.setFloat("threshold",i._highlightsThreshold);n.setBool("pentagon",i._dofPentagon);n.setTextureFromPostProcess("textureSampler",i._chromaticAberrationPostProcess);n.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width);n.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height)}},i.prototype._createDepthOfFieldPostProcess=function(t){var i=this;this._depthOfFieldPostProcess=new n.PostProcess("LensDepthOfField","depthOfField",["grain_amount","blur_noise","screen_width","screen_height","distortion","dof_enabled","screen_distance","aperture","darken","edge_blur","highlights","near","far"],["depthSampler","grainSampler","highlightsSampler"],t,null,n.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1);this._depthOfFieldPostProcess.onApply=function(n){n.setTexture("depthSampler",i._depthTexture);n.setTexture("grainSampler",i._grainTexture);n.setTextureFromPostProcess("textureSampler",i._highlightsPostProcess);n.setTextureFromPostProcess("highlightsSampler",i._depthOfFieldPostProcess);n.setFloat("grain_amount",i._grainAmount);n.setBool("blur_noise",i._blurNoise);n.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width);n.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height);n.setFloat("distortion",i._distortion);n.setBool("dof_enabled",-1!=i._dofDistance);n.setFloat("screen_distance",1/(.1-1/i._dofDistance));n.setFloat("aperture",i._dofAperture);n.setFloat("darken",i._dofDarken);n.setFloat("edge_blur",i._edgeBlur);n.setBool("highlights",-1!=i._highlightsGain);n.setFloat("near",i._scene.activeCamera.minZ);n.setFloat("far",i._scene.activeCamera.maxZ)}},i.prototype._createGrainTexture=function(){var r=512,i;this._grainTexture=new n.DynamicTexture("LensNoiseTexture",r,this._scene,!1,n.Texture.BILINEAR_SAMPLINGMODE);this._grainTexture.wrapU=n.Texture.WRAP_ADDRESSMODE;this._grainTexture.wrapV=n.Texture.WRAP_ADDRESSMODE;for(var t,f=this._grainTexture.getContext(),e=function(n,t){return Math.random()*(t-n)+n},u=0;r>u;u++)for(i=0;r>i;i++)t=Math.floor(255*e(.42,.58)),f.fillStyle="rgb("+t+", "+t+", "+t+")",f.fillRect(u,i,1,1);this._grainTexture.update(!1)},i}(n.PostProcessRenderPipeline);n.LensRenderingPipeline=t}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(i,r,u,f,e,o,s){var h=this;t.call(this,i,"colorCorrection",null,["colorTable"],u,f,e,o,s);this._colorTableTexture=new n.Texture(r,f.getScene(),!0,!1,n.Texture.TRILINEAR_SAMPLINGMODE);this._colorTableTexture.anisotropicFilteringLevel=1;this._colorTableTexture.wrapU=n.Texture.CLAMP_ADDRESSMODE;this._colorTableTexture.wrapV=n.Texture.CLAMP_ADDRESSMODE;this.onApply=function(n){n.setTexture("colorTable",h._colorTableTexture)}}return __extends(i,t),i}(n.PostProcess);n.ColorCorrectionPostProcess=t}(BABYLON||(BABYLON={}));!function(n){var e=function(t){function i(i,r,u,f){t.call(this,i,r,f);this.setCameraRigMode(n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:u})}return __extends(i,t),i}(n.FreeCamera),t,i,r,u,f;n.AnaglyphFreeCamera=e;t=function(t){function i(i,r,u,f,e,o,s){t.call(this,i,r,u,f,e,s);this.setCameraRigMode(n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:o})}return __extends(i,t),i}(n.ArcRotateCamera);n.AnaglyphArcRotateCamera=t;i=function(t){function i(i,r,u,f){t.call(this,i,r,f);this.setCameraRigMode(n.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:u})}return __extends(i,t),i}(n.GamepadCamera);n.AnaglyphGamepadCamera=i;r=function(t){function i(i,r,u,f,e){t.call(this,i,r,e);this.setCameraRigMode(f?n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:u})}return __extends(i,t),i}(n.FreeCamera);n.StereoscopicFreeCamera=r;u=function(t){function i(i,r,u,f,e,o,s,h){t.call(this,i,r,u,f,e,h);this.setCameraRigMode(s?n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:o})}return __extends(i,t),i}(n.ArcRotateCamera);n.StereoscopicArcRotateCamera=u;f=function(t){function i(i,r,u,f,e){t.call(this,i,r,e);this.setCameraRigMode(f?n.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:n.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:u})}return __extends(i,t),i}(n.GamepadCamera);n.StereoscopicGamepadCamera=f}(BABYLON||(BABYLON={}));!function(n){var t=function(t){function i(r,u,f,e,o){var s=this,c,h;for(void 0===e&&(e=null),t.call(this,u.getEngine(),r),this.gaussCoeff=.3,this.gaussMean=1,this.gaussStandDev=.8,this.exposure=1,this.minimumLuminance=1,this.maximumLuminance=1e20,this.luminanceIncreaserate=.5,this.luminanceDecreaseRate=.5,this.brightThreshold=.8,this._needUpdate=!0,this._scene=u,this._createBrightPassPostProcess(u,f),this._createDownSampleX4PostProcess(u,f),this._createGaussianBlurPostProcess(u,f),this._createTextureAdderPostProcess(u,f),this._createLuminanceGeneratorPostProcess(u),this._createHDRPostProcess(u,f),this._originalPostProcess=null===e?new n.PassPostProcess("hdr",f,null,n.Texture.BILINEAR_SAMPLINGMODE,u.getEngine(),!1):e,this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRPassPostProcess",function(){return s._originalPostProcess},!0)),this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRBrightPass",function(){return s._brightPassPostProcess},!0)),this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRDownSampleX4",function(){return s._downSampleX4PostProcess},!0)),this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRGaussianBlurH",function(){return s._guassianBlurHPostProcess},!0)),this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRGaussianBlurV",function(){return s._guassianBlurVPostProcess},!0)),this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRTextureAdder",function(){return s._textureAdderPostProcess},!0)),c=function(t){s.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDRDownSampler"+t,function(){return s._downSamplePostProcesses[t]},!0))},h=i.LUM_STEPS-1;h>=0;h--)c(h);this.addEffect(new n.PostProcessRenderEffect(u.getEngine(),"HDR",function(){return s._hdrPostProcess},!0));u.postProcessRenderPipelineManager.addPipeline(this);null!==o&&u.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(r,o);this.update()}return __extends(i,t),i.prototype.update=function(){this._needUpdate=!0},i.prototype.getCurrentLuminance=function(){return this._hdrCurrentLuminance},i.prototype.getOutputLuminance=function(){return this._hdrOutputLuminance},i.prototype.dispose=function(){this._originalPostProcess=void 0;this._brightPassPostProcess=void 0;this._downSampleX4PostProcess=void 0;this._guassianBlurHPostProcess=void 0;this._guassianBlurVPostProcess=void 0;this._textureAdderPostProcess=void 0;for(var n=i.LUM_STEPS-1;n>=0;n--)this._downSamplePostProcesses[n]=void 0;this._hdrPostProcess=void 0;this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras)},i.prototype._createHDRPostProcess=function(t,i){var r=this,u=0;this._hdrOutputLuminance=-1;this._hdrCurrentLuminance=1;this._hdrPostProcess=new n.PostProcess("hdr","hdr",["exposure","avgLuminance"],["otherSampler"],i,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define HDR");this._hdrPostProcess.onApply=function(i){if(r._hdrOutputLuminance<0)r._hdrOutputLuminance=r._hdrCurrentLuminance;else{var f=(u-(u+t.getEngine().getDeltaTime()))/1e3;r._hdrCurrentLuminance<r._hdrOutputLuminance+r.luminanceDecreaseRate*f?r._hdrOutputLuminance+=r.luminanceDecreaseRate*f:r._hdrCurrentLuminance>r._hdrOutputLuminance-r.luminanceIncreaserate*f?r._hdrOutputLuminance-=r.luminanceIncreaserate*f:r._hdrOutputLuminance=r._hdrCurrentLuminance}r._hdrOutputLuminance=n.Tools.Clamp(r._hdrOutputLuminance,r.minimumLuminance,r.maximumLuminance);u+=t.getEngine().getDeltaTime();i.setTextureFromPostProcess("textureSampler",r._textureAdderPostProcess);i.setTextureFromPostProcess("otherSampler",r._originalPostProcess);i.setFloat("exposure",r.exposure);i.setFloat("avgLuminance",r._hdrOutputLuminance);r._needUpdate=!1}},i.prototype._createTextureAdderPostProcess=function(t,i){var r=this;this._textureAdderPostProcess=new n.PostProcess("hdr","hdr",[],["otherSampler"],i,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define TEXTURE_ADDER");this._textureAdderPostProcess.onApply=function(n){n.setTextureFromPostProcess("otherSampler",r._originalPostProcess)}},i.prototype._createDownSampleX4PostProcess=function(t,i){var r=this,u=new Array(32);this._downSampleX4PostProcess=new n.PostProcess("hdr","hdr",["dsOffsets"],[],i/4,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define DOWN_SAMPLE_X4");this._downSampleX4PostProcess.onApply=function(n){var t,i,f;if(r._needUpdate)for(t=0,i=-2;2>i;i++)for(f=-2;2>f;f++)u[t]=(i+.5)*(1/r._downSampleX4PostProcess.width),u[t+1]=(f+.5)*(1/r._downSampleX4PostProcess.height),t+=2;n.setArray2("dsOffsets",u)}},i.prototype._createBrightPassPostProcess=function(t,i){var u=this,r=new Array(8),f=function(n){if(u._needUpdate){var t=1/u._brightPassPostProcess.width,i=1/u._brightPassPostProcess.height;r[0]=-.5*t;r[1]=.5*i;r[2]=.5*t;r[3]=.5*i;r[4]=-.5*t;r[5]=-.5*i;r[6]=.5*t;r[7]=-.5*i}n.setArray2("dsOffsets",r);n.setFloat("brightThreshold",u.brightThreshold)};this._brightPassPostProcess=new n.PostProcess("hdr","hdr",["dsOffsets","brightThreshold"],[],i,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define BRIGHT_PASS");this._brightPassPostProcess.onApply=f},i.prototype._createLuminanceGeneratorPostProcess=function(t){var l,r=this,e=i.LUM_STEPS,f=new Array(8),o=new Array(18),u,h,c;this._downSamplePostProcesses=new Array(e);var a=function(n,t){var i=1/n,r=1/t;f[0]=-.5*i;f[1]=.5*r;f[2]=.5*i;f[3]=.5*r;f[4]=-.5*i;f[5]=-.5*r;f[6]=.5*i;f[7]=-.5*r},v=function(n,t){for(var u,i=0,r=-1;2>r;r++)for(u=-1;2>u;u++)o[i]=r/n,o[i+1]=u/t,i+=2},y=function(n){r._needUpdate&&a(r._textureAdderPostProcess.width,r._textureAdderPostProcess.height);n.setTextureFromPostProcess("textureSampler",r._textureAdderPostProcess);n.setArray2("lumOffsets",f)},p=function(n){var t=n;return function(n){a(r._downSamplePostProcesses[t].width,r._downSamplePostProcesses[t].height);v(r._downSamplePostProcesses[t].width,r._downSamplePostProcesses[t].height);l=.5/r._downSamplePostProcesses[t].width;n.setTextureFromPostProcess("textureSampler",r._downSamplePostProcesses[t+1]);n.setFloat("halfDestPixelSize",l);n.setArray2("dsOffsets",o)}},w=function(){var i=t.getEngine().readPixels(0,0,1,1),u=new n.Vector4(1/16581375,1/65025,1/255,1);r._hdrCurrentLuminance=(i[0]*u.x+i[1]*u.y+i[2]*u.z+i[3]*u.w)/100},s={width:Math.pow(3,e-1),height:Math.pow(3,e-1)};for(this._downSamplePostProcesses[e-1]=new n.PostProcess("hdr","hdr",["lumOffsets"],[],s,null,n.Texture.NEAREST_SAMPLINGMODE,t.getEngine(),!1,"#define LUMINANCE_GENERATOR",n.Engine.TEXTURETYPE_FLOAT),this._downSamplePostProcesses[e-1].onApply=y,u=e-2;u>=0;u--)h=Math.pow(3,u),s={width:h,height:h},c="#define DOWN_SAMPLE\n",0===u&&(c+="#define FINAL_DOWN_SAMPLE\n"),this._downSamplePostProcesses[u]=new n.PostProcess("hdr","hdr",["dsOffsets","halfDestPixelSize"],[],s,null,n.Texture.NEAREST_SAMPLINGMODE,t.getEngine(),!1,c,n.Engine.TEXTURETYPE_FLOAT),this._downSamplePostProcesses[u].onApply=p(u),0===u&&(this._downSamplePostProcesses[u].onAfterRender=w)},i.prototype._createGaussianBlurPostProcess=function(t,i){var r=this,u=new Array(9),f=new Array(9),e=new Array(9),o=["blurOffsets","blurWeights"],h=function(n){for(var o,e={width:t.getEngine().getRenderWidth()*(i/4),height:t.getEngine().getRenderHeight()*(i/4)},r=0;9>r;r++)o=(r-4)*(1/(n===!0?e.height:e.width)),n?f[r]=o:u[r]=o},c=function(){for(var t=0,n=0;9>n;n++)t=(n-4)/4,e[n]=r.gaussCoeff*(1/Math.sqrt(2*Math.PI*r.gaussStandDev))*Math.exp(-((t-r.gaussMean)*(t-r.gaussMean))/(2*r.gaussStandDev*r.gaussStandDev))},s=function(n){return function(t){r._needUpdate&&(c(),h(n));t.setArray("blurOffsets",n?f:u);t.setArray("blurWeights",e)}};this._guassianBlurHPostProcess=new n.PostProcess("hdr","hdr",o,[],i/4,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define GAUSSIAN_BLUR_H");this._guassianBlurHPostProcess.onApply=s(!1);this._guassianBlurVPostProcess=new n.PostProcess("hdr","hdr",o,[],i/4,null,n.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define GAUSSIAN_BLUR_V");this._guassianBlurVPostProcess.onApply=s(!0)},i.LUM_STEPS=6,i}(n.PostProcessRenderPipeline);n.HDRRenderingPipeline=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(){this.edges=[];this.edgesConnectedCount=0}return n}(),i=function(){function i(n,t,i){void 0===t&&(t=.95);void 0===i&&(i=!1);this._linesPositions=[];this._linesNormals=[];this._linesIndices=[];this._buffers=[];this._checkVerticesInsteadOfIndices=!1;this._source=n;this._checkVerticesInsteadOfIndices=i;this._epsilon=t;this._prepareRessources();this._generateEdgesLines()}return i.prototype._prepareRessources=function(){this._lineShader||(this._lineShader=new n.ShaderMaterial("lineShader",this._source.getScene(),"line",{attributes:["position","normal"],uniforms:["worldViewProjection","color","width","aspectRatio"]}),this._lineShader.disableDepthWrite=!0,this._lineShader.backFaceCulling=!1)},i.prototype.dispose=function(){this._vb0.dispose();this._vb1.dispose();this._source.getScene().getEngine()._releaseBuffer(this._ib);this._lineShader.dispose()},i.prototype._processEdgeForAdjacencies=function(n,t,i,r,u){return n===i&&t===r||n===r&&t===i?0:n===r&&t===u||n===u&&t===r?1:n===u&&t===i||n===i&&t===u?2:-1},i.prototype._processEdgeForAdjacenciesWithVertices=function(n,t,i,r,u){return n.equalsWithEpsilon(i)&&t.equalsWithEpsilon(r)||n.equalsWithEpsilon(r)&&t.equalsWithEpsilon(i)?0:n.equalsWithEpsilon(r)&&t.equalsWithEpsilon(u)||n.equalsWithEpsilon(u)&&t.equalsWithEpsilon(r)?1:n.equalsWithEpsilon(u)&&t.equalsWithEpsilon(i)||n.equalsWithEpsilon(i)&&t.equalsWithEpsilon(u)?2:-1},i.prototype._checkEdge=function(t,i,r,u,f){var o,s,e,h;void 0===i?o=!0:(s=n.Vector3.Dot(r[t],r[i]),o=s<this._epsilon);o&&(e=this._linesPositions.length/3,h=u.subtract(f),h.normalize(),this._linesPositions.push(u.x),this._linesPositions.push(u.y),this._linesPositions.push(u.z),this._linesPositions.push(u.x),this._linesPositions.push(u.y),this._linesPositions.push(u.z),this._linesPositions.push(f.x),this._linesPositions.push(f.y),this._linesPositions.push(f.z),this._linesPositions.push(f.x),this._linesPositions.push(f.y),this._linesPositions.push(f.z),this._linesNormals.push(f.x),this._linesNormals.push(f.y),this._linesNormals.push(f.z),this._linesNormals.push(-1),this._linesNormals.push(f.x),this._linesNormals.push(f.y),this._linesNormals.push(f.z),this._linesNormals.push(1),this._linesNormals.push(u.x),this._linesNormals.push(u.y),this._linesNormals.push(u.z),this._linesNormals.push(-1),this._linesNormals.push(u.x),this._linesNormals.push(u.y),this._linesNormals.push(u.z),this._linesNormals.push(1),this._linesIndices.push(e),this._linesIndices.push(e+1),this._linesIndices.push(e+2),this._linesIndices.push(e),this._linesIndices.push(e+2),this._linesIndices.push(e+3))},i.prototype._generateEdgesLines=function(){for(var r,o=this._source.getVerticesData(n.VertexBuffer.PositionKind),u=this._source.getIndices(),h=[],a=[],b,s,f,l,e,v,i=0;i<u.length;i+=3){r=new t;var y=u[i],p=u[i+1],w=u[i+2];r.p0=new n.Vector3(o[3*y],o[3*y+1],o[3*y+2]);r.p1=new n.Vector3(o[3*p],o[3*p+1],o[3*p+2]);r.p2=new n.Vector3(o[3*w],o[3*w+1],o[3*w+2]);b=n.Vector3.Cross(r.p1.subtract(r.p0),r.p2.subtract(r.p1));b.normalize();a.push(b);h.push(r)}for(i=0;i<h.length;i++)for(r=h[i],s=i+1;s<h.length;s++){if(f=h[s],3===r.edgesConnectedCount)break;if(3!==f.edgesConnectedCount)for(var k=u[3*s],d=u[3*s+1],g=u[3*s+2],c=0;3>c;c++)if(void 0===r.edges[c]){switch(c){case 0:l=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p0,r.p1,f.p0,f.p1,f.p2):this._processEdgeForAdjacencies(u[3*i],u[3*i+1],k,d,g);break;case 1:l=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p1,r.p2,f.p0,f.p1,f.p2):this._processEdgeForAdjacencies(u[3*i+1],u[3*i+2],k,d,g);break;case 2:l=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p2,r.p0,f.p0,f.p1,f.p2):this._processEdgeForAdjacencies(u[3*i+2],u[3*i],k,d,g)}if(-1!==l&&(r.edges[c]=s,f.edges[l]=i,r.edgesConnectedCount++,f.edgesConnectedCount++,3===r.edgesConnectedCount))break}}for(i=0;i<h.length;i++)e=h[i],this._checkEdge(i,e.edges[0],a,e.p0,e.p1),this._checkEdge(i,e.edges[1],a,e.p1,e.p2),this._checkEdge(i,e.edges[2],a,e.p2,e.p0);v=this._source.getScene().getEngine();this._vb0=new n.VertexBuffer(v,this._linesPositions,n.VertexBuffer.PositionKind,!1);this._vb1=new n.VertexBuffer(v,this._linesNormals,n.VertexBuffer.NormalKind,!1,!1,4);this._buffers[n.VertexBuffer.PositionKind]=this._vb0;this._buffers[n.VertexBuffer.NormalKind]=this._vb1;this._ib=v.createIndexBuffer(this._linesIndices);this._indicesCount=this._linesIndices.length},i.prototype.render=function(){if(this._lineShader.isReady()){var t=this._source.getScene(),n=t.getEngine();this._lineShader._preBind();n.bindMultiBuffers(this._buffers,this._ib,this._lineShader.getEffect());t.resetCachedMaterial();this._lineShader.setColor4("color",this._source.edgesColor);this._lineShader.setFloat("width",this._source.edgesWidth/50);this._lineShader.setFloat("aspectRatio",n.getAspectRatio(t.activeCamera));this._lineShader.bind(this._source.getWorldMatrix());n.draw(!0,0,this._indicesCount);this._lineShader.unbind();n.setDepthWrite(!0)}},i}();n.EdgesRenderer=i}(BABYLON||(BABYLON={}));!function(n){!function(n){n[n.Hable=0]="Hable";n[n.Reinhard=1]="Reinhard";n[n.HejiDawson=2]="HejiDawson";n[n.Photographic=3]="Photographic"}(n.TonemappingOperator||(n.TonemappingOperator={}));var t=n.TonemappingOperator,i=function(i){function r(r,u,f,e,o,s,h){var a=this,l,c;void 0===o&&(o=n.Texture.BILINEAR_SAMPLINGMODE);void 0===h&&(h=n.Engine.TEXTURETYPE_UNSIGNED_INT);this._operator=u;this._exposureAdjustment=f;l=["_ExposureAdjustment"];c="#define ";u===t.Hable?c+="HABLE_TONEMAPPING":u===t.Reinhard?c+="REINHARD_TONEMAPPING":u===t.HejiDawson?c+="OPTIMIZED_HEJIDAWSON_TONEMAPPING":u===t.Photographic&&(c+="PHOTOGRAPHIC_TONEMAPPING");i.call(this,r,"tonemap",l,null,1,e,o,s,!0,c,h);this.onApply=function(n){n.setFloat("_ExposureAdjustment",a._exposureAdjustment)}}return __extends(r,i),r}(n.PostProcess);n.TonemapPostProcess=i}(BABYLON||(BABYLON={}));BABYLON.Effect.ShadersStore={anaglyphPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D leftSampler;\r\n\r\nvoid main(void)\r\n{\r\n    vec4 leftFrag = texture2D(leftSampler, vUV);\r\n    leftFrag = vec4(1.0, leftFrag.g, leftFrag.b, 1.0);\r\n\r\n\tvec4 rightFrag = texture2D(textureSampler, vUV);\r\n    rightFrag = vec4(rightFrag.r, 1.0, 1.0, 1.0);\r\n\r\n    gl_FragColor = vec4(rightFrag.rgb * leftFrag.rgb, 1.0);\r\n}",blackAndWhitePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\nvoid main(void) \r\n{\r\n\tfloat luminance = dot(texture2D(textureSampler, vUV).rgb, vec3(0.3, 0.59, 0.11));\r\n\tgl_FragColor = vec4(luminance, luminance, luminance, 1.0);\r\n}",blurPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\n// Parameters\r\nuniform vec2 screenSize;\r\nuniform vec2 direction;\r\nuniform float blurWidth;\r\n\r\nvoid main(void)\r\n{\r\n\tfloat weights[7];\r\n\tweights[0] = 0.05;\r\n\tweights[1] = 0.1;\r\n\tweights[2] = 0.2;\r\n\tweights[3] = 0.3;\r\n\tweights[4] = 0.2;\r\n\tweights[5] = 0.1;\r\n\tweights[6] = 0.05;\r\n\r\n\tvec2 texelSize = vec2(1.0 / screenSize.x, 1.0 / screenSize.y);\r\n\tvec2 texelStep = texelSize * direction * blurWidth;\r\n\tvec2 start = vUV - 3.0 * texelStep;\r\n\r\n\tvec4 baseColor = vec4(0., 0., 0., 0.);\r\n\tvec2 texelOffset = vec2(0., 0.);\r\n\r\n\tfor (int i = 0; i < 7; i++)\r\n\t{\r\n\t\tbaseColor += texture2D(textureSampler, start + texelOffset) * weights[i];\r\n\t\ttexelOffset += texelStep;\r\n\t}\r\n\r\n\tgl_FragColor = baseColor;\r\n}",brickPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vUV;\r\n\r\nuniform float numberOfBricksHeight;\r\nuniform float numberOfBricksWidth;\r\nuniform vec3 brickColor;\r\nuniform vec3 jointColor;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nfloat round(float number){\r\n\treturn sign(number)*floor(abs(number) + 0.5);\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tfloat brickW = 1.0 / numberOfBricksWidth;\r\n\tfloat brickH = 1.0 / numberOfBricksHeight;\r\n\tfloat jointWPercentage = 0.01;\r\n\tfloat jointHPercentage = 0.05;\r\n\tvec3 color = brickColor;\r\n\tfloat yi = vUV.y / brickH;\r\n\tfloat nyi = round(yi);\r\n\tfloat xi = vUV.x / brickW;\r\n\r\n\tif (mod(floor(yi), 2.0) == 0.0){\r\n\t\txi = xi - 0.5;\r\n\t}\r\n\r\n\tfloat nxi = round(xi);\r\n\tvec2 brickvUV = vec2((xi - floor(xi)) / brickH, (yi - floor(yi)) /  brickW);\r\n\r\n\tif (yi < nyi + jointHPercentage && yi > nyi - jointHPercentage){\r\n\t\tcolor = mix(jointColor, vec3(0.37, 0.25, 0.25), (yi - nyi) / jointHPercentage + 0.2);\r\n\t}\r\n\telse if (xi < nxi + jointWPercentage && xi > nxi - jointWPercentage){\r\n\t\tcolor = mix(jointColor, vec3(0.44, 0.44, 0.44), (xi - nxi) / jointWPercentage + 0.2);\r\n\t}\r\n\telse {\r\n\t\tfloat brickColorSwitch = mod(floor(yi) + floor(xi), 3.0);\r\n\r\n\t\tif (brickColorSwitch == 0.0)\r\n\t\t\tcolor = mix(color, vec3(0.33, 0.33, 0.33), 0.3);\r\n\t\telse if (brickColorSwitch == 2.0)\r\n\t\t\tcolor = mix(color, vec3(0.11, 0.11, 0.11), 0.3);\r\n\t}\r\n\r\n\tgl_FragColor = vec4(color, 1.0);\r\n}",chromaticAberrationPixelShader:"// BABYLON.JS Chromatic Aberration GLSL Shader\r\n// Author: Olivier Guyot\r\n// Separates very slightly R, G and B colors on the edges of the screen\r\n// Inspired by Francois Tarlier & Martins Upitis\r\n\r\n#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// samplers\r\nuniform sampler2D textureSampler;\t// original color\r\n\r\n// uniforms\r\nuniform float chromatic_aberration;\r\nuniform float screen_width;\r\nuniform float screen_height;\r\n\r\n// varyings\r\nvarying vec2 vUV;\r\n\r\nvoid main(void)\r\n{\r\n\tvec2 centered_screen_pos = vec2(vUV.x - 0.5, vUV.y - 0.5);\r\n\tfloat radius2 = centered_screen_pos.x*centered_screen_pos.x\r\n\t\t+ centered_screen_pos.y*centered_screen_pos.y;\r\n\tfloat radius = sqrt(radius2);\r\n\r\n\tvec4 original = texture2D(textureSampler, vUV);\r\n\r\n\tif (chromatic_aberration > 0.0) {\r\n\t\t//index of refraction of each color channel, causing chromatic dispersion\r\n\t\tvec3 ref_indices = vec3(-0.3, 0.0, 0.3);\r\n\t\tfloat ref_shiftX = chromatic_aberration * radius * 17.0 / screen_width;\r\n\t\tfloat ref_shiftY = chromatic_aberration * radius * 17.0 / screen_height;\r\n\r\n\t\t// shifts for red, green & blue\r\n\t\tvec2 ref_coords_r = vec2(vUV.x + ref_indices.r*ref_shiftX, vUV.y + ref_indices.r*ref_shiftY*0.5);\r\n\t\tvec2 ref_coords_g = vec2(vUV.x + ref_indices.g*ref_shiftX, vUV.y + ref_indices.g*ref_shiftY*0.5);\r\n\t\tvec2 ref_coords_b = vec2(vUV.x + ref_indices.b*ref_shiftX, vUV.y + ref_indices.b*ref_shiftY*0.5);\r\n\r\n\t\toriginal.r = texture2D(textureSampler, ref_coords_r).r;\r\n\t\toriginal.g = texture2D(textureSampler, ref_coords_g).g;\r\n\t\toriginal.b = texture2D(textureSampler, ref_coords_b).b;\r\n\t}\r\n\r\n\tgl_FragColor = original;\r\n}",cloudPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vUV;\r\n\r\nuniform vec4 skyColor;\r\nuniform vec4 cloudColor;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nvoid main() {\r\n\r\n\tvec2 p = vUV * 12.0;\r\n\tvec4 c = mix(skyColor, cloudColor, fbm(p));\r\n\tgl_FragColor = c;\r\n\r\n}\r\n\r\n",colorPixelShader:"precision highp float;\r\n\r\nuniform vec4 color;\r\n\r\nvoid main(void) {\r\n\tgl_FragColor = color;\r\n}",colorVertexShader:"precision highp float;\r\n\r\n// Attributes\r\nattribute vec3 position;\r\n\r\n// Uniforms\r\nuniform mat4 worldViewProjection;\r\n\r\nvoid main(void) {\r\n\tgl_Position = worldViewProjection * vec4(position, 1.0);\r\n}",colorCorrectionPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// samplers\r\nuniform sampler2D textureSampler;\t// screen render\r\nuniform sampler2D colorTable;\t\t// color table with modified colors\r\n\r\n// varyings\r\nvarying vec2 vUV;\r\n\r\n// constants\r\nconst float SLICE_COUNT = 16.0;\t\t// how many slices in the color cube; 1 slice = 1 pixel\r\n// it means the image is 256x16 pixels\r\n\r\nvec4 sampleAs3DTexture(sampler2D texture, vec3 uv, float width) {\r\n\tfloat sliceSize = 1.0 / width;              // space of 1 slice\r\n\tfloat slicePixelSize = sliceSize / width;           // space of 1 pixel\r\n\tfloat sliceInnerSize = slicePixelSize * (width - 1.0);  // space of width pixels\r\n\tfloat zSlice0 = min(floor(uv.z * width), width - 1.0);\r\n\tfloat zSlice1 = min(zSlice0 + 1.0, width - 1.0);\r\n\tfloat xOffset = slicePixelSize * 0.5 + uv.x * sliceInnerSize;\r\n\tfloat s0 = xOffset + (zSlice0 * sliceSize);\r\n\tfloat s1 = xOffset + (zSlice1 * sliceSize);\r\n\tvec4 slice0Color = texture2D(texture, vec2(s0, uv.y));\r\n\tvec4 slice1Color = texture2D(texture, vec2(s1, uv.y));\r\n\tfloat zOffset = mod(uv.z * width, 1.0);\r\n\tvec4 result = mix(slice0Color, slice1Color, zOffset);\r\n\treturn result;\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tvec4 screen_color = texture2D(textureSampler, vUV);\r\n\tgl_FragColor = sampleAs3DTexture(colorTable, screen_color.rgb, SLICE_COUNT);\r\n\r\n}",convolutionPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\nuniform vec2 screenSize;\r\nuniform float kernel[9];\r\n\r\nvoid main(void)\r\n{\r\n\tvec2 onePixel = vec2(1.0, 1.0) / screenSize;\r\n\tvec4 colorSum =\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(-1, -1)) * kernel[0] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(0, -1)) * kernel[1] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(1, -1)) * kernel[2] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(-1, 0)) * kernel[3] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(0, 0)) * kernel[4] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(1, 0)) * kernel[5] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(-1, 1)) * kernel[6] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(0, 1)) * kernel[7] +\r\n\t\ttexture2D(textureSampler, vUV + onePixel * vec2(1, 1)) * kernel[8];\r\n\r\n\tfloat kernelWeight =\r\n\t\tkernel[0] +\r\n\t\tkernel[1] +\r\n\t\tkernel[2] +\r\n\t\tkernel[3] +\r\n\t\tkernel[4] +\r\n\t\tkernel[5] +\r\n\t\tkernel[6] +\r\n\t\tkernel[7] +\r\n\t\tkernel[8];\r\n\r\n\tif (kernelWeight <= 0.0) {\r\n\t\tkernelWeight = 1.0;\r\n\t}\r\n\r\n\tgl_FragColor = vec4((colorSum / kernelWeight).rgb, 1);\r\n}",defaultPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#define MAP_EXPLICIT\t0.\r\n#define MAP_SPHERICAL\t1.\r\n#define MAP_PLANAR\t\t2.\r\n#define MAP_CUBIC\t\t3.\r\n#define MAP_PROJECTION\t4.\r\n#define MAP_SKYBOX\t\t5.\r\n\r\n// Constants\r\nuniform vec3 vEyePosition;\r\nuniform vec3 vAmbientColor;\r\nuniform vec4 vDiffuseColor;\r\n#ifdef SPECULARTERM\r\nuniform vec4 vSpecularColor;\r\n#endif\r\nuniform vec3 vEmissiveColor;\r\n\r\n// Input\r\nvarying vec3 vPositionW;\r\n\r\n#ifdef NORMAL\r\nvarying vec3 vNormalW;\r\n#endif\r\n\r\n#ifdef VERTEXCOLOR\r\nvarying vec4 vColor;\r\n#endif\r\n\r\n// Lights\r\n#ifdef LIGHT0\r\nuniform vec4 vLightData0;\r\nuniform vec4 vLightDiffuse0;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular0;\r\n#endif\r\n#ifdef SHADOW0\r\nvarying vec4 vPositionFromLight0;\r\nuniform sampler2D shadowSampler0;\r\nuniform vec3 shadowsInfo0;\r\n#endif\r\n#ifdef SPOTLIGHT0\r\nuniform vec4 vLightDirection0;\r\n#endif\r\n#ifdef HEMILIGHT0\r\nuniform vec3 vLightGround0;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT1\r\nuniform vec4 vLightData1;\r\nuniform vec4 vLightDiffuse1;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular1;\r\n#endif\r\n#ifdef SHADOW1\r\nvarying vec4 vPositionFromLight1;\r\nuniform sampler2D shadowSampler1;\r\nuniform vec3 shadowsInfo1;\r\n#endif\r\n#ifdef SPOTLIGHT1\r\nuniform vec4 vLightDirection1;\r\n#endif\r\n#ifdef HEMILIGHT1\r\nuniform vec3 vLightGround1;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT2\r\nuniform vec4 vLightData2;\r\nuniform vec4 vLightDiffuse2;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular2;\r\n#endif\r\n#ifdef SHADOW2\r\nvarying vec4 vPositionFromLight2;\r\nuniform sampler2D shadowSampler2;\r\nuniform vec3 shadowsInfo2;\r\n#endif\r\n#ifdef SPOTLIGHT2\r\nuniform vec4 vLightDirection2;\r\n#endif\r\n#ifdef HEMILIGHT2\r\nuniform vec3 vLightGround2;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT3\r\nuniform vec4 vLightData3;\r\nuniform vec4 vLightDiffuse3;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular3;\r\n#endif\r\n#ifdef SHADOW3\r\nvarying vec4 vPositionFromLight3;\r\nuniform sampler2D shadowSampler3;\r\nuniform vec3 shadowsInfo3;\r\n#endif\r\n#ifdef SPOTLIGHT3\r\nuniform vec4 vLightDirection3;\r\n#endif\r\n#ifdef HEMILIGHT3\r\nuniform vec3 vLightGround3;\r\n#endif\r\n#endif\r\n\r\n// Samplers\r\n#ifdef DIFFUSE\r\nvarying vec2 vDiffuseUV;\r\nuniform sampler2D diffuseSampler;\r\nuniform vec2 vDiffuseInfos;\r\n#endif\r\n\r\n#ifdef AMBIENT\r\nvarying vec2 vAmbientUV;\r\nuniform sampler2D ambientSampler;\r\nuniform vec2 vAmbientInfos;\r\n#endif\r\n\r\n#ifdef OPACITY\t\r\nvarying vec2 vOpacityUV;\r\nuniform sampler2D opacitySampler;\r\nuniform vec2 vOpacityInfos;\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\nvarying vec2 vEmissiveUV;\r\nuniform vec2 vEmissiveInfos;\r\nuniform sampler2D emissiveSampler;\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\nvarying vec2 vSpecularUV;\r\nuniform vec2 vSpecularInfos;\r\nuniform sampler2D specularSampler;\r\n#endif\r\n\r\n// Fresnel\r\n#ifdef FRESNEL\r\nfloat computeFresnelTerm(vec3 viewDirection, vec3 worldNormal, float bias, float power)\r\n{\r\n\tfloat fresnelTerm = pow(bias + abs(dot(viewDirection, worldNormal)), power);\r\n\treturn clamp(fresnelTerm, 0., 1.);\r\n}\r\n#endif\r\n\r\n#ifdef DIFFUSEFRESNEL\r\nuniform vec4 diffuseLeftColor;\r\nuniform vec4 diffuseRightColor;\r\n#endif\r\n\r\n#ifdef OPACITYFRESNEL\r\nuniform vec4 opacityParts;\r\n#endif\r\n\r\n#ifdef REFLECTIONFRESNEL\r\nuniform vec4 reflectionLeftColor;\r\nuniform vec4 reflectionRightColor;\r\n#endif\r\n\r\n#ifdef EMISSIVEFRESNEL\r\nuniform vec4 emissiveLeftColor;\r\nuniform vec4 emissiveRightColor;\r\n#endif\r\n\r\n// Reflection\r\n#ifdef REFLECTION\r\nvarying vec3 vPositionUVW;\r\nuniform samplerCube reflectionCubeSampler;\r\nuniform sampler2D reflection2DSampler;\r\nuniform vec3 vReflectionInfos;\r\nuniform mat4 reflectionMatrix;\r\nuniform mat4 view;\r\n\r\n#ifdef ROUGHNESS\r\nuniform float roughness;\r\n#endif\r\n\r\nvec3 computeReflectionCoords(float mode, vec4 worldPos, vec3 worldNormal)\r\n{\r\n\tif (mode == MAP_SPHERICAL)\r\n\t{\r\n\t\tvec3 coords = vec3(view * vec4(worldNormal, 0.0));\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 1.0));\r\n\t}\r\n\telse if (mode == MAP_PLANAR)\r\n\t{\r\n\t\tvec3 viewDir = worldPos.xyz - vEyePosition;\r\n\t\tvec3 coords = normalize(reflect(viewDir, worldNormal));\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 1));\r\n\t}\r\n\telse if (mode == MAP_CUBIC)\r\n\t{\r\n\t\tvec3 viewDir = worldPos.xyz - vEyePosition;\r\n\t\tvec3 coords = reflect(viewDir, worldNormal);\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 0));\r\n\t}\r\n\telse if (mode == MAP_PROJECTION)\r\n\t{\r\n\t\treturn vec3(reflectionMatrix * (view * worldPos));\r\n\t}\r\n\telse if (mode == MAP_SKYBOX)\r\n\t{\r\n\t\treturn vPositionUVW;\r\n\t}\r\n\r\n\treturn vec3(0, 0, 0);\r\n}\r\n#endif\r\n\r\n// Shadows\r\n#ifdef SHADOWS\r\n\r\nfloat unpack(vec4 color)\r\n{\r\n\tconst vec4 bit_shift = vec4(1.0 / (255.0 * 255.0 * 255.0), 1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\r\n\treturn dot(color, bit_shift);\r\n}\r\n\r\nfloat unpackHalf(vec2 color)\r\n{\r\n\treturn color.x + (color.y / 255.0);\r\n}\r\n\r\nfloat computeShadow(vec4 vPositionFromLight, sampler2D shadowSampler, float darkness, float bias)\r\n{\r\n\tvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\r\n\tdepth = 0.5 * depth + vec3(0.5);\r\n\tvec2 uv = depth.xy;\r\n\r\n\tif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tfloat shadow = unpack(texture2D(shadowSampler, uv)) + bias;\r\n\r\n\tif (depth.z > shadow)\r\n\t{\r\n\t\treturn darkness;\r\n\t}\r\n\treturn 1.;\r\n}\r\n\r\nfloat computeShadowWithPCF(vec4 vPositionFromLight, sampler2D shadowSampler, float mapSize, float bias, float darkness)\r\n{\r\n\tvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\r\n\tdepth = 0.5 * depth + vec3(0.5);\r\n\tvec2 uv = depth.xy;\r\n\r\n\tif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tfloat visibility = 1.;\r\n\r\n\tvec2 poissonDisk[4];\r\n\tpoissonDisk[0] = vec2(-0.94201624, -0.39906216);\r\n\tpoissonDisk[1] = vec2(0.94558609, -0.76890725);\r\n\tpoissonDisk[2] = vec2(-0.094184101, -0.92938870);\r\n\tpoissonDisk[3] = vec2(0.34495938, 0.29387760);\r\n\r\n\t// Poisson Sampling\r\n\tfloat biasedDepth = depth.z - bias;\r\n\r\n\tif (unpack(texture2D(shadowSampler, uv + poissonDisk[0] / mapSize)) < biasedDepth) visibility -= 0.25;\r\n\tif (unpack(texture2D(shadowSampler, uv + poissonDisk[1] / mapSize)) < biasedDepth) visibility -= 0.25;\r\n\tif (unpack(texture2D(shadowSampler, uv + poissonDisk[2] / mapSize)) < biasedDepth) visibility -= 0.25;\r\n\tif (unpack(texture2D(shadowSampler, uv + poissonDisk[3] / mapSize)) < biasedDepth) visibility -= 0.25;\r\n\r\n\treturn  min(1.0, visibility + darkness);\r\n}\r\n\r\n// Thanks to http://devmaster.net/\r\nfloat linstep(float low, float high, float v) {\r\n\treturn clamp((v - low) / (high - low), 0.0, 1.0);\r\n}\r\n\r\nfloat ChebychevInequality(vec2 moments, float compare, float bias)\r\n{\r\n\tfloat p = smoothstep(compare - bias, compare, moments.x);\r\n\tfloat variance = max(moments.y - moments.x * moments.x, 0.02);\r\n\tfloat d = compare - moments.x;\r\n\tfloat p_max = linstep(0.2, 1.0, variance / (variance + d * d));\r\n\r\n\treturn clamp(max(p, p_max), 0.0, 1.0);\r\n}\r\n\r\nfloat computeShadowWithVSM(vec4 vPositionFromLight, sampler2D shadowSampler, float bias, float darkness)\r\n{\r\n\tvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\r\n\tdepth = 0.5 * depth + vec3(0.5);\r\n\tvec2 uv = depth.xy;\r\n\r\n\tif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0 || depth.z >= 1.0)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tvec4 texel = texture2D(shadowSampler, uv);\r\n\r\n\tvec2 moments = vec2(unpackHalf(texel.xy), unpackHalf(texel.zw));\r\n\treturn min(1.0, 1.0 - ChebychevInequality(moments, depth.z, bias) + darkness);\r\n}\r\n#endif\r\n\r\n// Bump\r\n#ifdef BUMP\r\n#extension GL_OES_standard_derivatives : enable\r\nvarying vec2 vBumpUV;\r\nuniform vec2 vBumpInfos;\r\nuniform sampler2D bumpSampler;\r\n\r\n// Thanks to http://www.thetenthplanet.de/archives/1180\r\nmat3 cotangent_frame(vec3 normal, vec3 p, vec2 uv)\r\n{\r\n\t// get edge vectors of the pixel triangle\r\n\tvec3 dp1 = dFdx(p);\r\n\tvec3 dp2 = dFdy(p);\r\n\tvec2 duv1 = dFdx(uv);\r\n\tvec2 duv2 = dFdy(uv);\r\n\r\n\t// solve the linear system\r\n\tvec3 dp2perp = cross(dp2, normal);\r\n\tvec3 dp1perp = cross(normal, dp1);\r\n\tvec3 tangent = dp2perp * duv1.x + dp1perp * duv2.x;\r\n\tvec3 binormal = dp2perp * duv1.y + dp1perp * duv2.y;\r\n\r\n\t// construct a scale-invariant frame \r\n\tfloat invmax = inversesqrt(max(dot(tangent, tangent), dot(binormal, binormal)));\r\n\treturn mat3(tangent * invmax, binormal * invmax, normal);\r\n}\r\n\r\nvec3 perturbNormal(vec3 viewDir)\r\n{\r\n\tvec3 map = texture2D(bumpSampler, vBumpUV).xyz;\r\n\tmap = map * 255. / 127. - 128. / 127.;\r\n\tmat3 TBN = cotangent_frame(vNormalW * vBumpInfos.y, -viewDir, vBumpUV);\r\n\treturn normalize(TBN * map);\r\n}\r\n#endif\r\n\r\n#ifdef CLIPPLANE\r\nvarying float fClipDistance;\r\n#endif\r\n\r\n// Fog\r\n#ifdef FOG\r\n\r\n#define FOGMODE_NONE    0.\r\n#define FOGMODE_EXP     1.\r\n#define FOGMODE_EXP2    2.\r\n#define FOGMODE_LINEAR  3.\r\n#define E 2.71828\r\n\r\nuniform vec4 vFogInfos;\r\nuniform vec3 vFogColor;\r\nvarying float fFogDistance;\r\n\r\nfloat CalcFogFactor()\r\n{\r\n\tfloat fogCoeff = 1.0;\r\n\tfloat fogStart = vFogInfos.y;\r\n\tfloat fogEnd = vFogInfos.z;\r\n\tfloat fogDensity = vFogInfos.w;\r\n\r\n\tif (FOGMODE_LINEAR == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = (fogEnd - fFogDistance) / (fogEnd - fogStart);\r\n\t}\r\n\telse if (FOGMODE_EXP == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fogDensity);\r\n\t}\r\n\telse if (FOGMODE_EXP2 == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fFogDistance * fogDensity * fogDensity);\r\n\t}\r\n\r\n\treturn clamp(fogCoeff, 0.0, 1.0);\r\n}\r\n#endif\r\n\r\n// Light Computing\r\nstruct lightingInfo\r\n{\r\n\tvec3 diffuse;\r\n#ifdef SPECULARTERM\r\n\tvec3 specular;\r\n#endif\r\n};\r\n\r\nlightingInfo computeLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec3 diffuseColor, vec3 specularColor, float range, float glossiness) {\r\n\tlightingInfo result;\r\n\r\n\tvec3 lightVectorW;\r\n\tfloat attenuation = 1.0;\r\n\tif (lightData.w == 0.)\r\n\t{\r\n\t\tvec3 direction = lightData.xyz - vPositionW;\r\n\r\n\t\tattenuation = max(0., 1.0 - length(direction) / range);\r\n\t\tlightVectorW = normalize(direction);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tlightVectorW = normalize(-lightData.xyz);\r\n\t}\r\n\r\n\t// diffuse\r\n\tfloat ndl = max(0., dot(vNormal, lightVectorW));\r\n\tresult.diffuse = ndl * diffuseColor * attenuation;\r\n\r\n#ifdef SPECULARTERM\r\n\t// Specular\r\n\tvec3 angleW = normalize(viewDirectionW + lightVectorW);\r\n\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\tspecComp = pow(specComp, max(1., glossiness));\r\n\r\n\tresult.specular = specComp * specularColor * attenuation;\r\n#endif\r\n\treturn result;\r\n}\r\n\r\nlightingInfo computeSpotLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec4 lightDirection, vec3 diffuseColor, vec3 specularColor, float range, float glossiness) {\r\n\tlightingInfo result;\r\n\r\n\tvec3 direction = lightData.xyz - vPositionW;\r\n\tvec3 lightVectorW = normalize(direction);\r\n\tfloat attenuation = max(0., 1.0 - length(direction) / range);\r\n\r\n\t// diffuse\r\n\tfloat cosAngle = max(0., dot(-lightDirection.xyz, lightVectorW));\r\n\tfloat spotAtten = 0.0;\r\n\r\n\tif (cosAngle >= lightDirection.w)\r\n\t{\r\n\t\tcosAngle = max(0., pow(cosAngle, lightData.w));\r\n\t\tspotAtten = clamp((cosAngle - lightDirection.w) / (1. - cosAngle), 0.0, 1.0);\r\n\r\n\t\t// Diffuse\r\n\t\tfloat ndl = max(0., dot(vNormal, -lightDirection.xyz));\r\n\t\tresult.diffuse = ndl * spotAtten * diffuseColor * attenuation;\r\n\r\n#ifdef SPECULARTERM\r\n\t\t// Specular\r\n\t\tvec3 angleW = normalize(viewDirectionW - lightDirection.xyz);\r\n\t\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\t\tspecComp = pow(specComp, max(1., glossiness));\r\n\r\n\t\tresult.specular = specComp * specularColor * spotAtten * attenuation;\r\n#endif\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tresult.diffuse = vec3(0.);\r\n#ifdef SPECULARTERM\r\n\tresult.specular = vec3(0.);\r\n#endif\r\n\r\n\treturn result;\r\n}\r\n\r\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec3 diffuseColor, vec3 specularColor, vec3 groundColor, float glossiness) {\r\n\tlightingInfo result;\r\n\r\n\t// Diffuse\r\n\tfloat ndl = dot(vNormal, lightData.xyz) * 0.5 + 0.5;\r\n\tresult.diffuse = mix(groundColor, diffuseColor, ndl);\r\n\r\n#ifdef SPECULARTERM\r\n\t// Specular\r\n\tvec3 angleW = normalize(viewDirectionW + lightData.xyz);\r\n\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\tspecComp = pow(specComp, max(1., glossiness));\r\n\r\n\tresult.specular = specComp * specularColor;\r\n#endif\r\n\r\n\treturn result;\r\n}\r\n\r\nvoid main(void) {\r\n\t// Clip plane\r\n#ifdef CLIPPLANE\r\n\tif (fClipDistance > 0.0)\r\n\t\tdiscard;\r\n#endif\r\n\r\n\tvec3 viewDirectionW = normalize(vEyePosition - vPositionW);\r\n\r\n\t// Base color\r\n\tvec4 baseColor = vec4(1., 1., 1., 1.);\r\n\tvec3 diffuseColor = vDiffuseColor.rgb;\r\n\r\n\t// Alpha\r\n\tfloat alpha = vDiffuseColor.a;\r\n\r\n#ifdef DIFFUSE\r\n\tbaseColor = texture2D(diffuseSampler, vDiffuseUV);\r\n\r\n#ifdef ALPHATEST\r\n\tif (baseColor.a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\r\n#ifdef ALPHAFROMDIFFUSE\r\n\talpha *= baseColor.a;\r\n#endif\r\n\r\n\tbaseColor.rgb *= vDiffuseInfos.y;\r\n#endif\r\n\r\n#ifdef VERTEXCOLOR\r\n\tbaseColor.rgb *= vColor.rgb;\r\n#endif\r\n\r\n\t// Bump\r\n#ifdef NORMAL\r\n\tvec3 normalW = normalize(vNormalW);\r\n#else\r\n\tvec3 normalW = vec3(1.0, 1.0, 1.0);\r\n#endif\r\n\r\n\r\n#ifdef BUMP\r\n\tnormalW = perturbNormal(viewDirectionW);\r\n#endif\r\n\r\n\t// Ambient color\r\n\tvec3 baseAmbientColor = vec3(1., 1., 1.);\r\n\r\n#ifdef AMBIENT\r\n\tbaseAmbientColor = texture2D(ambientSampler, vAmbientUV).rgb * vAmbientInfos.y;\r\n#endif\r\n\r\n\r\n\t// Specular map\r\n#ifdef SPECULARTERM\r\n\tfloat glossiness = vSpecularColor.a;\r\n\tvec3 specularColor = vSpecularColor.rgb;\r\n\r\n\t#ifdef SPECULAR\r\n\t\tvec4 specularMapColor = texture2D(specularSampler, vSpecularUV);\r\n\t\tspecularColor = specularMapColor.rgb;\r\n\t\t#ifdef GLOSSINESS\r\n\t\t\tglossiness = glossiness * specularMapColor.a;\r\n\t\t#endif\r\n\t#endif\r\n#else\r\n\tfloat glossiness = 0.;\r\n#endif\r\n\r\n\t// Lighting\r\n\tvec3 diffuseBase = vec3(0., 0., 0.);\r\n#ifdef SPECULARTERM\r\n\tvec3 specularBase = vec3(0., 0., 0.);\r\n#endif\r\n\tfloat shadow = 1.;\r\n\r\n#ifdef LIGHT0\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular0 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT0\r\n\tlightingInfo info = computeSpotLighting(viewDirectionW, normalW, vLightData0, vLightDirection0, vLightDiffuse0.rgb, vLightSpecular0, vLightDiffuse0.a, glossiness);\r\n#endif\r\n#ifdef HEMILIGHT0\r\n\tlightingInfo info = computeHemisphericLighting(viewDirectionW, normalW, vLightData0, vLightDiffuse0.rgb, vLightSpecular0, vLightGround0, glossiness);\r\n#endif\r\n#ifdef POINTDIRLIGHT0\r\n\tlightingInfo info = computeLighting(viewDirectionW, normalW, vLightData0, vLightDiffuse0.rgb, vLightSpecular0, vLightDiffuse0.a, glossiness);\r\n#endif\r\n#ifdef SHADOW0\r\n#ifdef SHADOWVSM0\r\n\tshadow = computeShadowWithVSM(vPositionFromLight0, shadowSampler0, shadowsInfo0.z, shadowsInfo0.x);\r\n#else\r\n\t#ifdef SHADOWPCF0\r\n\t\tshadow = computeShadowWithPCF(vPositionFromLight0, shadowSampler0, shadowsInfo0.y, shadowsInfo0.z, shadowsInfo0.x);\r\n\t#else\r\n\t\tshadow = computeShadow(vPositionFromLight0, shadowSampler0, shadowsInfo0.x, shadowsInfo0.z);\r\n\t#endif\r\n#endif\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info.diffuse * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info.specular * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT1\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular1 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT1\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData1, vLightDirection1, vLightDiffuse1.rgb, vLightSpecular1, vLightDiffuse1.a, glossiness);\r\n#endif\r\n#ifdef HEMILIGHT1\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData1, vLightDiffuse1.rgb, vLightSpecular1, vLightGround1, glossiness);\r\n#endif\r\n#ifdef POINTDIRLIGHT1\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData1, vLightDiffuse1.rgb, vLightSpecular1, vLightDiffuse1.a, glossiness);\r\n#endif\r\n#ifdef SHADOW1\r\n#ifdef SHADOWVSM1\r\n\tshadow = computeShadowWithVSM(vPositionFromLight1, shadowSampler1, shadowsInfo1.z, shadowsInfo1.x);\r\n#else\r\n\t#ifdef SHADOWPCF1\r\n\t\tshadow = computeShadowWithPCF(vPositionFromLight1, shadowSampler1, shadowsInfo1.y, shadowsInfo1.z, shadowsInfo1.x);\r\n\t#else\r\n\t\tshadow = computeShadow(vPositionFromLight1, shadowSampler1, shadowsInfo1.x, shadowsInfo1.z);\r\n\t#endif\r\n#endif\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info.diffuse * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info.specular * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT2\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular2 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT2\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData2, vLightDirection2, vLightDiffuse2.rgb, vLightSpecular2, vLightDiffuse2.a, glossiness);\r\n#endif\r\n#ifdef HEMILIGHT2\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData2, vLightDiffuse2.rgb, vLightSpecular2, vLightGround2, glossiness);\r\n#endif\r\n#ifdef POINTDIRLIGHT2\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData2, vLightDiffuse2.rgb, vLightSpecular2, vLightDiffuse2.a, glossiness);\r\n#endif\r\n#ifdef SHADOW2\r\n#ifdef SHADOWVSM2\r\n\tshadow = computeShadowWithVSM(vPositionFromLight2, shadowSampler2, shadowsInfo2.z, shadowsInfo2.x);\r\n#else\r\n\t#ifdef SHADOWPCF2\r\n\t\tshadow = computeShadowWithPCF(vPositionFromLight2, shadowSampler2, shadowsInfo2.y, shadowsInfo2.z, shadowsInfo2.x);\r\n\t#else\r\n\t\tshadow = computeShadow(vPositionFromLight2, shadowSampler2, shadowsInfo2.x, shadowsInfo2.z);\r\n\t#endif\t\r\n#endif\t\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info.diffuse * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info.specular * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT3\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular3 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT3\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData3, vLightDirection3, vLightDiffuse3.rgb, vLightSpecular3, vLightDiffuse3.a, glossiness);\r\n#endif\r\n#ifdef HEMILIGHT3\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData3, vLightDiffuse3.rgb, vLightSpecular3, vLightGround3, glossiness);\r\n#endif\r\n#ifdef POINTDIRLIGHT3\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData3, vLightDiffuse3.rgb, vLightSpecular3, vLightDiffuse3.a, glossiness);\r\n#endif\r\n#ifdef SHADOW3\r\n#ifdef SHADOWVSM3\r\n\tshadow = computeShadowWithVSM(vPositionFromLight3, shadowSampler3, shadowsInfo3.z, shadowsInfo3.x);\r\n#else\r\n\t#ifdef SHADOWPCF3\r\n\t\tshadow = computeShadowWithPCF(vPositionFromLight3, shadowSampler3, shadowsInfo3.y, shadowsInfo3.z, shadowsInfo3.x);\r\n\t#else\r\n\t\tshadow = computeShadow(vPositionFromLight3, shadowSampler3, shadowsInfo3.x, shadowsInfo3.z);\r\n\t#endif\t\r\n#endif\t\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info.diffuse * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info.specular * shadow;\r\n#endif\r\n#endif\r\n\r\n\t// Reflection\r\n\tvec3 reflectionColor = vec3(0., 0., 0.);\r\n\r\n#ifdef REFLECTION\r\n\tvec3 vReflectionUVW = computeReflectionCoords(vReflectionInfos.x, vec4(vPositionW, 1.0), normalW);\r\n\r\n\tif (vReflectionInfos.z != 0.0)\r\n\t{\r\n\t\tfloat bias = 0.;\r\n\r\n#ifdef ROUGHNESS\r\n\t\tbias = roughness;\r\n#endif\r\n\r\n#ifdef SPECULARTERM\r\n#ifdef SPECULAR\r\n#ifdef GLOSSINESS\r\n\t\tbias *= (1.0 - specularMapColor.a);\r\n#endif\r\n#endif\r\n#endif\r\n\r\n\t\treflectionColor = textureCube(reflectionCubeSampler, vReflectionUVW, bias).rgb * vReflectionInfos.y * shadow;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvec2 coords = vReflectionUVW.xy;\r\n\r\n\t\tif (vReflectionInfos.x == MAP_PROJECTION)\r\n\t\t{\r\n\t\t\tcoords /= vReflectionUVW.z;\r\n\t\t}\r\n\r\n\t\tcoords.y = 1.0 - coords.y;\r\n\r\n\t\treflectionColor = texture2D(reflection2DSampler, coords).rgb * vReflectionInfos.y * shadow;\r\n\t}\r\n\r\n#ifdef REFLECTIONFRESNEL\r\n\tfloat reflectionFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, reflectionRightColor.a, reflectionLeftColor.a);\r\n\r\n#ifdef REFLECTIONFRESNELFROMSPECULAR\r\n#ifdef SPECULARTERM\r\n\treflectionColor *= specularColor.rgb * (1.0 - reflectionFresnelTerm) + reflectionFresnelTerm * reflectionRightColor.rgb;\r\n#else\r\n\treflectionColor *= reflectionLeftColor.rgb * (1.0 - reflectionFresnelTerm) + reflectionFresnelTerm * reflectionRightColor.rgb;\r\n#endif\r\n#else\r\n\treflectionColor *= reflectionLeftColor.rgb * (1.0 - reflectionFresnelTerm) + reflectionFresnelTerm * reflectionRightColor.rgb;\r\n#endif\r\n#endif\r\n#endif\r\n\r\n\r\n#ifdef OPACITY\r\n\tvec4 opacityMap = texture2D(opacitySampler, vOpacityUV);\r\n\r\n#ifdef OPACITYRGB\r\n\topacityMap.rgb = opacityMap.rgb * vec3(0.3, 0.59, 0.11);\r\n\talpha *= (opacityMap.x + opacityMap.y + opacityMap.z)* vOpacityInfos.y;\r\n#else\r\n\talpha *= opacityMap.a * vOpacityInfos.y;\r\n#endif\r\n\r\n#endif\r\n\r\n#ifdef VERTEXALPHA\r\n\talpha *= vColor.a;\r\n#endif\r\n\r\n#ifdef OPACITYFRESNEL\r\n\tfloat opacityFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, opacityParts.z, opacityParts.w);\r\n\r\n\talpha += opacityParts.x * (1.0 - opacityFresnelTerm) + opacityFresnelTerm * opacityParts.y;\r\n#endif\r\n\r\n\t// Emissive\r\n\tvec3 emissiveColor = vEmissiveColor;\r\n#ifdef EMISSIVE\r\n    emissiveColor += texture2D(emissiveSampler, vEmissiveUV).rgb * vEmissiveInfos.y;\r\n#endif\r\n\r\n#ifdef EMISSIVEFRESNEL\r\n\tfloat emissiveFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, emissiveRightColor.a, emissiveLeftColor.a);\r\n\r\n\temissiveColor *= emissiveLeftColor.rgb * (1.0 - emissiveFresnelTerm) + emissiveFresnelTerm * emissiveRightColor.rgb;\r\n#endif\r\n\r\n\t// Fresnel\r\n#ifdef DIFFUSEFRESNEL\r\n\tfloat diffuseFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, diffuseRightColor.a, diffuseLeftColor.a);\r\n\r\n\tdiffuseBase *= diffuseLeftColor.rgb * (1.0 - diffuseFresnelTerm) + diffuseFresnelTerm * diffuseRightColor.rgb;\r\n#endif\r\n\r\n\t// Composition\r\n#ifdef EMISSIVEASILLUMINATION\r\n\tvec3 finalDiffuse = clamp(diffuseBase * diffuseColor + vAmbientColor, 0.0, 1.0) * baseColor.rgb;\r\n#else\r\n    vec3 finalDiffuse = clamp(diffuseBase * diffuseColor + emissiveColor + vAmbientColor, 0.0, 1.0) * baseColor.rgb;\r\n#endif\r\n\r\n#ifdef SPECULARTERM\r\n\tvec3 finalSpecular = specularBase * specularColor;\r\n#else\r\n\tvec3 finalSpecular = vec3(0.0);\r\n#endif\r\n\r\n#ifdef SPECULAROVERALPHA\r\n\talpha = clamp(alpha + dot(finalSpecular, vec3(0.3, 0.59, 0.11)), 0., 1.);\r\n#endif\r\n\r\n// Composition\r\n#ifdef EMISSIVEASILLUMINATION\r\n    vec4 color = vec4(clamp(finalDiffuse * baseAmbientColor + finalSpecular + reflectionColor + emissiveColor, 0.0, 1.0), alpha);\r\n#else\r\n    vec4 color = vec4(finalDiffuse * baseAmbientColor + finalSpecular + reflectionColor, alpha);\r\n#endif\r\n\r\n#ifdef FOG\r\n\tfloat fog = CalcFogFactor();\r\n\tcolor.rgb = fog * color.rgb + (1.0 - fog) * vFogColor;\r\n#endif\r\n\r\n\tgl_FragColor = color;\r\n}",defaultVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec3 position;\r\n#ifdef NORMAL\r\nattribute vec3 normal;\r\n#endif\r\n#ifdef UV1\r\nattribute vec2 uv;\r\n#endif\r\n#ifdef UV2\r\nattribute vec2 uv2;\r\n#endif\r\n#ifdef VERTEXCOLOR\r\nattribute vec4 color;\r\n#endif\r\n#ifdef BONES\r\nattribute vec4 matricesIndices;\r\nattribute vec4 matricesWeights;\r\n#endif\r\n\r\n// Uniforms\r\n\r\n#ifdef INSTANCES\r\nattribute vec4 world0;\r\nattribute vec4 world1;\r\nattribute vec4 world2;\r\nattribute vec4 world3;\r\n#else\r\nuniform mat4 world;\r\n#endif\r\n\r\nuniform mat4 view;\r\nuniform mat4 viewProjection;\r\n\r\n#ifdef DIFFUSE\r\nvarying vec2 vDiffuseUV;\r\nuniform mat4 diffuseMatrix;\r\nuniform vec2 vDiffuseInfos;\r\n#endif\r\n\r\n#ifdef AMBIENT\r\nvarying vec2 vAmbientUV;\r\nuniform mat4 ambientMatrix;\r\nuniform vec2 vAmbientInfos;\r\n#endif\r\n\r\n#ifdef OPACITY\r\nvarying vec2 vOpacityUV;\r\nuniform mat4 opacityMatrix;\r\nuniform vec2 vOpacityInfos;\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\nvarying vec2 vEmissiveUV;\r\nuniform vec2 vEmissiveInfos;\r\nuniform mat4 emissiveMatrix;\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\nvarying vec2 vSpecularUV;\r\nuniform vec2 vSpecularInfos;\r\nuniform mat4 specularMatrix;\r\n#endif\r\n\r\n#ifdef BUMP\r\nvarying vec2 vBumpUV;\r\nuniform vec2 vBumpInfos;\r\nuniform mat4 bumpMatrix;\r\n#endif\r\n\r\n#ifdef BONES\r\nuniform mat4 mBones[BonesPerMesh];\r\n#endif\r\n\r\n#ifdef POINTSIZE\r\nuniform float pointSize;\r\n#endif\r\n\r\n// Output\r\nvarying vec3 vPositionW;\r\n#ifdef NORMAL\r\nvarying vec3 vNormalW;\r\n#endif\r\n\r\n#ifdef VERTEXCOLOR\r\nvarying vec4 vColor;\r\n#endif\r\n\r\n#ifdef CLIPPLANE\r\nuniform vec4 vClipPlane;\r\nvarying float fClipDistance;\r\n#endif\r\n\r\n#ifdef FOG\r\nvarying float fFogDistance;\r\n#endif\r\n\r\n#ifdef SHADOWS\r\n#ifdef LIGHT0\r\nuniform mat4 lightMatrix0;\r\nvarying vec4 vPositionFromLight0;\r\n#endif\r\n#ifdef LIGHT1\r\nuniform mat4 lightMatrix1;\r\nvarying vec4 vPositionFromLight1;\r\n#endif\r\n#ifdef LIGHT2\r\nuniform mat4 lightMatrix2;\r\nvarying vec4 vPositionFromLight2;\r\n#endif\r\n#ifdef LIGHT3\r\nuniform mat4 lightMatrix3;\r\nvarying vec4 vPositionFromLight3;\r\n#endif\r\n#endif\r\n\r\n#ifdef REFLECTION\r\nvarying vec3 vPositionUVW;\r\n#endif\r\n\r\nvoid main(void) {\r\n\tmat4 finalWorld;\r\n\r\n#ifdef REFLECTION\r\n\tvPositionUVW = position;\r\n#endif \r\n\r\n#ifdef INSTANCES\r\n\tfinalWorld = mat4(world0, world1, world2, world3);\r\n#else\r\n\tfinalWorld = world;\r\n#endif\r\n\r\n#ifdef BONES\r\n\tmat4 m0 = mBones[int(matricesIndices.x)] * matricesWeights.x;\r\n\tmat4 m1 = mBones[int(matricesIndices.y)] * matricesWeights.y;\r\n\tmat4 m2 = mBones[int(matricesIndices.z)] * matricesWeights.z;\r\n\r\n#ifdef BONES4\r\n\tmat4 m3 = mBones[int(matricesIndices.w)] * matricesWeights.w;\r\n\tfinalWorld = finalWorld * (m0 + m1 + m2 + m3);\r\n#else\r\n\tfinalWorld = finalWorld * (m0 + m1 + m2);\r\n#endif \r\n\r\n#endif\r\n\tgl_Position = viewProjection * finalWorld * vec4(position, 1.0);\r\n\r\n\tvec4 worldPos = finalWorld * vec4(position, 1.0);\r\n\tvPositionW = vec3(worldPos);\r\n\r\n#ifdef NORMAL\r\n\tvNormalW = normalize(vec3(finalWorld * vec4(normal, 0.0)));\r\n#endif\r\n\r\n\t// Texture coordinates\r\n#ifndef UV1\r\n\tvec2 uv = vec2(0., 0.);\r\n#endif\r\n#ifndef UV2\r\n\tvec2 uv2 = vec2(0., 0.);\r\n#endif\r\n\r\n#ifdef DIFFUSE\r\n\tif (vDiffuseInfos.x == 0.)\r\n\t{\r\n\t\tvDiffuseUV = vec2(diffuseMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvDiffuseUV = vec2(diffuseMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef AMBIENT\r\n\tif (vAmbientInfos.x == 0.)\r\n\t{\r\n\t\tvAmbientUV = vec2(ambientMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvAmbientUV = vec2(ambientMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef OPACITY\r\n\tif (vOpacityInfos.x == 0.)\r\n\t{\r\n\t\tvOpacityUV = vec2(opacityMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvOpacityUV = vec2(opacityMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\n\tif (vEmissiveInfos.x == 0.)\r\n\t{\r\n\t\tvEmissiveUV = vec2(emissiveMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvEmissiveUV = vec2(emissiveMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\n\tif (vSpecularInfos.x == 0.)\r\n\t{\r\n\t\tvSpecularUV = vec2(specularMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvSpecularUV = vec2(specularMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef BUMP\r\n\tif (vBumpInfos.x == 0.)\r\n\t{\r\n\t\tvBumpUV = vec2(bumpMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvBumpUV = vec2(bumpMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n\t// Clip plane\r\n#ifdef CLIPPLANE\r\n\tfClipDistance = dot(worldPos, vClipPlane);\r\n#endif\r\n\r\n\t// Fog\r\n#ifdef FOG\r\n\tfFogDistance = (view * worldPos).z;\r\n#endif\r\n\r\n\t// Shadows\r\n#ifdef SHADOWS\r\n#ifdef LIGHT0\r\n\tvPositionFromLight0 = lightMatrix0 * worldPos;\r\n#endif\r\n#ifdef LIGHT1\r\n\tvPositionFromLight1 = lightMatrix1 * worldPos;\r\n#endif\r\n#ifdef LIGHT2\r\n\tvPositionFromLight2 = lightMatrix2 * worldPos;\r\n#endif\r\n#ifdef LIGHT3\r\n\tvPositionFromLight3 = lightMatrix3 * worldPos;\r\n#endif\r\n#endif\r\n\r\n\t// Vertex color\r\n#ifdef VERTEXCOLOR\r\n\tvColor = color;\r\n#endif\r\n\r\n\t// Point size\r\n#ifdef POINTSIZE\r\n\tgl_PointSize = pointSize;\r\n#endif\r\n}",depthPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\nvarying vec2 vUV;\r\nuniform sampler2D diffuseSampler;\r\n#endif\r\n\r\nuniform float far;\r\n\r\nvoid main(void)\r\n{\r\n#ifdef ALPHATEST\r\n\tif (texture2D(diffuseSampler, vUV).a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\r\n\tfloat depth = (gl_FragCoord.z / gl_FragCoord.w) / far;\r\n\tgl_FragColor = vec4(depth, depth * depth, 0.0, 1.0);\r\n}",depthVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attribute\r\nattribute vec3 position;\r\n#ifdef BONES\r\nattribute vec4 matricesIndices;\r\nattribute vec4 matricesWeights;\r\n#endif\r\n\r\n// Uniform\r\n#ifdef INSTANCES\r\nattribute vec4 world0;\r\nattribute vec4 world1;\r\nattribute vec4 world2;\r\nattribute vec4 world3;\r\n#else\r\nuniform mat4 world;\r\n#endif\r\n\r\nuniform mat4 viewProjection;\r\n#ifdef BONES\r\nuniform mat4 mBones[BonesPerMesh];\r\n#endif\r\n\r\n#if defined(ALPHATEST) || defined(NEED_UV)\r\nvarying vec2 vUV;\r\nuniform mat4 diffuseMatrix;\r\n#ifdef UV1\r\nattribute vec2 uv;\r\n#endif\r\n#ifdef UV2\r\nattribute vec2 uv2;\r\n#endif\r\n#endif\r\n\r\nvoid main(void)\r\n{\r\n#ifdef INSTANCES\r\n\tmat4 finalWorld = mat4(world0, world1, world2, world3);\r\n#else\r\n\tmat4 finalWorld = world;\r\n#endif\r\n\r\n#ifdef BONES\r\n\tmat4 m0 = mBones[int(matricesIndices.x)] * matricesWeights.x;\r\n\tmat4 m1 = mBones[int(matricesIndices.y)] * matricesWeights.y;\r\n\tmat4 m2 = mBones[int(matricesIndices.z)] * matricesWeights.z;\r\n\tmat4 m3 = mBones[int(matricesIndices.w)] * matricesWeights.w;\r\n\tfinalWorld = finalWorld * (m0 + m1 + m2 + m3);\r\n\tgl_Position = viewProjection * finalWorld * vec4(position, 1.0);\r\n#else\r\n\tgl_Position = viewProjection * finalWorld * vec4(position, 1.0);\r\n#endif\r\n\r\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\r\n#ifdef UV1\r\n\tvUV = vec2(diffuseMatrix * vec4(uv, 1.0, 0.0));\r\n#endif\r\n#ifdef UV2\r\n\tvUV = vec2(diffuseMatrix * vec4(uv2, 1.0, 0.0));\r\n#endif\r\n#endif\r\n}",depthBoxBlurPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\n// Parameters\r\nuniform vec2 screenSize;\r\n\r\nvoid main(void)\r\n{\r\n\tvec4 colorDepth = vec4(0.0);\r\n\r\n\tfor (int x = -OFFSET; x <= OFFSET; x++)\r\n\t\tfor (int y = -OFFSET; y <= OFFSET; y++)\r\n\t\t\tcolorDepth += texture2D(textureSampler, vUV + vec2(x, y) / screenSize);\r\n\r\n\tgl_FragColor = (colorDepth / float((OFFSET * 2 + 1) * (OFFSET * 2 + 1)));\r\n}",depthOfFieldPixelShader:'// BABYLON.JS Depth-of-field GLSL Shader\r\n// Author: Olivier Guyot\r\n// Does depth-of-field blur, edge blur\r\n// Inspired by Francois Tarlier & Martins Upitis\r\n\r\n#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n\r\n// samplers\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D highlightsSampler;\r\nuniform sampler2D depthSampler;\r\nuniform sampler2D grainSampler;\r\n\r\n// uniforms\r\nuniform float grain_amount;\r\nuniform bool blur_noise;\r\nuniform float screen_width;\r\nuniform float screen_height;\r\nuniform float distortion;\r\nuniform bool dof_enabled;\r\n//uniform float focus_distance;\t\t// not needed; already used to compute screen distance\r\nuniform float screen_distance;\t\t// precomputed screen distance from lens center; based on focal length & desired focus distance\r\nuniform float aperture;\r\nuniform float darken;\r\nuniform float edge_blur;\r\nuniform bool highlights;\r\n\r\n// preconputed uniforms (not effect parameters)\r\nuniform float near;\r\nuniform float far;\r\n\r\n// varyings\r\nvarying vec2 vUV;\r\n\r\n// constants\r\n#define PI \t\t3.14159265\r\n#define TWOPI \t6.28318530\r\n#define inverse_focal_length 0.1\t// a property of the lens used\r\n\r\n// common calculations\r\nvec2 centered_screen_pos;\r\nvec2 distorted_coords;\r\nfloat radius2;\r\nfloat radius;\r\n\r\n\r\n// on-the-fly constant noise\r\nvec2 rand(vec2 co)\r\n{\r\n\tfloat noise1 = (fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453));\r\n\tfloat noise2 = (fract(sin(dot(co, vec2(12.9898, 78.233)*2.0)) * 43758.5453));\r\n\treturn clamp(vec2(noise1, noise2), 0.0, 1.0);\r\n}\r\n\r\n// applies edge distortion on texture coords\r\nvec2 getDistortedCoords(vec2 coords) {\r\n\r\n\tif (distortion == 0.0) { return coords; }\r\n\r\n\tvec2 direction = 1.0 * normalize(centered_screen_pos);\r\n\tvec2 dist_coords = vec2(0.5, 0.5);\r\n\tdist_coords.x = 0.5 + direction.x * radius2 * 1.0;\r\n\tdist_coords.y = 0.5 + direction.y * radius2 * 1.0;\r\n\tfloat dist_amount = clamp(distortion*0.23, 0.0, 1.0);\r\n\r\n\tdist_coords = mix(coords, dist_coords, dist_amount);\r\n\r\n\treturn dist_coords;\r\n}\r\n\r\n// sample screen with an offset (randomize offset angle for better smothness), returns partial sample weight\r\nfloat sampleScreen(inout vec4 color, const in vec2 offset, const in float weight) {\r\n\r\n\t// compute coords with offset (a random angle is added)\r\n\tvec2 coords = distorted_coords;\r\n\tfloat angle = rand(coords * 100.0).x * TWOPI;\r\n\tcoords += vec2(offset.x * cos(angle) - offset.y * sin(angle), offset.x * sin(angle) + offset.y * cos(angle));\r\n\r\n\tcolor += texture2D(textureSampler, coords)*weight;\r\n\r\n\treturn weight;\r\n}\r\n\r\n// returns blur level according to blur size required\r\nfloat getBlurLevel(float size) {\r\n\treturn min(3.0, ceil(size / 1.0));\r\n}\r\n\r\n// returns original screen color after blur\r\nvec4 getBlurColor(float size) {\r\n\r\n\tvec4 col = texture2D(textureSampler, distorted_coords);\r\n\tif (size == 0.0) { return col; }\r\n\r\n\t// there are max. 30 samples; the number of samples chosen is dependant on the blur size\r\n\t// there can be 10, 20 or 30 samples chosen; levels of blur are then 1, 2 or 3\r\n\tfloat blur_level = getBlurLevel(size);\r\n\r\n\tfloat w = (size / screen_width);\r\n\tfloat h = (size / screen_height);\r\n\tfloat total_weight = 1.0;\r\n\tvec2 sample_coords;\r\n\r\n\ttotal_weight += sampleScreen(col, vec2(-0.50*w, 0.24*h), 0.93);\r\n\ttotal_weight += sampleScreen(col, vec2(0.30*w, -0.75*h), 0.90);\r\n\ttotal_weight += sampleScreen(col, vec2(0.36*w, 0.96*h), 0.87);\r\n\ttotal_weight += sampleScreen(col, vec2(-1.08*w, -0.55*h), 0.85);\r\n\ttotal_weight += sampleScreen(col, vec2(1.33*w, -0.37*h), 0.83);\r\n\ttotal_weight += sampleScreen(col, vec2(-0.82*w, 1.31*h), 0.80);\r\n\ttotal_weight += sampleScreen(col, vec2(-0.31*w, -1.67*h), 0.78);\r\n\ttotal_weight += sampleScreen(col, vec2(1.47*w, 1.11*h), 0.76);\r\n\ttotal_weight += sampleScreen(col, vec2(-1.97*w, 0.19*h), 0.74);\r\n\ttotal_weight += sampleScreen(col, vec2(1.42*w, -1.57*h), 0.72);\r\n\r\n\tif (blur_level > 1.0) {\r\n\t\ttotal_weight += sampleScreen(col, vec2(0.01*w, 2.25*h), 0.70);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-1.62*w, -1.74*h), 0.67);\r\n\t\ttotal_weight += sampleScreen(col, vec2(2.49*w, 0.20*h), 0.65);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-2.07*w, 1.61*h), 0.63);\r\n\t\ttotal_weight += sampleScreen(col, vec2(0.46*w, -2.70*h), 0.61);\r\n\t\ttotal_weight += sampleScreen(col, vec2(1.55*w, 2.40*h), 0.59);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-2.88*w, -0.75*h), 0.56);\r\n\t\ttotal_weight += sampleScreen(col, vec2(2.73*w, -1.44*h), 0.54);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-1.08*w, 3.02*h), 0.52);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-1.28*w, -3.05*h), 0.49);\r\n\t}\r\n\r\n\tif (blur_level > 2.0) {\r\n\t\ttotal_weight += sampleScreen(col, vec2(3.11*w, 1.43*h), 0.46);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-3.36*w, 1.08*h), 0.44);\r\n\t\ttotal_weight += sampleScreen(col, vec2(1.80*w, -3.16*h), 0.41);\r\n\t\ttotal_weight += sampleScreen(col, vec2(0.83*w, 3.65*h), 0.38);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-3.16*w, -2.19*h), 0.34);\r\n\t\ttotal_weight += sampleScreen(col, vec2(3.92*w, -0.53*h), 0.31);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-2.59*w, 3.12*h), 0.26);\r\n\t\ttotal_weight += sampleScreen(col, vec2(-0.20*w, -4.15*h), 0.22);\r\n\t\ttotal_weight += sampleScreen(col, vec2(3.02*w, 3.00*h), 0.15);\r\n\t}\r\n\r\n\tcol /= total_weight;\t\t// scales color according to weights\r\n\r\n\t\t\t\t\t\t\t\t// darken if out of focus\r\n\tif (darken > 0.0) {\r\n\t\tcol.rgb *= clamp(0.3, 1.0, 1.05 - size*0.5*darken);\r\n\t}\r\n\r\n\t// blur levels debug\r\n\t// if(blur_level == 1.0) { col.b *= 0.5; }\r\n\t// if(blur_level == 2.0) { col.r *= 0.5; }\r\n\t// if(blur_level == 3.0) { col.g *= 0.5; }\r\n\r\n\treturn col;\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\r\n\t// Common calc: position relative to screen center, screen radius, distorted coords, position in texel space\r\n\tcentered_screen_pos = vec2(vUV.x - 0.5, vUV.y - 0.5);\r\n\tradius2 = centered_screen_pos.x*centered_screen_pos.x + centered_screen_pos.y*centered_screen_pos.y;\r\n\tradius = sqrt(radius2);\r\n\tdistorted_coords = getDistortedCoords(vUV);\t\t// we distort the screen coordinates (lens "magnifying" effect)\r\n\tvec2 texels_coords = vec2(vUV.x * screen_width, vUV.y * screen_height);\t// varies from 0 to SCREEN_WIDTH or _HEIGHT\r\n\r\n\tfloat depth = texture2D(depthSampler, distorted_coords).r;\t// depth value from DepthRenderer: 0 to 1\r\n\tfloat distance = near + (far - near)*depth;\t\t// actual distance from the lens\r\n\tvec4 color = texture2D(textureSampler, vUV);\t// original raster\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// compute the circle of confusion size (CoC), i.e. blur radius depending on depth\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// screen_distance is precomputed in code\r\n\tfloat coc = abs(aperture * (screen_distance * (inverse_focal_length - 1.0 / distance) - 1.0));\r\n\r\n\t// disable blur\r\n\tif (dof_enabled == false || coc < 0.07) { coc = 0.0; }\r\n\r\n\t// blur from edge blur effect\r\n\tfloat edge_blur_amount = 0.0;\r\n\tif (edge_blur > 0.0) {\r\n\t\tedge_blur_amount = clamp((radius*2.0 - 1.0 + 0.15*edge_blur) * 1.5, 0.0, 1.0) * 1.3;\r\n\t}\r\n\r\n\t// total blur amount\r\n\tfloat blur_amount = max(edge_blur_amount, coc);\r\n\r\n\t// apply blur if necessary\r\n\tif (blur_amount == 0.0) {\r\n\t\tgl_FragColor = texture2D(textureSampler, distorted_coords);\r\n\t}\r\n\telse {\r\n\r\n\t\t// add blurred color\r\n\t\tgl_FragColor = getBlurColor(blur_amount * 1.7);\r\n\r\n\t\t// if we have computed highlights: enhance highlights\r\n\t\tif (highlights) {\r\n\t\t\tgl_FragColor.rgb += clamp(coc, 0.0, 1.0)*texture2D(highlightsSampler, distorted_coords).rgb;\r\n\t\t}\r\n\r\n\t\tif (blur_noise) {\r\n\t\t\t// we put a slight amount of noise in the blurred color\r\n\t\t\tvec2 noise = rand(distorted_coords) * 0.01 * blur_amount;\r\n\t\t\tvec2 blurred_coord = vec2(distorted_coords.x + noise.x, distorted_coords.y + noise.y);\r\n\t\t\tgl_FragColor = 0.04 * texture2D(textureSampler, blurred_coord) + 0.96 * gl_FragColor;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// apply grain\r\n\tif (grain_amount > 0.0) {\r\n\t\tvec4 grain_color = texture2D(grainSampler, texels_coords*0.003);\r\n\t\tgl_FragColor.rgb += (-0.5 + grain_color.rgb) * 0.30 * grain_amount;\r\n\t}\r\n\r\n}\r\n',displayPassPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D passSampler;\r\n\r\nvoid main(void)\r\n{\r\n    gl_FragColor = texture2D(passSampler, vUV);\r\n}",filterPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\nuniform mat4 kernelMatrix;\r\n\r\nvoid main(void)\r\n{\r\n\tvec3 baseColor = texture2D(textureSampler, vUV).rgb;\r\n\tvec3 updatedColor = (kernelMatrix * vec4(baseColor, 1.0)).rgb;\r\n\r\n\tgl_FragColor = vec4(updatedColor, 1.0);\r\n}",firePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform float time;\r\nuniform vec3 c1;\r\nuniform vec3 c2;\r\nuniform vec3 c3;\r\nuniform vec3 c4;\r\nuniform vec3 c5;\r\nuniform vec3 c6;\r\nuniform vec2 speed;\r\nuniform float shift;\r\nuniform float alphaThreshold;\r\n\r\nvarying vec2 vUV;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nvoid main() {\r\n\tvec2 p = vUV * 8.0;\r\n\tfloat q = fbm(p - time * 0.1);\r\n\tvec2 r = vec2(fbm(p + q + time * speed.x - p.x - p.y), fbm(p + q - time * speed.y));\r\n\tvec3 c = mix(c1, c2, fbm(p + r)) + mix(c3, c4, r.x) - mix(c5, c6, r.y);\r\n\tvec3 color = c * cos(shift * vUV.y);\r\n\tfloat luminance = dot(color.rgb, vec3(0.3, 0.59, 0.11));\r\n\r\n\tgl_FragColor = vec4(color, luminance * alphaThreshold + (1.0 - alphaThreshold));\r\n}",fxaaPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#define FXAA_REDUCE_MIN   (1.0/128.0)\r\n#define FXAA_REDUCE_MUL   (1.0/8.0)\r\n#define FXAA_SPAN_MAX     8.0\r\n\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\nuniform vec2 texelSize;\r\n\r\nvoid main(){\r\n\tvec2 localTexelSize = texelSize;\r\n\tvec4 rgbNW = texture2D(textureSampler, (vUV + vec2(-1.0, -1.0) * localTexelSize));\r\n\tvec4 rgbNE = texture2D(textureSampler, (vUV + vec2(1.0, -1.0) * localTexelSize));\r\n\tvec4 rgbSW = texture2D(textureSampler, (vUV + vec2(-1.0, 1.0) * localTexelSize));\r\n\tvec4 rgbSE = texture2D(textureSampler, (vUV + vec2(1.0, 1.0) * localTexelSize));\r\n\tvec4 rgbM = texture2D(textureSampler, vUV);\r\n\tvec4 luma = vec4(0.299, 0.587, 0.114, 1.0);\r\n\tfloat lumaNW = dot(rgbNW, luma);\r\n\tfloat lumaNE = dot(rgbNE, luma);\r\n\tfloat lumaSW = dot(rgbSW, luma);\r\n\tfloat lumaSE = dot(rgbSE, luma);\r\n\tfloat lumaM = dot(rgbM, luma);\r\n\tfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\r\n\tfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\r\n\r\n\tvec2 dir = vec2(-((lumaNW + lumaNE) - (lumaSW + lumaSE)), ((lumaNW + lumaSW) - (lumaNE + lumaSE)));\r\n\r\n\tfloat dirReduce = max(\r\n\t\t(lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL),\r\n\t\tFXAA_REDUCE_MIN);\r\n\r\n\tfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\r\n\tdir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\r\n\t\tmax(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\r\n\t\tdir * rcpDirMin)) * localTexelSize;\r\n\r\n\tvec4 rgbA = 0.5 * (\r\n\t\ttexture2D(textureSampler, vUV + dir * (1.0 / 3.0 - 0.5)) +\r\n\t\ttexture2D(textureSampler, vUV + dir * (2.0 / 3.0 - 0.5)));\r\n\r\n\tvec4 rgbB = rgbA * 0.5 + 0.25 * (\r\n\t\ttexture2D(textureSampler, vUV + dir *  -0.5) +\r\n\t\ttexture2D(textureSampler, vUV + dir * 0.5));\r\n\tfloat lumaB = dot(rgbB, luma);\r\n\tif ((lumaB < lumaMin) || (lumaB > lumaMax)) {\r\n\t\tgl_FragColor = rgbA;\r\n\t}\r\n\telse {\r\n\t\tgl_FragColor = rgbB;\r\n\t}\r\n}",grassPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vUV;\r\n\r\nuniform vec3 herb1Color;\r\nuniform vec3 herb2Color;\r\nuniform vec3 herb3Color;\r\nuniform vec3 groundColor;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nvoid main(void) {\r\n\tvec3 color = mix(groundColor, herb1Color, rand(gl_FragCoord.xy * 4.0));\r\n\tcolor = mix(color, herb2Color, rand(gl_FragCoord.xy * 8.0));\r\n\tcolor = mix(color, herb3Color, rand(gl_FragCoord.xy));\r\n\tcolor = mix(color, herb1Color, fbm(gl_FragCoord.xy * 16.0));\r\n\tgl_FragColor = vec4(color, 1.0);\r\n}",hdrPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform sampler2D textureSampler;\r\nvarying vec2 vUV;\r\n\r\n#if defined(GAUSSIAN_BLUR_H) || defined(GAUSSIAN_BLUR_V)\r\nuniform float blurOffsets[9];\r\nuniform float blurWeights[9];\r\n\r\nvoid main(void) {\r\n\tvec4 color = vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n\tfor (int i = 0; i < 9; i++) {\r\n\t\t#ifdef GAUSSIAN_BLUR_H\r\n\t\tcolor += (texture2D(textureSampler, vUV + vec2(blurOffsets[i], 0.0)) * blurWeights[i]);\r\n\t\t#else\r\n\t\tcolor += (texture2D(textureSampler, vUV + vec2(0.0, blurOffsets[i])) * blurWeights[i]);\r\n\t\t#endif\r\n\t}\r\n\r\n\tcolor.a = 1.0;\r\n\tgl_FragColor = color;\r\n}\r\n#endif\r\n\r\n#if defined(TEXTURE_ADDER)\r\nuniform sampler2D otherSampler;\r\n\r\nvoid main() {\r\n\tvec4 sum = texture2D(textureSampler, vUV) + texture2D(otherSampler, vUV);\r\n\tsum.a = clamp(sum.a, 0.0, 1.0);\r\n\r\n\tgl_FragColor = sum;\r\n}\r\n#endif\r\n\r\n#if defined(LUMINANCE_GENERATOR)\r\nuniform vec2 lumOffsets[4];\r\n\r\nvoid main() {\r\n\tfloat average = 0.0;\r\n\tvec4 color = vec4(0.0, 0.0, 0.0, 0.0);\r\n\tfloat maximum = -1e20;\r\n\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\tcolor = texture2D(textureSampler, vUV + lumOffsets[i]);\r\n\r\n\t\tfloat GreyValue = length(color.rgb);\r\n\r\n\t\tmaximum = max(maximum, GreyValue);\r\n\t\taverage += (0.25 * log(1e-5 + GreyValue));\r\n\t}\r\n\r\n\taverage = exp(average);\r\n\r\n\tgl_FragColor = vec4(average, maximum, 0.0, 1.0);\r\n\r\n}\r\n#endif\r\n\r\n#if defined(DOWN_SAMPLE)\r\nuniform vec2 dsOffsets[9];\r\nuniform float halfDestPixelSize;\r\n\r\n#ifdef FINAL_DOWN_SAMPLE\r\nvec4 pack(float value) {\r\n\tconst vec4 bit_shift = vec4(255.0 * 255.0 * 255.0, 255.0 * 255.0, 255.0, 1.0);\r\n\tconst vec4 bit_mask = vec4(0.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\r\n\r\n\tvec4 res = fract(value * bit_shift);\r\n\tres -= res.xxyz * bit_mask;\r\n\r\n\treturn res;\r\n}\r\n#endif\r\n\r\nvoid main() {\r\n\tvec4 color = vec4(0.0, 0.0, 0.0, 0.0);\r\n\tfloat average = 0.0;\r\n\r\n\tfor (int i = 0; i < 9; i++) {\r\n\t\tcolor = texture2D(textureSampler, vUV + vec2(halfDestPixelSize, halfDestPixelSize) + dsOffsets[i]);\r\n\t\taverage += color.r;\r\n\t}\r\n\r\n\taverage /= 9.0;\r\n\r\n\t#ifndef FINAL_DOWN_SAMPLE\r\n\tgl_FragColor = vec4(average, average, 0.0, 1.0);\r\n\t#else\r\n\tgl_FragColor = pack(average);\r\n\t#endif\r\n}\r\n#endif\r\n\r\n#if defined(BRIGHT_PASS)\r\nuniform vec2 dsOffsets[4];\r\nuniform float brightThreshold;\r\n\r\nvoid main() {\r\n\tvec4 average = vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n\taverage = texture2D(textureSampler, vUV + vec2(dsOffsets[0].x, dsOffsets[0].y));\r\n\taverage += texture2D(textureSampler, vUV + vec2(dsOffsets[1].x, dsOffsets[1].y));\r\n\taverage += texture2D(textureSampler, vUV + vec2(dsOffsets[2].x, dsOffsets[2].y));\r\n\taverage += texture2D(textureSampler, vUV + vec2(dsOffsets[3].x, dsOffsets[3].y));\r\n\r\n\taverage *= 0.25;\r\n\r\n\tfloat luminance = length(average.rgb);\r\n\r\n\tif (luminance < brightThreshold) {\r\n\t\taverage = vec4(0.0, 0.0, 0.0, 1.0);\r\n\t}\r\n\r\n\tgl_FragColor = average;\r\n}\r\n#endif\r\n\r\n#if defined(DOWN_SAMPLE_X4)\r\nuniform vec2 dsOffsets[16];\r\n\r\nvoid main() {\r\n\tvec4 average = vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n\taverage = texture2D(textureSampler, vUV + dsOffsets[0]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[1]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[2]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[3]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[4]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[5]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[6]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[7]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[8]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[9]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[10]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[11]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[12]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[13]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[14]);\r\n\taverage += texture2D(textureSampler, vUV + dsOffsets[15]);\r\n\r\n\taverage /= 16.0;\r\n\r\n\tgl_FragColor = average;\r\n}\r\n#endif\r\n\r\n#if defined(HDR)\r\nuniform sampler2D otherSampler;\r\n\r\nuniform float exposure;\r\nuniform float avgLuminance;\r\n\r\nvoid main() {\r\n\tvec4 color = texture2D(textureSampler, vUV) + texture2D(otherSampler, vUV);\r\n\tvec4 adjustedColor = color / avgLuminance * exposure;\r\n\r\n\tcolor = adjustedColor;\r\n\tcolor.a = 1.0;\r\n\r\n\tgl_FragColor = color;\r\n}\r\n#endif\r\n",layerPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\n// Color\r\nuniform vec4 color;\r\n\r\nvoid main(void) {\r\n\tvec4 baseColor = texture2D(textureSampler, vUV);\r\n\r\n\tgl_FragColor = baseColor * color;\r\n}",layerVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec2 position;\r\n\r\n// Uniforms\r\nuniform mat4 textureMatrix;\r\n\r\n// Output\r\nvarying vec2 vUV;\r\n\r\nconst vec2 madd = vec2(0.5, 0.5);\r\n\r\nvoid main(void) {\t\r\n\r\n\tvUV = vec2(textureMatrix * vec4(position * madd + madd, 1.0, 0.0));\r\n\tgl_Position = vec4(position, 0.0, 1.0);\r\n}",legacydefaultPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#define MAP_PROJECTION\t4.\r\n\r\n// Constants\r\nuniform vec3 vEyePosition;\r\nuniform vec3 vAmbientColor;\r\nuniform vec4 vDiffuseColor;\r\n#ifdef SPECULARTERM\r\nuniform vec4 vSpecularColor;\r\n#endif\r\nuniform vec3 vEmissiveColor;\r\n\r\n// Input\r\nvarying vec3 vPositionW;\r\nvarying vec3 vNormalW;\r\n\r\n#ifdef VERTEXCOLOR\r\nvarying vec4 vColor;\r\n#endif\r\n\r\n// Lights\r\n#ifdef LIGHT0\r\nuniform vec4 vLightData0;\r\nuniform vec4 vLightDiffuse0;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular0;\r\n#endif\r\n#ifdef SHADOW0\r\nvarying vec4 vPositionFromLight0;\r\nuniform sampler2D shadowSampler0;\r\n#endif\r\n#ifdef SPOTLIGHT0\r\nuniform vec4 vLightDirection0;\r\n#endif\r\n#ifdef HEMILIGHT0\r\nuniform vec3 vLightGround0;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT1\r\nuniform vec4 vLightData1;\r\nuniform vec4 vLightDiffuse1;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular1;\r\n#endif\r\n#ifdef SHADOW1\r\nvarying vec4 vPositionFromLight1;\r\nuniform sampler2D shadowSampler1;\r\n#endif\r\n#ifdef SPOTLIGHT1\r\nuniform vec4 vLightDirection1;\r\n#endif\r\n#ifdef HEMILIGHT1\r\nuniform vec3 vLightGround1;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT2\r\nuniform vec4 vLightData2;\r\nuniform vec4 vLightDiffuse2;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular2;\r\n#endif\r\n#ifdef SHADOW2\r\nvarying vec4 vPositionFromLight2;\r\nuniform sampler2D shadowSampler2;\r\n#endif\r\n#ifdef SPOTLIGHT2\r\nuniform vec4 vLightDirection2;\r\n#endif\r\n#ifdef HEMILIGHT2\r\nuniform vec3 vLightGround2;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT3\r\nuniform vec4 vLightData3;\r\nuniform vec4 vLightDiffuse3;\r\n#ifdef SPECULARTERM\r\nuniform vec3 vLightSpecular3;\r\n#endif\r\n#ifdef SHADOW3\r\nvarying vec4 vPositionFromLight3;\r\nuniform sampler2D shadowSampler3;\r\n#endif\r\n#ifdef SPOTLIGHT3\r\nuniform vec4 vLightDirection3;\r\n#endif\r\n#ifdef HEMILIGHT3\r\nuniform vec3 vLightGround3;\r\n#endif\r\n#endif\r\n\r\n// Samplers\r\n#ifdef DIFFUSE\r\nvarying vec2 vDiffuseUV;\r\nuniform sampler2D diffuseSampler;\r\nuniform vec2 vDiffuseInfos;\r\n#endif\r\n\r\n#ifdef AMBIENT\r\nvarying vec2 vAmbientUV;\r\nuniform sampler2D ambientSampler;\r\nuniform vec2 vAmbientInfos;\r\n#endif\r\n\r\n#ifdef OPACITY\t\r\nvarying vec2 vOpacityUV;\r\nuniform sampler2D opacitySampler;\r\nuniform vec2 vOpacityInfos;\r\n#endif\r\n\r\n#ifdef REFLECTION\r\nvarying vec3 vReflectionUVW;\r\nuniform samplerCube reflectionCubeSampler;\r\nuniform sampler2D reflection2DSampler;\r\nuniform vec3 vReflectionInfos;\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\nvarying vec2 vEmissiveUV;\r\nuniform vec2 vEmissiveInfos;\r\nuniform sampler2D emissiveSampler;\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\nvarying vec2 vSpecularUV;\r\nuniform vec2 vSpecularInfos;\r\nuniform sampler2D specularSampler;\r\n#endif\r\n\r\n// Fresnel\r\n#ifdef FRESNEL\r\nfloat computeFresnelTerm(vec3 viewDirection, vec3 worldNormal, float bias, float power)\r\n{\r\n\tfloat fresnelTerm = pow(bias + abs(dot(viewDirection, worldNormal)), power);\r\n\treturn clamp(fresnelTerm, 0., 1.);\r\n}\r\n#endif\r\n\r\n#ifdef DIFFUSEFRESNEL\r\nuniform vec4 diffuseLeftColor;\r\nuniform vec4 diffuseRightColor;\r\n#endif\r\n\r\n#ifdef OPACITYFRESNEL\r\nuniform vec4 opacityParts;\r\n#endif\r\n\r\n#ifdef REFLECTIONFRESNEL\r\nuniform vec4 reflectionLeftColor;\r\nuniform vec4 reflectionRightColor;\r\n#endif\r\n\r\n#ifdef EMISSIVEFRESNEL\r\nuniform vec4 emissiveLeftColor;\r\nuniform vec4 emissiveRightColor;\r\n#endif\r\n\r\n// Shadows\r\n#ifdef SHADOWS\r\n\r\nfloat unpack(vec4 color)\r\n{\r\n\tconst vec4 bitShift = vec4(1. / (255. * 255. * 255.), 1. / (255. * 255.), 1. / 255., 1.);\r\n\treturn dot(color, bitShift);\r\n}\r\n\r\nfloat unpackHalf(vec2 color)\r\n{\r\n\treturn color.x + (color.y / 255.0);\r\n}\r\n\r\nfloat computeShadow(vec4 vPositionFromLight, sampler2D shadowSampler)\r\n{\r\n\tvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\r\n\tvec2 uv = 0.5 * depth.xy + vec2(0.5, 0.5);\r\n\r\n\tif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tfloat shadow = unpack(texture2D(shadowSampler, uv));\r\n\r\n\tif (depth.z > shadow)\r\n\t{\r\n\t\treturn 0.;\r\n\t}\r\n\treturn 1.;\r\n}\r\n\r\n// Thanks to http://devmaster.net/\r\nfloat ChebychevInequality(vec2 moments, float t)\r\n{\r\n\tif (t <= moments.x)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tfloat variance = moments.y - (moments.x * moments.x);\r\n\tvariance = max(variance, 0.);\r\n\r\n\tfloat d = t - moments.x;\r\n\treturn variance / (variance + d * d);\r\n}\r\n\r\nfloat computeShadowWithVSM(vec4 vPositionFromLight, sampler2D shadowSampler)\r\n{\r\n\tvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\r\n\tvec2 uv = 0.5 * depth.xy + vec2(0.5, 0.5);\r\n\r\n\tif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0)\r\n\t{\r\n\t\treturn 1.0;\r\n\t}\r\n\r\n\tvec4 texel = texture2D(shadowSampler, uv);\r\n\r\n\tvec2 moments = vec2(unpackHalf(texel.xy), unpackHalf(texel.zw));\r\n\treturn clamp(1.3 - ChebychevInequality(moments, depth.z), 0., 1.0);\r\n}\r\n#endif\r\n\r\n#ifdef CLIPPLANE\r\nvarying float fClipDistance;\r\n#endif\r\n\r\n// Fog\r\n#ifdef FOG\r\n\r\n#define FOGMODE_NONE    0.\r\n#define FOGMODE_EXP     1.\r\n#define FOGMODE_EXP2    2.\r\n#define FOGMODE_LINEAR  3.\r\n#define E 2.71828\r\n\r\nuniform vec4 vFogInfos;\r\nuniform vec3 vFogColor;\r\nvarying float fFogDistance;\r\n\r\nfloat CalcFogFactor()\r\n{\r\n\tfloat fogCoeff = 1.0;\r\n\tfloat fogStart = vFogInfos.y;\r\n\tfloat fogEnd = vFogInfos.z;\r\n\tfloat fogDensity = vFogInfos.w;\r\n\r\n\tif (FOGMODE_LINEAR == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = (fogEnd - fFogDistance) / (fogEnd - fogStart);\r\n\t}\r\n\telse if (FOGMODE_EXP == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fogDensity);\r\n\t}\r\n\telse if (FOGMODE_EXP2 == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fFogDistance * fogDensity * fogDensity);\r\n\t}\r\n\r\n\treturn clamp(fogCoeff, 0.0, 1.0);\r\n}\r\n#endif\r\n\r\n// Light Computing\r\nmat3 computeLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec4 diffuseColor, vec3 specularColor) {\r\n\tmat3 result;\r\n\r\n\tvec3 lightVectorW;\r\n\tif (lightData.w == 0.)\r\n\t{\r\n\t\tlightVectorW = normalize(lightData.xyz - vPositionW);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tlightVectorW = normalize(-lightData.xyz);\r\n\t}\r\n\r\n\t// diffuse\r\n\tfloat ndl = max(0., dot(vNormal, lightVectorW));\r\n\r\n\tresult[0] = ndl * diffuseColor.rgb;\r\n\r\n#ifdef SPECULARTERM\r\n\t// Specular\r\n\tvec3 angleW = normalize(viewDirectionW + lightVectorW);\r\n\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\tspecComp = max(0., pow(specComp, max(1.0, vSpecularColor.a)));\r\n\tresult[1] = specComp * specularColor;\r\n#else\r\n\tresult[1] = vec3(0.);\r\n#endif\r\n\r\n\tresult[2] = vec3(0.);\r\n\r\n\treturn result;\r\n}\r\n\r\nmat3 computeSpotLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec4 lightDirection, vec4 diffuseColor, vec3 specularColor) {\r\n\tmat3 result;\r\n\r\n\tvec3 lightVectorW = normalize(lightData.xyz - vPositionW);\r\n\r\n\t// diffuse\r\n\tfloat cosAngle = max(0., dot(-lightDirection.xyz, lightVectorW));\r\n\tfloat spotAtten = 0.0;\r\n\r\n\tif (cosAngle >= lightDirection.w)\r\n\t{\r\n\t\tcosAngle = max(0., pow(cosAngle, lightData.w));\r\n\t\tspotAtten = max(0., (cosAngle - lightDirection.w) / (1. - cosAngle));\r\n\r\n\t\t// Diffuse\r\n\t\tfloat ndl = max(0., dot(vNormal, -lightDirection.xyz));\r\n\t\tresult[0] = ndl * spotAtten * diffuseColor.rgb;\r\n\r\n#ifdef SPECULARTERM\r\n\t\t// Specular\r\n\t\tvec3 angleW = normalize(viewDirectionW - lightDirection.xyz);\r\n\t\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\t\tspecComp = pow(specComp, vSpecularColor.a);\r\n\t\tresult[1] = specComp * specularColor * spotAtten;\r\n#else\r\n\t\tresult[1] = vec3(0.);\r\n#endif\r\n\t\tresult[2] = vec3(0.);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tresult[0] = vec3(0.);\r\n\tresult[1] = vec3(0.);\r\n\tresult[2] = vec3(0.);\r\n\r\n\treturn result;\r\n}\r\n\r\nmat3 computeHemisphericLighting(vec3 viewDirectionW, vec3 vNormal, vec4 lightData, vec4 diffuseColor, vec3 specularColor, vec3 groundColor) {\r\n\tmat3 result;\r\n\r\n\t// Diffuse\r\n\tfloat ndl = dot(vNormal, lightData.xyz) * 0.5 + 0.5;\r\n\tresult[0] = mix(groundColor, diffuseColor.rgb, ndl);\r\n\r\n#ifdef SPECULARTERM\r\n\t// Specular\r\n\tvec3 angleW = normalize(viewDirectionW + lightData.xyz);\r\n\tfloat specComp = max(0., dot(vNormal, angleW));\r\n\tspecComp = pow(specComp, vSpecularColor.a);\r\n\tresult[1] = specComp * specularColor;\r\n#else\r\n\tresult[1] = vec3(0.);\r\n#endif\r\n\r\n\tresult[2] = vec3(0.);\r\n\r\n\treturn result;\r\n}\r\n\r\nvoid main(void) {\r\n\t// Clip plane\r\n#ifdef CLIPPLANE\r\n\tif (fClipDistance > 0.0)\r\n\t\tdiscard;\r\n#endif\r\n\r\n\tvec3 viewDirectionW = normalize(vEyePosition - vPositionW);\r\n\r\n\t// Base color\r\n\tvec4 baseColor = vec4(1., 1., 1., 1.);\r\n\tvec3 diffuseColor = vDiffuseColor.rgb;\r\n\r\n#ifdef DIFFUSE\r\n\tbaseColor = texture2D(diffuseSampler, vDiffuseUV);\r\n\r\n#ifdef ALPHATEST\r\n\tif (baseColor.a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\r\n\tbaseColor.rgb *= vDiffuseInfos.y;\r\n#endif\r\n\r\n#ifdef VERTEXCOLOR\r\n\tbaseColor.rgb *= vColor.rgb;\r\n#endif\r\n\r\n\t// Bump\r\n\tvec3 normalW = normalize(vNormalW);\r\n\r\n\t// Ambient color\r\n\tvec3 baseAmbientColor = vec3(1., 1., 1.);\r\n\r\n#ifdef AMBIENT\r\n\tbaseAmbientColor = texture2D(ambientSampler, vAmbientUV).rgb * vAmbientInfos.y;\r\n#endif\r\n\r\n\t// Lighting\r\n\tvec3 diffuseBase = vec3(0., 0., 0.);\r\n#ifdef SPECULARTERM\r\n\tvec3 specularBase = vec3(0., 0., 0.);\r\n#endif\r\n\tfloat shadow = 1.;\r\n\r\n#ifdef LIGHT0\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular0 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT0\r\n\tmat3 info = computeSpotLighting(viewDirectionW, normalW, vLightData0, vLightDirection0, vLightDiffuse0, vLightSpecular0);\r\n#endif\r\n#ifdef HEMILIGHT0\r\n\tmat3 info = computeHemisphericLighting(viewDirectionW, normalW, vLightData0, vLightDiffuse0, vLightSpecular0, vLightGround0);\r\n#endif\r\n#ifdef POINTDIRLIGHT0\r\n\tmat3 info = computeLighting(viewDirectionW, normalW, vLightData0, vLightDiffuse0, vLightSpecular0);\r\n#endif\r\n#ifdef SHADOW0\r\n#ifdef SHADOWVSM0\r\n\tshadow = computeShadowWithVSM(vPositionFromLight0, shadowSampler0);\r\n#else\r\n\tshadow = computeShadow(vPositionFromLight0, shadowSampler0);\r\n#endif\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info[0] * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info[1] * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT1\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular1 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT1\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData1, vLightDirection1, vLightDiffuse1, vLightSpecular1);\r\n#endif\r\n#ifdef HEMILIGHT1\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData1, vLightDiffuse1, vLightSpecular1, vLightGround1);\r\n#endif\r\n#ifdef POINTDIRLIGHT1\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData1, vLightDiffuse1, vLightSpecular1);\r\n#endif\r\n#ifdef SHADOW1\r\n#ifdef SHADOWVSM1\r\n\tshadow = computeShadowWithVSM(vPositionFromLight1, shadowSampler1);\r\n#else\r\n\tshadow = computeShadow(vPositionFromLight1, shadowSampler1);\r\n#endif\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info[0] * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info[1] * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT2\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular2 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT2\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData2, vLightDirection2, vLightDiffuse2, vLightSpecular2);\r\n#endif\r\n#ifdef HEMILIGHT2\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData2, vLightDiffuse2, vLightSpecular2, vLightGround2);\r\n#endif\r\n#ifdef POINTDIRLIGHT2\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData2, vLightDiffuse2, vLightSpecular2);\r\n#endif\r\n#ifdef SHADOW2\r\n#ifdef SHADOWVSM2\r\n\tshadow = computeShadowWithVSM(vPositionFromLight2, shadowSampler2);\r\n#else\r\n\tshadow = computeShadow(vPositionFromLight2, shadowSampler2);\r\n#endif\t\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info[0] * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info[1] * shadow;\r\n#endif\r\n#endif\r\n\r\n#ifdef LIGHT3\r\n#ifndef SPECULARTERM\r\n\tvec3 vLightSpecular3 = vec3(0.0);\r\n#endif\r\n#ifdef SPOTLIGHT3\r\n\tinfo = computeSpotLighting(viewDirectionW, normalW, vLightData3, vLightDirection3, vLightDiffuse3, vLightSpecular3);\r\n#endif\r\n#ifdef HEMILIGHT3\r\n\tinfo = computeHemisphericLighting(viewDirectionW, normalW, vLightData3, vLightDiffuse3, vLightSpecular3, vLightGround3);\r\n#endif\r\n#ifdef POINTDIRLIGHT3\r\n\tinfo = computeLighting(viewDirectionW, normalW, vLightData3, vLightDiffuse3, vLightSpecular3);\r\n#endif\r\n#ifdef SHADOW3\r\n#ifdef SHADOWVSM3\r\n\tshadow = computeShadowWithVSM(vPositionFromLight3, shadowSampler3);\r\n#else\r\n\tshadow = computeShadow(vPositionFromLight3, shadowSampler3);\r\n#endif\t\r\n#else\r\n\tshadow = 1.;\r\n#endif\r\n\tdiffuseBase += info[0] * shadow;\r\n#ifdef SPECULARTERM\r\n\tspecularBase += info[1] * shadow;\r\n#endif\r\n#endif\r\n\r\n\t// Reflection\r\n\tvec3 reflectionColor = vec3(0., 0., 0.);\r\n\r\n#ifdef REFLECTION\r\n\tif (vReflectionInfos.z != 0.0)\r\n\t{\r\n\t\treflectionColor = textureCube(reflectionCubeSampler, vReflectionUVW).rgb * vReflectionInfos.y;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvec2 coords = vReflectionUVW.xy;\r\n\r\n\t\tif (vReflectionInfos.x == MAP_PROJECTION)\r\n\t\t{\r\n\t\t\tcoords /= vReflectionUVW.z;\r\n\t\t}\r\n\r\n\t\tcoords.y = 1.0 - coords.y;\r\n\r\n\t\treflectionColor = texture2D(reflection2DSampler, coords).rgb * vReflectionInfos.y;\r\n\t}\r\n\r\n#ifdef REFLECTIONFRESNEL\r\n\tfloat reflectionFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, reflectionRightColor.a, reflectionLeftColor.a);\r\n\r\n\treflectionColor *= reflectionLeftColor.rgb * (1.0 - reflectionFresnelTerm) + reflectionFresnelTerm * reflectionRightColor.rgb;\r\n#endif\r\n#endif\r\n\r\n\t// Alpha\r\n\tfloat alpha = vDiffuseColor.a;\r\n\r\n#ifdef OPACITY\r\n\tvec4 opacityMap = texture2D(opacitySampler, vOpacityUV);\r\n#ifdef OPACITYRGB\r\n\topacityMap.rgb = opacityMap.rgb * vec3(0.3, 0.59, 0.11);\r\n\talpha *= (opacityMap.x + opacityMap.y + opacityMap.z)* vOpacityInfos.y;\r\n#else\r\n\talpha *= opacityMap.a * vOpacityInfos.y;\r\n#endif\r\n#endif\r\n\r\n#ifdef VERTEXALPHA\r\n\talpha *= vColor.a;\r\n#endif\r\n\r\n#ifdef OPACITYFRESNEL\r\n\tfloat opacityFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, opacityParts.z, opacityParts.w);\r\n\r\n\talpha += opacityParts.x * (1.0 - opacityFresnelTerm) + opacityFresnelTerm * opacityParts.y;\r\n#endif\r\n\r\n\t// Emissive\r\n\tvec3 emissiveColor = vEmissiveColor;\r\n#ifdef EMISSIVE\r\n\temissiveColor += texture2D(emissiveSampler, vEmissiveUV).rgb * vEmissiveInfos.y;\r\n#endif\r\n\r\n#ifdef EMISSIVEFRESNEL\r\n\tfloat emissiveFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, emissiveRightColor.a, emissiveLeftColor.a);\r\n\r\n\temissiveColor *= emissiveLeftColor.rgb * (1.0 - emissiveFresnelTerm) + emissiveFresnelTerm * emissiveRightColor.rgb;\r\n#endif\r\n\r\n\t// Specular map\r\n#ifdef SPECULARTERM\r\n\tvec3 specularColor = vSpecularColor.rgb;\r\n#ifdef SPECULAR\r\n\tspecularColor = texture2D(specularSampler, vSpecularUV).rgb * vSpecularInfos.y;\r\n#endif\r\n#endif\r\n\r\n\t// Fresnel\r\n#ifdef DIFFUSEFRESNEL\r\n\tfloat diffuseFresnelTerm = computeFresnelTerm(viewDirectionW, normalW, diffuseRightColor.a, diffuseLeftColor.a);\r\n\r\n\tdiffuseBase *= diffuseLeftColor.rgb * (1.0 - diffuseFresnelTerm) + diffuseFresnelTerm * diffuseRightColor.rgb;\r\n#endif\r\n\r\n\t// Composition\r\n\tvec3 finalDiffuse = clamp(diffuseBase * diffuseColor + emissiveColor + vAmbientColor, 0.0, 1.0) * baseColor.rgb;\r\n#ifdef SPECULARTERM\r\n\tvec3 finalSpecular = specularBase * specularColor;\r\n#else\r\n\tvec3 finalSpecular = vec3(0.0);\r\n#endif\r\n\r\n\tvec4 color = vec4(finalDiffuse * baseAmbientColor + finalSpecular + reflectionColor, alpha);\r\n\r\n#ifdef FOG\r\n\tfloat fog = CalcFogFactor();\r\n\tcolor.rgb = fog * color.rgb + (1.0 - fog) * vFogColor;\r\n#endif\r\n\r\n\tgl_FragColor = color;\r\n}",legacydefaultVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#define MAP_EXPLICIT\t0.\r\n#define MAP_SPHERICAL\t1.\r\n#define MAP_PLANAR\t\t2.\r\n#define MAP_CUBIC\t\t3.\r\n#define MAP_PROJECTION\t4.\r\n#define MAP_SKYBOX\t\t5.\r\n\r\n// Attributes\r\nattribute vec3 position;\r\nattribute vec3 normal;\r\n#ifdef UV1\r\nattribute vec2 uv;\r\n#endif\r\n#ifdef UV2\r\nattribute vec2 uv2;\r\n#endif\r\n#ifdef VERTEXCOLOR\r\nattribute vec4 color;\r\n#endif\r\n#ifdef BONES\r\nattribute vec4 matricesIndices;\r\nattribute vec4 matricesWeights;\r\n#endif\r\n\r\n// Uniforms\r\nuniform mat4 world;\r\nuniform mat4 view;\r\nuniform mat4 viewProjection;\r\n\r\n#ifdef DIFFUSE\r\nvarying vec2 vDiffuseUV;\r\nuniform mat4 diffuseMatrix;\r\nuniform vec2 vDiffuseInfos;\r\n#endif\r\n\r\n#ifdef AMBIENT\r\nvarying vec2 vAmbientUV;\r\nuniform mat4 ambientMatrix;\r\nuniform vec2 vAmbientInfos;\r\n#endif\r\n\r\n#ifdef OPACITY\r\nvarying vec2 vOpacityUV;\r\nuniform mat4 opacityMatrix;\r\nuniform vec2 vOpacityInfos;\r\n#endif\r\n\r\n#ifdef REFLECTION\r\nuniform vec3 vEyePosition;\r\nvarying vec3 vReflectionUVW;\r\nuniform vec3 vReflectionInfos;\r\nuniform mat4 reflectionMatrix;\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\nvarying vec2 vEmissiveUV;\r\nuniform vec2 vEmissiveInfos;\r\nuniform mat4 emissiveMatrix;\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\nvarying vec2 vSpecularUV;\r\nuniform vec2 vSpecularInfos;\r\nuniform mat4 specularMatrix;\r\n#endif\r\n\r\n#ifdef BUMP\r\nvarying vec2 vBumpUV;\r\nuniform vec2 vBumpInfos;\r\nuniform mat4 bumpMatrix;\r\n#endif\r\n\r\n#ifdef BONES\r\nuniform mat4 mBones[BonesPerMesh];\r\n#endif\r\n\r\n// Output\r\nvarying vec3 vPositionW;\r\nvarying vec3 vNormalW;\r\n\r\n#ifdef VERTEXCOLOR\r\nvarying vec4 vColor;\r\n#endif\r\n\r\n#ifdef CLIPPLANE\r\nuniform vec4 vClipPlane;\r\nvarying float fClipDistance;\r\n#endif\r\n\r\n#ifdef FOG\r\nvarying float fFogDistance;\r\n#endif\r\n\r\n#ifdef SHADOWS\r\n#ifdef LIGHT0\r\nuniform mat4 lightMatrix0;\r\nvarying vec4 vPositionFromLight0;\r\n#endif\r\n#ifdef LIGHT1\r\nuniform mat4 lightMatrix1;\r\nvarying vec4 vPositionFromLight1;\r\n#endif\r\n#ifdef LIGHT2\r\nuniform mat4 lightMatrix2;\r\nvarying vec4 vPositionFromLight2;\r\n#endif\r\n#ifdef LIGHT3\r\nuniform mat4 lightMatrix3;\r\nvarying vec4 vPositionFromLight3;\r\n#endif\r\n#endif\r\n\r\n#ifdef REFLECTION\r\nvec3 computeReflectionCoords(float mode, vec4 worldPos, vec3 worldNormal)\r\n{\r\n\tif (mode == MAP_SPHERICAL)\r\n\t{\r\n\t\tvec3 coords = vec3(view * vec4(worldNormal, 0.0));\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 1.0));\r\n\t}\r\n\telse if (mode == MAP_PLANAR)\r\n\t{\r\n\t\tvec3 viewDir = worldPos.xyz - vEyePosition;\r\n\t\tvec3 coords = normalize(reflect(viewDir, worldNormal));\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 1));\r\n\t}\r\n\telse if (mode == MAP_CUBIC)\r\n\t{\r\n\t\tvec3 viewDir = worldPos.xyz - vEyePosition;\r\n\t\tvec3 coords = reflect(viewDir, worldNormal);\r\n\r\n\t\treturn vec3(reflectionMatrix * vec4(coords, 0));\r\n\t}\r\n\telse if (mode == MAP_PROJECTION)\r\n\t{\r\n\t\treturn vec3(reflectionMatrix * (view * worldPos));\r\n\t}\r\n\telse if (mode == MAP_SKYBOX)\r\n\t{\r\n\t\treturn position;\r\n\t}\r\n\r\n\treturn vec3(0, 0, 0);\r\n}\r\n#endif\r\n\r\nvoid main(void) {\r\n\tmat4 finalWorld;\r\n\r\n#ifdef BONES\r\n\tmat4 m0 = mBones[int(matricesIndices.x)] * matricesWeights.x;\r\n\tmat4 m1 = mBones[int(matricesIndices.y)] * matricesWeights.y;\r\n\tmat4 m2 = mBones[int(matricesIndices.z)] * matricesWeights.z;\r\n\r\n#ifdef BONES4\r\n\tmat4 m3 = mBones[int(matricesIndices.w)] * matricesWeights.w;\r\n\tfinalWorld = world * (m0 + m1 + m2 + m3);\r\n#else\r\n\tfinalWorld = world * (m0 + m1 + m2);\r\n#endif \r\n\r\n#else\r\n\tfinalWorld = world;\r\n#endif\r\n\r\n\tgl_Position = viewProjection * finalWorld * vec4(position, 1.0);\r\n\r\n\tvec4 worldPos = finalWorld * vec4(position, 1.0);\r\n\tvPositionW = vec3(worldPos);\r\n\tvNormalW = normalize(vec3(finalWorld * vec4(normal, 0.0)));\r\n\r\n\t// Texture coordinates\r\n#ifndef UV1\r\n\tvec2 uv = vec2(0., 0.);\r\n#endif\r\n#ifndef UV2\r\n\tvec2 uv2 = vec2(0., 0.);\r\n#endif\r\n\r\n#ifdef DIFFUSE\r\n\tif (vDiffuseInfos.x == 0.)\r\n\t{\r\n\t\tvDiffuseUV = vec2(diffuseMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvDiffuseUV = vec2(diffuseMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef AMBIENT\r\n\tif (vAmbientInfos.x == 0.)\r\n\t{\r\n\t\tvAmbientUV = vec2(ambientMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvAmbientUV = vec2(ambientMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef OPACITY\r\n\tif (vOpacityInfos.x == 0.)\r\n\t{\r\n\t\tvOpacityUV = vec2(opacityMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvOpacityUV = vec2(opacityMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef REFLECTION\r\n\tvReflectionUVW = computeReflectionCoords(vReflectionInfos.x, vec4(vPositionW, 1.0), vNormalW);\r\n#endif\r\n\r\n#ifdef EMISSIVE\r\n\tif (vEmissiveInfos.x == 0.)\r\n\t{\r\n\t\tvEmissiveUV = vec2(emissiveMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvEmissiveUV = vec2(emissiveMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#if defined(SPECULAR) && defined(SPECULARTERM)\r\n\tif (vSpecularInfos.x == 0.)\r\n\t{\r\n\t\tvSpecularUV = vec2(specularMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvSpecularUV = vec2(specularMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n#ifdef BUMP\r\n\tif (vBumpInfos.x == 0.)\r\n\t{\r\n\t\tvBumpUV = vec2(bumpMatrix * vec4(uv, 1.0, 0.0));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvBumpUV = vec2(bumpMatrix * vec4(uv2, 1.0, 0.0));\r\n\t}\r\n#endif\r\n\r\n\t// Clip plane\r\n#ifdef CLIPPLANE\r\n\tfClipDistance = dot(worldPos, vClipPlane);\r\n#endif\r\n\r\n\t// Fog\r\n#ifdef FOG\r\n\tfFogDistance = (view * worldPos).z;\r\n#endif\r\n\r\n\t// Shadows\r\n#ifdef SHADOWS\r\n#ifdef LIGHT0\r\n\tvPositionFromLight0 = lightMatrix0 * worldPos;\r\n#endif\r\n#ifdef LIGHT1\r\n\tvPositionFromLight1 = lightMatrix1 * worldPos;\r\n#endif\r\n#ifdef LIGHT2\r\n\tvPositionFromLight2 = lightMatrix2 * worldPos;\r\n#endif\r\n#ifdef LIGHT3\r\n\tvPositionFromLight3 = lightMatrix3 * worldPos;\r\n#endif\r\n#endif\r\n\r\n\t// Vertex color\r\n#ifdef VERTEXCOLOR\r\n\tvColor = color;\r\n#endif\r\n}",lensFlarePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\n// Color\r\nuniform vec4 color;\r\n\r\nvoid main(void) {\r\n\tvec4 baseColor = texture2D(textureSampler, vUV);\r\n\r\n\tgl_FragColor = baseColor * color;\r\n}",lensFlareVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec2 position;\r\n\r\n// Uniforms\r\nuniform mat4 viewportMatrix;\r\n\r\n// Output\r\nvarying vec2 vUV;\r\n\r\nconst vec2 madd = vec2(0.5, 0.5);\r\n\r\nvoid main(void) {\t\r\n\r\n\tvUV = position * madd + madd;\r\n\tgl_Position = viewportMatrix * vec4(position, 0.0, 1.0);\r\n}",lensHighlightsPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// samplers\r\nuniform sampler2D textureSampler;\t// original color\r\n\r\n// uniforms\r\nuniform float gain;\r\nuniform float threshold;\r\nuniform bool pentagon;\r\nuniform float screen_width;\r\nuniform float screen_height;\r\n\r\n// varyings\r\nvarying vec2 vUV;\r\n\r\n// apply luminance filter\r\nvec4 highlightColor(vec4 color) {\r\n\tvec4 highlight = color;\r\n\tfloat luminance = dot(highlight.rgb, vec3(0.2125, 0.7154, 0.0721));\r\n\tfloat lum_threshold;\r\n\tif (threshold > 1.0) { lum_threshold = 0.94 + 0.01 * threshold; }\r\n\telse { lum_threshold = 0.5 + 0.44 * threshold; }\r\n\r\n\tluminance = clamp((luminance - lum_threshold) * (1.0 / (1.0 - lum_threshold)), 0.0, 1.0);\r\n\r\n\thighlight *= luminance * gain;\r\n\thighlight.a = 1.0;\r\n\r\n\treturn highlight;\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tvec4 original = texture2D(textureSampler, vUV);\r\n\r\n\t// quick exit if no highlight computing\r\n\tif (gain == -1.0) {\r\n\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n\t\treturn;\r\n\t}\r\n\r\n\tfloat w = 2.0 / screen_width;\r\n\tfloat h = 2.0 / screen_height;\r\n\r\n\tfloat weight = 1.0;\r\n\r\n\t// compute blurred color\r\n\tvec4 blurred = vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n\tif (pentagon) {\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.84*w, 0.43*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.48*w, -1.29*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.61*w, 1.51*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.55*w, -0.74*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.71*w, -0.52*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.94*w, 1.59*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.40*w, -1.87*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.62*w, 1.16*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.09*w, 0.25*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.46*w, -1.71*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.08*w, 2.42*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.85*w, -1.89*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.89*w, 0.16*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.29*w, 1.88*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.40*w, -2.81*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.54*w, 2.26*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.60*w, -0.61*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.31*w, -1.30*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.83*w, 2.53*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.12*w, -2.48*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.60*w, 1.11*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.82*w, 0.99*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.50*w, -2.81*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.85*w, 3.33*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.94*w, -1.92*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(3.27*w, -0.53*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.95*w, 2.48*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.23*w, -3.04*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.17*w, 2.05*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.97*w, -0.04*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.25*w, -2.00*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.31*w, 3.08*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.94*w, -2.59*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(3.37*w, 0.64*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-3.13*w, 1.93*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.03*w, -3.65*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.60*w, 3.17*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-3.14*w, -1.19*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(3.00*w, -1.19*h)));\r\n\t}\r\n\telse {\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.85*w, 0.36*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.52*w, -1.14*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.46*w, 1.42*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.46*w, -0.83*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.79*w, -0.42*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.11*w, 1.62*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.29*w, -2.07*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.69*w, 1.39*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.28*w, 0.12*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.65*w, -1.69*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.08*w, 2.44*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.63*w, -1.90*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.55*w, 0.31*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.13*w, 1.52*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.56*w, -2.61*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.38*w, 2.34*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.64*w, -0.81*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.53*w, -1.21*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.06*w, 2.63*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.00*w, -2.69*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.59*w, 1.32*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.82*w, 0.78*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.57*w, -2.50*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(0.54*w, 2.93*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.39*w, -1.81*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(3.01*w, -0.28*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.04*w, 2.25*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.02*w, -3.05*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.09*w, 2.25*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-3.07*w, -0.25*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.44*w, -1.90*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-0.52*w, 3.05*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-1.68*w, -2.61*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(3.01*w, 0.79*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.76*w, 1.46*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.05*w, -2.94*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(1.21*w, 2.88*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(-2.84*w, -1.30*h)));\r\n\t\tblurred += highlightColor(texture2D(textureSampler, vUV + vec2(2.98*w, -0.96*h)));\r\n\t}\r\n\r\n\tblurred /= 39.0;\r\n\r\n\tgl_FragColor = blurred;\r\n\r\n\t//if(vUV.x > 0.5) { gl_FragColor.rgb *= 0.0; }\r\n}",linePixelShader:"precision highp float;\r\n\r\nuniform vec4 color;\r\n\r\nvoid main(void) {\r\n\tgl_FragColor = color;\r\n}",lineVertexShader:"precision highp float;\r\n\r\n// Attributes\r\nattribute vec3 position;\r\nattribute vec4 normal;\r\n\r\n// Uniforms\r\nuniform mat4 worldViewProjection;\r\n\r\nuniform float width;\r\nuniform float aspectRatio;\r\n\r\nvoid main(void) {\r\n\tvec4 viewPosition = worldViewProjection * vec4(position, 1.0);\r\n\tvec4 viewPositionNext = worldViewProjection * vec4(normal.xyz, 1.0);\r\n\r\n\tvec2 currentScreen = viewPosition.xy / viewPosition.w;\r\n\tvec2 nextScreen = viewPositionNext.xy / viewPositionNext.w;\r\n\r\n\tcurrentScreen.x *= aspectRatio;\r\n\tnextScreen.x *= aspectRatio;\r\n\r\n\tvec2 dir = normalize(nextScreen - currentScreen);\r\n\tvec2 normalDir = vec2(-dir.y, dir.x);\r\n\r\n\tnormalDir *= width / 2.0;\r\n\tnormalDir.x /= aspectRatio;\r\n\r\n\tvec4 offset = vec4(normalDir * normal.w, 0.0, 0.0);\r\n\tgl_Position = viewPosition + offset;\r\n}",marblePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vUV;\r\n\r\nuniform float numberOfTilesHeight;\r\nuniform float numberOfTilesWidth;\r\nuniform float amplitude;\r\nuniform vec3 brickColor;\r\nuniform vec3 jointColor;\r\n\r\nconst vec3 tileSize = vec3(1.1, 1.0, 1.1);\r\nconst vec3 tilePct = vec3(0.98, 1.0, 0.98);\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat turbulence(vec2 P)\r\n{\r\n\tfloat val = 0.0;\r\n\tfloat freq = 1.0;\r\n\tfor (int i = 0; i < 4; i++)\r\n\t{\r\n\t\tval += abs(noise(P*freq) / freq);\r\n\t\tfreq *= 2.07;\r\n\t}\r\n\treturn val;\r\n}\r\n\r\nfloat round(float number){\r\n\treturn sign(number)*floor(abs(number) + 0.5);\r\n}\r\n\r\nvec3 marble_color(float x)\r\n{\r\n\tvec3 col;\r\n\tx = 0.5*(x + 1.);\r\n\tx = sqrt(x);             \r\n\tx = sqrt(x);\r\n\tx = sqrt(x);\r\n\tcol = vec3(.2 + .75*x);  \r\n\tcol.b *= 0.95;           \r\n\treturn col;\r\n}\r\n\r\nvoid main()\r\n{\r\n\tfloat brickW = 1.0 / numberOfTilesWidth;\r\n\tfloat brickH = 1.0 / numberOfTilesHeight;\r\n\tfloat jointWPercentage = 0.01;\r\n\tfloat jointHPercentage = 0.01;\r\n\tvec3 color = brickColor;\r\n\tfloat yi = vUV.y / brickH;\r\n\tfloat nyi = round(yi);\r\n\tfloat xi = vUV.x / brickW;\r\n\r\n\tif (mod(floor(yi), 2.0) == 0.0){\r\n\t\txi = xi - 0.5;\r\n\t}\r\n\r\n\tfloat nxi = round(xi);\r\n\tvec2 brickvUV = vec2((xi - floor(xi)) / brickH, (yi - floor(yi)) / brickW);\r\n\r\n\tif (yi < nyi + jointHPercentage && yi > nyi - jointHPercentage){\r\n\t\tcolor = mix(jointColor, vec3(0.37, 0.25, 0.25), (yi - nyi) / jointHPercentage + 0.2);\r\n\t}\r\n\telse if (xi < nxi + jointWPercentage && xi > nxi - jointWPercentage){\r\n\t\tcolor = mix(jointColor, vec3(0.44, 0.44, 0.44), (xi - nxi) / jointWPercentage + 0.2);\r\n\t}\r\n\telse {\r\n\t\tfloat t = 6.28 * brickvUV.x / (tileSize.x + noise(vec2(vUV)*6.0));\r\n\t\tt += amplitude * turbulence(brickvUV.xy);\r\n\t\tt = sin(t);\r\n\t\tcolor = marble_color(t);\r\n\t}\r\n\r\n\tgl_FragColor = vec4(color, 0.0);\r\n}",outlinePixelShader:"precision highp float;\r\n\r\nuniform vec4 color;\r\n\r\n#ifdef ALPHATEST\r\nvarying vec2 vUV;\r\nuniform sampler2D diffuseSampler;\r\n#endif\r\n\r\nvoid main(void) {\r\n#ifdef ALPHATEST\r\n\tif (texture2D(diffuseSampler, vUV).a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\r\n\tgl_FragColor = color;\r\n}",outlineVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attribute\r\nattribute vec3 position;\r\nattribute vec3 normal;\r\n\r\n#ifdef BONES\r\nattribute vec4 matricesIndices;\r\nattribute vec4 matricesWeights;\r\n#endif\r\n\r\n// Uniform\r\nuniform float offset;\r\n\r\n#ifdef INSTANCES\r\nattribute vec4 world0;\r\nattribute vec4 world1;\r\nattribute vec4 world2;\r\nattribute vec4 world3;\r\n#else\r\nuniform mat4 world;\r\n#endif\r\n\r\nuniform mat4 viewProjection;\r\n#ifdef BONES\r\nuniform mat4 mBones[BonesPerMesh];\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\nvarying vec2 vUV;\r\nuniform mat4 diffuseMatrix;\r\n#ifdef UV1\r\nattribute vec2 uv;\r\n#endif\r\n#ifdef UV2\r\nattribute vec2 uv2;\r\n#endif\r\n#endif\r\n\r\nvoid main(void)\r\n{\r\n#ifdef INSTANCES\r\n\tmat4 finalWorld = mat4(world0, world1, world2, world3);\r\n#else\r\n\tmat4 finalWorld = world;\r\n#endif\r\n\r\n\tvec3 offsetPosition = position + normal * offset;\r\n\r\n#ifdef BONES\r\n\tmat4 m0 = mBones[int(matricesIndices.x)] * matricesWeights.x;\r\n\tmat4 m1 = mBones[int(matricesIndices.y)] * matricesWeights.y;\r\n\tmat4 m2 = mBones[int(matricesIndices.z)] * matricesWeights.z;\r\n\tmat4 m3 = mBones[int(matricesIndices.w)] * matricesWeights.w;\r\n\tfinalWorld = finalWorld * (m0 + m1 + m2 + m3);\r\n\tgl_Position = viewProjection * finalWorld * vec4(offsetPosition, 1.0);\r\n#else\r\n\tgl_Position = viewProjection * finalWorld * vec4(offsetPosition, 1.0);\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\n#ifdef UV1\r\n\tvUV = vec2(diffuseMatrix * vec4(uv, 1.0, 0.0));\r\n#endif\r\n#ifdef UV2\r\n\tvUV = vec2(diffuseMatrix * vec4(uv2, 1.0, 0.0));\r\n#endif\r\n#endif\r\n}",particlesPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nvarying vec4 vColor;\r\nuniform vec4 textureMask;\r\nuniform sampler2D diffuseSampler;\r\n\r\n#ifdef CLIPPLANE\r\nvarying float fClipDistance;\r\n#endif\r\n\r\nvoid main(void) {\r\n#ifdef CLIPPLANE\r\n\tif (fClipDistance > 0.0)\r\n\t\tdiscard;\r\n#endif\r\n\tvec4 baseColor = texture2D(diffuseSampler, vUV);\r\n\r\n\tgl_FragColor = (baseColor * textureMask + (vec4(1., 1., 1., 1.) - textureMask)) * vColor;\r\n}",particlesVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec3 position;\r\nattribute vec4 color;\r\nattribute vec4 options;\r\n\r\n// Uniforms\r\nuniform mat4 view;\r\nuniform mat4 projection;\r\n\r\n// Output\r\nvarying vec2 vUV;\r\nvarying vec4 vColor;\r\n\r\n#ifdef CLIPPLANE\r\nuniform vec4 vClipPlane;\r\nuniform mat4 invView;\r\nvarying float fClipDistance;\r\n#endif\r\n\r\nvoid main(void) {\t\r\n\tvec3 viewPos = (view * vec4(position, 1.0)).xyz; \r\n\tvec3 cornerPos;\r\n\tfloat size = options.y;\r\n\tfloat angle = options.x;\r\n\tvec2 offset = options.zw;\r\n\r\n\tcornerPos = vec3(offset.x - 0.5, offset.y  - 0.5, 0.) * size;\r\n\r\n\t// Rotate\r\n\tvec3 rotatedCorner;\r\n\trotatedCorner.x = cornerPos.x * cos(angle) - cornerPos.y * sin(angle);\r\n\trotatedCorner.y = cornerPos.x * sin(angle) + cornerPos.y * cos(angle);\r\n\trotatedCorner.z = 0.;\r\n\r\n\t// Position\r\n\tviewPos += rotatedCorner;\r\n\tgl_Position = projection * vec4(viewPos, 1.0);   \r\n\t\r\n\tvColor = color;\r\n\tvUV = offset;\r\n\r\n\t// Clip plane\r\n#ifdef CLIPPLANE\r\n\tvec4 worldPos = invView * vec4(viewPos, 1.0);\r\n\tfClipDistance = dot(worldPos, vClipPlane);\r\n#endif\r\n}",passPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\nvoid main(void) \r\n{\r\n\tgl_FragColor = texture2D(textureSampler, vUV);\r\n}",postprocessVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec2 position;\r\n\r\n// Output\r\nvarying vec2 vUV;\r\n\r\nconst vec2 madd = vec2(0.5, 0.5);\r\n\r\nvoid main(void) {\t\r\n\r\n\tvUV = position * madd + madd;\r\n\tgl_Position = vec4(position, 0.0, 1.0);\r\n}",proceduralVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec2 position;\r\n\r\n// Output\r\nvarying vec2 vPosition;\r\nvarying vec2 vUV;\r\n\r\nconst vec2 madd = vec2(0.5, 0.5);\r\n\r\nvoid main(void) {\t\r\n\tvPosition = position;\r\n\tvUV = position * madd + madd;\r\n\tgl_Position = vec4(position, 0.0, 1.0);\r\n}",refractionPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D refractionSampler;\r\n\r\n// Parameters\r\nuniform vec3 baseColor;\r\nuniform float depth;\r\nuniform float colorLevel;\r\n\r\nvoid main() {\r\n\tfloat ref = 1.0 - texture2D(refractionSampler, vUV).r;\r\n\r\n\tvec2 uv = vUV - vec2(0.5);\r\n\tvec2 offset = uv * depth * ref;\r\n\tvec3 sourceColor = texture2D(textureSampler, vUV - offset).rgb;\r\n\r\n\tgl_FragColor = vec4(sourceColor + sourceColor * ref * colorLevel, 1.0);\r\n}",roadPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vUV;                    \r\nuniform vec3 roadColor;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nvoid main(void) {\r\n\tfloat ratioy = mod(gl_FragCoord.y * 100.0 , fbm(vUV * 2.0));\r\n\tvec3 color = roadColor * ratioy;\r\n\tgl_FragColor = vec4(color, 1.0);\r\n}",shadowMapPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvec4 pack(float depth)\r\n{\r\n\tconst vec4 bit_shift = vec4(255.0 * 255.0 * 255.0, 255.0 * 255.0, 255.0, 1.0);\r\n\tconst vec4 bit_mask = vec4(0.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\r\n\r\n\tvec4 res = fract(depth * bit_shift);\r\n\tres -= res.xxyz * bit_mask;\r\n\r\n\treturn res;\r\n}\r\n\r\n// Thanks to http://devmaster.net/\r\nvec2 packHalf(float depth) \r\n{ \r\n\tconst vec2 bitOffset = vec2(1.0 / 255., 0.);\r\n\tvec2 color = vec2(depth, fract(depth * 255.));\r\n\r\n\treturn color - (color.yy * bitOffset);\r\n}\r\n\r\nvarying vec4 vPosition;\r\n\r\n#ifdef ALPHATEST\r\nvarying vec2 vUV;\r\nuniform sampler2D diffuseSampler;\r\n#endif\r\n\r\nvoid main(void)\r\n{\r\n#ifdef ALPHATEST\r\n\tif (texture2D(diffuseSampler, vUV).a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\tfloat depth = vPosition.z / vPosition.w;\r\n\tdepth = depth * 0.5 + 0.5;\r\n\r\n#ifdef VSM\r\n\tfloat moment1 = depth;\r\n\tfloat moment2 = moment1 * moment1;\r\n\r\n\tgl_FragColor = vec4(packHalf(moment1), packHalf(moment2));\r\n#else\r\n\tgl_FragColor = pack(depth);\r\n#endif\r\n}",shadowMapVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attribute\r\nattribute vec3 position;\r\n#ifdef BONES\r\nattribute vec4 matricesIndices;\r\nattribute vec4 matricesWeights;\r\n#endif\r\n\r\n// Uniform\r\n#ifdef INSTANCES\r\nattribute vec4 world0;\r\nattribute vec4 world1;\r\nattribute vec4 world2;\r\nattribute vec4 world3;\r\n#else\r\nuniform mat4 world;\r\n#endif\r\n\r\nuniform mat4 viewProjection;\r\n#ifdef BONES\r\nuniform mat4 mBones[BonesPerMesh];\r\n#endif\r\n\r\nvarying vec4 vPosition;\r\n\r\n#ifdef ALPHATEST\r\nvarying vec2 vUV;\r\nuniform mat4 diffuseMatrix;\r\n#ifdef UV1\r\nattribute vec2 uv;\r\n#endif\r\n#ifdef UV2\r\nattribute vec2 uv2;\r\n#endif\r\n#endif\r\n\r\nvoid main(void)\r\n{\r\n#ifdef INSTANCES\r\n\tmat4 finalWorld = mat4(world0, world1, world2, world3);\r\n#else\r\n\tmat4 finalWorld = world;\r\n#endif\r\n\r\n#ifdef BONES\r\n\tmat4 m0 = mBones[int(matricesIndices.x)] * matricesWeights.x;\r\n\tmat4 m1 = mBones[int(matricesIndices.y)] * matricesWeights.y;\r\n\tmat4 m2 = mBones[int(matricesIndices.z)] * matricesWeights.z;\r\n\tmat4 m3 = mBones[int(matricesIndices.w)] * matricesWeights.w;\r\n\tfinalWorld = finalWorld * (m0 + m1 + m2 + m3);\r\n#endif\r\n\r\n\tvPosition = viewProjection * finalWorld * vec4(position, 1.0);\r\n\tgl_Position = vPosition;\r\n\r\n#ifdef ALPHATEST\r\n#ifdef UV1\r\n\tvUV = vec2(diffuseMatrix * vec4(uv, 1.0, 0.0));\r\n#endif\r\n#ifdef UV2\r\n\tvUV = vec2(diffuseMatrix * vec4(uv2, 1.0, 0.0));\r\n#endif\r\n#endif\r\n}",spritesPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform bool alphaTest;\r\n\r\nvarying vec4 vColor;\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D diffuseSampler;\r\n\r\n// Fog\r\n#ifdef FOG\r\n\r\n#define FOGMODE_NONE    0.\r\n#define FOGMODE_EXP     1.\r\n#define FOGMODE_EXP2    2.\r\n#define FOGMODE_LINEAR  3.\r\n#define E 2.71828\r\n\r\nuniform vec4 vFogInfos;\r\nuniform vec3 vFogColor;\r\nvarying float fFogDistance;\r\n\r\nfloat CalcFogFactor()\r\n{\r\n\tfloat fogCoeff = 1.0;\r\n\tfloat fogStart = vFogInfos.y;\r\n\tfloat fogEnd = vFogInfos.z;\r\n\tfloat fogDensity = vFogInfos.w;\r\n\r\n\tif (FOGMODE_LINEAR == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = (fogEnd - fFogDistance) / (fogEnd - fogStart);\r\n\t}\r\n\telse if (FOGMODE_EXP == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fogDensity);\r\n\t}\r\n\telse if (FOGMODE_EXP2 == vFogInfos.x)\r\n\t{\r\n\t\tfogCoeff = 1.0 / pow(E, fFogDistance * fFogDistance * fogDensity * fogDensity);\r\n\t}\r\n\r\n\treturn min(1., max(0., fogCoeff));\r\n}\r\n#endif\r\n\r\n\r\nvoid main(void) {\r\n\tvec4 baseColor = texture2D(diffuseSampler, vUV);\r\n\r\n\tif (alphaTest) \r\n\t{\r\n\t\tif (baseColor.a < 0.95)\r\n\t\t\tdiscard;\r\n\t}\r\n\r\n\tbaseColor *= vColor;\r\n\r\n#ifdef FOG\r\n\tfloat fog = CalcFogFactor();\r\n\tbaseColor.rgb = fog * baseColor.rgb + (1.0 - fog) * vFogColor;\r\n#endif\r\n\r\n\tgl_FragColor = baseColor;\r\n}",spritesVertexShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Attributes\r\nattribute vec4 position;\r\nattribute vec4 options;\r\nattribute vec4 cellInfo;\r\nattribute vec4 color;\r\n\r\n// Uniforms\r\nuniform vec2 textureInfos;\r\nuniform mat4 view;\r\nuniform mat4 projection;\r\n\r\n// Output\r\nvarying vec2 vUV;\r\nvarying vec4 vColor;\r\n\r\n#ifdef FOG\r\nvarying float fFogDistance;\r\n#endif\r\n\r\nvoid main(void) {\t\r\n\tvec3 viewPos = (view * vec4(position.xyz, 1.0)).xyz; \r\n\tvec2 cornerPos;\r\n\t\r\n\tfloat angle = position.w;\r\n\tvec2 size = vec2(options.x, options.y);\r\n\tvec2 offset = options.zw;\r\n\tvec2 uvScale = textureInfos.xy;\r\n\r\n\tcornerPos = vec2(offset.x - 0.5, offset.y  - 0.5) * size;\r\n\r\n\t// Rotate\r\n\tvec3 rotatedCorner;\r\n\trotatedCorner.x = cornerPos.x * cos(angle) - cornerPos.y * sin(angle);\r\n\trotatedCorner.y = cornerPos.x * sin(angle) + cornerPos.y * cos(angle);\r\n\trotatedCorner.z = 0.;\r\n\r\n\t// Position\r\n\tviewPos += rotatedCorner;\r\n\tgl_Position = projection * vec4(viewPos, 1.0);   \r\n\r\n\t// Color\r\n\tvColor = color;\r\n\t\r\n\t// Texture\r\n\tvec2 uvOffset = vec2(abs(offset.x - cellInfo.x), 1.0 - abs(offset.y - cellInfo.y));\r\n\r\n\tvUV = (uvOffset + cellInfo.zw) * uvScale;\r\n\r\n\t// Fog\r\n#ifdef FOG\r\n\tfFogDistance = viewPos.z;\r\n#endif\r\n}",ssaoPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#define SAMPLES 16\r\n\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D randomSampler;\r\n\r\nuniform float randTextureTiles;\r\nuniform float samplesFactor;\r\nuniform vec3 sampleSphere[16];\r\n\r\nuniform float totalStrength;\r\nuniform float radius;\r\nuniform float area;\r\nuniform float fallOff;\r\n\r\nvarying vec2 vUV;\r\n\r\nconst vec2 offset1 = vec2(0.0, 0.001);\r\nconst vec2 offset2 = vec2(0.001, 0.0);\r\n\r\nvec3 normalFromDepth(const float depth, const vec2 coords) {\r\n\tfloat depth1 = texture2D(textureSampler, coords + offset1).r;\r\n\tfloat depth2 = texture2D(textureSampler, coords + offset2).r;\r\n\r\n    vec3 p1 = vec3(offset1, depth1 - depth);\r\n    vec3 p2 = vec3(offset2, depth2 - depth);\r\n\r\n    vec3 normal = cross(p1, p2);\r\n    normal.z = -normal.z;\r\n\r\n    return normalize(normal);\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tconst float base = 0.2;\r\n\r\n\tvec3 random = texture2D(randomSampler, vUV * randTextureTiles).rgb;\r\n\tfloat depth = texture2D(textureSampler, vUV).r;\r\n\tvec3 position = vec3(vUV, depth);\r\n\tvec3 normal = normalFromDepth(depth, vUV);\r\n\tfloat radiusDepth = radius / depth;\r\n\tfloat occlusion = 0.0;\r\n\r\n\tvec3 ray;\r\n\tvec3 hemiRay;\r\n\tfloat occlusionDepth;\r\n\tfloat difference;\r\n\r\n\tfor (int i = 0; i < SAMPLES; i++)\r\n\t{\r\n\t\tray = radiusDepth * reflect(sampleSphere[i], random);\r\n\t\themiRay = position + sign(dot(ray, normal)) * ray;\r\n\r\n\t\tocclusionDepth = texture2D(textureSampler, clamp(hemiRay.xy, 0.0, 1.0)).r;\r\n\t\tdifference = depth - occlusionDepth;\r\n\r\n\t\tocclusion += step(fallOff, difference) * (1.0 - smoothstep(fallOff, area, difference));\r\n\t}\r\n\r\n\tfloat ao = 1.0 - totalStrength * occlusion * samplesFactor;\r\n\r\n\tfloat result = clamp(ao + base, 0.0, 1.0);\r\n\tgl_FragColor.r = result;\r\n\tgl_FragColor.g = result;\r\n\tgl_FragColor.b = result;\r\n\tgl_FragColor.a = 1.0;\r\n}\r\n",ssaoCombinePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D originalColor;\r\n\r\nvarying vec2 vUV;\r\n\r\nvoid main(void) {\r\n\tgl_FragColor = texture2D(originalColor, vUV) * texture2D(textureSampler, vUV);\r\n}\r\n",stereoscopicInterlacePixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nconst vec3 TWO = vec3(2.0, 2.0, 2.0);\r\n\r\nvarying vec2 vUV;\r\nuniform sampler2D camASampler;\r\nuniform sampler2D textureSampler;\r\nuniform vec2 stepSize;\r\n\r\nvoid main(void)\r\n{\r\n    bool useCamB;\r\n    vec2 texCoord1;\r\n    vec2 texCoord2;\r\n    \r\n    vec3 frag1;\r\n    vec3 frag2;\r\n    \r\n#ifdef IS_STEREOSCOPIC_HORIZ\r\n\t    useCamB = vUV.x > 0.5;\r\n\t    texCoord1 = vec2(useCamB ? (vUV.x - 0.5) * 2.0 : vUV.x * 2.0, vUV.y);\r\n\t    texCoord2 = vec2(texCoord1.x + stepSize.x, vUV.y);\r\n#else\r\n\t    useCamB = vUV.y > 0.5;\r\n\t    texCoord1 = vec2(vUV.x, useCamB ? (vUV.y - 0.5) * 2.0 : vUV.y * 2.0);\r\n\t    texCoord2 = vec2(vUV.x, texCoord1.y + stepSize.y);\r\n#endif\r\n    \r\n    // cannot assign a sampler to a variable, so must duplicate texture accesses\r\n    if (useCamB){\r\n        frag1 = texture2D(textureSampler, texCoord1).rgb;\r\n        frag2 = texture2D(textureSampler, texCoord2).rgb;\r\n    }else{\r\n        frag1 = texture2D(camASampler   , texCoord1).rgb;\r\n        frag2 = texture2D(camASampler   , texCoord2).rgb;\r\n    }\r\n    \r\n    gl_FragColor = vec4((frag1 + frag2) / TWO, 1.0);\r\n}",tonemapPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\n\r\n// Constants\r\nuniform float _ExposureAdjustment;\r\n\r\n#if defined(HABLE_TONEMAPPING)\r\n    const float A = 0.15;\r\n    const float B = 0.50;\r\n    const float C = 0.10;\r\n    const float D = 0.20;\r\n    const float E = 0.02;\r\n    const float F = 0.30;\r\n    const float W = 11.2;\r\n#endif\r\n\r\nfloat Luminance(vec3 c)\r\n{\r\n    return dot(c, vec3(0.22, 0.707, 0.071));\r\n}\r\n\r\nvoid main(void) \r\n{\r\n    vec3 colour = texture2D(textureSampler, vUV).rgb;\r\n\r\n#if defined(REINHARD_TONEMAPPING)\r\n\r\n    float lum = Luminance(colour.rgb); \r\n    float lumTm = lum * _ExposureAdjustment;\r\n    float scale = lumTm / (1.0 + lumTm);  \r\n\r\n    colour *= scale / lum;\r\n\r\n#elif defined(HABLE_TONEMAPPING)\r\n\r\n    colour *= _ExposureAdjustment;\r\n\r\n    const float ExposureBias = 2.0;\r\n    vec3 x = ExposureBias * colour;\r\n\r\n    vec3 curr = ((x * (A * x + C * B) + D * E) / (x * (A * x + B) + D * F)) - E / F;\r\n    \r\n    x = vec3(W, W, W);\r\n    vec3 whiteScale = 1.0 / (((x * (A * x + C * B) + D * E) / (x * (A * x + B) + D * F)) - E / F);\r\n    colour = curr * whiteScale;\r\n\r\n#elif defined(OPTIMIZED_HEJIDAWSON_TONEMAPPING)\r\n\r\n    colour *= _ExposureAdjustment;\r\n    \r\n    vec3 X = max(vec3(0.0, 0.0, 0.0), colour - 0.004);\r\n    vec3 retColor = (X * (6.2 * X + 0.5)) / (X * (6.2 * X + 1.7) + 0.06);\r\n\r\n    colour = retColor * retColor;\r\n\r\n#elif defined(PHOTOGRAPHIC_TONEMAPPING)\r\n\r\n    colour =  vec3(1.0, 1.0, 1.0) - exp2(-_ExposureAdjustment * colour);\r\n\r\n#endif\r\n\r\n\tgl_FragColor = vec4(colour.rgb, 1.0);\r\n}",volumetricLightScatteringPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform sampler2D textureSampler;\r\nuniform sampler2D lightScatteringSampler;\r\n\r\nuniform float decay;\r\nuniform float exposure;\r\nuniform float weight;\r\nuniform float density;\r\nuniform vec2 meshPositionOnScreen;\r\n\r\nvarying vec2 vUV;\r\n\r\nvoid main(void) {\r\n    vec2 tc = vUV;\r\n\tvec2 deltaTexCoord = (tc - meshPositionOnScreen.xy);\r\n    deltaTexCoord *= 1.0 / float(NUM_SAMPLES) * density;\r\n\r\n    float illuminationDecay = 1.0;\r\n\r\n\tvec4 color = texture2D(lightScatteringSampler, tc) * 0.4;\r\n\r\n    for(int i=0; i < NUM_SAMPLES; i++) {\r\n        tc -= deltaTexCoord;\r\n\t\tvec4 sample = texture2D(lightScatteringSampler, tc) * 0.4;\r\n        sample *= illuminationDecay * weight;\r\n        color += sample;\r\n        illuminationDecay *= decay;\r\n    }\r\n\r\n    vec4 realColor = texture2D(textureSampler, vUV);\r\n    gl_FragColor = ((vec4((vec3(color.r, color.g, color.b) * exposure), 1)) + (realColor * (1.5 - 0.4)));\r\n}\r\n",volumetricLightScatteringPassPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n#if defined(ALPHATEST) || defined(NEED_UV)\r\nvarying vec2 vUV;\r\n#endif\r\n\r\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\r\nuniform sampler2D diffuseSampler;\r\n#endif\r\n\r\n#if defined(DIFFUSE_COLOR_RENDER)\r\nuniform vec3 color;\r\n#endif\r\n\r\n#if defined(OPACITY)\r\nuniform sampler2D opacitySampler;\r\nuniform float opacityLevel;\r\n#endif\r\n\r\nvoid main(void)\r\n{\r\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\r\n\tvec4 diffuseColor = texture2D(diffuseSampler, vUV);\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\n\tif (diffuseColor.a < 0.4)\r\n\t\tdiscard;\r\n#endif\r\n\r\n#ifdef OPACITY\r\n\tvec4 opacityColor = texture2D(opacitySampler, vUV);\r\n\tfloat alpha = 1.0;\r\n\r\n\t#ifdef OPACITYRGB\r\n\topacityColor.rgb = opacityColor.rgb * vec3(0.3, 0.59, 0.11);\r\n\talpha *= (opacityColor.x + opacityColor.y + opacityColor.z) * opacityLevel;\r\n\t#else\r\n\talpha *= opacityColor.a * opacityLevel;\r\n\t#endif\r\n\r\n\t#if defined(BASIC_RENDER)\r\n\tgl_FragColor = vec4(diffuseColor.rgb, alpha);\r\n\t#elif defined(DIFFUSE_COLOR_RENDER)\r\n\tgl_FragColor = vec4(color.rgb, alpha);\r\n\t#else\r\n\tgl_FragColor = vec4(0.0, 0.0, 0.0, alpha);\r\n\t#endif\r\n\r\n\tgl_FragColor.a = alpha;\r\n#else\r\n\r\n\t#if defined(BASIC_RENDER)\r\n\tgl_FragColor = diffuseColor;\r\n\t#elif defined(DIFFUSE_COLOR_RENDER)\r\n\tgl_FragColor = vec4(color.rgb, 1.0);\r\n\t#else\r\n\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n\t#endif\r\n#endif\r\n\r\n}\r\n",vrDistortionCorrectionPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n// Samplers\r\nvarying vec2 vUV;\r\nuniform sampler2D textureSampler;\r\nuniform vec2 LensCenter;\r\nuniform vec2 Scale;\r\nuniform vec2 ScaleIn;\r\nuniform vec4 HmdWarpParam;\r\n\r\nvec2 HmdWarp(vec2 in01) {\r\n\r\n\tvec2 theta = (in01 - LensCenter) * ScaleIn; // Scales to [-1, 1]\r\n\tfloat rSq = theta.x * theta.x + theta.y * theta.y;\r\n\tvec2 rvector = theta * (HmdWarpParam.x + HmdWarpParam.y * rSq + HmdWarpParam.z * rSq * rSq + HmdWarpParam.w * rSq * rSq * rSq);\r\n\treturn LensCenter + Scale * rvector;\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tvec2 tc = HmdWarp(vUV);\r\n\tif (tc.x <0.0 || tc.x>1.0 || tc.y<0.0 || tc.y>1.0)\r\n\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n\telse{\r\n\t\tgl_FragColor = vec4(texture2D(textureSampler, tc).rgb, 1.0);\r\n\t}\r\n}",woodPixelShader:"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vUV;\r\n\r\nuniform float ampScale;\r\nuniform vec3 woodColor;\r\n\r\nfloat rand(vec2 n) {\r\n\treturn fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 n) {\r\n\tconst vec2 d = vec2(0.0, 1.0);\r\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\r\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\r\n}\r\n\r\nfloat fbm(vec2 n) {\r\n\tfloat total = 0.0, amplitude = 1.0;\r\n\tfor (int i = 0; i < 4; i++) {\r\n\t\ttotal += noise(n) * amplitude;\r\n\t\tn += n;\r\n\t\tamplitude *= 0.5;\r\n\t}\r\n\treturn total;\r\n}\r\n\r\nvoid main(void) {\r\n\tfloat ratioy = mod(vUV.x * ampScale, 2.0 + fbm(vUV * 0.8));\r\n\tvec3 wood = woodColor * ratioy;\r\n\tgl_FragColor = vec4(wood, 1.0);\r\n}"};BABYLON.CollisionWorker='var BABYLON;!function(t){var e=function(t,e,o,i){return t.x>o.x+i?!1:o.x-i>e.x?!1:t.y>o.y+i?!1:o.y-i>e.y?!1:t.z>o.z+i?!1:o.z-i>e.z?!1:!0},o=function(t,e,o,i){var s=e*e-4*t*o,r={root:0,found:!1};if(0>s)return r;var n=Math.sqrt(s),c=(-e-n)/(2*t),h=(-e+n)/(2*t);if(c>h){var a=h;h=c,c=a}return c>0&&i>c?(r.root=c,r.found=!0,r):h>0&&i>h?(r.root=h,r.found=!0,r):r},i=function(){function i(){this.radius=new t.Vector3(1,1,1),this.retry=0,this.basePointWorld=t.Vector3.Zero(),this.velocityWorld=t.Vector3.Zero(),this.normalizedVelocity=t.Vector3.Zero(),this._collisionPoint=t.Vector3.Zero(),this._planeIntersectionPoint=t.Vector3.Zero(),this._tempVector=t.Vector3.Zero(),this._tempVector2=t.Vector3.Zero(),this._tempVector3=t.Vector3.Zero(),this._tempVector4=t.Vector3.Zero(),this._edge=t.Vector3.Zero(),this._baseToVertex=t.Vector3.Zero(),this._destinationPoint=t.Vector3.Zero(),this._slidePlaneNormal=t.Vector3.Zero(),this._displacementVector=t.Vector3.Zero()}return i.prototype._initialize=function(e,o,i){this.velocity=o,t.Vector3.NormalizeToRef(o,this.normalizedVelocity),this.basePoint=e,e.multiplyToRef(this.radius,this.basePointWorld),o.multiplyToRef(this.radius,this.velocityWorld),this.velocityWorldLength=this.velocityWorld.length(),this.epsilon=i,this.collisionFound=!1},i.prototype._checkPointInTriangle=function(e,o,i,s,r){o.subtractToRef(e,this._tempVector),i.subtractToRef(e,this._tempVector2),t.Vector3.CrossToRef(this._tempVector,this._tempVector2,this._tempVector4);var n=t.Vector3.Dot(this._tempVector4,r);return 0>n?!1:(s.subtractToRef(e,this._tempVector3),t.Vector3.CrossToRef(this._tempVector2,this._tempVector3,this._tempVector4),n=t.Vector3.Dot(this._tempVector4,r),0>n?!1:(t.Vector3.CrossToRef(this._tempVector3,this._tempVector,this._tempVector4),n=t.Vector3.Dot(this._tempVector4,r),n>=0))},i.prototype._canDoCollision=function(o,i,s,r){var n=t.Vector3.Distance(this.basePointWorld,o),c=Math.max(this.radius.x,this.radius.y,this.radius.z);return n>this.velocityWorldLength+c+i?!1:e(s,r,this.basePointWorld,this.velocityWorldLength+c)?!0:!1},i.prototype._testTriangle=function(e,i,s,r,n,c){var h,a=!1;i||(i=[]),i[e]||(i[e]=new t.Plane(0,0,0,0),i[e].copyFromPoints(s,r,n));var l=i[e];if(c||l.isFrontFacingTo(this.normalizedVelocity,0)){var _=l.signedDistanceTo(this.basePoint),d=t.Vector3.Dot(l.normal,this.velocity);if(0==d){if(Math.abs(_)>=1)return;a=!0,h=0}else{h=(-1-_)/d;var V=(1-_)/d;if(h>V){var u=V;V=h,h=u}if(h>1||0>V)return;0>h&&(h=0),h>1&&(h=1)}this._collisionPoint.copyFromFloats(0,0,0);var P=!1,p=1;if(a||(this.basePoint.subtractToRef(l.normal,this._planeIntersectionPoint),this.velocity.scaleToRef(h,this._tempVector),this._planeIntersectionPoint.addInPlace(this._tempVector),this._checkPointInTriangle(this._planeIntersectionPoint,s,r,n,l.normal)&&(P=!0,p=h,this._collisionPoint.copyFrom(this._planeIntersectionPoint))),!P){var m=this.velocity.lengthSquared(),f=m;this.basePoint.subtractToRef(s,this._tempVector);var T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p);y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(s)),this.basePoint.subtractToRef(r,this._tempVector),T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p),y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(r)),this.basePoint.subtractToRef(n,this._tempVector),T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p),y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(n)),r.subtractToRef(s,this._edge),s.subtractToRef(this.basePoint,this._baseToVertex);var g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex);if(f=g*-m+v*v,T=2*g*t.Vector3.Dot(this.velocity,this._baseToVertex)-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found){var D=(v*y.root-R)/g;D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),s.addToRef(this._edge,this._collisionPoint))}n.subtractToRef(r,this._edge),r.subtractToRef(this.basePoint,this._baseToVertex),g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex),f=g*-m+v*v,T=2*g*t.Vector3.Dot(this.velocity,this._baseToVertex)-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found&&(D=(v*y.root-R)/g,D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),r.addToRef(this._edge,this._collisionPoint))),s.subtractToRef(n,this._edge),n.subtractToRef(this.basePoint,this._baseToVertex),g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex),f=g*-m+v*v,T=2*g*t.Vector3.Dot(this.velocity,this._baseToVertex)-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found&&(D=(v*y.root-R)/g,D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),n.addToRef(this._edge,this._collisionPoint)))}if(P){var x=p*this.velocity.length();(!this.collisionFound||x<this.nearestDistance)&&(this.intersectionPoint?this.intersectionPoint.copyFrom(this._collisionPoint):this.intersectionPoint=this._collisionPoint.clone(),this.nearestDistance=x,this.collisionFound=!0)}}},i.prototype._collide=function(t,e,o,i,s,r,n){for(var c=i;s>c;c+=3){var h=e[o[c]-r],a=e[o[c+1]-r],l=e[o[c+2]-r];this._testTriangle(c,t,l,a,h,n)}},i.prototype._getResponse=function(e,o){e.addToRef(o,this._destinationPoint),o.scaleInPlace(this.nearestDistance/o.length()),this.basePoint.addToRef(o,e),e.subtractToRef(this.intersectionPoint,this._slidePlaneNormal),this._slidePlaneNormal.normalize(),this._slidePlaneNormal.scaleToRef(this.epsilon,this._displacementVector),e.addInPlace(this._displacementVector),this.intersectionPoint.addInPlace(this._displacementVector),this._slidePlaneNormal.scaleInPlace(t.Plane.SignedDistanceToPlaneFromPositionAndNormal(this.intersectionPoint,this._slidePlaneNormal,this._destinationPoint)),this._destinationPoint.subtractInPlace(this._slidePlaneNormal),this._destinationPoint.subtractToRef(this.intersectionPoint,o)},i}();t.Collider=i}(BABYLON||(BABYLON={}));var BABYLON;!function(o){o.WorkerIncluded=!0;var e=function(){function o(){this._meshes={},this._geometries={}}return o.prototype.getMeshes=function(){return this._meshes},o.prototype.getGeometries=function(){return this._geometries},o.prototype.getMesh=function(o){return this._meshes[o]},o.prototype.addMesh=function(o){this._meshes[o.uniqueId]=o},o.prototype.getGeometry=function(o){return this._geometries[o]},o.prototype.addGeometry=function(o){this._geometries[o.id]=o},o}();o.CollisionCache=e;var i=function(){function e(e,i,r){this.collider=e,this._collisionCache=i,this.finalPosition=r,this.collisionsScalingMatrix=o.Matrix.Zero(),this.collisionTranformationMatrix=o.Matrix.Zero()}return e.prototype.collideWithWorld=function(o,e,i,r){var t=.01;if(this.collider.retry>=i)return void this.finalPosition.copyFrom(o);this.collider._initialize(o,e,t);for(var s,l=this._collisionCache.getMeshes(),n=Object.keys(l),a=n.length,c=0;a>c;++c)if(s=n[c],parseInt(s)!=r){var d=l[s];d.checkCollisions&&this.checkCollision(d)}return this.collider.collisionFound?((0!==e.x||0!==e.y||0!==e.z)&&this.collider._getResponse(o,e),e.length()<=t?void this.finalPosition.copyFrom(o):(this.collider.retry++,void this.collideWithWorld(o,e,i,r))):void o.addToRef(e,this.finalPosition)},e.prototype.checkCollision=function(e){if(this.collider._canDoCollision(o.Vector3.FromArray(e.sphereCenter),e.sphereRadius,o.Vector3.FromArray(e.boxMinimum),o.Vector3.FromArray(e.boxMaximum))){o.Matrix.ScalingToRef(1/this.collider.radius.x,1/this.collider.radius.y,1/this.collider.radius.z,this.collisionsScalingMatrix);var i=o.Matrix.FromArray(e.worldMatrixFromCache);i.multiplyToRef(this.collisionsScalingMatrix,this.collisionTranformationMatrix),this.processCollisionsForSubMeshes(this.collisionTranformationMatrix,e)}},e.prototype.processCollisionsForSubMeshes=function(o,e){var i,r;if(r=e.subMeshes,i=r.length,!e.geometryId)return void console.log("no mesh geometry id");var t=this._collisionCache.getGeometry(e.geometryId);if(!t)return void console.log("couldn\'t find geometry",e.geometryId);for(var s=0;i>s;s++){var l=r[s];i>1&&!this.checkSubmeshCollision(l)||(this.collideForSubMesh(l,o,t),this.collider.collisionFound&&(this.collider.collidedMesh=e.uniqueId))}},e.prototype.collideForSubMesh=function(e,i,r){if(!r.positionsArray){r.positionsArray=[];for(var t=0,s=r.positions.length;s>t;t+=3){var l=o.Vector3.FromArray([r.positions[t],r.positions[t+1],r.positions[t+2]]);r.positionsArray.push(l)}}if(!e._lastColliderWorldVertices||!e._lastColliderTransformMatrix.equals(i)){e._lastColliderTransformMatrix=i.clone(),e._lastColliderWorldVertices=[],e._trianglePlanes=[];for(var n=e.verticesStart,a=e.verticesStart+e.verticesCount,t=n;a>t;t++)e._lastColliderWorldVertices.push(o.Vector3.TransformCoordinates(r.positionsArray[t],i))}this.collider._collide(e._trianglePlanes,e._lastColliderWorldVertices,r.indices,e.indexStart,e.indexStart+e.indexCount,e.verticesStart,e.hasMaterial)},e.prototype.checkSubmeshCollision=function(e){return this.collider._canDoCollision(o.Vector3.FromArray(e.sphereCenter),e.sphereRadius,o.Vector3.FromArray(e.boxMinimum),o.Vector3.FromArray(e.boxMaximum))},e}();o.CollideWorker=i;var r=function(){function r(){}return r.prototype.onInit=function(i){this._collisionCache=new e;var r={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.INIT};postMessage(r,void 0)},r.prototype.onUpdate=function(e){for(var i in e.updatedGeometries)e.updatedGeometries.hasOwnProperty(i)&&this._collisionCache.addGeometry(e.updatedGeometries[i]);for(var r in e.updatedMeshes)e.updatedMeshes.hasOwnProperty(r)&&this._collisionCache.addMesh(e.updatedMeshes[r]);var t={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.UPDATE};postMessage(t,void 0)},r.prototype.onCollision=function(e){var r=o.Vector3.Zero(),t=new o.Collider;t.radius=o.Vector3.FromArray(e.collider.radius);var s=new i(t,this._collisionCache,r);s.collideWithWorld(o.Vector3.FromArray(e.collider.position),o.Vector3.FromArray(e.collider.velocity),e.maximumRetry,e.excludedMeshUniqueId);var l={collidedMeshUniqueId:t.collidedMesh,collisionId:e.collisionId,newPosition:r.asArray()},n={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.COLLIDE,payload:l};postMessage(n,void 0)},r}();o.CollisionDetectorTransferable=r;try{if(self&&self instanceof WorkerGlobalScope){window={},o.Collider||(importScripts("./babylon.collisionCoordinator.js"),importScripts("./babylon.collider.js"),importScripts("../Math/babylon.math.js"));var t=new r,s=function(e){var i=e.data;switch(i.taskType){case o.WorkerTaskType.INIT:t.onInit(i.payload);break;case o.WorkerTaskType.COLLIDE:t.onCollision(i.payload);break;case o.WorkerTaskType.UPDATE:t.onUpdate(i.payload)}};self.onmessage=s}}catch(l){console.log("single worker init")}}(BABYLON||(BABYLON={}));var BABYLON;!function(e){e.CollisionWorker="",function(e){e[e.INIT=0]="INIT",e[e.UPDATE=1]="UPDATE",e[e.COLLIDE=2]="COLLIDE"}(e.WorkerTaskType||(e.WorkerTaskType={}));var o=e.WorkerTaskType;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR"}(e.WorkerReplyType||(e.WorkerReplyType={}));var i=e.WorkerReplyType,t=function(){function t(){var r=this;this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this.onMeshUpdated=function(e){r._addUpdateMeshesList[e.uniqueId]=t.SerializeMesh(e)},this.onGeometryUpdated=function(e){r._addUpdateGeometriesList[e.id]=t.SerializeGeometry(e)},this._afterRender=function(){if(r._init&&!(0==r._toRemoveGeometryArray.length&&0==r._toRemoveMeshesArray.length&&0==Object.keys(r._addUpdateGeometriesList).length&&0==Object.keys(r._addUpdateMeshesList).length||r._runningUpdated>4)){++r._runningUpdated;var e={updatedMeshes:r._addUpdateMeshesList,updatedGeometries:r._addUpdateGeometriesList,removedGeometries:r._toRemoveGeometryArray,removedMeshes:r._toRemoveMeshesArray},i={payload:e,taskType:o.UPDATE},t=[];for(var s in e.updatedGeometries)e.updatedGeometries.hasOwnProperty(s)&&(t.push(i.payload.updatedGeometries[s].indices.buffer),t.push(i.payload.updatedGeometries[s].normals.buffer),t.push(i.payload.updatedGeometries[s].positions.buffer));r._worker.postMessage(i,t),r._addUpdateMeshesList={},r._addUpdateGeometriesList={},r._toRemoveGeometryArray=[],r._toRemoveMeshesArray=[]}},this._onMessageFromWorker=function(t){var s=t.data;if(s.error!=i.SUCCESS)return void e.Tools.Warn("error returned from worker!");switch(s.taskType){case o.INIT:r._init=!0,r._scene.meshes.forEach(function(e){r.onMeshAdded(e)}),r._scene.getGeometries().forEach(function(e){r.onGeometryAdded(e)});break;case o.UPDATE:r._runningUpdated--;break;case o.COLLIDE:r._runningCollisionTask=!1;var n=s.payload;if(!r._collisionsCallbackArray[n.collisionId])return;r._collisionsCallbackArray[n.collisionId](n.collisionId,e.Vector3.FromArray(n.newPosition),r._scene.getMeshByUniqueID(n.collidedMeshUniqueId)),r._collisionsCallbackArray[n.collisionId]=void 0}},this._collisionsCallbackArray=[],this._init=!1,this._runningUpdated=0,this._runningCollisionTask=!1,this._addUpdateMeshesList={},this._addUpdateGeometriesList={},this._toRemoveGeometryArray=[],this._toRemoveMeshesArray=[]}return t.prototype.getNewPosition=function(e,i,t,r,s,n,a){if(this._init&&!this._collisionsCallbackArray[a]&&!this._collisionsCallbackArray[a+1e5]){e.divideToRef(t.radius,this._scaledPosition),i.divideToRef(t.radius,this._scaledVelocity),this._collisionsCallbackArray[a]=n;var d={collider:{position:this._scaledPosition.asArray(),velocity:this._scaledVelocity.asArray(),radius:t.radius.asArray()},collisionId:a,excludedMeshUniqueId:s?s.uniqueId:null,maximumRetry:r},l={payload:d,taskType:o.COLLIDE};this._worker.postMessage(l)}},t.prototype.init=function(i){this._scene=i,this._scene.registerAfterRender(this._afterRender);var t=e.WorkerIncluded?e.Engine.CodeRepository+"Collisions/babylon.collisionWorker.js":URL.createObjectURL(new Blob([e.CollisionWorker],{type:"application/javascript"}));this._worker=new Worker(t),this._worker.onmessage=this._onMessageFromWorker;var r={payload:{},taskType:o.INIT};this._worker.postMessage(r)},t.prototype.destroy=function(){this._scene.unregisterAfterRender(this._afterRender),this._worker.terminate()},t.prototype.onMeshAdded=function(e){e.registerAfterWorldMatrixUpdate(this.onMeshUpdated),this.onMeshUpdated(e)},t.prototype.onMeshRemoved=function(e){this._toRemoveMeshesArray.push(e.uniqueId)},t.prototype.onGeometryAdded=function(e){e.onGeometryUpdated=this.onGeometryUpdated,this.onGeometryUpdated(e)},t.prototype.onGeometryDeleted=function(e){this._toRemoveGeometryArray.push(e.id)},t.SerializeMesh=function(o){var i=[];o.subMeshes&&(i=o.subMeshes.map(function(e,o){return{position:o,verticesStart:e.verticesStart,verticesCount:e.verticesCount,indexStart:e.indexStart,indexCount:e.indexCount,hasMaterial:!!e.getMaterial(),sphereCenter:e.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:e.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:e.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:e.getBoundingInfo().boundingBox.maximumWorld.asArray()}}));var t=null;return o instanceof e.Mesh?t=o.geometry?o.geometry.id:null:o instanceof e.InstancedMesh&&(t=o.sourceMesh.geometry?o.sourceMesh.geometry.id:null),{uniqueId:o.uniqueId,id:o.id,name:o.name,geometryId:t,sphereCenter:o.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:o.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:o.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:o.getBoundingInfo().boundingBox.maximumWorld.asArray(),worldMatrixFromCache:o.worldMatrixFromCache.asArray(),subMeshes:i,checkCollisions:o.checkCollisions}},t.SerializeGeometry=function(o){return{id:o.id,positions:new Float32Array(o.getVerticesData(e.VertexBuffer.PositionKind)||[]),normals:new Float32Array(o.getVerticesData(e.VertexBuffer.NormalKind)||[]),indices:new Int32Array(o.getIndices()||[])}},t}();e.CollisionCoordinatorWorker=t;var r=function(){function o(){this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this._finalPosition=e.Vector3.Zero()}return o.prototype.getNewPosition=function(e,o,i,t,r,s,n){e.divideToRef(i.radius,this._scaledPosition),o.divideToRef(i.radius,this._scaledVelocity),i.collidedMesh=null,i.retry=0,i.initialVelocity=this._scaledVelocity,i.initialPosition=this._scaledPosition,this._collideWithWorld(this._scaledPosition,this._scaledVelocity,i,t,this._finalPosition,r),this._finalPosition.multiplyInPlace(i.radius),s(n,this._finalPosition,i.collidedMesh)},o.prototype.init=function(e){this._scene=e},o.prototype.destroy=function(){},o.prototype.onMeshAdded=function(e){},o.prototype.onMeshUpdated=function(e){},o.prototype.onMeshRemoved=function(e){},o.prototype.onGeometryAdded=function(e){},o.prototype.onGeometryUpdated=function(e){},o.prototype.onGeometryDeleted=function(e){},o.prototype._collideWithWorld=function(o,i,t,r,s,n){void 0===n&&(n=null);var a=10*e.Engine.CollisionsEpsilon;if(t.retry>=r)return void s.copyFrom(o);t._initialize(o,i,a);for(var d=0;d<this._scene.meshes.length;d++){var l=this._scene.meshes[d];l.isEnabled()&&l.checkCollisions&&l.subMeshes&&l!==n&&l._checkCollision(t)}return t.collisionFound?((0!==i.x||0!==i.y||0!==i.z)&&t._getResponse(o,i),i.length()<=a?void s.copyFrom(o):(t.retry++,void this._collideWithWorld(o,i,t,r,s,n))):void o.addToRef(i,s)},o}();e.CollisionCoordinatorLegacy=r}(BABYLON||(BABYLON={}));var BABYLON;!function(t){var i=function(){function i(t,i,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),this.r=t,this.g=i,this.b=o}return i.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},i.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,this},i.prototype.toColor4=function(t){return void 0===t&&(t=1),new o(this.r,this.g,this.b,t)},i.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},i.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},i.prototype.multiply=function(t){return new i(this.r*t.r,this.g*t.g,this.b*t.b)},i.prototype.multiplyToRef=function(t,i){return i.r=this.r*t.r,i.g=this.g*t.g,i.b=this.b*t.b,this},i.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},i.prototype.equalsFloats=function(t,i,o){return this.r===t&&this.g===i&&this.b===o},i.prototype.scale=function(t){return new i(this.r*t,this.g*t,this.b*t)},i.prototype.scaleToRef=function(t,i){return i.r=this.r*t,i.g=this.g*t,i.b=this.b*t,this},i.prototype.add=function(t){return new i(this.r+t.r,this.g+t.g,this.b+t.b)},i.prototype.addToRef=function(t,i){return i.r=this.r+t.r,i.g=this.g+t.g,i.b=this.b+t.b,this},i.prototype.subtract=function(t){return new i(this.r-t.r,this.g-t.g,this.b-t.b)},i.prototype.subtractToRef=function(t,i){return i.r=this.r-t.r,i.g=this.g-t.g,i.b=this.b-t.b,this},i.prototype.clone=function(){return new i(this.r,this.g,this.b)},i.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},i.prototype.copyFromFloats=function(t,i,o){return this.r=t,this.g=i,this.b=o,this},i.prototype.toHexString=function(){var i=255*this.r|0,o=255*this.g|0,n=255*this.b|0;return"#"+t.Tools.ToHex(i)+t.Tools.ToHex(o)+t.Tools.ToHex(n)},i.FromHexString=function(o){if("#"!==o.substring(0,1)||7!==o.length)return t.Tools.Warn("Color3.FromHexString must be called with a string like #FFFFFF"),new i(0,0,0);var n=parseInt(o.substring(1,3),16),r=parseInt(o.substring(3,5),16),s=parseInt(o.substring(5,7),16);return i.FromInts(n,r,s)},i.FromArray=function(t,o){return void 0===o&&(o=0),new i(t[o],t[o+1],t[o+2])},i.FromInts=function(t,o,n){return new i(t/255,o/255,n/255)},i.Lerp=function(t,o,n){var r=t.r+(o.r-t.r)*n,s=t.g+(o.g-t.g)*n,e=t.b+(o.b-t.b)*n;return new i(r,s,e)},i.Red=function(){return new i(1,0,0)},i.Green=function(){return new i(0,1,0)},i.Blue=function(){return new i(0,0,1)},i.Black=function(){return new i(0,0,0)},i.White=function(){return new i(1,1,1)},i.Purple=function(){return new i(.5,0,.5)},i.Magenta=function(){return new i(1,0,1)},i.Yellow=function(){return new i(1,1,0)},i.Gray=function(){return new i(.5,.5,.5)},i}();t.Color3=i;var o=function(){function i(t,i,o,n){this.r=t,this.g=i,this.b=o,this.a=n}return i.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},i.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},i.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t[i+3]=this.a,this},i.prototype.add=function(t){return new i(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)},i.prototype.subtract=function(t){return new i(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)},i.prototype.subtractToRef=function(t,i){return i.r=this.r-t.r,i.g=this.g-t.g,i.b=this.b-t.b,i.a=this.a-t.a,this},i.prototype.scale=function(t){return new i(this.r*t,this.g*t,this.b*t,this.a*t)},i.prototype.scaleToRef=function(t,i){return i.r=this.r*t,i.g=this.g*t,i.b=this.b*t,i.a=this.a*t,this},i.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},i.prototype.clone=function(){return new i(this.r,this.g,this.b,this.a)},i.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},i.prototype.toHexString=function(){var i=255*this.r|0,o=255*this.g|0,n=255*this.b|0,r=255*this.a|0;return"#"+t.Tools.ToHex(i)+t.Tools.ToHex(o)+t.Tools.ToHex(n)+t.Tools.ToHex(r)},i.FromHexString=function(o){if("#"!==o.substring(0,1)||9!==o.length)return t.Tools.Warn("Color4.FromHexString must be called with a string like #FFFFFFFF"),new i(0,0,0,0);var n=parseInt(o.substring(1,3),16),r=parseInt(o.substring(3,5),16),s=parseInt(o.substring(5,7),16),e=parseInt(o.substring(7,9),16);return i.FromInts(n,r,s,e)},i.Lerp=function(t,o,n){var r=new i(0,0,0,0);return i.LerpToRef(t,o,n,r),r},i.LerpToRef=function(t,i,o,n){n.r=t.r+(i.r-t.r)*o,n.g=t.g+(i.g-t.g)*o,n.b=t.b+(i.b-t.b)*o,n.a=t.a+(i.a-t.a)*o},i.FromArray=function(t,o){return void 0===o&&(o=0),new i(t[o],t[o+1],t[o+2],t[o+3])},i.FromInts=function(t,o,n,r){return new i(t/255,o/255,n/255,r/255)},i}();t.Color4=o;var n=function(){function i(t,i){this.x=t,this.y=i}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},i.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,this},i.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},i.prototype.copyFromFloats=function(t,i){return this.x=t,this.y=i,this},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y)},i.prototype.addVector3=function(t){return new i(this.x+t.x,this.y+t.y)},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y)},i.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},i.prototype.multiply=function(t){return new i(this.x*t.x,this.y*t.y)},i.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,this},i.prototype.multiplyByFloats=function(t,o){return new i(this.x*t,this.y*o)},i.prototype.divide=function(t){return new i(this.x/t.x,this.y/t.y)},i.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,this},i.prototype.negate=function(){return new i(-this.x,-this.y)},i.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},i.prototype.scale=function(t){return new i(this.x*t,this.y*t)},i.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},i.prototype.equalsWithEpsilon=function(i,o){return void 0===o&&(o=t.Engine.Epsilon),i&&t.Tools.WithinEpsilon(this.x,i.x,o)&&t.Tools.WithinEpsilon(this.y,i.y,o)},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},i.prototype.normalize=function(){var t=this.length();if(0===t)return this;var i=1/t;return this.x*=i,this.y*=i,this},i.prototype.clone=function(){return new i(this.x,this.y)},i.Zero=function(){return new i(0,0)},i.FromArray=function(t,o){return void 0===o&&(o=0),new i(t[o],t[o+1])},i.FromArrayToRef=function(t,i,o){o.x=t[i],o.y=t[i+1]},i.CatmullRom=function(t,o,n,r,s){var e=s*s,a=s*e,h=.5*(2*o.x+(-t.x+n.x)*s+(2*t.x-5*o.x+4*n.x-r.x)*e+(-t.x+3*o.x-3*n.x+r.x)*a),u=.5*(2*o.y+(-t.y+n.y)*s+(2*t.y-5*o.y+4*n.y-r.y)*e+(-t.y+3*o.y-3*n.y+r.y)*a);return new i(h,u)},i.Clamp=function(t,o,n){var r=t.x;r=r>n.x?n.x:r,r=r<o.x?o.x:r;var s=t.y;return s=s>n.y?n.y:s,s=s<o.y?o.y:s,new i(r,s)},i.Hermite=function(t,o,n,r,s){var e=s*s,a=s*e,h=2*a-3*e+1,u=-2*a+3*e,l=a-2*e+s,m=a-e,f=t.x*h+n.x*u+o.x*l+r.x*m,x=t.y*h+n.y*u+o.y*l+r.y*m;return new i(f,x)},i.Lerp=function(t,o,n){var r=t.x+(o.x-t.x)*n,s=t.y+(o.y-t.y)*n;return new i(r,s)},i.Dot=function(t,i){return t.x*i.x+t.y*i.y},i.Normalize=function(t){var i=t.clone();return i.normalize(),i},i.Minimize=function(t,o){var n=t.x<o.x?t.x:o.x,r=t.y<o.y?t.y:o.y;return new i(n,r)},i.Maximize=function(t,o){var n=t.x>o.x?t.x:o.x,r=t.y>o.y?t.y:o.y;return new i(n,r)},i.Transform=function(t,o){var n=t.x*o.m[0]+t.y*o.m[4],r=t.x*o.m[1]+t.y*o.m[5];return new i(n,r)},i.Distance=function(t,o){return Math.sqrt(i.DistanceSquared(t,o))},i.DistanceSquared=function(t,i){var o=t.x-i.x,n=t.y-i.y;return o*o+n*n},i}();t.Vector2=n;var r=function(){function i(t,i,o){this.x=t,this.y=i,this.z=o}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"}"},i.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},i.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,this},i.prototype.toQuaternion=function(){var t=new e(0,0,0,1),i=Math.cos(.5*(this.x+this.z)),o=Math.sin(.5*(this.x+this.z)),n=Math.cos(.5*(this.z-this.x)),r=Math.sin(.5*(this.z-this.x)),s=Math.cos(.5*this.y),a=Math.sin(.5*this.y);return t.x=n*a,t.y=-r*a,t.z=o*s,t.w=i*s,t},i.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)},i.prototype.addToRef=function(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i.z=this.z+t.z,this},i.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)},i.prototype.subtractToRef=function(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i.z=this.z-t.z,this},i.prototype.subtractFromFloats=function(t,o,n){return new i(this.x-t,this.y-o,this.z-n)},i.prototype.subtractFromFloatsToRef=function(t,i,o,n){return n.x=this.x-t,n.y=this.y-i,n.z=this.z-o,this},i.prototype.negate=function(){return new i(-this.x,-this.y,-this.z)},i.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},i.prototype.scale=function(t){return new i(this.x*t,this.y*t,this.z*t)},i.prototype.scaleToRef=function(t,i){i.x=this.x*t,i.y=this.y*t,i.z=this.z*t},i.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},i.prototype.equalsWithEpsilon=function(i,o){return void 0===o&&(o=t.Engine.Epsilon),i&&t.Tools.WithinEpsilon(this.x,i.x,o)&&t.Tools.WithinEpsilon(this.y,i.y,o)&&t.Tools.WithinEpsilon(this.z,i.z,o)},i.prototype.equalsToFloats=function(t,i,o){return this.x===t&&this.y===i&&this.z===o},i.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},i.prototype.multiply=function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z)},i.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i.z=this.z*t.z,this},i.prototype.multiplyByFloats=function(t,o,n){return new i(this.x*t,this.y*o,this.z*n)},i.prototype.divide=function(t){return new i(this.x/t.x,this.y/t.y,this.z/t.z)},i.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i.z=this.z/t.z,this},i.prototype.MinimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),this},i.prototype.MaximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),this},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},i.prototype.normalize=function(){var t=this.length();if(0===t||1===t)return this;var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this},i.prototype.clone=function(){return new i(this.x,this.y,this.z)},i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.prototype.copyFromFloats=function(t,i,o){return this.x=t,this.y=i,this.z=o,this},i.GetClipFactor=function(t,o,n,r){var s=i.Dot(t,n)-r,e=i.Dot(o,n)-r,a=s/(s-e);return a},i.FromArray=function(t,o){return o||(o=0),new i(t[o],t[o+1],t[o+2])},i.FromFloatArray=function(t,o){return o||(o=0),new i(t[o],t[o+1],t[o+2])},i.FromArrayToRef=function(t,i,o){o.x=t[i],o.y=t[i+1],o.z=t[i+2]},i.FromFloatArrayToRef=function(t,i,o){o.x=t[i],o.y=t[i+1],o.z=t[i+2]},i.FromFloatsToRef=function(t,i,o,n){n.x=t,n.y=i,n.z=o},i.Zero=function(){return new i(0,0,0)},i.Up=function(){return new i(0,1,0)},i.TransformCoordinates=function(t,o){var n=i.Zero();return i.TransformCoordinatesToRef(t,o,n),n},i.TransformCoordinatesToRef=function(t,i,o){var n=t.x*i.m[0]+t.y*i.m[4]+t.z*i.m[8]+i.m[12],r=t.x*i.m[1]+t.y*i.m[5]+t.z*i.m[9]+i.m[13],s=t.x*i.m[2]+t.y*i.m[6]+t.z*i.m[10]+i.m[14],e=t.x*i.m[3]+t.y*i.m[7]+t.z*i.m[11]+i.m[15];o.x=n/e,o.y=r/e,o.z=s/e},i.TransformCoordinatesFromFloatsToRef=function(t,i,o,n,r){var s=t*n.m[0]+i*n.m[4]+o*n.m[8]+n.m[12],e=t*n.m[1]+i*n.m[5]+o*n.m[9]+n.m[13],a=t*n.m[2]+i*n.m[6]+o*n.m[10]+n.m[14],h=t*n.m[3]+i*n.m[7]+o*n.m[11]+n.m[15];r.x=s/h,r.y=e/h,r.z=a/h},i.TransformCoordinatesToRefSIMD=function(t,i,o){var n=SIMD.float32x4.loadXYZ(t._data,0),r=SIMD.float32x4.load(i.m,0),s=SIMD.float32x4.load(i.m,4),e=SIMD.float32x4.load(i.m,8),a=SIMD.float32x4.load(i.m,12),h=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(n,0,0,0,0),r),SIMD.float32x4.mul(SIMD.float32x4.swizzle(n,1,1,1,1),s)),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(n,2,2,2,2),e),a));h=SIMD.float32x4.div(h,SIMD.float32x4.swizzle(h,3,3,3,3)),SIMD.float32x4.storeXYZ(o._data,0,h)},i.TransformCoordinatesFromFloatsToRefSIMD=function(t,i,o,n,r){var s=SIMD.float32x4.splat(t),e=SIMD.float32x4.splat(i),a=SIMD.float32x4.splat(o),h=SIMD.float32x4.load(n.m,0),u=SIMD.float32x4.load(n.m,4),l=SIMD.float32x4.load(n.m,8),m=SIMD.float32x4.load(n.m,12),f=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(s,h),SIMD.float32x4.mul(e,u)),SIMD.float32x4.add(SIMD.float32x4.mul(a,l),m));f=SIMD.float32x4.div(f,SIMD.float32x4.swizzle(f,3,3,3,3)),SIMD.float32x4.storeXYZ(r._data,0,f)},i.TransformNormal=function(t,o){var n=i.Zero();return i.TransformNormalToRef(t,o,n),n},i.TransformNormalToRef=function(t,i,o){o.x=t.x*i.m[0]+t.y*i.m[4]+t.z*i.m[8],o.y=t.x*i.m[1]+t.y*i.m[5]+t.z*i.m[9],o.z=t.x*i.m[2]+t.y*i.m[6]+t.z*i.m[10]},i.TransformNormalFromFloatsToRef=function(t,i,o,n,r){r.x=t*n.m[0]+i*n.m[4]+o*n.m[8],r.y=t*n.m[1]+i*n.m[5]+o*n.m[9],r.z=t*n.m[2]+i*n.m[6]+o*n.m[10]},i.CatmullRom=function(t,o,n,r,s){var e=s*s,a=s*e,h=.5*(2*o.x+(-t.x+n.x)*s+(2*t.x-5*o.x+4*n.x-r.x)*e+(-t.x+3*o.x-3*n.x+r.x)*a),u=.5*(2*o.y+(-t.y+n.y)*s+(2*t.y-5*o.y+4*n.y-r.y)*e+(-t.y+3*o.y-3*n.y+r.y)*a),l=.5*(2*o.z+(-t.z+n.z)*s+(2*t.z-5*o.z+4*n.z-r.z)*e+(-t.z+3*o.z-3*n.z+r.z)*a);return new i(h,u,l)},i.Clamp=function(t,o,n){var r=t.x;r=r>n.x?n.x:r,r=r<o.x?o.x:r;var s=t.y;s=s>n.y?n.y:s,s=s<o.y?o.y:s;var e=t.z;return e=e>n.z?n.z:e,e=e<o.z?o.z:e,new i(r,s,e)},i.Hermite=function(t,o,n,r,s){var e=s*s,a=s*e,h=2*a-3*e+1,u=-2*a+3*e,l=a-2*e+s,m=a-e,f=t.x*h+n.x*u+o.x*l+r.x*m,x=t.y*h+n.y*u+o.y*l+r.y*m,y=t.z*h+n.z*u+o.z*l+r.z*m;return new i(f,x,y)},i.Lerp=function(t,o,n){var r=t.x+(o.x-t.x)*n,s=t.y+(o.y-t.y)*n,e=t.z+(o.z-t.z)*n;return new i(r,s,e)},i.Dot=function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},i.Cross=function(t,o){var n=i.Zero();return i.CrossToRef(t,o,n),n},i.CrossToRef=function(t,i,o){o.x=t.y*i.z-t.z*i.y,o.y=t.z*i.x-t.x*i.z,o.z=t.x*i.y-t.y*i.x},i.Normalize=function(t){var o=i.Zero();return i.NormalizeToRef(t,o),o},i.NormalizeToRef=function(t,i){i.copyFrom(t),i.normalize()},i.Project=function(t,o,n,r){var s=r.width,e=r.height,h=r.x,u=r.y,l=a.FromValues(s/2,0,0,0,0,-e/2,0,0,0,0,1,0,h+s/2,e/2+u,0,1),m=o.multiply(n).multiply(l);return i.TransformCoordinates(t,m)},i.UnprojectFromTransform=function(o,n,r,s,e){var a=s.multiply(e);a.invert(),o.x=o.x/n*2-1,o.y=-(o.y/r*2-1);var h=i.TransformCoordinates(o,a),u=o.x*a.m[3]+o.y*a.m[7]+o.z*a.m[11]+a.m[15];return t.Tools.WithinEpsilon(u,1)&&(h=h.scale(1/u)),h},i.Unproject=function(o,n,r,s,e,a){var h=s.multiply(e).multiply(a);h.invert();var u=new i(o.x/n*2-1,-(o.y/r*2-1),o.z),l=i.TransformCoordinates(u,h),m=u.x*h.m[3]+u.y*h.m[7]+u.z*h.m[11]+h.m[15];return t.Tools.WithinEpsilon(m,1)&&(l=l.scale(1/m)),l},i.Minimize=function(t,i){var o=t.clone();return o.MinimizeInPlace(i),o},i.Maximize=function(t,i){var o=t.clone();return o.MaximizeInPlace(i),o},i.Distance=function(t,o){return Math.sqrt(i.DistanceSquared(t,o))},i.DistanceSquared=function(t,i){var o=t.x-i.x,n=t.y-i.y,r=t.z-i.z;return o*o+n*n+r*r},i.Center=function(t,i){var o=t.add(i);return o.scaleInPlace(.5),o},i.RotationFromAxis=function(t,o,n){var r=i.Zero();return i.RotationFromAxisToRef(t,o,n,r),r},i.RotationFromAxisToRef=function(o,n,r,s){var e,a,h,u=i.Normalize(o),l=i.Normalize(r),m=f.X,x=f.Y,y=0,c=0,p=0,z=0,M=0,w=0,d=0,I=-1,D=0,S=0;t.Tools.WithinEpsilon(l.z,0,t.Engine.Epsilon)?w=1:t.Tools.WithinEpsilon(l.x,0,t.Engine.Epsilon)?z=1:(d=l.z/l.x,z=-d*Math.sqrt(1/(1+d*d)),w=Math.sqrt(1/(1+d*d))),a=new i(z,M,w),a.normalize(),h=i.Cross(l,a),h.normalize(),e=i.Cross(u,a),e.normalize(),i.Dot(l,e)<0&&(I=1),S=i.Dot(u,a),S=Math.min(1,Math.max(-1,S)),p=Math.acos(S)*I,i.Dot(a,m)<0&&(p=Math.PI+p,a=a.scaleInPlace(-1),h=h.scaleInPlace(-1),D++);var v,g;z=0,M=0,w=0,I=-1,t.Tools.WithinEpsilon(l.z,0,t.Engine.Epsilon)?z=1:(d=a.z/a.x,z=-d*Math.sqrt(1/(1+d*d)),w=Math.sqrt(1/(1+d*d))),v=new i(z,M,w),v.normalize(),g=i.Cross(v,a),g.normalize(),e=i.Cross(l,v),e.normalize(),i.Dot(a,e)<0&&(I=1),S=i.Dot(l,v),S=Math.min(1,Math.max(-1,S)),c=Math.acos(S)*I,i.Dot(g,x)<0&&(c=Math.PI+c,g=g.scaleInPlace(-1),v=v.scaleInPlace(-1),D++),I=-1,e=i.Cross(m,a),e.normalize(),i.Dot(e,x)<0&&(I=1),S=i.Dot(a,m),S=Math.min(1,Math.max(-1,S)),y=-Math.acos(S)*I,0>S&&2>D&&(y=Math.PI+y),s.x=c,s.y=y,s.z=p},i}();t.Vector3=r;var s=function(){function i(t,i,o,n){this.x=t,this.y=i,this.z=o,this.w=n}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"W:"+this.w+"}"},i.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},i.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,this},i.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},i.prototype.addToRef=function(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i.z=this.z+t.z,i.w=this.w+t.w,this},i.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},i.prototype.subtractToRef=function(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i.z=this.z-t.z,i.w=this.w-t.w,this},i.prototype.subtractFromFloats=function(t,o,n,r){return new i(this.x-t,this.y-o,this.z-n,this.w-r)},i.prototype.subtractFromFloatsToRef=function(t,i,o,n,r){return r.x=this.x-t,r.y=this.y-i,r.z=this.z-o,r.w=this.w-n,this},i.prototype.negate=function(){return new i(-this.x,-this.y,-this.z,-this.w)},i.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},i.prototype.scale=function(t){return new i(this.x*t,this.y*t,this.z*t,this.w*t)},i.prototype.scaleToRef=function(t,i){i.x=this.x*t,i.y=this.y*t,i.z=this.z*t,i.w=this.w*t},i.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},i.prototype.equalsWithEpsilon=function(i,o){return void 0===o&&(o=t.Engine.Epsilon),i&&t.Tools.WithinEpsilon(this.x,i.x,o)&&t.Tools.WithinEpsilon(this.y,i.y,o)&&t.Tools.WithinEpsilon(this.z,i.z,o)&&t.Tools.WithinEpsilon(this.w,i.w,o)},i.prototype.equalsToFloats=function(t,i,o,n){return this.x===t&&this.y===i&&this.z===o&&this.w===n},i.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},i.prototype.multiply=function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},i.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i.z=this.z*t.z,i.w=this.w*t.w,this},i.prototype.multiplyByFloats=function(t,o,n,r){return new i(this.x*t,this.y*o,this.z*n,this.w*r)},i.prototype.divide=function(t){return new i(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)},i.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i.z=this.z/t.z,i.w=this.w/t.w,this},i.prototype.MinimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},i.prototype.MaximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},i.prototype.normalize=function(){var t=this.length();if(0===t)return this;var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this},i.prototype.clone=function(){return new i(this.x,this.y,this.z,this.w)},i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},i.prototype.copyFromFloats=function(t,i,o,n){return this.x=t,this.y=i,this.z=o,this.w=n,this},i.FromArray=function(t,o){return o||(o=0),new i(t[o],t[o+1],t[o+2],t[o+3])},i.FromArrayToRef=function(t,i,o){o.x=t[i],o.y=t[i+1],o.z=t[i+2],o.w=t[i+3]},i.FromFloatArrayToRef=function(t,i,o){o.x=t[i],o.y=t[i+1],o.z=t[i+2],o.w=t[i+3]},i.FromFloatsToRef=function(t,i,o,n,r){r.x=t,r.y=i,r.z=o,r.w=n},i.Zero=function(){return new i(0,0,0,0)},i.Normalize=function(t){var o=i.Zero();return i.NormalizeToRef(t,o),o},i.NormalizeToRef=function(t,i){i.copyFrom(t),i.normalize()},i.Minimize=function(t,i){var o=t.clone();return o.MinimizeInPlace(i),o},i.Maximize=function(t,i){var o=t.clone();return o.MaximizeInPlace(i),o},i.Distance=function(t,o){return Math.sqrt(i.DistanceSquared(t,o))},i.DistanceSquared=function(t,i){var o=t.x-i.x,n=t.y-i.y,r=t.z-i.z,s=t.w-i.w;return o*o+n*n+r*r+s*s},i.Center=function(t,i){var o=t.add(i);return o.scaleInPlace(.5),o},i}();t.Vector4=s;var e=function(){function t(t,i,o,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===n&&(n=1),this.x=t,this.y=i,this.z=o,this.w=n}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,i,o,n){return this.x=t,this.y=i,this.z=o,this.w=n,this},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y,this.z+i.z,this.w+i.w)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y,this.z-i.z,this.w-i.w)},t.prototype.scale=function(i){return new t(this.x*i,this.y*i,this.z*i,this.w*i)},t.prototype.multiply=function(i){var o=new t(0,0,0,1);return this.multiplyToRef(i,o),o},t.prototype.multiplyToRef=function(t,i){var o=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,n=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,r=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,s=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return i.copyFromFloats(o,n,r,s),this},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.toEulerAngles=function(){var t=r.Zero();return this.toEulerAnglesToRef(t),t},t.prototype.toEulerAnglesToRef=function(t){var i=this.x,o=this.y,n=this.z,r=this.w,s=i*o,e=i*n,a=r*o,h=r*n,u=r*i,l=o*n,m=i*i,f=o*o,x=m+f;return 0!==x&&1!==x?(t.x=Math.atan2(e+a,u-l),t.y=Math.acos(1-2*x),t.z=Math.atan2(e-a,u+l)):0===x?(t.x=0,t.y=0,t.z=Math.atan2(s-h,.5-f-n*n)):(t.x=Math.atan2(s-h,.5-f-n*n),t.y=Math.PI,t.z=0),this},t.prototype.toRotationMatrix=function(t){var i=this.x*this.x,o=this.y*this.y,n=this.z*this.z,r=this.x*this.y,s=this.z*this.w,e=this.z*this.x,a=this.y*this.w,h=this.y*this.z,u=this.x*this.w;return t.m[0]=1-2*(o+n),t.m[1]=2*(r+s),t.m[2]=2*(e-a),t.m[3]=0,t.m[4]=2*(r-s),t.m[5]=1-2*(n+i),t.m[6]=2*(h+u),t.m[7]=0,t.m[8]=2*(e+a),t.m[9]=2*(h-u),t.m[10]=1-2*(o+i),t.m[11]=0,t.m[12]=0,t.m[13]=0,t.m[14]=0,t.m[15]=1,this},t.prototype.fromRotationMatrix=function(i){return t.FromRotationMatrixToRef(i,this),this},t.FromRotationMatrix=function(i){var o=new t;return t.FromRotationMatrixToRef(i,o),o},t.FromRotationMatrixToRef=function(t,i){var o,n=t.m,r=n[0],s=n[4],e=n[8],a=n[1],h=n[5],u=n[9],l=n[2],m=n[6],f=n[10],x=r+h+f;x>0?(o=.5/Math.sqrt(x+1),i.w=.25/o,i.x=(m-u)*o,i.y=(e-l)*o,i.z=(a-s)*o):r>h&&r>f?(o=2*Math.sqrt(1+r-h-f),i.w=(m-u)/o,i.x=.25*o,i.y=(s+a)/o,i.z=(e+l)/o):h>f?(o=2*Math.sqrt(1+h-r-f),i.w=(e-l)/o,i.x=(s+a)/o,i.y=.25*o,i.z=(u+m)/o):(o=2*Math.sqrt(1+f-r-h),i.w=(a-s)/o,i.x=(e+l)/o,i.y=(u+m)/o,i.z=.25*o)},t.Inverse=function(i){return new t(-i.x,-i.y,-i.z,i.w)},t.Identity=function(){return new t(0,0,0,1)},t.RotationAxis=function(i,o){var n=new t,r=Math.sin(o/2);return n.w=Math.cos(o/2),n.x=i.x*r,n.y=i.y*r,n.z=i.z*r,n},t.FromArray=function(i,o){return o||(o=0),new t(i[o],i[o+1],i[o+2],i[o+3])},t.RotationYawPitchRoll=function(i,o,n){var r=new t;return t.RotationYawPitchRollToRef(i,o,n,r),r},t.RotationYawPitchRollToRef=function(t,i,o,n){var r=.5*o,s=.5*i,e=.5*t,a=Math.sin(r),h=Math.cos(r),u=Math.sin(s),l=Math.cos(s),m=Math.sin(e),f=Math.cos(e);n.x=f*u*h+m*l*a,n.y=m*l*h-f*u*a,n.z=f*l*a-m*u*h,n.w=f*l*h+m*u*a},t.RotationAlphaBetaGamma=function(i,o,n){var r=new t;return t.RotationAlphaBetaGammaToRef(i,o,n,r),r},t.RotationAlphaBetaGammaToRef=function(t,i,o,n){var r=.5*(o+t),s=.5*(o-t),e=.5*i;n.x=Math.cos(s)*Math.sin(e),n.y=Math.sin(s)*Math.sin(e),n.z=Math.sin(r)*Math.cos(e),n.w=Math.cos(r)*Math.cos(e)},t.Slerp=function(i,o,n){var r,s,e=n,a=i.x*o.x+i.y*o.y+i.z*o.z+i.w*o.w,h=!1;if(0>a&&(h=!0,a=-a),a>.999999)s=1-e,r=h?-e:e;else{var u=Math.acos(a),l=1/Math.sin(u);s=Math.sin((1-e)*u)*l,r=h?-Math.sin(e*u)*l:Math.sin(e*u)*l}return new t(s*i.x+r*o.x,s*i.y+r*o.y,s*i.z+r*o.z,s*i.w+r*o.w)},t}();t.Quaternion=e;var a=function(){function i(){this.m=new Float32Array(16)}return i.prototype.isIdentity=function(){return 1!==this.m[0]||1!==this.m[5]||1!==this.m[10]||1!==this.m[15]?!1:0!==this.m[1]||0!==this.m[2]||0!==this.m[3]||0!==this.m[4]||0!==this.m[6]||0!==this.m[7]||0!==this.m[8]||0!==this.m[9]||0!==this.m[11]||0!==this.m[12]||0!==this.m[13]||0!==this.m[14]?!1:!0},i.prototype.determinant=function(){var t=this.m[10]*this.m[15]-this.m[11]*this.m[14],i=this.m[9]*this.m[15]-this.m[11]*this.m[13],o=this.m[9]*this.m[14]-this.m[10]*this.m[13],n=this.m[8]*this.m[15]-this.m[11]*this.m[12],r=this.m[8]*this.m[14]-this.m[10]*this.m[12],s=this.m[8]*this.m[13]-this.m[9]*this.m[12];return this.m[0]*(this.m[5]*t-this.m[6]*i+this.m[7]*o)-this.m[1]*(this.m[4]*t-this.m[6]*n+this.m[7]*r)+this.m[2]*(this.m[4]*i-this.m[5]*n+this.m[7]*s)-this.m[3]*(this.m[4]*o-this.m[5]*r+this.m[6]*s)},i.prototype.toArray=function(){return this.m},i.prototype.asArray=function(){return this.toArray()},i.prototype.invert=function(){return this.invertToRef(this),this},i.prototype.reset=function(){for(var t=0;16>t;t++)this.m[t]=0;return this},i.prototype.add=function(t){var o=new i;return this.addToRef(t,o),o},i.prototype.addToRef=function(t,i){for(var o=0;16>o;o++)i.m[o]=this.m[o]+t.m[o];return this},i.prototype.addToSelf=function(t){for(var i=0;16>i;i++)this.m[i]+=t.m[i];return this},i.prototype.invertToRef=function(t){var i=this.m[0],o=this.m[1],n=this.m[2],r=this.m[3],s=this.m[4],e=this.m[5],a=this.m[6],h=this.m[7],u=this.m[8],l=this.m[9],m=this.m[10],f=this.m[11],x=this.m[12],y=this.m[13],c=this.m[14],p=this.m[15],z=m*p-f*c,M=l*p-f*y,w=l*c-m*y,d=u*p-f*x,I=u*c-m*x,D=u*y-l*x,S=e*z-a*M+h*w,v=-(s*z-a*d+h*I),g=s*M-e*d+h*D,T=-(s*w-e*I+a*D),R=1/(i*S+o*v+n*g+r*T),_=a*p-h*c,b=e*p-h*y,F=e*c-a*y,A=s*p-h*x,P=s*c-a*x,C=s*y-e*x,E=a*f-h*m,L=e*f-h*l,q=e*m-a*l,Z=s*f-h*u,H=s*m-a*u,W=s*l-e*u;return t.m[0]=S*R,t.m[4]=v*R,t.m[8]=g*R,t.m[12]=T*R,t.m[1]=-(o*z-n*M+r*w)*R,t.m[5]=(i*z-n*d+r*I)*R,t.m[9]=-(i*M-o*d+r*D)*R,t.m[13]=(i*w-o*I+n*D)*R,t.m[2]=(o*_-n*b+r*F)*R,t.m[6]=-(i*_-n*A+r*P)*R,t.m[10]=(i*b-o*A+r*C)*R,t.m[14]=-(i*F-o*P+n*C)*R,t.m[3]=-(o*E-n*L+r*q)*R,t.m[7]=(i*E-n*Z+r*H)*R,t.m[11]=-(i*L-o*Z+r*W)*R,t.m[15]=(i*q-o*H+n*W)*R,this},i.prototype.invertToRefSIMD=function(t){var i,o,n,r,s,e,a,h,u,l,m=this.m,f=t.m,x=SIMD.float32x4.load(m,0),y=SIMD.float32x4.load(m,4),c=SIMD.float32x4.load(m,8),p=SIMD.float32x4.load(m,12);return s=SIMD.float32x4.shuffle(x,y,0,1,4,5),o=SIMD.float32x4.shuffle(c,p,0,1,4,5),i=SIMD.float32x4.shuffle(s,o,0,2,4,6),o=SIMD.float32x4.shuffle(o,s,1,3,5,7),s=SIMD.float32x4.shuffle(x,y,2,3,6,7),r=SIMD.float32x4.shuffle(c,p,2,3,6,7),n=SIMD.float32x4.shuffle(s,r,0,2,4,6),r=SIMD.float32x4.shuffle(r,s,1,3,5,7),s=SIMD.float32x4.mul(n,r),s=SIMD.float32x4.swizzle(s,1,0,3,2),e=SIMD.float32x4.mul(o,s),a=SIMD.float32x4.mul(i,s),s=SIMD.float32x4.swizzle(s,2,3,0,1),e=SIMD.float32x4.sub(SIMD.float32x4.mul(o,s),e),a=SIMD.float32x4.sub(SIMD.float32x4.mul(i,s),a),a=SIMD.float32x4.swizzle(a,2,3,0,1),s=SIMD.float32x4.mul(o,n),s=SIMD.float32x4.swizzle(s,1,0,3,2),e=SIMD.float32x4.add(SIMD.float32x4.mul(r,s),e),u=SIMD.float32x4.mul(i,s),s=SIMD.float32x4.swizzle(s,2,3,0,1),e=SIMD.float32x4.sub(e,SIMD.float32x4.mul(r,s)),u=SIMD.float32x4.sub(SIMD.float32x4.mul(i,s),u),u=SIMD.float32x4.swizzle(u,2,3,0,1),s=SIMD.float32x4.mul(SIMD.float32x4.swizzle(o,2,3,0,1),r),s=SIMD.float32x4.swizzle(s,1,0,3,2),n=SIMD.float32x4.swizzle(n,2,3,0,1),e=SIMD.float32x4.add(SIMD.float32x4.mul(n,s),e),h=SIMD.float32x4.mul(i,s),s=SIMD.float32x4.swizzle(s,2,3,0,1),e=SIMD.float32x4.sub(e,SIMD.float32x4.mul(n,s)),h=SIMD.float32x4.sub(SIMD.float32x4.mul(i,s),h),h=SIMD.float32x4.swizzle(h,2,3,0,1),s=SIMD.float32x4.mul(i,o),s=SIMD.float32x4.swizzle(s,1,0,3,2),h=SIMD.float32x4.add(SIMD.float32x4.mul(r,s),h),u=SIMD.float32x4.sub(SIMD.float32x4.mul(n,s),u),s=SIMD.float32x4.swizzle(s,2,3,0,1),h=SIMD.float32x4.sub(SIMD.float32x4.mul(r,s),h),u=SIMD.float32x4.sub(u,SIMD.float32x4.mul(n,s)),s=SIMD.float32x4.mul(i,r),s=SIMD.float32x4.swizzle(s,1,0,3,2),a=SIMD.float32x4.sub(a,SIMD.float32x4.mul(n,s)),h=SIMD.float32x4.add(SIMD.float32x4.mul(o,s),h),s=SIMD.float32x4.swizzle(s,2,3,0,1),a=SIMD.float32x4.add(SIMD.float32x4.mul(n,s),a),h=SIMD.float32x4.sub(h,SIMD.float32x4.mul(o,s)),s=SIMD.float32x4.mul(i,n),s=SIMD.float32x4.swizzle(s,1,0,3,2),a=SIMD.float32x4.add(SIMD.float32x4.mul(r,s),a),u=SIMD.float32x4.sub(u,SIMD.float32x4.mul(o,s)),s=SIMD.float32x4.swizzle(s,2,3,0,1),a=SIMD.float32x4.sub(a,SIMD.float32x4.mul(r,s)),u=SIMD.float32x4.add(SIMD.float32x4.mul(o,s),u),l=SIMD.float32x4.mul(i,e),l=SIMD.float32x4.add(SIMD.float32x4.swizzle(l,2,3,0,1),l),l=SIMD.float32x4.add(SIMD.float32x4.swizzle(l,1,0,3,2),l),s=SIMD.float32x4.reciprocalApproximation(l),l=SIMD.float32x4.sub(SIMD.float32x4.add(s,s),SIMD.float32x4.mul(l,SIMD.float32x4.mul(s,s))),l=SIMD.float32x4.swizzle(l,0,0,0,0),e=SIMD.float32x4.mul(l,e),a=SIMD.float32x4.mul(l,a),h=SIMD.float32x4.mul(l,h),u=SIMD.float32x4.mul(l,u),SIMD.float32x4.store(f,0,e),SIMD.float32x4.store(f,4,a),SIMD.float32x4.store(f,8,h),SIMD.float32x4.store(f,12,u),this},i.prototype.setTranslation=function(t){return this.m[12]=t.x,this.m[13]=t.y,this.m[14]=t.z,this},i.prototype.multiply=function(t){var o=new i;return this.multiplyToRef(t,o),o},i.prototype.copyFrom=function(t){for(var i=0;16>i;i++)this.m[i]=t.m[i];return this},i.prototype.copyToArray=function(t,i){void 0===i&&(i=0);for(var o=0;16>o;o++)t[i+o]=this.m[o];return this},i.prototype.multiplyToRef=function(t,i){return this.multiplyToArray(t,i.m,0),this},i.prototype.multiplyToArray=function(t,i,o){var n=this.m[0],r=this.m[1],s=this.m[2],e=this.m[3],a=this.m[4],h=this.m[5],u=this.m[6],l=this.m[7],m=this.m[8],f=this.m[9],x=this.m[10],y=this.m[11],c=this.m[12],p=this.m[13],z=this.m[14],M=this.m[15],w=t.m[0],d=t.m[1],I=t.m[2],D=t.m[3],S=t.m[4],v=t.m[5],g=t.m[6],T=t.m[7],R=t.m[8],_=t.m[9],b=t.m[10],F=t.m[11],A=t.m[12],P=t.m[13],C=t.m[14],E=t.m[15];return i[o]=n*w+r*S+s*R+e*A,i[o+1]=n*d+r*v+s*_+e*P,i[o+2]=n*I+r*g+s*b+e*C,i[o+3]=n*D+r*T+s*F+e*E,i[o+4]=a*w+h*S+u*R+l*A,i[o+5]=a*d+h*v+u*_+l*P,i[o+6]=a*I+h*g+u*b+l*C,i[o+7]=a*D+h*T+u*F+l*E,i[o+8]=m*w+f*S+x*R+y*A,i[o+9]=m*d+f*v+x*_+y*P,i[o+10]=m*I+f*g+x*b+y*C,i[o+11]=m*D+f*T+x*F+y*E,i[o+12]=c*w+p*S+z*R+M*A,i[o+13]=c*d+p*v+z*_+M*P,i[o+14]=c*I+p*g+z*b+M*C,i[o+15]=c*D+p*T+z*F+M*E,this},i.prototype.multiplyToArraySIMD=function(t,i,o){void 0===o&&(o=0);var n=this.m,r=t.m,s=SIMD.float32x4.load(r,0),e=SIMD.float32x4.load(r,4),a=SIMD.float32x4.load(r,8),h=SIMD.float32x4.load(r,12),u=SIMD.float32x4.load(n,0);SIMD.float32x4.store(i,o+0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,1,1,1,1),e),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,3,3,3,3),h)))));\n\nvar l=SIMD.float32x4.load(n,4);SIMD.float32x4.store(i,o+4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,1,1,1,1),e),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,3,3,3,3),h)))));var m=SIMD.float32x4.load(n,8);SIMD.float32x4.store(i,o+8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(m,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(m,1,1,1,1),e),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(m,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(m,3,3,3,3),h)))));var f=SIMD.float32x4.load(n,12);SIMD.float32x4.store(i,o+12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,0,0,0,0),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,1,1,1,1),e),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,3,3,3,3),h)))))},i.prototype.equals=function(t){return t&&this.m[0]===t.m[0]&&this.m[1]===t.m[1]&&this.m[2]===t.m[2]&&this.m[3]===t.m[3]&&this.m[4]===t.m[4]&&this.m[5]===t.m[5]&&this.m[6]===t.m[6]&&this.m[7]===t.m[7]&&this.m[8]===t.m[8]&&this.m[9]===t.m[9]&&this.m[10]===t.m[10]&&this.m[11]===t.m[11]&&this.m[12]===t.m[12]&&this.m[13]===t.m[13]&&this.m[14]===t.m[14]&&this.m[15]===t.m[15]},i.prototype.clone=function(){return i.FromValues(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5],this.m[6],this.m[7],this.m[8],this.m[9],this.m[10],this.m[11],this.m[12],this.m[13],this.m[14],this.m[15])},i.prototype.decompose=function(o,n,r){r.x=this.m[12],r.y=this.m[13],r.z=this.m[14];var s=t.Tools.Sign(this.m[0]*this.m[1]*this.m[2]*this.m[3])<0?-1:1,a=t.Tools.Sign(this.m[4]*this.m[5]*this.m[6]*this.m[7])<0?-1:1,h=t.Tools.Sign(this.m[8]*this.m[9]*this.m[10]*this.m[11])<0?-1:1;if(o.x=s*Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]+this.m[2]*this.m[2]),o.y=a*Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]+this.m[6]*this.m[6]),o.z=h*Math.sqrt(this.m[8]*this.m[8]+this.m[9]*this.m[9]+this.m[10]*this.m[10]),0===o.x||0===o.y||0===o.z)return n.x=0,n.y=0,n.z=0,n.w=1,!1;var u=i.FromValues(this.m[0]/o.x,this.m[1]/o.x,this.m[2]/o.x,0,this.m[4]/o.y,this.m[5]/o.y,this.m[6]/o.y,0,this.m[8]/o.z,this.m[9]/o.z,this.m[10]/o.z,0,0,0,0,1);return e.FromRotationMatrixToRef(u,n),!0},i.FromArray=function(t,o){var n=new i;return o||(o=0),i.FromArrayToRef(t,o,n),n},i.FromArrayToRef=function(t,i,o){for(var n=0;16>n;n++)o.m[n]=t[n+i]},i.FromFloat32ArrayToRefScaled=function(t,i,o,n){for(var r=0;16>r;r++)n.m[r]=t[r+i]*o},i.FromValuesToRef=function(t,i,o,n,r,s,e,a,h,u,l,m,f,x,y,c,p){p.m[0]=t,p.m[1]=i,p.m[2]=o,p.m[3]=n,p.m[4]=r,p.m[5]=s,p.m[6]=e,p.m[7]=a,p.m[8]=h,p.m[9]=u,p.m[10]=l,p.m[11]=m,p.m[12]=f,p.m[13]=x,p.m[14]=y,p.m[15]=c},i.FromValues=function(t,o,n,r,s,e,a,h,u,l,m,f,x,y,c,p){var z=new i;return z.m[0]=t,z.m[1]=o,z.m[2]=n,z.m[3]=r,z.m[4]=s,z.m[5]=e,z.m[6]=a,z.m[7]=h,z.m[8]=u,z.m[9]=l,z.m[10]=m,z.m[11]=f,z.m[12]=x,z.m[13]=y,z.m[14]=c,z.m[15]=p,z},i.Compose=function(t,o,n){var r=i.FromValues(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1),s=i.Identity();return o.toRotationMatrix(s),r=r.multiply(s),r.setTranslation(n),r},i.Identity=function(){return i.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},i.IdentityToRef=function(t){i.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t)},i.Zero=function(){return i.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},i.RotationX=function(t){var o=new i;return i.RotationXToRef(t,o),o},i.Invert=function(t){var o=new i;return t.invertToRef(o),o},i.RotationXToRef=function(t,i){var o=Math.sin(t),n=Math.cos(t);i.m[0]=1,i.m[15]=1,i.m[5]=n,i.m[10]=n,i.m[9]=-o,i.m[6]=o,i.m[1]=0,i.m[2]=0,i.m[3]=0,i.m[4]=0,i.m[7]=0,i.m[8]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},i.RotationY=function(t){var o=new i;return i.RotationYToRef(t,o),o},i.RotationYToRef=function(t,i){var o=Math.sin(t),n=Math.cos(t);i.m[5]=1,i.m[15]=1,i.m[0]=n,i.m[2]=-o,i.m[8]=o,i.m[10]=n,i.m[1]=0,i.m[3]=0,i.m[4]=0,i.m[6]=0,i.m[7]=0,i.m[9]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},i.RotationZ=function(t){var o=new i;return i.RotationZToRef(t,o),o},i.RotationZToRef=function(t,i){var o=Math.sin(t),n=Math.cos(t);i.m[10]=1,i.m[15]=1,i.m[0]=n,i.m[1]=o,i.m[4]=-o,i.m[5]=n,i.m[2]=0,i.m[3]=0,i.m[6]=0,i.m[7]=0,i.m[8]=0,i.m[9]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},i.RotationAxis=function(t,o){var n=Math.sin(-o),r=Math.cos(-o),s=1-r;t.normalize();var e=i.Zero();return e.m[0]=t.x*t.x*s+r,e.m[1]=t.x*t.y*s-t.z*n,e.m[2]=t.x*t.z*s+t.y*n,e.m[3]=0,e.m[4]=t.y*t.x*s+t.z*n,e.m[5]=t.y*t.y*s+r,e.m[6]=t.y*t.z*s-t.x*n,e.m[7]=0,e.m[8]=t.z*t.x*s-t.y*n,e.m[9]=t.z*t.y*s+t.x*n,e.m[10]=t.z*t.z*s+r,e.m[11]=0,e.m[15]=1,e},i.RotationYawPitchRoll=function(t,o,n){var r=new i;return i.RotationYawPitchRollToRef(t,o,n,r),r},i.RotationYawPitchRollToRef=function(t,i,o,n){e.RotationYawPitchRollToRef(t,i,o,this._tempQuaternion),this._tempQuaternion.toRotationMatrix(n)},i.Scaling=function(t,o,n){var r=i.Zero();return i.ScalingToRef(t,o,n,r),r},i.ScalingToRef=function(t,i,o,n){n.m[0]=t,n.m[1]=0,n.m[2]=0,n.m[3]=0,n.m[4]=0,n.m[5]=i,n.m[6]=0,n.m[7]=0,n.m[8]=0,n.m[9]=0,n.m[10]=o,n.m[11]=0,n.m[12]=0,n.m[13]=0,n.m[14]=0,n.m[15]=1},i.Translation=function(t,o,n){var r=i.Identity();return i.TranslationToRef(t,o,n,r),r},i.TranslationToRef=function(t,o,n,r){i.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,o,n,1,r)},i.LookAtLH=function(t,o,n){var r=i.Zero();return i.LookAtLHToRef(t,o,n,r),r},i.LookAtLHToRef=function(t,o,n,s){o.subtractToRef(t,this._zAxis),this._zAxis.normalize(),r.CrossToRef(n,this._zAxis,this._xAxis),this._xAxis.normalize(),r.CrossToRef(this._zAxis,this._xAxis,this._yAxis),this._yAxis.normalize();var e=-r.Dot(this._xAxis,t),a=-r.Dot(this._yAxis,t),h=-r.Dot(this._zAxis,t);return i.FromValuesToRef(this._xAxis.x,this._yAxis.x,this._zAxis.x,0,this._xAxis.y,this._yAxis.y,this._zAxis.y,0,this._xAxis.z,this._yAxis.z,this._zAxis.z,0,e,a,h,1,s)},i.LookAtLHToRefSIMD=function(t,i,o,n){var r=n.m,s=SIMD.float32x4(i.x,i.y,i.z,0),e=SIMD.float32x4(t.x,t.y,t.z,0),a=SIMD.float32x4(o.x,o.y,o.z,0),h=SIMD.float32x4.sub(s,e),u=SIMD.float32x4.mul(h,h);u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3))),h=SIMD.float32x4.mul(h,SIMD.float32x4.reciprocalSqrtApproximation(u)),u=SIMD.float32x4.mul(a,a),u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3))),a=SIMD.float32x4.mul(a,SIMD.float32x4.reciprocalSqrtApproximation(u));var l=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(h,1,2,0,3),SIMD.float32x4.swizzle(a,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(h,2,0,1,3),SIMD.float32x4.swizzle(a,1,2,0,3)));u=SIMD.float32x4.mul(l,l),u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3))),l=SIMD.float32x4.mul(l,SIMD.float32x4.reciprocalSqrtApproximation(u));var m=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,1,2,0,3),SIMD.float32x4.swizzle(h,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,2,0,1,3),SIMD.float32x4.swizzle(h,1,2,0,3)));u=SIMD.float32x4.mul(l,l),u=SIMD.float32x4.add(u,SIMD.float32x4.add(SIMD.float32x4.swizzle(u,1,2,0,3),SIMD.float32x4.swizzle(u,2,0,1,3))),l=SIMD.float32x4.mul(l,SIMD.float32x4.reciprocalSqrtApproximation(u));var f=SIMD.float32x4.splat(0);l=SIMD.float32x4.neg(l);var x=SIMD.float32x4.shuffle(l,m,0,1,4,5),y=SIMD.float32x4.shuffle(h,f,0,1,4,5),c=SIMD.float32x4.shuffle(x,y,0,2,4,6),p=SIMD.float32x4.shuffle(x,y,1,3,5,7);x=SIMD.float32x4.shuffle(l,m,2,3,6,7),y=SIMD.float32x4.shuffle(h,f,2,3,6,7);var z=SIMD.float32x4.shuffle(x,y,0,2,4,6),M=SIMD.float32x4(0,0,0,1),w=SIMD.float32x4(1,0,0,0),d=SIMD.float32x4(0,1,0,0),I=SIMD.float32x4(0,0,1,0),D=SIMD.float32x4.neg(e);D=SIMD.float32x4.withW(D,1),SIMD.float32x4.store(r,0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,0,0,0,0),c),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,1,1,1,1),p),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,2,2,2,2),z),SIMD.float32x4.mul(SIMD.float32x4.swizzle(w,3,3,3,3),M))))),SIMD.float32x4.store(r,4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(d,0,0,0,0),c),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(d,1,1,1,1),p),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(d,2,2,2,2),z),SIMD.float32x4.mul(SIMD.float32x4.swizzle(d,3,3,3,3),M))))),SIMD.float32x4.store(r,8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(I,0,0,0,0),c),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(I,1,1,1,1),p),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(I,2,2,2,2),z),SIMD.float32x4.mul(SIMD.float32x4.swizzle(I,3,3,3,3),M))))),SIMD.float32x4.store(r,12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(D,0,0,0,0),c),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(D,1,1,1,1),p),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(D,2,2,2,2),z),SIMD.float32x4.mul(SIMD.float32x4.swizzle(D,3,3,3,3),M)))))},i.OrthoLH=function(t,o,n,r){var s=i.Zero();return i.OrthoLHToRef(t,o,n,r,s),s},i.OrthoLHToRef=function(t,o,n,r,s){var e=2/t,a=2/o,h=1/(r-n),u=n/(n-r);i.FromValuesToRef(e,0,0,0,0,a,0,0,0,0,h,0,0,0,u,1,s)},i.OrthoOffCenterLH=function(t,o,n,r,s,e){var a=i.Zero();return i.OrthoOffCenterLHToRef(t,o,n,r,s,e,a),a},i.OrthoOffCenterLHToRef=function(t,i,o,n,r,s,e){e.m[0]=2/(i-t),e.m[1]=e.m[2]=e.m[3]=0,e.m[5]=2/(n-o),e.m[4]=e.m[6]=e.m[7]=0,e.m[10]=-1/(r-s),e.m[8]=e.m[9]=e.m[11]=0,e.m[12]=(t+i)/(t-i),e.m[13]=(n+o)/(o-n),e.m[14]=r/(r-s),e.m[15]=1},i.PerspectiveLH=function(t,o,n,r){var s=i.Zero();return s.m[0]=2*n/t,s.m[1]=s.m[2]=s.m[3]=0,s.m[5]=2*n/o,s.m[4]=s.m[6]=s.m[7]=0,s.m[10]=-r/(n-r),s.m[8]=s.m[9]=0,s.m[11]=1,s.m[12]=s.m[13]=s.m[15]=0,s.m[14]=n*r/(n-r),s},i.PerspectiveFovLH=function(t,o,n,r){var s=i.Zero();return i.PerspectiveFovLHToRef(t,o,n,r,s),s},i.PerspectiveFovLHToRef=function(i,o,n,r,s,e){void 0===e&&(e=t.Camera.FOVMODE_VERTICAL_FIXED);var a=1/Math.tan(.5*i),h=e===t.Camera.FOVMODE_VERTICAL_FIXED;s.m[0]=h?a/o:a,s.m[1]=s.m[2]=s.m[3]=0,s.m[5]=h?a:a*o,s.m[4]=s.m[6]=s.m[7]=0,s.m[8]=s.m[9]=0,s.m[10]=-r/(n-r),s.m[11]=1,s.m[12]=s.m[13]=s.m[15]=0,s.m[14]=n*r/(n-r)},i.GetFinalMatrix=function(t,o,n,r,s,e){var a=t.width,h=t.height,u=t.x,l=t.y,m=i.FromValues(a/2,0,0,0,0,-h/2,0,0,0,0,e-s,0,u+a/2,h/2+l,s,1);return o.multiply(n).multiply(r).multiply(m)},i.GetAsMatrix2x2=function(t){return new Float32Array([t.m[0],t.m[1],t.m[4],t.m[5]])},i.GetAsMatrix3x3=function(t){return new Float32Array([t.m[0],t.m[1],t.m[2],t.m[4],t.m[5],t.m[6],t.m[8],t.m[9],t.m[10]])},i.Transpose=function(t){var o=new i;return o.m[0]=t.m[0],o.m[1]=t.m[4],o.m[2]=t.m[8],o.m[3]=t.m[12],o.m[4]=t.m[1],o.m[5]=t.m[5],o.m[6]=t.m[9],o.m[7]=t.m[13],o.m[8]=t.m[2],o.m[9]=t.m[6],o.m[10]=t.m[10],o.m[11]=t.m[14],o.m[12]=t.m[3],o.m[13]=t.m[7],o.m[14]=t.m[11],o.m[15]=t.m[15],o},i.Reflection=function(t){var o=new i;return i.ReflectionToRef(t,o),o},i.ReflectionToRef=function(t,i){t.normalize();var o=t.normal.x,n=t.normal.y,r=t.normal.z,s=-2*o,e=-2*n,a=-2*r;i.m[0]=s*o+1,i.m[1]=e*o,i.m[2]=a*o,i.m[3]=0,i.m[4]=s*n,i.m[5]=e*n+1,i.m[6]=a*n,i.m[7]=0,i.m[8]=s*r,i.m[9]=e*r,i.m[10]=a*r+1,i.m[11]=0,i.m[12]=s*t.d,i.m[13]=e*t.d,i.m[14]=a*t.d,i.m[15]=1},i._tempQuaternion=new e,i._xAxis=r.Zero(),i._yAxis=r.Zero(),i._zAxis=r.Zero(),i}();t.Matrix=a;var h=function(){function t(t,i,o,n){this.normal=new r(t,i,o),this.d=n}return t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),i=0;return 0!==t&&(i=1/t),this.normal.x*=i,this.normal.y*=i,this.normal.z*=i,this.d*=i,this},t.prototype.transform=function(i){var o=a.Transpose(i),n=this.normal.x,r=this.normal.y,s=this.normal.z,e=this.d,h=n*o.m[0]+r*o.m[1]+s*o.m[2]+e*o.m[3],u=n*o.m[4]+r*o.m[5]+s*o.m[6]+e*o.m[7],l=n*o.m[8]+r*o.m[9]+s*o.m[10]+e*o.m[11],m=n*o.m[12]+r*o.m[13]+s*o.m[14]+e*o.m[15];return new t(h,u,l,m)},t.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},t.prototype.copyFromPoints=function(t,i,o){var n,r=i.x-t.x,s=i.y-t.y,e=i.z-t.z,a=o.x-t.x,h=o.y-t.y,u=o.z-t.z,l=s*u-e*h,m=e*a-r*u,f=r*h-s*a,x=Math.sqrt(l*l+m*m+f*f);return n=0!==x?1/x:0,this.normal.x=l*n,this.normal.y=m*n,this.normal.z=f*n,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},t.prototype.isFrontFacingTo=function(t,i){var o=r.Dot(this.normal,t);return i>=o},t.prototype.signedDistanceTo=function(t){return r.Dot(t,this.normal)+this.d},t.FromArray=function(i){return new t(i[0],i[1],i[2],i[3])},t.FromPoints=function(i,o,n){var r=new t(0,0,0,0);return r.copyFromPoints(i,o,n),r},t.FromPositionAndNormal=function(i,o){var n=new t(0,0,0,0);return o.normalize(),n.normal=o,n.d=-(o.x*i.x+o.y*i.y+o.z*i.z),n},t.SignedDistanceToPlaneFromPositionAndNormal=function(t,i,o){var n=-(i.x*t.x+i.y*t.y+i.z*t.z);return r.Dot(o,i)+n},t}();t.Plane=h;var u=function(){function t(t,i,o,n){this.x=t,this.y=i,this.width=o,this.height=n}return t.prototype.toGlobal=function(i){var o=i.getRenderWidth(),n=i.getRenderHeight();return new t(this.x*o,this.y*n,this.width*o,this.height*n)},t}();t.Viewport=u;var l=function(){function t(){}return t.GetPlanes=function(i){for(var o=[],n=0;6>n;n++)o.push(new h(0,0,0,0));return t.GetPlanesToRef(i,o),o},t.GetPlanesToRef=function(t,i){i[0].normal.x=t.m[3]+t.m[2],i[0].normal.y=t.m[7]+t.m[6],i[0].normal.z=t.m[11]+t.m[10],i[0].d=t.m[15]+t.m[14],i[0].normalize(),i[1].normal.x=t.m[3]-t.m[2],i[1].normal.y=t.m[7]-t.m[6],i[1].normal.z=t.m[11]-t.m[10],i[1].d=t.m[15]-t.m[14],i[1].normalize(),i[2].normal.x=t.m[3]+t.m[0],i[2].normal.y=t.m[7]+t.m[4],i[2].normal.z=t.m[11]+t.m[8],i[2].d=t.m[15]+t.m[12],i[2].normalize(),i[3].normal.x=t.m[3]-t.m[0],i[3].normal.y=t.m[7]-t.m[4],i[3].normal.z=t.m[11]-t.m[8],i[3].d=t.m[15]-t.m[12],i[3].normalize(),i[4].normal.x=t.m[3]-t.m[1],i[4].normal.y=t.m[7]-t.m[5],i[4].normal.z=t.m[11]-t.m[9],i[4].d=t.m[15]-t.m[13],i[4].normalize(),i[5].normal.x=t.m[3]+t.m[1],i[5].normal.y=t.m[7]+t.m[5],i[5].normal.z=t.m[11]+t.m[9],i[5].d=t.m[15]+t.m[13],i[5].normalize()},t}();t.Frustum=l;var m=function(){function i(t,i,o){void 0===o&&(o=Number.MAX_VALUE),this.origin=t,this.direction=i,this.length=o}return i.prototype.intersectsBoxMinMax=function(t,i){var o,n,r,s,e=0,a=Number.MAX_VALUE;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<t.x||this.origin.x>i.x)return!1}else if(o=1/this.direction.x,n=(t.x-this.origin.x)*o,r=(i.x-this.origin.x)*o,r===-(1/0)&&(r=1/0),n>r&&(s=n,n=r,r=s),e=Math.max(n,e),a=Math.min(r,a),e>a)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<t.y||this.origin.y>i.y)return!1}else if(o=1/this.direction.y,n=(t.y-this.origin.y)*o,r=(i.y-this.origin.y)*o,r===-(1/0)&&(r=1/0),n>r&&(s=n,n=r,r=s),e=Math.max(n,e),a=Math.min(r,a),e>a)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<t.z||this.origin.z>i.z)return!1}else if(o=1/this.direction.z,n=(t.z-this.origin.z)*o,r=(i.z-this.origin.z)*o,r===-(1/0)&&(r=1/0),n>r&&(s=n,n=r,r=s),e=Math.max(n,e),a=Math.min(r,a),e>a)return!1;return!0},i.prototype.intersectsBox=function(t){return this.intersectsBoxMinMax(t.minimum,t.maximum)},i.prototype.intersectsSphere=function(t){var i=t.center.x-this.origin.x,o=t.center.y-this.origin.y,n=t.center.z-this.origin.z,r=i*i+o*o+n*n,s=t.radius*t.radius;if(s>=r)return!0;var e=i*this.direction.x+o*this.direction.y+n*this.direction.z;if(0>e)return!1;var a=r-e*e;return s>=a},i.prototype.intersectsTriangle=function(i,o,n){this._edge1||(this._edge1=r.Zero(),this._edge2=r.Zero(),this._pvec=r.Zero(),this._tvec=r.Zero(),this._qvec=r.Zero()),o.subtractToRef(i,this._edge1),n.subtractToRef(i,this._edge2),r.CrossToRef(this.direction,this._edge2,this._pvec);var s=r.Dot(this._edge1,this._pvec);if(0===s)return null;var e=1/s;this.origin.subtractToRef(i,this._tvec);var a=r.Dot(this._tvec,this._pvec)*e;if(0>a||a>1)return null;r.CrossToRef(this._tvec,this._edge1,this._qvec);var h=r.Dot(this.direction,this._qvec)*e;if(0>h||a+h>1)return null;var u=r.Dot(this._edge2,this._qvec)*e;return u>this.length?null:new t.IntersectionInfo(a,h,u)},i.CreateNew=function(t,o,n,s,e,a,h){var u=r.Unproject(new r(t,o,0),n,s,e,a,h),l=r.Unproject(new r(t,o,1),n,s,e,a,h),m=l.subtract(u);return m.normalize(),new i(u,m)},i.CreateNewFromTo=function(t,o,n){void 0===n&&(n=a.Identity());var r=o.subtract(t),s=Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z);return r.normalize(),i.Transform(new i(t,r,s),n)},i.Transform=function(t,o){var n=r.TransformCoordinates(t.origin,o),s=r.TransformNormal(t.direction,o);return new i(n,s,t.length)},i}();t.Ray=m,function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD"}(t.Space||(t.Space={}));var f=(t.Space,function(){function t(){}return t.X=new r(1,0,0),t.Y=new r(0,1,0),t.Z=new r(0,0,1),t}());t.Axis=f;var x=function(){function t(){}return t.interpolate=function(t,i,o,n,r){for(var s=1-3*n+3*i,e=3*n-6*i,a=3*i,h=t,u=0;5>u;u++){var l=h*h,m=l*h,f=s*m+e*l+a*h,x=1/(3*s*l+2*e*h+a);h-=(f-t)*x,h=Math.min(1,Math.max(0,h))}return 3*Math.pow(1-h,2)*h*o+3*(1-h)*Math.pow(h,2)*r+Math.pow(h,3)},t}();t.BezierCurve=x,function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(t.Orientation||(t.Orientation={}));var y=t.Orientation,c=function(){function t(t){var i=this;this.degrees=function(){return 180*i._radians/Math.PI},this.radians=function(){return i._radians},this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}return t.BetweenTwoPoints=function(i,o){var n=o.subtract(i),r=Math.atan2(n.y,n.x);return new t(r)},t.FromRadians=function(i){return new t(i)},t.FromDegrees=function(i){return new t(i*Math.PI/180)},t}();t.Angle=c;var p=function(){function t(t,i,o){this.startPoint=t,this.midPoint=i,this.endPoint=o;var r=Math.pow(i.x,2)+Math.pow(i.y,2),s=(Math.pow(t.x,2)+Math.pow(t.y,2)-r)/2,e=(r-Math.pow(o.x,2)-Math.pow(o.y,2))/2,a=(t.x-i.x)*(i.y-o.y)-(i.x-o.x)*(t.y-i.y);this.centerPoint=new n((s*(i.y-o.y)-e*(t.y-i.y))/a,((t.x-i.x)*e-(i.x-o.x)*s)/a),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=c.BetweenTwoPoints(this.centerPoint,this.startPoint);var h=this.startAngle.degrees(),u=c.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),l=c.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-h>180&&(u-=360),-180>u-h&&(u+=360),l-u>180&&(l-=360),-180>l-u&&(l+=360),this.orientation=0>u-h?y.CW:y.CCW,this.angle=c.FromDegrees(this.orientation===y.CW?h-l:l-h)}return t}();t.Arc2=p;var z=function(){function t(t){this.path=t,this._onchange=new Array,this.value=0,this.animations=new Array}return t.prototype.getPoint=function(){var t=this.path.getPointAtLengthPosition(this.value);return new r(t.x,0,t.y)},t.prototype.moveAhead=function(t){return void 0===t&&(t=.002),this.move(t),this},t.prototype.moveBack=function(t){return void 0===t&&(t=.002),this.move(-t),this},t.prototype.move=function(t){if(Math.abs(t)>1)throw"step size should be less than 1.";return this.value+=t,this.ensureLimits(),this.raiseOnChange(),this},t.prototype.ensureLimits=function(){for(;this.value>1;)this.value-=1;for(;this.value<0;)this.value+=1;return this},t.prototype.markAsDirty=function(t){return this.ensureLimits(),this.raiseOnChange(),this},t.prototype.raiseOnChange=function(){var t=this;return this._onchange.forEach(function(i){return i(t)}),this},t.prototype.onchange=function(t){return this._onchange.push(t),this},t}();t.PathCursor=z;var M=function(){function i(t,i){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new n(t,i))}return i.prototype.addLineTo=function(i,o){if(closed)return t.Tools.Error("cannot add lines to closed paths"),this;var r=new n(i,o),s=this._points[this._points.length-1];return this._points.push(r),this._length+=r.subtract(s).length(),this},i.prototype.addArcTo=function(i,o,r,s,e){if(void 0===e&&(e=36),closed)return t.Tools.Error("cannot add arcs to closed paths"),this;var a=this._points[this._points.length-1],h=new n(i,o),u=new n(r,s),l=new p(a,h,u),m=l.angle.radians()/e;l.orientation===y.CW&&(m*=-1);for(var f=l.startAngle.radians()+m,x=0;e>x;x++){var c=Math.cos(f)*l.radius+l.centerPoint.x,z=Math.sin(f)*l.radius+l.centerPoint.y;this.addLineTo(c,z),f+=m}return this},i.prototype.close=function(){return this.closed=!0,this},i.prototype.length=function(){var t=this._length;if(!this.closed){var i=this._points[this._points.length-1],o=this._points[0];t+=o.subtract(i).length()}return t},i.prototype.getPoints=function(){return this._points},i.prototype.getPointAtLengthPosition=function(i){if(0>i||i>1)return t.Tools.Error("normalized length position should be between 0 and 1."),n.Zero();for(var o=i*this.length(),r=0,s=0;s<this._points.length;s++){var e=(s+1)%this._points.length,a=this._points[s],h=this._points[e],u=h.subtract(a),l=u.length()+r;if(o>=r&&l>=o){var m=u.normalize(),f=o-r;return new n(a.x+m.x*f,a.y+m.y*f)}r=l}return t.Tools.Error("internal error"),n.Zero()},i.StartingAt=function(t,o){return new i(t,o)},i}();t.Path2=M;var w=function(){function i(t,i,o){this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var n=0;n<t.length;n++)this._curve[n]=t[n].clone();this._raw=o||!1,this._compute(i)}return i.prototype.getCurve=function(){return this._curve},i.prototype.getTangents=function(){return this._tangents},i.prototype.getNormals=function(){return this._normals},i.prototype.getBinormals=function(){return this._binormals},i.prototype.getDistances=function(){return this._distances},i.prototype.update=function(t,i){for(var o=0;o<t.length;o++)this._curve[o].x=t[o].x,this._curve[o].y=t[o].y,this._curve[o].z=t[o].z;return this._compute(i),this},i.prototype._compute=function(t){var i=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[i-1]=this._curve[i-1].subtract(this._curve[i-2]),this._raw||this._tangents[i-1].normalize();var o=this._tangents[0],n=this._normalVector(this._curve[0],o,t);this._normals[0]=n,this._raw||this._normals[0].normalize(),this._binormals[0]=r.Cross(o,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var s,e,a,h,u=1;i>u;u++)s=this._getLastNonNullVector(u),i-1>u&&(e=this._getFirstNonNullVector(u),this._tangents[u]=s.add(e),this._tangents[u].normalize()),this._distances[u]=this._distances[u-1]+s.length(),a=this._tangents[u],h=this._binormals[u-1],this._normals[u]=r.Cross(h,a),this._raw||this._normals[u].normalize(),this._binormals[u]=r.Cross(a,this._normals[u]),this._raw||this._binormals[u].normalize()},i.prototype._getFirstNonNullVector=function(t){for(var i=1,o=this._curve[t+i].subtract(this._curve[t]);0===o.length()&&t+i+1<this._curve.length;)i++,o=this._curve[t+i].subtract(this._curve[t]);return o},i.prototype._getLastNonNullVector=function(t){for(var i=1,o=this._curve[t].subtract(this._curve[t-i]);0===o.length()&&t>i+1;)i++,o=this._curve[t].subtract(this._curve[t-i]);return o},i.prototype._normalVector=function(i,o,n){var s;if(void 0===n||null===n){var e;t.Tools.WithinEpsilon(o.y,1,t.Engine.Epsilon)?t.Tools.WithinEpsilon(o.x,1,t.Engine.Epsilon)?t.Tools.WithinEpsilon(o.z,1,t.Engine.Epsilon)||(e=new r(0,0,1)):e=new r(1,0,0):e=new r(0,-1,0),s=r.Cross(o,e)}else s=r.Cross(o,n),r.CrossToRef(s,o,s);return s.normalize(),s},i}();t.Path3D=w;var d=function(){function t(t){this._length=0,this._points=t,this._length=this._computeLength(t)}return t.CreateQuadraticBezier=function(i,o,n,s){s=s>2?s:3;for(var e=new Array,a=function(t,i,o,n){var r=(1-t)*(1-t)*i+2*t*(1-t)*o+t*t*n;return r},h=0;s>=h;h++)e.push(new r(a(h/s,i.x,o.x,n.x),a(h/s,i.y,o.y,n.y),a(h/s,i.z,o.z,n.z)));return new t(e)},t.CreateCubicBezier=function(i,o,n,s,e){e=e>3?e:4;for(var a=new Array,h=function(t,i,o,n,r){var s=(1-t)*(1-t)*(1-t)*i+3*t*(1-t)*(1-t)*o+3*t*t*(1-t)*n+t*t*t*r;return s},u=0;e>=u;u++)a.push(new r(h(u/e,i.x,o.x,n.x,s.x),h(u/e,i.y,o.y,n.y,s.y),h(u/e,i.z,o.z,n.z,s.z)));return new t(a)},t.CreateHermiteSpline=function(i,o,n,s,e){for(var a=new Array,h=1/e,u=0;e>=u;u++)a.push(r.Hermite(i,o,n,s,u*h));return new t(a)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype["continue"]=function(i){for(var o=this._points[this._points.length-1],n=this._points.slice(),r=i.getPoints(),s=1;s<r.length;s++)n.push(r[s].subtract(r[0]).add(o));var e=new t(n);return e},t.prototype._computeLength=function(t){for(var i=0,o=1;o<t.length;o++)i+=t[o].subtract(t[o-1]).length();return i},t}();t.Curve3=d;var I=function(){function t(t,i){void 0===t&&(t=r.Zero()),void 0===i&&(i=r.Up()),this.position=t,this.normal=i}return t.prototype.clone=function(){return new t(this.position.clone(),this.normal.clone())},t}();t.PositionNormalVertex=I;var D=function(){function t(t,i,o){void 0===t&&(t=r.Zero()),void 0===i&&(i=r.Up()),void 0===o&&(o=n.Zero()),this.position=t,this.normal=i,this.uv=o}return t.prototype.clone=function(){return new t(this.position.clone(),this.normal.clone(),this.uv.clone())},t}();t.PositionNormalTextureVertex=D;var S=a.prototype.multiplyToArray,v=a.prototype.invertToRef,g=a.LookAtLHToRef,T=r.TransformCoordinatesToRef,R=r.TransformCoordinatesFromFloatsToRef,_=function(){function t(){}return Object.defineProperty(t,"IsEnabled",{get:function(){return t._isEnabled},enumerable:!0,configurable:!0}),t.DisableSIMD=function(){a.prototype.multiplyToArray=S,a.prototype.invertToRef=v,a.LookAtLHToRef=g,r.TransformCoordinatesToRef=T,r.TransformCoordinatesFromFloatsToRef=R,t._isEnabled=!1},t.EnableSIMD=function(){void 0!==window.SIMD&&(a.prototype.multiplyToArray=a.prototype.multiplyToArraySIMD,a.prototype.invertToRef=a.prototype.invertToRefSIMD,a.LookAtLHToRef=a.LookAtLHToRefSIMD,r.TransformCoordinatesToRef=r.TransformCoordinatesToRefSIMD,r.TransformCoordinatesFromFloatsToRef=r.TransformCoordinatesFromFloatsToRefSIMD,Object.defineProperty(r.prototype,"x",{get:function(){return this._data[0]},set:function(t){this._data||(this._data=new Float32Array(3)),this._data[0]=t}}),Object.defineProperty(r.prototype,"y",{get:function(){return this._data[1]},set:function(t){this._data[1]=t}}),Object.defineProperty(r.prototype,"z",{get:function(){return this._data[2]},set:function(t){this._data[2]=t}}),t._isEnabled=!0)},t._isEnabled=!1,t}();t.SIMDHelper=_}(BABYLON||(BABYLON={}));';("undefined"!=typeof window&&window.module||"undefined"!=typeof module)&&"undefined"!=typeof module.exports&&(module.exports=BABYLON);
/*!
 * Knockout JavaScript library v3.3.0
 * (c) Steven Sanderson - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
(function(){(function(n){var i=this||eval("this"),r=i.document,f=i.navigator,t=i.jQuery,u=i.JSON;(function(n){"function"==typeof define&&define.amd?define(["exports","require"],n):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?n(module.exports||exports):n(i.ko={})})(function(e,o){function a(n,t){return null===n||typeof n in p?n===t:!1}function w(t,i){var r;return function(){r||(r=setTimeout(function(){r=n;t()},i))}}function b(n,t){var i;return function(){clearTimeout(i);i=setTimeout(n,t)}}function v(n,t,i,r){s.d[n]={init:function(n,u,f,e,o){var c,h;return s.w(function(){var l=s.a.c(u()),f=!i!=!l,e=!h;(e||t||f!==c)&&(e&&s.Z.oa()&&(h=s.a.la(s.e.childNodes(n),!0)),f?(e||s.e.T(n,s.a.la(h)),s.Ja(r?r(o,l):o,n)):s.e.ma(n),c=f)},null,{q:n}),{controlsDescendantBindings:!0}}};s.h.ka[n]=!1;s.e.R[n]=!0}var s="undefined"!=typeof e?e:{},p,h,c,y,l;s.b=function(n,t){for(var i=n.split("."),r=s,u=0;u<i.length-1;u++)r=r[i[u]];r[i[i.length-1]]=t};s.D=function(n,t,i){n[t]=i};s.version="3.3.0";s.b("version",s.version);s.a=function(){function o(n,t){for(var i in n)n.hasOwnProperty(i)&&t(i,n[i])}function l(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function a(n,t){return n.__proto__=t,n}function v(n,t,i,r){var u=n[t].match(c)||[];s.a.o(i.match(c),function(n){s.a.ga(u,n,r)});n[t]=u.join(" ")}var y={__proto__:[]}instanceof Array,h={},p={};h[f&&/Firefox\/2/i.test(f.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(h,function(n,t){if(t.length)for(var i=0,r=t.length;i<r;i++)p[t[i]]=n});var w={propertychange:!0},e=r&&function(){for(var t=3,i=r.createElement("div"),u=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i><\/i><![endif]-->",u[0];);return 4<t?t:n}(),c=/\S+/g;return{Bb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],o:function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i],i)},m:function(n,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(n,t);for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},vb:function(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r],r))return n[r];return null},ya:function(n,t){var i=s.a.m(n,t);0<i?n.splice(i,1):0===i&&n.shift()},wb:function(n){n=n||[];for(var i=[],t=0,r=n.length;t<r;t++)0>s.a.m(i,n[t])&&i.push(n[t]);return i},Ka:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i],i));return r},xa:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)t(n[i],i)&&r.push(n[i]);return r},ia:function(n,t){if(t instanceof Array)n.push.apply(n,t);else for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},ga:function(n,t,i){var r=s.a.m(s.a.cb(n),t);0>r?i&&n.push(t):i||n.splice(r,1)},za:y,extend:l,Fa:a,Ga:y?a:l,A:o,pa:function(n,t){if(!n)return n;var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=t(n[i],i,n));return r},Ra:function(n){for(;n.firstChild;)s.removeNode(n.firstChild)},Jb:function(n){n=s.a.O(n);for(var i=(n[0]&&n[0].ownerDocument||r).createElement("div"),t=0,u=n.length;t<u;t++)i.appendChild(s.S(n[t]));return i},la:function(n,t){for(var r,i=0,f=n.length,u=[];i<f;i++)r=n[i].cloneNode(!0),u.push(t?s.S(r):r);return u},T:function(n,t){if(s.a.Ra(n),t)for(var i=0,r=t.length;i<r;i++)n.appendChild(t[i])},Qb:function(n,t){var r=n.nodeType?[n]:n;if(0<r.length){for(var f=r[0],e=f.parentNode,i=0,u=t.length;i<u;i++)e.insertBefore(t[i],f);for(i=0,u=r.length;i<u;i++)s.removeNode(r[i])}},na:function(n,t){if(n.length){for(t=8===t.nodeType&&t.parentNode||t;n.length&&n[0].parentNode!==t;)n.splice(0,1);if(1<n.length){var i=n[0],r=n[n.length-1];for(n.length=0;i!==r;)if(n.push(i),i=i.nextSibling,!i)return;n.push(r)}}return n},Sb:function(n,t){7>e?n.setAttribute("selected",t):n.selected=t},ib:function(t){return null===t||t===n?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Dc:function(n,t){return n=n||"",t.length>n.length?!1:n.substring(0,t.length)===t},jc:function(n,t){if(n===t)return!0;if(11===n.nodeType)return!1;if(t.contains)return t.contains(3===n.nodeType?n.parentNode:n);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(n)&16);for(;n&&n!=t;)n=n.parentNode;return!!n},Qa:function(n){return s.a.jc(n,n.ownerDocument.documentElement)},tb:function(n){return!!s.a.vb(n,s.a.Qa)},v:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},n:function(n,i,r){var o=e&&w[i],u,f;if(!o&&t)t(n).bind(i,r);else if(o||"function"!=typeof n.addEventListener)if("undefined"!=typeof n.attachEvent)u=function(t){r.call(n,t)},f="on"+i,n.attachEvent(f,u),s.a.C.fa(n,function(){n.detachEvent(f,u)});else throw Error("Browser doesn't support addEventListener or attachEvent");else n.addEventListener(i,r,!1)},qa:function(n,u){if(!n||!n.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var f;if("input"===s.a.v(n)&&n.type&&"click"==u.toLowerCase()?(f=n.type,f="checkbox"==f||"radio"==f):f=!1,t&&!f)t(n).trigger(u);else if("function"==typeof r.createEvent)if("function"==typeof n.dispatchEvent)f=r.createEvent(p[u]||"HTMLEvents"),f.initEvent(u,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,n),n.dispatchEvent(f);else throw Error("The supplied element doesn't support dispatchEvent");else if(f&&n.click)n.click();else if("undefined"!=typeof n.fireEvent)n.fireEvent("on"+u);else throw Error("Browser doesn't support triggering events");},c:function(n){return s.F(n)?n():n},cb:function(n){return s.F(n)?n.B():n},Ia:function(n,t,i){var r;t&&("object"==typeof n.classList?(r=n.classList[i?"add":"remove"],s.a.o(t.match(c),function(t){r.call(n.classList,t)})):"string"==typeof n.className.baseVal?v(n.className,"baseVal",t,i):v(n,"className",t,i))},Ha:function(t,i){var r=s.a.c(i),u;(null===r||r===n)&&(r="");u=s.e.firstChild(t);!u||3!=u.nodeType||s.e.nextSibling(u)?s.e.T(t,[t.ownerDocument.createTextNode(r)]):u.data=r;s.a.mc(t)},Rb:function(n,t){if(n.name=t,7>=e)try{n.mergeAttributes(r.createElement("<input name='"+n.name+"'/>"),!1)}catch(i){}},mc:function(n){9<=e&&(n=1==n.nodeType?n:n.parentNode,n.style&&(n.style.zoom=n.style.zoom))},kc:function(n){if(e){var t=n.style.width;n.style.width=0;n.style.width=t}},Bc:function(n,t){n=s.a.c(n);t=s.a.c(t);for(var r=[],i=n;i<=t;i++)r.push(i);return r},O:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i},Hc:6===e,Ic:7===e,M:e,Db:function(n,t){for(var r=s.a.O(n.getElementsByTagName("input")).concat(s.a.O(n.getElementsByTagName("textarea"))),f="string"==typeof t?function(n){return n.name===t}:function(n){return t.test(n.name)},u=[],i=r.length-1;0<=i;i--)f(r[i])&&u.push(r[i]);return u},yc:function(n){return"string"==typeof n&&(n=s.a.ib(n))?u&&u.parse?u.parse(n):new Function("return "+n)():null},jb:function(n,t,i){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(s.a.c(n),t,i)},zc:function(n,t,i){var v,e,h,f,u,c;i=i||{};var l=i.params||{},a=i.includeFields||this.Bb,v=n;if("object"==typeof n&&"form"===s.a.v(n))for(v=n.action,e=a.length-1;0<=e;e--)for(h=s.a.Db(n,a[e]),f=h.length-1;0<=f;f--)l[h[f].name]=h[f].value;t=s.a.c(t);u=r.createElement("form");u.style.display="none";u.action=v;u.method="post";for(c in t)n=r.createElement("input"),n.type="hidden",n.name=c,n.value=s.a.jb(s.a.c(t[c])),u.appendChild(n);o(l,function(n,t){var i=r.createElement("input");i.type="hidden";i.name=n;i.value=t;u.appendChild(i)});r.body.appendChild(u);i.submitter?i.submitter(u):u.submit();setTimeout(function(){u.parentNode.removeChild(u)},0)}}}();s.b("utils",s.a);s.b("utils.arrayForEach",s.a.o);s.b("utils.arrayFirst",s.a.vb);s.b("utils.arrayFilter",s.a.xa);s.b("utils.arrayGetDistinctValues",s.a.wb);s.b("utils.arrayIndexOf",s.a.m);s.b("utils.arrayMap",s.a.Ka);s.b("utils.arrayPushAll",s.a.ia);s.b("utils.arrayRemoveItem",s.a.ya);s.b("utils.extend",s.a.extend);s.b("utils.fieldsIncludedWithJsonPost",s.a.Bb);s.b("utils.getFormFields",s.a.Db);s.b("utils.peekObservable",s.a.cb);s.b("utils.postJson",s.a.zc);s.b("utils.parseJson",s.a.yc);s.b("utils.registerEventHandler",s.a.n);s.b("utils.stringifyJson",s.a.jb);s.b("utils.range",s.a.Bc);s.b("utils.toggleDomNodeCssClass",s.a.Ia);s.b("utils.triggerEvent",s.a.qa);s.b("utils.unwrapObservable",s.a.c);s.b("utils.objectForEach",s.a.A);s.b("utils.addOrRemoveItem",s.a.ga);s.b("utils.setTextContent",s.a.Ha);s.b("unwrap",s.a.c);Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,i;return 1===arguments.length?function(){return t.apply(n,arguments)}:(i=Array.prototype.slice.call(arguments,1),function(){var r=i.slice(0);return r.push.apply(r,arguments),t.apply(n,r)})});s.a.f=new function(){function r(r,f){var e=r[t];if(!e||"null"===e||!i[e]){if(!f)return n;e=r[t]="ko"+u++;i[e]={}}return i[e]}var u=0,t="__ko__"+(new Date).getTime(),i={};return{get:function(t,i){var u=r(t,!1);return u===n?n:u[i]},set:function(t,i,u){(u!==n||r(t,!1)!==n)&&(r(t,!0)[i]=u)},clear:function(n){var r=n[t];return r?(delete i[r],n[t]=null,!0):!1},I:function(){return u+++t}}};s.b("utils.domData",s.a.f);s.b("utils.domData.clear",s.a.f.clear);s.a.C=new function(){function i(t,i){var r=s.a.f.get(t,u);return r===n&&i&&(r=[],s.a.f.set(t,u,r)),r}function r(n){var t=i(n,!1),u;if(t)for(t=t.slice(0),u=0;u<t.length;u++)t[u](n);if(s.a.f.clear(n),s.a.C.cleanExternalData(n),f[n.nodeType])for(t=n.firstChild;n=t;)t=n.nextSibling,8===n.nodeType&&r(n)}var u=s.a.f.I(),e={1:!0,8:!0,9:!0},f={1:!0,9:!0};return{fa:function(n,t){if("function"!=typeof t)throw Error("Callback must be a function");i(n,!0).push(t)},Pb:function(t,r){var f=i(t,!1);f&&(s.a.ya(f,r),0==f.length&&s.a.f.set(t,u,n))},S:function(n){var t,i,u;if(e[n.nodeType]&&(r(n),f[n.nodeType]))for(t=[],s.a.ia(t,n.getElementsByTagName("*")),i=0,u=t.length;i<u;i++)r(t[i]);return n},removeNode:function(n){s.S(n);n.parentNode&&n.parentNode.removeChild(n)},cleanExternalData:function(n){t&&"function"==typeof t.cleanData&&t.cleanData([n])}}};s.S=s.a.C.S;s.removeNode=s.a.C.removeNode;s.b("cleanNode",s.S);s.b("removeNode",s.removeNode);s.b("utils.domNodeDisposal",s.a.C);s.b("utils.domNodeDisposal.addDisposeCallback",s.a.C.fa);s.b("utils.domNodeDisposal.removeDisposeCallback",s.a.C.Pb),function(){s.a.ca=function(n,u){var e,f;if(t){if(t.parseHTML)e=t.parseHTML(n,u)||[];else if((e=t.clean([n],u))&&e[0]){for(f=e[0];f.parentNode&&11!==f.parentNode.nodeType;)f=f.parentNode;f.parentNode&&f.parentNode.removeChild(f)}}else{(f=u)||(f=r);e=f.parentWindow||f.defaultView||i;var o=s.a.ib(n).toLowerCase(),f=f.createElement("div"),o=o.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","<\/table>"]||!o.indexOf("<tr")&&[2,"<table><tbody>","<\/tbody><\/table>"]||(!o.indexOf("<td")||!o.indexOf("<th"))&&[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"]||[0,"",""],h="ignored<div>"+o[1]+n+o[2]+"<\/div>";for("function"==typeof e.innerShiv?f.appendChild(e.innerShiv(h)):f.innerHTML=h;o[0]--;)f=f.lastChild;e=s.a.O(f.lastChild.childNodes)}return e};s.a.gb=function(i,r){if(s.a.Ra(i),r=s.a.c(r),null!==r&&r!==n)if("string"!=typeof r&&(r=r.toString()),t)t(i).html(r);else for(var f=s.a.ca(r,i.ownerDocument),u=0;u<f.length;u++)i.appendChild(f[u])}}();s.b("utils.parseHtmlFragment",s.a.ca);s.b("utils.setHtml",s.a.gb);s.H=function(){function i(n,t){var r;if(n)if(8==n.nodeType)r=s.H.Lb(n.nodeValue),null!=r&&t.push({ic:n,wc:r});else if(1==n.nodeType)for(var r=0,u=n.childNodes,f=u.length;r<f;r++)i(u[r],t)}var t={};return{$a:function(n){if("function"!=typeof n)throw Error("You can only pass a function to ko.memoization.memoize()");var i=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[i]=n,"<!--[ko_memo:"+i+"]-->"},Wb:function(i,r){var u=t[i];if(u===n)throw Error("Couldn't find any memo with ID "+i+". Perhaps it's already been unmemoized.");try{return u.apply(null,r||[]),!0}finally{delete t[i]}},Xb:function(n,t){var f=[],u,o,r,e;for(i(n,f),u=0,o=f.length;u<o;u++)r=f[u].ic,e=[r],t&&s.a.ia(e,t),s.H.Wb(f[u].wc,e),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)},Lb:function(n){return(n=n.match(/^\[ko_memo\:(.*?)\]$/))?n[1]:null}}}();s.b("memoization",s.H);s.b("memoization.memoize",s.H.$a);s.b("memoization.unmemoize",s.H.Wb);s.b("memoization.parseMemoText",s.H.Lb);s.b("memoization.unmemoizeDomNodeAndDescendants",s.H.Xb);s.Sa={throttle:function(n,t){n.throttleEvaluation=t;var i=null;return s.j({read:n,write:function(r){clearTimeout(i);i=setTimeout(function(){n(r)},t)}})},rateLimit:function(n,t){var i,r,u;"number"==typeof t?i=t:(i=t.timeout,r=t.method);u="notifyWhenChangesStop"==r?b:w;n.Za(function(n){return u(n,i)})},notify:function(n,t){n.equalityComparer="always"==t?null:a}};p={undefined:1,boolean:1,number:1,string:1};s.b("extenders",s.Sa);s.Ub=function(n,t,i){this.da=n;this.La=t;this.hc=i;this.Gb=!1;s.D(this,"dispose",this.p)};s.Ub.prototype.p=function(){this.Gb=!0;this.hc()};s.Q=function(){s.a.Ga(this,s.Q.fn);this.G={};this.rb=1};h={U:function(n,t,i){var r=this,u;return i=i||"change",u=new s.Ub(r,t?n.bind(t):n,function(){s.a.ya(r.G[i],u);r.ua&&r.ua(i)}),r.ja&&r.ja(i),r.G[i]||(r.G[i]=[]),r.G[i].push(u),u},notifySubscribers:function(n,t){if(t=t||"change","change"===t&&this.Yb(),this.Ba(t))try{s.k.xb();for(var u=this.G[t].slice(0),r=0,i;i=u[r];++r)i.Gb||i.La(n)}finally{s.k.end()}},Aa:function(){return this.rb},pc:function(n){return this.Aa()!==n},Yb:function(){++this.rb},Za:function(n){var t=this,e=s.F(t),r,u,i,f;t.ta||(t.ta=t.notifySubscribers,t.notifySubscribers=function(n,i){i&&"change"!==i?"beforeChange"===i?t.pb(n):t.ta(n,i):t.qb(n)});f=n(function(){e&&i===t&&(i=t());r=!1;t.Wa(u,i)&&t.ta(u=i)});t.qb=function(n){r=!0;i=n;f()};t.pb=function(n){r||(u=n,t.ta(n,"beforeChange"))}},Ba:function(n){return this.G[n]&&this.G[n].length},nc:function(n){if(n)return this.G[n]&&this.G[n].length||0;var t=0;return s.a.A(this.G,function(n,i){t+=i.length}),t},Wa:function(n,t){return!this.equalityComparer||!this.equalityComparer(n,t)},extend:function(n){var t=this;return n&&s.a.A(n,function(n,i){var r=s.Sa[n];"function"==typeof r&&(t=r(t,i)||t)}),t}};s.D(h,"subscribe",h.U);s.D(h,"extend",h.extend);s.D(h,"getSubscriptionsCount",h.nc);s.a.za&&s.a.Fa(h,Function.prototype);s.Q.fn=h;s.Hb=function(n){return null!=n&&"function"==typeof n.U&&"function"==typeof n.notifySubscribers};s.b("subscribable",s.Q);s.b("isSubscribable",s.Hb);s.Z=s.k=function(){function t(t){r.push(n);n=t}function i(){n=r.pop()}var r=[],n,u=0;return{xb:t,end:i,Ob:function(t){if(n){if(!s.Hb(t))throw Error("Only subscribable things can act as dependencies");n.La(t,t.ac||(t.ac=++u))}},u:function(n,r,u){try{return t(),n.apply(r,u||[])}finally{i()}},oa:function(){if(n)return n.w.oa()},Ca:function(){if(n)return n.Ca}}}();s.b("computedContext",s.Z);s.b("computedContext.getDependenciesCount",s.Z.oa);s.b("computedContext.isInitial",s.Z.Ca);s.b("computedContext.isSleeping",s.Z.Jc);s.b("ignoreDependencies",s.Gc=s.k.u);s.r=function(n){function t(){return 0<arguments.length?(t.Wa(i,arguments[0])&&(t.X(),i=arguments[0],t.W()),this):(s.k.Ob(t),i)}var i=n;return s.Q.call(t),s.a.Ga(t,s.r.fn),t.B=function(){return i},t.W=function(){t.notifySubscribers(i)},t.X=function(){t.notifySubscribers(i,"beforeChange")},s.D(t,"peek",t.B),s.D(t,"valueHasMutated",t.W),s.D(t,"valueWillMutate",t.X),t};s.r.fn={equalityComparer:a};c=s.r.Ac="__ko_proto__";s.r.fn[c]=s.r;s.a.za&&s.a.Fa(s.r.fn,s.Q.fn);s.Ta=function(t,i){return null===t||t===n||t[c]===n?!1:t[c]===i?!0:s.Ta(t[c],i)};s.F=function(n){return s.Ta(n,s.r)};s.Da=function(n){return"function"==typeof n&&n[c]===s.r||"function"==typeof n&&n[c]===s.j&&n.qc?!0:!1};s.b("observable",s.r);s.b("isObservable",s.F);s.b("isWriteableObservable",s.Da);s.b("isWritableObservable",s.Da);s.ba=function(n){if(n=n||[],"object"!=typeof n||!("length"in n))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return n=s.r(n),s.a.Ga(n,s.ba.fn),n.extend({trackArrayChanges:!0})};s.ba.fn={remove:function(n){for(var u,r=this.B(),i=[],f="function"!=typeof n||s.F(n)?function(t){return t===n}:n,t=0;t<r.length;t++)u=r[t],f(u)&&(0===i.length&&this.X(),i.push(u),r.splice(t,1),t--);return i.length&&this.W(),i},removeAll:function(t){if(t===n){var i=this.B(),r=i.slice(0);return this.X(),i.splice(0,i.length),this.W(),r}return t?this.remove(function(n){return 0<=s.a.m(t,n)}):[]},destroy:function(n){var i=this.B(),r="function"!=typeof n||s.F(n)?function(t){return t===n}:n,t;for(this.X(),t=i.length-1;0<=t;t--)r(i[t])&&(i[t]._destroy=!0);this.W()},destroyAll:function(t){return t===n?this.destroy(function(){return!0}):t?this.destroy(function(n){return 0<=s.a.m(t,n)}):[]},indexOf:function(n){var t=this();return s.a.m(t,n)},replace:function(n,t){var i=this.indexOf(n);0<=i&&(this.X(),this.B()[i]=t,this.W())}};s.a.o("pop push reverse shift sort splice unshift".split(" "),function(n){s.ba.fn[n]=function(){var t=this.B();return this.X(),this.yb(t,n,arguments),t=t[n].apply(t,arguments),this.W(),t}});s.a.o(["slice"],function(n){s.ba.fn[n]=function(){var t=this();return t[n].apply(t,arguments)}});s.a.za&&s.a.Fa(s.ba.fn,s.r.fn);s.b("observableArray",s.ba);s.Sa.trackArrayChanges=function(n){function o(){var e,f;i||(i=!0,e=n.notifySubscribers,n.notifySubscribers=function(n,t){return t&&"change"!==t||++r,e.apply(this,arguments)},f=[].concat(n.B()||[]),t=null,u=n.U(function(i){if(i=[].concat(i||[]),n.Ba("arrayChange")){var u;(!t||1<r)&&(t=s.a.Ma(f,i,{sparse:!0}));u=t}f=i;t=null;r=0;u&&u.length&&n.notifySubscribers(u,"arrayChange")}))}if(!n.yb){var i=!1,t=null,u,r=0,f=n.ja,e=n.ua;n.ja=function(t){f&&f.call(n,t);"arrayChange"===t&&o()};n.ua=function(t){e&&e.call(n,t);"arrayChange"!==t||n.Ba("arrayChange")||(u.p(),i=!1)};n.yb=function(n,u,f){function c(n,t,i){return l[l.length]={status:n,value:t,index:i}}if(i&&!r){var l=[],e=n.length,h=f.length,o=0;switch(u){case"push":o=e;case"unshift":for(u=0;u<h;u++)c("added",f[u],o+u);break;case"pop":o=e-1;case"shift":e&&c("deleted",n[o],o);break;case"splice":u=Math.min(Math.max(0,0>f[0]?e+f[0]:f[0]),e);for(var e=1===h?e:Math.min(u+(f[1]||0),e),h=u+h-2,o=Math.max(e,h),a=[],v=[],y=2;u<o;++u,++y)u<e&&v.push(c("deleted",n[u],u)),u<h&&a.push(c("added",f[y],u));s.a.Cb(v,a);break;default:return}t=l}}}};s.w=s.j=function(t,i,r){function rt(n,t,i){if(g&&t===u)throw Error("A 'pure' computed must not be called recursively");f[n]=i;i.sa=o++;i.ea=t.Aa()}function b(){var n,t;for(n in f)if(f.hasOwnProperty(n)&&(t=f[n],t.da.pc(t.ea)))return!0}function ut(){!e&&f&&s.a.A(f,function(n,t){t.p&&t.p()});f=null;o=0;y=!0;e=c=!1}function ft(){var n=u.throttleEvaluation;n&&0<=n?(clearTimeout(st),st=setTimeout(function(){a(!0)},n)):u.nb?u.nb():a(!0)}function a(t){var v;if(!k&&!y){if(it&&it()){if(!d){p();return}}else d=!1;k=!0;try{var r=f,a=o,b=g?n:!o;s.k.xb({La:function(n,t){y||(a&&r[t]?(rt(t,n,r[t]),delete r[t],--a):f[t]||rt(t,n,e?{da:n}:n.U(ft)))},w:u,Ca:b});f={};o=0;try{v=i?l.call(i):l()}finally{s.k.end();a&&!e&&s.a.A(r,function(n,t){t.p&&t.p()});c=!1}u.Wa(h,v)&&(e||w(h,"beforeChange"),h=v,e?u.Yb():t&&w(h));b&&w(h,"awake")}finally{k=!1}o||p()}}function u(){if(0<arguments.length){if("function"==typeof nt)nt.apply(i,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return s.k.Ob(u),(c||e&&b())&&a(),h}function et(){return(c&&!o||e&&b())&&a(),h}function ot(){return c||0<o}function w(n,t){u.notifySubscribers(n,t)}var h,c=!0,k=!1,d=!1,y=!1,l=t,g=!1,e=!1,ht;if(l&&"object"==typeof l?(r=l,l=r.read):(r=r||{},l||(l=r.read)),"function"!=typeof l)throw Error("Pass a function that returns the value of the ko.computed");var nt=r.write,v=r.disposeWhenNodeIsRemoved||r.q||null,tt=r.disposeWhen||r.Pa,it=tt,p=ut,f={},o=0,st=null;return i||(i=r.owner),s.Q.call(u),s.a.Ga(u,s.j.fn),u.B=et,u.oa=function(){return o},u.qc="function"==typeof nt,u.p=function(){p()},u.$=ot,ht=u.Za,u.Za=function(n){ht.call(u,n);u.nb=function(){u.pb(h);c=!0;u.qb(u)}},r.pure?(e=g=!0,u.ja=function(n){if(!y&&e&&"change"==n){if(e=!1,c||b())f=null,o=0,c=!0,a();else{var t=[];s.a.A(f,function(n,i){t[i.sa]=n});s.a.o(t,function(n,t){var r=f[n],i=r.da.U(ft);i.sa=t;i.ea=r.ea;f[n]=i})}y||w(h,"awake")}},u.ua=function(t){y||"change"!=t||u.Ba("change")||(s.a.A(f,function(n,t){t.p&&(f[n]={da:t.da,sa:t.sa,ea:t.ea},t.p())}),e=!0,w(n,"asleep"))},u.bc=u.Aa,u.Aa=function(){return e&&(c||b())&&a(),u.bc()}):r.deferEvaluation&&(u.ja=function(n){"change"!=n&&"beforeChange"!=n||et()}),s.D(u,"peek",u.B),s.D(u,"dispose",u.p),s.D(u,"isActive",u.$),s.D(u,"getDependenciesCount",u.oa),v&&(d=!0,v.nodeType&&(it=function(){return!s.a.Qa(v)||tt&&tt()})),e||r.deferEvaluation||a(),v&&ot()&&v.nodeType&&(p=function(){s.a.C.Pb(v,p);ut()},s.a.C.fa(v,p)),u};s.sc=function(n){return s.Ta(n,s.j)};h=s.r.Ac;s.j[h]=s.r;s.j.fn={equalityComparer:a};s.j.fn[h]=s.j;s.a.za&&s.a.Fa(s.j.fn,s.Q.fn);s.b("dependentObservable",s.j);s.b("computed",s.j);s.b("isComputed",s.sc);s.Nb=function(n,t){return"function"==typeof n?s.w(n,t,{pure:!0}):(n=s.a.extend({},n),n.pure=!0,s.w(n,t))};s.b("pureComputed",s.Nb),function(){function t(u,f,e){if(e=e||new i,u=f(u),"object"!=typeof u||null===u||u===n||u instanceof Date||u instanceof String||u instanceof Number||u instanceof Boolean)return u;var o=u instanceof Array?[]:{};return e.save(u,o),r(u,function(i){var r=f(u[i]),s;switch(typeof r){case"boolean":case"number":case"string":case"function":o[i]=r;break;case"object":case"undefined":s=e.get(r);o[i]=s!==n?s:t(r,f,e)}}),o}function r(n,t){if(n instanceof Array){for(var i=0;i<n.length;i++)t(i);"function"==typeof n.toJSON&&t("toJSON")}else for(i in n)t(i)}function i(){this.keys=[];this.mb=[]}s.Vb=function(n){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(n,function(n){for(var t=0;s.F(n)&&10>t;t++)n=n();return n})};s.toJSON=function(n,t,i){return n=s.Vb(n),s.a.jb(n,t,i)};i.prototype={save:function(n,t){var i=s.a.m(this.keys,n);0<=i?this.mb[i]=t:(this.keys.push(n),this.mb.push(t))},get:function(t){return t=s.a.m(this.keys,t),0<=t?this.mb[t]:n}}}();s.b("toJS",s.Vb);s.b("toJSON",s.toJSON),function(){s.i={s:function(t){switch(s.a.v(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?s.a.f.get(t,s.d.options.ab):7>=s.a.M?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?s.i.s(t.options[t.selectedIndex]):n;default:return t.value}},Y:function(t,i,r){switch(s.a.v(t)){case"option":switch(typeof i){case"string":s.a.f.set(t,s.d.options.ab,n);"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__;t.value=i;break;default:s.a.f.set(t,s.d.options.ab,i);t.__ko__hasDomDataOptionValue__=!0;t.value="number"==typeof i?i:""}break;case"select":(""===i||null===i)&&(i=n);for(var f=-1,u=0,o=t.options.length,e;u<o;++u)if(e=s.i.s(t.options[u]),e==i||""==e&&i===n){f=u;break}(r||0<=f||i===n&&1<t.size)&&(t.selectedIndex=f);break;default:(null===i||i===n)&&(i="");t.value=i}}}}();s.b("selectExtensions",s.i);s.b("selectExtensions.readValue",s.i.s);s.b("selectExtensions.writeValue",s.i.Y);s.h=function(){function n(n){var c,u,i;n=s.a.ib(n);123===n.charCodeAt(0)&&(n=n.slice(1,-1));var a=[],h=n.match(t),o,r=[],l=0;if(h)for(h.push(","),c=0;u=h[c];++c){if(i=u.charCodeAt(0),44===i){if(0>=l){a.push(o&&r.length?{key:o,value:r.join("")}:{unknown:o||r.join("")});o=l=0;r=[];continue}}else if(58===i){if(!l&&!o&&1===r.length){o=r.pop();continue}}else 47===i&&c&&1<u.length?(i=h[c-1].match(f))&&!e[i[0]]&&(n=n.substr(n.indexOf(u)+1),h=n.match(t),h.push(","),c=-1,u="/"):40===i||123===i||91===i?++l:41===i||125===i||93===i?--l:o||r.length||34!==i&&39!==i||(u=u.slice(1,-1));r.push(u)}return a}var r=["true","false","null","undefined"],u=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,t=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),f=/[\])"'A-Za-z0-9_$]+$/,e={"in":1,"return":1,"typeof":1},i={};return{ka:[],V:i,bb:n,Ea:function(t,f){function e(n,t){var a,f;if(!l){if(f=s.getBindingHandler(n),f&&f.preprocess&&!(t=f.preprocess(t,n,e)))return;(f=i[n])&&(a=t,0<=s.a.m(r,a)?a=!1:(f=a.match(u),a=null===f?!1:f[1]?"Object("+f[1]+")"+f[2]:a),f=a);f&&o.push("'"+n+"':function(_z){"+a+"=_z}")}c&&(t="function(){return "+t+" }");h.push("'"+n+"':"+t)}f=f||{};var h=[],o=[],c=f.valueAccessors,l=f.bindingParams,a="string"==typeof t?n(t):t;return s.a.o(a,function(n){e(n.key||n.unknown,n.value)}),o.length&&e("_ko_property_writers","{"+o.join(",")+" }"),h.join(",")},vc:function(n,t){for(var i=0;i<n.length;i++)if(n[i].key==t)return!0;return!1},ra:function(n,t,i,r,u){n&&s.F(n)?!s.Da(n)||u&&n.B()===r||n(r):(n=t.get("_ko_property_writers"))&&n[i]&&n[i](r)}}}();s.b("expressionRewriting",s.h);s.b("expressionRewriting.bindingRewriteValidators",s.h.ka);s.b("expressionRewriting.parseObjectLiteral",s.h.bb);s.b("expressionRewriting.preProcessBindings",s.h.Ea);s.b("expressionRewriting._twoWayBindings",s.h.V);s.b("jsonExpressionRewriting",s.h);s.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",s.h.Ea),function(){function n(n){return 8==n.nodeType&&e.test(t?n.text:n.nodeValue)}function i(n){return 8==n.nodeType&&o.test(t?n.text:n.nodeValue)}function u(t,r){for(var u=t,f=1,e=[];u=u.nextSibling;){if(i(u)&&(f--,0===f))return e;e.push(u);n(u)&&f++}if(!r)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function f(n,t){var i=u(n,t);return i?0<i.length?i[i.length-1].nextSibling:n.nextSibling:null}var t=r&&"<!--test-->"===r.createComment("test").text,e=t?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=t?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,h={ul:!0,ol:!0};s.e={R:{},childNodes:function(t){return n(t)?u(t):t.childNodes},ma:function(t){if(n(t)){t=s.e.childNodes(t);for(var i=0,r=t.length;i<r;i++)s.removeNode(t[i])}else s.a.Ra(t)},T:function(t,i){if(n(t)){s.e.ma(t);for(var u=t.nextSibling,r=0,f=i.length;r<f;r++)u.parentNode.insertBefore(i[r],u)}else s.a.T(t,i)},Mb:function(t,i){n(t)?t.parentNode.insertBefore(i,t.nextSibling):t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i)},Fb:function(t,i,r){r?n(t)?t.parentNode.insertBefore(i,r.nextSibling):r.nextSibling?t.insertBefore(i,r.nextSibling):t.appendChild(i):s.e.Mb(t,i)},firstChild:function(t){return n(t)?!t.nextSibling||i(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return n(t)&&(t=f(t)),t.nextSibling&&i(t.nextSibling)?null:t.nextSibling},oc:n,Fc:function(n){return(n=(t?n.text:n.nodeValue).match(e))?n[1]:null},Kb:function(t){var o,r,u,e;if(h[s.a.v(t)]&&(o=t.firstChild,o))do if(1===o.nodeType){if(r=o.firstChild,u=null,r)do u?u.push(r):n(r)?(e=f(r,!0),e?r=e:u=[r]):i(r)&&(u=[r]);while(r=r.nextSibling);if(r=u)for(u=o.nextSibling,e=0;e<r.length;e++)u?t.insertBefore(r[e],u):t.appendChild(r[e])}while(o=o.nextSibling)}}}();s.b("virtualElements",s.e);s.b("virtualElements.allowedBindings",s.e.R);s.b("virtualElements.emptyNode",s.e.ma);s.b("virtualElements.insertAfter",s.e.Fb);s.b("virtualElements.prepend",s.e.Mb);s.b("virtualElements.setDomNodeChildren",s.e.T),function(){s.L=function(){this.ec={}};s.a.extend(s.L.prototype,{nodeHasBindings:function(n){switch(n.nodeType){case 1:return null!=n.getAttribute("data-bind")||s.g.getComponentNameForNode(n);case 8:return s.e.oc(n);default:return!1}},getBindings:function(n,t){var i=this.getBindingsString(n,t),i=i?this.parseBindingsString(i,t,n):null;return s.g.sb(i,n,t,!1)},getBindingAccessors:function(n,t){var i=this.getBindingsString(n,t),i=i?this.parseBindingsString(i,t,n,{valueAccessors:!0}):null;return s.g.sb(i,n,t,!0)},getBindingsString:function(n){switch(n.nodeType){case 1:return n.getAttribute("data-bind");case 8:return s.e.Fc(n);default:return null}},parseBindingsString:function(n,t,i,r){var u,f,e,h,c;try{return u=this.ec,f=n+(r&&r.valueAccessors||""),(e=u[f])||(c="with($context){with($data||{}){return{"+s.h.Ea(n,r)+"}}}",h=new Function("$context","$element",c),e=u[f]=h),e(t,i)}catch(o){throw o.message="Unable to parse bindings.\nBindings value: "+n+"\nMessage: "+o.message,o;}}});s.L.instance=new s.L}();s.b("bindingProvider",s.L),function(){function v(n){return function(){return n}}function u(n){return n()}function o(n){return s.a.pa(s.k.u(n),function(t,i){return function(){return n()[i]}})}function y(n,t,i){return"function"==typeof n?o(n.bind(null,t,i)):s.a.pa(n,v)}function p(n,t){return o(this.getBindings.bind(this,n,t))}function h(n,t,i){var r,u=s.e.firstChild(t),f=s.L.instance,e=f.preprocessNode;if(e){for(;r=u;)u=s.e.nextSibling(r),e.call(f,r);u=s.e.firstChild(t)}for(;r=u;)u=s.e.nextSibling(r),c(n,r,i)}function c(n,t,i){var u=!0,r=1===t.nodeType;r&&s.e.Kb(t);(r&&i||s.L.instance.nodeHasBindings(t))&&(u=l(t,null,n,i).shouldBindDescendants);u&&!a[s.a.v(t)]&&h(n,t,!r)}function w(n){var i=[],r={},t=[];return s.a.A(n,function u(f){if(!r[f]){var e=s.getBindingHandler(f);e&&(e.after&&(t.push(f),s.a.o(e.after,function(i){if(n[i]){if(-1!==s.a.m(t,i))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+t.join(", "));u(i)}}),t.length--),i.push({key:f,Eb:e}));r[f]=!0}}),i}function l(t,i,r,e){var v=s.a.f.get(t,f),o,l,a,c;if(!i){if(v)throw Error("You cannot apply bindings multiple times to the same element.");s.a.f.set(t,f,!0)}if(!v&&e&&s.Tb(t,r),i&&"function"!=typeof i)o=i;else{var y=s.L.instance,b=y.getBindingAccessors||p,h=s.j(function(){return(o=i?i(r,t):b.call(y,t,r))&&r.K&&r.K(),o},null,{q:t});o&&h.$()||(h=null)}return o&&(a=h?function(n){return function(){return u(h()[n])}}:function(n){return o[n]},c=function(){return s.a.pa(h?h():o,u)},c.get=function(n){return o[n]&&u(a(n))},c.has=function(n){return n in o},e=w(o),s.a.o(e,function(i){var e=i.Eb.init,h=i.Eb.update,u=i.key;if(8===t.nodeType&&!s.e.R[u])throw Error("The binding '"+u+"' cannot be used with virtual elements");try{"function"==typeof e&&s.k.u(function(){var i=e(t,a(u),c,r.$data,r);if(i&&i.controlsDescendantBindings){if(l!==n)throw Error("Multiple bindings ("+l+" and "+u+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");l=u}});"function"==typeof h&&s.j(function(){h(t,a(u),c,r.$data,r)},null,{q:t})}catch(f){throw f.message='Unable to process binding "'+u+": "+o[u]+'"\nMessage: '+f.message,f;}})),{shouldBindDescendants:l===n}}function r(n){return n&&n instanceof s.N?n:new s.N(n)}var a,f,e;s.d={};a={script:!0,textarea:!0};s.getBindingHandler=function(n){return s.d[n]};s.N=function(t,i,r,u){var f=this,h="function"==typeof t&&!s.F(t),o,e=s.j(function(){var o=h?t():t,n=s.a.c(o);return i?(i.K&&i.K(),s.a.extend(f,i),e&&(f.K=e)):(f.$parents=[],f.$root=n,f.ko=s),f.$rawData=o,f.$data=n,r&&(f[r]=n),u&&u(f,i,n),f.$data},null,{Pa:function(){return o&&!s.a.tb(o)},q:!0});e.$()&&(f.K=e,e.equalityComparer=null,o=[],e.Zb=function(t){o.push(t);s.a.C.fa(t,function(t){s.a.ya(o,t);o.length||(e.p(),f.K=e=n)})})};s.N.prototype.createChildContext=function(n,t,i){return new s.N(n,this,t,function(n,t){n.$parentContext=t;n.$parent=t.$data;n.$parents=(t.$parents||[]).slice(0);n.$parents.unshift(n.$parent);i&&i(n)})};s.N.prototype.extend=function(n){return new s.N(this.K||this.$data,this,null,function(t,i){t.$rawData=i.$rawData;s.a.extend(t,"function"==typeof n?n():n)})};f=s.a.f.I();e=s.a.f.I();s.Tb=function(n,t){if(2==arguments.length)s.a.f.set(n,e,t),t.K&&t.K.Zb(n);else return s.a.f.get(n,e)};s.va=function(n,t,i){return 1===n.nodeType&&s.e.Kb(n),l(n,t,r(i),!0)};s.cc=function(n,t,i){return i=r(i),s.va(n,y(t,i,n),i)};s.Ja=function(n,t){1!==t.nodeType&&8!==t.nodeType||h(r(n),t,!0)};s.ub=function(n,u){if(!t&&i.jQuery&&(t=i.jQuery),u&&1!==u.nodeType&&8!==u.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");u=u||i.document.body;c(r(n),u,!0)};s.Oa=function(t){switch(t.nodeType){case 1:case 8:var i=s.Tb(t);if(i)return i;if(t.parentNode)return s.Oa(t.parentNode)}return n};s.gc=function(t){return(t=s.Oa(t))?t.$data:n};s.b("bindingHandlers",s.d);s.b("applyBindings",s.ub);s.b("applyBindingsToDescendants",s.Ja);s.b("applyBindingAccessorsToNode",s.va);s.b("applyBindingsToNode",s.cc);s.b("contextFor",s.Oa);s.b("dataFor",s.gc)}(),function(n){function u(t,u){var e=i.hasOwnProperty(t)?i[t]:n,o;e?e.U(u):(e=i[t]=new s.Q,e.U(u),f(t,function(n,u){var f=!(!u||!u.synchronous);r[t]={definition:n,tc:f};delete i[t];o||f?e.notifySubscribers(n):setTimeout(function(){e.notifySubscribers(n)},0)}),o=!0)}function f(n,i){t("getConfig",[n],function(r){r?t("loadComponent",[n,r],function(n){i(n,r)}):i(null,null)})}function t(i,r,u,f){var e,o,h;if(f||(f=s.g.loaders.slice(0)),e=f.shift(),e)if(o=e[i],o){if(h=!1,o.apply(e,r.concat(function(n){h?u(null):null!==n?u(n):t(i,r,u,f)}))!==n&&(h=!0,!e.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.");}else t(i,r,u,f);else u(null)}var i={},r={};s.g={get:function(t,i){var f=r.hasOwnProperty(t)?r[t]:n;f?f.tc?s.k.u(function(){i(f.definition)}):setTimeout(function(){i(f.definition)},0):u(t,i)},zb:function(n){delete r[n]},ob:t};s.g.loaders=[];s.b("components",s.g);s.b("components.get",s.g.get);s.b("components.clearCachedDefinition",s.g.zb)}(),function(){function l(n,i,r,f){function e(){0==--c&&f(o)}var o={},c=2,h=r.template;r=r.viewModel;h?u(i,h,function(t){s.g.ob("loadTemplate",[n,t],function(n){o.template=n;e()})}):e();r?u(i,r,function(i){s.g.ob("loadViewModel",[n,i],function(n){o[t]=n;e()})}):e()}function e(n,i,r){if("function"==typeof i)r(function(n){return new i(n)});else if("function"==typeof i[t])r(i[t]);else if("instance"in i){var u=i.instance;r(function(){return u})}else"viewModel"in i?e(n,i.viewModel,r):n("Unknown viewModel value: "+i)}function h(n){switch(s.a.v(n)){case"script":return s.a.ca(n.text);case"textarea":return s.a.ca(n.value);case"template":if(c(n.content))return s.a.la(n.content.childNodes)}return s.a.la(n.childNodes)}function c(n){return i.DocumentFragment?n instanceof DocumentFragment:n&&11===n.nodeType}function u(n,t,r){"string"==typeof t.require?o||i.require?(o||i.require)([t.require],r):n("Uses require, but no AMD loader is present"):r(t)}function f(n){return function(t){throw Error("Component '"+n+"': "+t);}}var n={},t;s.g.register=function(t,i){if(!i)throw Error("Invalid configuration for "+t);if(s.g.Xa(t))throw Error("Component "+t+" is already registered");n[t]=i};s.g.Xa=function(t){return t in n};s.g.Ec=function(t){delete n[t];s.g.zb(t)};s.g.Ab={getConfig:function(t,i){i(n.hasOwnProperty(t)?n[t]:null)},loadComponent:function(n,t,i){var r=f(n);u(r,t,function(t){l(n,r,t,i)})},loadTemplate:function(n,t,u){if(n=f(n),"string"==typeof t)u(s.a.ca(t));else if(t instanceof Array)u(t);else if(c(t))u(s.a.O(t.childNodes));else if(t.element)if(t=t.element,i.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)u(h(t));else if("string"==typeof t){var e=r.getElementById(t);e?u(h(e)):n("Cannot find element with ID "+t)}else n("Unknown element type: "+t);else n("Unknown template value: "+t)},loadViewModel:function(n,t,i){e(f(n),t,i)}};t="createViewModel";s.b("components.register",s.g.register);s.b("components.isRegistered",s.g.Xa);s.b("components.unregister",s.g.Ec);s.b("components.defaultLoader",s.g.Ab);s.g.loaders.push(s.g.Ab);s.g.$b=n}(),function(){function n(n,i){var r=n.getAttribute("params");if(r){var r=t.parseBindingsString(r,i,n,{valueAccessors:!0,bindingParams:!0}),r=s.a.pa(r,function(t){return s.w(t,null,{q:n})}),u=s.a.pa(r,function(t){var i=t.B();return t.$()?s.w({read:function(){return s.a.c(t())},write:s.Da(i)&&function(n){t()(n)},q:n}):i});return u.hasOwnProperty("$raw")||(u.$raw=r),u}return{$raw:{}}}s.g.getComponentNameForNode=function(n){return n=s.a.v(n),s.g.Xa(n)&&n};s.g.sb=function(t,i,r,u){var f,e;if(1===i.nodeType&&(f=s.g.getComponentNameForNode(i),f)){if(t=t||{},t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');e={name:f,params:n(i,r)};t.component=u?function(){return e}:e}return t};var t=new s.L;9>s.a.M&&(s.g.register=function(n){return function(t){return r.createElement(t),n.apply(this,arguments)}}(s.g.register),r.createDocumentFragment=function(n){return function(){var t=n(),i=s.g.$b;for(var r in i)i.hasOwnProperty(r)&&t.createElement(r);return t}}(r.createDocumentFragment))}(),function(n){function t(n,t,i){if(t=t.template,!t)throw Error("Component '"+n+"' has no template");n=s.a.la(t);s.e.T(i,n)}function i(n,t,i,r){var u=n.createViewModel;return u?u.call(n,r,{element:t,templateNodes:i}):r}var r=0;s.d.component={init:function(u,f,e,o,h){function a(){var n=c&&c.dispose;"function"==typeof n&&n.call(c);l=null}var c,l,v=s.a.O(s.e.childNodes(u));return s.a.C.fa(u,a),s.w(function(){var o=s.a.c(f()),e,y,p;if("string"==typeof o?e=o:(e=s.a.c(o.name),y=s.a.c(o.params)),!e)throw Error("No component name specified");p=l=++r;s.g.get(e,function(r){if(l===p){if(a(),!r)throw Error("Unknown component '"+e+"'");t(e,r,u);var f=i(r,u,v,y);r=h.createChildContext(f,n,function(n){n.$component=f;n.$componentTemplateNodes=v});c=f;s.Ja(r,u)}})},null,{q:u}),{controlsDescendantBindings:!0}}};s.e.R.component=!0}();y={"class":"className","for":"htmlFor"};s.d.attr={update:function(t,i){var r=s.a.c(i())||{};s.a.A(r,function(i,r){r=s.a.c(r);var u=!1===r||null===r||r===n;u&&t.removeAttribute(i);8>=s.a.M&&i in y?(i=y[i],u?t.removeAttribute(i):t[i]=r):u||t.setAttribute(i,r.toString());"name"===i&&s.a.Rb(t,u?"":r.toString())})}},function(){s.d.checked={after:["value","attr"],init:function(t,i,r){function c(){var c=t.checked,n=a?u():c,o;s.Z.Ca()||f&&!c||(o=s.k.u(i),e?h!==n?(c&&(s.a.ga(o,n,!0),s.a.ga(o,h,!1)),h=n):s.a.ga(o,n,c):s.h.ra(o,r,"checked",n,!0))}function l(){var n=s.a.c(i());t.checked=e?0<=s.a.m(n,u()):o?n:u()===n}var u=s.Nb(function(){return r.has("checkedValue")?s.a.c(r.get("checkedValue")):r.has("value")?s.a.c(r.get("value")):t.value}),o="checkbox"==t.type,f="radio"==t.type;if(o||f){var e=o&&s.a.c(i())instanceof Array,h=e?u():n,a=f||e;f&&!t.name&&s.d.uniqueName.init(t,function(){return!0});s.w(c,null,{q:t});s.a.n(t,"click",c);s.w(l,null,{q:t})}}};s.h.V.checked=!0;s.d.checkedValue={update:function(n,t){n.value=s.a.c(t())}}}();s.d.css={update:function(n,t){var i=s.a.c(t());null!==i&&"object"==typeof i?s.a.A(i,function(t,i){i=s.a.c(i);s.a.Ia(n,t,i)}):(i=String(i||""),s.a.Ia(n,n.__ko__cssValue,!1),n.__ko__cssValue=i,s.a.Ia(n,i,!0))}};s.d.enable={update:function(n,t){var i=s.a.c(t());i&&n.disabled?n.removeAttribute("disabled"):i||n.disabled||(n.disabled=!0)}};s.d.disable={update:function(n,t){s.d.enable.update(n,function(){return!s.a.c(t())})}};s.d.event={init:function(n,t,i,r,u){var f=t()||{};s.a.A(f,function(f){"string"==typeof f&&s.a.n(n,f,function(n){var o,h=t()[f],e;if(h){try{e=s.a.O(arguments);r=u.$data;e.unshift(r);o=h.apply(r,e)}finally{!0!==o&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}!1===i.get(f+"Bubble")&&(n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation())}})})}};s.d.foreach={Ib:function(n){return function(){var i=n(),t=s.a.cb(i);return!t||"number"==typeof t.length?{foreach:i,templateEngine:s.P.Va}:(s.a.c(i),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:s.P.Va})}},init:function(n,t){return s.d.template.init(n,s.d.foreach.Ib(t))},update:function(n,t,i,r,u){return s.d.template.update(n,s.d.foreach.Ib(t),i,r,u)}};s.h.ka.foreach=!1;s.e.R.foreach=!0;s.d.hasfocus={init:function(n,t,i){function r(r){var u,f;if(n.__ko_hasfocusUpdating=!0,u=n.ownerDocument,"activeElement"in u){try{f=u.activeElement}catch(e){f=u.body}r=f===n}u=t();s.h.ra(u,i,"hasfocus",r,!0);n.__ko_hasfocusLastValue=r;n.__ko_hasfocusUpdating=!1}var u=r.bind(null,!0),f=r.bind(null,!1);s.a.n(n,"focus",u);s.a.n(n,"focusin",u);s.a.n(n,"blur",f);s.a.n(n,"focusout",f)},update:function(n,t){var i=!!s.a.c(t());n.__ko_hasfocusUpdating||n.__ko_hasfocusLastValue===i||(i?n.focus():n.blur(),s.k.u(s.a.qa,null,[n,i?"focusin":"focusout"]))}};s.h.V.hasfocus=!0;s.d.hasFocus=s.d.hasfocus;s.h.V.hasFocus=!0;s.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){s.a.gb(n,t())}};v("if");v("ifnot",!1,!0);v("with",!0,!1,function(n,t){return n.createChildContext(t)});l={};s.d.options={init:function(n){if("select"!==s.a.v(n))throw Error("options binding applies only to SELECT elements");for(;0<n.length;)n.remove(0);return{controlsDescendantBindings:!0}},update:function(t,i,r){function v(){return s.a.xa(t.options,function(n){return n.selected})}function y(n,t,i){var r=typeof t;return"function"==r?t(n):"string"==r?n[t]:i}function p(n,i){if(o&&e)s.i.Y(t,s.a.c(r.get("value")),!0);else if(f.length){var u=0<=s.a.m(f,s.i.s(i[0]));s.a.Sb(i[0],u);o&&!u&&s.k.u(s.a.qa,null,[t,"change"])}}var h=t.multiple,c=0!=t.length&&h?t.scrollTop:null,u=s.a.c(i()),e=r.get("valueAllowUnset")&&r.has("value"),w=r.get("optionsIncludeDestroyed"),a,f,o;i={};f=[];e||(h?f=s.a.Ka(v(),s.i.s):0<=t.selectedIndex&&f.push(s.i.s(t.options[t.selectedIndex])));u&&("undefined"==typeof u.length&&(u=[u]),a=s.a.xa(u,function(t){return w||t===n||null===t||!s.a.c(t._destroy)}),r.has("optionsCaption")&&(u=s.a.c(r.get("optionsCaption")),null!==u&&u!==n&&a.unshift(l)));o=!1;i.beforeRemove=function(n){t.removeChild(n)};u=p;r.has("optionsAfterRender")&&"function"==typeof r.get("optionsAfterRender")&&(u=function(t,i){p(0,i);s.k.u(r.get("optionsAfterRender"),null,[i[0],t!==l?t:n])});s.a.fb(t,a,function(i,u,h){return h.length&&(f=!e&&h[0].selected?[s.i.s(h[0])]:[],o=!0),u=t.ownerDocument.createElement("option"),i===l?(s.a.Ha(u,r.get("optionsCaption")),s.i.Y(u,n)):(h=y(i,r.get("optionsValue"),i),s.i.Y(u,s.a.c(h)),i=y(i,r.get("optionsText"),h),s.a.Ha(u,i)),[u]},i,u);s.k.u(function(){e?s.i.Y(t,s.a.c(r.get("value")),!0):(h?f.length&&v().length<f.length:f.length&&0<=t.selectedIndex?s.i.s(t.options[t.selectedIndex])!==f[0]:f.length||0<=t.selectedIndex)&&s.a.qa(t,"change")});s.a.kc(t);c&&20<Math.abs(c-t.scrollTop)&&(t.scrollTop=c)}};s.d.options.ab=s.a.f.I();s.d.selectedOptions={after:["options","foreach"],init:function(n,t,i){s.a.n(n,"change",function(){var u=t(),r=[];s.a.o(n.getElementsByTagName("option"),function(n){n.selected&&r.push(s.i.s(n))});s.h.ra(u,i,"selectedOptions",r)})},update:function(n,t){if("select"!=s.a.v(n))throw Error("values binding applies only to SELECT elements");var i=s.a.c(t());i&&"number"==typeof i.length&&s.a.o(n.getElementsByTagName("option"),function(n){var t=0<=s.a.m(i,s.i.s(n));s.a.Sb(n,t)})}};s.h.V.selectedOptions=!0;s.d.style={update:function(t,i){var r=s.a.c(i()||{});s.a.A(r,function(i,r){r=s.a.c(r);(null===r||r===n||!1===r)&&(r="");t.style[i]=r})}};s.d.submit={init:function(n,t,i,r,u){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");s.a.n(n,"submit",function(i){var r,f=t();try{r=f.call(u.$data,n)}finally{!0!==r&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}})}};s.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){s.a.Ha(n,t())}};s.e.R.text=!0,function(){if(i&&i.navigator)var t=function(n){if(n)return parseFloat(n[1])},e=i.opera&&i.opera.version&&parseInt(i.opera.version()),r=i.navigator.userAgent,o=t(r.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),h=t(r.match(/Firefox\/([^ ]*)/));if(10>s.a.M)var u=s.a.f.I(),f=s.a.f.I(),c=function(n){var t=this.activeElement;(t=t&&s.a.f.get(t,f))&&t(n)},l=function(n,t){var i=n.ownerDocument;s.a.f.get(i,u)||(s.a.f.set(i,u,!0),s.a.n(i,"selectionchange",c));s.a.f.set(n,f,t)};s.d.textInput={init:function(t,i,r){function u(n,i){s.a.n(t,n,i)}function p(){var r=s.a.c(i());(null===r||r===n)&&(r="");v!==n&&r===v?setTimeout(p,4):t.value!==r&&(y=r,t.value=r)}function c(){a||(v=t.value,a=setTimeout(f,4))}function f(){clearTimeout(a);v=a=n;var u=t.value;y!==u&&(y=u,s.h.ra(i(),r,"textInput",u))}var y=t.value,a,v;10>s.a.M?(u("propertychange",function(n){"value"===n.propertyName&&f()}),8==s.a.M&&(u("keyup",f),u("keydown",f)),8<=s.a.M&&(l(t,f),u("dragend",c))):(u("input",f),5>o&&"textarea"===s.a.v(t)?(u("keydown",c),u("paste",c),u("cut",c)):11>e?u("keydown",c):4>h&&(u("DOMAutoComplete",f),u("dragdrop",f),u("drop",f)));u("change",f);s.w(p,null,{q:t})}};s.h.V.textInput=!0;s.d.textinput={preprocess:function(n,t,i){i("textInput",n)}}}();s.d.uniqueName={init:function(n,t){if(t()){var i="ko_unique_"+ ++s.d.uniqueName.fc;s.a.Rb(n,i)}}};s.d.uniqueName.fc=0;s.d.value={after:["options","foreach"],init:function(n,t,i){var o,h;if("input"!=n.tagName.toLowerCase()||"checkbox"!=n.type&&"radio"!=n.type){var r=["change"],u=i.get("valueUpdate"),f=!1,e=null;u&&("string"==typeof u&&(u=[u]),s.a.ia(r,u),r=s.a.wb(r));o=function(){e=null;f=!1;var r=t(),u=s.i.s(n);s.h.ra(r,i,"value",u)};!s.a.M||"input"!=n.tagName.toLowerCase()||"text"!=n.type||"off"==n.autocomplete||n.form&&"off"==n.form.autocomplete||-1!=s.a.m(r,"propertychange")||(s.a.n(n,"propertychange",function(){f=!0}),s.a.n(n,"focus",function(){f=!1}),s.a.n(n,"blur",function(){f&&o()}));s.a.o(r,function(t){var i=o;s.a.Dc(t,"after")&&(i=function(){e=s.i.s(n);setTimeout(o,0)},t=t.substring(5));s.a.n(n,t,i)});h=function(){var r=s.a.c(t()),u=s.i.s(n),f;null!==e&&r===e?setTimeout(h,0):r!==u&&("select"===s.a.v(n)?(f=i.get("valueAllowUnset"),u=function(){s.i.Y(n,r,f)},u(),f||r===s.i.s(n)?setTimeout(u,0):s.k.u(s.a.qa,null,[n,"change"])):s.i.Y(n,r))};s.w(h,null,{q:n})}else s.va(n,{checkedValue:t})},update:function(){}};s.h.V.value=!0;s.d.visible={update:function(n,t){var i=s.a.c(t()),r="none"!=n.style.display;i&&!r?n.style.display="":!i&&r&&(n.style.display="none")}},function(n){s.d[n]={init:function(t,i,r,u,f){return s.d.event.init.call(this,t,function(){var t={};return t[n]=i(),t},r,u,f)}}}("click");s.J=function(){};s.J.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource");};s.J.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock");};s.J.prototype.makeTemplateSource=function(n,t){if("string"==typeof n){t=t||r;var i=t.getElementById(n);if(!i)throw Error("Cannot find template with ID "+n);return new s.t.l(i)}if(1==n.nodeType||8==n.nodeType)return new s.t.ha(n);throw Error("Unknown template type: "+n);};s.J.prototype.renderTemplate=function(n,t,i,r){return n=this.makeTemplateSource(n,r),this.renderTemplateSource(n,t,i,r)};s.J.prototype.isTemplateRewritten=function(n,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(n,t).data("isRewritten")};s.J.prototype.rewriteTemplate=function(n,t,i){n=this.makeTemplateSource(n,i);t=t(n.text());n.text(t);n.data("isRewritten",!0)};s.b("templateEngine",s.J);s.kb=function(){function n(n,t,i,r){var o,f,u,e;for(n=s.h.bb(n),o=s.h.ka,f=0;f<n.length;f++)if(u=n[f].key,o.hasOwnProperty(u))if(e=o[u],"function"==typeof e){if(u=e(n[f].value))throw Error(u);}else if(!e)throw Error("This template engine does not support the '"+u+"' binding within its templates");return i="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+s.h.Ea(n,{valueAccessors:!0})+" } })()},'"+i.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(i)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{lc:function(n,t,i){t.isTemplateRewritten(n,i)||t.rewriteTemplate(n,function(n){return s.kb.xc(n,t)},i)},xc:function(r,u){return r.replace(t,function(t,i,r,f,e){return n(e,i,r,u)}).replace(i,function(t,i){return n(i,"<!-- ko -->","#comment",u)})},dc:function(n,t){return s.H.$a(function(i,r){var u=i.nextSibling;u&&u.nodeName.toLowerCase()===t&&s.va(u,n,r)})}}}();s.b("__tr_ambtns",s.kb.dc),function(){var i,t;s.t={};s.t.l=function(n){this.l=n};s.t.l.prototype.text=function(){var n=s.a.v(this.l),n="script"===n?"text":"textarea"===n?"value":"innerHTML",t;if(0==arguments.length)return this.l[n];t=arguments[0];"innerHTML"===n?s.a.gb(this.l,t):this.l[n]=t};i=s.a.f.I()+"_";s.t.l.prototype.data=function(n){if(1===arguments.length)return s.a.f.get(this.l,i+n);s.a.f.set(this.l,i+n,arguments[1])};t=s.a.f.I();s.t.ha=function(n){this.l=n};s.t.ha.prototype=new s.t.l;s.t.ha.prototype.text=function(){if(0==arguments.length){var i=s.a.f.get(this.l,t)||{};return i.lb===n&&i.Na&&(i.lb=i.Na.innerHTML),i.lb}s.a.f.set(this.l,t,{lb:arguments[0]})};s.t.l.prototype.nodes=function(){if(0==arguments.length)return(s.a.f.get(this.l,t)||{}).Na;s.a.f.set(this.l,t,{Na:arguments[0]})};s.b("templateSources",s.t);s.b("templateSources.domElement",s.t.l);s.b("templateSources.anonymousTemplate",s.t.ha)}(),function(){function t(n,t,i){var r;for(t=s.e.nextSibling(t);n&&(r=n)!==t;)n=s.e.nextSibling(r),i(r,n)}function f(n,i){if(n.length){var r=n[0],u=n[n.length-1],f=r.parentNode,e=s.L.instance,o=e.preprocessNode;if(o){if(t(r,u,function(n,t){var f=n.previousSibling,i=o.call(e,n);i&&(n===r&&(r=i[0]||t),n===u&&(u=i[i.length-1]||f))}),n.length=0,!r)return;r===u?n.push(r):(n.push(r,u),s.a.na(n,f))}t(r,u,function(n){1!==n.nodeType&&8!==n.nodeType||s.ub(i,n)});t(r,u,function(n){1!==n.nodeType&&8!==n.nodeType||s.H.Xb(n,[i])});s.a.na(n,f)}}function i(n){return n.nodeType?n:0<n.length?n[0]:null}function e(n,t,u,e,o){o=o||{};var h=(n&&i(n)||u||{}).ownerDocument,c=o.templateEngine||r;if(s.kb.lc(u,c,h),u=c.renderTemplate(u,e,o,h),"number"!=typeof u.length||0<u.length&&"number"!=typeof u[0].nodeType)throw Error("Template engine must return an array of DOM nodes");h=!1;switch(t){case"replaceChildren":s.e.T(n,u);h=!0;break;case"replaceNode":s.a.Qb(n,u);h=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t);}return h&&(f(u,e),o.afterRender&&s.k.u(o.afterRender,null,[u,e.$data])),u}function o(n,t,i){return s.F(n)?n():"function"==typeof n?n(t,i):n}var r,u;s.hb=function(t){if(t!=n&&!(t instanceof s.J))throw Error("templateEngine must inherit from ko.templateEngine");r=t};s.eb=function(t,u,f,h,c){if(f=f||{},(f.templateEngine||r)==n)throw Error("Set a template engine before calling renderTemplate");if(c=c||"replaceChildren",h){var l=i(h);return s.j(function(){var n=u&&u instanceof s.N?u:new s.N(s.a.c(u)),r=o(t,n.$data,n),n=e(h,c,r,n,f);"replaceNode"==c&&(h=n,l=i(h))},null,{Pa:function(){return!l||!s.a.Qa(l)},q:l&&"replaceNode"==c?l.parentNode:l})}return s.H.$a(function(n){s.eb(t,u,f,n,"replaceNode")})};s.Cc=function(t,i,r,u,h){function l(n,t){f(t,c);r.afterRender&&r.afterRender(t,n);c=null}function a(n,i){c=h.createChildContext(n,r.as,function(n){n.$index=i});var u=o(t,n,c);return e(null,"ignoreTargetNode",u,c,r)}var c;return s.j(function(){var t=s.a.c(i)||[];"undefined"==typeof t.length&&(t=[t]);t=s.a.xa(t,function(t){return r.includeDestroyed||t===n||null===t||!s.a.c(t._destroy)});s.k.u(s.a.fb,null,[u,t,a,r,l])},null,{q:u})};u=s.a.f.I();s.d.template={init:function(n,t){var i=s.a.c(t());if("string"==typeof i||i.name)s.e.ma(n);else{if("nodes"in i){if(i=i.nodes||[],s.F(i))throw Error('The "nodes" option must be a plain, non-observable array.');}else i=s.e.childNodes(n);i=s.a.Jb(i);new s.t.ha(n).nodes(i)}return{controlsDescendantBindings:!0}},update:function(t,i,r,f,e){var h=i(),o;i=s.a.c(h);r=!0;f=null;"string"==typeof i?i={}:(h=i.name,"if"in i&&(r=s.a.c(i["if"])),r&&"ifnot"in i&&(r=!s.a.c(i.ifnot)),o=s.a.c(i.data));"foreach"in i?f=s.Cc(h||t,r&&i.foreach||[],i,t,e):r?(e="data"in i?e.createChildContext(o,i.as):e,f=s.eb(h||t,e,i,t)):s.e.ma(t);e=f;(o=s.a.f.get(t,u))&&"function"==typeof o.p&&o.p();s.a.f.set(t,u,e&&e.$()?e:n)}};s.h.ka.template=function(n){return n=s.h.bb(n),1==n.length&&n[0].unknown||s.h.vc(n,"name")?null:"This template engine does not support anonymous templates nested within its templates"};s.e.R.template=!0}();s.b("setTemplateEngine",s.hb);s.b("renderTemplate",s.eb);s.a.Cb=function(n,t,i){if(n.length&&t.length)for(var o,r,f,e,u=o=0;(!i||u<i)&&(f=n[o]);++o){for(r=0;e=t[r];++r)if(f.value===e.value){f.moved=e.index;e.moved=f.index;t.splice(r,1);u=r=0;break}u+=r}};s.a.Ma=function(){function n(n,t,i,r,u){for(var o=Math.min,l=Math.max,a=[],c=n.length,f,h=t.length,v=h-c||1,w=c+h+1,y,p,b,e=0;e<=c;e++)for(p=y,a.push(y=[]),b=o(h,e+v),f=l(0,e-1);f<=b;f++)y[f]=f?e?n[e-1]===t[f-1]?p[f-1]:o(p[f]||w,y[f-1]||w)+1:f+1:e+1;for(o=[],l=[],v=[],e=c,f=h;e||f;)h=a[e][f]-1,f&&h===a[e][f-1]?l.push(o[o.length]={status:i,value:t[--f],index:f}):e&&h===a[e-1][f]?v.push(o[o.length]={status:r,value:n[--e],index:e}):(--f,--e,u.sparse||o.push({status:"retained",value:t[f]}));return s.a.Cb(l,v,10*c),o.reverse()}return function(t,i,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],i=i||[],t.length<=i.length?n(t,i,"added","deleted",r):n(i,t,"deleted","added",r)}}();s.b("utils.compareArrays",s.a.Ma),function(){function i(t,i,r,u,f){var e=[],o=s.j(function(){var n=i(r,f,s.a.na(e,t))||[];0<e.length&&(s.a.Qb(e,n),u&&s.k.u(u,null,[r,n,f]));e.length=0;s.a.ia(e,n)},null,{q:t,Pa:function(){return!s.a.tb(e)}});return{aa:e,j:o.$()?o:n}}var t=s.a.f.I();s.a.fb=function(r,u,f,e,o){function rt(n,t){h=k[t];nt!==t&&(it[n]=h);h.Ua(nt++);s.a.na(h.aa,r);g.push(h);p.push(h)}function v(n,t){if(n)for(var i=0,r=t.length;i<r;i++)t[i]&&s.a.o(t[i].aa,function(r){n(r,i,t[i].wa)})}var c,y,ut;u=u||[];e=e||{};var y=s.a.f.get(r,t)===n,k=s.a.f.get(r,t)||[],d=s.a.Ka(k,function(n){return n.wa}),l=s.a.Ma(d,u,e.dontLimitMoves),g=[],a=0,nt=0,tt=[],p=[];u=[];for(var it=[],d=[],h,c=0,w,b;w=l[c];c++)switch(b=w.moved,w.status){case"deleted":b===n&&(h=k[a],h.j&&h.j.p(),tt.push.apply(tt,s.a.na(h.aa,r)),e.beforeRemove&&(u[c]=h,p.push(h)));a++;break;case"retained":rt(c,a++);break;case"added":b!==n?rt(c,b):(h={wa:w.value,Ua:s.r(nt++)},g.push(h),p.push(h),y||(d[c]=h))}for(v(e.beforeMove,it),s.a.o(tt,e.beforeRemove?s.S:s.removeNode),c=0,y=s.e.firstChild(r);h=p[c];c++){for(h.aa||s.a.extend(h,i(r,f,h.wa,o,h.Ua)),a=0;l=h.aa[a];y=l.nextSibling,ut=l,a++)l!==y&&s.e.Fb(r,l,ut);!h.rc&&o&&(o(h.wa,h.aa,h.Ua),h.rc=!0)}v(e.beforeRemove,u);v(e.afterMove,it);v(e.afterAdd,d);s.a.f.set(r,t,g)}}();s.b("utils.setDomNodeChildrenFromArrayMapping",s.a.fb);s.P=function(){this.allowTemplateRewriting=!1};s.P.prototype=new s.J;s.P.prototype.renderTemplateSource=function(n,t,i,r){return(t=(9>s.a.M?0:n.nodes)?n.nodes():null)?s.a.O(t.cloneNode(!0).childNodes):(n=n.text(),s.a.ca(n,r))};s.P.Va=new s.P;s.hb(s.P.Va);s.b("nativeTemplateEngine",s.P),function(){s.Ya=function(){var n=this.uc=function(){if(!t||!t.tmpl)return 0;try{if(0<=t.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(n){}return 1}();this.renderTemplateSource=function(i,u,f,e){if(e=e||r,f=f||{},2>n)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var o=i.data("precompiled");return o||(o=i.text()||"",o=t.template(null,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),i.data("precompiled",o)),i=[u.$data],u=t.extend({koBindingContext:u},f.templateOptions),u=t.tmpl(o,i,u),u.appendTo(e.createElement("div")),t.fragments={},u};this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"};this.addTemplate=function(n,t){r.write("<script type='text/html' id='"+n+"'>"+t+"<\/script>")};0<n&&(t.tmpl.tag.ko_code={open:"__.push($1 || '');"},t.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};s.Ya.prototype=new s.J;var n=new s.Ya;0<n.uc&&s.hb(n);s.b("jqueryTmplTemplateEngine",s.Ya)}()})})()})(),function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.React=n()}}(function(){return function n(t,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!t[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){"use strict";var r=n(25),i=n(31),u=n(42),f=n(34),e=n(69),o=n(98),s=n(100),h=n(127),c=n(122),l=n(170);i.addons={CSSTransitionGroup:f,LinkedStateMixin:r,PureRenderMixin:u,TransitionGroup:o,batchedUpdates:s.batchedUpdates,classSet:h,cloneWithProps:c,createFragment:e.create,update:l};!0&&(i.addons.Perf=n(61),i.addons.TestUtils=n(95));t.exports=i},{"100":100,"122":122,"127":127,"170":170,"25":25,"31":31,"34":34,"42":42,"61":61,"69":69,"95":95,"98":98}],2:[function(n,t){"use strict";var i=n(134),r={componentDidMount:function(){this.props.autoFocus&&i(this.getDOMNode())}};t.exports=r},{"134":134}],3:[function(n,t){"use strict";function rt(){var n=window.opera;return typeof n=="object"&&typeof n.version=="function"&&parseInt(n.version(),10)<=12}function ut(n){return(n.ctrlKey||n.altKey||n.metaKey)&&!(n.ctrlKey&&n.altKey)}function ft(n){switch(n){case i.topCompositionStart:return u.compositionStart;case i.topCompositionEnd:return u.compositionEnd;case i.topCompositionUpdate:return u.compositionUpdate}}function et(n,t){return n===i.topKeyDown&&t.keyCode===l}function b(n,t){switch(n){case i.topKeyUp:return it.indexOf(t.keyCode)!==-1;case i.topKeyDown:return t.keyCode!==l;case i.topKeyPress:case i.topMouseDown:case i.topBlur:return!0;default:return!1}}function k(n){var t=n.detail;return typeof t=="object"&&"data"in t?t.data:null}function ot(n,t,i,f){var e,l,o,v;return(a?e=ft(n):r?b(n,f)&&(e=u.compositionEnd):et(n,f)&&(e=u.compositionStart),!e)?null:(s&&(r||e!==u.compositionStart?e===u.compositionEnd&&r&&(l=r.getData()):r=c.getPooled(t)),o=nt.getPooled(e,i,f),l?o.data=l:(v=k(f),v!==null&&(o.data=v)),h.accumulateTwoPhaseDispatches(o),o)}function st(n,t){var u,r;switch(n){case i.topCompositionEnd:return k(t);case i.topKeyPress:return(u=t.which,u!==y)?null:(w=!0,p);case i.topTextInput:return(r=t.data,r===p&&w)?null:r;default:return null}}function ht(n,t){if(r){if(n===i.topCompositionEnd||b(n,t)){var u=r.getData();return c.release(r),r=null,u}return null}switch(n){case i.topPaste:return null;case i.topKeyPress:return t.which&&!ut(t)?String.fromCharCode(t.which):null;case i.topCompositionEnd:return s?null:t.data;default:return null}}function ct(n,t,i,r){var e,f;return(e=v?st(n,r):ht(n,r),!e)?null:(f=tt.getPooled(u.beforeInput,i,r),f.data=e,h.accumulateTwoPhaseDispatches(f),f)}var g=n(16),h=n(21),o=n(22),c=n(23),nt=n(106),tt=n(110),f=n(157),it=[9,13,27,32],l=229,a=o.canUseDOM&&"CompositionEvent"in window,e=null,v,s,r,d;o.canUseDOM&&"documentMode"in document&&(e=document.documentMode);v=o.canUseDOM&&"TextEvent"in window&&!e&&!rt();s=o.canUseDOM&&(!a||e&&e>8&&e<=11);var y=32,p=String.fromCharCode(y),i=g.topLevelTypes,u={beforeInput:{phasedRegistrationNames:{bubbled:f({onBeforeInput:null}),captured:f({onBeforeInputCapture:null})},dependencies:[i.topCompositionEnd,i.topKeyPress,i.topTextInput,i.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:f({onCompositionEnd:null}),captured:f({onCompositionEndCapture:null})},dependencies:[i.topBlur,i.topCompositionEnd,i.topKeyDown,i.topKeyPress,i.topKeyUp,i.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:f({onCompositionStart:null}),captured:f({onCompositionStartCapture:null})},dependencies:[i.topBlur,i.topCompositionStart,i.topKeyDown,i.topKeyPress,i.topKeyUp,i.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:f({onCompositionUpdate:null}),captured:f({onCompositionUpdateCapture:null})},dependencies:[i.topBlur,i.topCompositionUpdate,i.topKeyDown,i.topKeyPress,i.topKeyUp,i.topMouseDown]}},w=!1;r=null;d={eventTypes:u,extractEvents:function(n,t,i,r){return[ot(n,t,i,r),ct(n,t,i,r)]}};t.exports=d},{"106":106,"110":110,"157":157,"16":16,"21":21,"22":22,"23":23}],4:[function(n,t){var i=n(150),r={addClass:function(n,t){return i(!/\s/.test(t),'CSSCore.addClass takes only a single class name. "%s" contains multiple classes.',t),t&&(n.classList?n.classList.add(t):r.hasClass(n,t)||(n.className=n.className+" "+t)),n},removeClass:function(n,t){return i(!/\s/.test(t),'CSSCore.removeClass takes only a single class name. "%s" contains multiple classes.',t),t&&(n.classList?n.classList.remove(t):r.hasClass(n,t)&&(n.className=n.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),n},conditionClass:function(n,t,i){return(i?r.addClass:r.removeClass)(n,t)},hasClass:function(n,t){return(i(!/\s/.test(t),"CSS.hasClass takes only a single class name."),n.classList)?!!t&&n.classList.contains(t):(" "+n.className+" ").indexOf(" "+t+" ")>-1}};t.exports=r},{"150":150}],5:[function(n,t){"use strict";function f(n,t){return n+t.charAt(0).toUpperCase()+t.substring(1)}var i={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},e=["Webkit","ms","Moz","O"],r,u;Object.keys(i).forEach(function(n){e.forEach(function(t){i[f(t,n)]=i[n]})});r={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}};u={isUnitlessNumber:i,shorthandPropertyExpansions:r};t.exports=u},{}],6:[function(n,t){"use strict";var c=n(5),l=n(22),a=n(121),f=n(128),v=n(148),y=n(159),r=n(171),p=y(function(n){return v(n)}),e="cssFloat",h;if(l.canUseDOM&&document.documentElement.style.cssFloat===undefined&&(e="styleFloat"),!0)var w=/^(?:webkit|moz|o)[A-Z]/,o=/;\s*$/,i={},u={},b=function(n){i.hasOwnProperty(n)&&i[n]||(i[n]=!0,r(!1,"Unsupported style property %s. Did you mean %s?",n,a(n)))},k=function(n){i.hasOwnProperty(n)&&i[n]||(i[n]=!0,r(!1,"Unsupported vendor-prefixed style property %s. Did you mean %s?",n,n.charAt(0).toUpperCase()+n.slice(1)))},d=function(n,t){u.hasOwnProperty(t)&&u[t]||(u[t]=!0,r(!1,'Style property values shouldn\'t contain a semicolon. Try "%s: %s" instead.',n,t.replace(o,"")))},s=function(n,t){n.indexOf("-")>-1?b(n):w.test(n)?k(n):o.test(t)&&d(n,t)};h={createMarkupForStyles:function(n){var r="",t,i;for(t in n)n.hasOwnProperty(t)&&(i=n[t],!0&&s(t,i),i!=null&&(r+=p(t)+":",r+=f(t,i)+";"));return r||null},setValueForStyles:function(n,t){var r=n.style,i,u,o,h;for(i in t)if(t.hasOwnProperty(i))if(!0&&s(i,t[i]),u=f(i,t[i]),i==="float"&&(i=e),u)r[i]=u;else if(o=c.shorthandPropertyExpansions[i],o)for(h in o)r[h]="";else r[i]=""}};t.exports=h},{"121":121,"128":128,"148":148,"159":159,"171":171,"22":22,"5":5}],7:[function(n,t){"use strict";function i(){this._callbacks=null;this._contexts=null}var u=n(30),f=n(29),r=n(150);f(i.prototype,{enqueue:function(n,t){this._callbacks=this._callbacks||[];this._contexts=this._contexts||[];this._callbacks.push(n);this._contexts.push(t)},notifyAll:function(){var n=this._callbacks,i=this._contexts,t,u;if(n){for(r(n.length===i.length,"Mismatched list of contexts in callback queue"),this._callbacks=null,this._contexts=null,t=0,u=n.length;t<u;t++)n[t].call(i[t]);n.length=0;i.length=0}},reset:function(){this._callbacks=null;this._contexts=null},destructor:function(){this.reset()}});u.addPoolingTo(i);t.exports=i},{"150":150,"29":29,"30":30}],8:[function(n,t){"use strict";function ut(n){return n.nodeName==="SELECT"||n.nodeName==="INPUT"&&n.type==="file"}function s(n){var t=v.getPooled(o.change,f,n);l.accumulateTwoPhaseDispatches(t);it.batchedUpdates(ft,t)}function ft(n){c.enqueueEvents(n);c.processEventQueue()}function et(n,t){r=n;f=t;r.attachEvent("onchange",s)}function b(){r&&(r.detachEvent("onchange",s),r=null,f=null)}function ot(n,t,r){if(n===i.topChange)return r}function st(n,t,r){n===i.topFocus?(b(),et(t,r)):n===i.topBlur&&b()}function ht(n,t){r=n;f=t;u=n.value;e=Object.getOwnPropertyDescriptor(n.constructor.prototype,"value");Object.defineProperty(r,"value",k);r.attachEvent("onpropertychange",g)}function d(){r&&(delete r.value,r.detachEvent("onpropertychange",g),r=null,f=null,u=null,e=null)}function g(n){if(n.propertyName==="value"){var t=n.srcElement.value;t!==u&&(u=t,s(n))}}function ct(n,t,r){if(n===i.topInput)return r}function lt(n,t,r){n===i.topFocus?(d(),ht(t,r)):n===i.topBlur&&d()}function at(n){if((n===i.topSelectionChange||n===i.topKeyUp||n===i.topKeyDown)&&r&&r.value!==u)return u=r.value,f}function vt(n){return n.nodeName==="INPUT"&&(n.type==="checkbox"||n.type==="radio")}function yt(n,t,r){if(n===i.topClick)return r}var tt=n(16),c=n(18),l=n(21),a=n(22),it=n(100),v=n(108),y=n(151),rt=n(153),p=n(157),i=tt.topLevelTypes,o={change:{phasedRegistrationNames:{bubbled:p({onChange:null}),captured:p({onChangeCapture:null})},dependencies:[i.topBlur,i.topChange,i.topClick,i.topFocus,i.topInput,i.topKeyDown,i.topKeyUp,i.topSelectionChange]}},r=null,f=null,u=null,e=null,w=!1,h,k,nt;a.canUseDOM&&(w=y("change")&&(!("documentMode"in document)||document.documentMode>8));h=!1;a.canUseDOM&&(h=y("input")&&(!("documentMode"in document)||document.documentMode>9));k={get:function(){return e.get.call(this)},set:function(n){u=""+n;e.set.call(this,n)}};nt={eventTypes:o,extractEvents:function(n,t,i,r){var u,f,e,s;if(ut(t)?w?u=ot:f=st:rt(t)?h?u=ct:(u=at,f=lt):vt(t)&&(u=yt),u&&(e=u(n,t,i),e))return s=v.getPooled(o.change,e,r),l.accumulateTwoPhaseDispatches(s),s;f&&f(n,t,i)}};t.exports=nt},{"100":100,"108":108,"151":151,"153":153,"157":157,"16":16,"18":18,"21":21,"22":22}],9:[function(n,t){"use strict";var i=0,r={createReactRootIndex:function(){return i++}};t.exports=r},{}],10:[function(n,t){"use strict";function e(n,t,i){n.insertBefore(t,n.childNodes[i]||null)}var r=n(13),i=n(79),u=n(165),f=n(150),o={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:u,processUpdates:function(n,t){for(var w,c,v,o,h=null,s=null,y=0;y<n.length;y++)if(o=n[y],o.type===i.MOVE_EXISTING||o.type===i.REMOVE_NODE){var p=o.fromIndex,l=o.parentNode.childNodes[p],a=o.parentID;f(l,"processUpdates(): Unable to find child %s of element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting tags like <form>, <p>, or <a>, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",p,a);h=h||{};h[a]=h[a]||[];h[a][p]=l;s=s||[];s.push(l)}if(w=r.dangerouslyRenderMarkup(t),s)for(c=0;c<s.length;c++)s[c].parentNode.removeChild(s[c]);for(v=0;v<n.length;v++){o=n[v];switch(o.type){case i.INSERT_MARKUP:e(o.parentNode,w[o.markupIndex],o.toIndex);break;case i.MOVE_EXISTING:e(o.parentNode,h[o.parentID][o.fromIndex],o.toIndex);break;case i.TEXT_CONTENT:u(o.parentNode,o.textContent)}}}};t.exports=o},{"13":13,"150":150,"165":165,"79":79}],11:[function(n,t){"use strict";function f(n,t){return(n&t)===t}var r=n(150),u={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(n){var h=n.Properties||{},c=n.DOMAttributeNames||{},l=n.DOMPropertyNames||{},a=n.DOMMutationMethods||{},t,o,s,e;n.isCustomAttribute&&i._isCustomAttributeFunctions.push(n.isCustomAttribute);for(t in h)r(!i.isStandardName.hasOwnProperty(t),"injectDOMPropertyConfig(...): You're trying to inject DOM property '%s' which has already been injected. You may be accidentally injecting the same DOM property config twice, or you may be injecting two configs that have conflicting property names.",t),i.isStandardName[t]=!0,o=t.toLowerCase(),i.getPossibleStandardName[o]=t,c.hasOwnProperty(t)?(s=c[t],i.getPossibleStandardName[s]=t,i.getAttributeName[t]=s):i.getAttributeName[t]=o,i.getPropertyName[t]=l.hasOwnProperty(t)?l[t]:t,i.getMutationMethod[t]=a.hasOwnProperty(t)?a[t]:null,e=h[t],i.mustUseAttribute[t]=f(e,u.MUST_USE_ATTRIBUTE),i.mustUseProperty[t]=f(e,u.MUST_USE_PROPERTY),i.hasSideEffects[t]=f(e,u.HAS_SIDE_EFFECTS),i.hasBooleanValue[t]=f(e,u.HAS_BOOLEAN_VALUE),i.hasNumericValue[t]=f(e,u.HAS_NUMERIC_VALUE),i.hasPositiveNumericValue[t]=f(e,u.HAS_POSITIVE_NUMERIC_VALUE),i.hasOverloadedBooleanValue[t]=f(e,u.HAS_OVERLOADED_BOOLEAN_VALUE),r(!i.mustUseAttribute[t]||!i.mustUseProperty[t],"DOMProperty: Cannot require using both attribute and property: %s",t),r(i.mustUseProperty[t]||!i.hasSideEffects[t],"DOMProperty: Properties that have side effects must use property: %s",t),r(!!i.hasBooleanValue[t]+!!i.hasNumericValue[t]+!!i.hasOverloadedBooleanValue[t]<=1,"DOMProperty: Value can be one of boolean, overloaded boolean, or numeric value, but not a combination: %s",t)}},e={},i={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(n){for(var r,t=0;t<i._isCustomAttributeFunctions.length;t++)if(r=i._isCustomAttributeFunctions[t],r(n))return!0;return!1},getDefaultValueForProperty:function(n,t){var i=e[n],r;return i||(e[n]=i={}),t in i||(r=document.createElement(n),i[t]=r[t]),i[t]},injection:u};t.exports=i},{"150":150}],12:[function(n,t){"use strict";function e(n,t){return t==null||i.hasBooleanValue[n]&&!t||i.hasNumericValue[n]&&isNaN(t)||i.hasPositiveNumericValue[n]&&t<1||i.hasOverloadedBooleanValue[n]&&t===!1}var i=n(11),r=n(163),h=n(171),s;if(1)var o={children:!0,dangerouslySetInnerHTML:!0,key:!0,ref:!0},u={},f=function(n){if((!o.hasOwnProperty(n)||!o[n])&&(!u.hasOwnProperty(n)||!u[n])){u[n]=!0;var t=n.toLowerCase(),r=i.isCustomAttribute(t)?t:i.getPossibleStandardName.hasOwnProperty(t)?i.getPossibleStandardName[t]:null;h(r==null,"Unknown DOM property %s. Did you mean %s?",n,r)}};s={createMarkupForID:function(n){return i.ID_ATTRIBUTE_NAME+"="+r(n)},createMarkupForProperty:function(n,t){if(i.isStandardName.hasOwnProperty(n)&&i.isStandardName[n]){if(e(n,t))return"";var u=i.getAttributeName[n];return i.hasBooleanValue[n]||i.hasOverloadedBooleanValue[n]&&t===!0?u:u+"="+r(t)}return i.isCustomAttribute(n)?t==null?"":n+"="+r(t):(!0&&f(n),null)},setValueForProperty:function(n,t,r){var u,o;i.isStandardName.hasOwnProperty(t)&&i.isStandardName[t]?(u=i.getMutationMethod[t],u?u(n,r):e(t,r)?this.deleteValueForProperty(n,t):i.mustUseAttribute[t]?n.setAttribute(i.getAttributeName[t],""+r):(o=i.getPropertyName[t],i.hasSideEffects[t]&&""+n[o]==""+r||(n[o]=r))):i.isCustomAttribute(t)?r==null?n.removeAttribute(t):n.setAttribute(t,""+r):!0&&f(t)},deleteValueForProperty:function(n,t){var u,r,e;i.isStandardName.hasOwnProperty(t)&&i.isStandardName[t]?(u=i.getMutationMethod[t],u?u(n,undefined):i.mustUseAttribute[t]?n.removeAttribute(i.getAttributeName[t]):(r=i.getPropertyName[t],e=i.getDefaultValueForProperty(n.nodeName,r),i.hasSideEffects[t]&&""+n[r]===e||(n[r]=e))):i.isCustomAttribute(t)?n.removeAttribute(t):!0&&f(t)}};t.exports=s},{"11":11,"163":163,"171":171}],13:[function(n,t){"use strict";function h(n){return n.substring(1,n.indexOf(" "))}var r=n(22),f=n(126),e=n(129),o=n(142),i=n(150),s=/^(<[^ \/>]+)/,u="data-danger-index",c={dangerouslyRenderMarkup:function(n){var t,v,a,c,w,p,l,d,k,b,y;for(i(r.canUseDOM,"dangerouslyRenderMarkup(...): Cannot render markup in a worker thread. Make sure `window` and `document` are available globally before requiring React when unit testing or use React.renderToString for server rendering."),v={},a=0;a<n.length;a++)i(n[a],"dangerouslyRenderMarkup(...): Missing markup."),t=h(n[a]),t=o(t)?t:"*",v[t]=v[t]||[],v[t][a]=n[a];c=[];w=0;for(t in v)if(v.hasOwnProperty(t)){p=v[t];for(l in p)p.hasOwnProperty(l)&&(d=p[l],p[l]=d.replace(s,"$1 "+u+'="'+l+'" '));for(k=f(p.join(""),e),b=0;b<k.length;++b)y=k[b],y.hasAttribute&&y.hasAttribute(u)?(l=+y.getAttribute(u),y.removeAttribute(u),i(!c.hasOwnProperty(l),"Danger: Assigning to an already-occupied result index."),c[l]=y,w+=1):!0&&console.error("Danger: Discarding unexpected node:",y)}return i(w===c.length,"Danger: Did not assign to every index of resultList."),i(c.length===n.length,"Danger: Expected markup to render %s nodes, but rendered %s.",n.length,c.length),c},dangerouslyReplaceNodeWithMarkup:function(n,t){i(r.canUseDOM,"dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a worker thread. Make sure `window` and `document` are available globally before requiring React when unit testing or use React.renderToString for server rendering.");i(t,"dangerouslyReplaceNodeWithMarkup(...): Missing markup.");i(n.tagName.toLowerCase()!=="html","dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the <html> node. This is because browser quirks make this unreliable and/or slow. If you want to render to the root you must use server rendering. See React.renderToString().");var u=f(t,e)[0];n.parentNode.replaceChild(u,n)}};t.exports=c},{"126":126,"129":129,"142":142,"150":150,"22":22}],14:[function(n,t){"use strict";var i=n(157),r=[i({ResponderEventPlugin:null}),i({SimpleEventPlugin:null}),i({TapEventPlugin:null}),i({EnterLeaveEventPlugin:null}),i({ChangeEventPlugin:null}),i({SelectEventPlugin:null}),i({BeforeInputEventPlugin:null}),i({AnalyticsEventPlugin:null}),i({MobileSafariClickEventPlugin:null})];t.exports=r},{"157":157}],15:[function(n,t){"use strict";var s=n(16),h=n(21),e=n(112),r=n(77),o=n(157),i=s.topLevelTypes,c=r.getFirstReactDOM,u={mouseEnter:{registrationName:o({onMouseEnter:null}),dependencies:[i.topMouseOut,i.topMouseOver]},mouseLeave:{registrationName:o({onMouseLeave:null}),dependencies:[i.topMouseOut,i.topMouseOver]}},f=[null,null],l={eventTypes:u,extractEvents:function(n,t,o,s){var p,w,l,a,v;if(n===i.topMouseOver&&(s.relatedTarget||s.fromElement)||n!==i.topMouseOut&&n!==i.topMouseOver||(t.window===t?p=t:(w=t.ownerDocument,p=w?w.defaultView||w.parentWindow:window),n===i.topMouseOut?(l=t,a=c(s.relatedTarget||s.toElement)||p):(l=p,a=t),l===a))return null;var b=l?r.getID(l):"",k=a?r.getID(a):"",y=e.getPooled(u.mouseLeave,b,s);return y.type="mouseleave",y.target=l,y.relatedTarget=a,v=e.getPooled(u.mouseEnter,k,s),v.type="mouseenter",v.target=a,v.relatedTarget=l,h.accumulateEnterLeaveDispatches(y,v,b,k),f[0]=y,f[1]=v,f}};t.exports=l},{"112":112,"157":157,"16":16,"21":21,"77":77}],16:[function(n,t){"use strict";var i=n(156),r=i({bubbled:null,captured:null}),u=i({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),f={topLevelTypes:u,PropagationPhases:r};t.exports=f},{"156":156}],17:[function(n,t){var i=n(129),r={listen:function(n,t,i){return n.addEventListener?(n.addEventListener(t,i,!1),{remove:function(){n.removeEventListener(t,i,!1)}}):n.attachEvent?(n.attachEvent("on"+t,i),{remove:function(){n.detachEvent("on"+t,i)}}):void 0},capture:function(n,t,r){return n.addEventListener?(n.addEventListener(t,r,!0),{remove:function(){n.removeEventListener(t,r,!0)}}):(!0&&console.error("Attempted to listen to events during the capture phase on a browser that does not support the capture phase. Your application will not receive some events."),{remove:i})},registerDefault:function(){}};t.exports=r},{"129":129}],18:[function(n,t){"use strict";function h(){var n=e&&e.traverseTwoPhase&&e.traverseEnterLeave;u(n,"InstanceHandle not injected before use!")}var r=n(19),o=n(20),s=n(118),c=n(135),u=n(150),i={},f=null,l=function(n){if(n){var i=o.executeDispatch,t=r.getPluginModuleForEvent(n);t&&t.executeDispatch&&(i=t.executeDispatch);o.executeDispatchesInOrder(n,i);n.isPersistent()||n.constructor.release(n)}},e=null,a={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(n){e=n;!0&&h()},getInstanceHandle:function(){return!0&&h(),e},injectEventPluginOrder:r.injectEventPluginOrder,injectEventPluginsByName:r.injectEventPluginsByName},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:function(n,t,r){u(!r||typeof r=="function","Expected %s listener to be a function, instead got type %s",t,typeof r);var f=i[t]||(i[t]={});f[n]=r},getListener:function(n,t){var r=i[t];return r&&r[n]},deleteListener:function(n,t){var r=i[t];r&&delete r[n]},deleteAllListeners:function(n){for(var t in i)delete i[t][n]},extractEvents:function(n,t,i,u){for(var o,h,f,c=r.plugins,e=0,l=c.length;e<l;e++)o=c[e],o&&(h=o.extractEvents(n,t,i,u),h&&(f=s(f,h)));return f},enqueueEvents:function(n){n&&(f=s(f,n))},processEventQueue:function(){var n=f;f=null;c(n,l);u(!f,"processEventQueue(): Additional events were enqueued while processing an event queue. Support for this has not yet been implemented.")},__purge:function(){i={}},__getListenerBank:function(){return i}};t.exports=a},{"118":118,"135":135,"150":150,"19":19,"20":20}],19:[function(n,t){"use strict";function e(){var t,n,s,h,e;if(f)for(t in u)if(n=u[t],s=f.indexOf(t),r(s>-1,"EventPluginRegistry: Cannot inject event plugins that do not exist in the plugin ordering, `%s`.",t),!i.plugins[s]){r(n.extractEvents,"EventPluginRegistry: Event plugins must implement an `extractEvents` method, but `%s` does not.",t);i.plugins[s]=n;h=n.eventTypes;for(e in h)r(o(h[e],n,e),"EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.",e,t)}}function o(n,t,u){var f,e,o;if(r(!i.eventNameDispatchConfigs.hasOwnProperty(u),"EventPluginHub: More than one plugin attempted to publish the same event name, `%s`.",u),i.eventNameDispatchConfigs[u]=n,f=n.phasedRegistrationNames,f){for(e in f)f.hasOwnProperty(e)&&(o=f[e],s(o,t,u));return!0}return n.registrationName?(s(n.registrationName,t,u),!0):!1}function s(n,t,u){r(!i.registrationNameModules[n],"EventPluginHub: More than one plugin attempted to publish the same registration name, `%s`.",n);i.registrationNameModules[n]=t;i.registrationNameDependencies[n]=t.eventTypes[u].dependencies}var r=n(150),f=null,u={},i={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(n){r(!f,"EventPluginRegistry: Cannot inject event plugin ordering more than once. You are likely trying to load more than one copy of React.");f=Array.prototype.slice.call(n);e()},injectEventPluginsByName:function(n){var f=!1,t,i;for(t in n)n.hasOwnProperty(t)&&(i=n[t],u.hasOwnProperty(t)&&u[t]===i||(r(!u[t],"EventPluginRegistry: Cannot inject two different event plugins using the same name, `%s`.",t),u[t]=i,f=!0));f&&e()},getPluginModuleForEvent:function(n){var t=n.dispatchConfig,r,u;if(t.registrationName)return i.registrationNameModules[t.registrationName]||null;for(r in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(r)&&(u=i.registrationNameModules[t.phasedRegistrationNames[r]],u))return u;return null},_resetEventPlugins:function(){var r,n,e,t,o;f=null;for(r in u)u.hasOwnProperty(r)&&delete u[r];i.plugins.length=0;n=i.eventNameDispatchConfigs;for(e in n)n.hasOwnProperty(e)&&delete n[e];t=i.registrationNameModules;for(o in t)t.hasOwnProperty(o)&&delete t[o]}};t.exports=i},{"150":150}],20:[function(n,t){"use strict";function s(n){return n===i.topMouseUp||n===i.topTouchEnd||n===i.topTouchCancel}function h(n){return n===i.topMouseMove||n===i.topTouchMove}function c(n){return n===i.topMouseDown||n===i.topTouchStart}function l(n,t){var i=n._dispatchListeners,f=n._dispatchIDs,r;if(!0&&u(n),Array.isArray(i))for(r=0;r<i.length;r++){if(n.isPropagationStopped())break;t(n,i[r],f[r])}else i&&t(n,i,f)}function a(n,t,i){n.currentTarget=f.Mount.getNode(i);var r=t(n,i);return n.currentTarget=null,r}function v(n,t){l(n,t);n._dispatchListeners=null;n._dispatchIDs=null}function y(n){var i=n._dispatchListeners,r=n._dispatchIDs,t;if(!0&&u(n),Array.isArray(i))for(t=0;t<i.length;t++){if(n.isPropagationStopped())break;if(i[t](n,r[t]))return r[t]}else if(i&&i(n,r))return r;return null}function p(n){var t=y(n);return n._dispatchIDs=null,n._dispatchListeners=null,t}function w(n){var t,i,f;return!0&&u(n),t=n._dispatchListeners,i=n._dispatchIDs,r(!Array.isArray(t),"executeDirectDispatch(...): Invalid `event`."),f=t?t(n,i):null,n._dispatchListeners=null,n._dispatchIDs=null,f}function b(n){return!!n._dispatchListeners}var o=n(16),r=n(150),f={Mount:null,injectMount:function(n){f.Mount=n;!0&&r(n&&n.getNode,"EventPluginUtils.injection.injectMount(...): Injected Mount module is missing getNode.")}},i=o.topLevelTypes,u,e;!0&&(u=function(n){var t=n._dispatchListeners,i=n._dispatchIDs,u=Array.isArray(t),f=Array.isArray(i),e=f?i.length:i?1:0,o=u?t.length:t?1:0;r(f===u&&e===o,"EventPluginUtils: Invalid `event`.")});e={isEndish:s,isMoveish:h,isStartish:c,executeDirectDispatch:w,executeDispatch:a,executeDispatchesInOrder:v,executeDispatchesInOrderStopAtTrue:p,hasDispatches:b,injection:f,useTouchEvents:!1};t.exports=e},{"150":150,"16":16}],21:[function(n,t){"use strict";function h(n,t,i){var r=t.dispatchConfig.phasedRegistrationNames[i];return e(n,r)}function c(n,t,r){if(!0&&!n)throw new Error("Dispatching id must not be null");var e=t?f.bubbled:f.captured,u=h(n,r,e);u&&(r._dispatchListeners=i(r._dispatchListeners,u),r._dispatchIDs=i(r._dispatchIDs,n))}function l(n){n&&n.dispatchConfig.phasedRegistrationNames&&r.injection.getInstanceHandle().traverseTwoPhase(n.dispatchMarker,c,n)}function o(n,t,r){if(r&&r.dispatchConfig.registrationName){var f=r.dispatchConfig.registrationName,u=e(n,f);u&&(r._dispatchListeners=i(r._dispatchListeners,u),r._dispatchIDs=i(r._dispatchIDs,n))}}function a(n){n&&n.dispatchConfig.registrationName&&o(n.dispatchMarker,null,n)}function v(n){u(n,l)}function y(n,t,i,u){r.injection.getInstanceHandle().traverseEnterLeave(i,u,o,n,t)}function p(n){u(n,a)}var s=n(16),r=n(18),i=n(118),u=n(135),f=s.PropagationPhases,e=r.getListener,w={accumulateTwoPhaseDispatches:v,accumulateDirectDispatches:p,accumulateEnterLeaveDispatches:y};t.exports=w},{"118":118,"135":135,"16":16,"18":18}],22:[function(n,t){"use strict";var i=!!(typeof window!="undefined"&&window.document&&window.document.createElement),r={canUseDOM:i,canUseWorkers:typeof Worker!="undefined",canUseEventListeners:i&&!!(window.addEventListener||window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};t.exports=r},{}],23:[function(n,t){"use strict";function i(n){this._root=n;this._startText=this.getText();this._fallbackText=null}var r=n(30),u=n(29),f=n(145);u(i.prototype,{getText:function(){return"value"in this._root?this._root.value:this._root[f()]},getData:function(){var f,e;if(this._fallbackText)return this._fallbackText;for(var r=this._startText,u=r.length,t,i=this.getText(),o=i.length,n=0;n<u;n++)if(r[n]!==i[n])break;for(f=u-n,t=1;t<=f;t++)if(r[u-t]!==i[o-t])break;return e=t>1?1-t:undefined,this._fallbackText=i.slice(n,e),this._fallbackText}});r.addPoolingTo(i);t.exports=i},{"145":145,"29":29,"30":30}],24:[function(n,t){"use strict";var f=n(11),c=n(22),i=f.injection.MUST_USE_ATTRIBUTE,u=f.injection.MUST_USE_PROPERTY,r=f.injection.HAS_BOOLEAN_VALUE,l=f.injection.HAS_SIDE_EFFECTS,a=f.injection.HAS_NUMERIC_VALUE,e=f.injection.HAS_POSITIVE_NUMERIC_VALUE,v=f.injection.HAS_OVERLOADED_BOOLEAN_VALUE,s,o,h;c.canUseDOM&&(o=document.implementation,s=o&&o.hasFeature&&o.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"));h={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:i|r,allowTransparency:i,alt:null,async:r,autoComplete:null,autoPlay:r,cellPadding:null,cellSpacing:null,charSet:i,checked:u|r,classID:i,className:s?i:u,cols:i|e,colSpan:null,content:null,contentEditable:null,contextMenu:i,controls:u|r,coords:null,crossOrigin:null,data:null,dateTime:i,defer:r,dir:null,disabled:i|r,download:v,draggable:null,encType:null,form:i,formAction:i,formEncType:i,formMethod:i,formNoValidate:r,formTarget:i,frameBorder:i,headers:null,height:i,hidden:i|r,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:u,label:null,lang:null,list:i,loop:u|r,low:null,manifest:i,marginHeight:null,marginWidth:null,max:null,maxLength:i,media:i,mediaGroup:null,method:null,min:null,multiple:u|r,muted:u|r,name:null,noValidate:r,open:r,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:u|r,rel:null,required:r,role:i,rows:i|e,rowSpan:null,sandbox:null,scope:null,scoped:r,scrolling:null,seamless:i|r,selected:u|r,shape:null,size:i|e,sizes:i,span:e,spellCheck:null,src:null,srcDoc:u,srcSet:i,start:a,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:u|l,width:i,wmode:i,autoCapitalize:null,autoCorrect:null,itemProp:i,itemScope:i|r,itemType:i,itemID:i,itemRef:i,property:null,unselectable:i},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=h},{"11":11,"22":22}],25:[function(n,t){"use strict";var i=n(75),r=n(94),u={linkState:function(n){return new i(this.state[n],r.createStateKeySetter(this,n))}};t.exports=u},{"75":75,"94":94}],26:[function(n,t){"use strict";function r(n){i(n.props.checkedLink==null||n.props.valueLink==null,"Cannot provide a checkedLink and a valueLink. If you want to use checkedLink, you probably don't want to use valueLink and vice versa.")}function u(n){r(n);i(n.props.value==null&&n.props.onChange==null,"Cannot provide a valueLink and a value or onChange event. If you want to use value or onChange, you probably don't want to use valueLink.")}function f(n){r(n);i(n.props.checked==null&&n.props.onChange==null,"Cannot provide a checkedLink and a checked property or onChange event. If you want to use checked or onChange, you probably don't want to use checkedLink")}function s(n){this.props.valueLink.requestChange(n.target.value)}function h(n){this.props.checkedLink.requestChange(n.target.checked)}var e=n(86),i=n(150),o={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},c={Mixin:{propTypes:{value:function(n,t){return!n[t]||o[n.type]||n.onChange||n.readOnly||n.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(n,t){return!n[t]||n.onChange||n.readOnly||n.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:e.func}},getValue:function(n){return n.props.valueLink?(u(n),n.props.valueLink.value):n.props.value},getChecked:function(n){return n.props.checkedLink?(f(n),n.props.checkedLink.value):n.props.checked},getOnChange:function(n){return n.props.valueLink?(u(n),s):n.props.checkedLink?(f(n),h):n.props.onChange}};t.exports=c},{"150":150,"86":86}],27:[function(n,t){"use strict";function e(n){n.remove()}var r=n(33),u=n(118),f=n(135),i=n(150),o={trapBubbledEvent:function(n,t){var f,e;i(this.isMounted(),"Must be mounted to trap events");f=this.getDOMNode();i(f,"LocalEventTrapMixin.trapBubbledEvent(...): Requires node to be rendered.");e=r.trapBubbledEvent(n,t,f);this._localEventListeners=u(this._localEventListeners,e)},componentWillUnmount:function(){this._localEventListeners&&f(this._localEventListeners,e)}};t.exports=o},{"118":118,"135":135,"150":150,"33":33}],28:[function(n,t){"use strict";var i=n(16),r=n(129),u=i.topLevelTypes,f={eventTypes:null,extractEvents:function(n,t,i,f){if(n===u.topTouchStart){var e=f.target;e&&!e.onclick&&(e.onclick=r)}}};t.exports=f},{"129":129,"16":16}],29:[function(n,t){"use strict";function i(n){var u,e,t,f,i,r;if(n==null)throw new TypeError("Object.assign target cannot be null or undefined");for(u=Object(n),e=Object.prototype.hasOwnProperty,t=1;t<arguments.length;t++)if(f=arguments[t],f!=null){i=Object(f);for(r in i)e.call(i,r)&&(u[r]=i[r])}return u}t.exports=i},{}],30:[function(n,t){"use strict";var i=n(150),r=function(n){var t=this,i;return t.instancePool.length?(i=t.instancePool.pop(),t.call(i,n),i):new t(n)},u=function(n,t){var i=this,r;return i.instancePool.length?(r=i.instancePool.pop(),i.call(r,n,t),r):new i(n,t)},f=function(n,t,i){var r=this,u;return r.instancePool.length?(u=r.instancePool.pop(),r.call(u,n,t,i),u):new r(n,t,i)},e=function(n,t,i,r,u){var f=this,e;return f.instancePool.length?(e=f.instancePool.pop(),f.call(e,n,t,i,r,u),e):new f(n,t,i,r,u)},o=function(n){var t=this;i(n instanceof t,"Trying to release an instance into a pool of a different type.");n.destructor&&n.destructor();t.instancePool.length<t.poolSize&&t.instancePool.push(n)},s=10,h=r,c=function(n,t){var i=n;return i.instancePool=[],i.getPooled=t||h,i.poolSize||(i.poolSize=s),i.release=o,i},l={addPoolingTo:c,oneArgumentPooler:r,twoArgumentPooler:u,threeArgumentPooler:f,fiveArgumentPooler:e};t.exports=l},{"150":150}],31:[function(n,t){"use strict";var p=n(20),f=n(37),w=n(39),b=n(38),k=n(44),d=n(45),r=n(63),e=n(64),g=n(46),nt=n(57),tt=n(60),it=n(72),i=n(77),rt=n(82),ut=n(86),ft=n(89),h=n(92),et=n(29),ot=n(132),st=n(160),v,o,y,s,u;tt.inject();var c=r.createElement,l=r.createFactory,a=r.cloneElement;if(!0&&(c=e.createElement,l=e.createFactory,a=e.cloneElement),v=rt.measure("React","render",i.render),o={Children:{map:f.map,forEach:f.forEach,count:f.count,only:st},Component:w,DOM:g,PropTypes:ut,initializeTouchEvents:function(n){p.useTouchEvents=n},createClass:b.createClass,createElement:c,cloneElement:a,createFactory:l,createMixin:function(n){return n},constructAndRenderComponent:i.constructAndRenderComponent,constructAndRenderComponentByID:i.constructAndRenderComponentByID,findDOMNode:ot,render:v,renderToString:h.renderToString,renderToStaticMarkup:h.renderToStaticMarkup,unmountComponentAtNode:i.unmountComponentAtNode,isValidElement:r.isValidElement,withContext:k.withContext,__spread:et},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:d,InstanceHandles:it,Mount:i,Reconciler:ft,TextComponent:nt}),!0&&(y=n(22),y.canUseDOM&&window.top===window.self))for(navigator.userAgent.indexOf("Chrome")>-1&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"&&console.debug("Download the React DevTools for a better development experience: https://fb.me/react-devtools"),s=[Array.isArray,Array.prototype.every,Array.prototype.forEach,Array.prototype.indexOf,Array.prototype.map,Date.now,Function.prototype.bind,Object.keys,String.prototype.split,String.prototype.trim,Object.create,Object.freeze],u=0;u<s.length;u++)if(!s[u]){console.error("One or more ES5 shim/shams expected by React are not available: https://fb.me/react-warning-polyfills");break}o.version="0.13.3";t.exports=o},{"132":132,"160":160,"20":20,"22":22,"29":29,"37":37,"38":38,"39":39,"44":44,"45":45,"46":46,"57":57,"60":60,"63":63,"64":64,"72":72,"77":77,"82":82,"86":86,"89":89,"92":92}],32:[function(n,t){"use strict";var i=n(132),r={getDOMNode:function(){return i(this)}};t.exports=r},{"132":132}],33:[function(n,t){"use strict";function p(n){return Object.prototype.hasOwnProperty.call(n,f)||(n[f]=y++,e[n[f]]={}),e[n[f]]}var h=n(16),r=n(18),c=n(19),l=n(67),a=n(117),v=n(29),u=n(151),e={},o=!1,y=0,s={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},f="_reactListenersID"+String(Math.random()).slice(2),i=v({},l,{ReactEventListener:null,injection:{injectReactEventListener:function(n){n.setHandleTopLevel(i.handleTopLevel);i.ReactEventListener=n}},setEnabled:function(n){i.ReactEventListener&&i.ReactEventListener.setEnabled(n)},isEnabled:function(){return!!(i.ReactEventListener&&i.ReactEventListener.isEnabled())},listenTo:function(n,t){for(var f,e=t,o=p(e),a=c.registrationNameDependencies[n],r=h.topLevelTypes,l=0,v=a.length;l<v;l++)f=a[l],o.hasOwnProperty(f)&&o[f]||(f===r.topWheel?u("wheel")?i.ReactEventListener.trapBubbledEvent(r.topWheel,"wheel",e):u("mousewheel")?i.ReactEventListener.trapBubbledEvent(r.topWheel,"mousewheel",e):i.ReactEventListener.trapBubbledEvent(r.topWheel,"DOMMouseScroll",e):f===r.topScroll?u("scroll",!0)?i.ReactEventListener.trapCapturedEvent(r.topScroll,"scroll",e):i.ReactEventListener.trapBubbledEvent(r.topScroll,"scroll",i.ReactEventListener.WINDOW_HANDLE):f===r.topFocus||f===r.topBlur?(u("focus",!0)?(i.ReactEventListener.trapCapturedEvent(r.topFocus,"focus",e),i.ReactEventListener.trapCapturedEvent(r.topBlur,"blur",e)):u("focusin")&&(i.ReactEventListener.trapBubbledEvent(r.topFocus,"focusin",e),i.ReactEventListener.trapBubbledEvent(r.topBlur,"focusout",e)),o[r.topBlur]=!0,o[r.topFocus]=!0):s.hasOwnProperty(f)&&i.ReactEventListener.trapBubbledEvent(f,s[f],e),o[f]=!0)},trapBubbledEvent:function(n,t,r){return i.ReactEventListener.trapBubbledEvent(n,t,r)},trapCapturedEvent:function(n,t,r){return i.ReactEventListener.trapCapturedEvent(n,t,r)},ensureScrollValueMonitoring:function(){if(!o){var n=a.refreshScrollValues;i.ReactEventListener.monitorScrollValue(n);o=!0}},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:r.putListener,getListener:r.getListener,deleteListener:r.deleteListener,deleteAllListeners:r.deleteAllListeners});t.exports=i},{"117":117,"151":151,"16":16,"18":18,"19":19,"29":29,"67":67}],34:[function(n,t){"use strict";var i=n(31),r=n(29),u=i.createFactory(n(98)),f=i.createFactory(n(35)),e=i.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:i.PropTypes.string.isRequired,transitionAppear:i.PropTypes.bool,transitionEnter:i.PropTypes.bool,transitionLeave:i.PropTypes.bool},getDefaultProps:function(){return{transitionAppear:!1,transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(n){return f({name:this.props.transitionName,appear:this.props.transitionAppear,enter:this.props.transitionEnter,leave:this.props.transitionLeave},n)},render:function(){return u(r({},this.props,{childFactory:this._wrapChild}))}});t.exports=e},{"29":29,"31":31,"35":35,"98":98}],35:[function(n,t){"use strict";var o=n(31),i=n(4),r=n(97),s=n(160),h=n(171),c=17,u=5e3,f=null,e;!0&&(f=function(){h(!1,"transition(): tried to perform an animation without an animationend or transitionend event after timeout (%sms). You should either disable this transition in JS or add a CSS animation/transition.",u)});e=o.createClass({displayName:"ReactCSSTransitionGroupChild",transition:function(n,t){var e=this.getDOMNode(),o=this.props.name+"-"+n,s=o+"-active",h=null,c=function(n){n&&n.target!==e||(!0&&clearTimeout(h),i.removeClass(e,o),i.removeClass(e,s),r.removeEndEventListener(e,c),t&&t())};r.addEndEventListener(e,c);i.addClass(e,o);this.queueClass(s);!0&&(h=setTimeout(f,u))},queueClass:function(n){this.classNameQueue.push(n);this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,c))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(i.addClass.bind(i,this.getDOMNode()));this.classNameQueue.length=0;this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillAppear:function(n){this.props.appear?this.transition("appear",n):n()},componentWillEnter:function(n){this.props.enter?this.transition("enter",n):n()},componentWillLeave:function(n){this.props.leave?this.transition("leave",n):n()},render:function(){return s(this.props.children)}});t.exports=e},{"160":160,"171":171,"31":31,"4":4,"97":97}],36:[function(n,t){"use strict";var i=n(89),r=n(133),u=n(149),f=n(167),e={instantiateChildren:function(n){var t=r(n),i,f,e;for(i in t)t.hasOwnProperty(i)&&(f=t[i],e=u(f,null),t[i]=e);return t},updateChildren:function(n,t,e,o){var h=r(t),s,a;if(!h&&!n)return null;for(s in h)if(h.hasOwnProperty(s)){var c=n&&n[s],v=c&&c._currentElement,l=h[s];f(v,l)?(i.receiveComponent(c,l,e,o),h[s]=c):(c&&i.unmountComponent(c,s),a=u(l,null),h[s]=a)}for(s in n)!n.hasOwnProperty(s)||h&&h.hasOwnProperty(s)||i.unmountComponent(n[s]);return h},unmountChildren:function(n){var t,r;for(t in n)r=n[t],i.unmountComponent(r)}};t.exports=e},{"133":133,"149":149,"167":167,"89":89}],37:[function(n,t){"use strict";function u(n,t){this.forEachFunction=n;this.forEachContext=t}function l(n,t,i,r){var u=n;u.forEachFunction.call(u.forEachContext,t,r)}function a(n,t,i){if(n==null)return n;var f=u.getPooled(t,i);r(n,l,f);u.release(f)}function f(n,t,i){this.mapResult=n;this.mapFunction=t;this.mapContext=i}function v(n,t,i,r){var u=n,f=u.mapResult,e=!f.hasOwnProperty(i),o;!0&&s(e,"ReactChildren.map(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",i);e&&(o=u.mapFunction.call(u.mapContext,t,r),f[i]=o)}function y(n,t,i){if(n==null)return n;var u={},e=f.getPooled(u,t,i);return r(n,v,e),f.release(e),o.create(u)}function p(){return null}function w(n){return r(n,p,null)}var i=n(30),o=n(69),r=n(169),s=n(171),h=i.twoArgumentPooler,c=i.threeArgumentPooler,e;i.addPoolingTo(u,h);i.addPoolingTo(f,c);e={forEach:a,map:y,count:w};t.exports=e},{"169":169,"171":171,"30":30,"69":69}],38:[function(n,t){"use strict";function c(n,t,i){for(var r in t)t.hasOwnProperty(r)&&u(typeof t[r]=="function","%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",n.displayName||"ReactClass",ut[i],r)}function ot(n,t){var u=e.hasOwnProperty(t)?e[t]:null;b.hasOwnProperty(t)&&r(u===i.OVERRIDE_BASE,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t);n.hasOwnProperty(t)&&r(u===i.DEFINE_MANY||u===i.DEFINE_MANY_MERGED,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function l(n,t){var f,u,o,h;if(t){r(typeof t!="function","ReactClass: You're attempting to use a component class as a mixin. Instead, just use a regular object.");r(!a.isValidElement(t),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");f=n.prototype;t.hasOwnProperty(v)&&s.mixins(n,t.mixins);for(u in t)if(t.hasOwnProperty(u)&&u!==v)if(o=t[u],ot(f,u),s.hasOwnProperty(u))s[u](n,o);else{var c=e.hasOwnProperty(u),l=f.hasOwnProperty(u),y=o&&o.__reactDontBind,p=typeof o=="function",b=p&&!c&&!l&&!y;b?(f.__reactAutoBindMap||(f.__reactAutoBindMap={}),f.__reactAutoBindMap[u]=o,f[u]=o):l?(h=e[u],r(c&&(h===i.DEFINE_MANY_MERGED||h===i.DEFINE_MANY),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",h,u),h===i.DEFINE_MANY_MERGED?f[u]=w(f[u],o):h===i.DEFINE_MANY&&(f[u]=ht(f[u],o))):(f[u]=o,!0&&typeof o=="function"&&t.displayName&&(f[u].displayName=t.displayName+"_"+u))}}}function st(n,t){var i,e,u,f;if(t)for(i in t)(e=t[i],t.hasOwnProperty(i))&&(u=i in s,r(!u,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',i),f=i in n,r(!f,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",i),n[i]=e)}function p(n,t){r(n&&t&&typeof n=="object"&&typeof t=="object","mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects.");for(var i in t)t.hasOwnProperty(i)&&(r(n[i]===undefined,"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",i),n[i]=t[i]);return n}function w(n,t){return function(){var r=n.apply(this,arguments),u=t.apply(this,arguments),i;return r==null?u:u==null?r:(i={},p(i,r),p(i,u),i)}}function ht(n,t){return function(){n.apply(this,arguments);t.apply(this,arguments)}}function ct(n,t){var i=t.bind(n),r,f;return!0&&(i.__reactBoundContext=n,i.__reactBoundMethod=t,i.__reactBoundArguments=null,r=n.constructor.displayName,f=i.bind,i.bind=function(e){for(var o,s=[],h=1,c=arguments.length;h<c;h++)s.push(arguments[h]);if(e!==n&&e!==null)u(!1,"bind(): React component methods may only be bound to the component instance. See %s",r);else if(!s.length)return u(!1,"bind(): You are binding a component method to the component. React does this for you automatically in a high-performance way, so you can safely remove this call. See %s",r),i;return o=f.apply(i,arguments),o.__reactBoundContext=n,o.__reactBoundMethod=t,o.__reactBoundArguments=s,o}),i}function lt(n){var t,i;for(t in n.__reactAutoBindMap)n.__reactAutoBindMap.hasOwnProperty(t)&&(i=n.__reactAutoBindMap[t],n[t]=ct(n,tt.guard(i,n.constructor.displayName+"."+t)))}var g=n(39),nt=n(45),a=n(63),tt=n(66),it=n(73),rt=n(74),h=n(85),ut=n(84),f=n(99),o=n(29),r=n(150),ft=n(156),et=n(157),u=n(171),v=et({mixins:null}),i=ft({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),y=[],e={mixins:i.DEFINE_MANY,statics:i.DEFINE_MANY,propTypes:i.DEFINE_MANY,contextTypes:i.DEFINE_MANY,childContextTypes:i.DEFINE_MANY,getDefaultProps:i.DEFINE_MANY_MERGED,getInitialState:i.DEFINE_MANY_MERGED,getChildContext:i.DEFINE_MANY_MERGED,render:i.DEFINE_ONCE,componentWillMount:i.DEFINE_MANY,componentDidMount:i.DEFINE_MANY,componentWillReceiveProps:i.DEFINE_MANY,shouldComponentUpdate:i.DEFINE_ONCE,componentWillUpdate:i.DEFINE_MANY,componentDidUpdate:i.DEFINE_MANY,componentWillUnmount:i.DEFINE_MANY,updateComponent:i.OVERRIDE_BASE},s={displayName:function(n,t){n.displayName=t},mixins:function(n,t){if(t)for(var i=0;i<t.length;i++)l(n,t[i])},childContextTypes:function(n,t){!0&&c(n,t,h.childContext);n.childContextTypes=o({},n.childContextTypes,t)},contextTypes:function(n,t){!0&&c(n,t,h.context);n.contextTypes=o({},n.contextTypes,t)},getDefaultProps:function(n,t){n.getDefaultProps=n.getDefaultProps?w(n.getDefaultProps,t):t},propTypes:function(n,t){!0&&c(n,t,h.prop);n.propTypes=o({},n.propTypes,t)},statics:function(n,t){st(n,t)}},at={enumerable:!1,get:function(){var n=this.displayName||this.name||"Component";return u(!1,"%s.type is deprecated. Use %s directly to access the class.",n,n),Object.defineProperty(this,"type",{value:this}),this}},b={replaceState:function(n,t){f.enqueueReplaceState(this,n);t&&f.enqueueCallback(this,t)},isMounted:function(){var n,t;return!0&&(n=nt.current,n!==null&&(u(n._warnedAboutRefsInRender,"%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",n.getName()||"A component"),n._warnedAboutRefsInRender=!0)),t=it.get(this),t&&t!==rt.currentlyMountingInstance},setProps:function(n,t){f.enqueueSetProps(this,n);t&&f.enqueueCallback(this,t)},replaceProps:function(n,t){f.enqueueReplaceProps(this,n);t&&f.enqueueCallback(this,t)}},k=function(){},d;o(k.prototype,g.prototype,b);d={createClass:function(n){var t=function(n,i){!0&&u(this instanceof t,"Something is calling a React component directly. Use a factory or JSX instead. See: https://fb.me/react-legacyfactory");this.__reactAutoBindMap&&lt(this);this.props=n;this.context=i;this.state=null;var f=this.getInitialState?this.getInitialState():null;!0&&typeof f=="undefined"&&this.getInitialState._isMockFunction&&(f=null);r(typeof f=="object"&&!Array.isArray(f),"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent");this.state=f},i;t.prototype=new k;t.prototype.constructor=t;y.forEach(l.bind(null,t));l(t,n);t.getDefaultProps&&(t.defaultProps=t.getDefaultProps());!0&&(t.getDefaultProps&&(t.getDefaultProps.isReactClassApproved={}),t.prototype.getInitialState&&(t.prototype.getInitialState.isReactClassApproved={}));r(t.prototype.render,"createClass(...): Class specification must implement a `render` method.");!0&&u(!t.prototype.componentShouldUpdate,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",n.displayName||"A component");for(i in e)t.prototype[i]||(t.prototype[i]=null);if(t.type=t,!0)try{Object.defineProperty(t,"type",at)}catch(f){}return t},injection:{injectMixin:function(n){y.push(n)}}};t.exports=d},{"150":150,"156":156,"157":157,"171":171,"29":29,"39":39,"45":45,"63":63,"66":66,"73":73,"74":74,"84":84,"85":85,"99":99}],39:[function(n,t){"use strict";function r(n,t){this.props=n;this.context=t}var i=n(99),e=n(150),o=n(171),u,s,f;if(r.prototype.setState=function(n,t){e(typeof n=="object"||typeof n=="function"||n==null,"setState(...): takes an object of state variables to update or a function which returns an object of state variables.");!0&&o(n!=null,"setState(...): You passed an undefined or null state object; instead, use forceUpdate().");i.enqueueSetState(this,n);t&&i.enqueueCallback(this,t)},r.prototype.forceUpdate=function(n){i.enqueueForceUpdate(this);n&&i.enqueueCallback(this,n)},!0){u={getDOMNode:["getDOMNode","Use React.findDOMNode(component) instead."],isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceProps:["replaceProps","Instead call React.render again at the top level."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."],setProps:["setProps","Instead call React.render again at the top level."]};s=function(n,t){try{Object.defineProperty(r.prototype,n,{get:function(){return o(!1,"%s(...) is deprecated in plain JavaScript React classes. %s",t[0],t[1]),undefined}})}catch(i){}};for(f in u)u.hasOwnProperty(f)&&s(f,u[f])}t.exports=r},{"150":150,"171":171,"99":99}],40:[function(n,t){"use strict";var i=n(50),r=n(77),u={processChildrenUpdates:i.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:i.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(n){r.purgeID(n)}};t.exports=u},{"50":50,"77":77}],41:[function(n,t){"use strict";var u=n(150),r=!1,i={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(n){u(!r,"ReactCompositeComponent: injectEnvironment() can only be called once.");i.unmountIDFromEnvironment=n.unmountIDFromEnvironment;i.replaceNodeWithMarkupByID=n.replaceNodeWithMarkupByID;i.processChildrenUpdates=n.processChildrenUpdates;r=!0}}};t.exports=i},{"150":150}],42:[function(n,t){"use strict";var i=n(166),r={shouldComponentUpdate:function(n,t){return!i(this.props,n)||!i(this.state,t)}};t.exports=r},{"166":166}],43:[function(n,t){"use strict";function tt(n){var i=n._currentElement._owner||null,t;return i&&(t=i.getName(),t)?" Check the render method of `"+t+"`.":""}var w=n(41),h=n(44),a=n(45),c=n(63),b=n(64),v=n(73),u=n(74),l=n(80),k=n(82),e=n(85),d=n(84),f=n(89),g=n(100),o=n(29),s=n(130),i=n(150),nt=n(167),r=n(171),it=1,y={construct:function(n){this._currentElement=n;this._rootNodeID=null;this._instance=null;this._pendingElement=null;this._pendingStateQueue=null;this._pendingReplaceState=!1;this._pendingForceUpdate=!1;this._renderedComponent=null;this._context=null;this._mountOrder=0;this._isTopLevel=!1;this._pendingCallbacks=null},mountComponent:function(n,t,e){var h,a,w,b,k;this._context=e;this._mountOrder=it++;this._rootNodeID=n;var y=this._processProps(this._currentElement.props),p=this._processContext(this._currentElement._context),c=l.getComponentClassForElement(this._currentElement),o=new c(y,p);!0&&r(o.render!=null,"%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render` in your component or you may have accidentally tried to render an element whose type is a function that isn't a React component.",c.displayName||c.name||"Component");o.props=y;o.context=p;o.refs=s;this._instance=o;v.set(o,this);!0&&this._warnIfContextsDiffer(this._currentElement._context,e);!0&&(r(!o.getInitialState||o.getInitialState.isReactClassApproved,"getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",this.getName()||"a component"),r(!o.getDefaultProps||o.getDefaultProps.isReactClassApproved,"getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",this.getName()||"a component"),r(!o.propTypes,"propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",this.getName()||"a component"),r(!o.contextTypes,"contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",this.getName()||"a component"),r(typeof o.componentShouldUpdate!="function","%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",this.getName()||"A component"));h=o.state;h===undefined&&(o.state=h=null);i(typeof h=="object"&&!Array.isArray(h),"%s.state: must be set to an object or null",this.getName()||"ReactCompositeComponent");this._pendingStateQueue=null;this._pendingReplaceState=!1;this._pendingForceUpdate=!1;b=u.currentlyMountingInstance;u.currentlyMountingInstance=this;try{o.componentWillMount&&(o.componentWillMount(),this._pendingStateQueue&&(o.state=this._processPendingState(o.props,o.context)));a=this._getValidatedChildContext(e);w=this._renderValidatedComponent(a)}finally{u.currentlyMountingInstance=b}return this._renderedComponent=this._instantiateReactComponent(w,this._currentElement.type),k=f.mountComponent(this._renderedComponent,n,t,this._mergeChildContext(e,a)),o.componentDidMount&&t.getReactMountReady().enqueue(o.componentDidMount,o),k},unmountComponent:function(){var n=this._instance,t;if(n.componentWillUnmount){t=u.currentlyUnmountingInstance;u.currentlyUnmountingInstance=this;try{n.componentWillUnmount()}finally{u.currentlyUnmountingInstance=t}}f.unmountComponent(this._renderedComponent);this._renderedComponent=null;this._pendingStateQueue=null;this._pendingReplaceState=!1;this._pendingForceUpdate=!1;this._pendingCallbacks=null;this._pendingElement=null;this._context=null;this._rootNodeID=null;v.remove(n)},_setPropsInternal:function(n,t){var i=this._pendingElement||this._currentElement;this._pendingElement=c.cloneAndReplaceProps(i,o({},i.props,n));g.enqueueUpdate(this,t)},_maskContext:function(n){var t=null,i,r;if(typeof this._currentElement.type=="string"||(i=this._currentElement.type.contextTypes,!i))return s;t={};for(r in i)t[r]=n[r];return t},_processContext:function(n){var i=this._maskContext(n),t;return!0&&(t=l.getComponentClassForElement(this._currentElement),t.contextTypes&&this._checkPropTypes(t.contextTypes,i,e.context)),i},_getValidatedChildContext:function(){var n=this._instance,t=n.getChildContext&&n.getChildContext(),r;if(t){i(typeof n.constructor.childContextTypes=="object","%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",this.getName()||"ReactCompositeComponent");!0&&this._checkPropTypes(n.constructor.childContextTypes,t,e.childContext);for(r in t)i(r in n.constructor.childContextTypes,'%s.getChildContext(): key "%s" is not defined in childContextTypes.',this.getName()||"ReactCompositeComponent",r);return t}return null},_mergeChildContext:function(n,t){return t?o({},n,t):n},_processProps:function(n){if(1){var t=l.getComponentClassForElement(this._currentElement);t.propTypes&&this._checkPropTypes(t.propTypes,n,e.prop)}return n},_checkPropTypes:function(n,t,u){var h=this.getName(),f,o,s;for(f in n)if(n.hasOwnProperty(f)){try{i(typeof n[f]=="function","%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",h||"React class",d[u],f);o=n[f](t,f,h,u)}catch(c){o=c}o instanceof Error&&(s=tt(this),u===e.prop?r(!1,"Failed Composite propType: %s%s",o.message,s):r(!1,"Failed Context Types: %s%s",o.message,s))}},receiveComponent:function(n,t,i){var r=this._currentElement,u=this._context;this._pendingElement=null;this.updateComponent(t,r,n,u,i)},performUpdateIfNecessary:function(n){this._pendingElement!=null&&f.receiveComponent(this,this._pendingElement||this._currentElement,n,this._context);(this._pendingStateQueue!==null||this._pendingForceUpdate)&&(!0&&b.checkAndWarnForMutatedProps(this._currentElement),this.updateComponent(n,this._currentElement,this._currentElement,this._context,this._context))},_warnIfContextsDiffer:function(n,t){var f,e,u,i;for(n=this._maskContext(n),t=this._maskContext(t),f=Object.keys(t).sort(),e=this.getName()||"ReactCompositeComponent",u=0;u<f.length;u++)i=f[u],r(n[i]===t[i],"owner-based and parent-based contexts differ (values: `%s` vs `%s`) for key (%s) while mounting %s (see: http://fb.me/react-context-by-parent)",n[i],t[i],i,e)},updateComponent:function(n,t,i,u,f){var e=this._instance,o=e.context,s=e.props,h,c;t!==i&&(o=this._processContext(i._context),s=this._processProps(i.props),!0&&f!=null&&this._warnIfContextsDiffer(i._context,f),e.componentWillReceiveProps&&e.componentWillReceiveProps(s,o));h=this._processPendingState(s,o);c=this._pendingForceUpdate||!e.shouldComponentUpdate||e.shouldComponentUpdate(s,h,o);!0&&r(typeof c!="undefined","%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",this.getName()||"ReactCompositeComponent");c?(this._pendingForceUpdate=!1,this._performComponentUpdate(i,s,h,o,n,f)):(this._currentElement=i,this._context=f,e.props=s,e.state=h,e.context=o)},_processPendingState:function(n,t){var e=this._instance,i=this._pendingStateQueue,s=this._pendingReplaceState,r,u,f;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!i)return e.state;if(s&&i.length===1)return i[0];for(r=o({},s?i[0]:e.state),u=s?1:0;u<i.length;u++)f=i[u],o(r,typeof f=="function"?f.call(e,r,n,t):f);return r},_performComponentUpdate:function(n,t,i,r,u,f){var e=this._instance,o=e.props,s=e.state,h=e.context;e.componentWillUpdate&&e.componentWillUpdate(t,i,r);this._currentElement=n;this._context=f;e.props=t;e.state=i;e.context=r;this._updateRenderedComponent(u,f);e.componentDidUpdate&&u.getReactMountReady().enqueue(e.componentDidUpdate.bind(e,o,s,h),e)},_updateRenderedComponent:function(n,t){var i=this._renderedComponent,h=i._currentElement,r=this._getValidatedChildContext(),u=this._renderValidatedComponent(r),e,o,s;nt(h,u)?f.receiveComponent(i,u,n,this._mergeChildContext(t,r)):(e=this._rootNodeID,o=i._rootNodeID,f.unmountComponent(i),this._renderedComponent=this._instantiateReactComponent(u,this._currentElement.type),s=f.mountComponent(this._renderedComponent,e,n,this._mergeChildContext(t,r)),this._replaceNodeWithMarkupByID(o,s))},_replaceNodeWithMarkupByID:function(n,t){w.replaceNodeWithMarkupByID(n,t)},_renderValidatedComponentWithoutOwnerOrContext:function(){var t=this._instance,n=t.render();return!0&&typeof n=="undefined"&&t.render._isMockFunction&&(n=null),n},_renderValidatedComponent:function(n){var t,r=h.current;h.current=this._mergeChildContext(this._currentElement._context,n);a.current=this;try{t=this._renderValidatedComponentWithoutOwnerOrContext()}finally{h.current=r;a.current=null}return i(t===null||t===!1||c.isValidElement(t),"%s.render(): A valid ReactComponent must be returned. You may have returned undefined, an array or some other invalid object.",this.getName()||"ReactCompositeComponent"),t},attachRef:function(n,t){var i=this.getPublicInstance(),r=i.refs===s?i.refs={}:i.refs;r[n]=t.getPublicInstance()},detachRef:function(n){var t=this.getPublicInstance().refs;delete t[n]},getName:function(){var t=this._currentElement.type,n=this._instance&&this._instance.constructor;return t.displayName||n&&n.displayName||t.name||n&&n.name||null},getPublicInstance:function(){return this._instance},_instantiateReactComponent:null},p;k.measureMethods(y,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});p={Mixin:y};t.exports=p},{"100":100,"130":130,"150":150,"167":167,"171":171,"29":29,"41":41,"44":44,"45":45,"63":63,"64":64,"73":73,"74":74,"80":80,"82":82,"84":84,"85":85,"89":89}],44:[function(n,t){"use strict";var u=n(29),f=n(130),e=n(171),r=!1,i={current:f,withContext:function(n,t){!0&&(e(r,"withContext is deprecated and will be removed in a future version. Use a wrapper component with getChildContext instead."),r=!0);var f,o=i.current;i.current=u({},o,n);try{f=t()}finally{i.current=o}return f}};t.exports=i},{"130":130,"171":171,"29":29}],45:[function(n,t){"use strict";t.exports={current:null}},{}],46:[function(n,t){"use strict";function f(n){return r.createFactory(n)}var i=n(63),r=n(64),u=n(158),e=u({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul","var":"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},f);t.exports=e},{"158":158,"63":63,"64":64}],47:[function(n,t){"use strict";var i=n(2),r=n(32),u=n(38),f=n(63),e=n(156),o=f.createFactory("button"),s=e({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),h=u.createClass({displayName:"ReactDOMButton",tagName:"BUTTON",mixins:[i,r],render:function(){var t={};for(var n in this.props)!this.props.hasOwnProperty(n)||this.props.disabled&&s[n]||(t[n]=this.props[n]);return o(t,this.props.children)}});t.exports=h},{"156":156,"2":2,"32":32,"38":38,"63":63}],48:[function(n,t){"use strict";function v(n){n&&(n.dangerouslySetInnerHTML!=null&&(i(n.children==null,"Can only set one of `children` or `props.dangerouslySetInnerHTML`."),i(typeof n.dangerouslySetInnerHTML=="object"&&"__html"in n.dangerouslySetInnerHTML,"`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://fb.me/react-invariant-dangerously-set-inner-html for more information.")),!0&&(h(n.innerHTML==null,"Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),h(!n.contentEditable||n.children==null,"A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional.")),i(n.style==null||typeof n.style=="object","The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX."))}function y(n,t,i,r){var u,f;!0&&h(t!=="onScroll"||it("scroll",!0),"This browser doesn't support the `onScroll` event");u=d.findReactContainerForID(n);u&&(f=u.nodeType===et?u.ownerDocument:u,ft(t,f));r.getPutListenerQueue().enqueuePutListener(n,t,i)}function ht(n){st.call(w,n)||(i(p.test(n),"Invalid tag: %s",n),w[n]=!0)}function r(n){ht(n);this._tag=n;this._renderedChildren=null;this._previousStyleCopy=null;this._rootNodeID=null}var b=n(6),f=n(11),a=n(12),e=n(33),k=n(40),d=n(77),g=n(78),nt=n(82),s=n(29),tt=n(131),i=n(150),it=n(151),rt=n(157),h=n(171),ut=e.deleteListener,ft=e.listenTo,c=e.registrationNameModules,l={string:!0,number:!0},o=rt({style:null}),et=1,u=null,ot={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},p=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,w={},st={}.hasOwnProperty;r.displayName="ReactDOMComponent";r.Mixin={construct:function(n){this._currentElement=n},mountComponent:function(n,t,i){this._rootNodeID=n;v(this._currentElement.props);var r=ot[this._tag]?"":"<\/"+this._tag+">";return this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t,i)+r},_createOpenTagMarkupAndPutListeners:function(n){var r=this._currentElement.props,u="<"+this._tag,i,t,f,e;for(i in r)r.hasOwnProperty(i)&&(t=r[i],t!=null)&&(c.hasOwnProperty(i)?y(this._rootNodeID,i,t,n):(i===o&&(t&&(t=this._previousStyleCopy=s({},r.style)),t=b.createMarkupForStyles(t)),f=a.createMarkupForProperty(i,t),f&&(u+=" "+f)));return n.renderToStaticMarkup?u+">":(e=a.createMarkupForID(this._rootNodeID),u+" "+e+">")},_createContentMarkup:function(n,t){var i="",r,u,f,e,o;if((this._tag==="listing"||this._tag==="pre"||this._tag==="textarea")&&(i="\n"),r=this._currentElement.props,u=r.dangerouslySetInnerHTML,u!=null){if(u.__html!=null)return i+u.__html}else{if(f=l[typeof r.children]?r.children:null,e=f!=null?null:r.children,f!=null)return i+tt(f);if(e!=null)return o=this.mountChildren(e,n,t),i+o.join("")}return i},receiveComponent:function(n,t,i){var r=this._currentElement;this._currentElement=n;this.updateComponent(t,r,n,i)},updateComponent:function(n,t,i,r){v(this._currentElement.props);this._updateDOMProperties(t.props,n);this._updateDOMChildren(t.props,n,r)},_updateDOMProperties:function(n,t){var a=this._currentElement.props,i,e,h,v,r,l;for(i in n)if(!a.hasOwnProperty(i)&&n.hasOwnProperty(i))if(i===o){v=this._previousStyleCopy;for(e in v)v.hasOwnProperty(e)&&(h=h||{},h[e]="");this._previousStyleCopy=null}else c.hasOwnProperty(i)?ut(this._rootNodeID,i):(f.isStandardName[i]||f.isCustomAttribute(i))&&u.deletePropertyByID(this._rootNodeID,i);for(i in a)if(r=a[i],l=i===o?this._previousStyleCopy:n[i],a.hasOwnProperty(i)&&r!==l)if(i===o)if(r?r=this._previousStyleCopy=s({},r):this._previousStyleCopy=null,l){for(e in l)!l.hasOwnProperty(e)||r&&r.hasOwnProperty(e)||(h=h||{},h[e]="");for(e in r)r.hasOwnProperty(e)&&l[e]!==r[e]&&(h=h||{},h[e]=r[e])}else h=r;else c.hasOwnProperty(i)?y(this._rootNodeID,i,r,t):(f.isStandardName[i]||f.isCustomAttribute(i))&&u.updatePropertyByID(this._rootNodeID,i,r);h&&u.updateStylesByID(this._rootNodeID,h)},_updateDOMChildren:function(n,t,i){var r=this._currentElement.props,o=l[typeof n.children]?n.children:null,f=l[typeof r.children]?r.children:null,h=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,e=r.dangerouslySetInnerHTML&&r.dangerouslySetInnerHTML.__html,c=o!=null?null:n.children,s=f!=null?null:r.children,a=o!=null||h!=null,v=f!=null||e!=null;c!=null&&s==null?this.updateChildren(null,t,i):a&&!v&&this.updateTextContent("");f!=null?o!==f&&this.updateTextContent(""+f):e!=null?h!==e&&u.updateInnerHTMLByID(this._rootNodeID,e):s!=null&&this.updateChildren(s,t,i)},unmountComponent:function(){this.unmountChildren();e.deleteAllListeners(this._rootNodeID);k.unmountIDFromEnvironment(this._rootNodeID);this._rootNodeID=null}};nt.measureMethods(r,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"});s(r.prototype,r.Mixin,g.Mixin);r.injection={injectIDOperations:function(n){r.BackendIDOperations=u=n}};t.exports=r},{"11":11,"12":12,"131":131,"150":150,"151":151,"157":157,"171":171,"29":29,"33":33,"40":40,"6":6,"77":77,"78":78,"82":82}],49:[function(n,t){"use strict";var i=n(16),r=n(27),u=n(32),f=n(38),e=n(63),o=e.createFactory("form"),s=f.createClass({displayName:"ReactDOMForm",tagName:"FORM",mixins:[u,r],render:function(){return o(this.props)},componentDidMount:function(){this.trapBubbledEvent(i.topLevelTypes.topReset,"reset");this.trapBubbledEvent(i.topLevelTypes.topSubmit,"submit")}});t.exports=s},{"16":16,"27":27,"32":32,"38":38,"63":63}],50:[function(n,t){"use strict";var s=n(6),f=n(10),e=n(12),i=n(77),h=n(82),u=n(150),c=n(164),r={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},o={updatePropertyByID:function(n,t,f){var o=i.getNode(n);u(!r.hasOwnProperty(t),"updatePropertyByID(...): %s",r[t]);f!=null?e.setValueForProperty(o,t,f):e.deleteValueForProperty(o,t)},deletePropertyByID:function(n,t,f){var o=i.getNode(n);u(!r.hasOwnProperty(t),"updatePropertyByID(...): %s",r[t]);e.deleteValueForProperty(o,t,f)},updateStylesByID:function(n,t){var r=i.getNode(n);s.setValueForStyles(r,t)},updateInnerHTMLByID:function(n,t){var r=i.getNode(n);c(r,t)},updateTextContentByID:function(n,t){var r=i.getNode(n);f.updateTextContent(r,t)},dangerouslyReplaceNodeWithMarkupByID:function(n,t){var r=i.getNode(n);f.dangerouslyReplaceNodeWithMarkup(r,t)},dangerouslyProcessChildrenUpdates:function(n,t){for(var r=0;r<n.length;r++)n[r].parentNode=i.getNode(n[r].parentID);f.processUpdates(n,t)}};h.measureMethods(o,"ReactDOMIDOperations",{updatePropertyByID:"updatePropertyByID",deletePropertyByID:"deletePropertyByID",updateStylesByID:"updateStylesByID",updateInnerHTMLByID:"updateInnerHTMLByID",updateTextContentByID:"updateTextContentByID",dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"});t.exports=o},{"10":10,"12":12,"150":150,"164":164,"6":6,"77":77,"82":82}],51:[function(n,t){"use strict";var i=n(16),r=n(27),u=n(32),f=n(38),e=n(63),o=e.createFactory("iframe"),s=f.createClass({displayName:"ReactDOMIframe",tagName:"IFRAME",mixins:[u,r],render:function(){return o(this.props)},componentDidMount:function(){this.trapBubbledEvent(i.topLevelTypes.topLoad,"load")}});t.exports=s},{"16":16,"27":27,"32":32,"38":38,"63":63}],52:[function(n,t){"use strict";var i=n(16),r=n(27),u=n(32),f=n(38),e=n(63),o=e.createFactory("img"),s=f.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[u,r],render:function(){return o(this.props)},componentDidMount:function(){this.trapBubbledEvent(i.topLevelTypes.topLoad,"load");this.trapBubbledEvent(i.topLevelTypes.topError,"error")}});t.exports=s},{"16":16,"27":27,"32":32,"38":38,"63":63}],53:[function(n,t){"use strict";function s(){this.isMounted()&&this.forceUpdate()}var h=n(2),e=n(12),i=n(26),c=n(32),l=n(38),a=n(63),u=n(77),o=n(100),v=n(29),r=n(150),y=a.createFactory("input"),f={},p=l.createClass({displayName:"ReactDOMInput",tagName:"INPUT",mixins:[h,i.Mixin,c],getInitialState:function(){var n=this.props.defaultValue;return{initialChecked:this.props.defaultChecked||!1,initialValue:n!=null?n:null}},render:function(){var n=v({},this.props),t,r;return n.defaultChecked=null,n.defaultValue=null,t=i.getValue(this),n.value=t!=null?t:this.state.initialValue,r=i.getChecked(this),n.checked=r!=null?r:this.state.initialChecked,n.onChange=this._handleChange,y(n,this.props.children)},componentDidMount:function(){var n=u.getID(this.getDOMNode());f[n]=this},componentWillUnmount:function(){var n=this.getDOMNode(),t=u.getID(n);delete f[t]},componentDidUpdate:function(){var t=this.getDOMNode(),n;this.props.checked!=null&&e.setValueForProperty(t,"checked",this.props.checked||!1);n=i.getValue(this);n!=null&&e.setValueForProperty(t,"value",""+n)},_handleChange:function(n){var p,w=i.getOnChange(this),v,h,t,y,c,b,l,e,a;if(w&&(p=w.call(this,n)),o.asap(s,this),v=this.props.name,this.props.type==="radio"&&v!=null){for(h=this.getDOMNode(),t=h;t.parentNode;)t=t.parentNode;for(y=t.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),c=0,b=y.length;c<b;c++)(l=y[c],l!==h&&l.form===h.form)&&(e=u.getID(l),r(e,"ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported."),a=f[e],r(a,"ReactDOMInput: Unknown radio button ID %s.",e),o.asap(s,a))}return p}});t.exports=p},{"100":100,"12":12,"150":150,"2":2,"26":26,"29":29,"32":32,"38":38,"63":63,"77":77}],54:[function(n,t){"use strict";var i=n(32),r=n(38),u=n(63),f=n(171),e=u.createFactory("option"),o=r.createClass({displayName:"ReactDOMOption",tagName:"OPTION",mixins:[i],componentWillMount:function(){!0&&f(this.props.selected==null,"Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>.")},render:function(){return e(this.props,this.props.children)}});t.exports=o},{"171":171,"32":32,"38":38,"63":63}],55:[function(n,t){"use strict";function a(){if(this._pendingUpdate){this._pendingUpdate=!1;var n=r.getValue(this);n!=null&&this.isMounted()&&i(this,n)}}function u(n,t){if(n[t]==null)return null;if(n.multiple){if(!Array.isArray(n[t]))return new Error("The `"+t+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(n[t]))return new Error("The `"+t+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function i(n,t){var f,i,u,r=n.getDOMNode().options,e;if(n.props.multiple){for(f={},i=0,u=t.length;i<u;i++)f[""+t[i]]=!0;for(i=0,u=r.length;i<u;i++)e=f.hasOwnProperty(r[i].value),r[i].selected!==e&&(r[i].selected=e)}else{for(f=""+t,i=0,u=r.length;i<u;i++)if(r[i].value===f){r[i].selected=!0;return}r.length&&(r[0].selected=!0)}}var f=n(2),r=n(26),e=n(32),o=n(38),s=n(63),h=n(100),c=n(29),l=s.createFactory("select"),v=o.createClass({displayName:"ReactDOMSelect",tagName:"SELECT",mixins:[f,r.Mixin,e],propTypes:{defaultValue:u,value:u},render:function(){var n=c({},this.props);return n.onChange=this._handleChange,n.value=null,l(n,this.props.children)},componentWillMount:function(){this._pendingUpdate=!1},componentDidMount:function(){var n=r.getValue(this);n!=null?i(this,n):this.props.defaultValue!=null&&i(this,this.props.defaultValue)},componentDidUpdate:function(n){var t=r.getValue(this);t!=null?(this._pendingUpdate=!1,i(this,t)):!n.multiple!=!this.props.multiple&&(this.props.defaultValue!=null?i(this,this.props.defaultValue):i(this,this.props.multiple?[]:""))},_handleChange:function(n){var t,i=r.getOnChange(this);return i&&(t=i.call(this,n)),this._pendingUpdate=!0,h.asap(a,this),t}});t.exports=v},{"100":100,"2":2,"26":26,"29":29,"32":32,"38":38,"63":63}],56:[function(n,t){"use strict";function r(n,t,i,r){return n===i&&t===r}function o(n){var f=document.selection,t=f.createRange(),e=t.text.length,i=t.duplicate(),r,u;return i.moveToElementText(n),i.setEndPoint("EndToStart",t),r=i.text.length,u=r+e,{start:r,end:u}}function s(n){var t=window.getSelection&&window.getSelection(),o;if(!t||t.rangeCount===0)return null;var h=t.anchorNode,c=t.anchorOffset,l=t.focusNode,a=t.focusOffset,u=t.getRangeAt(0),v=r(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),y=v?0:u.toString().length,i=u.cloneRange();i.selectNodeContents(n);i.setEnd(u.startContainer,u.startOffset);var p=r(i.startContainer,i.startOffset,i.endContainer,i.endOffset),f=p?0:i.toString().length,s=f+y,e=document.createRange();return e.setStart(h,c),e.setEnd(l,a),o=e.collapsed,{start:o?s:f,end:o?f:s}}function h(n,t){var i=document.selection.createRange().duplicate(),r,u;typeof t.end=="undefined"?(r=t.start,u=r):t.start>t.end?(r=t.end,u=t.start):(r=t.start,u=t.end);i.moveToElementText(n);i.moveStart("character",r);i.setEndPoint("EndToStart",i);i.moveEnd("character",u-r);i.select()}function c(n,t){var l,h,u,s;if(window.getSelection){var f=window.getSelection(),c=n[e()].length,r=Math.min(t.start,c),o=typeof t.end=="undefined"?r:Math.min(t.end,c);!f.extend&&r>o&&(l=o,o=r,r=l);h=i(n,r);u=i(n,o);h&&u&&(s=document.createRange(),s.setStart(h.node,h.offset),f.removeAllRanges(),r>o?(f.addRange(s),f.extend(u.node,u.offset)):(s.setEnd(u.node,u.offset),f.addRange(s)))}}var f=n(22),i=n(143),e=n(145),u=f.canUseDOM&&"selection"in document&&!("getSelection"in window),l={getOffsets:u?o:s,setOffsets:u?h:c};t.exports=l},{"143":143,"145":145,"22":22}],57:[function(n,t){"use strict";var r=n(12),u=n(40),f=n(48),e=n(29),o=n(131),i=function(){};e(i.prototype,{construct:function(n){this._currentElement=n;this._stringText=""+n;this._rootNodeID=null;this._mountIndex=0},mountComponent:function(n,t){this._rootNodeID=n;var i=o(this._stringText);return t.renderToStaticMarkup?i:"<span "+r.createMarkupForID(n)+">"+i+"<\/span>"},receiveComponent:function(n){if(n!==this._currentElement){this._currentElement=n;var t=""+n;t!==this._stringText&&(this._stringText=t,f.BackendIDOperations.updateTextContentByID(this._rootNodeID,t))}},unmountComponent:function(){u.unmountIDFromEnvironment(this._rootNodeID)}});t.exports=i},{"12":12,"131":131,"29":29,"40":40,"48":48}],58:[function(n,t){"use strict";function v(){this.isMounted()&&this.forceUpdate()}var u=n(2),f=n(12),r=n(26),e=n(32),o=n(38),s=n(63),h=n(100),c=n(29),i=n(150),l=n(171),a=s.createFactory("textarea"),y=o.createClass({displayName:"ReactDOMTextarea",tagName:"TEXTAREA",mixins:[u,r.Mixin,e],getInitialState:function(){var t=this.props.defaultValue,n=this.props.children,u;return n!=null&&(!0&&l(!1,"Use the `defaultValue` or `value` props instead of setting children on <textarea>."),i(t==null,"If you supply `defaultValue` on a <textarea>, do not pass children."),Array.isArray(n)&&(i(n.length<=1,"<textarea> can only have at most one child."),n=n[0]),t=""+n),t==null&&(t=""),u=r.getValue(this),{initialValue:""+(u!=null?u:t)}},render:function(){var n=c({},this.props);return i(n.dangerouslySetInnerHTML==null,"`dangerouslySetInnerHTML` does not make sense on <textarea>."),n.defaultValue=null,n.value=null,n.onChange=this._handleChange,a(n,this.state.initialValue)},componentDidUpdate:function(){var n=r.getValue(this),t;n!=null&&(t=this.getDOMNode(),f.setValueForProperty(t,"value",""+n))},_handleChange:function(n){var t,i=r.getOnChange(this);return i&&(t=i.call(this,n)),h.asap(v,this),t}});t.exports=y},{"100":100,"12":12,"150":150,"171":171,"2":2,"26":26,"29":29,"32":32,"38":38,"63":63}],59:[function(n,t){"use strict";function f(){this.reinitializeTransaction()}var r=n(100),o=n(116),s=n(29),u=n(129),h={initialize:u,close:function(){i.isBatchingUpdates=!1}},c={initialize:u,close:r.flushBatchedUpdates.bind(r)},l=[c,h],e,i;s(f.prototype,o.Mixin,{getTransactionWrappers:function(){return l}});e=new f;i={isBatchingUpdates:!1,batchedUpdates:function(n,t,r,u,f){var o=i.isBatchingUpdates;i.isBatchingUpdates=!0;o?n(t,r,u,f):e.perform(n,null,t,r,u,f)}};t.exports=i},{"100":100,"116":116,"129":129,"29":29}],60:[function(n,t){"use strict";function pt(n){return v.createClass({tagName:n.toUpperCase(),render:function(){return new et(n,null,null,null,null,this.props)}})}function wt(){var t,v;i.EventEmitter.injectReactEventListener(ot);i.EventPluginHub.injectEventPluginOrder(s);i.EventPluginHub.injectInstanceHandle(st);i.EventPluginHub.injectMount(ht);i.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:vt,EnterLeaveEventPlugin:h,ChangeEventPlugin:e,MobileSafariClickEventPlugin:l,SelectEventPlugin:lt,BeforeInputEventPlugin:f});i.NativeComponent.injectGenericComponentClass(w);i.NativeComponent.injectTextComponentClass(ft);i.NativeComponent.injectAutoWrapper(pt);i.Class.injectMixin(a);i.NativeComponent.injectComponentClasses({button:b,form:k,iframe:nt,img:d,input:tt,option:it,select:rt,textarea:ut,html:r("html"),head:r("head"),body:r("body")});i.DOMProperty.injectDOMPropertyConfig(c);i.DOMProperty.injectDOMPropertyConfig(yt);i.EmptyComponent.injectEmptyComponent("noscript");i.Updates.injectReconcileTransaction(ct);i.Updates.injectBatchingStrategy(p);i.RootIndex.injectCreateReactRootIndex(u.canUseDOM?o.createReactRootIndex:at.createReactRootIndex);i.Component.injectEnvironment(y);i.DOMComponent.injectIDOperations(g);!0&&(t=u.canUseDOM&&window.location.href||"",/[?&]react_perf\b/.test(t)&&(v=n(61),v.start()))}var f=n(3),e=n(8),o=n(9),s=n(14),h=n(15),u=n(22),c=n(24),l=n(28),a=n(32),v=n(38),y=n(40),p=n(59),w=n(48),b=n(47),k=n(49),d=n(52),g=n(50),nt=n(51),tt=n(53),it=n(54),rt=n(55),ut=n(58),ft=n(57),et=n(63),ot=n(68),i=n(70),st=n(72),ht=n(77),ct=n(88),lt=n(102),at=n(103),vt=n(104),yt=n(101),r=n(125);t.exports={inject:wt}},{"101":101,"102":102,"103":103,"104":104,"125":125,"14":14,"15":15,"22":22,"24":24,"28":28,"3":3,"32":32,"38":38,"40":40,"47":47,"48":48,"49":49,"50":50,"51":51,"52":52,"53":53,"54":54,"55":55,"57":57,"58":58,"59":59,"61":61,"63":63,"68":68,"70":70,"72":72,"77":77,"8":8,"88":88,"9":9}],61:[function(n,t){"use strict";function f(n){return Math.floor(n*100)/100}function e(n,t,i){n[t]=(n[t]||0)+i}var s=n(11),r=n(62),h=n(77),o=n(82),u=n(162),i={_allMeasurements:[],_mountStack:[0],_injected:!1,start:function(){i._injected||o.injection.injectMeasure(i.measure);i._allMeasurements.length=0;o.enableMeasure=!0},stop:function(){o.enableMeasure=!1},getLastMeasurements:function(){return i._allMeasurements},printExclusive:function(n){n=n||i._allMeasurements;var t=r.getExclusiveSummary(n);console.table(t.map(function(n){return{"Component class name":n.componentName,"Total inclusive time (ms)":f(n.inclusive),"Exclusive mount time (ms)":f(n.exclusive),"Exclusive render time (ms)":f(n.render),"Mount time per instance (ms)":f(n.exclusive/n.count),"Render time per instance (ms)":f(n.render/n.count),Instances:n.count}}))},printInclusive:function(n){n=n||i._allMeasurements;var t=r.getInclusiveSummary(n);console.table(t.map(function(n){return{"Owner > component":n.componentName,"Inclusive time (ms)":f(n.time),Instances:n.count}}));console.log("Total time:",r.getTotalTime(n).toFixed(2)+" ms")},getMeasurementsSummaryMap:function(n){var t=r.getInclusiveSummary(n,!0);return t.map(function(n){return{"Owner > component":n.componentName,"Wasted time (ms)":n.time,Instances:n.count}})},printWasted:function(n){n=n||i._allMeasurements;console.table(i.getMeasurementsSummaryMap(n));console.log("Total time:",r.getTotalTime(n).toFixed(2)+" ms")},printDOM:function(n){n=n||i._allMeasurements;var t=r.getDOMSummary(n);console.table(t.map(function(n){var t={};return t[s.ID_ATTRIBUTE_NAME]=n.id,t.type=n.type,t.args=JSON.stringify(n.args),t}));console.log("Total time:",r.getTotalTime(n).toFixed(2)+" ms")},_recordWrite:function(n,t,r,u){var f=i._allMeasurements[i._allMeasurements.length-1].writes;f[n]=f[n]||[];f[n].push({type:t,time:r,args:u})},measure:function(n,t,r){return function(){for(var o,s,c,p,k,f=[],y=0,d=arguments.length;y<d;y++)f.push(arguments[y]);if(t==="_renderNewRootComponent"||t==="flushBatchedUpdates")return i._allMeasurements.push({exclusive:{},inclusive:{},render:{},counts:{},writes:{},displayNames:{},totalTime:0}),c=u(),s=r.apply(this,f),i._allMeasurements[i._allMeasurements.length-1].totalTime=u()-c,s;if(t==="_mountImageIntoNode"||n==="ReactDOMIDOperations")return c=u(),s=r.apply(this,f),o=u()-c,t==="_mountImageIntoNode"?(p=h.getID(f[1]),i._recordWrite(p,t,o,f[0])):t==="dangerouslyProcessChildrenUpdates"?f[0].forEach(function(n){var t={};n.fromIndex!==null&&(t.fromIndex=n.fromIndex);n.toIndex!==null&&(t.toIndex=n.toIndex);n.textContent!==null&&(t.textContent=n.textContent);n.markupIndex!==null&&(t.markup=f[1][n.markupIndex]);i._recordWrite(n.parentID,n.type,o,t)}):i._recordWrite(f[0],t,o,Array.prototype.slice.call(f,1)),s;if(n==="ReactCompositeComponent"&&(t==="mountComponent"||t==="updateComponent"||t==="_renderValidatedComponent")){if(typeof this._currentElement.type=="string")return r.apply(this,f);var l=t==="mountComponent"?f[0]:this._rootNodeID,w=t==="_renderValidatedComponent",b=t==="mountComponent",v=i._mountStack,a=i._allMeasurements[i._allMeasurements.length-1];return w?e(a.counts,l,1):b&&v.push(0),c=u(),s=r.apply(this,f),o=u()-c,w?e(a.render,l,o):b?(k=v.pop(),v[v.length-1]+=o,e(a.exclusive,l,o-k),e(a.inclusive,l,o)):e(a.inclusive,l,o),a.displayNames[l]={current:this.getName(),owner:this._currentElement._owner?this._currentElement._owner.getName():"<root>"},s}return r.apply(this,f)}}};t.exports=i},{"11":11,"162":162,"62":62,"77":77,"82":82}],62:[function(n,t){function f(n){for(var r,i=0,t=0;t<n.length;t++)r=n[t],i+=r.totalTime;return i}function e(n){for(var i,r,f=[],t=0;t<n.length;t++){i=n[t];for(r in i.writes)i.writes[r].forEach(function(n){f.push({id:r,type:u[n.type]||n.type,args:n.args})})}return f}function o(n){for(var t,h,f,o,e={},u,s=0;s<n.length;s++){t=n[s];h=i({},t.exclusive,t.inclusive);for(f in h)u=t.displayNames[f].current,e[u]=e[u]||{componentName:u,inclusive:0,exclusive:0,render:0,count:0},t.render[f]&&(e[u].render+=t.render[f]),t.exclusive[f]&&(e[u].exclusive+=t.exclusive[f]),t.inclusive[f]&&(e[u].inclusive+=t.inclusive[f]),t.counts[f]&&(e[u].count+=t.counts[f])}o=[];for(u in e)e[u].exclusive>=r&&o.push(e[u]);return o.sort(function(n,t){return t.exclusive-n.exclusive}),o}function s(n,t){for(var f,a,v,o,l,s,e={},u,c=0;c<n.length;c++){f=n[c];a=i({},f.exclusive,f.inclusive);t&&(v=h(f));for(o in a)(!t||v[o])&&(l=f.displayNames[o],u=l.owner+" > "+l.current,e[u]=e[u]||{componentName:u,time:0,count:0},f.inclusive[o]&&(e[u].time+=f.inclusive[o]),f.counts[o]&&(e[u].count+=f.counts[o]))}s=[];for(u in e)e[u].time>=r&&s.push(e[u]);return s.sort(function(n,t){return t.time-n.time}),s}function h(n){var f={},e=Object.keys(n.writes),o=i({},n.exclusive,n.inclusive),t,u,r;for(t in o){for(u=!1,r=0;r<e.length;r++)if(e[r].indexOf(t)===0){u=!0;break}!u&&n.counts[t]>0&&(f[t]=!0)}return f}var i=n(29),r=1.2,u={_mountImageIntoNode:"set innerHTML",INSERT_MARKUP:"set innerHTML",MOVE_EXISTING:"move",REMOVE_NODE:"remove",TEXT_CONTENT:"set textContent",updatePropertyByID:"update attribute",deletePropertyByID:"delete attribute",updateStylesByID:"update styles",updateInnerHTMLByID:"set innerHTML",dangerouslyReplaceNodeWithMarkupByID:"replace"},c={getExclusiveSummary:o,getInclusiveSummary:s,getDOMSummary:e,getTotalTime:f};t.exports=c},{"29":29}],63:[function(n,t){"use strict";function h(n,t){Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:function(){return this._store?this._store[t]:null},set:function(n){s(!1,"Don't set the %s property of the React element. Instead, specify the correct value when initially creating the element.",t);this._store[t]=n}})}function c(n){var t,i;try{t={props:!0};for(i in t)h(n,i);e=!0}catch(r){}}var o=n(44),r=n(45),u=n(29),s=n(171),f={key:!0,ref:!0},e=!1,i=function(n,t,i,r,f,o){if(this.type=n,this.key=t,this.ref=i,this._owner=r,this._context=f,!0){this._store={props:o,originalProps:u({},o)};try{Object.defineProperty(this._store,"validated",{configurable:!1,enumerable:!1,writable:!0})}catch(s){}if(this._store.validated=!1,e){Object.freeze(this);return}}this.props=o};i.prototype={_isReactElement:!0};!0&&c(i.prototype);i.createElement=function(n,t,u){var e,s={},v=null,y=null,h,l,c,a;if(t!=null){y=t.ref===undefined?null:t.ref;v=t.key===undefined?null:""+t.key;for(e in t)t.hasOwnProperty(e)&&!f.hasOwnProperty(e)&&(s[e]=t[e])}if(h=arguments.length-2,h===1)s.children=u;else if(h>1){for(l=Array(h),c=0;c<h;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps){a=n.defaultProps;for(e in a)typeof s[e]=="undefined"&&(s[e]=a[e])}return new i(n,v,y,r.current,o.current,s)};i.createFactory=function(n){var t=i.createElement.bind(null,n);return t.type=n,t};i.cloneAndReplaceProps=function(n,t){var r=new i(n.type,n.key,n.ref,n._owner,n._context,t);return!0&&(r._store.validated=n._store.validated),r};i.cloneElement=function(n,t,e){var o,c=u({},n.props),a=n.key,v=n.ref,y=n._owner,s,l,h;if(t!=null){t.ref!==undefined&&(v=t.ref,y=r.current);t.key!==undefined&&(a=""+t.key);for(o in t)t.hasOwnProperty(o)&&!f.hasOwnProperty(o)&&(c[o]=t[o])}if(s=arguments.length-2,s===1)c.children=e;else if(s>1){for(l=Array(s),h=0;h<s;h++)l[h]=arguments[h+2];c.children=l}return new i(n.type,a,v,y,n._context,c)};i.isValidElement=function(n){return!!(n&&n._isReactElement)};t.exports=i},{"171":171,"29":29,"44":44,"45":45}],64:[function(n,t){"use strict";function g(){if(u.current){var n=u.current.getName();if(n)return" Check the render method of `"+n+"`."}return""}function s(n){var i=n&&n.getPublicInstance(),t;return i?(t=i.constructor,!t)?undefined:t.displayName||t.name||undefined:undefined}function tt(){var n=u.current;return n&&s(n)||undefined}function h(n,t){n._store.validated||n.key!=null||(n._store.validated=!0,c('Each child in an array or iterator should have a unique "key" prop.',n,t))}function it(n,t,i){nt.test(n)&&c("Child objects should have non-numeric keys so ordering is preserved.",t,i)}function c(n,t,r){var f=tt(),o=typeof r=="string"?r:r.displayName||r.name,c=f||o,l=e[n]||(e[n]={}),a,h,v;l.hasOwnProperty(c)||(l[c]=!0,a=f?" Check the render method of "+f+".":o?" Check the React.render call using <"+o+">.":"",h="",t&&t._owner&&t._owner!==u.current&&(v=s(t._owner),h=" It was passed a child from "+v+"."),i(!1,n+"%s%s See https://fb.me/react-warning-keys for more information.",a,h))}function l(n,t){var i,o,u,c,s,f,e;if(Array.isArray(n))for(i=0;i<n.length;i++)o=n[i],r.isValidElement(o)&&h(o,t);else if(r.isValidElement(n))n._store.validated=!0;else if(n)if(u=d(n),u){if(u!==n.entries)for(c=u.call(n);!(s=c.next()).done;)r.isValidElement(s.value)&&h(s.value,t)}else if(typeof n=="object"){f=p.extractIfFragment(n);for(e in f)f.hasOwnProperty(e)&&it(e,f[e],t)}}function rt(n,t,r,u){var e,s,h;for(e in t)if(t.hasOwnProperty(e)){try{f(typeof t[e]=="function","%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",n||"React class",b[u],e);s=t[e](r,e,n,u)}catch(c){s=c}s instanceof Error&&!(s.message in o)&&(o[s.message]=!0,h=g(this),i(!1,"Failed propType: %s%s",s.message,h))}}function ut(n,t){var r=t.type,u=typeof r=="string"?r:r.displayName,f=t._owner?t._owner.getPublicInstance().constructor.displayName:null,s=n+"|"+u+"|"+f,e,o;a.hasOwnProperty(s)||(a[s]=!0,e="",u&&(e=" <"+u+" />"),o="",f&&(o=" The element was created by "+f+"."),i(!1,"Don't set .props.%s of the React component%s. Instead, specify the correct value when initially creating the element or use React.cloneElement to make a new element with updated props.%s",n,e,o))}function ft(n,t){return n!==n?t!==t:n===0&&t===0?1/n==1/t:n===t}function et(n){var r,i,t;if(n._store){r=n._store.originalProps;i=n.props;for(t in i)i.hasOwnProperty(t)&&(r.hasOwnProperty(t)&&ft(r[t],i[t])||(ut(t,n),r[t]=i[t]))}}function v(n){if(n.type!=null){var t=k.getComponentClassForElement(n),r=t.displayName||t.name;t.propTypes&&rt(r,t.propTypes,n.props,w.prop);typeof t.getDefaultProps=="function"&&i(t.getDefaultProps.isReactClassApproved,"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var r=n(63),p=n(69),w=n(85),b=n(84),u=n(45),k=n(80),d=n(141),f=n(150),i=n(171),e={},o={},nt=/^\d+$/,a={},y={checkAndWarnForMutatedProps:et,createElement:function(n){var t,u;if(i(n!=null,"React.createElement: type should not be null or undefined. It should be a string (for DOM elements) or a ReactClass (for composite components)."),t=r.createElement.apply(this,arguments),t==null)return t;for(u=2;u<arguments.length;u++)l(arguments[u],n);return v(t),t},createFactory:function(n){var t=y.createElement.bind(null,n);if(t.type=n,!0)try{Object.defineProperty(t,"type",{enumerable:!1,get:function(){return i(!1,"Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:n}),n}})}catch(r){}return t},cloneElement:function(){for(var n=r.cloneElement.apply(this,arguments),t=2;t<arguments.length;t++)l(arguments[t],n.type);return v(n),n}};t.exports=y},{"141":141,"150":150,"171":171,"45":45,"63":63,"69":69,"80":80,"84":84,"85":85}],65:[function(n,t){"use strict";function l(n){u[n]=!0}function a(n){delete u[n]}function v(n){return!!u[n]}var f=n(63),e=n(73),o=n(150),i,u={},c={injectEmptyComponent:function(n){i=f.createFactory(n)}},r=function(){},s,h;r.prototype.componentDidMount=function(){var n=e.get(this);n&&l(n._rootNodeID)};r.prototype.componentWillUnmount=function(){var n=e.get(this);n&&a(n._rootNodeID)};r.prototype.render=function(){return o(i,"Trying to return null from a render, but no null placeholder component was injected."),i()};s=f.createElement(r);h={emptyElement:s,injection:c,isNullComponentID:v};t.exports=h},{"150":150,"63":63,"73":73}],66:[function(n,t){"use strict";var i={guard:function(n){return n}};t.exports=i},{}],67:[function(n,t){"use strict";function r(n){i.enqueueEvents(n);i.processEventQueue()}var i=n(18),u={handleTopLevel:function(n,t,u,f){var e=i.extractEvents(n,t,u,f);r(e)}};t.exports=u},{"18":18}],68:[function(n,t){"use strict";function v(n){var t=r.getID(n),i=s.getReactRootIDFromNodeID(t),u=r.findReactContainerForID(i);return r.getFirstReactDOM(u)}function u(n,t){this.topLevelType=n;this.nativeEvent=t;this.ancestors=[]}function y(n){for(var t=r.getFirstReactDOM(l(n.nativeEvent))||window,u=t,f,e,o;u;)n.ancestors.push(u),u=v(u);for(f=0,e=n.ancestors.length;f<e;f++)t=n.ancestors[f],o=r.getID(t)||"",i._handleTopLevel(n.topLevelType,t,o,n.nativeEvent)}function p(n){var t=a(window);n(t)}var f=n(17),o=n(22),e=n(30),s=n(72),r=n(77),h=n(100),c=n(29),l=n(140),a=n(146),i;c(u.prototype,{destructor:function(){this.topLevelType=null;this.nativeEvent=null;this.ancestors.length=0}});e.addPoolingTo(u,e.twoArgumentPooler);i={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:o.canUseDOM?window:null,setHandleTopLevel:function(n){i._handleTopLevel=n},setEnabled:function(n){i._enabled=!!n},isEnabled:function(){return i._enabled},trapBubbledEvent:function(n,t,r){var u=r;return u?f.listen(u,t,i.dispatchEvent.bind(null,n)):null},trapCapturedEvent:function(n,t,r){var u=r;return u?f.capture(u,t,i.dispatchEvent.bind(null,n)):null},monitorScrollValue:function(n){var t=p.bind(null,n);f.listen(window,"scroll",t)},dispatchEvent:function(n,t){if(i._enabled){var r=u.getPooled(n,t);try{h.batchedUpdates(y,r)}finally{u.release(r)}}}};t.exports=i},{"100":100,"140":140,"146":146,"17":17,"22":22,"29":29,"30":30,"72":72,"77":77}],69:[function(n,t){"use strict";var o=n(63),r=n(171),s,e;if(1){var i="_reactFragment",u="_reactDidWarn",f=!1;try{s=function(){return 1};Object.defineProperty({},i,{enumerable:!1,value:!0});Object.defineProperty({},"key",{enumerable:!0,get:s});f=!0}catch(a){}var c=function(n,t){Object.defineProperty(n,t,{enumerable:!0,get:function(){return r(this[u],"A ReactFragment is an opaque type. Accessing any of its properties is deprecated. Pass it to one of the React.Children helpers."),this[u]=!0,this[i][t]},set:function(n){r(this[u],"A ReactFragment is an immutable opaque type. Mutating its properties is deprecated.");this[u]=!0;this[i][t]=n}})},h={},l=function(n){var t="",i,r;for(i in n)t+=i+":"+typeof n[i]+",";return r=!!h[t],h[t]=!0,r}}e={create:function(n){var t,e;if(1){if(typeof n!="object"||!n||Array.isArray(n))return r(!1,"React.addons.createFragment only accepts a single object.",n),n;if(o.isValidElement(n))return r(!1,"React.addons.createFragment does not accept a ReactElement without a wrapper object."),n;if(f){t={};Object.defineProperty(t,i,{enumerable:!1,value:n});Object.defineProperty(t,u,{writable:!0,enumerable:!1,value:!1});for(e in n)c(t,e);return Object.preventExtensions(t),t}}return n},extract:function(n){return!0&&f?n[i]?n[i]:(r(l(n),"Any use of a keyed object should be wrapped in React.addons.createFragment(object) before being passed as a child."),n):n},extractIfFragment:function(n){if(!0&&f){if(n[i])return n[i];for(var t in n)if(n.hasOwnProperty(t)&&o.isValidElement(n[t]))return e.extract(n)}return n}};t.exports=e},{"171":171,"63":63}],70:[function(n,t){"use strict";var i=n(11),r=n(18),u=n(41),f=n(38),e=n(65),o=n(33),s=n(80),h=n(48),c=n(82),l=n(91),a=n(100),v={Component:u.injection,Class:f.injection,DOMComponent:h.injection,DOMProperty:i.injection,EmptyComponent:e.injection,EventPluginHub:r.injection,EventEmitter:o.injection,NativeComponent:s.injection,Perf:c.injection,RootIndex:l.injection,Updates:a.injection};t.exports=v},{"100":100,"11":11,"18":18,"33":33,"38":38,"41":41,"48":48,"65":65,"80":80,"82":82,"91":91}],71:[function(n,t){"use strict";function o(n){return f(document.documentElement,n)}var r=n(56),f=n(123),e=n(134),u=n(136),i={hasSelectionCapabilities:function(n){return n&&(n.nodeName==="INPUT"&&n.type==="text"||n.nodeName==="TEXTAREA"||n.contentEditable==="true")},getSelectionInformation:function(){var n=u();return{focusedElem:n,selectionRange:i.hasSelectionCapabilities(n)?i.getSelection(n):null}},restoreSelection:function(n){var r=u(),t=n.focusedElem,f=n.selectionRange;r!==t&&o(t)&&(i.hasSelectionCapabilities(t)&&i.setSelection(t,f),e(t))},getSelection:function(n){var t,i;return"selectionStart"in n?t={start:n.selectionStart,end:n.selectionEnd}:document.selection&&n.nodeName==="INPUT"?(i=document.selection.createRange(),i.parentElement()===n&&(t={start:-i.moveStart("character",-n.value.length),end:-i.moveEnd("character",-n.value.length)})):t=r.getOffsets(n),t||{start:0,end:0}},setSelection:function(n,t){var u=t.start,f=t.end,i;typeof f=="undefined"&&(f=u);"selectionStart"in n?(n.selectionStart=u,n.selectionEnd=Math.min(f,n.value.length)):document.selection&&n.nodeName==="INPUT"?(i=n.createTextRange(),i.collapse(!0),i.moveStart("character",u),i.moveEnd("character",f-u),i.select()):r.setOffsets(n,t)}};t.exports=i},{"123":123,"134":134,"136":136,"56":56}],72:[function(n,t){"use strict";function v(n){return r+n.toString(36)}function o(n,t){return n.charAt(t)===r||t===n.length}function u(n){return n===""||n.charAt(0)===r&&n.charAt(n.length-1)!==r}function f(n,t){return t.indexOf(n)===0&&o(t,n.length)}function y(n){return n?n.substr(0,n.lastIndexOf(r)):""}function h(n,t){if(i(u(n)&&u(t),"getNextDescendantID(%s, %s): Received an invalid React DOM ID.",n,t),i(f(n,t),"getNextDescendantID(...): React has made an invalid assumption about the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.",n,t),n===t)return n;for(var e=n.length+a,r=e;r<t.length;r++)if(o(t,r))break;return t.substr(0,r)}function c(n,t){var s=Math.min(n.length,t.length),e,r,f;if(s===0)return"";for(e=0,r=0;r<=s;r++)if(o(n,r)&&o(t,r))e=r;else if(n.charAt(r)!==t.charAt(r))break;return f=n.substr(0,e),i(u(f),"getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s",n,t,f),f}function e(n,t,r,u,e,o){var l,a,v,c,p;for(n=n||"",t=t||"",i(n!==t,"traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.",n),l=f(t,n),i(l||f(n,t),"traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do not have a parent path.",n,t),a=0,v=l?y:h,c=n;;c=v(c,t)){if(e&&c===n||o&&c===t||(p=r(c,l,u)),p===!1||c===t)break;i(a++<s,"traverseParentPath(%s, %s, ...): Detected an infinite loop while traversing the React DOM ID tree. This may be due to malformed IDs: %s",n,t)}}var l=n(91),i=n(150),r=".",a=r.length,s=100,p={createReactRootID:function(){return v(l.createReactRootIndex())},createReactID:function(n,t){return n+t},getReactRootIDFromNodeID:function(n){if(n&&n.charAt(0)===r&&n.length>1){var t=n.indexOf(r,1);return t>-1?n.substr(0,t):n}return null},traverseEnterLeave:function(n,t,i,r,u){var f=c(n,t);f!==n&&e(n,f,i,r,!1,!0);f!==t&&e(f,t,i,u,!0,!1)},traverseTwoPhase:function(n,t,i){n&&(e("",n,t,i,!0,!1),e(n,"",t,i,!1,!0))},traverseAncestors:function(n,t,i){e("",n,t,i,!0,!1)},_getFirstCommonAncestorID:c,_getNextDescendantID:h,isAncestorIDOf:f,SEPARATOR:r};t.exports=p},{"150":150,"91":91}],73:[function(n,t){"use strict";var i={remove:function(n){n._reactInternalInstance=undefined},get:function(n){return n._reactInternalInstance},has:function(n){return n._reactInternalInstance!==undefined},set:function(n,t){n._reactInternalInstance=t}};t.exports=i},{}],74:[function(n,t){"use strict";t.exports={currentlyMountingInstance:null,currentlyUnmountingInstance:null}},{}],75:[function(n,t){"use strict";function r(n,t){this.value=n;this.requestChange=t}function u(n){var t={value:typeof n=="undefined"?i.PropTypes.any.isRequired:n.isRequired,requestChange:i.PropTypes.func.isRequired};return i.PropTypes.shape(t)}var i=n(31);r.PropTypes={link:u};t.exports=r},{"31":31}],76:[function(n,t){"use strict";var r=n(119),i={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(n){var t=r(n);return n.replace(">"," "+i.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(n,t){var u=t.getAttribute(i.CHECKSUM_ATTR_NAME),f;return u=u&&parseInt(u,10),f=r(n),f===u}};t.exports=i},{"119":119}],77:[function(n,t){"use strict";function wt(n,t){for(var r=Math.min(n.length,t.length),i=0;i<r;i++)if(n.charAt(i)!==t.charAt(i))return i;return n.length===t.length?-1:r}function v(n){var t=c(n);return t&&i.getID(t)}function bt(n){var t=e(n),i;return t&&(u.hasOwnProperty(t)?(i=u[t],i!==n&&(r(!y(i,t),"ReactMount: Two valid but unequal nodes with the same `%s`: %s",b,t),u[t]=n)):u[t]=n),t}function e(n){return n&&n.getAttribute&&n.getAttribute(b)||""}function kt(n,t){var i=e(n);i!==t&&delete u[i];n.setAttribute(b,t);u[t]=n}function dt(n){return u.hasOwnProperty(n)&&y(u[n],n)||(u[n]=i.findReactNodeByID(n)),u[n]}function gt(n){var t=st.get(n)._rootNodeID;return ot.isNullComponentID(t)?null:(u.hasOwnProperty(t)&&y(u[t],t)||(u[t]=i.findReactNodeByID(t)),u[t])}function y(n,t){if(n){r(e(n)===t,"ReactMount: Unexpected modification of `%s`",b);var u=i.findReactContainerForID(t);if(u&&lt(u,n))return!0}return!1}function ni(n){delete u[n]}function ti(n){var t=u[n];if(t&&y(t,n))p=t;else return!1}function ii(n){p=null;o.traverseAncestors(n,ti);var t=p;return p=null,t}function ri(n,t,r,u,f){var e=tt.mountComponent(n,t,u,ct);n._isTopLevel=!0;i._mountImageIntoNode(e,r,f)}function ui(n,t,i,r){var u=d.ReactReconcileTransaction.getPooled();u.perform(ri,null,n,t,i,u,r);d.ReactReconcileTransaction.release(u)}var ut=n(11),ft=n(33),nt=n(45),k=n(63),et=n(64),ot=n(65),o=n(72),st=n(73),w=n(76),ht=n(82),tt=n(89),it=n(99),d=n(100),ct=n(130),lt=n(123),c=n(144),at=n(149),r=n(150),vt=n(164),yt=n(167),l=n(171),pt=o.SEPARATOR,b=ut.ID_ATTRIBUTE_NAME,u={},s=1,f=9,a={},g={},h,rt,p,i;!0&&(h={});rt=[];p=null;i={_instancesByReactRootID:a,scrollMonitor:function(n,t){t()},_updateRootComponent:function(n,t,r,u){return!0&&et.checkAndWarnForMutatedProps(t),i.scrollMonitor(r,function(){it.enqueueElementInternal(n,t);u&&it.enqueueCallbackInternal(n,u)}),!0&&(h[v(r)]=c(r)),n},_registerComponent:function(n,t){r(t&&(t.nodeType===s||t.nodeType===f),"_registerComponent(...): Target container is not a DOM element.");ft.ensureScrollValueMonitoring();var u=i.registerContainer(t);return a[u]=n,u},_renderNewRootComponent:function(n,t,r){l(nt.current==null,"_renderNewRootComponent(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.");var u=at(n,null),f=i._registerComponent(u,t);return d.batchedUpdates(ui,u,f,t,r),!0&&(h[f]=c(t)),u},render:function(n,t,u){var f,y,e,s,o,p,h;if(r(k.isValidElement(n),"React.render(): Invalid component element.%s",typeof n=="string"?" Instead of passing an element string, make sure to instantiate it by passing it to React.createElement.":typeof n=="function"?" Instead of passing a component class, make sure to instantiate it by passing it to React.createElement.":n!=null&&n.props!==undefined?" This may be caused by unintentionally loading two independent copies of React.":""),f=a[v(t)],f){if(y=f._currentElement,yt(y,n))return i._updateRootComponent(f,n,t,u).getPublicInstance();i.unmountComponentAtNode(t)}if(e=c(t),s=e&&i.isRenderedByReact(e),!0&&(!s||e.nextSibling))for(o=e;o;){if(i.isRenderedByReact(o)){l(!1,"render(): Target node has markup rendered by React, but there are unrelated nodes as well. This is most commonly caused by white-space inserted around server-rendered markup.");break}o=o.nextSibling}return p=s&&!f,h=i._renderNewRootComponent(n,t,p).getPublicInstance(),u&&u.call(h),h},constructAndRenderComponent:function(n,t,r){var u=k.createElement(n,t);return i.render(u,r)},constructAndRenderComponentByID:function(n,t,u){var f=document.getElementById(u);return r(f,'Tried to get element with id of "%s" but it is not present on the page.',u),i.constructAndRenderComponent(n,t,f)},registerContainer:function(n){var t=v(n);return t&&(t=o.getReactRootIDFromNodeID(t)),t||(t=o.createReactRootID()),g[t]=n,t},unmountComponentAtNode:function(n){l(nt.current==null,"unmountComponentAtNode(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.");r(n&&(n.nodeType===s||n.nodeType===f),"unmountComponentAtNode(...): Target container is not a DOM element.");var t=v(n),u=a[t];return u?(i.unmountComponentFromNode(u,n),delete a[t],delete g[t],!0&&delete h[t],!0):!1},unmountComponentFromNode:function(n,t){for(tt.unmountComponent(n),t.nodeType===f&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(n){var t=o.getReactRootIDFromNodeID(n),f=g[t],i,u;return!0&&(i=h[t],i&&i.parentNode!==f&&(r(e(i)===t,"ReactMount: Root element ID differed from reactRootID."),u=f.firstChild,u&&t===e(u)?h[t]=u:l(!1,"ReactMount: Root element has been removed from its original container. New container:",i.parentNode))),f},findReactNodeByID:function(n){var t=i.findReactContainerForID(n);return i.findComponentRoot(t,n)},isRenderedByReact:function(n){if(n.nodeType!==1)return!1;var t=i.getID(n);return t?t.charAt(0)===pt:!1},getFirstReactDOM:function(n){for(var t=n;t&&t.parentNode!==t;){if(i.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(n,t){var u=rt,s=0,c=ii(t)||n,f,h,e;for(u[0]=c.firstChild,u.length=1;s<u.length;){for(f=u[s++];f;)e=i.getID(f),e?t===e?h=f:o.isAncestorIDOf(e,t)&&(u.length=s=0,u.push(f.firstChild)):u.push(f.firstChild),f=f.nextSibling;if(h)return u.length=0,h}u.length=0;r(!1,"findComponentRoot(..., %s): Unable to find element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting tags like <form>, <p>, or <a>, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",t,i.getID(n))},_mountImageIntoNode:function(n,t,i){var u,a,o,e,h;if(r(t&&(t.nodeType===s||t.nodeType===f),"mountComponentIntoNode(...): Target container is not valid."),i){if(u=c(t),w.canReuseMarkup(n,u))return;a=u.getAttribute(w.CHECKSUM_ATTR_NAME);u.removeAttribute(w.CHECKSUM_ATTR_NAME);o=u.outerHTML;u.setAttribute(w.CHECKSUM_ATTR_NAME,a);e=wt(n,o);h=" (client) "+n.substring(e-20,e+20)+"\n (server) "+o.substring(e-20,e+20);r(t.nodeType!==f,"You're trying to render a component to the document using server rendering but the checksum was invalid. This usually means you rendered a different component type or props on the client from the one on the server, or your render() methods are impure. React cannot handle this case due to cross-browser quirks by rendering at the document root. You should look for environment dependent code in your components and ensure the props are the same client and server side:\n%s",h);!0&&l(!1,"React attempted to reuse markup in a container but the checksum was invalid. This generally means that you are using server rendering and the markup generated on the server was not what the client was expecting. React injected new markup to compensate which works but you have lost many of the benefits of server rendering. Instead, figure out why the markup being generated is different on the client or server:\n%s",h)}r(t.nodeType!==f,"You're trying to render a component to the document but you didn't use server rendering. We can't do this without using server rendering due to cross-browser quirks. See React.renderToString() for server rendering.");vt(t,n)},getReactRootID:v,getID:bt,setID:kt,getNode:dt,getNodeFromInstance:gt,purgeID:ni};ht.measureMethods(i,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"});t.exports=i},{"100":100,"11":11,"123":123,"130":130,"144":144,"149":149,"150":150,"164":164,"167":167,"171":171,"33":33,"45":45,"63":63,"64":64,"65":65,"72":72,"73":73,"76":76,"82":82,"89":89,"99":99}],78:[function(n,t){"use strict";function l(n,t,r){i.push({parentID:n,parentNode:null,type:u.INSERT_MARKUP,markupIndex:e.push(t)-1,textContent:null,fromIndex:null,toIndex:r})}function a(n,t,r){i.push({parentID:n,parentNode:null,type:u.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:r})}function v(n,t){i.push({parentID:n,parentNode:null,type:u.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function y(n,t){i.push({parentID:n,parentNode:null,type:u.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function h(){i.length&&(c.processChildrenUpdates(i,e),o())}function o(){i.length=0;e.length=0}var c=n(41),u=n(79),s=n(89),f=n(36),r=0,i=[],e=[],p={Mixin:{mountChildren:function(n,t,i){var r=f.instantiateChildren(n,t,i),e,o,u;this._renderedChildren=r;e=[];o=0;for(u in r)if(r.hasOwnProperty(u)){var h=r[u],c=this._rootNodeID+u,l=s.mountComponent(h,c,t,i);h._mountIndex=o;e.push(l);o++}return e},updateTextContent:function(n){var u,t,i;r++;u=!0;try{t=this._renderedChildren;f.unmountChildren(t);for(i in t)t.hasOwnProperty(i)&&this._unmountChildByName(t[i],i);this.setTextContent(n);u=!1}finally{r--;r||(u?o():h())}},updateChildren:function(n,t,i){r++;var u=!0;try{this._updateChildren(n,t,i);u=!1}finally{r--;r||(u?o():h())}},_updateChildren:function(n,t,i){var e=this._renderedChildren,o=f.updateChildren(e,n,t,i),r,s,h,u,c;if(this._renderedChildren=o,o||e){s=0;h=0;for(r in o)o.hasOwnProperty(r)&&(u=e&&e[r],c=o[r],u===c?(this.moveChild(u,h,s),s=Math.max(u._mountIndex,s),u._mountIndex=h):(u&&(s=Math.max(u._mountIndex,s),this._unmountChildByName(u,r)),this._mountChildByNameAtIndex(c,r,h,t,i)),h++);for(r in e)!e.hasOwnProperty(r)||o&&o.hasOwnProperty(r)||this._unmountChildByName(e[r],r)}},unmountChildren:function(){var n=this._renderedChildren;f.unmountChildren(n);this._renderedChildren=null},moveChild:function(n,t,i){n._mountIndex<i&&a(this._rootNodeID,n._mountIndex,t)},createChild:function(n,t){l(this._rootNodeID,t,n._mountIndex)},removeChild:function(n){v(this._rootNodeID,n._mountIndex)},setTextContent:function(n){y(this._rootNodeID,n)},_mountChildByNameAtIndex:function(n,t,i,r,u){var f=this._rootNodeID+t,e=s.mountComponent(n,f,r,u);n._mountIndex=i;this.createChild(n,e)},_unmountChildByName:function(n){this.removeChild(n);n._mountIndex=null}}};t.exports=p},{"36":36,"41":41,"79":79,"89":89}],79:[function(n,t){"use strict";var i=n(156),r=i({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=r},{"156":156}],80:[function(n,t){"use strict";function h(n){if(typeof n.type=="function")return n.type;var t=n.type,i=r[t];return i==null&&(r[t]=i=e(t)),i}function c(n){return f(i,"There is no registered component for the tag %s",n.type),new i(n.type,n.props)}function l(n){return new u(n)}function a(n){return n instanceof u}var o=n(29),f=n(150),e=null,i=null,r={},u=null,s={injectGenericComponentClass:function(n){i=n},injectTextComponentClass:function(n){u=n},injectComponentClasses:function(n){o(r,n)},injectAutoWrapper:function(n){e=n}},v={getComponentClassForElement:h,createInternalComponent:c,createInstanceForText:l,isTextComponent:a,injection:s};t.exports=v},{"150":150,"29":29}],81:[function(n,t){"use strict";var r=n(150),i={isValidOwner:function(n){return!!(n&&typeof n.attachRef=="function"&&typeof n.detachRef=="function")},addComponentAsRefTo:function(n,t,u){r(i.isValidOwner(u),"addComponentAsRefTo(...): Only a ReactOwner can have refs. This usually means that you're trying to add a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref.");u.attachRef(t,n)},removeComponentAsRefFrom:function(n,t,u){r(i.isValidOwner(u),"removeComponentAsRefFrom(...): Only a ReactOwner can have refs. This usually means that you're trying to remove a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref.");u.getPublicInstance().refs[t]===n.getPublicInstance()&&u.detachRef(t)}};t.exports=i},{"150":150}],82:[function(n,t){"use strict";function r(n,t,i){return i}var i={enableMeasure:!1,storedMeasure:r,measureMethods:function(n,t,r){if(1)for(var u in r)r.hasOwnProperty(u)&&(n[u]=i.measure(t,r[u],n[u]))},measure:function(n,t,r){if(1){var u=null,f=function(){return i.enableMeasure?(u||(u=i.storedMeasure(n,t,r)),u.apply(this,arguments)):r.apply(this,arguments)};return f.displayName=n+"_"+t,f}return r},injection:{injectMeasure:function(n){i.storedMeasure=n}}};t.exports=i},{}],83:[function(n,t){"use strict";function r(n){return function(t,i,r){t[i]=t.hasOwnProperty(i)?n(t[i],r):r}}function s(n,t){var i,r;for(i in t)t.hasOwnProperty(i)&&(r=u[i],r&&u.hasOwnProperty(i)?r(n,i,t[i]):n.hasOwnProperty(i)||(n[i]=t[i]));return n}var i=n(29),f=n(129),e=n(155),o=r(function(n,t){return i({},t,n)}),u={children:f,className:r(e),style:o},h={mergeProps:function(n,t){return s(i({},n),t)}};t.exports=h},{"129":129,"155":155,"29":29}],84:[function(n,t){"use strict";var i={};!0&&(i={prop:"prop",context:"context",childContext:"child context"});t.exports=i},{}],85:[function(n,t){"use strict";var i=n(156),r=i({prop:null,context:null,childContext:null});t.exports=r},{"156":156}],86:[function(n,t){"use strict";function r(n){function t(t,r,u,f,e){if(f=f||s,r[u]==null){var o=i[e];return t?new Error("Required "+o+" `"+u+"` was not specified in "+("`"+f+"`.")):null}return n(r,u,f,e)}var r=t.bind(null,!1);return r.isRequired=t.bind(null,!0),r}function u(n){function t(t,r,u,e){var o=t[r],c=f(o),s,h;return c!==n?(s=i[e],h=it(o),new Error("Invalid "+s+" `"+r+"` of type `"+h+"` "+("supplied to `"+u+"`, expected `"+n+"`."))):null}return r(t)}function y(){return r(c.thatReturns(null))}function p(n){function t(t,r,u,e){var o=t[r],c,l,s,h;if(!Array.isArray(o))return c=i[e],l=f(o),new Error("Invalid "+c+" `"+r+"` of type "+("`"+l+"` supplied to `"+u+"`, expected an array."));for(s=0;s<o.length;s++)if(h=n(o,s,u,e),h instanceof Error)return h;return null}return r(t)}function w(){function n(n,t,r,u){if(!o.isValidElement(n[t])){var f=i[u];return new Error("Invalid "+f+" `"+t+"` supplied to "+("`"+r+"`, expected a ReactElement."))}return null}return r(n)}function b(n){function t(t,r,u,f){if(!(t[r]instanceof n)){var e=i[f],o=n.name||s;return new Error("Invalid "+e+" `"+r+"` supplied to "+("`"+u+"`, expected instance of `"+o+"`."))}return null}return r(t)}function k(n){function t(t,r,u,f){for(var s,h,o=t[r],e=0;e<n.length;e++)if(o===n[e])return null;return s=i[f],h=JSON.stringify(n),new Error("Invalid "+s+" `"+r+"` of value `"+o+"` "+("supplied to `"+u+"`, expected one of "+h+"."))}return r(t)}function d(n){function t(t,r,u,e){var o=t[r],c=f(o),l,s,h;if(c!=="object")return l=i[e],new Error("Invalid "+l+" `"+r+"` of type "+("`"+c+"` supplied to `"+u+"`, expected an object."));for(s in o)if(o.hasOwnProperty(s)&&(h=n(o,s,u,e),h instanceof Error))return h;return null}return r(t)}function g(n){function t(t,r,u,f){for(var o,s,e=0;e<n.length;e++)if(o=n[e],o(t,r,u,f)==null)return null;return s=i[f],new Error("Invalid "+s+" `"+r+"` supplied to "+("`"+u+"`."))}return r(t)}function nt(){function n(n,t,r,u){if(!e(n[t])){var f=i[u];return new Error("Invalid "+f+" `"+t+"` supplied to "+("`"+r+"`, expected a ReactNode."))}return null}return r(n)}function tt(n){function t(t,r,u,e){var c=t[r],l=f(c),a,o,s,h;if(l!=="object")return a=i[e],new Error("Invalid "+a+" `"+r+"` of type `"+l+"` "+("supplied to `"+u+"`, expected `object`."));for(o in n)if((s=n[o],s)&&(h=s(c,o,u,e),h))return h;return null}return r(t)}function e(n){switch(typeof n){case"number":case"string":case"undefined":return!0;case"boolean":return!n;case"object":if(Array.isArray(n))return n.every(e);if(n===null||o.isValidElement(n))return!0;n=h.extractIfFragment(n);for(var t in n)if(!e(n[t]))return!1;return!0;default:return!1}}function f(n){var t=typeof n;return Array.isArray(n)?"array":n instanceof RegExp?"object":t}function it(n){var t=f(n);if(t==="object"){if(n instanceof Date)return"date";if(n instanceof RegExp)return"regexp"}return t}var o=n(63),h=n(69),i=n(84),c=n(129),s="<<anonymous>>",l=w(),a=nt(),v={array:u("array"),bool:u("boolean"),func:u("function"),number:u("number"),object:u("object"),string:u("string"),any:y(),arrayOf:p,element:l,instanceOf:b,node:a,objectOf:d,oneOf:k,oneOfType:g,shape:tt};t.exports=v},{"129":129,"63":63,"69":69,"84":84}],87:[function(n,t){"use strict";function i(){this.listenersToPut=[]}var r=n(30),u=n(33),f=n(29);f(i.prototype,{enqueuePutListener:function(n,t,i){this.listenersToPut.push({rootNodeID:n,propKey:t,propValue:i})},putListeners:function(){for(var t,n=0;n<this.listenersToPut.length;n++)t=this.listenersToPut[n],u.putListener(t.rootNodeID,t.propKey,t.propValue)},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}});r.addPoolingTo(i);t.exports=i},{"29":29,"30":30,"33":33}],88:[function(n,t){"use strict";function r(){this.reinitializeTransaction();this.renderToStaticMarkup=!1;this.reactMountReady=u.getPooled(null);this.putListenerQueue=e.getPooled()}var u=n(7),o=n(30),i=n(33),f=n(71),e=n(87),s=n(116),h=n(29),c={initialize:f.getSelectionInformation,close:f.restoreSelection},l={initialize:function(){var n=i.isEnabled();return i.setEnabled(!1),n},close:function(n){i.setEnabled(n)}},a={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},v={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},y=[v,c,l,a],p={getTransactionWrappers:function(){return y},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){u.release(this.reactMountReady);this.reactMountReady=null;e.release(this.putListenerQueue);this.putListenerQueue=null}};h(r.prototype,s.Mixin,p);o.addPoolingTo(r);t.exports=r},{"116":116,"29":29,"30":30,"33":33,"7":7,"71":71,"87":87}],89:[function(n,t){"use strict";function u(){i.attachRefs(this,this._currentElement)}var i=n(90),r=n(64),f={mountComponent:function(n,t,i,f){var e=n.mountComponent(t,i,f);return!0&&r.checkAndWarnForMutatedProps(n._currentElement),i.getReactMountReady().enqueue(u,n),e},unmountComponent:function(n){i.detachRefs(n,n._currentElement);n.unmountComponent()},receiveComponent:function(n,t,f,e){var o=n._currentElement,s;(t!==o||t._owner==null)&&(!0&&r.checkAndWarnForMutatedProps(t),s=i.shouldUpdateRefs(o,t),s&&i.detachRefs(n,o),n.receiveComponent(t,f,e),s&&f.getReactMountReady().enqueue(u,n))},performUpdateIfNecessary:function(n,t){n.performUpdateIfNecessary(t)}};t.exports=f},{"64":64,"90":90}],90:[function(n,t){"use strict";function u(n,t,i){typeof n=="function"?n(t.getPublicInstance()):r.addComponentAsRefTo(t,n,i)}function f(n,t,i){typeof n=="function"?n(null):r.removeComponentAsRefFrom(t,n,i)}var r=n(81),i={};i.attachRefs=function(n,t){var i=t.ref;i!=null&&u(i,n,t._owner)};i.shouldUpdateRefs=function(n,t){return t._owner!==n._owner||t.ref!==n.ref};i.detachRefs=function(n,t){var i=t.ref;i!=null&&f(i,n,t._owner)};t.exports=i},{"81":81}],91:[function(n,t){"use strict";var r={injectCreateReactRootIndex:function(n){i.createReactRootIndex=n}},i={createReactRootIndex:null,injection:r};t.exports=i},{}],92:[function(n,t){"use strict";function h(n){var t,h;u(i.isValidElement(n),"renderToString(): You must pass a valid ReactElement.");try{return h=f.createReactRootID(),t=r.getPooled(!1),t.perform(function(){var i=o(n,null),r=i.mountComponent(h,t,e);return s.addChecksumToMarkup(r)},null)}finally{r.release(t)}}function c(n){var t,s;u(i.isValidElement(n),"renderToStaticMarkup(): You must pass a valid ReactElement.");try{return s=f.createReactRootID(),t=r.getPooled(!0),t.perform(function(){var i=o(n,null);return i.mountComponent(s,t,e)},null)}finally{r.release(t)}}var i=n(63),f=n(72),s=n(76),r=n(93),e=n(130),o=n(149),u=n(150);t.exports={renderToString:h,renderToStaticMarkup:c}},{"130":130,"149":149,"150":150,"63":63,"72":72,"76":76,"93":93}],93:[function(n,t){"use strict";function i(n){this.reinitializeTransaction();this.renderToStaticMarkup=n;this.reactMountReady=r.getPooled(null);this.putListenerQueue=u.getPooled()}var e=n(30),r=n(7),u=n(87),o=n(116),s=n(29),f=n(129),h={initialize:function(){this.reactMountReady.reset()},close:f},c={initialize:function(){this.putListenerQueue.reset()},close:f},l=[c,h],a={getTransactionWrappers:function(){return l},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady);this.reactMountReady=null;u.release(this.putListenerQueue);this.putListenerQueue=null}};s(i.prototype,o.Mixin,a);e.addPoolingTo(i);t.exports=i},{"116":116,"129":129,"29":29,"30":30,"7":7,"87":87}],94:[function(n,t){"use strict";function r(n,t){var i={};return function(r){i[t]=r;n.setState(i)}}var i={createStateSetter:function(n,t){return function(i,r,u,f,e,o){var s=t.call(n,i,r,u,f,e,o);s&&n.setState(s)}},createStateKeySetter:function(n,t){var i=n.__keySetters||(n.__keySetters={});return i[t]||(i[t]=r(n,t))}};i.Mixin={createStateSetter:function(n){return i.createStateSetter(this,n)},createStateKeySetter:function(n){return i.createStateKeySetter(this,n)}};t.exports=i},{}],95:[function(n,t){"use strict";function b(){}function ot(n){return function(t,u){var f,c,e;i.isDOMComponent(t)?f=t.getDOMNode():t.tagName&&(f=t);c=new b;c.target=f;e=new ut(o.eventNameDispatchConfigs[n],rt.getID(f),c);h(e,u);tt.accumulateTwoPhaseDispatches(e);s.batchedUpdates(function(){r.enqueueEvents(e);r.processEventQueue()})}}function a(){i.Simulate={};for(var n in o.eventNameDispatchConfigs)i.Simulate[n]=ot(n)}function st(n){return function(t,r){var u=new b(n);h(u,r);i.isDOMComponent(t)?i.simulateNativeEventOnDOMComponent(n,t,u):!t.tagName||i.simulateNativeEventOnNode(n,t,u)}}var nt=n(16),r=n(18),tt=n(21),v=n(31),e=n(63),y=n(65),o=n(33),p=n(43),it=n(72),w=n(73),rt=n(77),s=n(100),ut=n(108),h=n(29),ft=n(130),et=nt.topLevelTypes,i={renderIntoDocument:function(n){var t=document.createElement("div");return v.render(n,t)},isElement:function(n){return e.isValidElement(n)},isElementOfType:function(n,t){return e.isValidElement(n)&&n.type===t},isDOMComponent:function(n){return!!(n&&n.tagName&&n.getDOMNode)},isDOMComponentElement:function(n){return!!(n&&e.isValidElement(n)&&!!n.tagName)},isCompositeComponent:function(n){return typeof n.render=="function"&&typeof n.setState=="function"},isCompositeComponentWithType:function(n,t){return!!(i.isCompositeComponent(n)&&n.constructor===t)},isCompositeComponentElement:function(n){if(!e.isValidElement(n))return!1;var t=n.type.prototype;return typeof t.render=="function"&&typeof t.setState=="function"},isCompositeComponentElementWithType:function(n,t){return!!(i.isCompositeComponentElement(n)&&n.constructor===t)},getRenderedChildOfCompositeComponent:function(n){if(!i.isCompositeComponent(n))return null;var t=w.get(n);return t._renderedComponent.getPublicInstance()},findAllInRenderedTree:function(n,t){var r,e,u,f;if(!n)return[];if(r=t(n)?[n]:[],i.isDOMComponent(n)){e=w.get(n);u=e._renderedComponent._renderedChildren;for(f in u)u.hasOwnProperty(f)&&u[f].getPublicInstance&&(r=r.concat(i.findAllInRenderedTree(u[f].getPublicInstance(),t)))}else i.isCompositeComponent(n)&&(r=r.concat(i.findAllInRenderedTree(i.getRenderedChildOfCompositeComponent(n),t)));return r},scryRenderedDOMComponentsWithClass:function(n,t){return i.findAllInRenderedTree(n,function(n){var r=n.props.className;return i.isDOMComponent(n)&&r&&(" "+r+" ").indexOf(" "+t+" ")!==-1})},findRenderedDOMComponentWithClass:function(n,t){var r=i.scryRenderedDOMComponentsWithClass(n,t);if(r.length!==1)throw new Error("Did not find exactly one match (found: "+r.length+") for class:"+t);return r[0]},scryRenderedDOMComponentsWithTag:function(n,t){return i.findAllInRenderedTree(n,function(n){return i.isDOMComponent(n)&&n.tagName===t.toUpperCase()})},findRenderedDOMComponentWithTag:function(n,t){var r=i.scryRenderedDOMComponentsWithTag(n,t);if(r.length!==1)throw new Error("Did not find exactly one match for tag:"+t);return r[0]},scryRenderedComponentsWithType:function(n,t){return i.findAllInRenderedTree(n,function(n){return i.isCompositeComponentWithType(n,t)})},findRenderedComponentWithType:function(n,t){var r=i.scryRenderedComponentsWithType(n,t);if(r.length!==1)throw new Error("Did not find exactly one match for componentType:"+t);return r[0]},mockComponent:function(n,t){return t=t||n.mockTagName||"div",n.prototype.render.mockImplementation(function(){return v.createElement(t,null,this.props.children)}),this},simulateNativeEventOnNode:function(n,t,i){i.target=t;o.ReactEventListener.dispatchEvent(n,i)},simulateNativeEventOnDOMComponent:function(n,t,r){i.simulateNativeEventOnNode(n,t.getDOMNode(),r)},nativeTouchData:function(n,t){return{touches:[{pageX:n,pageY:t}]}},createRenderer:function(){return new f},Simulate:null,SimulateNative:{}},f=function(){this._instance=null},c,l,k,d,u,g;f.prototype.getRenderOutput=function(){return this._instance&&this._instance._renderedComponent&&this._instance._renderedComponent._renderedOutput||null};c=function(n){this._renderedOutput=n;this._currentElement=n===null||n===!1?y.emptyElement:n};c.prototype={mountComponent:function(){},receiveComponent:function(n){this._renderedOutput=n;this._currentElement=n===null||n===!1?y.emptyElement:n},unmountComponent:function(){}};l=function(){};h(l.prototype,p.Mixin,{_instantiateReactComponent:function(n){return new c(n)},_replaceNodeWithMarkupByID:function(){},_renderValidatedComponent:p.Mixin._renderValidatedComponentWithoutOwnerOrContext});f.prototype.render=function(n,t){t||(t=ft);var i=s.ReactReconcileTransaction.getPooled();this._render(n,i,t);s.ReactReconcileTransaction.release(i)};f.prototype.unmount=function(){this._instance&&this._instance.unmountComponent()};f.prototype._render=function(n,t,i){if(this._instance)this._instance.receiveComponent(n,t,i);else{var u=it.createReactRootID(),r=new l(n.type);r.construct(n);r.mountComponent(u,t,i);this._instance=r}};k=r.injection.injectEventPluginOrder;r.injection.injectEventPluginOrder=function(){k.apply(this,arguments);a()};d=r.injection.injectEventPluginsByName;r.injection.injectEventPluginsByName=function(){d.apply(this,arguments);a()};a();for(u in et)g=u.indexOf("top")===0?u.charAt(3).toLowerCase()+u.substr(4):u,i.SimulateNative[g]=st(u);t.exports=i},{"100":100,"108":108,"130":130,"16":16,"18":18,"21":21,"29":29,"31":31,"33":33,"43":43,"63":63,"65":65,"72":72,"73":73,"77":77}],96:[function(n,t){"use strict";var i=n(37),r=n(69),u={getChildMapping:function(n){return n?r.extract(i.map(n,function(n){return n})):n},mergeChildMappings:function(n,t){function s(i){return t.hasOwnProperty(i)?t[i]:n[i]}var f,r,o,i,e,u,h;n=n||{};t=t||{};f={};r=[];for(o in n)t.hasOwnProperty(o)?r.length&&(f[o]=r,r=[]):r.push(o);e={};for(u in t){if(f.hasOwnProperty(u))for(i=0;i<f[u].length;i++)h=f[u][i],e[f[u][i]]=s(h);e[u]=s(u)}for(i=0;i<r.length;i++)e[r[i]]=s(r[i]);return e}};t.exports=u},{"37":37,"69":69}],97:[function(n,t){"use strict";function e(){var f=document.createElement("div"),e=f.style,u,n,t;"AnimationEvent"in window||delete r.animationend.animation;"TransitionEvent"in window||delete r.transitionend.transition;for(u in r){n=r[u];for(t in n)if(t in e){i.push(n[t]);break}}}function o(n,t,i){n.addEventListener(t,i,!1)}function s(n,t,i){n.removeEventListener(t,i,!1)}var f=n(22),r={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},i=[],u;f.canUseDOM&&e();u={addEndEventListener:function(n,t){if(i.length===0){window.setTimeout(t,0);return}i.forEach(function(i){o(n,i,t)})},removeEndEventListener:function(n,t){i.length!==0&&i.forEach(function(i){s(n,i,t)})}};t.exports=u},{"22":22}],98:[function(n,t){"use strict";var r=n(31),i=n(96),u=n(29),f=n(122),e=n(129),o=r.createClass({displayName:"ReactTransitionGroup",propTypes:{component:r.PropTypes.any,childFactory:r.PropTypes.func},getDefaultProps:function(){return{component:"span",childFactory:e.thatReturnsArgument}},getInitialState:function(){return{children:i.getChildMapping(this.props.children)}},componentWillMount:function(){this.currentlyTransitioningKeys={};this.keysToEnter=[];this.keysToLeave=[]},componentDidMount:function(){var n=this.state.children;for(var t in n)n[t]&&this.performAppear(t)},componentWillReceiveProps:function(n){var r=i.getChildMapping(n.children),u=this.state.children,t,f,e;this.setState({children:i.mergeChildMappings(u,r)});for(t in r)f=u&&u.hasOwnProperty(t),!r[t]||f||this.currentlyTransitioningKeys[t]||this.keysToEnter.push(t);for(t in u)e=r&&r.hasOwnProperty(t),!u[t]||e||this.currentlyTransitioningKeys[t]||this.keysToLeave.push(t)},componentDidUpdate:function(){var t=this.keysToEnter,n;this.keysToEnter=[];t.forEach(this.performEnter);n=this.keysToLeave;this.keysToLeave=[];n.forEach(this.performLeave)},performAppear:function(n){this.currentlyTransitioningKeys[n]=!0;var t=this.refs[n];t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,n)):this._handleDoneAppearing(n)},_handleDoneAppearing:function(n){var r=this.refs[n],t;r.componentDidAppear&&r.componentDidAppear();delete this.currentlyTransitioningKeys[n];t=i.getChildMapping(this.props.children);t&&t.hasOwnProperty(n)||this.performLeave(n)},performEnter:function(n){this.currentlyTransitioningKeys[n]=!0;var t=this.refs[n];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,n)):this._handleDoneEntering(n)},_handleDoneEntering:function(n){var r=this.refs[n],t;r.componentDidEnter&&r.componentDidEnter();delete this.currentlyTransitioningKeys[n];t=i.getChildMapping(this.props.children);t&&t.hasOwnProperty(n)||this.performLeave(n)},performLeave:function(n){this.currentlyTransitioningKeys[n]=!0;var t=this.refs[n];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,n)):this._handleDoneLeaving(n)},_handleDoneLeaving:function(n){var f=this.refs[n],t,r;f.componentDidLeave&&f.componentDidLeave();delete this.currentlyTransitioningKeys[n];t=i.getChildMapping(this.props.children);t&&t.hasOwnProperty(n)?this.performEnter(n):(r=u({},this.state.children),delete r[n],this.setState({children:r}))},render:function(){var i=[],n,t;for(n in this.state.children)t=this.state.children[n],t&&i.push(f(this.props.childFactory(t),{ref:n,key:n}));return r.createElement(this.props.component,this.props,i)}});t.exports=o},{"122":122,"129":129,"29":29,"31":31,"96":96}],99:[function(n,t){"use strict";function r(n){n!==f.currentlyMountingInstance&&h.enqueueUpdate(n)}function u(n,t){i(e.current==null,"%s(...): Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state.",t);var r=s.get(n);return r?r===f.currentlyUnmountingInstance?null:r:(!0&&l(!t,"%s(...): Can only update a mounted or mounting component. This usually means you called %s() on an unmounted component. This is a no-op.",t,t),null)}var f=n(74),e=n(45),o=n(63),s=n(73),h=n(100),c=n(29),i=n(150),l=n(171),a={enqueueCallback:function(n,t){i(typeof t=="function","enqueueCallback(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable.");var e=u(n);if(!e||e===f.currentlyMountingInstance)return null;e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t];r(e)},enqueueCallbackInternal:function(n,t){i(typeof t=="function","enqueueCallback(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable.");n._pendingCallbacks?n._pendingCallbacks.push(t):n._pendingCallbacks=[t];r(n)},enqueueForceUpdate:function(n){var t=u(n,"forceUpdate");t&&(t._pendingForceUpdate=!0,r(t))},enqueueReplaceState:function(n,t){var i=u(n,"replaceState");i&&(i._pendingStateQueue=[t],i._pendingReplaceState=!0,r(i))},enqueueSetState:function(n,t){var i=u(n,"setState"),f;i&&(f=i._pendingStateQueue||(i._pendingStateQueue=[]),f.push(t),r(i))},enqueueSetProps:function(n,t){var f=u(n,"setProps"),e,s;f&&(i(f._isTopLevel,"setProps(...): You called `setProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."),e=f._pendingElement||f._currentElement,s=c({},e.props,t),f._pendingElement=o.cloneAndReplaceProps(e,s),r(f))},enqueueReplaceProps:function(n,t){var f=u(n,"replaceProps"),e;f&&(i(f._isTopLevel,"replaceProps(...): You called `replaceProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."),e=f._pendingElement||f._currentElement,f._pendingElement=o.cloneAndReplaceProps(e,t),r(f))},enqueueElementInternal:function(n,t){n._pendingElement=t;r(n)}};t.exports=a},{"100":100,"150":150,"171":171,"29":29,"45":45,"63":63,"73":73,"74":74}],100:[function(n,t){"use strict";function a(){i(f.ReactReconcileTransaction&&u,"ReactUpdates: must inject a reconcile transaction class and batching strategy")}function h(){this.reinitializeTransaction();this.dirtyComponentsLength=null;this.callbackQueue=e.getPooled();this.reconcileTransaction=f.ReactReconcileTransaction.getPooled()}function rt(n,t,i,r,f){a();u.batchedUpdates(n,t,i,r,f)}function ut(n,t){return n._mountOrder-t._mountOrder}function ft(n){var u=n.dirtyComponentsLength,f,t,e,o;for(i(u===r.length,"Expected flush transaction's stored dirty-components length (%s) to match dirty-components array length (%s).",u,r.length),r.sort(ut),f=0;f<u;f++)if(t=r[f],e=t._pendingCallbacks,t._pendingCallbacks=null,k.performUpdateIfNecessary(t,n.reconcileTransaction),e)for(o=0;o<e.length;o++)n.callbackQueue.enqueue(e[o],t.getPublicInstance())}function v(n){if(a(),g(w.current==null,"enqueueUpdate(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate."),!u.isBatchingUpdates){u.batchedUpdates(v,n);return}r.push(n)}function et(n,t){i(u.isBatchingUpdates,"ReactUpdates.asap: Can't enqueue an asap callback in a context whereupdates are not being batched.");c.enqueue(n,t);s=!0}var e=n(7),p=n(30),w=n(45),b=n(82),k=n(89),l=n(116),d=n(29),i=n(150),g=n(171),r=[],c=e.getPooled(),s=!1,u=null,nt={initialize:function(){this.dirtyComponentsLength=r.length},close:function(){this.dirtyComponentsLength!==r.length?(r.splice(0,this.dirtyComponentsLength),o()):r.length=0}},tt={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},it=[nt,tt],o,y,f;d(h.prototype,l.Mixin,{getTransactionWrappers:function(){return it},destructor:function(){this.dirtyComponentsLength=null;e.release(this.callbackQueue);this.callbackQueue=null;f.ReactReconcileTransaction.release(this.reconcileTransaction);this.reconcileTransaction=null},perform:function(n,t,i){return l.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,n,t,i)}});p.addPoolingTo(h);o=function(){for(var n,t;r.length||s;)r.length&&(n=h.getPooled(),n.perform(ft,null,n),h.release(n)),s&&(s=!1,t=c,c=e.getPooled(),t.notifyAll(),e.release(t))};o=b.measure("ReactUpdates","flushBatchedUpdates",o);y={injectReconcileTransaction:function(n){i(n,"ReactUpdates: must provide a reconcile transaction class");f.ReactReconcileTransaction=n},injectBatchingStrategy:function(n){i(n,"ReactUpdates: must provide a batching strategy");i(typeof n.batchedUpdates=="function","ReactUpdates: must provide a batchedUpdates() function");i(typeof n.isBatchingUpdates=="boolean","ReactUpdates: must provide an isBatchingUpdates boolean attribute");u=n}};f={ReactReconcileTransaction:null,batchedUpdates:rt,enqueueUpdate:v,flushBatchedUpdates:o,injection:y,asap:et};t.exports=f},{"116":116,"150":150,"171":171,"29":29,"30":30,"45":45,"7":7,"82":82,"89":89}],101:[function(n,t){"use strict";var r=n(11),i=r.injection.MUST_USE_ATTRIBUTE,u={Properties:{clipPath:i,cx:i,cy:i,d:i,dx:i,dy:i,fill:i,fillOpacity:i,fontFamily:i,fontSize:i,fx:i,fy:i,gradientTransform:i,gradientUnits:i,markerEnd:i,markerMid:i,markerStart:i,offset:i,opacity:i,patternContentUnits:i,patternUnits:i,points:i,preserveAspectRatio:i,r:i,rx:i,ry:i,spreadMethod:i,stopColor:i,stopOpacity:i,stroke:i,strokeDasharray:i,strokeLinecap:i,strokeOpacity:i,strokeWidth:i,textAnchor:i,transform:i,version:i,viewBox:i,x1:i,x2:i,x:i,y1:i,y2:i,y:i},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};t.exports=u},{"11":11}],102:[function(n,t){"use strict";function b(n){var t,i;return"selectionStart"in n&&a.hasSelectionCapabilities(n)?{start:n.selectionStart,end:n.selectionEnd}:window.getSelection?(t=window.getSelection(),{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}):document.selection?(i=document.selection.createRange(),{parentElement:i.parentElement(),text:i.text,top:i.boundingTop,left:i.boundingLeft}):void 0}function h(n){var i,t;return e||r==null||r!==y()?null:(i=b(r),!u||!w(u,i)?(u=i,t=v.getPooled(s.select,f,n),t.type="select",t.target=r,l.accumulateTwoPhaseDispatches(t),t):void 0)}var c=n(16),l=n(21),a=n(71),v=n(108),y=n(136),p=n(153),o=n(157),w=n(166),i=c.topLevelTypes,s={select:{phasedRegistrationNames:{bubbled:o({onSelect:null}),captured:o({onSelectCapture:null})},dependencies:[i.topBlur,i.topContextMenu,i.topFocus,i.topKeyDown,i.topMouseDown,i.topMouseUp,i.topSelectionChange]}},r=null,f=null,u=null,e=!1,k={eventTypes:s,extractEvents:function(n,t,o,s){switch(n){case i.topFocus:(p(t)||t.contentEditable==="true")&&(r=t,f=o,u=null);break;case i.topBlur:r=null;f=null;u=null;break;case i.topMouseDown:e=!0;break;case i.topContextMenu:case i.topMouseUp:return e=!1,h(s);case i.topSelectionChange:case i.topKeyDown:case i.topKeyUp:return h(s)}}};t.exports=k},{"108":108,"136":136,"153":153,"157":157,"16":16,"166":166,"21":21,"71":71}],103:[function(n,t){"use strict";var i=Math.pow(2,53),r={createReactRootIndex:function(){return Math.ceil(Math.random()*i)}};t.exports=r},{}],104:[function(n,t){"use strict";var h=n(16),c=n(20),l=n(21),a=n(105),v=n(108),y=n(109),p=n(111),w=n(112),b=n(107),k=n(113),d=n(114),g=n(115),nt=n(137),o=n(150),i=n(157),tt=n(171),u=h.topLevelTypes,r={blur:{phasedRegistrationNames:{bubbled:i({onBlur:!0}),captured:i({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:i({onClick:!0}),captured:i({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:i({onContextMenu:!0}),captured:i({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:i({onCopy:!0}),captured:i({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:i({onCut:!0}),captured:i({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:i({onDoubleClick:!0}),captured:i({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:i({onDrag:!0}),captured:i({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:i({onDragEnd:!0}),captured:i({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:i({onDragEnter:!0}),captured:i({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:i({onDragExit:!0}),captured:i({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:i({onDragLeave:!0}),captured:i({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:i({onDragOver:!0}),captured:i({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:i({onDragStart:!0}),captured:i({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:i({onDrop:!0}),captured:i({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:i({onFocus:!0}),captured:i({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:i({onInput:!0}),captured:i({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:i({onKeyDown:!0}),captured:i({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:i({onKeyPress:!0}),captured:i({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:i({onKeyUp:!0}),captured:i({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:i({onLoad:!0}),captured:i({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:i({onError:!0}),captured:i({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:i({onMouseDown:!0}),captured:i({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:i({onMouseMove:!0}),captured:i({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:i({onMouseOut:!0}),captured:i({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:i({onMouseOver:!0}),captured:i({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:i({onMouseUp:!0}),captured:i({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:i({onPaste:!0}),captured:i({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:i({onReset:!0}),captured:i({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:i({onScroll:!0}),captured:i({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:i({onSubmit:!0}),captured:i({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:i({onTouchCancel:!0}),captured:i({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:i({onTouchEnd:!0}),captured:i({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:i({onTouchMove:!0}),captured:i({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:i({onTouchStart:!0}),captured:i({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:i({onWheel:!0}),captured:i({onWheelCapture:!0})}}},f={topBlur:r.blur,topClick:r.click,topContextMenu:r.contextMenu,topCopy:r.copy,topCut:r.cut,topDoubleClick:r.doubleClick,topDrag:r.drag,topDragEnd:r.dragEnd,topDragEnter:r.dragEnter,topDragExit:r.dragExit,topDragLeave:r.dragLeave,topDragOver:r.dragOver,topDragStart:r.dragStart,topDrop:r.drop,topError:r.error,topFocus:r.focus,topInput:r.input,topKeyDown:r.keyDown,topKeyPress:r.keyPress,topKeyUp:r.keyUp,topLoad:r.load,topMouseDown:r.mouseDown,topMouseMove:r.mouseMove,topMouseOut:r.mouseOut,topMouseOver:r.mouseOver,topMouseUp:r.mouseUp,topPaste:r.paste,topReset:r.reset,topScroll:r.scroll,topSubmit:r.submit,topTouchCancel:r.touchCancel,topTouchEnd:r.touchEnd,topTouchMove:r.touchMove,topTouchStart:r.touchStart,topWheel:r.wheel},e,s;for(e in f)f[e].dependencies=[e];s={eventTypes:r,executeDispatch:function(n,t,i){var r=c.executeDispatch(n,t,i);tt(typeof r!="boolean","Returning `false` from an event handler is deprecated and will be ignored in a future release. Instead, manually call e.stopPropagation() or e.preventDefault(), as appropriate.");r===!1&&(n.stopPropagation(),n.preventDefault())},extractEvents:function(n,t,i,r){var h=f[n],e,s;if(!h)return null;switch(n){case u.topInput:case u.topLoad:case u.topError:case u.topReset:case u.topSubmit:e=v;break;case u.topKeyPress:if(nt(r)===0)return null;case u.topKeyDown:case u.topKeyUp:e=p;break;case u.topBlur:case u.topFocus:e=y;break;case u.topClick:if(r.button===2)return null;case u.topContextMenu:case u.topDoubleClick:case u.topMouseDown:case u.topMouseMove:case u.topMouseOut:case u.topMouseOver:case u.topMouseUp:e=w;break;case u.topDrag:case u.topDragEnd:case u.topDragEnter:case u.topDragExit:case u.topDragLeave:case u.topDragOver:case u.topDragStart:case u.topDrop:e=b;break;case u.topTouchCancel:case u.topTouchEnd:case u.topTouchMove:case u.topTouchStart:e=k;break;case u.topScroll:e=d;break;case u.topWheel:e=g;break;case u.topCopy:case u.topCut:case u.topPaste:e=a}return o(e,"SimpleEventPlugin: Unhandled event type, `%s`.",n),s=e.getPooled(h,i,r),l.accumulateTwoPhaseDispatches(s),s}};t.exports=s},{"105":105,"107":107,"108":108,"109":109,"111":111,"112":112,"113":113,"114":114,"115":115,"137":137,"150":150,"157":157,"16":16,"171":171,"20":20,"21":21}],105:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(108),u={clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}};i.augmentClass(r,u);t.exports=r},{"108":108}],106:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(108);i.augmentClass(r,{data:null});t.exports=r},{"108":108}],107:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(112);i.augmentClass(r,{dataTransfer:null});t.exports=r},{"112":112}],108:[function(n,t){"use strict";function r(n,t,r){var f,u,e,o;this.dispatchConfig=n;this.dispatchMarker=t;this.nativeEvent=r;f=this.constructor.Interface;for(u in f)f.hasOwnProperty(u)&&(e=f[u],this[u]=e?e(r):r[u]);o=r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1;this.isDefaultPrevented=o?i.thatReturnsTrue:i.thatReturnsFalse;this.isPropagationStopped=i.thatReturnsFalse}var u=n(30),f=n(29),i=n(129),e=n(140),o={type:null,target:e,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};f(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n.preventDefault?n.preventDefault():n.returnValue=!1;this.isDefaultPrevented=i.thatReturnsTrue},stopPropagation:function(){var n=this.nativeEvent;n.stopPropagation?n.stopPropagation():n.cancelBubble=!0;this.isPropagationStopped=i.thatReturnsTrue},persist:function(){this.isPersistent=i.thatReturnsTrue},isPersistent:i.thatReturnsFalse,destructor:function(){var n=this.constructor.Interface;for(var t in n)this[t]=null;this.dispatchConfig=null;this.dispatchMarker=null;this.nativeEvent=null}});r.Interface=o;r.augmentClass=function(n,t){var i=this,r=Object.create(i.prototype);f(r,n.prototype);n.prototype=r;n.prototype.constructor=n;n.Interface=f({},i.Interface,t);n.augmentClass=i.augmentClass;u.addPoolingTo(n,u.threeArgumentPooler)};u.addPoolingTo(r,u.threeArgumentPooler);t.exports=r},{"129":129,"140":140,"29":29,"30":30}],109:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(114);i.augmentClass(r,{relatedTarget:null});t.exports=r},{"114":114}],110:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(108);i.augmentClass(r,{data:null});t.exports=r},{"108":108}],111:[function(n,t){"use strict";function u(n,t,r){i.call(this,n,t,r)}var i=n(114),r=n(137),f=n(138),e=n(139),o={key:f,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:e,charCode:function(n){return n.type==="keypress"?r(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?r(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}};i.augmentClass(u,o);t.exports=u},{"114":114,"137":137,"138":138,"139":139}],112:[function(n,t){"use strict";function u(n,t,r){i.call(this,n,t,r)}var i=n(114),r=n(117),f=n(139),e={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:f,button:function(n){var t=n.button;return"which"in n?t:t===2?2:t===4?1:0},buttons:null,relatedTarget:function(n){return n.relatedTarget||(n.fromElement===n.srcElement?n.toElement:n.fromElement)},pageX:function(n){return"pageX"in n?n.pageX:n.clientX+r.currentScrollLeft},pageY:function(n){return"pageY"in n?n.pageY:n.clientY+r.currentScrollTop}};i.augmentClass(u,e);t.exports=u},{"114":114,"117":117,"139":139}],113:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(114),u=n(139),f={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:u};i.augmentClass(r,f);t.exports=r},{"114":114,"139":139}],114:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(108),u=n(140),f={view:function(n){var t,i;return n.view?n.view:(t=u(n),t!=null&&t.window===t)?t:(i=t.ownerDocument,i?i.defaultView||i.parentWindow:window)},detail:function(n){return n.detail||0}};i.augmentClass(r,f);t.exports=r},{"108":108,"140":140}],115:[function(n,t){"use strict";function r(n,t,r){i.call(this,n,t,r)}var i=n(112),u={deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:null,deltaMode:null};i.augmentClass(r,u);t.exports=r},{"112":112}],116:[function(n,t){"use strict";var i=n(150),u={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers();this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[];this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(n,t,r,u,f,e,o,s){i(!this.isInTransaction(),"Transaction.perform(...): Cannot initialize a transaction when there is already an outstanding transaction.");var h,c;try{this._isInTransaction=!0;h=!0;this.initializeAll(0);c=n.call(t,r,u,f,e,o,s);h=!1}finally{try{if(h)try{this.closeAll(0)}catch(l){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return c},initializeAll:function(n){for(var i,u=this.transactionWrappers,t=n;t<u.length;t++){i=u[t];try{this.wrapperInitData[t]=r.OBSERVED_ERROR;this.wrapperInitData[t]=i.initialize?i.initialize.call(this):null}finally{if(this.wrapperInitData[t]===r.OBSERVED_ERROR)try{this.initializeAll(t+1)}catch(f){}}}},closeAll:function(n){var u,t,f,e,o;for(i(this.isInTransaction(),"Transaction.closeAll(): Cannot close transaction when none are open."),u=this.transactionWrappers,t=n;t<u.length;t++){f=u[t];e=this.wrapperInitData[t];try{o=!0;e!==r.OBSERVED_ERROR&&f.close&&f.close.call(this,e);o=!1}finally{if(o)try{this.closeAll(t+1)}catch(s){}}}this.wrapperInitData.length=0}},r={Mixin:u,OBSERVED_ERROR:{}};t.exports=r},{"150":150}],117:[function(n,t){"use strict";var i={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(n){i.currentScrollLeft=n.x;i.currentScrollTop=n.y}};t.exports=i},{}],118:[function(n,t){"use strict";function r(n,t){if(i(t!=null,"accumulateInto(...): Accumulated items must not be null or undefined."),n==null)return t;var r=Array.isArray(n),u=Array.isArray(t);return r&&u?(n.push.apply(n,t),n):r?(n.push(t),n):u?[n].concat(t):[n,t]}var i=n(150);t.exports=r},{"150":150}],119:[function(n,t){"use strict";function r(n){for(var t=1,r=0,u=0;u<n.length;u++)t=(t+n.charCodeAt(u))%i,r=(r+t)%i;return t|r<<16}var i=65521;t.exports=r},{}],120:[function(n,t){function r(n){return n.replace(i,function(n,t){return t.toUpperCase()})}var i=/-(.)/g;t.exports=r},{}],121:[function(n,t){"use strict";function u(n){return i(n.replace(r,"ms-"))}var i=n(120),r=/^-ms-/;t.exports=u},{"120":120}],122:[function(n,t){"use strict";function o(n,t){!0&&e(!n.ref,"You are calling cloneWithProps() on a child with a ref. This is dangerous because you're creating a new child which will not be added as a ref to its parent.");var f=u.mergeProps(t,n.props);return!f.hasOwnProperty(i)&&n.props.hasOwnProperty(i)&&(f.children=n.props.children),r.createElement(n.type,f)}var r=n(63),u=n(83),f=n(157),e=n(171),i=f({children:null});t.exports=o},{"157":157,"171":171,"63":63,"83":83}],123:[function(n,t){function r(n,t){return n&&t?n===t?!0:i(n)?!1:i(t)?r(n,t.parentNode):n.contains?n.contains(t):n.compareDocumentPosition?!!(n.compareDocumentPosition(t)&16):!1:!1}var i=n(154);t.exports=r},{"154":154}],124:[function(n,t){function r(n){return!!n&&(typeof n=="object"||typeof n=="function")&&"length"in n&&!("setInterval"in n)&&typeof n.nodeType!="number"&&(Array.isArray(n)||"callee"in n||"item"in n)}function u(n){return r(n)?Array.isArray(n)?n.slice():i(n):[n]}var i=n(168);t.exports=u},{"168":168}],125:[function(n,t){"use strict";function f(n){var t=u.createFactory(n);return r.createClass({tagName:n.toUpperCase(),displayName:"ReactFullPageComponent"+n,componentWillUnmount:function(){i(!1,"%s tried to unmount. Because of cross-browser quirks it is impossible to unmount some top-level components (eg <html>, <head>, and <body>) reliably and efficiently. To fix this, have a single top-level component that never unmounts render these elements.",this.constructor.displayName)},render:function(){return t(this.props)}})}var r=n(38),u=n(63),i=n(150);t.exports=f},{"150":150,"38":38,"63":63}],126:[function(n,t){function s(n){var t=n.match(o);return t&&t[1].toLowerCase()}function h(n,t){var f=r,h,o,l,c,a;if(i(!!r,"createNodesFromMarkup dummy not initialized"),h=s(n),o=h&&e(h),o)for(f.innerHTML=o[1]+n+o[2],l=o[0];l--;)f=f.lastChild;else f.innerHTML=n;for(c=f.getElementsByTagName("script"),c.length&&(i(t,"createNodesFromMarkup(...): Unexpected <script> element rendered."),u(c).forEach(t)),a=u(f.childNodes);f.lastChild;)f.removeChild(f.lastChild);return a}var f=n(22),u=n(124),e=n(142),i=n(150),r=f.canUseDOM?document.createElement("div"):null,o=/^\s*<(\w+)/;t.exports=h},{"124":124,"142":142,"150":150,"22":22}],127:[function(n,t){"use strict";function u(n){return!0&&(r(i,"React.addons.classSet will be deprecated in a future version. See http://fb.me/react-addons-classset"),i=!0),typeof n=="object"?Object.keys(n).filter(function(t){return n[t]}).join(" "):Array.prototype.join.call(arguments," ")}var r=n(171),i=!1;t.exports=u},{"171":171}],128:[function(n,t){"use strict";function u(n,t){var u=t==null||typeof t=="boolean"||t==="",r;return u?"":(r=isNaN(t),r||t===0||i.hasOwnProperty(n)&&i[n])?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}var r=n(5),i=r.isUnitlessNumber;t.exports=u},{"5":5}],129:[function(n,t){function r(n){return function(){return n}}function i(){}i.thatReturns=r;i.thatReturnsFalse=r(!1);i.thatReturnsTrue=r(!0);i.thatReturnsNull=r(null);i.thatReturnsThis=function(){return this};i.thatReturnsArgument=function(n){return n};t.exports=i},{}],130:[function(n,t){"use strict";var i={};!0&&Object.freeze(i);t.exports=i},{}],131:[function(n,t){"use strict";function u(n){return i[n]}function f(n){return(""+n).replace(r,u)}var i={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},r=/[&><"']/g;t.exports=f},{}],132:[function(n,t){"use strict";function s(n){if(1){var t=r.current;t!==null&&(o(t._warnedAboutRefsInRender,"%s is accessing getDOMNode or findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",t.getName()||"A component"),t._warnedAboutRefsInRender=!0)}if(n==null)return null;if(e(n))return n;if(u.has(n))return f.getNodeFromInstance(n);i(n.render==null||typeof n.render!="function","Component (with keys: %s) contains `render` method but is not mounted in the DOM",Object.keys(n));i(!1,"Element appears to be neither ReactComponent nor DOMNode (keys: %s)",Object.keys(n))}var r=n(45),u=n(73),f=n(77),i=n(150),e=n(152),o=n(171);t.exports=s},{"150":150,"152":152,"171":171,"45":45,"73":73,"77":77}],133:[function(n,t){"use strict";function u(n,t,i){var u=n,f=!u.hasOwnProperty(i);!0&&r(f,"flattenChildren(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",i);f&&t!=null&&(u[i]=t)}function f(n){if(n==null)return n;var t={};return i(n,u,t),t}var i=n(169),r=n(171);t.exports=f},{"169":169,"171":171}],134:[function(n,t){"use strict";function i(n){try{n.focus()}catch(t){}}t.exports=i},{}],135:[function(n,t){"use strict";var i=function(n,t,i){Array.isArray(n)?n.forEach(t,i):n&&t.call(i,n)};t.exports=i},{}],136:[function(n,t){function i(){try{return document.activeElement||document.body}catch(n){return document.body}}t.exports=i},{}],137:[function(n,t){"use strict";function i(n){var t,i=n.keyCode;return("charCode"in n?(t=n.charCode,t===0&&i===13&&(t=13)):t=i,t>=32||t===13)?t:0}t.exports=i},{}],138:[function(n,t){"use strict";function f(n){var t,f;return n.key&&(t=r[n.key]||n.key,t!=="Unidentified")?t:n.type==="keypress"?(f=i(n),f===13?"Enter":String.fromCharCode(f)):n.type==="keydown"||n.type==="keyup"?u[n.keyCode]||"Unidentified":""}var i=n(137),r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},u={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=f},{"137":137}],139:[function(n,t){"use strict";function r(n){var u=this,t=u.nativeEvent,r;return t.getModifierState?t.getModifierState(n):(r=i[n],r?!!t[r]:!1)}function u(){return r}var i={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=u},{}],140:[function(n,t){"use strict";function i(n){var t=n.target||n.srcElement||window;return t.nodeType===3?t.parentNode:t}t.exports=i},{}],141:[function(n,t){"use strict";function u(n){var t=n&&(i&&n[i]||n[r]);if(typeof t=="function")return t}var i=typeof Symbol=="function"&&Symbol.iterator,r="@@iterator";t.exports=u},{}],142:[function(n,t){function l(n){return e(!!r,"Markup wrapping node not initialized"),h.hasOwnProperty(n)||(n="*"),f.hasOwnProperty(n)||(r.innerHTML=n==="*"?"<link />":"<"+n+"><\/"+n+">",f[n]=!r.firstChild),f[n]?h[n]:null}var c=n(22),e=n(150),r=c.canUseDOM?document.createElement("div"):null,f={circle:!0,clipPath:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},o=[1,'<select multiple="true">',"<\/select>"],u=[1,"<table>","<\/table>"],s=[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],i=[1,"<svg>","<\/svg>"],h={"*":[1,"?<div>","<\/div>"],area:[1,"<map>","<\/map>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],legend:[1,"<fieldset>","<\/fieldset>"],param:[1,"<object>","<\/object>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],optgroup:o,option:o,caption:u,colgroup:u,tbody:u,tfoot:u,thead:u,td:s,th:s,circle:i,clipPath:i,defs:i,ellipse:i,g:i,line:i,linearGradient:i,path:i,polygon:i,polyline:i,radialGradient:i,rect:i,stop:i,text:i};t.exports=l},{"150":150,"22":22}],143:[function(n,t){"use strict";function i(n){while(n&&n.firstChild)n=n.firstChild;return n}function r(n){while(n){if(n.nextSibling)return n.nextSibling;n=n.parentNode}}function u(n,t){for(var u=i(n),f=0,e=0;u;){if(u.nodeType===3){if(e=f+u.textContent.length,f<=t&&e>=t)return{node:u,offset:t-f};f=e}u=i(r(u))}}t.exports=u},{}],144:[function(n,t){"use strict";function r(n){return n?n.nodeType===i?n.documentElement:n.firstChild:null}var i=9;t.exports=r},{}],145:[function(n,t){"use strict";function u(){return!i&&r.canUseDOM&&(i="textContent"in document.documentElement?"textContent":"innerText"),i}var r=n(22),i=null;t.exports=u},{"22":22}],146:[function(n,t){"use strict";function i(n){return n===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:n.scrollLeft,y:n.scrollTop}}t.exports=i},{}],147:[function(n,t){function r(n){return n.replace(i,"-$1").toLowerCase()}var i=/([A-Z])/g;t.exports=r},{}],148:[function(n,t){"use strict";function u(n){return i(n).replace(r,"-ms-")}var i=n(147),r=/^ms-/;t.exports=u},{"147":147}],149:[function(n,t){"use strict";function c(n){return typeof n=="function"&&typeof n.prototype!="undefined"&&typeof n.prototype.mountComponent=="function"&&typeof n.prototype.receiveComponent=="function"}function e(n,t){var e,o;return(n===null||n===!1)&&(n=s.emptyElement),typeof n=="object"?(o=n,!0&&u(o&&(typeof o.type=="function"||typeof o.type=="string"),"Only functions or strings can be mounted as React components."),e=t===o.type&&typeof o.type=="string"?i.createInternalComponent(o):c(o.type)?new o.type(o):new f):typeof n=="string"||typeof n=="number"?e=i.createInstanceForText(n):r(!1,"Encountered invalid React node of type %s",typeof n),!0&&u(typeof e.construct=="function"&&typeof e.mountComponent=="function"&&typeof e.receiveComponent=="function"&&typeof e.unmountComponent=="function","Only React Components can be mounted."),e.construct(n),e._mountIndex=0,e._mountImage=null,!0&&(e._isOwnerNecessary=!1,e._warnedAboutRefsInRender=!1),!0&&Object.preventExtensions&&Object.preventExtensions(e),e}var o=n(43),s=n(65),i=n(80),h=n(29),r=n(150),u=n(171),f=function(){};h(f.prototype,o.Mixin,{_instantiateReactComponent:e});t.exports=e},{"150":150,"171":171,"29":29,"43":43,"65":65,"80":80}],150:[function(n,t){"use strict";var i=function(n,t,i,r,u,f,e,o){var s,h,c;if(!0&&t===undefined)throw new Error("invariant requires an error message argument");if(!n){t===undefined?s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings."):(h=[i,r,u,f,e,o],c=0,s=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return h[c++]})));s.framesToPop=1;throw s;}};t.exports=i},{}],151:[function(n,t){"use strict";function u(n,t){var f,u,e;return!i.canUseDOM||t&&!("addEventListener"in document)?!1:(f="on"+n,u=f in document,u||(e=document.createElement("div"),e.setAttribute(f,"return;"),u=typeof e[f]=="function"),!u&&r&&n==="wheel"&&(u=document.implementation.hasFeature("Events.wheel","3.0")),u)}var i=n(22),r;i.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);
/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */
t.exports=u},{"22":22}],152:[function(n,t){function i(n){return!!(n&&(typeof Node=="function"?n instanceof Node:typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.nodeName=="string"))}t.exports=i},{}],153:[function(n,t){"use strict";function r(n){return n&&(n.nodeName==="INPUT"&&i[n.type]||n.nodeName==="TEXTAREA")}var i={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=r},{}],154:[function(n,t){function r(n){return i(n)&&n.nodeType==3}var i=n(152);t.exports=r},{"152":152}],155:[function(n,t){"use strict";function i(n){var i,r,t;if(n||(n=""),r=arguments.length,r>1)for(t=1;t<r;t++)i=arguments[t],i&&(n=(n?n+" ":"")+i);return n}t.exports=i},{}],156:[function(n,t){"use strict";var i=n(150),r=function(n){var r={},t;i(n instanceof Object&&!Array.isArray(n),"keyMirror(...): Argument must be an object.");for(t in n)n.hasOwnProperty(t)&&(r[t]=t);return r};t.exports=r},{"150":150}],157:[function(n,t){var i=function(n){for(var t in n)if(n.hasOwnProperty(t))return t;return null};t.exports=i},{}],158:[function(n,t){"use strict";function r(n,t,r){var f,u;if(!n)return null;f={};for(u in n)i.call(n,u)&&(f[u]=t.call(r,n[u],u,n));return f}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],159:[function(n,t){"use strict";function i(n){var t={};return function(i){return t.hasOwnProperty(i)||(t[i]=n.call(this,i)),t[i]}}t.exports=i},{}],160:[function(n,t){"use strict";function u(n){return r(i.isValidElement(n),"onlyChild must be passed a children with exactly one child."),n}var i=n(63),r=n(150);t.exports=u},{"150":150,"63":63}],161:[function(n,t){"use strict";var r=n(22),i;r.canUseDOM&&(i=window.performance||window.msPerformance||window.webkitPerformance);t.exports=i||{}},{"22":22}],162:[function(n,t){var i=n(161),r;i&&i.now||(i=Date);r=i.now.bind(i);t.exports=r},{"161":161}],163:[function(n,t){"use strict";function r(n){return'"'+i(n)+'"'}var i=n(131);t.exports=r},{"131":131}],164:[function(n,t){"use strict";var u=n(22),f=/^[ \r\n\t\f]/,e=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,i=function(n,t){n.innerHTML=t},r;typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction&&(i=function(n,t){MSApp.execUnsafeLocalFunction(function(){n.innerHTML=t})});u.canUseDOM&&(r=document.createElement("div"),r.innerHTML=" ",r.innerHTML===""&&(i=function(n,t){if(n.parentNode&&n.parentNode.replaceChild(n,n),f.test(t)||t[0]==="<"&&e.test(t)){n.innerHTML="﻿"+t;var i=n.firstChild;i.data.length===1?n.removeChild(i):i.deleteData(0,1)}else n.innerHTML=t}));t.exports=i},{"22":22}],165:[function(n,t){"use strict";var r=n(22),u=n(131),f=n(164),i=function(n,t){n.textContent=t};r.canUseDOM&&("textContent"in document.documentElement||(i=function(n,t){f(n,u(t))}));t.exports=i},{"131":131,"164":164,"22":22}],166:[function(n,t){"use strict";function i(n,t){if(n===t)return!0;for(var i in n)if(n.hasOwnProperty(i)&&(!t.hasOwnProperty(i)||n[i]!==t[i]))return!1;for(i in t)if(t.hasOwnProperty(i)&&!n.hasOwnProperty(i))return!1;return!0}t.exports=i},{}],167:[function(n,t){"use strict";function r(n,t){var u,r;if(n!=null&&t!=null){if(u=typeof n,r=typeof t,u==="string"||u==="number")return r==="string"||r==="number";if(r==="object"&&n.type===t.type&&n.key===t.key){var e=n._owner===t._owner,o=null,s=null,f=null;return!0&&(e||(n._owner!=null&&n._owner.getPublicInstance()!=null&&n._owner.getPublicInstance().constructor!=null&&(o=n._owner.getPublicInstance().constructor.displayName),t._owner!=null&&t._owner.getPublicInstance()!=null&&t._owner.getPublicInstance().constructor!=null&&(s=t._owner.getPublicInstance().constructor.displayName),t.type!=null&&t.type.displayName!=null&&(f=t.type.displayName),t.type!=null&&typeof t.type=="string"&&(f=t.type),(typeof t.type!="string"||t.type==="input"||t.type==="textarea")&&(n._owner!=null&&n._owner._isOwnerNecessary===!1||t._owner!=null&&t._owner._isOwnerNecessary===!1)&&(n._owner!=null&&(n._owner._isOwnerNecessary=!0),t._owner!=null&&(t._owner._isOwnerNecessary=!0),i(!1,"<%s /> is being rendered by both %s and %s using the same key (%s) in the same place. Currently, this means that they don't preserve state. This behavior should be very rare so we're considering deprecating it. Please contact the React team and explain your use case so that we can take that into consideration.",f||"Unknown Component",o||"[Unknown]",s||"[Unknown]",n.key)))),e}}return!1}var i=n(171);t.exports=r},{"171":171}],168:[function(n,t){function r(n){var t=n.length,u,r;if(i(!Array.isArray(n)&&(typeof n=="object"||typeof n=="function"),"toArray: Array-like object expected"),i(typeof t=="number","toArray: Object needs a length property"),i(t===0||t-1 in n,"toArray: Object should have keys for indices"),n.hasOwnProperty)try{return Array.prototype.slice.call(n)}catch(f){}for(u=Array(t),r=0;r<t;r++)u[r]=n[r];return u}var i=n(150);t.exports=r},{"150":150}],169:[function(n,t){"use strict";function w(n){return y[n]}function u(n,t){return n&&n.key!=null?e(n.key):t.toString(36)}function b(n){return(""+n).replace(p,w)}function e(n){return"$"+b(n)}function f(n,t,l,y,p){var g=typeof n,w,k,d,b,nt,tt,et,it,ot,rt,ut,ft;if((g==="undefined"||g==="boolean")&&(n=null),n===null||g==="string"||g==="number"||h.isValidElement(n))return y(p,n,t===""?r+u(n,0):t,l),1;if(b=0,Array.isArray(n))for(nt=0;nt<n.length;nt++)w=n[nt],k=(t!==""?t+i:r)+u(w,nt),d=l+b,b+=f(w,k,d,y,p);else if(tt=a(n),tt)if(et=tt.call(n),tt!==n.entries)for(ot=0;!(it=et.next()).done;)w=it.value,k=(t!==""?t+i:r)+u(w,ot++),d=l+b,b+=f(w,k,d,y,p);else for(!0&&(v(s,"Using Maps as children is not yet fully supported. It is an experimental feature that might be removed. Convert it to a sequence / iterable of keyed ReactElements instead."),s=!0);!(it=et.next()).done;)rt=it.value,rt&&(w=rt[1],k=(t!==""?t+i:r)+e(rt[0])+i+u(w,0),d=l+b,b+=f(w,k,d,y,p));else if(g==="object"){o(n.nodeType!==1,"traverseAllChildren(...): Encountered an invalid child; DOM elements are not valid children of React components.");ut=c.extract(n);for(ft in ut)ut.hasOwnProperty(ft)&&(w=ut[ft],k=(t!==""?t+i:r)+e(ft)+i+u(w,0),d=l+b,b+=f(w,k,d,y,p))}return b}function k(n,t,i){return n==null?0:f(n,"",0,t,i)}var h=n(63),c=n(69),l=n(72),a=n(141),o=n(150),v=n(171),r=l.SEPARATOR,i=":",y={"=":"=0",".":"=1",":":"=2"},p=/[=.:]/g,s=!1;t.exports=k},{"141":141,"150":150,"171":171,"63":63,"69":69,"72":72}],170:[function(n,t){"use strict";function w(n){return Array.isArray(n)?n.concat():n&&typeof n=="object"?a(new n.constructor,n):n}function y(n,t,r){i(Array.isArray(n),"update(): expected target of %s to be an array; got %s.",r,n);var u=t[r];i(Array.isArray(u),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",r,u)}function p(n,t){var f,b,k;if(i(typeof t=="object","update(): You provided a key path to update() that did not contain one of %s. Did you forget to include {%s: ...}?",v.join(", "),s),e.call(t,s))return i(Object.keys(t).length===1,"Cannot have more than one key in an object with %s",s),t[s];f=w(n);e.call(t,o)&&(b=t[o],i(b&&typeof b=="object","update(): %s expects a spec of type 'object'; got %s",o,b),i(f&&typeof f=="object","update(): %s expects a target of type 'object'; got %s",o,f),a(f,t[o]));e.call(t,h)&&(y(n,t,h),t[h].forEach(function(n){f.push(n)}));e.call(t,c)&&(y(n,t,c),t[c].forEach(function(n){f.unshift(n)}));e.call(t,r)&&(i(Array.isArray(n),"Expected %s target to be an array; got %s",r,n),i(Array.isArray(t[r]),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",r,t[r]),t[r].forEach(function(n){i(Array.isArray(n),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",r,t[r]);f.splice.apply(f,n)}));e.call(t,u)&&(i(typeof t[u]=="function","update(): expected spec of %s to be a function; got %s.",u,t[u]),f=t[u](f));for(k in t)l.hasOwnProperty(k)&&l[k]||(f[k]=p(n[k],t[k]));return f}var a=n(29),f=n(157),i=n(150),e={}.hasOwnProperty,h=f({$push:null}),c=f({$unshift:null}),r=f({$splice:null}),s=f({$set:null}),o=f({$merge:null}),u=f({$apply:null}),v=[h,c,r,s,o,u],l={};v.forEach(function(n){l[n]=!0});t.exports=p},{"150":150,"157":157,"29":29}],171:[function(n,t){"use strict";var r=n(129),i=r;!0&&(i=function(n,t){for(var f,r,u=[],i=2,e=arguments.length;i<e;i++)u.push(arguments[i]);if(t===undefined)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(t.length<10||/^[s\W]*$/.test(t))throw new Error("The warning format should be able to uniquely identify this warning. Please, use a more descriptive format than: "+t);if(t.indexOf("Failed Composite propType: ")!==0&&!n){f=0;r="Warning: "+t.replace(/%s/g,function(){return u[f++]});console.warn(r);try{throw new Error(r);}catch(o){}}});t.exports=i},{"129":129}]},{},[1])(1)}),function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.JSXTransformer=n()}}(function(){var n;return function t(n,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!n[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};n[f][0].call(s.exports,function(t){var i=n[f][1][t];return u(i?i:t)},s,s.exports,t,n,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){"use strict";function transformReact(n,t){return t=t||{},t.sourceMap&&(t.sourceMap=s),e.transformWithDetails(n,t)}function h(source,options){return eval(transformReact(source,options).code)}function c(n,t){var e=n.split("\n"),i,f,u,r,o;return!t.lineNumber||t.lineNumber>e.length?"":(i=e[t.lineNumber-1],f=0,i=i.replace(/^\s+/,function(n){return f=n.length,""}),u=30,r=t.column-f,r>u&&(i="... "+i.slice(r-u),r=4+u),i.length-r>u&&(i=i.slice(0,r+u)+" ..."),o="\n\n"+i+"\n",o+(new Array(r-1).join(" ")+"^"))}function l(n,t,u){var e,s;try{e=transformReact(n,u)}catch(f){f.message+="\n    at ";t?("fileName"in f&&(f.fileName=t),f.message+=t+":"+f.lineNumber+":"+f.columnNumber):f.message+=location.href;f.message+=c(n,f);throw f;}return e.sourceMap?(t==null?(s="Inline JSX script",r++,r>1&&(s+=" ("+r+")")):i&&(i.href=t,s=i.pathname.substr(1)),e.code+"\n"+o(e.sourceMap,n,s)):e.code}function a(n,t,i){var r=document.createElement("script");r.text=l(n,t,i);u.appendChild(r)}function v(n,t,i){var r;return r=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,r.open("GET",n,!0),"overrideMimeType"in r&&r.overrideMimeType("text/plain"),r.onreadystatechange=function(){if(r.readyState===4)if(r.status===0||r.status===200)t(r.responseText);else{i();throw new Error("Could not load "+n);}},r.send(null)}function y(n){function i(){for(var n,i=0;i<r;i++)if(n=t[i],n.loaded&&!n.executed)n.executed=!0,a(n.content,n.url,n.options);else if(!n.loaded&&!n.error&&!n.async)break}var t=[],r=n.length;n.forEach(function(n,r){var u={sourceMap:!0},f;/;harmony=true(;|$)/.test(n.type)&&(u.harmony=!0);/;stripTypes=true(;|$)/.test(n.type)&&(u.stripTypes=!0);f=n.hasAttribute("async");n.src?(t[r]={async:f,error:!1,executed:!1,content:null,loaded:!1,url:n.src,options:u},v(n.src,function(n){t[r].loaded=!0;t[r].content=n;i()},function(){t[r].error=!0;i()})):t[r]={async:f,error:!1,executed:!1,content:n.innerHTML,loaded:!0,url:null,options:u}});i()}function f(){for(var t=document.getElementsByTagName("script"),i=[],n=0;n<t.length;n++)/^text\/jsx(;|$)/.test(t.item(n).type)&&i.push(t.item(n));i.length<1||(console.warn("You are using the in-browser JSX transformer. Be sure to precompile your JSX for production - http://facebook.github.io/react/docs/tooling-integration.html#jsx"),y(i))}var e=n("../main"),o=n("./inline-source-map"),u,i,r=0,s=Object.prototype.hasOwnProperty("__defineGetter__");typeof window!="undefined"&&window!==null&&(u=document.getElementsByTagName("head")[0],i=document.createElement("a"),window.addEventListener?window.addEventListener("DOMContentLoaded",f,!1):window.attachEvent("onload",f));t.exports={transform:transformReact,exec:h}},{"../main":2,"./inline-source-map":41}],2:[function(n,t){"use strict";function r(n){n=n||{};var t={};return t.harmony=n.harmony,t.stripTypes=n.stripTypes,t.sourceMap=n.sourceMap,t.filename=n.sourceFilename,n.es6module&&(t.sourceType="module"),n.nonStrictEs6module&&(t.sourceType="nonStrictModule"),t.es3=n.target==="es3",t.es5=!t.es3,t}function u(n,t){var r=["react"],u;return t.harmony&&r.push("harmony"),t.es3&&r.push("es3"),t.stripTypes&&(n=i(e.visitorList,n,t).code),u=f.getVisitorsBySet(r),i(u,n,t)}var f=n("./vendor/fbtransform/visitors"),i=n("jstransform").transform,e=n("jstransform/visitors/type-syntax"),o=n("./vendor/inline-source-map");t.exports={transform:function(n,t){var i,f,e;return t=r(t),i=u(n,t),f=i.code,t.sourceMap&&(e=o(i.sourceMap,n,t.filename),f+="\n"+e),f},transformWithDetails:function(n,t){t=r(t);var f=u(n,t),i={};return i.code=f.code,t.sourceMap&&(i.sourceMap=f.sourceMap.toJSON()),t.filename&&(i.sourceMap.sources=[t.filename]),i}}},{"./vendor/fbtransform/visitors":40,"./vendor/inline-source-map":41,jstransform:22,"jstransform/visitors/type-syntax":36}],3:[function(n,t,i){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(n,t){var f=this,e,i,u;if(!(f instanceof r))return new r(n,t);if(e=typeof n,e==="number")i=+n;else if(e==="string")i=r.byteLength(n,t);else if(e==="object"&&n!==null)n.type==="Buffer"&&a(n.data)&&(n=n.data),i=+n.length;else throw new TypeError("must start with number, buffer, array or string");if(i>v)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+v.toString(16)+" bytes");if(i<0?i=0:i>>>=0,r.TYPED_ARRAY_SUPPORT?f=r._augment(new Uint8Array(i)):(f.length=i,f._isBuffer=!0),r.TYPED_ARRAY_SUPPORT&&typeof n.byteLength=="number")f._set(n);else if(wt(n))if(r.isBuffer(n))for(u=0;u<i;u++)f[u]=n.readUInt8(u);else for(u=0;u<i;u++)f[u]=(n[u]%256+256)%256;else if(e==="string")f.write(n,0,t);else if(e==="number"&&!r.TYPED_ARRAY_SUPPORT)for(u=0;u<i;u++)f[u]=0;return i>0&&i<=r.poolSize&&(f.parent=w),f}function y(n,t){if(!(this instanceof y))return new y(n,t);var i=new r(n,t);return delete i.parent,i}function rt(n,t,i,r){var f,e,u,o;if(i=Number(i)||0,f=n.length-i,r?(r=Number(r),r>f&&(r=f)):r=f,e=t.length,e%2!=0)throw new Error("Invalid hex string");for(r>e/2&&(r=e/2),u=0;u<r;u++){if(o=parseInt(t.substr(u*2,2),16),isNaN(o))throw new Error("Invalid hex string");n[i+u]=o}return u}function ut(n,t,i,r){return c(p(t,n.length-i),n,i,r)}function b(n,t,i,r){return c(kt(t),n,i,r)}function ft(n,t,i,r){return b(n,t,i,r)}function et(n,t,i,r){return c(tt(t),n,i,r)}function ot(n,t,i,r){return c(dt(t,n.length-i),n,i,r)}function st(n,t,i){return t===0&&i===n.length?l.fromByteArray(n):l.fromByteArray(n.slice(t,i))}function ht(n,t,i){var f="",u="",r;for(i=Math.min(n.length,i),r=t;r<i;r++)n[r]<=127?(f+=it(u)+String.fromCharCode(n[r]),u=""):u+="%"+n[r].toString(16);return f+it(u)}function ct(n,t,i){var u="",r;for(i=Math.min(n.length,i),r=t;r<i;r++)u+=String.fromCharCode(n[r]&127);return u}function lt(n,t,i){var u="",r;for(i=Math.min(n.length,i),r=t;r<i;r++)u+=String.fromCharCode(n[r]);return u}function at(n,t,i){var f=n.length,u,r;for((!t||t<0)&&(t=0),(!i||i<0||i>f)&&(i=f),u="",r=t;r<i;r++)u+=bt(n[r]);return u}function vt(n,t,i){for(var u=n.slice(t,i),f="",r=0;r<u.length;r+=2)f+=String.fromCharCode(u[r]+u[r+1]*256);return f}function f(n,t,i){if(n%1!=0||n<0)throw new RangeError("offset is not uint");if(n+t>i)throw new RangeError("Trying to access beyond buffer length");}function e(n,t,i,u,f,e){if(!r.isBuffer(n))throw new TypeError("buffer must be a Buffer instance");if(t>f||t<e)throw new RangeError("value is out of bounds");if(i+u>n.length)throw new RangeError("index out of range");}function s(n,t,i,r){t<0&&(t=65535+t+1);for(var u=0,f=Math.min(n.length-i,2);u<f;u++)n[i+u]=(t&255<<8*(r?u:1-u))>>>(r?u:1-u)*8}function h(n,t,i,r){t<0&&(t=4294967295+t+1);for(var u=0,f=Math.min(n.length-i,4);u<f;u++)n[i+u]=t>>>(r?u:3-u)*8&255}function k(n,t,i,r,u,f){if(t>u||t<f)throw new RangeError("value is out of bounds");if(i+r>n.length)throw new RangeError("index out of range");if(i<0)throw new RangeError("index out of range");}function d(n,t,i,r,u){return u||k(n,t,i,4,34028234663852886e22,-34028234663852886e22),o.write(n,t,i,r,23,4),i+4}function g(n,t,i,r,u){return u||k(n,t,i,8,17976931348623157e292,-17976931348623157e292),o.write(n,t,i,r,52,8),i+8}function yt(n){if(n=pt(n).replace(nt,""),n.length<2)return"";while(n.length%4!=0)n=n+"=";return n}function pt(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function wt(n){return a(n)||r.isBuffer(n)||n&&typeof n=="object"&&typeof n.length=="number"}function bt(n){return n<16?"0"+n.toString(16):n.toString(16)}function p(n,t){t=t||Infinity;for(var i,e=n.length,u=null,r=[],f=0;f<e;f++){if(i=n.charCodeAt(f),i>55295&&i<57344)if(u)if(i<56320){(t-=3)>-1&&r.push(239,191,189);u=i;continue}else i=u-55296<<10|i-56320|65536,u=null;else if(i>56319){(t-=3)>-1&&r.push(239,191,189);continue}else if(f+1===e){(t-=3)>-1&&r.push(239,191,189);continue}else{u=i;continue}else u&&((t-=3)>-1&&r.push(239,191,189),u=null);if(i<128){if((t-=1)<0)break;r.push(i)}else if(i<2048){if((t-=2)<0)break;r.push(i>>6|192,i&63|128)}else if(i<65536){if((t-=3)<0)break;r.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<2097152){if((t-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point");}return r}function kt(n){for(var i=[],t=0;t<n.length;t++)i.push(n.charCodeAt(t)&255);return i}function dt(n,t){for(var i,f,e,r=[],u=0;u<n.length;u++){if((t-=2)<0)break;i=n.charCodeAt(u);f=i>>8;e=i%256;r.push(e);r.push(f)}return r}function tt(n){return l.toByteArray(yt(n))}function c(n,t,i,r){for(var u=0;u<r;u++){if(u+i>=t.length||u>=n.length)break;t[u+i]=n[u]}return u}function it(n){try{return decodeURIComponent(n)}catch(t){return String.fromCharCode(65533)}}var l=n("base64-js"),o=n("ieee754"),a=n("is-array"),v,w,u,nt;i.Buffer=r;i.SlowBuffer=y;i.INSPECT_MAX_BYTES=50;r.poolSize=8192;v=1073741823;w={};r.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),n=new Uint8Array(t);return n.foo=function(){return 42},n.foo()===42&&typeof n.subarray=="function"&&new Uint8Array(1).subarray(1,1).byteLength===0}catch(i){return!1}}();r.isBuffer=function(n){return!!(n!=null&&n._isBuffer)};r.compare=function(n,t){var u,f,i,e;if(!r.isBuffer(n)||!r.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(n===t)return 0;for(u=n.length,f=t.length,i=0,e=Math.min(u,f);i<e&&n[i]===t[i];i++);return(i!==e&&(u=n[i],f=t[i]),u<f)?-1:f<u?1:0};r.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};r.concat=function(n,t){var i,u,f,e;if(!a(n))throw new TypeError("list argument must be an Array of Buffers.");if(n.length===0)return new r(0);if(n.length===1)return n[0];if(t===undefined)for(t=0,i=0;i<n.length;i++)t+=n[i].length;for(u=new r(t),f=0,i=0;i<n.length;i++)e=n[i],e.copy(u,f),f+=e.length;return u};r.byteLength=function(n,t){var i;n=n+"";switch(t||"utf8"){case"ascii":case"binary":case"raw":i=n.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=n.length*2;break;case"hex":i=n.length>>>1;break;case"utf8":case"utf-8":i=p(n).length;break;case"base64":i=tt(n).length;break;default:i=n.length}return i};r.prototype.length=undefined;r.prototype.parent=undefined;r.prototype.toString=function(n,t,i){var r=!1;if(t=t>>>0,i=i===undefined||i===Infinity?this.length:i>>>0,n||(n="utf8"),t<0&&(t=0),i>this.length&&(i=this.length),i<=t)return"";for(;;)switch(n){case"hex":return at(this,t,i);case"utf8":case"utf-8":return ht(this,t,i);case"ascii":return ct(this,t,i);case"binary":return lt(this,t,i);case"base64":return st(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase();r=!0}};r.prototype.equals=function(n){if(!r.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:r.compare(this,n)===0};r.prototype.inspect=function(){var n="",t=i.INSPECT_MAX_BYTES;return this.length>0&&(n=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(n+=" ... ")),"<Buffer "+n+">"};r.prototype.compare=function(n){if(!r.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?0:r.compare(this,n)};r.prototype.indexOf=function(n,t){function i(n,t,i){for(var r=-1,u=0;i+u<n.length;u++)if(n[i+u]===t[r===-1?0:u-r]){if(r===-1&&(r=u),u-r+1===t.length)return i+r}else r=-1;return-1}if((t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t>>=0,this.length===0)||t>=this.length)return-1;if(t<0&&(t=Math.max(this.length+t,0)),typeof n=="string")return n.length===0?-1:String.prototype.indexOf.call(this,n,t);if(r.isBuffer(n))return i(this,n,t);if(typeof n=="number")return r.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"?Uint8Array.prototype.indexOf.call(this,n,t):i(this,[n],t);throw new TypeError("val must be string, number or Buffer");};r.prototype.get=function(n){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(n)};r.prototype.set=function(n,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(n,t)};r.prototype.write=function(n,t,i,r){var e,f,u;if(isFinite(t)?isFinite(i)||(r=i,i=undefined):(e=r,r=t,t=i,i=e),t=Number(t)||0,i<0||t<0||t>this.length)throw new RangeError("attempt to write outside buffer bounds");f=this.length-t;i?(i=Number(i),i>f&&(i=f)):i=f;r=String(r||"utf8").toLowerCase();switch(r){case"hex":u=rt(this,n,t,i);break;case"utf8":case"utf-8":u=ut(this,n,t,i);break;case"ascii":u=b(this,n,t,i);break;case"binary":u=ft(this,n,t,i);break;case"base64":u=et(this,n,t,i);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":u=ot(this,n,t,i);break;default:throw new TypeError("Unknown encoding: "+r);}return u};r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};r.prototype.slice=function(n,t){var i=this.length,u,e,f;if(n=~~n,t=t===undefined?i:~~t,n<0?(n+=i,n<0&&(n=0)):n>i&&(n=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<n&&(t=n),r.TYPED_ARRAY_SUPPORT)u=r._augment(this.subarray(n,t));else for(e=t-n,u=new r(e,undefined),f=0;f<e;f++)u[f]=this[f+n];return u.length&&(u.parent=this.parent||this),u};r.prototype.readUIntLE=function(n,t,i){n=n>>>0;t=t>>>0;i||f(n,t,this.length);for(var r=this[n],u=1,e=0;++e<t&&(u*=256);)r+=this[n+e]*u;return r};r.prototype.readUIntBE=function(n,t,i){n=n>>>0;t=t>>>0;i||f(n,t,this.length);for(var r=this[n+--t],u=1;t>0&&(u*=256);)r+=this[n+--t]*u;return r};r.prototype.readUInt8=function(n,t){return t||f(n,1,this.length),this[n]};r.prototype.readUInt16LE=function(n,t){return t||f(n,2,this.length),this[n]|this[n+1]<<8};r.prototype.readUInt16BE=function(n,t){return t||f(n,2,this.length),this[n]<<8|this[n+1]};r.prototype.readUInt32LE=function(n,t){return t||f(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216};r.prototype.readUInt32BE=function(n,t){return t||f(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])};r.prototype.readIntLE=function(n,t,i){n=n>>>0;t=t>>>0;i||f(n,t,this.length);for(var r=this[n],u=1,e=0;++e<t&&(u*=256);)r+=this[n+e]*u;return u*=128,r>=u&&(r-=Math.pow(2,8*t)),r};r.prototype.readIntBE=function(n,t,i){n=n>>>0;t=t>>>0;i||f(n,t,this.length);for(var e=t,r=1,u=this[n+--e];e>0&&(r*=256);)u+=this[n+--e]*r;return r*=128,u>=r&&(u-=Math.pow(2,8*t)),u};r.prototype.readInt8=function(n,t){return(t||f(n,1,this.length),!(this[n]&128))?this[n]:(256-this[n])*-1};r.prototype.readInt16LE=function(n,t){t||f(n,2,this.length);var i=this[n]|this[n+1]<<8;return i&32768?i|4294901760:i};r.prototype.readInt16BE=function(n,t){t||f(n,2,this.length);var i=this[n+1]|this[n]<<8;return i&32768?i|4294901760:i};r.prototype.readInt32LE=function(n,t){return t||f(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24};r.prototype.readInt32BE=function(n,t){return t||f(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]};r.prototype.readFloatLE=function(n,t){return t||f(n,4,this.length),o.read(this,n,!0,23,4)};r.prototype.readFloatBE=function(n,t){return t||f(n,4,this.length),o.read(this,n,!1,23,4)};r.prototype.readDoubleLE=function(n,t){return t||f(n,8,this.length),o.read(this,n,!0,52,8)};r.prototype.readDoubleBE=function(n,t){return t||f(n,8,this.length),o.read(this,n,!1,52,8)};r.prototype.writeUIntLE=function(n,t,i,r){n=+n;t=t>>>0;i=i>>>0;r||e(this,n,t,i,Math.pow(2,8*i),0);var u=1,f=0;for(this[t]=n&255;++f<i&&(u*=256);)this[t+f]=n/u>>>0&255;return t+i};r.prototype.writeUIntBE=function(n,t,i,r){n=+n;t=t>>>0;i=i>>>0;r||e(this,n,t,i,Math.pow(2,8*i),0);var u=i-1,f=1;for(this[t+u]=n&255;--u>=0&&(f*=256);)this[t+u]=n/f>>>0&255;return t+i};r.prototype.writeUInt8=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,1,255,0),r.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),this[t]=n,t+1};r.prototype.writeUInt16LE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n,this[t+1]=n>>>8):s(this,n,t,!0),t+2};r.prototype.writeUInt16BE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>8,this[t+1]=n):s(this,n,t,!1),t+2};r.prototype.writeUInt32LE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t+3]=n>>>24,this[t+2]=n>>>16,this[t+1]=n>>>8,this[t]=n):h(this,n,t,!0),t+4};r.prototype.writeUInt32BE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>24,this[t+1]=n>>>16,this[t+2]=n>>>8,this[t+3]=n):h(this,n,t,!1),t+4};r.prototype.writeIntLE=function(n,t,i,r){n=+n;t=t>>>0;r||e(this,n,t,i,Math.pow(2,8*i-1)-1,-Math.pow(2,8*i-1));var u=0,f=1,o=n<0?1:0;for(this[t]=n&255;++u<i&&(f*=256);)this[t+u]=(n/f>>0)-o&255;return t+i};r.prototype.writeIntBE=function(n,t,i,r){n=+n;t=t>>>0;r||e(this,n,t,i,Math.pow(2,8*i-1)-1,-Math.pow(2,8*i-1));var u=i-1,f=1,o=n<0?1:0;for(this[t+u]=n&255;--u>=0&&(f*=256);)this[t+u]=(n/f>>0)-o&255;return t+i};r.prototype.writeInt8=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,1,127,-128),r.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),n<0&&(n=255+n+1),this[t]=n,t+1};r.prototype.writeInt16LE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=n,this[t+1]=n>>>8):s(this,n,t,!0),t+2};r.prototype.writeInt16BE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>8,this[t+1]=n):s(this,n,t,!1),t+2};r.prototype.writeInt32LE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[t]=n,this[t+1]=n>>>8,this[t+2]=n>>>16,this[t+3]=n>>>24):h(this,n,t,!0),t+4};r.prototype.writeInt32BE=function(n,t,i){return n=+n,t=t>>>0,i||e(this,n,t,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>24,this[t+1]=n>>>16,this[t+2]=n>>>8,this[t+3]=n):h(this,n,t,!1),t+4};r.prototype.writeFloatLE=function(n,t,i){return d(this,n,t,!0,i)};r.prototype.writeFloatBE=function(n,t,i){return d(this,n,t,!1,i)};r.prototype.writeDoubleLE=function(n,t,i){return g(this,n,t,!0,i)};r.prototype.writeDoubleBE=function(n,t,i){return g(this,n,t,!1,i)};r.prototype.copy=function(n,t,i,u){var f,e;if((i||(i=0),u||u===0||(u=this.length),t>=n.length&&(t=n.length),t||(t=0),u>0&&u<i&&(u=i),u===i)||n.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(u<0)throw new RangeError("sourceEnd out of bounds");if(u>this.length&&(u=this.length),n.length-t<u-i&&(u=n.length-t+i),f=u-i,f<1e3||!r.TYPED_ARRAY_SUPPORT)for(e=0;e<f;e++)n[e+t]=this[e+i];else n._set(this.subarray(i,i+f),t);return f};r.prototype.fill=function(n,t,i){var r,u,f;if(n||(n=0),t||(t=0),i||(i=this.length),i<t)throw new RangeError("end < start");if(i!==t&&this.length!==0){if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(i<0||i>this.length)throw new RangeError("end out of bounds");if(typeof n=="number")for(r=t;r<i;r++)this[r]=n;else for(u=p(n.toString()),f=u.length,r=t;r<i;r++)this[r]=u[r%f];return this}};r.prototype.toArrayBuffer=function(){var t,n,i;if(typeof Uint8Array!="undefined"){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(t=new Uint8Array(this.length),n=0,i=t.length;n<i;n+=1)t[n]=this[n];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};u=r.prototype;r._augment=function(n){return n.constructor=r,n._isBuffer=!0,n._set=n.set,n.get=u.get,n.set=u.set,n.write=u.write,n.toString=u.toString,n.toLocaleString=u.toString,n.toJSON=u.toJSON,n.equals=u.equals,n.compare=u.compare,n.indexOf=u.indexOf,n.copy=u.copy,n.slice=u.slice,n.readUIntLE=u.readUIntLE,n.readUIntBE=u.readUIntBE,n.readUInt8=u.readUInt8,n.readUInt16LE=u.readUInt16LE,n.readUInt16BE=u.readUInt16BE,n.readUInt32LE=u.readUInt32LE,n.readUInt32BE=u.readUInt32BE,n.readIntLE=u.readIntLE,n.readIntBE=u.readIntBE,n.readInt8=u.readInt8,n.readInt16LE=u.readInt16LE,n.readInt16BE=u.readInt16BE,n.readInt32LE=u.readInt32LE,n.readInt32BE=u.readInt32BE,n.readFloatLE=u.readFloatLE,n.readFloatBE=u.readFloatBE,n.readDoubleLE=u.readDoubleLE,n.readDoubleBE=u.readDoubleBE,n.writeUInt8=u.writeUInt8,n.writeUIntLE=u.writeUIntLE,n.writeUIntBE=u.writeUIntBE,n.writeUInt16LE=u.writeUInt16LE,n.writeUInt16BE=u.writeUInt16BE,n.writeUInt32LE=u.writeUInt32LE,n.writeUInt32BE=u.writeUInt32BE,n.writeIntLE=u.writeIntLE,n.writeIntBE=u.writeIntBE,n.writeInt8=u.writeInt8,n.writeInt16LE=u.writeInt16LE,n.writeInt16BE=u.writeInt16BE,n.writeInt32LE=u.writeInt32LE,n.writeInt32BE=u.writeInt32BE,n.writeFloatLE=u.writeFloatLE,n.writeFloatBE=u.writeFloatBE,n.writeDoubleLE=u.writeDoubleLE,n.writeDoubleBE=u.writeDoubleBE,n.fill=u.fill,n.inspect=u.inspect,n.toArrayBuffer=u.toArrayBuffer,n};nt=/[^+\/0-9A-z\-]/g},{"base64-js":4,ieee754:5,"is-array":6}],4:[function(n,t,i){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(n){"use strict";function t(n){var t=n.charCodeAt(0);return t===o||t===h?62:t===s||t===c?63:t<i?-1:t<i+10?t-i+26+26:t<f+26?t-f:t<u+26?t-u+26:void 0}function l(n){function u(n){o[l++]=n}var i,h,c,r,f,o,s,l;if(n.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");for(s=n.length,f="="===n.charAt(s-2)?2:"="===n.charAt(s-1)?1:0,o=new e(n.length*3/4-f),c=f>0?n.length-4:n.length,l=0,i=0,h=0;i<c;i+=4,h+=3)r=t(n.charAt(i))<<18|t(n.charAt(i+1))<<12|t(n.charAt(i+2))<<6|t(n.charAt(i+3)),u((r&16711680)>>16),u((r&65280)>>8),u(r&255);return f===2?(r=t(n.charAt(i))<<2|t(n.charAt(i+1))>>4,u(r&255)):f===1&&(r=t(n.charAt(i))<<10|t(n.charAt(i+1))<<4|t(n.charAt(i+2))>>2,u(r>>8&255),u(r&255)),o}function a(n){function u(n){return r.charAt(n)}function s(n){return u(n>>18&63)+u(n>>12&63)+u(n>>6&63)+u(n&63)}for(var e=n.length%3,t="",i,f=0,o=n.length-e;f<o;f+=3)i=(n[f]<<16)+(n[f+1]<<8)+n[f+2],t+=s(i);switch(e){case 1:i=n[n.length-1];t+=u(i>>2);t+=u(i<<4&63);t+="==";break;case 2:i=(n[n.length-2]<<8)+n[n.length-1];t+=u(i>>10);t+=u(i>>4&63);t+=u(i<<2&63);t+="="}return t}var e=typeof Uint8Array!="undefined"?Uint8Array:Array,o="+".charCodeAt(0),s="/".charCodeAt(0),i="0".charCodeAt(0),u="a".charCodeAt(0),f="A".charCodeAt(0),h="-".charCodeAt(0),c="_".charCodeAt(0);n.toByteArray=l;n.fromByteArray=a})(typeof i=="undefined"?this.base64js={}:i)},{}],5:[function(n,t,i){i.read=function(n,t,i,r,u){var f,o,l=u*8-r-1,a=(1<<l)-1,v=a>>1,e=-7,s=i?u-1:0,c=i?-1:1,h=n[t+s];for(s+=c,f=h&(1<<-e)-1,h>>=-e,e+=l;e>0;f=f*256+n[t+s],s+=c,e-=8);for(o=f&(1<<-e)-1,f>>=-e,e+=r;e>0;o=o*256+n[t+s],s+=c,e-=8);if(f===0)f=1-v;else{if(f===a)return o?NaN:(h?-1:1)*Infinity;o=o+Math.pow(2,r);f=f-v}return(h?-1:1)*o*Math.pow(2,f-r)};i.write=function(n,t,i,r,u,f){var e,o,s,l=f*8-u-1,a=(1<<l)-1,h=a>>1,y=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=r?0:f-1,v=r?1:-1,p=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===Infinity?(o=isNaN(t)?1:0,e=a):(e=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-e))<1&&(e--,s*=2),t+=e+h>=1?y/s:y*Math.pow(2,1-h),t*s>=2&&(e++,s/=2),e+h>=a?(o=0,e=a):e+h>=1?(o=(t*s-1)*Math.pow(2,u),e=e+h):(o=t*Math.pow(2,h-1)*Math.pow(2,u),e=0));u>=8;n[i+c]=o&255,c+=v,o/=256,u-=8);for(e=e<<u|o,l+=u;l>0;n[i+c]=e&255,c+=v,e/=256,l-=8);n[i+c-v]|=p*128}},{}],6:[function(n,t){var i=Array.isArray,r=Object.prototype.toString;t.exports=i||function(n){return!!n&&"[object Array]"==r.call(n)}},{}],7:[function(n,t,i){(function(n){function u(n,t){for(var u,r=0,i=n.length-1;i>=0;i--)u=n[i],u==="."?n.splice(i,1):u===".."?(n.splice(i,1),r++):r&&(n.splice(i,1),r--);if(t)for(;r--;r)n.unshift("..");return n}function r(n,t){var r,i;if(n.filter)return n.filter(t);for(r=[],i=0;i<n.length;i++)t(n[i],i,n)&&r.push(n[i]);return r}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,t=function(n){return e.exec(n).slice(1)},f;i.resolve=function(){for(var i,t="",f=!1,e=arguments.length-1;e>=-1&&!f;e--){if(i=e>=0?arguments[e]:n.cwd(),typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");else if(!i)continue;t=i+"/"+t;f=i.charAt(0)==="/"}return t=u(r(t.split("/"),function(n){return!!n}),!f).join("/"),(f?"/":"")+t||"."};i.normalize=function(n){var t=i.isAbsolute(n),e=f(n,-1)==="/";return n=u(r(n.split("/"),function(n){return!!n}),!t).join("/"),n||t||(n="."),n&&e&&(n+="/"),(t?"/":"")+n};i.isAbsolute=function(n){return n.charAt(0)==="/"};i.join=function(){var n=Array.prototype.slice.call(arguments,0);return i.normalize(r(n,function(n){if(typeof n!="string")throw new TypeError("Arguments to path.join must be strings");return n}).join("/"))};i.relative=function(n,t){function s(n){for(var t=0,i;t<n.length;t++)if(n[t]!=="")break;for(i=n.length-1;i>=0;i--)if(n[i]!=="")break;return t>i?[]:n.slice(t,i-t+1)}var u,r;n=i.resolve(n).substr(1);t=i.resolve(t).substr(1);var f=s(n.split("/")),e=s(t.split("/")),h=Math.min(f.length,e.length),o=h;for(r=0;r<h;r++)if(f[r]!==e[r]){o=r;break}for(u=[],r=o;r<f.length;r++)u.push("..");return u=u.concat(e.slice(o)),u.join("/")};i.sep="/";i.delimiter=":";i.dirname=function(n){var r=t(n),u=r[0],i=r[1];return!u&&!i?".":(i&&(i=i.substr(0,i.length-1)),u+i)};i.basename=function(n,i){var r=t(n)[2];return i&&r.substr(-1*i.length)===i&&(r=r.substr(0,r.length-i.length)),r};i.extname=function(n){return t(n)[3]};f="ab".substr(-1)==="b"?function(n,t,i){return n.substr(t,i)}:function(n,t,i){return t<0&&(t=n.length+t),n.substr(t,i)}}).call(this,n("_process"))},{_process:8}],8:[function(n,t){function e(){var i,n,t;if(!f){for(f=!0,n=u.length;n;){for(i=u,u=[],t=-1;++t<n;)i[t]();n=u.length}f=!1}}function r(){}var i=t.exports={},u=[],f=!1;i.nextTick=function(n){u.push(n);f||setTimeout(e,0)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};i.on=r;i.addListener=r;i.once=r;i.off=r;i.removeListener=r;i.removeAllListeners=r;i.emit=r;i.binding=function(){throw new Error("process.binding is not supported");};i.cwd=function(){return"/"};i.chdir=function(){throw new Error("process.chdir is not supported");};i.umask=function(){return 0}},{}],9:[function(t,i,r){(function(t,i){"use strict";typeof n=="function"&&n.amd?n(["exports"],i):typeof r!="undefined"?i(r):i(t.esprima={})})(this,function(n){"use strict";function ui(n,t){if(!n)throw new Error("ASSERT: "+t);}function vt(){this.$data={}}function wt(n){return n>=48&&n<=57}function pr(n){return"0123456789abcdefABCDEF".indexOf(n)>=0}function ni(n){return"01234567".indexOf(n)>=0}function he(n){return n===32||n===9||n===11||n===12||n===160||n>=5760&&" ᠎             　﻿".indexOf(String.fromCharCode(n))>0}function bt(n){return n===10||n===13||n===8232||n===8233}function fi(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n===92||n>=128&&ur.NonAsciiIdentifierStart.test(String.fromCharCode(n))}function bi(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57||n===92||n>=128&&ur.NonAsciiIdentifierPart.test(String.fromCharCode(n))}function ce(n){switch(n){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function ki(n){switch(n){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function lt(n){return n==="eval"||n==="arguments"}function le(n){if(k&&ki(n))return!0;switch(n.length){case 2:return n==="if"||n==="in"||n==="do";case 3:return n==="var"||n==="for"||n==="new"||n==="try"||n==="let";case 4:return n==="this"||n==="else"||n==="case"||n==="void"||n==="with"||n==="enum";case 5:return n==="while"||n==="break"||n==="catch"||n==="throw"||n==="const"||n==="class"||n==="super";case 6:return n==="return"||n==="typeof"||n==="delete"||n==="switch"||n==="export"||n==="import";case 7:return n==="default"||n==="finally"||n==="extends";case 8:return n==="function"||n==="continue"||n==="debugger";case 10:return n==="instanceof";default:return!1}}function wr(n,t,i,r,u){var f;(ui(typeof i=="number","Comment must have valid position"),e.lastCommentStart>=i)||(e.lastCommentStart=i,f={type:n,value:t},c.range&&(f.range=[i,r]),c.loc&&(f.loc=u),c.comments.push(f),c.attachComment&&(c.leadingComments.push(f),c.trailingComments.push(f)))}function ae(){for(var u,r,n=t-2,i={start:{line:w,column:t-b-2}};t<d;)if(u=l.charCodeAt(t),++t,bt(u)){c.comments&&(r=l.slice(n+2,t-1),i.end={line:w,column:t-b-1},wr("Line",r,n,t-1,i));u===13&&l.charCodeAt(t)===10&&++t;++w;b=t;return}c.comments&&(r=l.slice(n+2,t),i.end={line:w,column:t-b},wr("Line",r,n,t,i))}function ve(){var i,r,n,u;for(c.comments&&(i=t-2,r={start:{line:w,column:t-b-2}});t<d;)if(n=l.charCodeAt(t),bt(n))n===13&&l.charCodeAt(t+1)===10&&++t,++w,++t,b=t,t>=d&&p({},o.UnexpectedToken,"ILLEGAL");else if(n===42){if(l.charCodeAt(t+1)===47){++t;++t;c.comments&&(u=l.slice(i+2,t-2),r.end={line:w,column:t-b},wr("Block",u,i,t,r));return}++t}else++t;p({},o.UnexpectedToken,"ILLEGAL")}function ei(){for(var n;t<d;)if(n=l.charCodeAt(t),he(n))++t;else if(bt(n))++t,n===13&&l.charCodeAt(t)===10&&++t,++w,b=t;else if(n===47)if(n=l.charCodeAt(t+1),n===47)++t,++t,ae();else if(n===42)++t,++t,ve();else break;else break}function di(n){for(var f,r=0,u=n==="u"?4:2,i=0;i<u;++i)if(t<d&&pr(l[t]))f=l[t++],r=r*16+"0123456789abcdef".indexOf(f.toLowerCase());else return"";return String.fromCharCode(r)}function cu(){var i,n,r,u;for(i=l[t],n=0,i==="}"&&p({},o.UnexpectedToken,"ILLEGAL");t<d;){if(i=l[t++],!pr(i))break;n=n*16+"0123456789abcdef".indexOf(i.toLowerCase())}return((n>1114111||i!=="}")&&p({},o.UnexpectedToken,"ILLEGAL"),n<=65535)?String.fromCharCode(n):(r=(n-65536>>10)+55296,u=(n-65536&1023)+56320,String.fromCharCode(r,u))}function lu(){var n,i;for(n=l.charCodeAt(t++),i=String.fromCharCode(n),n===92&&(l.charCodeAt(t)!==117&&p({},o.UnexpectedToken,"ILLEGAL"),++t,n=di("u"),n&&n!=="\\"&&fi(n.charCodeAt(0))||p({},o.UnexpectedToken,"ILLEGAL"),i=n);t<d;){if(n=l.charCodeAt(t),!bi(n))break;++t;i+=String.fromCharCode(n);n===92&&(i=i.substr(0,i.length-1),l.charCodeAt(t)!==117&&p({},o.UnexpectedToken,"ILLEGAL"),++t,n=di("u"),n&&n!=="\\"&&bi(n.charCodeAt(0))||p({},o.UnexpectedToken,"ILLEGAL"),i+=n)}return i}function ye(){for(var i,n=t++;t<d;){if(i=l.charCodeAt(t),i===92)return t=n,lu();if(bi(i))++t;else break}return l.slice(n,t)}function pe(){var i,n,r;return i=t,n=l.charCodeAt(t)===92?lu():ye(),r=n.length===1?s.Identifier:le(n)?s.Keyword:n==="null"?s.NullLiteral:n==="true"||n==="false"?s.BooleanLiteral:s.Identifier,{type:r,value:n,lineNumber:w,lineStart:b,range:[i,t]}}function ti(){var n=t,u=l.charCodeAt(t),h,i=l[t],r,f,a;if(e.inJSXTag||e.inJSXChild)switch(u){case 60:case 62:return++t,{type:s.Punctuator,value:String.fromCharCode(u),lineNumber:w,lineStart:b,range:[n,t]}}switch(u){case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++t,c.tokenize&&(u===40?c.openParenToken=c.tokens.length:u===123&&(c.openCurlyToken=c.tokens.length)),{type:s.Punctuator,value:String.fromCharCode(u),lineNumber:w,lineStart:b,range:[n,t]};default:if(h=l.charCodeAt(t+1),h===61)switch(u){case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:return t+=2,{type:s.Punctuator,value:String.fromCharCode(u)+String.fromCharCode(h),lineNumber:w,lineStart:b,range:[n,t]};case 33:case 61:return t+=2,l.charCodeAt(t)===61&&++t,{type:s.Punctuator,value:l.slice(n,t),lineNumber:w,lineStart:b,range:[n,t]}}}if(r=l[t+1],f=l[t+2],a=l[t+3],i===">"&&r===">"&&f===">"&&a==="=")return t+=4,{type:s.Punctuator,value:">>>=",lineNumber:w,lineStart:b,range:[n,t]};if(i===">"&&r===">"&&f===">"&&!e.inType)return t+=3,{type:s.Punctuator,value:">>>",lineNumber:w,lineStart:b,range:[n,t]};if(i==="<"&&r==="<"&&f==="=")return t+=3,{type:s.Punctuator,value:"<<=",lineNumber:w,lineStart:b,range:[n,t]};if(i===">"&&r===">"&&f==="=")return t+=3,{type:s.Punctuator,value:">>=",lineNumber:w,lineStart:b,range:[n,t]};if(i==="."&&r==="."&&f===".")return t+=3,{type:s.Punctuator,value:"...",lineNumber:w,lineStart:b,range:[n,t]};if(i===r&&"+-<>&|".indexOf(i)>=0&&!e.inType)return t+=2,{type:s.Punctuator,value:i+r,lineNumber:w,lineStart:b,range:[n,t]};if(i==="="&&r===">")return t+=2,{type:s.Punctuator,value:"=>",lineNumber:w,lineStart:b,range:[n,t]};if("<>=!+-*%&|^/".indexOf(i)>=0)return++t,{type:s.Punctuator,value:i,lineNumber:w,lineStart:b,range:[n,t]};if(i===".")return++t,{type:s.Punctuator,value:i,lineNumber:w,lineStart:b,range:[n,t]};p({},o.UnexpectedToken,"ILLEGAL")}function we(n){for(var i="";t<d;){if(!pr(l[t]))break;i+=l[t++]}return i.length===0&&p({},o.UnexpectedToken,"ILLEGAL"),fi(l.charCodeAt(t))&&p({},o.UnexpectedToken,"ILLEGAL"),{type:s.NumericLiteral,value:parseInt("0x"+i,16),lineNumber:w,lineStart:b,range:[n,t]}}function be(n){for(var i,r="";t<d;){if(i=l[t],i!=="0"&&i!=="1")break;r+=l[t++]}return r.length===0&&p({},o.UnexpectedToken,"ILLEGAL"),t<d&&(i=l.charCodeAt(t),(fi(i)||wt(i))&&p({},o.UnexpectedToken,"ILLEGAL")),{type:s.NumericLiteral,value:parseInt(r,2),lineNumber:w,lineStart:b,range:[n,t]}}function ke(n,i){var r,u;for(ni(n)?(u=!0,r="0"+l[t++]):(u=!1,++t,r="");t<d;){if(!ni(l[t]))break;r+=l[t++]}return u||r.length!==0||p({},o.UnexpectedToken,"ILLEGAL"),(fi(l.charCodeAt(t))||wt(l.charCodeAt(t)))&&p({},o.UnexpectedToken,"ILLEGAL"),{type:s.NumericLiteral,value:parseInt(r,8),octal:u,lineNumber:w,lineStart:b,range:[i,t]}}function au(){var i,r,n;if(n=l[t],ui(wt(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),r=t,i="",n!=="."){if(i=l[t++],n=l[t],i==="0"){if(n==="x"||n==="X")return++t,we(r);if(n==="b"||n==="B")return++t,be(r);if(n==="o"||n==="O"||ni(n))return ke(n,r);n&&wt(n.charCodeAt(0))&&p({},o.UnexpectedToken,"ILLEGAL")}while(wt(l.charCodeAt(t)))i+=l[t++];n=l[t]}if(n==="."){for(i+=l[t++];wt(l.charCodeAt(t));)i+=l[t++];n=l[t]}if(n==="e"||n==="E")if(i+=l[t++],n=l[t],(n==="+"||n==="-")&&(i+=l[t++]),wt(l.charCodeAt(t)))while(wt(l.charCodeAt(t)))i+=l[t++];else p({},o.UnexpectedToken,"ILLEGAL");return fi(l.charCodeAt(t))&&p({},o.UnexpectedToken,"ILLEGAL"),{type:s.NumericLiteral,value:parseFloat(i),lineNumber:w,lineStart:b,range:[r,t]}}function de(){var i="",u,h,n,r,f,c,e=!1;for(u=l[t],ui(u==="'"||u==='"',"String literal must starts with a quote"),h=t,++t;t<d;)if(n=l[t++],n===u){u="";break}else if(n==="\\")if(n=l[t++],n&&bt(n.charCodeAt(0)))++w,n==="\r"&&l[t]==="\n"&&++t,b=t;else switch(n){case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"u":case"x":l[t]==="{"?(++t,i+=cu()):(c=t,f=di(n),f?i+=f:(t=c,i+=n));break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\x0b";break;default:ni(n)?(r="01234567".indexOf(n),r!==0&&(e=!0),t<d&&ni(l[t])&&(e=!0,r=r*8+"01234567".indexOf(l[t++]),"0123".indexOf(n)>=0&&t<d&&ni(l[t])&&(r=r*8+"01234567".indexOf(l[t++]))),i+=String.fromCharCode(r)):i+=n}else if(bt(n.charCodeAt(0)))break;else i+=n;return u!==""&&p({},o.UnexpectedToken,"ILLEGAL"),{type:s.StringLiteral,value:i,octal:e,lineNumber:w,lineStart:b,range:[h,t]}}function vu(){var i="",n,e,u,f,a,h,r,c;for(u=!1,f=!1,e=t,++t;t<d;)if(n=l[t++],n==="`"){f=!0;u=!0;break}else if(n==="$"){if(l[t]==="{"){++t;u=!0;break}i+=n}else if(n==="\\")if(n=l[t++],bt(n.charCodeAt(0)))++w,n==="\r"&&l[t]==="\n"&&++t,b=t;else switch(n){case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"u":case"x":l[t]==="{"?(++t,i+=cu()):(a=t,h=di(n),h?i+=h:(t=a,i+=n));break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+='\v';break;default:ni(n)?(r="01234567".indexOf(n),r!==0&&(c=!0),t<d&&ni(l[t])&&(c=!0,r=r*8+"01234567".indexOf(l[t++]),"0123".indexOf(n)>=0&&t<d&&ni(l[t])&&(r=r*8+"01234567".indexOf(l[t++]))),i+=String.fromCharCode(r)):i+=n}else bt(n.charCodeAt(0))?(++w,n==="\r"&&l[t]==="\n"&&++t,b=t,i+="\n"):i+=n;return u||p({},o.UnexpectedToken,"ILLEGAL"),{type:s.Template,value:{cooked:i,raw:l.slice(e+1,t-(f?1:2))},tail:f,octal:c,lineNumber:w,lineStart:b,range:[e,t]}}function ge(n){var i,r;return a=null,ei(),i=n.head?"`":"}",l[t]!==i&&p({},o.UnexpectedToken,"ILLEGAL"),r=vu(),fr(),r}function no(n,t){var i=n,r;t.indexOf("u")>=0&&(i=i.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(n,t){if(parseInt(t,16)<=1114111)return"x";p({},o.InvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{r=new RegExp(i)}catch(u){p({},o.InvalidRegExp)}try{return new RegExp(n,t)}catch(f){return null}}function to(){var n,i,r,u,f;for(n=l[t],ui(n==="/","Regular expression literal must start with a slash"),i=l[t++],r=!1,u=!1;t<d;)if(n=l[t++],i+=n,n==="\\")n=l[t++],bt(n.charCodeAt(0))&&p({},o.UnterminatedRegExp),i+=n;else if(bt(n.charCodeAt(0)))p({},o.UnterminatedRegExp);else if(r)n==="]"&&(r=!1);else if(n==="/"){u=!0;break}else n==="["&&(r=!0);return u||p({},o.UnterminatedRegExp),f=i.substr(1,i.length-2),{value:f,literal:i}}function io(){for(var n,u,i="",r="";t<d;){if(n=l[t],!bi(n.charCodeAt(0)))break;if(++t,n==="\\"&&t<d)if(n=l[t],n==="u"){if(++t,u=t,n=di("u"),n)for(r+=n,i+="\\u";u<t;++u)i+=l[u];else t=u,r+="u",i+="\\u";tt({},o.UnexpectedToken,"ILLEGAL")}else i+="\\",tt({},o.UnexpectedToken,"ILLEGAL");else r+=n,i+=n}return{value:r,literal:i}}function kt(){var r,n,i,u;return(a=null,ei(),r=t,n=to(),i=io(),u=no(n.value,i.value),c.tokenize)?{type:s.RegularExpression,value:u,regex:{pattern:n.value,flags:i.value},lineNumber:w,lineStart:b,range:[r,t]}:{literal:n.literal+i.literal,value:u,regex:{pattern:n.value,flags:i.value},range:[r,t]}}function br(n){return n.type===s.Identifier||n.type===s.Keyword||n.type===s.BooleanLiteral||n.type===s.NullLiteral}function ro(){var t,n;if(t=c.tokens[c.tokens.length-1],!t)return kt();if(t.type==="Punctuator"){if(t.value===")")return(n=c.tokens[c.openParenToken-1],n&&n.type==="Keyword"&&(n.value==="if"||n.value==="while"||n.value==="for"||n.value==="with"))?kt():ti();if(t.value==="}"){if(c.tokens[c.openCurlyToken-3]&&c.tokens[c.openCurlyToken-3].type==="Keyword"){if(n=c.tokens[c.openCurlyToken-4],!n)return ti()}else if(c.tokens[c.openCurlyToken-4]&&c.tokens[c.openCurlyToken-4].type==="Keyword"){if(n=c.tokens[c.openCurlyToken-5],!n)return kt()}else return ti();return hu.indexOf(n.value)>=0?ti():kt()}return kt()}return t.type==="Keyword"&&t.value!=="this"?kt():ti()}function li(){var n;return(e.inJSXChild||ei(),t>=d)?{type:s.EOF,lineNumber:w,lineStart:b,range:[t,t]}:e.inJSXChild?rc():(n=l.charCodeAt(t),n===40||n===41||n===58)?ti():n===39||n===34?e.inJSXTag?ic():de():e.inJSXTag&&dh(n)?nc():n===96?vu():fi(n)?pe():n===46?wt(l.charCodeAt(t+1))?au():ti():wt(n)?au():c.tokenize&&n===47?ro():ti()}function y(){var n;return n=a,t=n.range[1],w=n.lineNumber,b=n.lineStart,a=li(),t=n.range[1],w=n.lineNumber,b=n.lineStart,n}function fr(){var n,i,r;n=t;i=w;r=b;a=li();t=n;w=i;b=r}function st(){var n,i,r,u,f;return n=typeof c.advance=="function"?c.advance:li,i=t,r=w,u=b,a===null&&(a=n()),t=a.range[1],w=a.lineNumber,b=a.lineStart,f=n(),t=i,w=r,b=u,f}function kr(n){t=n.range[0];w=n.lineNumber;b=n.lineStart;a=n}function v(){return!c.loc&&!c.range?undefined:(ei(),{offset:t,line:w,col:t-b})}function yu(){return!c.loc&&!c.range?undefined:{offset:t,line:w,col:t-b}}function uo(n){var i,r,f=c.bottomRightStack,t=f[f.length-1];if(n.type!==u.Program||!(n.body.length>0)){if(c.trailingComments.length>0?c.trailingComments[0].range[0]>=n.range[1]?(r=c.trailingComments,c.trailingComments=[]):c.trailingComments.length=0:t&&t.trailingComments&&t.trailingComments[0].range[0]>=n.range[1]&&(r=t.trailingComments,delete t.trailingComments),t)while(t&&t.range[0]>=n.range[0])i=t,t=f.pop();i?i.leadingComments&&i.leadingComments[i.leadingComments.length-1].range[1]<=n.range[0]&&(n.leadingComments=i.leadingComments,delete i.leadingComments):c.leadingComments.length>0&&c.leadingComments[c.leadingComments.length-1].range[1]<=n.range[0]&&(n.leadingComments=c.leadingComments,c.leadingComments=[]);r&&(n.trailingComments=r);f.push(n)}}function r(n,i){return c.range&&(i.range=[n.offset,t]),c.loc&&(i.loc={start:{line:n.line,column:n.col},end:{line:w,column:t-b}},i=f.postProcess(i)),c.attachComment&&uo(i),i}function ai(){var i,n,r,u;return i=t,n=w,r=b,ei(),u=w!==n,t=i,w=n,b=r,u}function p(n,i){var r,f=Array.prototype.slice.call(arguments,2),u=i.replace(/%(\d)/g,function(n,t){return ui(t<f.length,"Message reference must be in range"),f[t]});typeof n.lineNumber=="number"?(r=new Error("Line "+n.lineNumber+": "+u),r.index=n.range[0],r.lineNumber=n.lineNumber,r.column=n.range[0]-b+1):(r=new Error("Line "+w+": "+u),r.index=t,r.lineNumber=w,r.column=t-b+1);r.description=u;throw r;}function tt(){try{p.apply(null,arguments)}catch(n){if(c.errors)c.errors.push(n);else throw n;}}function ut(n){if(n.type===s.EOF&&p(n,o.UnexpectedEOS),n.type===s.NumericLiteral&&p(n,o.UnexpectedNumber),(n.type===s.StringLiteral||n.type===s.JSXText)&&p(n,o.UnexpectedString),n.type===s.Identifier&&p(n,o.UnexpectedIdentifier),n.type===s.Keyword){if(ce(n.value))p(n,o.UnexpectedReserved);else if(k&&ki(n.value)){tt(n,o.StrictReservedWord);return}p(n,o.UnexpectedToken,n.value)}n.type===s.Template&&p(n,o.UnexpectedTemplate,n.value.raw);p(n,o.UnexpectedToken,n.value)}function h(n){var t=y();(t.type!==s.Punctuator||t.value!==n)&&ut(t)}function nt(n,t){var i=y();(i.type!==(t?s.Identifier:s.Keyword)||i.value!==n)&&ut(i)}function ii(n){return nt(n,!0)}function i(n){return a.type===s.Punctuator&&a.value===n}function g(n,t){var i=t?s.Identifier:s.Keyword;return a.type===i&&a.value===n}function it(n){return g(n,!0)}function fo(){var n;return a.type!==s.Punctuator?!1:(n=a.value,n==="="||n==="*="||n==="/="||n==="%="||n==="+="||n==="-="||n==="<<="||n===">>="||n===">>>="||n==="&="||n==="^="||n==="|=")}function eo(){return e.yieldAllowed&&g("yield",!k)}function gi(){var t=a,n=!1;return it("async")&&(y(),n=!ai(),kr(t)),n}function oo(){return e.awaitAllowed&&it("await")}function ft(){var n,r=t,u=w,f=b,e=a;if(l.charCodeAt(t)===59){y();return}if(n=w,ei(),w!==n){t=r;w=u;b=f;a=e;return}if(i(";")){y();return}a.type===s.EOF||i("}")||ut(a)}function er(n){return n.type===u.Identifier||n.type===u.MemberExpression}function so(n){return er(n)||n.type===u.ObjectPattern||n.type===u.ArrayPattern}function or(){var t=[],e=[],l=null,n,c=!0,w=v();for(h("[");!i("]");)a.value==="for"&&a.type===s.Keyword?(c||p({},o.ComprehensionError),g("for"),n=af({ignoreBody:!0}),n.of=n.type===u.ForOfStatement,n.type=u.ComprehensionBlock,n.left.kind&&p({},o.ComprehensionError),e.push(n)):a.value==="if"&&a.type===s.Keyword?(c||p({},o.ComprehensionError),nt("if"),h("("),l=rt(),h(")")):a.value===","&&a.type===s.Punctuator?(c=!1,y(),t.push(null)):(n=gr(),t.push(n),n&&n.type===u.SpreadElement?i("]")||p({},o.ElementAfterSpreadElement):i("]")||g("for")||g("if")||(h(","),c=!1));return(h("]"),l&&!e.length&&p({},o.ComprehensionRequiresBlock),e.length)?(t.length!==1&&p({},o.ComprehensionError),r(w,f.createComprehensionExpression(l,e,t[0]))):r(w,f.createArrayExpression(t))}function nr(n){var s,h,c,t,l,i,a=v();return s=k,h=e.yieldAllowed,e.yieldAllowed=n.generator,c=e.awaitAllowed,e.awaitAllowed=n.async,t=n.params||[],l=n.defaults||[],i=vf(),n.name&&k&&lt(t[0].name)&&tt(n.name,o.StrictParamName),k=s,e.yieldAllowed=h,e.awaitAllowed=c,r(a,f.createFunctionExpression(null,t,l,i,n.rest||null,n.generator,i.type!==u.BlockStatement,n.async,n.returnType,n.typeParameters))}function vi(n){var i,t,r;return i=k,k=!0,t=ar(),t.stricted&&tt(t.stricted,t.message),r=nr({params:t.params,defaults:t.defaults,rest:t.rest,generator:n.generator,async:n.async,returnType:t.returnType,typeParameters:n.typeParameters}),k=i,r}function yt(){var t=v(),n=y(),i,u;return n.type===s.StringLiteral||n.type===s.NumericLiteral?(k&&n.octal&&tt(n,o.StrictOctalLiteral),r(t,f.createLiteral(n))):n.type===s.Punctuator&&n.value==="["?(t=v(),i=et(),u=r(t,i),h("]"),u):r(t,f.createIdentifier(n.value))}function ho(){var t,u,c,p,n,e=v(),l,o;if(t=a,n=t.value==="["&&t.type===s.Punctuator,t.type===s.Identifier||n||gi())return(c=yt(),i(":"))?(y(),r(e,f.createProperty("init",c,et(),!1,!1,n))):i("(")||i("<")?(i("<")&&(o=ht()),r(e,f.createProperty("init",c,vi({generator:!1,async:!1,typeParameters:o}),!0,!1,n))):t.value==="get"?(n=a.value==="[",u=yt(),h("("),h(")"),i(":")&&(l=pt()),r(e,f.createProperty("get",u,nr({generator:!1,async:!1,returnType:l}),!1,!1,n))):t.value==="set"?(n=a.value==="[",u=yt(),h("("),t=a,p=[hi()],h(")"),i(":")&&(l=pt()),r(e,f.createProperty("set",u,nr({params:p,generator:!1,async:!1,name:t,returnType:l}),!1,!1,n))):t.value==="async"?(n=a.value==="[",u=yt(),i("<")&&(o=ht()),r(e,f.createProperty("init",u,vi({generator:!1,async:!0,typeParameters:o}),!0,!1,n))):(n&&ut(a),r(e,f.createProperty("init",c,c,!1,!0,!1)));if(t.type===s.EOF||t.type===s.Punctuator)return i("*")||ut(t),y(),n=a.type===s.Punctuator&&a.value==="[",c=yt(),i("<")&&(o=ht()),i("(")||ut(y()),r(e,f.createProperty("init",c,vi({generator:!0,typeParameters:o}),!0,!1,n));if(u=yt(),i(":"))return y(),r(e,f.createProperty("init",u,et(),!1,!1,!1));if(i("(")||i("<"))return i("<")&&(o=ht()),r(e,f.createProperty("init",u,vi({generator:!1,typeParameters:o}),!0,!1,!1));ut(y())}function co(){var n=v();return h("..."),r(n,f.createSpreadProperty(et()))}function lo(n){var t=String;return n.type===u.Identifier?n.name:t(n.value)}function sr(){var l=[],n,e,t,s,c=new vt,a=v(),y=String;for(h("{");!i("}");)i("...")?n=co():(n=ho(),e=n.key.type===u.Identifier?n.key.name:y(n.key.value),t=n.kind==="init"?ri.Data:n.kind==="get"?ri.Get:ri.Set,c.has(e)?(s=c.get(e),s===ri.Data?k&&t===ri.Data?tt({},o.StrictDuplicateProperty):t!==ri.Data&&tt({},o.AccessorDataProperty):t===ri.Data?tt({},o.AccessorDataProperty):s&t&&tt({},o.AccessorGetSet),c.set(e,s|t)):c.set(e,t)),l.push(n),i("}")||h(",");return h("}"),r(a,f.createObjectExpression(l))}function pu(n){var i=v(),t=ge(n);return k&&t.octal&&p(t,o.StrictOctalLiteral),r(i,f.createTemplateElement({raw:t.value.raw,cooked:t.value.cooked},t.tail))}function dr(){var n,t,i,u=v();for(n=pu({head:!0}),t=[n],i=[];!n.tail;)i.push(rt()),n=pu({head:!1}),t.push(n);return r(u,f.createTemplateLiteral(t,i))}function ao(){var n,t,u;return h("("),++e.parenthesizedCount,t=v(),n=rt(),i(":")&&(u=pt(),n=r(t,f.createTypeCast(n,u))),h(")"),n}function wu(){var n;return gi()&&(n=st(),n.type===s.Keyword&&n.value==="function")?!0:!1}function bu(){var n,t,u,e;if(t=a.type,t===s.Identifier)return n=v(),r(n,f.createIdentifier(y().value));if(t===s.StringLiteral||t===s.NumericLiteral)return k&&a.octal&&tt(a,o.StrictOctalLiteral),n=v(),r(n,f.createLiteral(y()));if(t===s.Keyword){if(g("this"))return n=v(),y(),r(n,f.createThisExpression());if(g("function"))return ou();if(g("class"))return wf();if(g("super"))return n=v(),y(),r(n,f.createIdentifier("super"))}if(t===s.BooleanLiteral)return n=v(),u=y(),u.value=u.value==="true",r(n,f.createLiteral(u));if(t===s.NullLiteral)return n=v(),u=y(),u.value=null,r(n,f.createLiteral(u));if(i("["))return or();if(i("{"))return sr();if(i("("))return ao();if(i("/")||i("/="))return n=v(),e=f.createLiteral(kt()),fr(),r(n,e);if(t===s.Template)return dr();if(i("<"))return su();ut(y())}function ku(){var r=[],n;if(h("("),!i(")"))while(t<d){if(n=gr(),r.push(n),i(")"))break;else n.type===u.SpreadElement&&p({},o.ElementAfterSpreadElement);h(",")}return h(")"),r}function gr(){if(i("...")){var n=v();return y(),r(n,f.createSpreadElement(et()))}return et()}function yi(){var t=v(),n=y();return br(n)||ut(n),r(t,f.createIdentifier(n.value))}function du(){return h("."),yi()}function gu(){var n;return h("["),n=rt(),h("]"),n}function nf(){var n,t,u=v();return nt("new"),n=vo(),t=i("(")?ku():[],r(u,f.createNewExpression(n,t))}function nu(){for(var u,t=v(),n=g("new")?nf():bu();i(".")||i("[")||i("(")||a.type===s.Template;)i("(")?(u=ku(),n=r(t,f.createCallExpression(n,u))):n=i("[")?r(t,f.createMemberExpression("[",n,gu())):i(".")?r(t,f.createMemberExpression(".",n,du())):r(t,f.createTaggedTemplateExpression(n,dr()));return n}function vo(){for(var t=v(),n=g("new")?nf():bu();i(".")||i("[")||a.type===s.Template;)n=i("[")?r(t,f.createMemberExpression("[",n,gu())):i(".")?r(t,f.createMemberExpression(".",n,du())):r(t,f.createTaggedTemplateExpression(n,dr()));return n}function tf(){var e=v(),n=nu(),t;return a.type!==s.Punctuator?n:((i("++")||i("--"))&&!ai()&&(k&&n.type===u.Identifier&&lt(n.name)&&tt({},o.StrictLHSPostfix),er(n)||p({},o.InvalidLHSInAssignment),t=y(),n=r(e,f.createPostfixExpression(t.value,n))),n)}function pi(){var t,e,n;return a.type!==s.Punctuator&&a.type!==s.Keyword?tf():i("++")||i("--")?(t=v(),e=y(),n=pi(),k&&n.type===u.Identifier&&lt(n.name)&&tt({},o.StrictLHSPrefix),er(n)||p({},o.InvalidLHSInAssignment),r(t,f.createUnaryExpression(e.value,n))):i("+")||i("-")||i("~")||i("!")?(t=v(),e=y(),n=pi(),r(t,f.createUnaryExpression(e.value,n))):g("delete")||g("void")||g("typeof")?(t=v(),e=y(),n=pi(),n=r(t,f.createUnaryExpression(e.value,n)),k&&n.operator==="delete"&&n.argument.type===u.Identifier&&tt({},o.StrictDelete),n):tf()}function rf(n,t){var i=0;if(n.type!==s.Punctuator&&n.type!==s.Keyword)return 0;switch(n.value){case"||":i=1;break;case"&&":i=2;break;case"|":i=3;break;case"^":i=4;break;case"&":i=5;break;case"==":case"!=":case"===":case"!==":i=6;break;case"<":case">":case"<=":case">=":case"instanceof":i=7;break;case"in":i=t?7:0;break;case"<<":case">>":case">>>":i=8;break;case"+":case"-":i=9;break;case"*":case"/":case"%":i=11}return i}function yo(){var t,i,s,l,n,p,w,c,h,u,o;if(l=e.allowIn,e.allowIn=!0,u=v(),c=pi(),i=a,s=rf(i,l),s===0)return c;for(i.prec=s,y(),o=[u,v()],p=pi(),n=[c,i,p];(s=rf(a,l))>0;){while(n.length>2&&s<=n[n.length-2].prec)p=n.pop(),w=n.pop().value,c=n.pop(),t=f.createBinaryExpression(w,c,p),o.pop(),u=o.pop(),r(u,t),n.push(t),o.push(u);i=y();i.prec=s;n.push(i);o.push(v());t=pi();n.push(t)}for(e.allowIn=l,h=n.length-1,t=n[h],o.pop();h>1;)t=f.createBinaryExpression(n[h-1].value,n[h-2],t),h-=2,u=o.pop(),r(u,t);return t}function uf(){var n,t,u,o,s=v();return n=yo(),i("?")&&(y(),t=e.allowIn,e.allowIn=!0,u=et(),e.allowIn=t,h(":"),o=et(),n=r(s,f.createConditionalExpression(n,u,o))),n}function oi(n){var t,i,r,f;if(n.type===u.ObjectExpression)for(n.type=u.ObjectPattern,t=0,i=n.properties.length;t<i;t+=1)r=n.properties[t],r.type===u.SpreadProperty?(t<i-1&&p({},o.PropertyAfterSpreadProperty),oi(r.argument)):(r.kind!=="init"&&p({},o.InvalidLHSInAssignment),oi(r.value));else if(n.type===u.ArrayExpression)for(n.type=u.ArrayPattern,t=0,i=n.elements.length;t<i;t+=1)f=n.elements[t],f&&oi(f);else n.type===u.Identifier?lt(n.name)&&p({},o.InvalidLHSInAssignment):n.type===u.SpreadElement?(oi(n.argument),n.argument.type===u.ObjectPattern&&p({},o.ObjectPatternAsSpread)):n.type!==u.MemberExpression&&n.type!==u.CallExpression&&n.type!==u.NewExpression&&p({},o.InvalidLHSInAssignment)}function si(n,t){var i,r,f,e;if(t.type===u.ObjectExpression)for(t.type=u.ObjectPattern,i=0,r=t.properties.length;i<r;i+=1)f=t.properties[i],f.type===u.SpreadProperty?(i<r-1&&p({},o.PropertyAfterSpreadProperty),si(n,f.argument)):(f.kind!=="init"&&p({},o.InvalidLHSInFormalsList),si(n,f.value));else if(t.type===u.ArrayExpression)for(t.type=u.ArrayPattern,i=0,r=t.elements.length;i<r;i+=1)e=t.elements[i],e&&si(n,e);else t.type===u.Identifier?ir(n,t,t.name):t.type===u.SpreadElement?(t.argument.type!==u.Identifier&&p({},o.InvalidLHSInFormalsList),ir(n,t.argument,t.argument.name)):p({},o.InvalidLHSInFormalsList)}function tu(n){var f,s,t,e,r,h,i,c;for(e=[],r=[],h=0,c=null,i={paramSet:new vt},f=0,s=n.length;f<s;f+=1)if(t=n[f],t.type===u.Identifier)e.push(t),r.push(null),ir(i,t,t.name);else if(t.type===u.ObjectExpression||t.type===u.ArrayExpression)si(i,t),e.push(t),r.push(null);else if(t.type===u.SpreadElement)ui(f===s-1,"It is guaranteed that SpreadElement is last element by parseExpression"),t.argument.type!==u.Identifier&&p({},o.InvalidLHSInFormalsList),si(i,t.argument),c=t.argument;else if(t.type===u.AssignmentExpression)e.push(t.left),r.push(t.right),++h,ir(i,t.left,t.left.name);else return null;return i.message===o.StrictParamDupe&&p(k?i.stricted:i.firstRestricted,i.message),h===0&&(r=[]),{params:e,defaults:r,rest:c,stricted:i.stricted,firstRestricted:i.firstRestricted,message:i.message}}function ff(n,t){var o,s,c,i;return h("=>"),o=k,s=e.yieldAllowed,e.yieldAllowed=!1,c=e.awaitAllowed,e.awaitAllowed=!!n.async,i=vf(),k&&n.firstRestricted&&p(n.firstRestricted,n.message),k&&n.stricted&&tt(n.stricted,n.message),k=o,e.yieldAllowed=s,e.awaitAllowed=c,r(t,f.createArrowFunctionExpression(n.params,n.defaults,i,n.rest,i.type!==u.BlockStatement,!!n.async))}function et(){var l,n,h,t,w,b=!1,d=a,c=!1;if(eo())return ch();if(oo())return lh();if(w=e.parenthesizedCount,l=v(),wu())return ou();if(gi()&&(c=!0,y()),i("(")){if(h=st(),h.type===s.Punctuator&&h.value===")"||h.value==="...")return t=ar(),i("=>")||ut(y()),t.async=c,ff(t,l);b=!0}return(h=a,c&&!i("(")&&h.type!==s.Identifier&&(c=!1,kr(d)),n=uf(),i("=>")&&(e.parenthesizedCount===w||e.parenthesizedCount===w+1)&&(n.type===u.Identifier?t=tu([n]):n.type===u.AssignmentExpression||n.type===u.ArrayExpression||n.type===u.ObjectExpression?(b||ut(y()),t=tu([n])):n.type===u.SequenceExpression&&(t=tu(n.expressions)),t))?(t.async=c,ff(t,l)):(c&&(c=!1,kr(d),n=uf()),fo()&&(k&&n.type===u.Identifier&&lt(n.name)&&tt(h,o.StrictLHSAssignment),i("=")&&(n.type===u.ObjectExpression||n.type===u.ArrayExpression)?oi(n):er(n)||p({},o.InvalidLHSInAssignment),n=r(l,f.createAssignmentExpression(y().value,n,et()))),n)}function rt(){var s,n,e,h,c;if(s=v(),n=et(),e=[n],i(",")){while(t<d){if(!i(","))break;if(y(),n=gr(),e.push(n),n.type===u.SpreadElement){c=!0;i(")")||p({},o.ElementAfterSpreadElement);break}}h=r(s,f.createSequenceExpression(e))}return c&&st().value!=="=>"&&p({},o.IllegalSpread),h||n}function po(){for(var r=[],n;t<d;){if(i("}"))break;if(n=ci(),typeof n=="undefined")break;r.push(n)}return r}function hr(){var n,t=v();return h("{"),n=po(),h("}"),r(t,f.createBlockStatement(n))}function ht(){var t=v(),n=[];for(h("<");!i(">");)n.push(hi()),i(">")||h(",");return h(">"),r(t,f.createTypeParameterDeclaration(n))}function tr(){var t=v(),u=e.inType,n=[];for(e.inType=!0,h("<");!i(">");)n.push(at()),i(">")||h(",");return h(">"),e.inType=u,r(t,f.createTypeParameterInstantiation(n))}function wo(n,t){var i,u,e;return h("["),i=yt(),h(":"),u=at(),h("]"),h(":"),e=at(),r(n,f.createObjectTypeIndexer(i,u,e,t))}function ef(n){var t=[],u=null,e,o=null;for(i("<")&&(o=ht()),h("(");a.type===s.Identifier;)t.push(cr()),i(")")||h(",");return i("...")&&(y(),u=cr()),h(")"),h(":"),e=at(),r(n,f.createFunctionTypeAnnotation(t,e,u,o))}function bo(n,t,i){var u;return u=ef(n),r(n,f.createObjectTypeProperty(i,u,!1,t))}function ko(n,t){var i=v();return r(n,f.createObjectTypeCallProperty(ef(i),t))}function of(n){var l=[],p=[],t,w=!1,s=[],e,b,c,u,d;for(h("{");!i("}");)t=v(),d=k?g("static"):it("static"),n&&d&&(c=y(),u=!0),i("[")?p.push(wo(t,u)):i("(")||i("<")?l.push(ko(t,n)):(u&&i(":")?(e=r(t,f.createIdentifier(c)),tt(c,o.StrictReservedWord)):e=yt(),i("<")||i("(")?s.push(bo(t,u,e)):(i("?")&&(y(),w=!0),h(":"),b=at(),s.push(r(t,f.createObjectTypeProperty(e,b,w,u))))),i(";")?y():i("}")||ut(a);return h("}"),f.createObjectTypeAnnotation(s,p,l)}function go(){for(var t=v(),u=null,n=ot();i(".");)h("."),n=r(t,f.createQualifiedTypeIdentifier(n,ot()));return i("<")&&(u=tr()),r(t,f.createGenericTypeAnnotation(n,u))}function ns(){var n=v();return nt("void"),r(n,f.createVoidTypeAnnotation())}function ts(){var n,t=v();return nt("typeof"),n=sf(),r(t,f.createTypeofTypeAnnotation(n))}function is(){var u=v(),n=[];for(h("[");t<d&&!i("]");){if(n.push(at()),i("]"))break;h(",")}return h("]"),r(u,f.createTupleTypeAnnotation(n))}function cr(){var e=v(),n,t=!1,u;return n=ot(),i("?")&&(y(),t=!0),h(":"),u=at(),r(e,f.createFunctionTypeParam(n,u,t))}function iu(){for(var n={params:[],rest:null};a.type===s.Identifier;)n.params.push(cr()),i(")")||h(",");return i("...")&&(y(),n.rest=cr()),n}function sf(){var e=null,c=null,n=v(),l=null,u,b,t,k,w=!1;switch(a.type){case s.Identifier:switch(a.value){case"any":return y(),r(n,f.createAnyTypeAnnotation());case"bool":case"boolean":return y(),r(n,f.createBooleanTypeAnnotation());case"number":return y(),r(n,f.createNumberTypeAnnotation());case"string":return y(),r(n,f.createStringTypeAnnotation())}return r(n,go());case s.Punctuator:switch(a.value){case"{":return r(n,of());case"[":return is();case"<":return b=ht(),h("("),u=iu(),e=u.params,l=u.rest,h(")"),h("=>"),c=at(),r(n,f.createFunctionTypeAnnotation(e,c,l,b));case"(":return(y(),i(")")||i("...")||(a.type===s.Identifier?(t=st(),w=t.value!=="?"&&t.value!==":"):w=!0),w)?(k=at(),h(")"),i("=>")&&p({},o.ConfusedAboutFunctionType),k):(u=iu(),e=u.params,l=u.rest,h(")"),h("=>"),c=at(),r(n,f.createFunctionTypeAnnotation(e,c,l,null)))}break;case s.Keyword:switch(a.value){case"void":return r(n,ns());case"typeof":return r(n,ts())}break;case s.StringLiteral:return t=y(),t.octal&&p(t,o.StrictOctalLiteral),r(n,f.createStringLiteralTypeAnnotation(t))}ut(a)}function rs(){var t=v(),n=sf();return i("[")?(h("["),h("]"),r(t,f.createArrayTypeAnnotation(n))):n}function ru(){var n=v();return i("?")?(y(),r(n,f.createNullableTypeAnnotation(ru()))):rs()}function hf(){for(var u=v(),t=ru(),n=[t];i("&");)y(),n.push(ru());return n.length===1?t:r(u,f.createIntersectionTypeAnnotation(n))}function us(){for(var u=v(),t=hf(),n=[t];i("|");)y(),n.push(hf());return n.length===1?t:r(u,f.createUnionTypeAnnotation(n))}function at(){var t=e.inType,n;return e.inType=!0,n=us(),e.inType=t,n}function pt(){var t=v(),n;return h(":"),n=at(),r(t,f.createTypeAnnotation(n))}function ot(){var t=v(),n=y();return n.type!==s.Identifier&&ut(n),r(t,f.createIdentifier(n.value))}function hi(n,t){var f=v(),u=ot(),e=!1;return t&&i("?")&&(h("?"),e=!0),(n||i(":"))&&(u.typeAnnotation=pt(),u=r(f,u)),e&&(u.optional=!0,u=r(f,u)),u}function fs(n){var t,c=v(),u=null,s=v();return i("{")?(t=sr(),oi(t),i(":")&&(t.typeAnnotation=pt(),r(s,t))):i("[")?(t=or(),oi(t),i(":")&&(t.typeAnnotation=pt(),r(s,t))):(t=e.allowKeyword?yi():hi(),k&&lt(t.name)&&tt({},o.StrictVarName)),n==="const"?(i("=")||p({},o.NoUninitializedConst),h("="),u=et()):i("=")&&(y(),u=et()),r(c,f.createVariableDeclarator(t,u))}function uu(n){var r=[];do{if(r.push(fs(n)),!i(","))break;y()}while(t<d);return r}function es(){var n,t=v();return nt("var"),n=uu(),ft(),r(t,f.createVariableDeclaration(n,"var"))}function os(n){var t,i=v();return nt(n),t=uu(n),ft(),r(i,f.createVariableDeclaration(t,n))}function lr(){var t=v(),n;return a.type!==s.StringLiteral&&p({},o.InvalidModuleSpecifier),n=f.createModuleSpecifier(a),y(),r(t,n)}function ss(){var n=v();return h("*"),r(n,f.createExportBatchSpecifier())}function hs(){var n,t=null,i=v();return g("default")?(y(),n=r(i,f.createIdentifier("default"))):n=ot(),it("as")&&(y(),t=yi()),r(i,f.createExportSpecifier(n,t))}function cf(){var e=null,w,c,l,u=null,t=[],n=v();if(nt("export"),g("default")){if(y(),g("function")||g("class")){if(w=st(),br(w))return c=ci(),r(n,f.createExportDeclaration(!0,c,[c.id],null));switch(a.value){case"class":return r(n,f.createExportDeclaration(!0,wf(),[],null));case"function":return r(n,f.createExportDeclaration(!0,ou(),[],null))}}return it("from")&&p({},o.UnexpectedToken,a.value),e=i("{")?sr():i("[")?or():et(),ft(),r(n,f.createExportDeclaration(!0,e,[],null))}if(a.type===s.Keyword||it("type"))switch(a.value){case"type":case"let":case"const":case"var":case"class":case"function":return r(n,f.createExportDeclaration(!1,ci(),t,null))}if(i("*"))return t.push(ss()),it("from")||p({},a.value?o.UnexpectedToken:o.MissingFromClause,a.value),y(),u=lr(),ft(),r(n,f.createExportDeclaration(!1,null,t,u));if(h("{"),!i("}"))do l=l||g("default"),t.push(hs());while(i(",")&&y());return h("}"),it("from")?(y(),u=lr(),ft()):l?p({},a.value?o.UnexpectedToken:o.MissingFromClause,a.value):ft(),r(n,f.createExportDeclaration(!1,e,t,u))}function cs(){var n,t=null,i=v();return n=yi(),it("as")&&(y(),t=ot()),r(i,f.createImportSpecifier(n,t))}function ls(){var n=[];if(h("{"),!i("}"))do n.push(cs());while(i(",")&&y());return h("}"),n}function as(){var n,t=v();return n=yi(),r(t,f.createImportDefaultSpecifier(n))}function vs(){var n,t=v();return h("*"),it("as")||p({},o.NoAsAfterImportNamespace),y(),n=yi(),r(t,f.createImportNamespaceSpecifier(n))}function lf(){var n,u,h=v(),e=!1,t;return(nt("import"),it("type")&&(t=st(),(t.type===s.Identifier&&t.value!=="from"||t.type===s.Punctuator&&(t.value==="{"||t.value==="*"))&&(e=!0,y())),n=[],a.type===s.StringLiteral)?(u=lr(),ft(),r(h,f.createImportDeclaration(n,u,e))):(!g("default")&&br(a)&&(n.push(as()),i(",")&&y()),i("*")?n.push(vs()):i("{")&&(n=n.concat(ls())),it("from")||p({},a.value?o.UnexpectedToken:o.MissingFromClause,a.value),y(),u=lr(),ft(),r(h,f.createImportDeclaration(n,u,e)))}function ys(){var n=v();return h(";"),r(n,f.createEmptyStatement())}function ps(){var n=v(),t=rt();return ft(),r(n,f.createExpressionStatement(t))}function ws(){var t,i,n,u=v();return nt("if"),h("("),t=rt(),h(")"),i=dt(),g("else")?(y(),n=dt()):n=null,r(u,f.createIfStatement(t,i,n))}function bs(){var n,t,u,o=v();return nt("do"),u=e.inIteration,e.inIteration=!0,n=dt(),e.inIteration=u,nt("while"),h("("),t=rt(),h(")"),i(";")&&y(),r(o,f.createDoWhileStatement(n,t))}function ks(){var n,t,i,u=v();return nt("while"),h("("),n=rt(),h(")"),i=e.inIteration,e.inIteration=!0,t=dt(),e.inIteration=i,r(u,f.createWhileStatement(n,t))}function ds(){var n=v(),t=y(),i=uu();return r(n,f.createVariableDeclaration(i,t.value))}function af(n){var t,w,b,u,s,l,c,d,k=v();return(t=w=b=null,nt("for"),it("each")&&p({},o.EachNotAllowed),h("("),i(";")?y():(g("var")||g("let")||g("const")?(e.allowIn=!1,t=ds(),e.allowIn=!0,t.declarations.length===1&&(g("in")||it("of"))&&(c=a,(c.value==="in"||t.kind!=="var")&&t.declarations[0].init||(y(),u=t,s=rt(),t=null))):(e.allowIn=!1,t=rt(),e.allowIn=!0,it("of")?(c=y(),u=t,s=rt(),t=null):g("in")&&(so(t)||p({},o.InvalidLHSInForIn),c=y(),u=t,s=rt(),t=null)),typeof u=="undefined"&&h(";")),typeof u=="undefined"&&(i(";")||(w=rt()),h(";"),i(")")||(b=rt())),h(")"),d=e.inIteration,e.inIteration=!0,n!==undefined&&n.ignoreBody||(l=dt()),e.inIteration=d,typeof u=="undefined")?r(k,f.createForStatement(t,w,b,l)):c.value==="in"?r(k,f.createForInStatement(u,s,l)):r(k,f.createForOfStatement(u,s,l))}function gs(){var n=null,i=v();return(nt("continue"),l.charCodeAt(t)===59)?(y(),e.inIteration||p({},o.IllegalContinue),r(i,f.createContinueStatement(null))):ai()?(e.inIteration||p({},o.IllegalContinue),r(i,f.createContinueStatement(null))):(a.type===s.Identifier&&(n=ot(),e.labelSet.has(n.name)||p({},o.UnknownLabel,n.name)),ft(),n!==null||e.inIteration||p({},o.IllegalContinue),r(i,f.createContinueStatement(n)))}function nh(){var n=null,i=v();return(nt("break"),l.charCodeAt(t)===59)?(y(),e.inIteration||e.inSwitch||p({},o.IllegalBreak),r(i,f.createBreakStatement(null))):ai()?(e.inIteration||e.inSwitch||p({},o.IllegalBreak),r(i,f.createBreakStatement(null))):(a.type===s.Identifier&&(n=ot(),e.labelSet.has(n.name)||p({},o.UnknownLabel,n.name)),ft(),n!==null||e.inIteration||e.inSwitch||p({},o.IllegalBreak),r(i,f.createBreakStatement(n)))}function th(){var n=null,u=v();return(nt("return"),e.inFunctionBody||tt({},o.IllegalReturn),l.charCodeAt(t)===32&&fi(l.charCodeAt(t+1)))?(n=rt(),ft(),r(u,f.createReturnStatement(n))):ai()?r(u,f.createReturnStatement(null)):(i(";")||i("}")||a.type===s.EOF||(n=rt()),ft(),r(u,f.createReturnStatement(n)))}function ih(){var n,t,i=v();return k&&tt({},o.StrictModeWith),nt("with"),h("("),n=rt(),h(")"),t=dt(),r(i,f.createWithStatement(n,t))}function rh(){var n,e=[],u,o=v();for(g("default")?(y(),n=null):(nt("case"),n=rt()),h(":");t<d;){if(i("}")||g("default")||g("case"))break;if(u=ci(),typeof u=="undefined")break;e.push(u)}return r(o,f.createSwitchCase(n,e))}function uh(){var u,n,s,l,c,a=v();if(nt("switch"),h("("),u=rt(),h(")"),h("{"),n=[],i("}"))return y(),r(a,f.createSwitchStatement(u,n));for(l=e.inSwitch,e.inSwitch=!0,c=!1;t<d;){if(i("}"))break;s=rh();s.test===null&&(c&&p({},o.MultipleDefaultsInSwitch),c=!0);n.push(s)}return e.inSwitch=l,h("}"),r(a,f.createSwitchStatement(u,n))}function fh(){var n,t=v();return nt("throw"),ai()&&p({},o.NewlineAfterThrow),n=rt(),ft(),r(t,f.createThrowStatement(n))}function eh(){var n,t,e=v();return nt("catch"),h("("),i(")")&&ut(a),n=rt(),k&&n.type===u.Identifier&&lt(n.name)&&tt({},o.StrictCatchVariable),h(")"),t=hr(),r(e,f.createCatchClause(n,t))}function oh(){var i,n=[],t=null,u=v();return nt("try"),i=hr(),g("catch")&&n.push(eh()),g("finally")&&(y(),t=hr()),n.length!==0||t||p({},o.NoCatchOrFinally),r(u,f.createTryStatement(i,[],n,t))}function sh(){var n=v();return nt("debugger"),ft(),r(n,f.createDebuggerStatement())}function dt(){var t=a.type,h,n,c;if(t===s.EOF&&ut(a),t===s.Punctuator)switch(a.value){case";":return ys();case"{":return hr();case"(":return ps()}if(t===s.Keyword)switch(a.value){case"break":return nh();case"continue":return gs();case"debugger":return sh();case"do":return bs();case"for":return af();case"function":return eu();case"class":return wh();case"if":return ws();case"return":return th();case"switch":return uh();case"throw":return fh();case"try":return oh();case"var":return es();case"while":return ks();case"with":return ih()}return wu()?eu():(h=v(),n=rt(),n.type===u.Identifier&&i(":"))?(y(),e.labelSet.has(n.name)&&p({},o.Redeclaration,"Label",n.name),e.labelSet.set(n.name,!0),c=dt(),e.labelSet["delete"](n.name),r(h,f.createLabeledStatement(n,c))):(ft(),r(h,f.createExpressionStatement(n)))}function vf(){return i("{")?fu():et()}function fu(){var n,p=[],c,w,y,b,g,nt,it,rt,ut=v();for(h("{");t<d;){if(a.type!==s.StringLiteral)break;if(c=a,n=ci(),p.push(n),n.expression.type!==u.Literal)break;w=l.slice(c.range[0]+1,c.range[1]-1);w==="use strict"?(k=!0,y&&tt(y,o.StrictOctalLiteral)):!y&&c.octal&&(y=c)}for(b=e.labelSet,g=e.inIteration,nt=e.inSwitch,it=e.inFunctionBody,rt=e.parenthesizedCount,e.labelSet=new vt,e.inIteration=!1,e.inSwitch=!1,e.inFunctionBody=!0,e.parenthesizedCount=0;t<d;){if(i("}"))break;if(n=ci(),typeof n=="undefined")break;p.push(n)}return h("}"),e.labelSet=b,e.inIteration=g,e.inSwitch=nt,e.inFunctionBody=it,e.parenthesizedCount=rt,r(ut,f.createBlockStatement(p))}function ir(n,t,i){k?(lt(i)&&(n.stricted=t,n.message=o.StrictParamName),n.paramSet.has(i)&&(n.stricted=t,n.message=o.StrictParamDupe)):n.firstRestricted||(lt(i)?(n.firstRestricted=t,n.message=o.StrictParamName):ki(i)?(n.firstRestricted=t,n.message=o.StrictReservedWord):n.paramSet.has(i)&&(n.firstRestricted=t,n.message=o.StrictParamDupe));n.paramSet.set(i,!0)}function hh(n){var e,u,f,t,s;return(u=a,u.value==="..."&&(u=y(),f=!0),i("[")?(e=v(),t=or(),si(n,t),i(":")&&(t.typeAnnotation=pt(),r(e,t))):i("{")?(e=v(),f&&p({},o.ObjectPatternAsRestParameter),t=sr(),si(n,t),i(":")&&(t.typeAnnotation=pt(),r(e,t))):(t=f?hi(!1,!1):hi(!1,!0),ir(n,u,u.value)),i("=")&&(f&&tt(a,o.DefaultRestParameter),y(),s=et(),++n.defaultCount),f)?(i(")")||p({},o.ParameterAfterRestParameter),n.rest=t,!1):(n.params.push(t),n.defaults.push(s),!i(")"))}function ar(n){var u,f=v();if(u={params:[],defaultCount:0,defaults:[],rest:null,firstRestricted:n},h("("),!i(")"))for(u.paramSet=new vt;t<d;){if(!hh(u))break;h(",")}return h(")"),u.defaultCount===0&&(u.defaults=[]),i(":")&&(u.returnType=pt()),r(f,u)}function eu(){var l,w,t,n,u,s,h,c,b,d,g,rt=v(),it;return c=!1,gi()&&(y(),c=!0),nt("function"),h=!1,i("*")&&(y(),h=!0),t=a,l=ot(),i("<")&&(it=ht()),k?lt(t.value)&&tt(t,o.StrictFunctionName):lt(t.value)?(u=t,s=o.StrictFunctionName):ki(t.value)&&(u=t,s=o.StrictReservedWord),n=ar(u),u=n.firstRestricted,n.message&&(s=n.message),b=k,d=e.yieldAllowed,e.yieldAllowed=h,g=e.awaitAllowed,e.awaitAllowed=c,w=fu(),k&&u&&p(u,s),k&&n.stricted&&tt(n.stricted,s),k=b,e.yieldAllowed=d,e.awaitAllowed=g,r(rt,f.createFunctionDeclaration(l,n.params,n.defaults,w,n.rest,h,!1,c,n.returnType,it))}function ou(){var t,l=null,u,s,n,w,h,c,b,d,g,rt=v(),it;return c=!1,gi()&&(y(),c=!0),nt("function"),h=!1,i("*")&&(y(),h=!0),i("(")||(i("<")||(t=a,l=ot(),k?lt(t.value)&&tt(t,o.StrictFunctionName):lt(t.value)?(u=t,s=o.StrictFunctionName):ki(t.value)&&(u=t,s=o.StrictReservedWord)),i("<")&&(it=ht())),n=ar(u),u=n.firstRestricted,n.message&&(s=n.message),b=k,d=e.yieldAllowed,e.yieldAllowed=h,g=e.awaitAllowed,e.awaitAllowed=c,w=fu(),k&&u&&p(u,s),k&&n.stricted&&tt(n.stricted,s),k=b,e.yieldAllowed=d,e.awaitAllowed=g,r(rt,f.createFunctionExpression(l,n.params,n.defaults,w,n.rest,h,!1,c,n.returnType,it))}function ch(){var n,t,u=v();return nt("yield",!k),n=!1,i("*")&&(y(),n=!0),t=et(),r(u,f.createYieldExpression(t,n))}function lh(){var n,t=v();return ii("await"),n=et(),r(t,f.createAwaitExpression(n))}function ah(n){return n.kind==="get"||n.kind==="set"||n.value.generator}function vh(n,t,r,u){var l,v,e,c,y,o,s;return(e=t?gt["static"]:gt.prototype,r)?f.createMethodDefinition(e,"",n,vi({generator:!0}),u):(o=n.type==="Identifier"&&n.name,o==="get"&&!i("("))?(n=yt(),h("("),h(")"),i(":")&&(s=pt()),f.createMethodDefinition(e,"get",n,nr({generator:!1,returnType:s}),u)):o==="set"&&!i("(")?(n=yt(),h("("),l=a,v=[hi()],h(")"),i(":")&&(s=pt()),f.createMethodDefinition(e,"set",n,nr({params:v,generator:!1,name:l,returnType:s}),u)):(i("<")&&(y=ht()),c=o==="async"&&!i("("),c&&(n=yt()),f.createMethodDefinition(e,"",n,vi({generator:!1,async:c,typeParameters:y}),u))}function yh(n,t,i){var r;return r=pt(),h(";"),f.createClassProperty(n,r,t,i)}function ph(){var t=!1,u=!1,f,o=v(),e=!1,n;return i(";")?(y(),undefined):(a.value==="static"&&(y(),e=!0),i("*")&&(y(),u=!0),n=a,(it("get")||it("set"))&&(n=st()),n.type===s.Punctuator&&n.value==="["&&(t=!0),f=yt(),!u&&a.value===":")?r(o,yh(f,t,e)):r(o,vh(f,e,u,t))}function yf(){var n,c=[],e={},a=v(),s,l;for(e[gt["static"]]=new vt,e[gt.prototype]=new vt,h("{");t<d;){if(i("}"))break;n=ph(e);typeof n!="undefined"&&(c.push(n),s=!n.computed&&lo(n.key),s!==!1&&(l=n["static"]?gt["static"]:gt.prototype,n.type===u.MethodDefinition&&(s!=="constructor"||n["static"]||(ah(n)&&p(n,o.IllegalClassConstructorProperty),e[gt.prototype].has("constructor")&&p(n.key,o.IllegalDuplicateClassProperty)),e[l].set(s,!0))))}return h("}"),r(a,f.createClassBody(c))}function pf(){var n,u=[],e,o;for(k?nt("implements"):ii("implements");t<d;){if(e=v(),n=ot(),o=i("<")?tr():null,u.push(r(e,f.createClassImplements(n,o))),!i(","))break;h(",")}return u}function wf(){var n,t,u,o=null,s,l=v(),h,c;return nt("class"),c=k?g("implements"):it("implements"),g("extends")||c||i("{")||(n=ot()),i("<")&&(h=ht()),g("extends")&&(nt("extends"),u=e.yieldAllowed,e.yieldAllowed=!1,o=nu(),i("<")&&(s=tr()),e.yieldAllowed=u),(k?g("implements"):it("implements"))&&(t=pf()),r(l,f.createClassExpression(n,o,yf(),h,s,t))}function wh(){var n,t,u,o=null,s,c=v(),h;return nt("class"),n=ot(),i("<")&&(h=ht()),g("extends")&&(nt("extends"),u=e.yieldAllowed,e.yieldAllowed=!1,o=nu(),i("<")&&(s=tr()),e.yieldAllowed=u),(k?g("implements"):it("implements"))&&(t=pf()),r(c,f.createClassDeclaration(n,o,yf(),h,s,t))}function ci(){var n;if(a.type===s.Keyword)switch(a.value){case"const":case"let":return os(a.value);case"function":return eu();case"export":return tt({},o.IllegalExportDeclaration),cf();case"import":return tt({},o.IllegalImportDeclaration),lf();case"interface":return st().type===s.Identifier?ie():dt();default:return dt()}if(it("type")&&st().type===s.Identifier)return vc();if(it("interface")&&st().type===s.Identifier)return ie();if(it("declare"))if(n=st(),n.type===s.Keyword)switch(n.value){case"class":return re();case"function":return ue();case"var":return fe()}else if(n.type===s.Identifier&&n.value==="module")return pc();if(a.type!==s.EOF)return dt()}function bf(){var n=c.sourceType==="module"||c.sourceType==="nonStrictModule";if(n&&a.type===s.Keyword)switch(a.value){case"export":return cf();case"import":return lf()}return ci()}function bh(){for(var n,f=[],i,e,r;t<d;){if(i=a,i.type!==s.StringLiteral)break;if(n=bf(),f.push(n),n.expression.type!==u.Literal)break;e=l.slice(i.range[0]+1,i.range[1]-1);e==="use strict"?(k=!0,r&&tt(r,o.StrictOctalLiteral)):!r&&i.octal&&(r=i)}while(t<d){if(n=bf(),typeof n=="undefined")break;f.push(n)}return f}function kh(){var n,t=v();return k=c.sourceType==="module",fr(),n=bh(),r(t,f.createProgram(n))}function rr(n){if(n.type===u.JSXIdentifier)return n.name;if(n.type===u.JSXNamespacedName)return n.namespace.name+":"+n.name.name;if(n.type===u.JSXMemberExpression)return rr(n.object)+"."+rr(n.property);ut(n)}function dh(n){return n!==92&&fi(n)}function gh(n){return n!==92&&(n===45||bi(n))}function nc(){for(var n,r="",i=t;t<d;){if(n=l.charCodeAt(t),!gh(n))break;r+=l[t++]}return{type:s.JSXIdentifier,value:r,lineNumber:w,lineStart:b,range:[i,t]}}function tc(){var i,n="",u=t,f=0,r;for(i=l[t],ui(i==="&","Entity must start with an ampersand"),t++;t<d&&f++<10;){if(i=l[t++],i===";")break;n+=i}if(i===";")if(n[0]==="#"){if(r=n[1]==="x"?+("0"+n.substr(1)):+n.substr(1).replace(ur.LeadingZeros,""),!isNaN(r))return String.fromCharCode(r)}else if(yr[n])return yr[n];return t=u+1,"&"}function kf(n){for(var i,r="",u=t;t<d;){if(i=l[t],n.indexOf(i)!==-1)break;i==="&"?r+=tc():(t++,i==="\r"&&l[t]==="\n"&&(r+=i,i=l[t],t++),bt(i.charCodeAt(0))&&(++w,b=t),r+=i)}return{type:s.JSXText,value:r,lineNumber:w,lineStart:b,range:[u,t]}}function ic(){var i,n,r;return n=l[t],ui(n==="'"||n==='"',"String literal must starts with a quote"),r=t,++t,i=kf([n]),n!==l[t]&&p({},o.UnexpectedToken,"ILLEGAL"),++t,i.range=[r,t],i}function rc(){var n=l.charCodeAt(t);return n!==60&&n!==62&&n!==123&&n!==125?kf(["<",">","{","}"]):ti()}function wi(){var n,t=v();return a.type!==s.JSXIdentifier&&ut(a),n=y(),r(t,f.createJSXIdentifier(n.value))}function df(){var n,t,i=v();return n=wi(),h(":"),t=wi(),r(i,f.createJSXNamespacedName(n,t))}function uc(){for(var t=v(),n=wi();i(".");)y(),n=r(t,f.createJSXMemberExpression(n,wi()));return n}function gf(){return st().value===":"?df():st().value==="."?uc():wi()}function fc(){return st().value===":"?df():wi()}function ec(){var n,t;return i("{")?(n=ne(),n.expression.type===u.JSXEmptyExpression&&p(n,"JSX attributes must only be assigned a non-empty expression")):i("<")?n=su():a.type===s.JSXText?(t=v(),n=r(t,f.createLiteral(y()))):p({},o.InvalidJSXAttributeValue),n}function oc(){for(var n=yu();l.charAt(t)!=="}";)t++;return r(n,f.createJSXEmptyExpression())}function ne(){var n,t,u,o=v();return t=e.inJSXChild,u=e.inJSXTag,e.inJSXChild=!1,e.inJSXTag=!1,h("{"),n=i("}")?oc():rt(),e.inJSXChild=t,e.inJSXTag=u,h("}"),r(o,f.createJSXExpressionContainer(n))}function sc(){var n,t,i,u=v();return t=e.inJSXChild,i=e.inJSXTag,e.inJSXChild=!1,e.inJSXTag=!1,h("{"),h("..."),n=et(),e.inJSXChild=t,e.inJSXTag=i,h("}"),r(u,f.createJSXSpreadAttribute(n))}function hc(){var n,t;return i("{")?sc():(t=v(),n=fc(),i("="))?(y(),r(t,f.createJSXAttribute(n,ec()))):r(t,f.createJSXAttribute(n))}function cc(){var n,t;return i("{")?n=ne():a.type===s.JSXText?(t=yu(),n=r(t,f.createLiteral(y()))):i("<")?n=su():ut(a),n}function lc(){var n,t,i,u=v();return t=e.inJSXChild,i=e.inJSXTag,e.inJSXChild=!1,e.inJSXTag=!0,h("<"),h("/"),n=gf(),e.inJSXChild=t,e.inJSXTag=i,h(">"),r(u,f.createJSXClosingElement(n))}function ac(){var n,i=[],u=!1,o,s,c=v();for(o=e.inJSXChild,s=e.inJSXTag,e.inJSXChild=!1,e.inJSXTag=!0,h("<"),n=gf();t<d&&a.value!=="/"&&a.value!==">";)i.push(hc());return e.inJSXTag=s,a.value==="/"?(h("/"),e.inJSXChild=o,h(">"),u=!0):(e.inJSXChild=!0,h(">")),r(c,f.createJSXOpeningElement(n,i,u))}function su(){var n,u=null,h=[],s,c,l=v();if(s=e.inJSXChild,c=e.inJSXTag,n=ac(),!n.selfClosing){while(t<d){if(e.inJSXChild=!1,a.value==="<"&&st().value==="/")break;e.inJSXChild=!0;h.push(cc())}e.inJSXChild=s;e.inJSXTag=c;u=lc();rr(u.name)!==rr(n.name)&&p({},o.ExpectedJSXClosingTag,rr(n.name))}return!s&&i("<")&&p(a,o.AdjacentJSXElements),r(l,f.createJSXElement(n,u,h))}function vc(){var n,e=v(),t=null,u;return ii("type"),n=ot(),i("<")&&(t=ht()),h("="),u=at(),ft(),r(e,f.createTypeAlias(n,t,u))}function yc(){var u=v(),n,t=null;return n=ot(),i("<")&&(t=tr()),r(u,f.createInterfaceExtends(n,t))}function te(n,u){var e,o,s=[],c,l=null;if(c=ot(),i("<")&&(l=ht()),g("extends"))for(nt("extends");t<d;){if(s.push(yc()),!i(","))break;h(",")}return o=v(),e=r(o,of(u)),r(n,f.createInterface(c,l,e,s))}function ie(){var n=v();return k?nt("interface"):ii("interface"),te(n,!1)}function re(){var t=v(),n;return ii("declare"),nt("class"),n=te(t,!0),n.type=u.DeclareClass,n}function ue(){var n,e,y=v(),o,s,c,t,l=null,a,u;return ii("declare"),nt("function"),e=v(),n=ot(),u=v(),i("<")&&(l=ht()),h("("),t=iu(),o=t.params,c=t.rest,h(")"),h(":"),s=at(),a=r(u,f.createFunctionTypeAnnotation(o,s,c,l)),n.typeAnnotation=r(u,f.createTypeAnnotation(a)),r(e,n),ft(),r(y,f.createDeclareFunction(n))}function fe(){var n,t=v();return ii("declare"),nt("var"),n=hi(),ft(),r(t,f.createDeclareVariable(n))}function pc(){var n=[],e,u,c,p=v(),l;for(ii("declare"),ii("module"),a.type===s.StringLiteral?(k&&a.octal&&tt(a,o.StrictOctalLiteral),c=v(),u=r(c,f.createLiteral(y()))):u=ot(),e=v(),h("{");t<d&&!i("}");){l=st();switch(l.value){case"class":n.push(re());break;case"function":n.push(ue());break;case"var":n.push(fe());break;default:ut(a)}}return h("}"),r(p,f.createDeclareModule(u,r(e,f.createBlockStatement(n))))}function wc(){var i,n,u,f,r;return e.inJSXChild||ei(),i={start:{line:w,column:t-b}},n=c.advance(),i.end={line:w,column:t-b},n.type!==s.EOF&&(u=[n.range[0],n.range[1]],f=l.slice(n.range[0],n.range[1]),r={type:ct[n.type],value:f,range:u,loc:i},n.regex&&(r.regex={pattern:n.regex.pattern,flags:n.regex.flags}),c.tokens.push(r)),n}function bc(){var r,u,i,n;return ei(),r=t,u={start:{line:w,column:t-b}},i=c.scanRegExp(),u.end={line:w,column:t-b},c.tokenize||(c.tokens.length>0&&(n=c.tokens[c.tokens.length-1],n.range[0]===r&&n.type==="Punctuator"&&(n.value==="/"||n.value==="/=")&&c.tokens.pop()),c.tokens.push({type:"RegularExpression",value:i.literal,regex:i.regex,range:[r,t],loc:u})),i}function ee(){for(var n,t,r=[],i=0;i<c.tokens.length;++i)n=c.tokens[i],t={type:n.type,value:n.value},n.regex&&(t.regex={pattern:n.regex.pattern,flags:n.regex.flags}),c.range&&(t.range=n.range),c.loc&&(t.loc=n.loc),r.push(t);c.tokens=r}function oe(){typeof c.tokens!="undefined"&&(c.advance=li,c.scanRegExp=kt,li=wc,kt=bc)}function se(){typeof c.scanRegExp=="function"&&(li=c.advance,kt=c.scanRegExp)}function kc(n,t){var i,r={};for(i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r}function dc(n,i){var o,u,r;o=String;typeof n=="string"||n instanceof String||(n=o(n));f=vr;l=n;t=0;w=l.length>0?1:0;b=0;d=l.length;a=null;e={allowKeyword:!0,allowIn:!0,labelSet:new vt,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};c={};i=i||{};i.tokens=!0;c.tokens=[];c.tokenize=!0;c.openParenToken=-1;c.openCurlyToken=-1;c.range=typeof i.range=="boolean"&&i.range;c.loc=typeof i.loc=="boolean"&&i.loc;typeof i.comment=="boolean"&&i.comment&&(c.comments=[]);typeof i.tolerant=="boolean"&&i.tolerant&&(c.errors=[]);oe();try{if(fr(),a.type===s.EOF)return c.tokens;for(u=y();a.type!==s.EOF;)try{u=y()}catch(h){if(u=a,c.errors){c.errors.push(h);break}else throw h;}ee();r=c.tokens;typeof c.comments!="undefined"&&(r.comments=c.comments);typeof c.errors!="undefined"&&(r.errors=c.errors)}catch(v){throw v;}finally{se();c={}}return r}function gc(n,i){var r,u;u=String;typeof n=="string"||n instanceof String||(n=u(n));f=vr;l=n;t=0;w=l.length>0?1:0;b=0;d=l.length;a=null;e={allowKeyword:!1,allowIn:!0,labelSet:new vt,parenthesizedCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,inJSXChild:!1,inJSXTag:!1,inType:!1,lastCommentStart:-1,yieldAllowed:!1,awaitAllowed:!1};c={};typeof i!="undefined"&&(c.range=typeof i.range=="boolean"&&i.range,c.loc=typeof i.loc=="boolean"&&i.loc,c.attachComment=typeof i.attachComment=="boolean"&&i.attachComment,c.loc&&i.source!==null&&i.source!==undefined&&(f=kc(f,{postProcess:function(n){return n.loc.source=u(i.source),n}})),c.sourceType=i.sourceType,typeof i.tokens=="boolean"&&i.tokens&&(c.tokens=[]),typeof i.comment=="boolean"&&i.comment&&(c.comments=[]),typeof i.tolerant=="boolean"&&i.tolerant&&(c.errors=[]),c.attachComment&&(c.range=!0,c.comments=[],c.bottomRightStack=[],c.trailingComments=[],c.leadingComments=[]));oe();try{r=kh();typeof c.comments!="undefined"&&(r.comments=c.comments);typeof c.tokens!="undefined"&&(ee(),r.tokens=c.tokens);typeof c.errors!="undefined"&&(r.errors=c.errors)}catch(o){throw o;}finally{se();c={}}return r}var s,ct,hu,u,ri,o,ur,vr,yr,gt,l,k,t,w,b,d,f,a,e,c;s={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9,Template:10,JSXIdentifier:11,JSXText:12};ct={};ct[s.BooleanLiteral]="Boolean";ct[s.EOF]="<end>";ct[s.Identifier]="Identifier";ct[s.Keyword]="Keyword";ct[s.NullLiteral]="Null";ct[s.NumericLiteral]="Numeric";ct[s.Punctuator]="Punctuator";ct[s.StringLiteral]="String";ct[s.JSXIdentifier]="JSXIdentifier";ct[s.JSXText]="JSXText";ct[s.RegularExpression]="RegularExpression";hu=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="];u={AnyTypeAnnotation:"AnyTypeAnnotation",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrayTypeAnnotation:"ArrayTypeAnnotation",ArrowFunctionExpression:"ArrowFunctionExpression",AssignmentExpression:"AssignmentExpression",BinaryExpression:"BinaryExpression",BlockStatement:"BlockStatement",BooleanTypeAnnotation:"BooleanTypeAnnotation",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ClassImplements:"ClassImplements",ClassProperty:"ClassProperty",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DeclareClass:"DeclareClass",DeclareFunction:"DeclareFunction",DeclareModule:"DeclareModule",DeclareVariable:"DeclareVariable",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExportBatchSpecifier:"ExportBatchSpecifier",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",ForStatement:"ForStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",FunctionTypeAnnotation:"FunctionTypeAnnotation",FunctionTypeParam:"FunctionTypeParam",GenericTypeAnnotation:"GenericTypeAnnotation",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",InterfaceDeclaration:"InterfaceDeclaration",InterfaceExtends:"InterfaceExtends",IntersectionTypeAnnotation:"IntersectionTypeAnnotation",LabeledStatement:"LabeledStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",NullableTypeAnnotation:"NullableTypeAnnotation",NumberTypeAnnotation:"NumberTypeAnnotation",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",ObjectTypeAnnotation:"ObjectTypeAnnotation",ObjectTypeCallProperty:"ObjectTypeCallProperty",ObjectTypeIndexer:"ObjectTypeIndexer",ObjectTypeProperty:"ObjectTypeProperty",Program:"Program",Property:"Property",QualifiedTypeIdentifier:"QualifiedTypeIdentifier",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SpreadProperty:"SpreadProperty",StringLiteralTypeAnnotation:"StringLiteralTypeAnnotation",StringTypeAnnotation:"StringTypeAnnotation",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TupleTypeAnnotation:"TupleTypeAnnotation",TryStatement:"TryStatement",TypeAlias:"TypeAlias",TypeAnnotation:"TypeAnnotation",TypeCastExpression:"TypeCastExpression",TypeofTypeAnnotation:"TypeofTypeAnnotation",TypeParameterDeclaration:"TypeParameterDeclaration",TypeParameterInstantiation:"TypeParameterInstantiation",UnaryExpression:"UnaryExpression",UnionTypeAnnotation:"UnionTypeAnnotation",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",VoidTypeAnnotation:"VoidTypeAnnotation",WhileStatement:"WhileStatement",WithStatement:"WithStatement",JSXIdentifier:"JSXIdentifier",JSXNamespacedName:"JSXNamespacedName",JSXMemberExpression:"JSXMemberExpression",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXElement:"JSXElement",JSXClosingElement:"JSXClosingElement",JSXOpeningElement:"JSXOpeningElement",JSXAttribute:"JSXAttribute",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText",YieldExpression:"YieldExpression",AwaitExpression:"AwaitExpression"};ri={Data:1,Get:2,Set:4};gt={"static":"static",prototype:"prototype"};o={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInFormalsList:"Invalid left-hand side in formals list",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalDuplicateClassProperty:"Illegal duplicate property in class definition",IllegalClassConstructorProperty:"Illegal constructor property in class definition",IllegalReturn:"Illegal return statement",IllegalSpread:"Illegal spread element",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",ParameterAfterRestParameter:"Rest parameter must be final parameter of an argument list",DefaultRestParameter:"Rest parameter can not have a default value",ElementAfterSpreadElement:"Spread must be the final element of an element list",PropertyAfterSpreadProperty:"A rest property must be the final property of an object literal",ObjectPatternAsRestParameter:"Invalid rest parameter",ObjectPatternAsSpread:"Invalid spread argument",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",MissingFromClause:"Missing from clause",NoAsAfterImportNamespace:"Missing as after import *",InvalidModuleSpecifier:"Invalid module specifier",IllegalImportDeclaration:"Illegal import declaration",IllegalExportDeclaration:"Illegal export declaration",NoUninitializedConst:"Const must be initialized",ComprehensionRequiresBlock:"Comprehension must have at least one block",ComprehensionError:"Comprehension Error",EachNotAllowed:"Each is not supported",InvalidJSXAttributeValue:"JSX value should be either an expression or a quoted JSX text",ExpectedJSXClosingTag:"Expected corresponding JSX closing tag for %0",AdjacentJSXElements:"Adjacent JSX elements must be wrapped in an enclosing tag",ConfusedAboutFunctionType:"Unexpected token =>. It looks like you are trying to write a function type, but you ended up writing a grouped type followed by an =>, which is a syntax error. Remember, function type parameters are named so function types look like (name1: type1, name2: type2) => returnType. You probably wrote (type1) => returnType"};ur={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),LeadingZeros:new RegExp("^0+(?!$)")};vt.prototype.get=function(n){return n="$"+n,this.$data[n]};vt.prototype.set=function(n,t){return n="$"+n,this.$data[n]=t,this};vt.prototype.has=function(n){return n="$"+n,Object.prototype.hasOwnProperty.call(this.$data,n)};vt.prototype["delete"]=function(n){return n="$"+n,delete this.$data[n]};vr={name:"SyntaxTree",postProcess:function(n){return n},createArrayExpression:function(n){return{type:u.ArrayExpression,elements:n}},createAssignmentExpression:function(n,t,i){return{type:u.AssignmentExpression,operator:n,left:t,right:i}},createBinaryExpression:function(n,t,i){var r=n==="||"||n==="&&"?u.LogicalExpression:u.BinaryExpression;return{type:r,operator:n,left:t,right:i}},createBlockStatement:function(n){return{type:u.BlockStatement,body:n}},createBreakStatement:function(n){return{type:u.BreakStatement,label:n}},createCallExpression:function(n,t){return{type:u.CallExpression,callee:n,arguments:t}},createCatchClause:function(n,t){return{type:u.CatchClause,param:n,body:t}},createConditionalExpression:function(n,t,i){return{type:u.ConditionalExpression,test:n,consequent:t,alternate:i}},createContinueStatement:function(n){return{type:u.ContinueStatement,label:n}},createDebuggerStatement:function(){return{type:u.DebuggerStatement}},createDoWhileStatement:function(n,t){return{type:u.DoWhileStatement,body:n,test:t}},createEmptyStatement:function(){return{type:u.EmptyStatement}},createExpressionStatement:function(n){return{type:u.ExpressionStatement,expression:n}},createForStatement:function(n,t,i,r){return{type:u.ForStatement,init:n,test:t,update:i,body:r}},createForInStatement:function(n,t,i){return{type:u.ForInStatement,left:n,right:t,body:i,each:!1}},createForOfStatement:function(n,t,i){return{type:u.ForOfStatement,left:n,right:t,body:i}},createFunctionDeclaration:function(n,t,i,r,f,e,o,s,h,c){var l={type:u.FunctionDeclaration,id:n,params:t,defaults:i,body:r,rest:f,generator:e,expression:o,returnType:h,typeParameters:c};return s&&(l.async=!0),l},createFunctionExpression:function(n,t,i,r,f,e,o,s,h,c){var l={type:u.FunctionExpression,id:n,params:t,defaults:i,body:r,rest:f,generator:e,expression:o,returnType:h,typeParameters:c};return s&&(l.async=!0),l},createIdentifier:function(n){return{type:u.Identifier,name:n,typeAnnotation:undefined,optional:undefined}},createTypeAnnotation:function(n){return{type:u.TypeAnnotation,typeAnnotation:n}},createTypeCast:function(n,t){return{type:u.TypeCastExpression,expression:n,typeAnnotation:t}},createFunctionTypeAnnotation:function(n,t,i,r){return{type:u.FunctionTypeAnnotation,params:n,returnType:t,rest:i,typeParameters:r}},createFunctionTypeParam:function(n,t,i){return{type:u.FunctionTypeParam,name:n,typeAnnotation:t,optional:i}},createNullableTypeAnnotation:function(n){return{type:u.NullableTypeAnnotation,typeAnnotation:n}},createArrayTypeAnnotation:function(n){return{type:u.ArrayTypeAnnotation,elementType:n}},createGenericTypeAnnotation:function(n,t){return{type:u.GenericTypeAnnotation,id:n,typeParameters:t}},createQualifiedTypeIdentifier:function(n,t){return{type:u.QualifiedTypeIdentifier,qualification:n,id:t}},createTypeParameterDeclaration:function(n){return{type:u.TypeParameterDeclaration,params:n}},createTypeParameterInstantiation:function(n){return{type:u.TypeParameterInstantiation,params:n}},createAnyTypeAnnotation:function(){return{type:u.AnyTypeAnnotation}},createBooleanTypeAnnotation:function(){return{type:u.BooleanTypeAnnotation}},createNumberTypeAnnotation:function(){return{type:u.NumberTypeAnnotation}},createStringTypeAnnotation:function(){return{type:u.StringTypeAnnotation}},createStringLiteralTypeAnnotation:function(n){return{type:u.StringLiteralTypeAnnotation,value:n.value,raw:l.slice(n.range[0],n.range[1])}},createVoidTypeAnnotation:function(){return{type:u.VoidTypeAnnotation}},createTypeofTypeAnnotation:function(n){return{type:u.TypeofTypeAnnotation,argument:n}},createTupleTypeAnnotation:function(n){return{type:u.TupleTypeAnnotation,types:n}},createObjectTypeAnnotation:function(n,t,i){return{type:u.ObjectTypeAnnotation,properties:n,indexers:t,callProperties:i}},createObjectTypeIndexer:function(n,t,i,r){return{type:u.ObjectTypeIndexer,id:n,key:t,value:i,"static":r}},createObjectTypeCallProperty:function(n,t){return{type:u.ObjectTypeCallProperty,value:n,"static":t}},createObjectTypeProperty:function(n,t,i,r){return{type:u.ObjectTypeProperty,key:n,value:t,optional:i,"static":r}},createUnionTypeAnnotation:function(n){return{type:u.UnionTypeAnnotation,types:n}},createIntersectionTypeAnnotation:function(n){return{type:u.IntersectionTypeAnnotation,types:n}},createTypeAlias:function(n,t,i){return{type:u.TypeAlias,id:n,typeParameters:t,right:i}},createInterface:function(n,t,i,r){return{type:u.InterfaceDeclaration,id:n,typeParameters:t,body:i,"extends":r}},createInterfaceExtends:function(n,t){return{type:u.InterfaceExtends,id:n,typeParameters:t}},createDeclareFunction:function(n){return{type:u.DeclareFunction,id:n}},createDeclareVariable:function(n){return{type:u.DeclareVariable,id:n}},createDeclareModule:function(n,t){return{type:u.DeclareModule,id:n,body:t}},createJSXAttribute:function(n,t){return{type:u.JSXAttribute,name:n,value:t||null}},createJSXSpreadAttribute:function(n){return{type:u.JSXSpreadAttribute,argument:n}},createJSXIdentifier:function(n){return{type:u.JSXIdentifier,name:n}},createJSXNamespacedName:function(n,t){return{type:u.JSXNamespacedName,namespace:n,name:t}},createJSXMemberExpression:function(n,t){return{type:u.JSXMemberExpression,object:n,property:t}},createJSXElement:function(n,t,i){return{type:u.JSXElement,openingElement:n,closingElement:t,children:i}},createJSXEmptyExpression:function(){return{type:u.JSXEmptyExpression}},createJSXExpressionContainer:function(n){return{type:u.JSXExpressionContainer,expression:n}},createJSXOpeningElement:function(n,t,i){return{type:u.JSXOpeningElement,name:n,selfClosing:i,attributes:t}},createJSXClosingElement:function(n){return{type:u.JSXClosingElement,name:n}},createIfStatement:function(n,t,i){return{type:u.IfStatement,test:n,consequent:t,alternate:i}},createLabeledStatement:function(n,t){return{type:u.LabeledStatement,label:n,body:t}},createLiteral:function(n){var t={type:u.Literal,value:n.value,raw:l.slice(n.range[0],n.range[1])};return n.regex&&(t.regex=n.regex),t},createMemberExpression:function(n,t,i){return{type:u.MemberExpression,computed:n==="[",object:t,property:i}},createNewExpression:function(n,t){return{type:u.NewExpression,callee:n,arguments:t}},createObjectExpression:function(n){return{type:u.ObjectExpression,properties:n}},createPostfixExpression:function(n,t){return{type:u.UpdateExpression,operator:n,argument:t,prefix:!1}},createProgram:function(n){return{type:u.Program,body:n}},createProperty:function(n,t,i,r,f,e){return{type:u.Property,key:t,value:i,kind:n,method:r,shorthand:f,computed:e}},createReturnStatement:function(n){return{type:u.ReturnStatement,argument:n}},createSequenceExpression:function(n){return{type:u.SequenceExpression,expressions:n}},createSwitchCase:function(n,t){return{type:u.SwitchCase,test:n,consequent:t}},createSwitchStatement:function(n,t){return{type:u.SwitchStatement,discriminant:n,cases:t}},createThisExpression:function(){return{type:u.ThisExpression}},createThrowStatement:function(n){return{type:u.ThrowStatement,argument:n}},createTryStatement:function(n,t,i,r){return{type:u.TryStatement,block:n,guardedHandlers:t,handlers:i,finalizer:r}},createUnaryExpression:function(n,t){return n==="++"||n==="--"?{type:u.UpdateExpression,operator:n,argument:t,prefix:!0}:{type:u.UnaryExpression,operator:n,argument:t,prefix:!0}},createVariableDeclaration:function(n,t){return{type:u.VariableDeclaration,declarations:n,kind:t}},createVariableDeclarator:function(n,t){return{type:u.VariableDeclarator,id:n,init:t}},createWhileStatement:function(n,t){return{type:u.WhileStatement,test:n,body:t}},createWithStatement:function(n,t){return{type:u.WithStatement,object:n,body:t}},createTemplateElement:function(n,t){return{type:u.TemplateElement,value:n,tail:t}},createTemplateLiteral:function(n,t){return{type:u.TemplateLiteral,quasis:n,expressions:t}},createSpreadElement:function(n){return{type:u.SpreadElement,argument:n}},createSpreadProperty:function(n){return{type:u.SpreadProperty,argument:n}},createTaggedTemplateExpression:function(n,t){return{type:u.TaggedTemplateExpression,tag:n,quasi:t}},createArrowFunctionExpression:function(n,t,i,r,f,e){var o={type:u.ArrowFunctionExpression,id:null,params:n,defaults:t,body:i,rest:r,generator:!1,expression:f};return e&&(o.async=!0),o},createMethodDefinition:function(n,t,i,r,f){return{type:u.MethodDefinition,key:i,value:r,kind:t,"static":n===gt["static"],computed:f}},createClassProperty:function(n,t,i,r){return{type:u.ClassProperty,key:n,typeAnnotation:t,computed:i,"static":r}},createClassBody:function(n){return{type:u.ClassBody,body:n}},createClassImplements:function(n,t){return{type:u.ClassImplements,id:n,typeParameters:t}},createClassExpression:function(n,t,i,r,f,e){return{type:u.ClassExpression,id:n,superClass:t,body:i,typeParameters:r,superTypeParameters:f,"implements":e}},createClassDeclaration:function(n,t,i,r,f,e){return{type:u.ClassDeclaration,id:n,superClass:t,body:i,typeParameters:r,superTypeParameters:f,"implements":e}},createModuleSpecifier:function(n){return{type:u.ModuleSpecifier,value:n.value,raw:l.slice(n.range[0],n.range[1])}},createExportSpecifier:function(n,t){return{type:u.ExportSpecifier,id:n,name:t}},createExportBatchSpecifier:function(){return{type:u.ExportBatchSpecifier}},createImportDefaultSpecifier:function(n){return{type:u.ImportDefaultSpecifier,id:n}},createImportNamespaceSpecifier:function(n){return{type:u.ImportNamespaceSpecifier,id:n}},createExportDeclaration:function(n,t,i,r){return{type:u.ExportDeclaration,"default":!!n,declaration:t,specifiers:i,source:r}},createImportSpecifier:function(n,t){return{type:u.ImportSpecifier,id:n,name:t}},createImportDeclaration:function(n,t,i){return{type:u.ImportDeclaration,specifiers:n,source:t,isType:i}},createYieldExpression:function(n,t){return{type:u.YieldExpression,argument:n,delegate:t}},createAwaitExpression:function(n){return{type:u.AwaitExpression,argument:n}},createComprehensionExpression:function(n,t,i){return{type:u.ComprehensionExpression,filter:n,blocks:t,body:i}}};yr={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"};n.version="13001.1001.0-dev-harmony-fb";n.tokenize=dc;n.parse=gc;n.Syntax=function(){var n,t={};typeof Object.create=="function"&&(t=Object.create(null));for(n in u)u.hasOwnProperty(n)&&(t[n]=u[n]);return typeof Object.freeze=="function"&&Object.freeze(t),t}()})},{}],10:[function(n,t){var i=function(n){return n.chars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n.encode=function(n){if(n===0)return"0";for(var t="";n>0;)t=this.chars[n%62]+t,n=Math.floor(n/62);return t},n.decode=function(n,t,i,r){for(t=i=(n===(/\W|_|^$/.test(n+="")||n))-1;r=n.charCodeAt(i++);)t=t*62+r-[,48,29,87][r>>5];return t},n}({});t.exports=i},{}],11:[function(n,t,i){i.SourceMapGenerator=n("./source-map/source-map-generator").SourceMapGenerator;i.SourceMapConsumer=n("./source-map/source-map-consumer").SourceMapConsumer;i.SourceNode=n("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":16,"./source-map/source-map-generator":17,"./source-map/source-node":18}],12:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function i(){this._array=[];this._set={}}var r=n("./util");i.fromArray=function(n,t){for(var u=new i,r=0,f=n.length;r<f;r++)u.add(n[r],t);return u};i.prototype.add=function(n,t){var i=this.has(n),u=this._array.length;(!i||t)&&this._array.push(n);i||(this._set[r.toSetString(n)]=u)};i.prototype.has=function(n){return Object.prototype.hasOwnProperty.call(this._set,r.toSetString(n))};i.prototype.indexOf=function(n){if(this.has(n))return this._set[r.toSetString(n)];throw new Error('"'+n+'" is not in the set.');};i.prototype.at=function(n){if(n>=0&&n<this._array.length)return this._array[n];throw new Error("No element indexed by "+n);};i.prototype.toArray=function(){return this._array.slice()};t.ArraySet=i})},{"./util":19,amdefine:20}],13:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function o(n){return n<0?(-n<<1)+1:(n<<1)+0}function s(n){var i=(n&1)==1,t=n>>1;return i?-t:t}var r=n("./base64"),i=5,u=1<<i,f=u-1,e=u;t.encode=function(n){var s="",u,t=o(n);do u=t&f,t>>>=i,t>0&&(u|=e),s+=r.encode(u);while(t>0);return s};t.decode=function(n){var u=0,l=n.length,o=0,h=0,c,t;do{if(u>=l)throw new Error("Expected more digits in base 64 VLQ value.");t=r.decode(n.charAt(u++));c=!!(t&e);t&=f;o=o+(t<<h);h+=i}while(c);return{value:s(o),rest:n.slice(u)}}})},{"./base64":14,amdefine:20}],14:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){var i={},r={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(function(n,t){i[n]=t;r[t]=n});t.encode=function(n){if(n in r)return r[n];throw new TypeError("Must be between 0 and 63: "+n);};t.decode=function(n){if(n in i)return i[n];throw new TypeError("Not a valid base 64 digit: "+n);}})},{amdefine:20}],15:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function i(n,t,r,u,f){var e=Math.floor((t-n)/2)+n,o=f(r,u[e],!0);return o===0?u[e]:o>0?t-e>1?i(e,t,r,u,f):u[e]:e-n>1?i(n,e,r,u,f):n<0?null:u[n]}t.search=function(n,t,r){return t.length>0?i(-1,t.length,n,t,r):null}})},{amdefine:20}],16:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function r(n){var t=n;typeof n=="string"&&(t=JSON.parse(n.replace(/^\)\]\}'/,"")));var r=i.getArg(t,"version"),u=i.getArg(t,"sources"),e=i.getArg(t,"names",[]),o=i.getArg(t,"sourceRoot",null),s=i.getArg(t,"sourcesContent",null),h=i.getArg(t,"mappings"),c=i.getArg(t,"file",null);if(r!=this._version)throw new Error("Unsupported version: "+r);this._names=f.fromArray(e,!0);this._sources=f.fromArray(u,!0);this.sourceRoot=o;this.sourcesContent=s;this._mappings=h;this.file=c}var i=n("./util"),e=n("./binary-search"),f=n("./array-set").ArraySet,u=n("./base64-vlq");r.fromSourceMap=function(n){var t=Object.create(r.prototype);return t._names=f.fromArray(n._names.toArray(),!0),t._sources=f.fromArray(n._sources.toArray(),!0),t.sourceRoot=n._sourceRoot,t.sourcesContent=n._generateSourcesContent(t._sources.toArray(),t.sourceRoot),t.file=n._file,t.__generatedMappings=n._mappings.slice().sort(i.compareByGeneratedPositions),t.__originalMappings=n._mappings.slice().sort(i.compareByOriginalPositions),t};r.prototype._version=3;Object.defineProperty(r.prototype,"sources",{get:function(){return this._sources.toArray().map(function(n){return this.sourceRoot?i.join(this.sourceRoot,n):n},this)}});r.prototype.__generatedMappings=null;Object.defineProperty(r.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}});r.prototype.__originalMappings=null;Object.defineProperty(r.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}});r.prototype._parseMappings=function(n){for(var s=1,o=0,h=0,c=0,l=0,a=0,e=/^[,;]/,t=n,f,r;t.length>0;)if(t.charAt(0)===";")s++,t=t.slice(1),o=0;else if(t.charAt(0)===",")t=t.slice(1);else{if(f={},f.generatedLine=s,r=u.decode(t),f.generatedColumn=o+r.value,o=f.generatedColumn,t=r.rest,t.length>0&&!e.test(t.charAt(0))){if(r=u.decode(t),f.source=this._sources.at(l+r.value),l+=r.value,t=r.rest,t.length===0||e.test(t.charAt(0)))throw new Error("Found a source, but no line and column");if(r=u.decode(t),f.originalLine=h+r.value,h=f.originalLine,f.originalLine+=1,t=r.rest,t.length===0||e.test(t.charAt(0)))throw new Error("Found a source and line, but no column");r=u.decode(t);f.originalColumn=c+r.value;c=f.originalColumn;t=r.rest;t.length>0&&!e.test(t.charAt(0))&&(r=u.decode(t),f.name=this._names.at(a+r.value),a+=r.value,t=r.rest)}this.__generatedMappings.push(f);typeof f.originalLine=="number"&&this.__originalMappings.push(f)}this.__originalMappings.sort(i.compareByOriginalPositions)};r.prototype._findMapping=function(n,t,i,r,u){if(n[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+n[i]);if(n[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+n[r]);return e.search(n,t,u)};r.prototype.originalPositionFor=function(n){var u={generatedLine:i.getArg(n,"line"),generatedColumn:i.getArg(n,"column")},t=this._findMapping(u,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositions),r;return t?(r=i.getArg(t,"source",null),r&&this.sourceRoot&&(r=i.join(this.sourceRoot,r)),{source:r,line:i.getArg(t,"originalLine",null),column:i.getArg(t,"originalColumn",null),name:i.getArg(t,"name",null)}):{source:null,line:null,column:null,name:null}};r.prototype.sourceContentFor=function(n){var t,r;if(!this.sourcesContent)return null;if(this.sourceRoot&&(n=i.relative(this.sourceRoot,n)),this._sources.has(n))return this.sourcesContent[this._sources.indexOf(n)];if(this.sourceRoot&&(t=i.urlParse(this.sourceRoot))){if(r=n.replace(/^file:\/\//,""),t.scheme=="file"&&this._sources.has(r))return this.sourcesContent[this._sources.indexOf(r)];if((!t.path||t.path=="/")&&this._sources.has("/"+n))return this.sourcesContent[this._sources.indexOf("/"+n)]}throw new Error('"'+n+'" is not in the SourceMap.');};r.prototype.generatedPositionFor=function(n){var r={source:i.getArg(n,"source"),originalLine:i.getArg(n,"line"),originalColumn:i.getArg(n,"column")},t;return(this.sourceRoot&&(r.source=i.relative(this.sourceRoot,r.source)),t=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions),t)?{line:i.getArg(t,"generatedLine",null),column:i.getArg(t,"generatedColumn",null)}:{line:null,column:null}};r.GENERATED_ORDER=1;r.ORIGINAL_ORDER=2;r.prototype.eachMapping=function(n,t,u){var o=t||null,s=u||r.GENERATED_ORDER,f,e;switch(s){case r.GENERATED_ORDER:f=this._generatedMappings;break;case r.ORIGINAL_ORDER:f=this._originalMappings;break;default:throw new Error("Unknown order of iteration.");}e=this.sourceRoot;f.map(function(n){var t=n.source;return t&&e&&(t=i.join(e,t)),{source:t,generatedLine:n.generatedLine,generatedColumn:n.generatedColumn,originalLine:n.originalLine,originalColumn:n.originalColumn,name:n.name}}).forEach(n,o)};t.SourceMapConsumer=r})},{"./array-set":12,"./base64-vlq":13,"./binary-search":15,"./util":19,amdefine:20}],17:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function r(n){this._file=i.getArg(n,"file");this._sourceRoot=i.getArg(n,"sourceRoot",null);this._sources=new f;this._names=new f;this._mappings=[];this._sourcesContents=null}var u=n("./base64-vlq"),i=n("./util"),f=n("./array-set").ArraySet;r.prototype._version=3;r.fromSourceMap=function(n){var t=n.sourceRoot,u=new r({file:n.file,sourceRoot:t});return n.eachMapping(function(n){var r={generated:{line:n.generatedLine,column:n.generatedColumn}};n.source&&(r.source=n.source,t&&(r.source=i.relative(t,r.source)),r.original={line:n.originalLine,column:n.originalColumn},n.name&&(r.name=n.name));u.addMapping(r)}),n.sources.forEach(function(t){var i=n.sourceContentFor(t);i&&u.setSourceContent(t,i)}),u};r.prototype.addMapping=function(n){var f=i.getArg(n,"generated"),t=i.getArg(n,"original",null),r=i.getArg(n,"source",null),u=i.getArg(n,"name",null);this._validateMapping(f,t,r,u);r&&!this._sources.has(r)&&this._sources.add(r);u&&!this._names.has(u)&&this._names.add(u);this._mappings.push({generatedLine:f.line,generatedColumn:f.column,originalLine:t!=null&&t.line,originalColumn:t!=null&&t.column,source:r,name:u})};r.prototype.setSourceContent=function(n,t){var r=n;this._sourceRoot&&(r=i.relative(this._sourceRoot,r));t!==null?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[i.toSetString(r)]=t):(delete this._sourcesContents[i.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};r.prototype.applySourceMap=function(n,t){var r,u,e;t||(t=n.file);r=this._sourceRoot;r&&(t=i.relative(r,t));u=new f;e=new f;this._mappings.forEach(function(f){var o,s,h;f.source===t&&f.originalLine&&(o=n.originalPositionFor({line:f.originalLine,column:f.originalColumn}),o.source!==null&&(f.source=r?i.relative(r,o.source):o.source,f.originalLine=o.line,f.originalColumn=o.column,o.name!==null&&f.name!==null&&(f.name=o.name)));s=f.source;s&&!u.has(s)&&u.add(s);h=f.name;h&&!e.has(h)&&e.add(h)},this);this._sources=u;this._names=e;n.sources.forEach(function(t){var u=n.sourceContentFor(t);u&&(r&&(t=i.relative(r,t)),this.setSourceContent(t,u))},this)};r.prototype._validateMapping=function(n,t,i,r){if((!n||!("line"in n)||!("column"in n)||!(n.line>0)||!(n.column>=0)||t||i||r)&&(!n||!("line"in n)||!("column"in n)||!t||!("line"in t)||!("column"in t)||!(n.line>0)||!(n.column>=0)||!(t.line>0)||!(t.column>=0)||!i))throw new Error("Invalid mapping: "+JSON.stringify({generated:n,source:i,orginal:t,name:r}));};r.prototype._serializeMappings=function(){var f=0,e=1,o=0,s=0,h=0,c=0,t="",n,r,l;for(this._mappings.sort(i.compareByGeneratedPositions),r=0,l=this._mappings.length;r<l;r++){if(n=this._mappings[r],n.generatedLine!==e)for(f=0;n.generatedLine!==e;)t+=";",e++;else if(r>0){if(!i.compareByGeneratedPositions(n,this._mappings[r-1]))continue;t+=","}t+=u.encode(n.generatedColumn-f);f=n.generatedColumn;n.source&&(t+=u.encode(this._sources.indexOf(n.source)-c),c=this._sources.indexOf(n.source),t+=u.encode(n.originalLine-1-s),s=n.originalLine-1,t+=u.encode(n.originalColumn-o),o=n.originalColumn,n.name&&(t+=u.encode(this._names.indexOf(n.name)-h),h=this._names.indexOf(n.name)))}return t};r.prototype._generateSourcesContent=function(n,t){return n.map(function(n){if(!this._sourcesContents)return null;t&&(n=i.relative(t,n));var r=i.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)};r.prototype.toJSON=function(){var n={version:this._version,file:this._file,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._sourceRoot&&(n.sourceRoot=this._sourceRoot),this._sourcesContents&&(n.sourcesContent=this._generateSourcesContent(n.sources,n.sourceRoot)),n};r.prototype.toString=function(){return JSON.stringify(this)};t.SourceMapGenerator=r})},{"./array-set":12,"./base64-vlq":13,"./util":19,amdefine:20}],18:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function i(n,t,i,r,u){this.children=[];this.sourceContents={};this.line=n===undefined?null:n;this.column=t===undefined?null:t;this.source=i===undefined?null:i;this.name=u===undefined?null:u;r!=null&&this.add(r)}var u=n("./source-map-generator").SourceMapGenerator,r=n("./util");i.fromStringWithSourceMap=function(n,t){function s(n,t){n===null||n.source===undefined?f.add(t):f.add(new i(n.originalLine,n.originalColumn,n.source,t,n.name))}var f=new i,r=n.split("\n"),e=1,u=0,o=null;return t.eachMapping(function(n){var t,i;if(o===null){while(e<n.generatedLine)f.add(r.shift()+"\n"),e++;u<n.generatedColumn&&(t=r[0],f.add(t.substr(0,n.generatedColumn)),r[0]=t.substr(n.generatedColumn),u=n.generatedColumn)}else if(e<n.generatedLine){i="";do i+=r.shift()+"\n",e++,u=0;while(e<n.generatedLine);u<n.generatedColumn&&(t=r[0],i+=t.substr(0,n.generatedColumn),r[0]=t.substr(n.generatedColumn),u=n.generatedColumn);s(o,i)}else t=r[0],i=t.substr(0,n.generatedColumn-u),r[0]=t.substr(n.generatedColumn-u),u=n.generatedColumn,s(o,i);o=n},this),s(o,r.join("\n")),t.sources.forEach(function(n){var i=t.sourceContentFor(n);i&&f.setSourceContent(n,i)}),f};i.prototype.add=function(n){if(Array.isArray(n))n.forEach(function(n){this.add(n)},this);else if(n instanceof i||typeof n=="string")n&&this.children.push(n);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);return this};i.prototype.prepend=function(n){if(Array.isArray(n))for(var t=n.length-1;t>=0;t--)this.prepend(n[t]);else if(n instanceof i||typeof n=="string")this.children.unshift(n);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);return this};i.prototype.walk=function(n){for(var t,r=0,u=this.children.length;r<u;r++)t=this.children[r],t instanceof i?t.walk(n):t!==""&&n(t,{source:this.source,line:this.line,column:this.column,name:this.name})};i.prototype.join=function(n){var t,i,r=this.children.length;if(r>0){for(t=[],i=0;i<r-1;i++)t.push(this.children[i]),t.push(n);t.push(this.children[i]);this.children=t}return this};i.prototype.replaceRight=function(n,t){var r=this.children[this.children.length-1];return r instanceof i?r.replaceRight(n,t):typeof r=="string"?this.children[this.children.length-1]=r.replace(n,t):this.children.push("".replace(n,t)),this};i.prototype.setSourceContent=function(n,t){this.sourceContents[r.toSetString(n)]=t};i.prototype.walkSourceContents=function(n){for(var f,t=0,u=this.children.length;t<u;t++)this.children[t]instanceof i&&this.children[t].walkSourceContents(n);for(f=Object.keys(this.sourceContents),t=0,u=f.length;t<u;t++)n(r.fromSetString(f[t]),this.sourceContents[f[t]])};i.prototype.toString=function(){var n="";return this.walk(function(t){n+=t}),n};i.prototype.toStringWithSourceMap=function(n){var t={code:"",line:1,column:0},i=new u(n),r=!1,f=null,e=null,o=null,s=null;return this.walk(function(n,u){t.code+=n;u.source!==null&&u.line!==null&&u.column!==null?((f!==u.source||e!==u.line||o!==u.column||s!==u.name)&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:t.line,column:t.column},name:u.name}),f=u.source,e=u.line,o=u.column,s=u.name,r=!0):r&&(i.addMapping({generated:{line:t.line,column:t.column}}),f=null,r=!1);n.split("").forEach(function(n){n==="\n"?(t.line++,t.column=0):t.column++})}),this.walkSourceContents(function(n,t){i.setSourceContent(n,t)}),{code:t.code,map:i}};t.SourceNode=i})},{"./source-map-generator":17,"./util":19,amdefine:20}],19:[function(n,t){if(typeof i!="function")var i=n("amdefine")(t,n);i(function(n,t){function e(n,t,i){if(t in n)return n[t];if(arguments.length===3)return i;throw new Error('"'+t+'" is a required argument.');}function r(n){var t=n.match(u);return t?{scheme:t[1],auth:t[3],host:t[4],port:t[6],path:t[7]}:null}function f(n){var t=n.scheme+"://";return n.auth&&(t+=n.auth+"@"),n.host&&(t+=n.host),n.port&&(t+=":"+n.port),n.path&&(t+=n.path),t}function s(n,t){var i;return t.match(u)||t.match(o)?t:t.charAt(0)==="/"&&(i=r(n))?(i.path=t,f(i)):n.replace(/\/$/,"")+"/"+t}function h(n){return"$"+n}function c(n){return n.substr(1)}function l(n,t){n=n.replace(/\/$/,"");var i=r(n);return t.charAt(0)=="/"&&i&&i.path=="/"?t.slice(1):t.indexOf(n+"/")===0?t.substr(n.length+1):t}function i(n,t){var i=n||"",r=t||"";return(i>r)-(i<r)}function a(n,t,r){var u;return(u=i(n.source,t.source),u)?u:(u=n.originalLine-t.originalLine,u)?u:(u=n.originalColumn-t.originalColumn,u||r)?u:(u=i(n.name,t.name),u)?u:(u=n.generatedLine-t.generatedLine,u)?u:n.generatedColumn-t.generatedColumn}function v(n,t,r){var u;return(u=n.generatedLine-t.generatedLine,u)?u:(u=n.generatedColumn-t.generatedColumn,u||r)?u:(u=i(n.source,t.source),u)?u:(u=n.originalLine-t.originalLine,u)?u:(u=n.originalColumn-t.originalColumn,u)?u:i(n.name,t.name)}t.getArg=e;var u=/([\w+\-.]+):\/\/((\w+:\w+)@)?([\w.]+)?(:(\d+))?(\S+)?/,o=/^data:.+\,.+/;t.urlParse=r;t.urlGenerate=f;t.join=s;t.toSetString=h;t.fromSetString=c;t.relative=l;t.compareByOriginalPositions=a;t.compareByGeneratedPositions=v})},{amdefine:20}],20:[function(n,t){(function(i,r){
/** vim: et:ts=4:sw=4:sts=4
 * @license amdefine 0.1.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/amdefine for details
 */
function u(t,u){"use strict";function y(n){for(var i,t=0;n[t];t+=1)if(i=n[t],i===".")n.splice(t,1),t-=1;else if(i==="..")if(t===1&&(n[2]===".."||n[0]===".."))break;else t>0&&(n.splice(t-1,2),t-=2)}function h(n,t){var i;return n&&n.charAt(0)==="."&&t&&(i=t.split("/"),i=i.slice(0,i.length-1),i=i.concat(n.split("/")),y(i),n=i.join("/")),n}function p(n){return function(t){return h(t,n)}}function w(n){function t(t){f[n]=t}return t.fromText=function(){throw new Error("amdefine does not implement load.fromText");},t}function c(n,i,e){var c,h,s,l;if(n)h=f[n]={},s={id:n,uri:r,exports:h},c=o(u,h,s,n);else{if(a)throw new Error("amdefine with no module ID cannot be called more than once per file.");a=!0;h=t.exports;s=t;c=o(u,h,s,t.id)}i&&(i=i.map(function(n){return c(n)}));l=typeof e=="function"?e.apply(s.exports,i):e;l!==undefined&&(s.exports=l,n&&(f[n]=s.exports))}function l(n,t,i){Array.isArray(n)?(i=t,t=n,n=undefined):typeof n!="string"&&(i=n,n=t=undefined);t&&!Array.isArray(t)&&(i=t,t=undefined);t||(t=["require","exports","module"]);n?e[n]=[n,t,i]:c(n,t,i)}var e={},f={},a=!1,v=n("path"),o,s;return o=function(n,t,r,u){function f(f,e){if(typeof f=="string")return s(n,t,r,f,u);f=f.map(function(i){return s(n,t,r,i,u)});i.nextTick(function(){e.apply(null,f)})}return f.toUrl=function(n){return n.indexOf(".")===0?h(n,v.dirname(r.filename)):n},f},u=u||function(){return t.require.apply(t,arguments)},s=function(n,t,i,r,u){var a=r.indexOf("!"),y=r,v,l;if(a===-1){if(r=h(r,u),r==="require")return o(n,t,i,u);if(r==="exports")return t;if(r==="module")return i;if(f.hasOwnProperty(r))return f[r];if(e[r])return c.apply(null,e[r]),f[r];if(n)return n(y);throw new Error("No module with ID: "+r);}else return v=r.substring(0,a),r=r.substring(a+1,r.length),l=s(n,t,i,v,u),r=l.normalize?l.normalize(r,p(u)):h(r,u),f[r]?f[r]:(l.load(r,o(n,t,i,u),w(r),{}),f[r])},l.require=function(n){return f[n]?f[n]:e[n]?(c.apply(null,e[n]),f[n]):void 0},l.amd={},l}t.exports=u}).call(this,n("_process"),"/node_modules/jstransform/node_modules/source-map/node_modules/amdefine/amdefine.js")},{_process:8,path:7}],21:[function(n,t,i){function e(n){var t=n.match(u);return t?t[0].replace(f,"")||"":""}function r(n){var t,i,r;for(n=n.replace(o,"").replace(s,"").replace(h," ").replace(c,"$1"),t="";t!=n;)t=n,n=n.replace(l,"\n$1 $2\n");for(n=n.trim(),i=[];r=a.exec(n);)i.push([r[1],r[2]]);return i}function v(n){for(var i=r(n),u={},t=0;t<i.length;t++)u[i[t][0]]=i[t][1];return u}var u=/^\s*(\/\*\*(.|\r?\n)*?\*\/)/,f=/^\s*/,o=/^\/\*\*?/,s=/\*+\/$/,h=/[\t ]+/g,c=/(\r?\n|^) *\*/g,l=/(?:^|\r?\n) *(@[^\r\n]*?) *\r?\n *([^@\r\n\s][^@\r\n]+?) *\r?\n/g,a=/(?:^|\r?\n) *@(\S+) *([^\r\n]*)/g;i.extract=e;i.parse=r;i.parseAsObject=v},{}],22:[function(n,t,i){"use strict";function v(n,t){if(n.type===r.Program)return!0;var i=t.type===r.FunctionDeclaration||t.type===r.FunctionExpression||t.type===r.ArrowFunctionExpression,u=t.type===r.ArrowFunctionExpression&&n===t.body;return i&&(n.type===r.BlockStatement||u)}function y(n,t){return n.type===r.Program?!1:n.type===r.BlockStatement&&t.type===r.CatchClause}function o(n,t,i){function g(n,t,i){n.range&&u.catchup(n.range[0],i);o(n,t,i);n.range&&u.catchup(n.range[1],i)}var c=null,s=t[0],p,k,w,d,h;if(!Array.isArray(n)&&i.localScope.parentNode!==s){if(v(n,s)){if(p=i.scopeIsStrict,p||n.type!==r.BlockStatement&&n.type!==r.Program||(p=n.body.length>0&&n.body[0].type===r.ExpressionStatement&&n.body[0].expression.type===r.Literal&&n.body[0].expression.value==="use strict"),n.type===r.Program)c=i.g.buffer.length,i=u.updateState(i,{scopeIsStrict:p});else{if(c=i.g.buffer.length+1,i=u.updateState(i,{localScope:{parentNode:s,parentScope:i.localScope,identifiers:{},tempVarIndex:0,tempVars:[]},scopeIsStrict:p}),f("arguments",e(n),i),s.params.length>0)for(h=e(s,t.slice(1),t[0]),w=0;w<s.params.length;w++)k=s.params[w],k.type===r.Identifier&&f(k.name,h,i);s.rest&&(h=e(s,t.slice(1),t[0]),f(s.rest.name,h,i));s.type===r.FunctionExpression&&s.id&&(d=e(s,t.parentNodeslice,s),f(s.id.name,d,i))}l(n,t,i)}y(n,s)&&(c=i.g.buffer.length,i=u.updateState(i,{localScope:{parentNode:s,parentScope:i.localScope,identifiers:{},tempVarIndex:0,tempVars:[]}}),s.type===r.CatchClause&&(h=e(s,t.slice(1),s),f(s.param.name,h,i)),a(n,t,i))}u.analyzeAndTraverse(b,g,n,t,i);c!==null&&u.injectTempVarDeclarations(i,c)}function l(n,t,i){u.analyzeAndTraverse(p,l,n,t,i)}function a(n,t,i){u.analyzeAndTraverse(w,a,n,t,i)}function p(n,t,i){var u;switch(n.type){case r.ArrowFunctionExpression:case r.FunctionExpression:return!1;case r.ClassDeclaration:case r.ClassExpression:case r.FunctionDeclaration:return n.id&&(u=e(c(t),t.slice(),n),f(n.id.name,u,i)),!1;case r.VariableDeclarator:t[0].kind==="var"&&(u=e(c(t),t.slice(),n),f(n.id.name,u,i))}}function w(n){if(n.type===r.CatchClause)return!1}function b(n,t,i){for(var u=i.g.visitors,r=0;r<u.length;r++)if(u[r].test(n,t,i))return u[r](o,n,t,i)}function k(n,t){if(s[n]&&!t.disableAstCache)return s[n];var i=h.parse(n,{comment:!0,loc:!0,range:!0,sourceType:t.sourceType});return t.disableAstCache||(s[n]=i),i}function d(t,i,r){var s,f,c,e;r=r||{};try{s=k(i,r)}catch(h){h.message="Parse Error: "+h.message;throw h;}return f=u.createState(i,s,r),f.g.visitors=t,r.sourceMap&&(c=n("source-map").SourceMapGenerator,f.g.sourceMap=new c({file:r.filename||"transformed.js"})),o(s,[],f),u.catchup(i.length,f),e={code:f.g.buffer,extra:f.g.extra},r.sourceMap&&(e.sourceMap=f.g.sourceMap,e.sourceMapFilename=r.filename||"source.js"),e}var h=n("esprima-fb"),u=n("./utils"),c=u.getBoundaryNode,f=u.declareIdentInLocalScope,e=u.initScopeMetadata,r=h.Syntax,s={};i.transform=d;i.Syntax=r},{"./utils":23,"esprima-fb":9,"source-map":11}],23:[function(n,t,i){function v(n,t,i){return{localScope:{parentNode:t,parentScope:null,identifiers:{},tempVarIndex:0,tempVars:[]},superClass:null,mungeNamespace:"",methodNode:null,methodFuncNode:null,className:null,scopeIsStrict:null,indentBy:0,g:{opts:i,position:0,extra:{},buffer:"",source:n,docblock:null,tagNamespaceUsed:!1,isBolt:undefined,sourceMap:null,sourceMapFilename:"source.js",sourceLine:1,bufferLine:1,originalProgramAST:null,sourceColumn:0,bufferColumn:0}}}function y(n,t){var i=Object.create(n);return Object.keys(t).forEach(function(n){i[n]=t[n]}),i}function f(n,t,i){var f,r,u,e,o;if(!(n<t.g.position)){if(f=t.g.source.substring(t.g.position,n),r=h(f,t),t.g.sourceMap&&r){for(t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:t.g.bufferColumn},original:{line:t.g.sourceLine,column:t.g.sourceColumn},source:t.g.sourceMapFilename}),u=f.split("\n"),e=r.split("\n"),o=1;o<u.length-1;o++)t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:0},original:{line:t.g.sourceLine,column:0},source:t.g.sourceMapFilename}),t.g.sourceLine++,t.g.bufferLine++;u.length>1&&(t.g.sourceLine++,t.g.bufferLine++,t.g.sourceColumn=0,t.g.bufferColumn=0);t.g.sourceColumn+=u[u.length-1].length;t.g.bufferColumn+=e[e.length-1].length}t.g.buffer+=i?i(r):r;t.g.position=n}}function p(n,t){return t.g.source.substring(n.range[0],n.range[1])}function w(n){return n.replace(s," ")}function b(n){return n.replace(s,"")}function k(n,t){var h=t.g.source.substring(t.g.position),c=h.split("\n"),i=0,o,s=!1,u=!1,f,r,e;n:while((o=c.shift())!==undefined){f=i+o.length;t:for(;i<f;i++){if(r=h[i],r==='"'||r==="'"){u=!u;continue t}else if(u)continue t;else if(i+1<f)if(e=r+o[i+1],e==="//"){i=f+1;continue n}else if(e==="/*"){s=!0;i+=1;continue t}else if(e==="*/"){s=!1;i+=1;continue t}if(!s&&r===n)return i+t.g.position}i++;u=!1}throw new Error("`"+n+"` not found!");}function d(n,t){f(n,t,w)}function g(n,t){f(n,t,b)}function tt(n){return n.replace(nt,function(){return""})}function it(n,t){f(n,t,tt)}function rt(n,t){if(t.g.sourceMap){n<t.g.position&&(t.g.position=0,t.g.sourceLine=1,t.g.sourceColumn=0);var r=t.g.source.substring(t.g.position,n),i=r.split("\n");i.length>1&&(t.g.sourceLine+=i.length-1,t.g.sourceColumn=0);t.g.sourceColumn+=i[i.length-1].length}t.g.position=n}function ut(n,t){if(t.g.sourceMap&&n){t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:t.g.bufferColumn},original:{line:t.g.sourceLine,column:t.g.sourceColumn},source:t.g.sourceMapFilename});var i=n.split("\n");i.length>1&&(t.g.bufferLine+=i.length-1,t.g.bufferColumn=0);t.g.bufferColumn+=i[i.length-1].length}t.g.buffer+=n}function h(n,t){var r=t.indentBy,i;if(r<0)for(i=0;i<-r;i++)n=n.replace(o,"$1");else for(i=0;i<r;i++)n=n.replace(o,"$1$2$2");return n}function ft(n,t){var i=n;for(n=n-1;n>0&&t.g.source[n]!="\n";)t.g.source[n].match(/[ \t]/)||(i=n),n--;return t.g.source.substring(n+1,i)}function et(t){if(!t.g.docblock){var i=n("./docblock");t.g.docblock=i.parseAsObject(i.extract(t.g.source))}return t.g.docblock}function ot(n,t,i){for(var r=t.localScope;r;){if(r.identifiers[n]!==undefined)return!0;if(i&&r.parentNode===i)break;r=r.parentScope}return!1}function st(n,t){return t.localScope.identifiers[n]!==undefined}function ht(n,t,i){return{boundaryNode:n,bindingPath:t,bindingNode:i}}function ct(n,t,i){i.localScope.identifiers[n]={boundaryNode:t.boundaryNode,path:t.bindingPath,node:t.bindingNode,state:Object.create(i)}}function lt(n,t){for(var i=t.localScope;i;){if(i.identifiers[n]!==undefined)return i.identifiers[n];i=i.parentScope}}function at(n,t){return t.localScope.identifiers[n]}function c(n,t,i,r,u){if(i.type){if(n(i,r,u)===!1)return;r.unshift(i)}l(i).forEach(function(n){t(n,r,u)});i.type&&r.shift()}function l(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&a(t,n[i]);return t.sort(function(n,t){return n[1]-t[1]}),t.map(function(n){return n[0]})}function a(n,t){if(typeof t=="object"&&t!==null)if(t.range)n.push([t,t.range[0]]);else if(Array.isArray(t))for(var i=0;i<t.length;i++)a(n,t[i])}function vt(n,t){return e(n,function(n){return n.type===t})}function e(n,t){function r(n){if(t(n)===!0)return i=!0,!1}function u(n){i||(i=e(n,t))}var i=!1;return c(r,u,n,[]),i}function yt(n){for(var t=0;t<n.length;++t)if(r[n[t].type])return n[t];throw new Error("Expected to find a node with one of the following types in path:\n"+JSON.stringify(Object.keys(r)));}function pt(n){return"$__"+n}function wt(n){var t="$__"+n.localScope.tempVarIndex++;return n.localScope.tempVars.push(t),t}function bt(n,t){n.localScope.tempVars.length&&(n.g.buffer=n.g.buffer.slice(0,t)+"var "+n.localScope.tempVars.join(", ")+";"+n.g.buffer.slice(t),n.localScope.tempVars=[])}var u=n("esprima-fb").Syntax,o=/(^|\n)( {2}|\t)/g,s=/(\S)/g,nt=/[^\n]/g,r={};r[u.ArrowFunctionExpression]=!0;r[u.FunctionExpression]=!0;r[u.FunctionDeclaration]=!0;r[u.Program]=!0;i.analyzeAndTraverse=c;i.append=ut;i.catchup=f;i.catchupNewlines=it;i.catchupWhiteOut=d;i.catchupWhiteSpace=g;i.containsChildMatching=e;i.containsChildOfType=vt;i.createState=v;i.declareIdentInLocalScope=ct;i.getBoundaryNode=yt;i.getDocblock=et;i.getLexicalBindingMetadata=lt;i.getLocalBindingMetadata=at;i.getNextSyntacticCharOffset=k;i.getNodeSourceText=p;i.getOrderedChildren=l;i.getTempVar=pt;i.identInLocalScope=st;i.identWithinLexicalScope=ot;i.indentBefore=ft;i.initScopeMetadata=ht;i.injectTempVar=wt;i.injectTempVarDeclarations=bt;i.move=rt;i.scopeTypes=r;i.updateIndent=h;i.updateState=y},{"./docblock":21,"esprima-fb":9}],24:[function(n,t,i){function f(n,t,i,f){var o=i[0].type===u.ExpressionStatement,s,c;return o&&r.append("(",f),r.append("function",f),h(n,t,i,f),r.catchupWhiteSpace(t.body.range[0],f),s=t.body.type==u.BlockStatement?e:l,i.unshift(t),s(n,t,i,f),i.shift(),c=r.containsChildMatching(t.body,function(n){return n.type===u.ThisExpression||n.type===u.Identifier&&n.name==="super"}),c&&r.append(".bind(this)",f),r.catchupWhiteSpace(t.range[1],f),o&&r.append(")",f),!1}function h(n,t,i,u){(c(t,u)||!t.params.length)&&r.append("(",u);t.params.length!==0&&(i.unshift(t),n(t.params,i,u),i.unshift());r.append(")",u)}function c(n,t){return n.params.length===1&&t.g.source[t.g.position]!=="("}function l(n,t,i,u){r.append("{",u);t.rest&&r.append(o.renderRestParamSetup(t,u),u);s.renderDestructuredComponents(t,r.updateState(u,{localScope:{parentNode:u.parentNode,parentScope:u.parentScope,identifiers:u.identifiers,tempVarIndex:0}}));r.append("return ",u);e(n,t,i,u);r.append(";}",u)}function e(n,t,i,u){n(t.body,i,u);r.catchup(t.body.range[1],u)}var o=n("./es6-rest-param-visitors"),s=n("./es6-destructuring-visitors"),u=n("esprima-fb").Syntax,r=n("../src/utils");f.test=function(n){return n.type===u.ArrowFunctionExpression};i.visitorList=[f]},{"../src/utils":23,"./es6-destructuring-visitors":27,"./es6-rest-param-visitors":30,"esprima-fb":9}],25:[function(n,t,i){function f(n,t,i,u){r.move(t.range[0],u);n(t,i,u);r.catchup(t.range[1],u)}function e(n,t,i,e){var h,c,o,l,s;if(r.catchup(t.range[0],e),t.type===u.NewExpression?(r.append("new (Function.prototype.bind.apply(",e),f(n,t.callee,i,e)):t.callee.type===u.MemberExpression?(h=r.injectTempVar(e),r.append("("+h+" = ",e),f(n,t.callee.object,i,e),r.append(")",e),t.callee.property.type===u.Identifier?(r.append(".",e),f(n,t.callee.property,i,e)):(r.append("[",e),f(n,t.callee.property,i,e),r.append("]",e)),r.append(".apply("+h,e)):(c=t.callee.type===u.FunctionDeclaration||t.callee.type===u.FunctionExpression,c&&r.append("(",e),f(n,t.callee,i,e),c&&r.append(")",e),r.append(".apply(null",e)),r.append(", ",e),o=t.arguments.slice(),l=o.pop(),o.length||t.type===u.NewExpression){for(r.append("[",e),t.type===u.NewExpression&&r.append("null"+(o.length?", ":""),e);o.length;)s=o.shift(),r.move(s.range[0],e),n(s,i,e),o.length?r.catchup(o[0].range[0],e):r.catchup(s.range[1],e);r.append("].concat(",e);f(n,l.argument,i,e);r.append(")",e)}else f(n,l.argument,i,e);return r.append(t.type===u.NewExpression?"))":")",e),r.move(t.range[1],e),!1}var u=n("esprima-fb").Syntax,r=n("../src/utils");e.test=function(n){return(n.type===u.CallExpression||n.type===u.NewExpression)&&n.arguments.length>0&&n.arguments[n.arguments.length-1].type===u.SpreadElement};i.visitorList=[e]},{"../src/utils":23,"esprima-fb":9}],26:[function(n,t,i){"use strict";function ft(){a=0;f={}}function v(n){var t=n.mungeNamespace||"";return"____Class"+t+h.encode(a++)}function o(n,t){var i=t.mungeNamespace,u=t.g.opts.minify,r;return u&&(f[i]||(f[i]={symbolMap:{},identUUIDCounter:0}),r=f[i].symbolMap,r[n]||(r[n]=h.encode(f[i].identUUIDCounter++)),n=r[n]),"$"+i+n}function y(n,t){var i={name:null,expression:null};return n.superClass&&(n.superClass.type===u.Identifier?i.name=n.superClass.name:(i.name=v(t),i.expression=t.g.source.substring(n.superClass.range[0],n.superClass.range[1]))),i}function p(n){return n.type===u.MethodDefinition&&n.key.type===u.Identifier&&n.key.name==="constructor"}function s(n,t){return!!t.methodFuncNode&&!r.getDocblock(t).hasOwnProperty("preventMunge")&&/^_(?!_)/.test(n.name)}function w(n,t,i,u){if(!u.g.opts.es5&&(t.kind==="get"||t.kind==="set"))throw new Error("This transform does not support "+t.kind+"ter methods for ES6 classes. (line: "+t.loc.start.line+", col: "+t.loc.start.column+")");return u=r.updateState(u,{methodNode:t}),r.catchup(t.range[0],u),i.unshift(t),n(t.value,i,u),i.shift(),!1}function b(n,t,i,f){var h=i[0],v=h.kind==="get",y=h.kind==="set",c,l,w,b;if(f=r.updateState(f,{methodFuncNode:t}),h.key.name==="constructor")r.append("function "+f.className,f);else{var a=!1,e,k=h["static"]?"":".prototype",p=f.className+k;h.key.type===u.Identifier?(e=h.key.name,s(h.key,f)&&(e=o(e,f)),v||y?e=JSON.stringify(e):ut.isReservedWord(e)&&(a=!0,e=JSON.stringify(e))):h.key.type===u.Literal&&(e=JSON.stringify(h.key.value),a=!0);y||v?r.append("Object.defineProperty("+p+","+e+",{configurable:true,"+h.kind+":function",f):f.g.opts.es3?(e=a?"["+e+"]":"."+e,r.append(p+e+"=function"+(t.generator?"*":""),f)):(a||(e=JSON.stringify(e)),r.append("Object.defineProperty("+p+","+e+",{writable:true,configurable:true,value:function"+(t.generator?"*":""),f))}if(r.move(h.key.range[1],f),r.append("(",f),c=t.params,c.length>0)for(r.catchupNewlines(c[0].range[0],f),l=0;l<c.length;l++)r.catchup(t.params[l].range[0],f),i.unshift(t),n(c[l],i,f),i.shift();return w=r.getNextSyntacticCharOffset(")",f),r.catchupWhiteSpace(w,f),b=r.getNextSyntacticCharOffset("{",f),r.catchup(b+1,f),f.scopeIsStrict||(r.append('"use strict";',f),f=r.updateState(f,{scopeIsStrict:!0})),r.move(t.body.range[0]+1,f),i.unshift(t),n(t.body,i,f),i.shift(),r.catchup(t.body.range[1],f),h.key.name!=="constructor"&&((v||y||!f.g.opts.es3)&&r.append("})",f),r.append(";",f)),!1}function k(n,t,i,u){var f=t.name;s(t,u)&&(f=o(t.name,u));r.append(f,u);r.move(t.range[1],u)}function d(n,t,i,u){var s=u.className,f=u.superClass,o,a,h;f.name&&(f.expression!==null&&r.append("var "+f.name+"="+f.expression+";",u),o=f.name+"____Key",a="",r.identWithinLexicalScope(o,u)||(a="var ",c(o,l(t),u)),r.append("for("+a+o+" in "+f.name+"){if("+f.name+".hasOwnProperty("+o+")){"+s+"["+o+"]="+f.name+"["+o+"];}}",u),h=e+f.name,r.identWithinLexicalScope(h,u)||(r.append("var "+h+"="+f.name+"===null?null:"+f.name+".prototype;",u),c(h,l(t),u)),r.append(s+".prototype=Object.create("+h+");",u),r.append(s+".prototype.constructor="+s+";",u),r.append(s+".__superConstructor__="+f.name+";",u));t.body.body.filter(p).pop()||(r.append("function "+s+"(){",u),u.scopeIsStrict||r.append('"use strict";',u),f.name&&r.append("if("+f.name+"!==null){"+f.name+".apply(this,arguments);}",u),r.append("}",u));r.move(t.body.range[0]+1,u);n(t.body,i,u);r.catchupWhiteSpace(t.range[1],u)}function g(n,t,i,u){var f=t.id.name,e=y(t,u);return u=r.updateState(u,{mungeNamespace:f,className:f,superClass:e}),d(n,t,i,u),!1}function nt(n,t,i,u){var f=t.id&&t.id.name||v(u),e=y(t,u);return r.append("(function(){",u),u=r.updateState(u,{mungeNamespace:f,className:f,superClass:e}),d(n,t,i,u),r.append("return "+f+";})()",u),!1}function tt(n,t,i,u){r.append(o(t.name,u),u);r.move(t.range[1],u)}function it(n,t,i,f){var s=f.superClass.name,o;return t.callee.type===u.Identifier?(p(f.methodNode)?r.append(s+".call(",f):(o=e+s,f.methodNode.key.type===u.Identifier?o+="."+f.methodNode.key.name:f.methodNode.key.type===u.Literal&&(o+="["+JSON.stringify(f.methodNode.key.value)+"]"),r.append(o+".call(",f)),r.move(t.callee.range[1],f)):t.callee.type===u.MemberExpression&&(r.append(e+s,f),r.move(t.callee.object.range[1],f),t.callee.computed?r.catchup(t.callee.property.range[1]+1,f):r.append("."+t.callee.property.name,f),r.append(".call(",f),r.move(t.callee.range[1],f)),r.append("this",f),t.arguments.length>0&&(r.append(",",f),r.catchupWhiteSpace(t.arguments[0].range[0],f),n(t.arguments,i,f)),r.catchupWhiteSpace(t.range[1],f),r.append(")",f),!1}function rt(n,t,i,u){var f=u.superClass.name;r.append(e+f,u);r.move(t.object.range[1],u)}var h=n("base62"),u=n("esprima-fb").Syntax,r=n("../src/utils"),ut=n("./reserved-words-helper"),c=r.declareIdentInLocalScope,l=r.initScopeMetadata,e="____SuperProtoOf",a=0,f={};w.test=function(n){return n.type===u.MethodDefinition};b.test=function(n,t){return n.type===u.FunctionExpression&&t[0].type===u.MethodDefinition};k.test=function(n,t){if(t[0]&&t[1]){var i=t[0],r=t[1];return i.type===u.FunctionExpression&&r.type===u.MethodDefinition&&n.type===u.Identifier}};g.test=function(n){return n.type===u.ClassDeclaration};nt.test=function(n){return n.type===u.ClassExpression};tt.test=function(n,t,i){if(n.type===u.Identifier&&s(n,i)){if(t[0].type===u.MemberExpression&&t[0].object!==n&&t[0].computed===!1||r.identWithinLexicalScope(n.name,i,i.methodFuncNode)||t[0].type===u.Property&&t[1].type===u.ObjectExpression)return!0;if(t[0].type===u.FunctionExpression||t[0].type===u.FunctionDeclaration||t[0].type===u.ArrowFunctionExpression)for(var f=0;f<t[0].params.length;f++)if(t[0].params[f]===n)return!0}return!1};it.test=function(n,t,i){if(i.superClass&&n.type===u.CallExpression){var r=n.callee;if(r.type===u.Identifier&&r.name==="super"||r.type==u.MemberExpression&&r.object.name==="super")return!0}return!1};rt.test=function(n,t,i){return i.superClass&&n.type===u.MemberExpression&&n.object.type===u.Identifier&&n.object.name==="super"};i.resetSymbols=ft;i.visitorList=[g,nt,b,w,k,tt,it,rt]},{"../src/utils":23,"./reserved-words-helper":34,base62:10,"esprima-fb":9}],27:[function(n,t,i){function o(n,t,i,u){return r.append(r.getTempVar(u.localScope.tempVarIndex)+"=",u),r.catchupWhiteSpace(t.init.range[0],u),n(t.init,i,u),r.catchup(t.init.range[1],u),r.append(","+e(t.id,u),u),u.localScope.tempVarIndex++,!1}function f(n){return n.type===u.ObjectPattern||n.type===u.ArrayPattern}function e(n,t){for(var i,a,l,s,h=t.localScope.tempVarIndex,f=[],c=w(n),o=0;o<c.length;o++)if(i=c[o],i){if(i.type===u.SpreadElement){f.push(i.argument.name+"=Array.prototype.slice.call("+r.getTempVar(h)+","+o+")");continue}if(i.type===u.SpreadProperty){a=p.renderRestExpression(r.getTempVar(h),c);f.push(i.argument.name+"="+a);continue}l=b(n,i,h,o);s=k(n,i);s.type===u.Identifier?f.push(s.name+"="+l):f.push(r.getTempVar(++t.localScope.tempVarIndex)+"="+l+","+e(s,t))}return f.join(",")}function w(n){return n.properties||n.elements}function b(n,t,i,f){var e=r.getTempVar(i);if(n.type===u.ObjectPattern){if(v.isReservedWord(t.key.name))return e+'["'+t.key.name+'"]';if(t.key.type===u.Literal)return e+"["+JSON.stringify(t.key.value)+"]";if(t.key.type===u.Identifier)return e+"."+t.key.name}else if(n.type===u.ArrayPattern)return e+"["+f+"]"}function k(n,t){return n.type===u.ObjectPattern?t.value:t}function s(n,t,i,u){var f=t.expression;return r.append("var "+r.getTempVar(u.localScope.tempVarIndex)+"=",u),r.catchupWhiteSpace(f.right.range[0],u),n(f.right,i,u),r.catchup(f.right.range[1],u),r.append(";"+e(f.left,u)+";",u),r.catchupWhiteSpace(t.range[1],u),u.localScope.tempVarIndex++,!1}function h(n,t,i,u){return r.append(r.getTempVar(d(t,i)),u),r.catchupWhiteSpace(t.range[1],u),!0}function d(n,t){for(var r,u=t[0],e=0,i=0;i<u.params.length;i++){if(r=u.params[i],r===n)break;f(r)&&e++}return e}function c(n){return n.type==u.FunctionDeclaration||n.type==u.FunctionExpression||n.type==u.MethodDefinition||n.type==u.ArrowFunctionExpression}function l(n,t,i,u){var f=i[0];return r.catchup(f.body.range[0]+1,u),a(f,u),f.rest&&r.append(y.renderRestParamSetup(f,u),u),!0}function a(n,t){for(var o,i=[],u=0;u<n.params.length;u++)o=n.params[u],f(o)&&(i.push(e(o,t)),t.localScope.tempVarIndex++);i.length&&r.append("var "+i.join(",")+";",t)}var u=n("esprima-fb").Syntax,r=n("../src/utils"),v=n("./reserved-words-helper"),y=n("./es6-rest-param-visitors"),p=n("./es7-rest-property-helpers");o.test=function(n){return n.type===u.VariableDeclarator&&f(n.id)};s.test=function(n){return n.type===u.ExpressionStatement&&n.expression.type===u.AssignmentExpression&&f(n.expression.left)};h.test=function(n,t){return f(n)&&c(t[0])};l.test=function(n,t){return n.type===u.BlockStatement&&c(t[0])};i.visitorList=[o,s,h,l];i.renderDestructuredComponents=a},{"../src/utils":23,"./es6-rest-param-visitors":30,"./es7-rest-property-helpers":32,"./reserved-words-helper":34,"esprima-fb":9}],28:[function(n,t,i){function f(n,t,i,u){var f=t.value.generator;return f&&r.catchupWhiteSpace(t.range[0]+1,u),t.computed?r.catchup(t.key.range[1]+1,u):e.isReservedWord(t.key.name)&&(r.catchup(t.key.range[0],u),r.append('"',u),r.catchup(t.key.range[1],u),r.append('"',u)),r.catchup(t.key.range[1],u),r.append(":function"+(f?"*":""),u),i.unshift(t),n(t.value,i,u),i.shift(),!1}var u=n("esprima-fb").Syntax,r=n("../src/utils"),e=n("./reserved-words-helper");f.test=function(n){return n.type===u.Property&&n.value.type===u.FunctionExpression&&n.method===!0};i.visitorList=[f]},{"../src/utils":23,"./reserved-words-helper":34,"esprima-fb":9}],29:[function(n,t,i){function f(n,t,i,r){return u.catchup(t.key.range[1],r),u.append(":"+t.key.name,r),!1}var r=n("esprima-fb").Syntax,u=n("../src/utils");f.test=function(n,t){return n.type===r.Property&&n.kind==="init"&&n.shorthand===!0&&t[0].type!==r.ObjectPattern};i.visitorList=[f]},{"../src/utils":23,"esprima-fb":9}],30:[function(n,t,i){function f(n){return(n.type===u.FunctionDeclaration||n.type===u.FunctionExpression||n.type===u.ArrowFunctionExpression)&&n.rest}function e(n,t,i,u){return t.parametricType&&(r.catchup(t.parametricType.range[0],u),i.unshift(t),n(t.parametricType,i,u),i.shift()),t.params.length?(i.unshift(t),n(t.params,i,u),i.shift()):r.catchup(t.rest.range[0]-3,u),r.catchupWhiteSpace(t.rest.range[1],u),i.unshift(t),n(t.body,i,u),i.shift(),!1}function o(n,t){var i=t.localScope.tempVarIndex++,u=t.localScope.tempVarIndex++;return"for (var "+n.rest.name+"=[],"+r.getTempVar(i)+"="+n.params.length+","+r.getTempVar(u)+"=arguments.length;"+r.getTempVar(i)+"<"+r.getTempVar(u)+";"+r.getTempVar(i)+"++) "+n.rest.name+".push(arguments["+r.getTempVar(i)+"]);"}function s(n,t,i,u){r.catchup(t.range[0]+1,u);var f=i[0];return r.append(o(f,u),u),!0}var u=n("esprima-fb").Syntax,r=n("../src/utils");e.test=function(n){return f(n)};s.test=function(n,t){return n.type===u.BlockStatement&&f(t[0])};i.renderRestParamSetup=o;i.visitorList=[e,s]},{"../src/utils":23,"esprima-fb":9}],31:[function(n,t,i){"use strict";function f(n,t,i,f){var c=t.quasis,s,e,h;for(r.append("(",f),s=0;s<c.length;s++)e=c[s],e.value.raw!==""?(r.append(o(e),f),e.tail||r.append(" + ",f),r.move(e.range[0],f),r.catchupNewlines(e.range[1],f)):s>0&&!e.tail&&r.append(" + ",f),r.move(e.range[1],f),e.tail||(h=t.expressions[s],h.type===u.Identifier||h.type===u.MemberExpression||h.type===u.CallExpression?r.catchup(h.range[1],f):(r.append("(",f),n(h,i,f),r.catchup(h.range[1],f),r.append(")",f)),c[s+1].value.cooked!==""&&r.append(" + ",f));return r.move(t.range[1],f),r.append(")",f),!1}function e(n,t,i,u){var e=t.quasi,h=e.quasis.length,f,c;for(r.move(t.tag.range[0],u),n(t.tag,i,u),r.catchup(t.tag.range[1],u),r.append("(function() { var siteObj = [",u),f=0;f<h;f++)r.append(o(e.quasis[f]),u),f!==h-1&&r.append(", ",u);for(r.append("]; siteObj.raw = [",u),f=0;f<h;f++)r.append(s(e.quasis[f]),u),f!==h-1&&r.append(", ",u);if(r.append("]; Object.freeze(siteObj.raw); Object.freeze(siteObj); return siteObj; }()",u),h>1)for(f=0;f<e.expressions.length;f++)c=e.expressions[f],r.append(", ",u),r.move(e.quasis[f].range[0],u),r.catchupNewlines(e.quasis[f].range[1],u),r.move(c.range[0],u),n(c,i,u),r.catchup(c.range[1],u);return r.catchupNewlines(t.range[1],u),r.append(")",u),!1}function o(n){return JSON.stringify(n.value.cooked)}function s(n){return JSON.stringify(n.value.raw)}var u=n("esprima-fb").Syntax,r=n("../src/utils");f.test=function(n){return n.type===u.TemplateLiteral};e.test=function(n){return n.type===u.TaggedTemplateExpression};i.visitorList=[f,e]},{"../src/utils":23,"esprima-fb":9}],32:[function(n,t,i){function e(n){for(var t,i=[],u=0;u<n.length;u++)(t=n[u],t.type!==r.SpreadProperty)&&(t.type===r.Identifier?i.push(t.name):i.push(t.key.name));return i}function u(n,t){return f+"("+n+","+t+")"}function o(n){return u(n,"{}")}function s(n,t){var i=e(t);return i.length?u(n,"{"+i.join(":1,")+":1}"):o(n)}var r=n("esprima-fb").Syntax,f="(function(source, exclusion) {var rest = {};var hasOwn = Object.prototype.hasOwnProperty;if (source == null) {throw new TypeError();}for (var key in source) {if (hasOwn.call(source, key) && !hasOwn.call(exclusion, key)) {rest[key] = source[key];}}return rest;})";i.renderRestExpression=s},{"esprima-fb":9}],33:[function(n,t,i){function f(n,t,i,f){var o,s,e;for(r.catchup(t.range[0],f),r.append("Object.assign({",f),r.move(t.range[0]+1,f),o=!1,s=0;s<t.properties.length;s++)e=t.properties[s],e.type===u.SpreadProperty?(o||r.append("}",f),s===0&&r.append(",",f),r.catchup(e.range[0],f),r.move(e.range[0]+3,f),n(e.argument,i,f),r.catchup(e.range[1],f),o=!0):(r.catchup(e.range[0],f),o&&r.append("{",f),n(e,i,f),r.catchup(e.range[1],f),o=!1);return r.catchupWhiteSpace(t.range[1]-1,f),r.move(t.range[1],f),o||r.append("}",f),r.append(")",f),!1}var u=n("esprima-fb").Syntax,r=n("../src/utils");f.test=function(n){var i,t,r;if(n.type!==u.ObjectExpression)return!1;for(i=!1,t=0;t<n.properties.length;t++)if(r=n.properties[t],r.type===u.SpreadProperty)i=!0;else if(r.kind!=="init")return!1;return i};i.visitorList=[f]},{"../src/utils":23,"esprima-fb":9}],34:[function(n,t,i){var r=["break","do","in","typeof","case","else","instanceof","var","catch","export","new","void","class","extends","return","while","const","finally","super","with","continue","for","switch","yield","debugger","function","this","default","if","throw","delete","import","try"],u=["null","true","false"],o=[].concat(r,["enum","await","implements","package","protected","static","interface","private","public"],u),f=Object.create(null);o.forEach(function(n){f[n]=!0});var s=[].concat(r,["enum","implements","package","protected","static","interface","private","public"],u),e=Object.create(null);s.forEach(function(n){e[n]=!0});i.isReservedWord=function(n){return!!f[n]};i.isES3ReservedWord=function(n){return!!e[n]}},{}],35:[function(n,t,i){function e(n,t,i,u){return r.catchup(t.key.range[0],u),r.append('"',u),r.catchup(t.key.range[1],u),r.append('"',u),r.catchup(t.value.range[0],u),n(t.value,i,u),!1}function o(n,t,i,u){return n(t.object,i,u),r.catchup(t.property.range[0]-1,u),r.append("[",u),r.catchupWhiteSpace(t.property.range[0],u),r.append('"',u),r.catchup(t.property.range[1],u),r.append('"]',u),!1}var u=n("esprima-fb").Syntax,r=n("../src/utils"),f=n("./reserved-words-helper");e.test=function(n){return n.type===u.Property&&n.key.type===u.Identifier&&!n.method&&!n.shorthand&&!n.computed&&f.isES3ReservedWord(n.key.name)};o.test=function(n){return n.type===u.MemberExpression&&n.property.type===u.Identifier&&f.isES3ReservedWord(n.property.name)};i.visitorList=[e,o]},{"../src/utils":23,"./reserved-words-helper":34,"esprima-fb":9}],36:[function(n,t,i){function f(n){return n.type===u.FunctionDeclaration||n.type===u.FunctionExpression||n.type===u.ArrowFunctionExpression}function e(n,t,i,u){return r.catchup(t.range[0],u),r.catchupWhiteOut(t.range[1],u),!1}function o(n,t,i,u){return r.catchupWhiteOut(t.range[1],u),!1}function s(n,t,i,u){return i.unshift(t),n(t.expression,i,u),i.shift(),r.catchup(t.typeAnnotation.range[0],u),r.catchupWhiteOut(t.typeAnnotation.range[1],u),!1}function h(n,t,i,u){return r.catchupWhiteOut(t.range[1],u),!1}function c(n,t,i,u){return r.catchupWhiteOut(t.range[1],u),!1}function l(n,t,i,u){return r.catchup(t.range[0],u),r.catchupWhiteOut(t.range[1],u),!1}function a(n,t,i,u){return r.catchup(t.range[0],u),r.catchupWhiteOut(t.range[1],u),!1}function v(n,t,i,u){return r.catchup(t.range[0]+t.name.length,u),r.catchupWhiteOut(t.range[1],u),!1}function y(n,t,i,u){return r.catchup(t.typeAnnotation.range[0],u),r.catchupWhiteOut(t.typeAnnotation.range[1],u),!1}function p(n,t,i,u){return r.catchup(t.typeAnnotation.range[0],u),r.catchupWhiteOut(t.typeAnnotation.range[1],u),!1}function w(n,t,i,r){return i.unshift(t),n(t.key,i,r),i.unshift(t.value),n(t.value.params,i,r),t.value.rest&&n(t.value.rest,i,r),t.value.returnType&&n(t.value.returnType,i,r),n(t.value.body,i,r),i.shift(),i.shift(),!1}function b(n,t,i,u){return r.catchupWhiteOut(t.range[1],u),!1}var k=n("esprima-fb"),r=n("../src/utils"),u=k.Syntax;e.test=function(n){return n.type===u.ClassProperty};o.test=function(n){return n.type===u.TypeAlias};s.test=function(n){return n.type===u.TypeCastExpression};h.test=function(n){return n.type===u.InterfaceDeclaration};c.test=function(n){switch(n.type){case u.DeclareVariable:case u.DeclareFunction:case u.DeclareClass:case u.DeclareModule:return!0}return!1};l.test=function(n,t){return n.type===u.TypeParameterDeclaration&&t[0]&&f(t[0])&&n===t[0].typeParameters};a.test=function(n,t){return t[0]&&f(t[0])&&n===t[0].returnType};v.test=function(n,t){return n.type===u.Identifier&&n.optional&&t[0]&&f(t[0])};y.test=function(n){return n.type===u.Identifier&&n.typeAnnotation};p.test=function(n){var t=n.type===u.ObjectPattern||n.type===u.ArrayPattern;return t&&n.typeAnnotation};w.test=function(n){return n.type==="Property"&&(n.method||n.kind==="set"||n.kind==="get")||n.type==="MethodDefinition"};b.test=function(n){return n.type==="ImportDeclaration"&&n.isType};i.visitorList=[e,c,b,h,l,a,w,v,o,s,y,p]},{"../src/utils":23,"esprima-fb":9}],37:[function(n,t,i){"use strict";function e(n,t,i,u,f){var e=n.value.split(/\r\n|\n|\r/),o;u&&r.append(u,i);o=0;e.forEach(function(n,t){n.match(/[^ \t]/)&&(o=t)});e.forEach(function(n,u){var l=u===0,h=u===e.length-1,c=u===o,s=n.replace(/\t/g," ");l||(s=s.replace(/^[ ]+/,""));h||(s=s.replace(/[ ]+$/,""));l||r.append(n.match(/^[ \t]*/)[0],i);(s||c)&&(r.append(JSON.stringify(s)+(c?"":" + ' ' +"),i),c&&(f&&r.append(f,i),t||r.append(", ",i)),s&&!h&&r.append(n.match(/[ \t]*$/)[0],i));h||r.append("\n",i)});r.move(n.range[1],i)}function o(n,t,i,e,o){return r.move(t.range[0]+1,o),r.catchup(t.expression.range[0],o),n(t.expression,e,o),i||t.expression.type===f.JSXEmptyExpression||(r.catchup(t.expression.range[1],o,u),r.append(", ",o)),r.catchup(t.range[1]-1,o,u),r.move(t.range[1],o),!1}function s(n){return/^[a-z_$][a-z\d_$]*$/i.test(n)?n:'"'+n+'"'}function u(n){return n.replace(/^[ ]+/,"")}var f=n("jstransform").Syntax,r=n("jstransform/src/utils");i.renderJSXExpressionContainer=o;i.renderJSXLiteral=e;i.quoteAttrName=s;i.trimLeft=u},{jstransform:22,"jstransform/src/utils":23}],38:[function(n,t,i){"use strict";function e(n){return n.replace(l,"")}function v(n){return a.test(n)}function h(n,t,i,h){var l=t.openingElement,a=l.name,p=l.attributes,b,k,y,w,d;if(r.catchup(l.range[0],h,f),a.type===u.JSXNamespacedName&&a.namespace)throw new Error("Namespace tags are not supported. ReactJSX is not XML.");return r.append("React.createElement(",h),a.type===u.JSXIdentifier&&v(a.name)?(r.append('"'+a.name+'"',h),r.move(a.range[1],h)):(r.move(a.range[0],h),r.catchup(a.range[1],h)),r.append(", ",h),b=p.length,k=p.some(function(n){return n.type===u.JSXSpreadAttribute}),k?r.append("React.__spread({",h):b?r.append("{",h):r.append("null",h),y=!1,p.forEach(function(t,l){var a=l===p.length-1,v;if(t.type===u.JSXSpreadAttribute){y||r.append("}, ",h);r.catchup(t.range[0],h,e);r.move(t.range[0]+1,h);r.catchup(t.argument.range[0],h,e);n(t.argument,i,h);r.catchup(t.argument.range[1],h);r.catchup(t.range[1]-1,h,e);a||r.append(", ",h);r.move(t.range[1],h);y=!0;return}if(a||(a=p[l+1].type===u.JSXSpreadAttribute),t.name.namespace)throw new Error("Namespace attributes are not supported. ReactJSX is not XML.");v=t.name.name;r.catchup(t.range[0],h,f);y&&r.append("{",h);r.append(c(v),h);r.append(": ",h);t.value?(r.move(t.name.range[1],h),r.catchupNewlines(t.value.range[0],h),t.value.type===u.Literal?s(t.value,a,h):o(n,t.value,a,i,h)):(h.g.buffer+="true",h.g.position=t.name.range[1],a||r.append(", ",h));r.catchup(t.range[1],h,f);y=!1}),l.selfClosing||(r.catchup(l.range[1]-1,h,f),r.move(l.range[1],h)),b&&!y&&r.append("}",h),k&&r.append(")",h),w=t.children.filter(function(n){return!(n.type===u.Literal&&typeof n.value=="string"&&n.value.match(/^[ \t]*[\r\n][ \t\r\n]*$/))}),w.length>0&&(w.forEach(function(n,t){(n.type!==u.JSXExpressionContainer||n.expression.type!==u.JSXEmptyExpression)&&(d=t)}),d!==undefined&&r.append(", ",h),w.forEach(function(t,e){r.catchup(t.range[0],h,f);var c=e>=d;t.type===u.Literal?s(t,c,h):t.type===u.JSXExpressionContainer?o(n,t,c,i,h):(n(t,i,h),c||r.append(", ",h));r.catchup(t.range[1],h,f)})),l.selfClosing?(r.catchup(l.range[1]-2,h,f),r.move(l.range[1],h)):(r.catchup(t.closingElement.range[0],h,f),r.move(t.closingElement.range[1],h)),r.append(")",h),!1}var u=n("jstransform").Syntax,r=n("jstransform/src/utils"),o=n("./jsx").renderJSXExpressionContainer,s=n("./jsx").renderJSXLiteral,c=n("./jsx").quoteAttrName,f=n("./jsx").trimLeft,l=/([^\s\(\)])/g,a=/^[a-z]|\-/;h.test=function(n){return n.type===u.JSXElement};i.visitorList=[h]},{"./jsx":37,jstransform:22,"jstransform/src/utils":23}],39:[function(n,t,i){"use strict";function e(n,t,i){if(t&&t.type===r.CallExpression&&t.callee.type===r.MemberExpression&&t.callee.object.type===r.Identifier&&t.callee.object.name==="React"&&t.callee.property.type===r.Identifier&&t.callee.property.name==="createClass"&&t.arguments.length===1&&t.arguments[0].type===r.ObjectExpression){var f=t.arguments[0].properties,e=f.every(function(n){var t=n.key.type===r.Identifier?n.key.name:n.key.value;return t!=="displayName"});e&&(u.catchup(t.arguments[0].range[0]+1,i),u.append('displayName: "'+n+'",',i))}}function f(n,t,i,u){var f,o;t.type===r.AssignmentExpression?(f=t.left,o=t.right):t.type===r.Property?(f=t.key,o=t.value):t.type===r.VariableDeclarator&&(f=t.id,o=t.init);f&&f.type===r.MemberExpression&&(f=f.property);f&&f.type===r.Identifier&&e(f.name,o,u)}var r=n("jstransform").Syntax,u=n("jstransform/src/utils");f.test=function(n){return n.type===r.AssignmentExpression||n.type===r.Property||n.type===r.VariableDeclarator};i.visitorList=[f]},{jstransform:22,"jstransform/src/utils":23}],40:[function(n,t,i){"use strict";function k(n){for(var i=[],t=0,f=r.length;t<f;t++)n&&n.indexOf(r[t])!==-1||(i=i.concat(u[r[t]]));return i}function d(n){for(var e=n.reduce(function(n,t){if(!f.hasOwnProperty(t))throw new Error("Unknown visitor set: "+t);return f[t].forEach(function(t){n[t]=!0}),n},{}),i=[],t=0;t<r.length;t++)e.hasOwnProperty(r[t])&&(i=i.concat(u[r[t]]));return i}var e=n("jstransform/visitors/es6-arrow-function-visitors"),o=n("jstransform/visitors/es6-class-visitors"),s=n("jstransform/visitors/es6-destructuring-visitors"),h=n("jstransform/visitors/es6-object-concise-method-visitors"),c=n("jstransform/visitors/es6-object-short-notation-visitors"),l=n("jstransform/visitors/es6-rest-param-visitors"),a=n("jstransform/visitors/es6-template-visitors"),v=n("jstransform/visitors/es6-call-spread-visitors"),y=n("jstransform/visitors/es7-spread-property-visitors"),p=n("./transforms/react"),w=n("./transforms/reactDisplayName"),b=n("jstransform/visitors/reserved-words-visitors"),u={"es6-arrow-functions":e.visitorList,"es6-classes":o.visitorList,"es6-destructuring":s.visitorList,"es6-object-concise-method":h.visitorList,"es6-object-short-notation":c.visitorList,"es6-rest-params":l.visitorList,"es6-templates":a.visitorList,"es6-call-spread":v.visitorList,"es7-spread-property":y.visitorList,react:p.visitorList.concat(w.visitorList),"reserved-words":b.visitorList},f={harmony:["es6-arrow-functions","es6-object-concise-method","es6-object-short-notation","es6-classes","es6-rest-params","es6-templates","es6-destructuring","es6-call-spread","es7-spread-property"],es3:["reserved-words"],react:["react"]},r=["reserved-words","es6-arrow-functions","es6-object-concise-method","es6-object-short-notation","es6-classes","es6-rest-params","es6-templates","es6-destructuring","es6-call-spread","es7-spread-property","react"];i.getVisitorsBySet=d;i.getAllVisitors=k;i.transformVisitors=u},{"./transforms/react":38,"./transforms/reactDisplayName":39,"jstransform/visitors/es6-arrow-function-visitors":24,"jstransform/visitors/es6-call-spread-visitors":25,"jstransform/visitors/es6-class-visitors":26,"jstransform/visitors/es6-destructuring-visitors":27,"jstransform/visitors/es6-object-concise-method-visitors":28,"jstransform/visitors/es6-object-short-notation-visitors":29,"jstransform/visitors/es6-rest-param-visitors":30,"jstransform/visitors/es6-template-visitors":31,"jstransform/visitors/es7-spread-property-visitors":33,"jstransform/visitors/reserved-words-visitors":35}],41:[function(n,t){"use strict";function r(n,t,r){var u=n,f;return typeof n.toJSON=="function"&&(u=n.toJSON()),u.sources=[r],u.sourcesContent=[t],f=i(JSON.stringify(u)).toString("base64"),"//# sourceMappingURL=data:application/json;base64,"+f}var i=n("buffer").Buffer;t.exports=r},{buffer:3}]},{},[1])(1)});
/**
 * alertify
 * An unobtrusive customizable JavaScript notification system
 *
 * @author Fabien Doiron <fabien.doiron@gmail.com>
 * @copyright Fabien Doiron 2013
 * @license MIT <http://opensource.org/licenses/mit-license.php>
 * @link http://fabien-d.github.com/alertify.js/
 * @module alertify
 * @version 0.3.11
 */
(function(n,t){"use strict";var i=n.document,r;r=function(){var u={},s={},v=!1,y={ENTER:13,ESC:27,SPACE:32},a=[],e,c,l,p,w,b,k,h,f,r,g,o,d;return s={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}<\/nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}<\/button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}<\/button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}<\/button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"><\/div>',message:'<p class="alertify-message">{{message}}<\/p>',log:'<article class="alertify-log{{class}}">{{message}}<\/article>'},d=function(){var n,r,u=!1,e=i.createElement("fakeelement"),f={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(n in f)if(e.style[n]!==t){r=f[n];u=!0;break}return{type:r,supported:u}},e=function(n){return i.getElementById(n)},u={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:t,addListeners:function(n){var v=typeof l!="undefined",r=typeof c!="undefined",s=typeof o!="undefined",b="",t=this,u,f,h,a,e;u=function(t){return typeof t.preventDefault!="undefined"&&t.preventDefault(),h(t),typeof o!="undefined"&&(b=o.value),typeof n=="function"&&(typeof o!="undefined"?n(!0,b):n(!0)),!1};f=function(t){return typeof t.preventDefault!="undefined"&&t.preventDefault(),h(t),typeof n=="function"&&n(!1),!1};h=function(){t.hide();t.unbind(i.body,"keyup",a);t.unbind(p,"focus",e);v&&t.unbind(l,"click",u);r&&t.unbind(c,"click",f)};a=function(n){var t=n.keyCode;(t===y.SPACE&&!s||s&&t===y.ENTER)&&u(n);t===y.ESC&&r&&f(n)};e=function(){s?o.focus():!r||t.buttonReverse?l.focus():c.focus()};this.bind(p,"focus",e);this.bind(w,"focus",e);v&&this.bind(l,"click",u);r&&this.bind(c,"click",f);this.bind(i.body,"keyup",a);this.transition.supported||this.setFocus()},bind:function(n,t,i){typeof n.addEventListener=="function"?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)},handleErrors:function(){if(typeof n.onerror!="undefined"){var t=this;return n.onerror=function(n,i,r){t.error("["+n+" on line "+r+" of "+i+"]",0)},!0}return!1},appendButtons:function(n,t){return this.buttonReverse?t+n:n+t},build:function(n){var t="",i=n.type,r=n.message,e=n.cssClass||"";t+='<div class="alertify-dialog">';t+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus<\/a>';u.buttonFocus==="none"&&(t+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"><\/a>');i==="prompt"&&(t+='<div id="alertify-form">');t+='<article class="alertify-inner">';t+=s.message.replace("{{message}}",r);i==="prompt"&&(t+=s.input);t+=s.buttons.holder;t+="<\/article>";i==="prompt"&&(t+="<\/div>");t+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus<\/a>';t+="<\/div>";switch(i){case"confirm":t=t.replace("{{buttons}}",this.appendButtons(s.buttons.cancel,s.buttons.ok));t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"prompt":t=t.replace("{{buttons}}",this.appendButtons(s.buttons.cancel,s.buttons.submit));t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"alert":t=t.replace("{{buttons}}",s.buttons.ok);t=t.replace("{{ok}}",this.labels.ok)}return f.className="alertify alertify-"+i+" "+e,h.className="alertify-cover",t},close:function(n,t){var e=t&&!isNaN(t)?+t:this.delay,i=this,u,f;(this.bind(n,"click",function(){u(n)}),f=function(n){n.stopPropagation();i.unbind(this,i.transition.type,f);r.removeChild(this);r.hasChildNodes()||(r.className+=" alertify-logs-hidden")},u=function(n){typeof n!="undefined"&&n.parentNode===r&&(i.transition.supported?(i.bind(n,i.transition.type,f),n.className+=" alertify-log-hide"):(r.removeChild(n),r.hasChildNodes()||(r.className+=" alertify-logs-hidden")))},t!==0)&&setTimeout(function(){u(n)},e)},dialog:function(n,t,u,f,e){k=i.activeElement;var o=function(){r&&r.scrollTop!==null&&h&&h.scrollTop!==null||o()};if(typeof n!="string")throw new Error("message must be a string");if(typeof t!="string")throw new Error("type must be a string");if(typeof u!="undefined"&&typeof u!="function")throw new Error("fn must be a function");return this.init(),o(),a.push({type:t,message:n,callback:u,placeholder:f,cssClass:e}),v||this.setup(),this},extend:function(n){if(typeof n!="string")throw new Error("extend method must have exactly one paramter");return function(t,i){return this.log(t,n,i),this}},hide:function(){var n,t=this;a.splice(0,1);a.length>0?this.setup(!0):(v=!1,n=function(i){i.stopPropagation();t.unbind(f,t.transition.type,n)},this.transition.supported?(this.bind(f,this.transition.type,n),f.className="alertify alertify-hide alertify-hidden"):f.className="alertify alertify-hide alertify-hidden alertify-isHidden",h.className="alertify-cover alertify-cover-hidden",k.focus())},init:function(){i.createElement("nav");i.createElement("article");i.createElement("section");e("alertify-cover")==null&&(h=i.createElement("div"),h.setAttribute("id","alertify-cover"),h.className="alertify-cover alertify-cover-hidden",i.body.appendChild(h));e("alertify")==null&&(v=!1,a=[],f=i.createElement("section"),f.setAttribute("id","alertify"),f.className="alertify alertify-hidden",i.body.appendChild(f));e("alertify-logs")==null&&(r=i.createElement("section"),r.setAttribute("id","alertify-logs"),r.className="alertify-logs alertify-logs-hidden",i.body.appendChild(r));i.body.setAttribute("tabindex","0");this.transition=d()},log:function(n,t,i){var u=function(){r&&r.scrollTop!==null||u()};return this.init(),u(),r.className="alertify-logs",this.notify(n,t,i),this},notify:function(n,t,u){var f=i.createElement("article");f.className="alertify-log"+(typeof t=="string"&&t!==""?" alertify-log-"+t:"");f.innerHTML=n;r.appendChild(f);setTimeout(function(){f.className=f.className+" alertify-log-show"},50);this.close(f,u)},set:function(n){var t;if(typeof n!="object"&&n instanceof Array)throw new Error("args must be an object");for(t in n)n.hasOwnProperty(t)&&(this[t]=n[t])},setFocus:function(){o?(o.focus(),o.select()):b.focus()},setup:function(n){var i=a[0],r=this,s;v=!0;s=function(n){n.stopPropagation();r.setFocus();r.unbind(f,r.transition.type,s)};this.transition.supported&&!n&&this.bind(f,this.transition.type,s);f.innerHTML=this.build(i);p=e("alertify-resetFocus");w=e("alertify-resetFocusBack");l=e("alertify-ok")||t;c=e("alertify-cancel")||t;b=u.buttonFocus==="cancel"?c:u.buttonFocus==="none"?e("alertify-noneFocus"):l;o=e("alertify-text")||t;g=e("alertify-form")||t;typeof i.placeholder=="string"&&i.placeholder!==""&&(o.value=i.placeholder);n&&this.setFocus();this.addListeners(i.callback)},unbind:function(n,t,i){typeof n.removeEventListener=="function"?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)}},{alert:function(n,t,i){return u.dialog(n,"alert",t,"",i),this},confirm:function(n,t,i){return u.dialog(n,"confirm",t,"",i),this},extend:u.extend,init:u.init,log:function(n,t,i){return u.log(n,t,i),this},prompt:function(n,t,i,r){return u.dialog(n,"prompt",t,i,r),this},success:function(n,t){return u.log(n,"success",t),this},error:function(n,t){return u.log(n,"error",t),this},set:function(n){u.set(n)},labels:u.labels,debug:u.handleErrors}};typeof define=="function"?define([],function(){return new r}):typeof n.alertify=="undefined"&&(n.alertify=new r)})(this);LokiTridentAdapter.prototype.loadDatabase=function(n,t){var i=this.app;this.db.getAppKey(i,n,function(n){if(typeof t=="function"){if(n.id===0){console.warn("loki trident adapter could not find database");t(null);return}t(n.val)}else console.log(n.val)})};LokiTridentAdapter.prototype.saveDatabase=function(n,t,i){var r=this.app;this.db.setAppKey(r,n,t,i)};LokiTridentAdapter.prototype.deleteDatabase=function(n){var t=this.app;this.db.getAppKey(t,n,function(n){var t=n.id;t!==0&&this.db.deleteAppKey(t)})};LokiTridentAdapter.prototype.getDatabaseList=function(n){var t=this.app;this.db.getAppKeys(t,function(t){for(var i=[],r=0;r<t.length;r++)i.push(t[r].key);typeof n=="function"?n(i):i.forEach(function(n){console.log(n)})})};LokiTridentAdapter.prototype.getCatalogSummary=function(n){var t=this.app;this.db.getAllKeys(function(t){for(var r=[],i,f,e,o,s,u=0;u<t.length;u++)i=t[u],e=i.app||"",o=i.key||"",s=i.val||"",f=e.length*2+o.length*2+s.length+1,r.push({app:i.app,key:i.key,size:f});typeof n=="function"?n(r):r.forEach(function(n){console.log(n)})})};prettyPrint=function(){var n={el:function(t,i){var u=document.createElement(t),r,f;i=n.merge({},i);i&&i.style&&(f=i.style,n.applyCSS(u,i.style),delete i.style);for(r in i)i.hasOwnProperty(r)&&(u[r]=i[r]);return u},applyCSS:function(n,t){for(var i in t)if(t.hasOwnProperty(i))try{n.style[i]=t[i]}catch(r){}},txt:function(n){return document.createTextNode(n)},row:function(t,i,r){r=r||"td";var e=n.count(t,null)+1,f=n.el("tr"),u,o={style:n.getStyles(r,i),colSpan:e,onmouseover:function(){var t=this.parentNode.childNodes;n.forEach(t,function(t){t.nodeName.toLowerCase()==="td"&&n.applyCSS(t,n.getStyles("td_hover",i))})},onmouseout:function(){var t=this.parentNode.childNodes;n.forEach(t,function(t){t.nodeName.toLowerCase()==="td"&&n.applyCSS(t,n.getStyles("td",i))})}};return n.forEach(t,function(t){t!==null&&(u=n.el(r,o),t.nodeType?u.appendChild(t):u.innerHTML=n.shorten(t.toString()),f.appendChild(u))}),f},hRow:function(t,i){return n.row(t,i,"th")},table:function(t,i){t=t||[];var r={thead:{style:n.getStyles("thead",i)},tbody:{style:n.getStyles("tbody",i)},table:{style:n.getStyles("table",i)}},u=n.el("table",r.table),f=n.el("thead",r.thead),e=n.el("tbody",r.tbody);return t.length&&(u.appendChild(f),f.appendChild(n.hRow(t,i))),u.appendChild(e),{node:u,tbody:e,thead:f,appendChild:function(n){this.tbody.appendChild(n)},addRow:function(t,r,u){return this.appendChild(n.row.call(n,t,r||i,u)),this}}},shorten:function(n){var t=60;return n=n.replace(/^\s\s*|\s\s*$|\n/g,""),n.length>t?n.substring(0,t-1)+"...":n},htmlentities:function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},merge:function(t,i){var r,u,f,e;typeof t!="object"&&(t={});for(r in i)if(i.hasOwnProperty(r)){if(u=i[r],typeof u=="object"){t[r]=n.merge(t[r],u);continue}t[r]=u}for(f=2,e=arguments.length;f<e;f++)n.merge(t,arguments[f]);return t},count:function(n,t){for(var r=0,i=0,u=n.length;i<u;i++)n[i]===t&&r++;return r},thead:function(n){return n.getElementsByTagName("thead")[0]},forEach:function(n,t,i){i||(i=t);for(var u=n.length,r=-1;++r<u;)if(i(n[r],r,n)===!1)break;return!0},type:function(n){try{if(n===null)return"null";if(n===undefined)return"undefined";var t=Object.prototype.toString.call(n).match(/\s(.+?)\]/)[1].toLowerCase();return n.nodeType?n.nodeType===1?"domelement":"domnode":/^(string|number|array|regexp|function|date|boolean)$/.test(t)?t:typeof n=="object"?n.jquery&&typeof n.jquery=="string"?"jquery":"object":n===window||n===document?"object":"default"}catch(i){return"default"}},within:function(n){return{is:function(t){for(var i in n)if(n[i]===t)return i;return""}}},common:{circRef:function(i,r){return n.expander("[POINTS BACK TO <strong>"+r+"<\/strong>]","Click to show this item anyway",function(){this.parentNode.appendChild(t(i,{maxDepth:1}))})},depthReached:function(i){return n.expander("[DEPTH REACHED]","Click to show this item anyway",function(){try{this.parentNode.appendChild(t(i,{maxDepth:1}))}catch(r){this.parentNode.appendChild(n.table(["ERROR OCCURED DURING OBJECT RETRIEVAL"],"error").addRow([r.message]).node)}})}},getStyles:function(i,r){return r=t.settings.styles[r]||{},n.merge({},t.settings.styles["default"][i],r[i])},expander:function(t,i,r){return n.el("a",{innerHTML:n.shorten(t)+' <b style="visibility:hidden;">[+]<\/b>',title:i,onmouseover:function(){var n=this.getElementsByTagName("b")[0];n&&(n.style.visibility="visible")},onmouseout:function(){var n=this.getElementsByTagName("b")[0];n&&(n.style.visibility="hidden")},onclick:function(){return this.style.display="none",r.call(this),!1},style:{cursor:"pointer"}})},stringify:function(t){var u=n.type(t),i,f=!0,r;if(u==="array")return i="[",n.forEach(t,function(t,r){i+=(r===0?"":", ")+n.stringify(t)}),i+"]";if(typeof t=="object"){i="{";for(r in t)t.hasOwnProperty(r)&&(i+=(f?"":", ")+r+":"+n.stringify(t[r]),f=!1);return i+"}"}return u==="regexp"?"/"+t.source+"/":u==="string"?'"'+t.replace(/"/g,'\\"')+'"':t.toString()},headerGradient:function(){var n=document.createElement("canvas"),t,i,r;return n.getContext?(t=n.getContext("2d"),n.height=30,n.width=1,i=t.createLinearGradient(0,0,0,30),i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,"rgba(0,0,0,0.25)"),t.fillStyle=i,t.fillRect(0,0,1,30),r=n.toDataURL&&n.toDataURL(),"url("+(r||"")+")"):""}()},t=function(i,r){var e;r=r||{};var u=n.merge({},t.config,r),o=n.el("div"),h=t.config,f={},s=!1;return t.settings=u,e={string:function(t){return n.txt('"'+n.shorten(t.replace(/"/g,'\\"'))+'"')},number:function(t){return n.txt(t)},regexp:function(t){var i=n.table(["RegExp",null],"regexp"),r=n.table(),f=n.expander("/"+t.source+"/","Click to show more",function(){this.parentNode.appendChild(i.node)});return r.addRow(["g",t.global]).addRow(["i",t.ignoreCase]).addRow(["m",t.multiline]),i.addRow(["source","/"+t.source+"/"]).addRow(["flags",r.node]).addRow(["lastIndex",t.lastIndex]),u.expanded?i.node:f},domelement:function(t){var i=n.table(["DOMElement",null],"domelement"),r=t.nodeName||"";return i.addRow(["tag","&lt;"+r.toLowerCase()+"&gt;"]),n.forEach(["id","className","innerHTML","src","href"],function(r){t[r]&&i.addRow([r,n.htmlentities(t[r])])}),u.expanded?i.node:n.expander("DOMElement ("+r.toLowerCase()+")","Click to show more",function(){this.parentNode.appendChild(i.node)})},domnode:function(t){var i=n.table(["DOMNode",null],"domelement"),r=n.htmlentities((t.data||"UNDEFINED").replace(/\n/g,"\\n"));return i.addRow(["nodeType",t.nodeType+" ("+t.nodeName+")"]).addRow(["data",r]),u.expanded?i.node:n.expander("DOMNode","Click to show more",function(){this.parentNode.appendChild(i.node)})},jquery:function(n,t,i){return e.array(n,t,i,!0)},object:function(t,i,r){var v=n.within(f).is(t),o,c,h,l,a,y;if(v)return n.common.circRef(t,v,u);if(f[r||"TOP"]=t,i===u.maxDepth)return n.common.depthReached(t,u);o=n.table(["Object",null],"object");c=!0;for(h in t)if(!t.hasOwnProperty||t.hasOwnProperty(h)){l=t[h];a=n.type(l);c=!1;try{o.addRow([h,e[a](l,i+1,h)],a)}catch(p){window.console&&window.console.log&&console.log(p.message)}}return c?o.addRow(["<small>[empty]<\/small>"]):o.thead.appendChild(n.hRow(["key","value"],"colHeader")),y=u.expanded||s?o.node:n.expander(n.stringify(t),"Click to show more",function(){this.parentNode.appendChild(o.node)}),s=!0,y},array:function(t,i,r,o){var h=n.within(f).is(t);if(h)return n.common.circRef(t,h);if(f[r||"TOP"]=t,i===u.maxDepth)return n.common.depthReached(t);var c=o?"jQuery":"Array",s=n.table([c+"("+t.length+")",null],o?"jquery":c.toLowerCase()),l=!0,a=0;return o&&s.addRow(["selector",t.selector]),n.forEach(t,function(r,f){if(u.maxArray>=0&&++a>u.maxArray)return s.addRow([f+".."+(t.length-1),e[n.type(r)]("...",i+1,f)]),!1;l=!1;s.addRow([f,e[n.type(r)](r,i+1,f)])}),o||(l?s.addRow(["<small>[empty]<\/small>"]):s.thead.appendChild(n.hRow(["index","value"],"colHeader"))),u.expanded?s.node:n.expander(n.stringify(t),"Click to show more",function(){this.parentNode.appendChild(s.node)})},"function":function(t,i,r){var o=n.within(f).is(t);if(o)return n.common.circRef(t,o);f[r||"TOP"]=t;var e=n.table(["Function",null],"function"),c=n.table(["Arguments"]),s=t.toString().match(/\((.+?)\)/),h=t.toString().match(/\(.*?\)\s+?\{?([\S\s]+)/)[1].replace(/\}?$/,"");return e.addRow(["arguments",s?s[1].replace(/[^\w_,\s]/g,""):"<small>[none/native]<\/small>"]).addRow(["body",h]),u.expanded?e.node:n.expander("function(){...}","Click to see more about this function.",function(){this.parentNode.appendChild(e.node)})},date:function(t){var i=n.table(["Date",null],"date"),r=t.toString().split(/\s/);return i.addRow(["Time",r[4]]).addRow(["Date",r.slice(0,4).join("-")]),u.expanded?i.node:n.expander("Date (timestamp): "+ +t,"Click to see a little more info about this date",function(){this.parentNode.appendChild(i.node)})},boolean:function(t){return n.txt(t.toString().toUpperCase())},undefined:function(){return n.txt("UNDEFINED")},"null":function(){return n.txt("NULL")},"default":function(){return n.txt("prettyPrint: TypeNotFound Error")}},o.appendChild(e[u.forceObject?"object":n.type(i)](i,0)),o};return t.config={expanded:!0,forceObject:!1,maxDepth:3,maxArray:-1,styles:{array:{th:{backgroundColor:"#6DBD2A",color:"white"}},"function":{th:{backgroundColor:"#D82525"}},regexp:{th:{backgroundColor:"#E2F3FB",color:"#000"}},object:{th:{backgroundColor:"#1F96CF"}},jquery:{th:{backgroundColor:"#FBF315"}},error:{th:{backgroundColor:"red",color:"yellow"}},domelement:{th:{backgroundColor:"#F3801E"}},date:{th:{backgroundColor:"#A725D8"}},colHeader:{th:{backgroundColor:"#EEE",color:"#000",textTransform:"uppercase"}},"default":{table:{borderCollapse:"collapse",width:"100%"},td:{padding:"5px",fontSize:"12px",backgroundColor:"#FFF",color:"#222",border:"1px solid #000",verticalAlign:"top",fontFamily:'"Consolas","Lucida Console",Courier,mono',whiteSpace:"nowrap"},td_hover:{},th:{padding:"5px",fontSize:"12px",backgroundColor:"#222",color:"#EEE",textAlign:"left",border:"1px solid #000",verticalAlign:"top",fontFamily:'"Consolas","Lucida Console",Courier,mono',backgroundImage:n.headerGradient,backgroundRepeat:"repeat-x"}}}},t}();shortcut={all_shortcuts:{},add:function(n,t,i){var e={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1},f,r,o,u;if(i)for(f in e)typeof i[f]=="undefined"&&(i[f]=e[f]);else i=e;r=i.target;typeof i.target=="string"&&(r=document.getElementById(i.target));o=this;n=n.toLowerCase();u=function(r){var o,e,s;if(r=r||window.event,!i.disable_in_input||(r.target?o=r.target:r.srcElement&&(o=r.srcElement),o.nodeType==3&&(o=o.parentNode),o.tagName!="INPUT"&&o.tagName!="TEXTAREA")){r.keyCode?code=r.keyCode:r.which&&(code=r.which);e=String.fromCharCode(code).toLowerCase();code==188&&(e=",");code==190&&(e=".");var h=n.split("+"),f=0,c={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},l={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},u={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};for(r.ctrlKey&&(u.ctrl.pressed=!0),r.shiftKey&&(u.shift.pressed=!0),r.altKey&&(u.alt.pressed=!0),r.metaKey&&(u.meta.pressed=!0),s=0;k=h[s],s<h.length;s++)k=="ctrl"||k=="control"?(f++,u.ctrl.wanted=!0):k=="shift"?(f++,u.shift.wanted=!0):k=="alt"?(f++,u.alt.wanted=!0):k=="meta"?(f++,u.meta.wanted=!0):k.length>1?l[k]==code&&f++:i.keycode?i.keycode==code&&f++:e==k?f++:c[e]&&r.shiftKey&&(e=c[e],e==k&&f++);if(f==h.length&&u.ctrl.pressed==u.ctrl.wanted&&u.shift.pressed==u.shift.wanted&&u.alt.pressed==u.alt.wanted&&u.meta.pressed==u.meta.wanted&&(t(r),!i.propagate))return r.cancelBubble=!0,r.returnValue=!1,r.stopPropagation&&(r.stopPropagation(),r.preventDefault()),!1}};this.all_shortcuts[n]={callback:u,target:r,event:i.type};r.addEventListener?r.addEventListener(i.type,u,!1):r.attachEvent?r.attachEvent("on"+i.type,u):r["on"+i.type]=u},remove:function(n){var t;if(n=n.toLowerCase(),t=this.all_shortcuts[n],delete this.all_shortcuts[n],t){var r=t.event,i=t.target,u=t.callback;i.detachEvent?i.detachEvent("on"+r,u):i.removeEventListener?i.removeEventListener(r,u,!1):i["on"+r]=!1}}},function(n){var r,f,e,o;n.fn.metrojs={capabilities:null,checkCapabilities:function(t,i){return(n.fn.metrojs.capabilities==null||typeof i!="undefined"&&i==!0)&&(n.fn.metrojs.capabilities=new n.fn.metrojs.MetroModernizr(t)),n.fn.metrojs.capabilities}};r=n.fn.metrojs;f=window.console;typeof f!="object"&&(f={},f.log=function(){},f.error=function(){});e=typeof n.error=="function"?n.error:f.error;o=99e3;n.fn.liveTile=function(t){var r,i;if(u[t]){for(r=[],i=1;i<=arguments.length;i++)r[i-1]=arguments[i];return u[t].apply(this,r)}return typeof t!="object"&&t?(n.error("Method "+t+" does not exist on jQuery.liveTile"),null):u.init.apply(this,arguments)};n.fn.liveTile.contentModules={modules:[],addContentModule:function(n,t){this.modules instanceof Array||(this.modules=[]);this.modules.push(t)},hasContentModule:function(n){if(typeof n=="undefined"||!(this.modules instanceof Array))return-1;for(var t=0;t<this.modules.length;t++)if(typeof this.modules[t].moduleName!="undefined"&&this.modules[t].moduleName==n)return t;return-1}};n.fn.liveTile.defaults={mode:"slide",speed:500,initDelay:-1,delay:5e3,stops:"100%",stack:!1,direction:"vertical",animationDirection:"forward",tileSelector:">div,>li,>p,>img,>a",tileFaceSelector:">div,>li,>p,>img,>a",ignoreDataAttributes:!1,click:null,link:"",newWindow:!1,bounce:!1,bounceDirections:"all",bounceFollowsMove:!0,pauseOnHover:!1,pauseOnHoverEvent:"both",playOnHover:!1,playOnHoverEvent:"both",onHoverDelay:0,onHoverOutDelay:200,repeatCount:-1,appendBack:!0,alwaysTrigger:!1,flipListOnHover:!1,flipListOnHoverEvent:"mouseout",noHAflipOpacity:"1",haTransFunc:"ease",noHaTransFunc:"linear",currentIndex:0,startNow:!0,useModernizr:typeof Modernizr!="undefined",useHardwareAccel:!0,useTranslate:!0,faces:{$front:null,$back:null},animationStarting:function(){},animationComplete:function(){},triggerDelay:function(){return Math.random()*3e3},swap:"",swapFront:"-",swapBack:"-",contentModules:[],rebindMessage:"tile data is missing. Are you missing a call to rebind or destroy? You may also be able to avoid this error by calling stop or pause"};var u={init:function(u){var f=n.extend({},n.fn.liveTile.defaults,u);return r.checkCapabilities(f),i.getBrowserPrefix(),n.fn.liveTile.contentModules.hasContentModule("image")==-1&&n.fn.liveTile.contentModules.addContentModule("image",s.imageSwap),n.fn.liveTile.contentModules.hasContentModule("html")==-1&&n.fn.liveTile.contentModules.addContentModule("html",s.htmlSwap),n(this).each(function(i,r){var e=n(r),u=t.initTileData(e,f),o;u.faces=t.prepTile(e,u);u.fade=function(n){t.fade(e,n)};u.slide=function(n){t.slide(e,n)};u.carousel=function(n){t.carousel(e,n)};u.flip=function(n){t.flip(e,n)};u.flipList=function(n){t.flipList(e,n)};o={fade:u.fade,slide:u.slide,carousel:u.carousel,flip:u.flip,"flip-list":u.flipList};u.doAction=function(n){var t=o[u.mode];typeof t=="function"&&(t(n),u.hasRun=!0);n==u.timer.repeatCount&&(u.runEvents=!1)};u.timer=new n.fn.metrojs.TileTimer(u.delay,u.doAction,u.repeatCount);e.data("LiveTile",u);(u.mode!=="flip-list"||u.flipListOnHover==!1)&&(u.pauseOnHover?t.bindPauseOnHover(e):u.playOnHover&&t.bindPlayOnHover(e,u));(u.link.length>0||typeof u.click=="function")&&e.css({cursor:"pointer"}).bind("click.liveTile",function(n){var t=!0;typeof u.click=="function"&&(t=u.click(e,u)||!1);t&&u.link.length>0&&(n.preventDefault(),u.newWindow?window.open(u.link):window.location=u.link)});t.bindBounce(e,u);u.startNow&&u.mode!="none"&&(u.runEvents=!0,u.timer.start(u.initDelay))})},goto:function(t){var i,r=typeof t,u;if(r==="undefined"&&(i={index:-99,delay:0,autoAniDirection:!1}),r!=="number"&&isNaN(t))if(r==="string")if(t=="next")i={index:-99,delay:0};else if(t.indexOf("prev")===0)i={index:-100,delay:0};else return n.error(t+' is not a recognized action for .liveTile("goto")'),n(this);else r==="object"&&(typeof t.delay=="undefined"&&(t.delay=0),u=typeof t.index,u==="undefined"?t.index=0:u==="string"&&(t.index==="next"?t.index=-99:t.index.indexOf("prev")===0&&(t.index=-100)),i=t);else i={index:parseInt(t,10),delay:0};return n(this).each(function(t,r){var o=n(r),u=o.data("LiveTile"),h=o.data("metrojs.tile"),f=i.index,s,e;if(h.animating===!0)return n(this);if(u.mode==="carousel"){if(s=u.faces.$listTiles.filter(".active"),e=u.faces.$listTiles.index(s),f===-100?((typeof i.autoAniDirection=="undefined"||i.autoAniDirection==!0)&&(u.tempValues.animationDirection=typeof i.animationDirection=="undefined"?"backward":i.animationDirection),f=e===0?u.faces.$listTiles.length-1:e-1):f===-99&&((typeof i.autoAniDirection=="undefined"||i.autoAniDirection==!0)&&(u.tempValues.animationDirection=typeof i.animationDirection=="undefined"?"forward":i.animationDirection),f=e+1),e==f)return;typeof i.direction!="undefined"&&(u.tempValues.direction=i.direction);typeof i.animationDirection!="undefined"&&(u.tempValues.animationDirection=i.animationDirection);u.currentIndex=f==0?u.faces.$listTiles.length:f-1}else u.currentIndex=f;u.runEvents=!0;u.timer.start(i.delay>=0?i.delay:u.delay)})},play:function(t){var i,r=typeof t;return r==="undefined"?i={delay:-1}:r==="number"?i={delay:t}:r==="object"&&(typeof t.delay=="undefined"&&(t.delay=-1),i=t),n(this).each(function(t,r){var f=n(r),u=f.data("LiveTile");u.runEvents=!0;i.delay<0&&!u.hasRun&&(i.delay=u.initDelay);u.timer.start(i.delay>=0?i.delay:u.delay)})},animate:function(){return n(this).each(function(t,i){var r=n(i),u=r.data("LiveTile");u.doAction()})},stop:function(){return n(this).each(function(t,i){var u=n(i),r=u.data("LiveTile");r.hasRun=!1;r.runEvents=!1;r.timer.stop();window.clearTimeout(r.eventTimeout);window.clearTimeout(r.flCompleteTimeout);window.clearTimeout(r.completeTimeout);r.mode==="flip-list"&&r.faces.$listTiles.each(function(t,i){var r=n(i).data("metrojs.tile");window.clearTimeout(r.eventTimeout);window.clearTimeout(r.flCompleteTimeout);window.clearTimeout(r.completeTimeout)})})},pause:function(){return n(this).each(function(t,i){var u=n(i),r=u.data("LiveTile");r.timer.pause();r.runEvents=!1;window.clearTimeout(r.eventTimeout);window.clearTimeout(r.flCompleteTimeout);window.clearTimeout(r.completeTimeout);r.mode==="flip-list"&&r.faces.$listTiles.each(function(t,i){var r=n(i).data("metrojs.tile");window.clearTimeout(r.eventTimeout);window.clearTimeout(r.flCompleteTimeout);window.clearTimeout(r.completeTimeout)})})},restart:function(t){var i,r=typeof t;return r==="undefined"?i={delay:-1}:r==="number"?i={delay:t}:r==="object"&&(typeof t.delay=="undefined"&&(t.delay=-1),i=t),n(this).each(function(t,r){var f=n(r),u=f.data("LiveTile");i.delay<0&&!u.hasRun&&(i.delay=u.initDelay);u.hasRun=!1;u.runEvents=!0;u.timer.restart(i.delay>=0?i.delay:u.delay)})},rebind:function(t){return n(this).each(function(n,i){typeof t!="undefined"?(typeof t.timer!="undefined"&&t.timer!=null&&t.timer.stop(),t.hasRun=!1,u.init.apply(i,[t])):u.init.apply(i,[{}])})},destroy:function(r){var f=typeof r,u;return f==="undefined"?u={removeCss:!1}:f==="boolean"?u={removeCss:r}:f==="object"&&(typeof r.removeCss=="undefined"&&(r.removeCss=!1),u=r),n(this).each(function(r,f){var o=n(f),e=o.data("LiveTile"),s;typeof e!="undefined"&&(o.unbind(".liveTile"),s=i.appendStyleProperties({margin:"",cursor:""},["transform","transition"],["",""]),e.timer.stop(),window.clearTimeout(e.eventTimeout),window.clearTimeout(e.flCompleteTimeout),window.clearTimeout(e.completeTimeout),e.faces.$listTiles!=null&&e.faces.$listTiles.each(function(i,r){var f=n(r),o,h;e.mode==="flip-list"?(o=f.data("metrojs.tile"),window.clearTimeout(o.eventTimeout),window.clearTimeout(o.flCompleteTimeout),window.clearTimeout(o.completeTimeout)):e.mode==="carousel"&&(h=e.listData[i],h.bounce&&t.unbindMsBounce(f,h));u.removeCss?(f.removeClass("ha"),f.find(e.tileFaceSelector).unbind(".liveTile").removeClass("bounce flip-front flip-back ha slide slide-front slide-back").css(s)):f.find(e.tileFaceSelector).unbind(".liveTile");f.removeData("metrojs.tile")}).unbind(".liveTile"),e.faces.$front!=null&&u.removeCss&&e.faces.$front.removeClass("flip-front flip-back ha slide slide-front slide-back").css(s),e.faces.$back!=null&&u.removeCss&&e.faces.$back.removeClass("flip-front flip-back ha slide slide-front slide-back").css(s),e.bounce&&t.unbindMsBounce(o,e),e.playOnHover&&t.unbindMsPlayOnHover(o,e),e.pauseOnhover&&t.unbindMsPauseOnHover(o,e),o.removeClass("ha"),o.removeData("LiveTile"),o.removeData("metrojs.tile"),e=null)})}},t={dataAtr:function(n,t,i){return typeof n.attr("data-"+t)!="undefined"?n.attr("data-"+t):i},dataMethod:function(n,t,i){return typeof n.data(t)!="undefined"?n.data(t):i},getDataOrDefault:null,initTileData:function(i,u){var s=u.ignoreDataAttributes==!1,f=null,e,v,o,a;this.getDataOrDefault==null&&(this.getDataOrDefault=r.capabilities.isOldJQuery?this.dataAtr:this.dataMethod);f=s?{speed:this.getDataOrDefault(i,"speed",u.speed),delay:this.getDataOrDefault(i,"delay",u.delay),stops:this.getDataOrDefault(i,"stops",u.stops),stack:this.getDataOrDefault(i,"stack",u.stack),mode:this.getDataOrDefault(i,"mode",u.mode),direction:this.getDataOrDefault(i,"direction",u.direction),useHardwareAccel:this.getDataOrDefault(i,"ha",u.useHardwareAccel),repeatCount:this.getDataOrDefault(i,"repeat",u.repeatCount),swap:this.getDataOrDefault(i,"swap",u.swap),appendBack:this.getDataOrDefault(i,"appendback",u.appendBack),currentIndex:this.getDataOrDefault(i,"start-index",u.currentIndex),animationDirection:this.getDataOrDefault(i,"ani-direction",u.animationDirection),startNow:this.getDataOrDefault(i,"start-now",u.startNow),tileSelector:this.getDataOrDefault(i,"tile-selector",u.tileSelector),tileFaceSelector:this.getDataOrDefault(i,"face-selector",u.tileFaceSelector),bounce:this.getDataOrDefault(i,"bounce",u.bounce),bounceDirections:this.getDataOrDefault(i,"bounce-dir",u.bounceDirections),bounceFollowsMove:this.getDataOrDefault(i,"bounce-follows",u.bounceFollowsMove),click:this.getDataOrDefault(i,"click",u.click),link:this.getDataOrDefault(i,"link",u.link),newWindow:this.getDataOrDefault(i,"new-window",u.newWindow),alwaysTrigger:this.getDataOrDefault(i,"always-trigger",u.alwaysTrigger),flipListOnHover:this.getDataOrDefault(i,"flip-onhover",u.flipListOnHover),pauseOnHover:this.getDataOrDefault(i,"pause-onhover",u.pauseOnHover),playOnHover:this.getDataOrDefault(i,"play-onhover",u.playOnHover),onHoverDelay:this.getDataOrDefault(i,"hover-delay",u.onHoverDelay),onHoverOutDelay:this.getDataOrDefault(i,"hoverout-delay",u.onHoverOutDelay),noHAflipOpacity:this.getDataOrDefault(i,"flip-opacity",u.noHAflipOpacity),useTranslate:this.getDataOrDefault(i,"use-translate",u.useTranslate),runEvents:!1,isReversed:!1,loopCount:0,contentModules:[],listData:[],height:i.height(),width:i.width(),tempValues:{}}:n.extend(!0,{runEvents:!1,isReversed:!1,loopCount:0,contentModules:[],listData:[],height:i.height(),width:i.width(),tempValues:{}},u);f.useTranslate=f.useTranslate&&f.useHardwareAccel&&r.capabilities.canTransform&&r.capabilities.canTransition;f.margin=f.direction==="vertical"?f.height/2:f.width/2;f.stops=typeof u.stops=="object"&&u.stops instanceof Array?u.stops:(""+f.stops).split(",");f.stops.length===1&&f.stops.push("0px");var h=f.swap instanceof Array?f.swap:f.swap.replace(" ","").split(","),c=s?this.getDataOrDefault(i,"swap-front",u.swapFront):u.swapFront,l=s?this.getDataOrDefault(i,"swap-back",u.swapBack):u.swapBack;for(f.swapFront=c instanceof Array?c:c==="-"?h:c.replace(" ","").split(","),f.swapBack=l instanceof Array?l:l==="-"?h:l.replace(" ","").split(","),e=0;e<f.swapFront.length;e++)f.swapFront[e].length>0&&n.inArray(f.swapFront[e],h)===-1&&h.push(f.swapFront[e]);for(e=0;e<f.swapBack.length;e++)f.swapBack[e].length>0&&n.inArray(f.swapBack[e],h)===-1&&h.push(f.swapBack[e]);for(f.swap=h,e=0;e<h.length;e++)h[e].length>0&&(v=n.fn.liveTile.contentModules.hasContentModule(h[e]),v>-1&&f.contentModules.push(n.fn.liveTile.contentModules.modules[v]));for(f.initDelay=s?this.getDataOrDefault(i,"initdelay",u.initDelay):u.initDelay,f.delay<-1?f.delay=u.triggerDelay(1):f.delay<0&&(f.delay=3500+Math.random()*4501),f.initDelay<0&&(f.initDelay=f.delay),o={},e=0;e<f.contentModules.length;e++)n.extend(o,f.contentModules[e].data);for(n.extend(o,u,f),o.mode==="flip-list"?(a=i.find(o.tileSelector).not(".tile-title"),a.each(function(i,r){var u=n(r),f={direction:s?t.getDataOrDefault(u,"direction",o.direction):o.direction,newWindow:s?t.getDataOrDefault(u,"new-window",!1):!1,link:s?t.getDataOrDefault(u,"link",""):"",faces:{$front:null,$back:null},height:u.height(),width:u.width(),isReversed:!1};f.margin=f.direction==="vertical"?f.height/2:f.width/2;o.listData.push(f)})):o.mode==="carousel"&&(o.stack=!0,a=i.find(o.tileSelector).not(".tile-title"),a.each(function(i,r){var u=n(r),f={bounce:s?t.getDataOrDefault(u,"bounce",!1):!1,bounceDirections:s?t.getDataOrDefault(u,"bounce-dir","all"):"all",link:s?t.getDataOrDefault(u,"link",""):"",newWindow:s?t.getDataOrDefault(u,"new-window",!1):!1,animationDirection:s?t.getDataOrDefault(u,"ani-direction",""):"",direction:s?t.getDataOrDefault(u,"direction",""):""};o.listData.push(f)})),e=0;e<f.contentModules.length;e++)typeof o.contentModules[e].initData=="function"&&o.contentModules[e].initData(o,i);return f=null,o},prepTile:function(u,f){var e,c,l,s,h,a,v,y;u.addClass(f.mode);e={$tileFaces:null,$listTiles:null,$front:null,$back:null};switch(f.mode){case"fade":e.$tileFaces=u.find(f.tileFaceSelector).not(".tile-title");e.$front=f.faces.$front!=null&&f.faces.$front.length>0?f.faces.$front.addClass("fade-front"):e.$tileFaces.filter(":first").addClass("fade-front");e.$back=f.faces.$back!=null&&f.faces.$back.length>0?f.faces.$back.addClass("fade-back"):e.$tileFaces.length>1?e.$tileFaces.filter(":last").addClass("fade-back"):f.appendBack?n('<div class="fade-back"><\/div>').appendTo(u):n("<div><\/div>");break;case"slide":e.$tileFaces=u.find(f.tileFaceSelector).not(".tile-title");e.$front=f.faces.$front!=null&&f.faces.$front.length>0?f.faces.$front.addClass("slide-front"):e.$tileFaces.filter(":first").addClass("slide-front");e.$back=f.faces.$back!=null&&f.faces.$back.length>0?f.faces.$back.addClass("slide-back"):e.$tileFaces.length>1?e.$tileFaces.filter(":last").addClass("slide-back"):f.appendBack?n('<div class="slide-back"><\/div>').appendTo(u):n("<div><\/div>");f.stack==!0&&(f.direction==="vertical"?(a="top",v="translate(0%, -100%) translateZ(0)"):(a="left",v="translate(-100%, 0%) translateZ(0)"),s={},f.useTranslate?i.appendStyleProperties(s,["transform"],[v]):s[a]="-100%",e.$back.css(s));u.data("metrojs.tile",{animating:!1});r.capabilities.canTransition&&f.useHardwareAccel&&(u.addClass("ha"),e.$front.addClass("ha"),e.$back.addClass("ha"));break;case"carousel":e.$listTiles=u.find(f.tileSelector).not(".tile-title");y=e.$listTiles.length;u.data("metrojs.tile",{animating:!1});f.currentIndex=Math.min(f.currentIndex,y-1);e.$listTiles.each(function(u,e){var s=n(e).addClass("slide"),o=f.listData[u],c=typeof o.animationDirection=="string"&&o.animationDirection.length>0?o.animationDirection:f.animationDirection,l=typeof o.direction=="string"&&o.direction.length>0?o.direction:f.direction;u==f.currentIndex?s.addClass("active"):c==="forward"?l==="vertical"?(h=f.useTranslate?i.appendStyleProperties({},["transform"],["translate(0%, 100%) translateZ(0)"]):{left:"0%",top:"100%"},s.css(h)):(h=f.useTranslate?i.appendStyleProperties({},["transform"],["translate(100%, 0%) translateZ(0)"]):{left:"100%",top:"0%"},s.css(h)):c==="backward"&&(l==="vertical"?(h=f.useTranslate?i.appendStyleProperties({},["transform"],["translate(0%, -100%) translateZ(0)"]):{left:"0%",top:"-100%"},s.css(h)):(h=f.useTranslate?i.appendStyleProperties({},["transform"],["translate(-100%, 0%) translateZ(0)"]):{left:"-100%",top:"0%"},s.css(h)));t.bindLink(s,o);f.useHardwareAccel&&r.capabilities.canTransition&&t.bindBounce(s,o);s=null;o=null});r.capabilities.canFlip3d&&f.useHardwareAccel&&(u.addClass("ha"),e.$listTiles.addClass("ha"));break;case"flip-list":e.$listTiles=u.find(f.tileSelector).not(".tile-title");e.$listTiles.each(function(u,e){var h=n(e).addClass("tile-"+(u+1)),y=h.find(f.tileFaceSelector).filter(":first").addClass("flip-front").css({margin:"0px"}),a,v,p,w;h.find(f.tileFaceSelector).length===1&&f.appendBack==!0&&h.append("<div><\/div>");a=h.find(f.tileFaceSelector).filter(":last").addClass("flip-back").css({margin:"0px"});f.listData[u].faces.$front=y;f.listData[u].faces.$back=a;h.data("metrojs.tile",{animating:!1,count:1,completeTimeout:null,flCompleteTimeout:null,index:u});v=h.data("metrojs.tile");r.capabilities.canFlip3d&&f.useHardwareAccel?(h.addClass("ha"),y.addClass("ha"),a.addClass("ha"),c=f.listData[u].direction==="vertical"?"rotateX(180deg)":"rotateY(180deg)",s=i.appendStyleProperties({},["transform"],[c]),a.css(s)):(l=f.listData[u].direction==="vertical"?{height:"100%",width:"100%",marginTop:"0px",opacity:"1"}:{height:"100%",width:"100%",marginLeft:"0px",opacity:"1"},s=f.listData[u].direction==="vertical"?{height:"0px",width:"100%",marginTop:f.listData[u].margin+"px",opacity:f.noHAflipOpacity}:{height:"100%",width:"0px",marginLeft:f.listData[u].margin+"px",opacity:f.noHAflipOpacity},y.css(l),a.css(s));p=function(){v.count++;v.count>=o&&(v.count=1)};f.flipListOnHover&&(w=f.flipListOnHoverEvent+".liveTile",y.bind(w,function(){t.flip(h,v.count,f,p)}),a.bind(w,function(){t.flip(h,v.count,f,p)}));f.listData[u].link.length>0&&h.css({cursor:"pointer"}).bind("click.liveTile",function(){f.listData[u].newWindow?window.open(f.listData[u].link):window.location=f.listData[u].link})});break;case"flip":e.$tileFaces=u.find(f.tileFaceSelector).not(".tile-title");e.$front=f.faces.$front!=null&&f.faces.$front.length>0?f.faces.$front.addClass("flip-front"):e.$tileFaces.filter(":first").addClass("flip-front");e.$back=f.faces.$back!=null&&f.faces.$back.length>0?f.faces.$back.addClass("flip-back"):e.$tileFaces.length>1?e.$tileFaces.filter(":last").addClass("flip-back"):f.appendBack?n('<div class="flip-back"><\/div>').appendTo(u):n("<div><\/div>");u.data("metrojs.tile",{animating:!1});r.capabilities.canFlip3d&&f.useHardwareAccel?(u.addClass("ha"),e.$front.addClass("ha"),e.$back.addClass("ha"),c=f.direction==="vertical"?"rotateX(180deg)":"rotateY(180deg)",s=i.appendStyleProperties({},["transform"],[c]),e.$back.css(s)):(l=f.direction==="vertical"?{height:"100%",width:"100%",marginTop:"0px",opacity:"1"}:{height:"100%",width:"100%",marginLeft:"0px",opacity:"1"},s=f.direction==="vertical"?{height:"0%",width:"100%",marginTop:f.margin+"px",opacity:"0"}:{height:"100%",width:"0%",marginLeft:f.margin+"px",opacity:"0"},e.$front.css(l),e.$back.css(s))}return e},bindPauseOnHover:function(t){(function(){var i=t.data("LiveTile"),f=!1,u=!1,s=!1,h=!1,e=i.pauseOnHoverEvent=="both"||i.pauseOnHoverEvent=="mouseover"||i.pauseOnHoverEvent=="mouseenter",o=i.pauseOnHoverEvent=="both"||i.pauseOnHoverEvent=="mouseout"||i.pauseOnHoverEvent=="mouseleave",c;i.pOnHoverMethods={pause:function(){i.timer.pause();i.mode==="flip-list"&&i.faces.$listTiles.each(function(t,i){window.clearTimeout(n(i).data("metrojs.tile").completeTimeout)})},over:function(n,t){(t=typeof t=="undefined"?!1:t,t||!s)&&(f||u||i.runEvents&&(u=!0,i.eventTimeout=window.setTimeout(function(){u=!1;o&&(f=!0);s=!1;i.pOnHoverMethods.pause()},i.onHoverDelay)))},out:function(n,t){if(t=typeof t=="undefined"?!1:t,t||h!=!0){if(u){window.clearTimeout(i.eventTimeout);u=!1;return}if(e){if(!f&&!u)return;i.runEvents&&i.timer.start(i.hasRun?i.delay:i.initDelay)}else i.pOnHoverMethods.pause();f=!1;h=!1}}};r.capabilities.canTouch?window.PointerEvent||window.MSPointerEvent?(c=window.MSPointerEvent?"MS":"",e&&t[0].addEventListener(c+"PointerOver",i.pOnHoverMethods.over,!1),o&&t[0].addEventListener(c+"PointerOut",i.pOnHoverMethods.out,!1)):(e&&(t.bind("mouseover.liveTile",i.pOnHoverMethods.over),t.bind("touchstart.liveTile",function(n){s=!1;i.pOnHoverMethods.over.apply(t[0],[n,!0])})),o&&(t.bind("mouseout.liveTile",i.pOnHoverMethods.out),t.bind("touchend.liveTile",function(n){h=!1;i.pOnHoverMethods.out.apply(t[0],[n,!0])}))):(e&&t.bind("mouseover.liveTile",i.pOnHoverMethods.over),o&&t.bind("mouseout.liveTile",i.pOnHoverMethods.out))})()},unbindMsPauseOnHover:function(n,t){if(typeof t.pOnHoverMethods!="undefined"&&(window.PointerEvent||window.MSPointerEvent)){var i=window.MSPointerEvent?"MS":"";n[0].removeEventListener(i+"PointerOver",t.pOnHoverMethods.over,!1);n[0].removeEventListener(i+"PointerOut",t.pOnHoverMethods.out,!1)}},bindPlayOnHover:function(n,t){(function(){var f=!1,i=!1,s=!1,h=!1,e=t.playOnHoverEvent=="both"||t.playOnHoverEvent=="mouseover"||t.playOnHoverEvent=="mouseenter",o=t.playOnHoverEvent=="both"||t.playOnHoverEvent=="mouseout"||t.playOnHoverEvent=="mouseleave",c;t.onHoverMethods={over:function(r,e){if((e=typeof e=="undefined"?!1:e,e||!s)&&!f&&!i&&(!t.bounce||t.bounceMethods.down=="no")){var h=t.mode=="flip"||(t.startNow?!t.isReversed:t.isReversed);window.clearTimeout(t.eventTimeout);(t.runEvents&&h||!t.hasRun)&&(i=!0,t.eventTimeout=window.setTimeout(function(){i=!1;o&&(f=!0);u.play.apply(n[0],[0]);s=!1},t.onHoverDelay))}},out:function(r,o){if(o=typeof o=="undefined"?!1:o,o||h!=!0){if(i){window.clearTimeout(t.eventTimeout);i=!1;return}(!e||f||i)&&(window.clearTimeout(t.eventTimeout),t.eventTimeout=window.setTimeout(function(){var i=t.mode=="flip"||(t.startNow?t.isReversed:!t.isReversed);t.runEvents&&i&&u.play.apply(n[0],[0]);h=!1;f=!1},t.speed+t.onHoverOutDelay))}}};r.capabilities.canTouch?window.PointerEvent||window.MSPointerEvent?(c=window.MSPointerEvent?"MS":"",e&&n[0].addEventListener(c+"PointerEnter",t.onHoverMethods.over,!1),o&&n[0].addEventListener(c+"PointerLeave",t.onHoverMethods.out,!1)):(e&&(n.bind("touchstart.liveTile",function(i){s=!0;t.onHoverMethods.over.apply(n[0],[i,!0])}),n.bind("mouseenter.liveTile",t.onHoverMethods.over)),o&&(n.bind("touchend.liveTile,touchcancel.liveTile",function(i){h=!1;t.onHoverMethods.out.apply(n[0],[i,!0])}),n.bind("mouseleave.liveTile",t.onHoverMethods.out))):(e&&n.bind("mouseenter.liveTile",t.onHoverMethods.over),o&&n.bind("mouseleave.liveTile",t.onHoverMethods.out))})()},unbindMsPlayOnHover:function(n,t){if(typeof t.onHoverMethods!="undefined"&&(window.PointerEvent||window.MSPointerEvent)){var i=window.MSPointerEvent?"MS":"";n[0].removeEventListener(i+"PointerOver",t.onHoverMethods.over,!1)}},bindBounce:function(t,u){u.bounce&&(t.addClass("bounce"),t.addClass("noselect"),function(){if(u.bounceMethods={down:"no",threshold:30,zeroPos:{x:0,y:0},eventPos:{x:0,y:0},inTilePos:{x:0,y:0},pointPos:{x:0,y:0},regions:{c:[0,0],tl:[-1,-1],tr:[1,-1],bl:[-1,1],br:[1,1],t:[null,-1],r:[1,null],b:[null,1],l:[-1,null]},targets:{all:["c","t","r","b","l","tl","tr","bl","br"],edges:["c","t","r","b","l"],corners:["c","tl","tr","bl","br"]},hitTest:function(t,i,f,e){var k=u.bounceMethods.regions,h=u.bounceMethods.targets[f],l=0,c=null,y=null,p={hit:[0,0],name:"c"},s,o;if(r.capabilities.isOldAndroid||!r.capabilities.canTransition)return p;typeof h=="undefined"&&(typeof f=="string"&&(h=f.split(",")),n.isArray(h)&&n.inArray("c")==-1&&(e=0,p=null));for(var d=t.width(),g=t.height(),a=[d*e,g*e],w=i.x-d*.5,b=i.y-g*.5,v=[w>0?Math.abs(w)<=a[0]?0:1:Math.abs(w)<=a[0]?0:-1,b>0?Math.abs(b)<=a[1]?0:1:Math.abs(b)<=a[1]?0:-1];l<h.length;l++){if(c!=null)return c;if(s=h[l],o=k[s],s=="*")return s=h[l+1],{region:k[s],name:s};v[0]==o[0]&&v[1]==o[1]?c={hit:o,name:s}:(v[0]==o[0]||o[0]==null)&&(v[1]==o[1]||o[1]==null)&&(y={hit:o,name:s})}return c!=null?c:y!=null?y:p},bounceDown:function(r){var s,h,f,c;if(r.target.tagName!="A"||n(r).is(".bounce")){var e=r.originalEvent&&r.originalEvent.touches?r.originalEvent.touches[0]:r,o=t.offset(),l=window.pageXOffset,a=window.pageYOffset;u.bounceMethods.pointPos={x:e.pageX,y:e.pageY};u.bounceMethods.inTilePos={x:e.pageX-o.left,y:e.pageY-o.top};u.$tileParent||(u.$tileParent=t.parent());s=u.$tileParent.offset();u.bounceMethods.eventPos={x:o.left-s.left+t.width()/2,y:o.top-s.top+t.height()/2};h=u.bounceMethods.hitTest(t,u.bounceMethods.inTilePos,u.bounceDirections,.25);h==null?u.bounceMethods.down="no":(window.PointerEvent||window.MSPointerEvent?(f=window.MSPointerEvent?"MS":"",document.addEventListener(f+"PointerUp",u.bounceMethods.bounceUp,!1),t[0].addEventListener(f+"PointerUp",u.bounceMethods.bounceUp,!1),document.addEventListener(f+"PointerCancel",u.bounceMethods.bounceUp,!1),u.bounceFollowsMove&&t[0].addEventListener(f+"PointerMove",u.bounceMethods.bounceMove,!1)):(n(document).bind("mouseup.liveTile, touchend.liveTile, touchcancel.liveTile, dragstart.liveTile",u.bounceMethods.bounceUp),u.bounceFollowsMove&&(t.bind("touchmove.liveTile",u.bounceMethods.bounceMove),t.bind("mousemove.liveTile",u.bounceMethods.bounceMove))),c="bounce-"+h.name,t.addClass(c),u.bounceMethods.down=c,u.bounceMethods.downPcss=i.appendStyleProperties({},["perspective-origin"],[u.bounceMethods.eventPos.x+"px "+u.bounceMethods.eventPos.y+"px"]),u.$tileParent.css(u.bounceMethods.downPcss))}},bounceUp:function(){if(u.bounceMethods.down!="no"){if(u.bounceMethods.unBounce(),window.PointerEvent||window.MSPointerEvent){var i=window.MSPointerEvent?"MS":"";document.removeEventListener(i+"PointerUp",u.bounceMethods.bounceUp,!1);t[0].removeEventListener(i+"PointerUp",u.bounceMethods.bounceUp,!1);document.removeEventListener(i+"PointerCancel",u.bounceMethods.bounceUp,!1);u.bounceFollowsMove&&t[0].removeEventListener(i+"PointerMove",u.bounceMethods.bounceMove,!1)}else n(document).unbind("mouseup.liveTile, touchend.liveTile, touchcancel.liveTile, dragstart.liveTile",u.bounceMethods.bounceUp);u.bounceFollowsMove&&(t.unbind("touchmove.liveTile",u.bounceMethods.bounceMove),t.unbind("mousemove.liveTile",u.bounceMethods.bounceMove))}},bounceMove:function(n){var i;if(u.bounceMethods.down!="no"){var r=n.originalEvent&&n.originalEvent.touches?n.originalEvent.touches[0]:n,f=Math.abs(r.pageX-u.bounceMethods.pointPos.x),e=Math.abs(r.pageY-u.bounceMethods.pointPos.y);(f>u.bounceMethods.threshold||e>u.bounceMethods.threshold)&&(i=u.bounceMethods.down,u.bounceMethods.bounceDown(n),i!=u.bounceMethods.down&&t.removeClass(i))}},unBounce:function(){if(t.removeClass(u.bounceMethods.down),typeof u.bounceMethods.downPcss=="object")u.bounceMethods.downPcss=i.appendStyleProperties({},["perspective-origin","perspective-origin-x","perspective-origin-y"],["","",""]),window.setTimeout(function(){u.$tileParent.css(u.bounceMethods.downPcss)},200);u.bounceMethods.down="no";u.bounceMethods.inTilePos=u.bounceMethods.zeroPos;u.bounceMethods.eventPos=u.bounceMethods.zeroPos}},window.PointerEvent||window.MSPointerEvent){var f=window.MSPointerEvent?"MS":"";t[0].addEventListener(f+"PointerDown",u.bounceMethods.bounceDown,!1)}else r.capabilities.canTouch?(t.bind("touchstart.liveTile",u.bounceMethods.bounceDown),t.bind("mousedown.liveTile",u.bounceMethods.bounceDown)):t.bind("mousedown.liveTile",u.bounceMethods.bounceDown)}())},unbindMsBounce:function(n,t){if(t.bounce&&(window.PointerEvent||window.MSPointerEvent)){var i=window.MSPointerEvent?"MS":"";n[0].removeEventListener(i+"PointerDown",t.bounceMethods.bounceDown,!1);n[0].removeEventListener(i+"PointerCancel",t.bounceMethods.bounceUp,!1);n[0].removeEventListener(i+"PointerOut",t.bounceMethods.bounceUp,!1)}},bindLink:function(t,i){i.link.length>0&&t.css({cursor:"pointer"}).bind("click.liveTile",function(t){(t.target.tagName!="A"||n(t).is(".live-tile,.slide,.flip"))&&(i.newWindow?window.open(i.link):window.location=i.link)})},runContenModules:function(n,t,i,r){for(var f,u=0;u<n.contentModules.length;u++)f=n.contentModules[u],typeof f.action=="function"&&f.action(n,t,i,r)},fade:function(i,r,u){var f=typeof u=="object"?u:i.data("LiveTile"),c=function(){(f.timer.repeatCount>0||f.timer.repeatCount==-1)&&f.timer.count!=f.timer.repeatCount&&f.timer.start(f.delay)},o,s,h;if(typeof f=="undefined"){e(n.fn.liveTile.defaults.rebindMessage);return}if(!f.faces.$front.is(":animated")){if(f.timer.pause(),o=f.loopCount+1,f.isReversed=o%2==0,s=f.animationStarting.call(i[0],f,f.faces.$front,f.faces.$back),typeof s!="undefined"&&s==!1){c();return}f.loopCount=o;h=function(){c();t.runContenModules(f,f.faces.$front,f.faces.$back);f.animationComplete.call(i[0],f,f.faces.$front,f.faces.$back)};f.isReversed?f.faces.$front.fadeIn(f.speed,f.noHaTransFunc,h):f.faces.$front.fadeOut(f.speed,f.noHaTransFunc,h)}},slide:function(u,f,o,s,h){var c=typeof o=="object"?o:u.data("LiveTile"),l=u.data("metrojs.tile"),tt,it,w,ut,d,g,ft,nt,st,ht;if(typeof c=="undefined"){e(n.fn.liveTile.defaults.rebindMessage);return}if(l.animating==!0||u.is(":animated")){c=null;l=null;return}if(tt=function(){(c.timer.repeatCount>0||c.timer.repeatCount==-1)&&c.timer.count!=c.timer.repeatCount&&c.timer.start(c.delay)},c.mode!=="carousel"){if(c.isReversed=c.currentIndex%2!=0,c.timer.pause(),it=c.animationStarting.call(u[0],c,c.faces.$front,c.faces.$back),typeof it!="undefined"&&it==!1){tt();return}c.loopCount=c.loopCount+1}else c.isReversed=!0;w=typeof c.tempValues.direction=="string"&&c.tempValues.direction.length>0?c.tempValues.direction:c.direction;c.tempValues.direction=null;var a={},v={},ct=typeof s=="undefined"?c.currentIndex:s,y=n.trim(c.stops[Math.min(ct,c.stops.length-1)]),et=y.indexOf("px"),p=0,b=0,lt=w==="vertical"?c.height:c.width,rt=w==="vertical"?"top":"left",k=c.stack==!0,ot=function(){typeof h=="undefined"?(c.currentIndex=c.currentIndex+1,c.currentIndex>c.stops.length-1&&(c.currentIndex=0)):h();c.mode!="carousel"&&tt();t.runContenModules(c,c.faces.$front,c.faces.$back,c.currentIndex);c.animationComplete.call(u[0],c,c.faces.$front,c.faces.$back);c=null;l=null};if(et>0?(b=parseInt(y.substring(0,et),10),p=b-lt+"px"):(b=parseInt(y.replace("%",""),10),p=b-100+"%"),r.capabilities.canTransition&&c.useHardwareAccel){if(typeof l.animating!="undefined"&&l.animating==!0)return;l.animating=!0;ut=["transition-property","transition-duration","transition-timing-function"];d=[c.useTranslate?"transform":rt,c.speed+"ms",c.haTransFunc];d[i.browserPrefix+"transition-property"]=i.browserPrefix+"transform";a=i.appendStyleProperties(a,ut,d);v=i.appendStyleProperties(v,ut,d);g=w==="vertical";ft=g?"top":"left";c.useTranslate?(nt=g?"translate(0%, "+y+")":"translate("+y+", 0%)",a=i.appendStyleProperties(a,["transform"],[nt+"translateZ(0)"]),k&&(nt=g?"translate(0%, "+p+")":"translate("+p+", 0%)",v=i.appendStyleProperties(v,["transform"],[nt+"translateZ(0)"]))):(a[ft]=y,k&&(v[ft]=p));c.faces.$front.css(a);k&&c.faces.$back.css(v);window.clearTimeout(c.completeTimeout);c.completeTimeout=window.setTimeout(function(){l.animating=!1;ot()},c.speed)}else a[rt]=y,v[rt]=p,l.animating=!0,st=c.faces.$front.stop(),ht=c.faces.$back.stop(),st.animate(a,c.speed,c.noHaTransFunc,function(){l.animating=!1;ot()}),k&&ht.animate(v,c.speed,c.noHaTransFunc,function(){})},carousel:function(u,f){var o=u.data("LiveTile"),a,b,tt,v,c,d,s,y,w;if(typeof o=="undefined"){e(n.fn.liveTile.defaults.rebindMessage);return}if(a=u.data("metrojs.tile"),a.animating==!0||o.faces.$listTiles.length<=1){a=null;return}b=function(){(o.timer.repeatCount>0||o.timer.repeatCount==-1)&&o.timer.count!=o.timer.repeatCount&&o.timer.start(o.delay)};o.timer.pause();var h=o.faces.$listTiles.filter(".active"),k=o.faces.$listTiles.index(h),g=o.currentIndex,nt=g!=k?g:k,p=nt+1>=o.faces.$listTiles.length?0:nt+1,l=o.listData[p];if(k==p){a=null;h=null;return}if(tt=typeof o.tempValues.animationDirection=="string"&&o.tempValues.animationDirection.length>0?o.tempValues.animationDirection:typeof l.animationDirection=="string"&&l.animationDirection.length>0?l.animationDirection:o.animationDirection,o.tempValues.animationDirection=null,typeof o.tempValues.direction=="string"&&o.tempValues.direction.length>0?v=o.tempValues.direction:typeof l.direction=="string"&&l.direction.length>0?(v=l.direction,o.tempValues.direction=v):v=o.direction,c=o.faces.$listTiles.eq(p),d=o.animationStarting.call(u[0],o,h,c),typeof d!="undefined"&&d==!1){b();return}o.loopCount=o.loopCount+1;s=i.appendStyleProperties({},["transition-duration"],["0s"]);y=v==="vertical";tt==="backward"?(o.useTranslate&&r.capabilities.canTransition?(w=y?"translate(0%, -100%)":"translate(-100%, 0%)",s=i.appendStyleProperties(s,["transform"],[w+" translateZ(0)"]),o.stops=["100%"]):(y?(s.top="-100%",s.left="0%"):(s.top="0%",s.left="-100%"),o.stops=["100%"]),o.faces.$front=h,o.faces.$back=c):(o.useTranslate&&r.capabilities.canTransition?(w=y?"translate(0%, 100%)":"translate(100%, 0%)",s=i.appendStyleProperties(s,["transform"],[w+" translateZ(0)"])):y?(s.top="100%",s.left="0%"):(s.top="0%",s.left="100%"),o.faces.$front=c,o.faces.$back=h,o.stops=["0%"]);c.css(s);window.setTimeout(function(){h.removeClass("active");c.addClass("active");t.slide(u,f,o,0,function(){o.currentIndex=p;a=null;h=null;c=null;b()})},150)},flip:function(u,f,o,s){var a=u.data("metrojs.tile"),h,nt,ft,tt,it;if(typeof a!="undefined"&&a.animating==!0){a=null;return}if(h=typeof o=="object"?o:u.data("LiveTile"),typeof h=="undefined"){e(n.fn.liveTile.defaults.rebindMessage);return}var c,l,w,g,rt,ut,k=typeof s=="undefined",v=0,y,d=function(){(h.timer.repeatCount>0||h.timer.repeatCount==-1)&&h.timer.count!=h.timer.repeatCount&&h.timer.start(h.delay)};if(k){if(h.timer.pause(),nt=h.loopCount+1,y=nt%2==0,h.isReversed=y,c=h.faces.$front,l=h.faces.$back,ft=y?[h,l,c]:[h,c,l],tt=h.animationStarting.apply(u[0],ft),typeof tt!="undefined"&&tt==!1){d();return}w=h.direction;height=h.height;width=h.width;margin=h.margin;h.loopCount=nt}else y=f%2==0,v=a.index,c=h.listData[v].faces.$front,l=h.listData[v].faces.$back,h.listData[v].isReversed=y,w=h.listData[v].direction,height=h.listData[v].height,width=h.listData[v].width,margin=h.listData[v].margin;if(r.capabilities.canFlip3d&&h.useHardwareAccel){g=y?"360deg":"180deg";rt=w==="vertical"?"rotateX("+g+")":"rotateY("+g+")";ut=i.appendStyleProperties({},["transform","transition"],[rt,"all "+h.speed+"ms "+h.haTransFunc+" 0s"]);var et=y?"540deg":"360deg",ht=w==="vertical"?"rotateX("+et+")":"rotateY("+et+")",ct=i.appendStyleProperties({},["transform","transition"],[ht,"all "+h.speed+"ms "+h.haTransFunc+" 0s"]);c.css(ut);l.css(ct);it=function(){a.animating=!1;var n,r;y?(n=w==="vertical"?"rotateX(0deg)":"rotateY(0deg)",r=i.appendStyleProperties({},["transform","transition"],[n,"all 0s "+h.haTransFunc+" 0s"]),c.css(r),t.runContenModules(h,c,l,v),k?(d(),h.animationComplete.call(u[0],h,c,l)):s(h,c,l),c=null,l=null,h=null,a=null):(t.runContenModules(h,l,c,v),k?(d(),h.animationComplete.call(u[0],h,l,c)):s(h,l,c))};h.mode==="flip-list"?(window.clearTimeout(h.listData[v].completeTimeout),h.listData[v].completeTimeout=window.setTimeout(it,h.speed)):(window.clearTimeout(h.completeTimeout),h.completeTimeout=window.setTimeout(it,h.speed))}else{var p=h.speed/2,ot=w==="vertical"?{height:"0px",width:"100%",marginTop:margin+"px",opacity:h.noHAflipOpacity}:{height:"100%",width:"0px",marginLeft:margin+"px",opacity:h.noHAflipOpacity},st=w==="vertical"?{height:"100%",width:"100%",marginTop:"0px",opacity:"1"}:{height:"100%",width:"100%",marginLeft:"0px",opacity:"1"},b;y?(a.animating=!0,l.stop().animate(ot,{duration:p}),b=function(){a.animating=!1;c.stop().animate(st,{duration:p,complete:function(){t.runContenModules(h,c,l,v);k?(d(),h.animationComplete.call(u[0],h,c,l)):s(h,c,l);a=null;c=null;l=null}})},h.mode==="flip-list"?(window.clearTimeout(h.listData[a.index].completeTimeout),h.listData[a.index].completeTimeout=window.setTimeout(b,p)):(window.clearTimeout(h.completeTimeout),h.completeTimeout=window.setTimeout(b,p))):(a.animating=!0,c.stop().animate(ot,{duration:p}),b=function(){a.animating=!1;l.stop().animate(st,{duration:p,complete:function(){t.runContenModules(h,l,c,v);k?(d(),h.animationComplete.call(u[0],h,l,c)):s(h,l,c);c=null;l=null;h=null;a=null}})},h.mode==="flip-list"?(window.clearTimeout(h.listData[a.index].completeTimeout),h.listData[a.index].completeTimeout=window.setTimeout(b,p)):(window.clearTimeout(h.completeTimeout),h.completeTimeout=window.setTimeout(b,p)))}},flipList:function(i){var r=i.data("LiveTile"),u=r.speed,s=!1,h=function(){(r.timer.repeatCount>0||r.timer.repeatCount==-1)&&r.timer.count!=r.timer.repeatCount&&r.timer.start(r.delay)},f;if(typeof r=="undefined"){e(n.fn.liveTile.defaults.rebindMessage);return}if(r.timer.pause(),f=r.animationStarting.call(i[0],r,null,null),typeof f!="undefined"&&f==!1){h();return}r.loopCount=r.loopCount+1;r.faces.$listTiles.each(function(i,f){var h=n(f),e=h.data("metrojs.tile"),a=r.triggerDelay(i),l=r.speed+Math.max(a,0),c=r.alwaysTrigger;c||(c=Math.random()*351>150?!0:!1);c&&(s=!0,u=Math.max(l+r.speed,u),window.clearTimeout(e.flCompleteTimeout),e.flCompleteTimeout=window.setTimeout(function(){t.flip(h,e.count,r,function(){e.count++;e.count>=o&&(e.count=1);h=null;e=null})},l))});s&&(window.clearTimeout(r.flCompleteTimeout),r.flCompleteTimeout=window.setTimeout(function(){t.runContenModules(r,null,null,-1);r.animationComplete.call(i[0],r,null,null);h()},u+r.speed))}},i={stylePrefixes:"Webkit Moz O ms Khtml ".split(" "),domPrefixes:"-webkit- -moz- -o- -ms- -khtml- ".split(" "),browserPrefix:null,appendStyleProperties:function(t,i,r){for(var u=0;u<=i.length-1;u++)t[n.trim(this.browserPrefix+i[u])]=r[u],t[n.trim(i[u])]=r[u];return t},applyStyleValue:function(t,i,r){return t[n.trim(this.browserPrefix+i)]=r,t[i]=r,t},getBrowserPrefix:function(){var t,n;if(this.browserPrefix==null){for(t="",n=0;n<=this.domPrefixes.length-1;n++)typeof document.body.style[this.domPrefixes[n]+"transform"]!="undefined"&&(t=this.domPrefixes[n]);return this.browserPrefix=t}return this.browserPrefix},shuffleArray:function(n){for(var t=[];n.length;)t.push(n.splice(Math.random()*n.length,1));while(t.length)n.push(t.pop());return n}},s={moduleName:"custom",customSwap:{data:{customDoSwapFront:function(){return!1},customDoSwapBack:function(){return!1},customGetContent:function(){return null}},initData:function(t){var i={};i.doSwapFront=n.inArray("custom",t.swapFront)>-1&&t.customDoSwapFront();i.doSwapBack=n.inArray("custom",t.swapBack)>-1&&t.customDoSwapBack();t.customSwap=typeof t.customSwap!="undefined"?n.extend(i,t.customSwap):i},action:function(){}},htmlSwap:{moduleName:"html",data:{frontContent:[],frontIsRandom:!0,frontIsInGrid:!1,backContent:[],backIsRandom:!0,backIsInGrid:!1},initData:function(i,r){var u={backBag:[],backIndex:0,backStaticIndex:0,backStaticRndm:-1,prevBackIndex:-1,frontBag:[],frontIndex:0,frontStaticIndex:0,frontStaticRndm:-1,prevFrontIndex:-1};i.ignoreDataAttributes?(u.frontIsRandom=i.frontIsRandom,u.frontIsInGrid=i.frontIsInGrid,u.backIsRandom=i.backIsRandom,u.backIsInGrid=i.backIsInGrid):(u.frontIsRandom=t.getDataOrDefault(r,"front-israndom",i.frontIsRandom),u.frontIsInGrid=t.getDataOrDefault(r,"front-isingrid",i.frontIsInGrid),u.backIsRandom=t.getDataOrDefault(r,"back-israndom",i.backIsRandom),u.backIsInGrid=t.getDataOrDefault(r,"back-isingrid",i.backIsInGrid));u.doSwapFront=n.inArray("html",i.swapFront)>-1&&i.frontContent instanceof Array&&i.frontContent.length>0;u.doSwapBack=n.inArray("html",i.swapBack)>-1&&i.backContent instanceof Array&&i.backContent.length>0;i.htmlSwap=typeof i.htmlSwap!="undefined"?n.extend(u,i.htmlSwap):u;i.htmlSwap.doSwapFront&&(i.htmlSwap.frontBag=this.prepBag(i.htmlSwap.frontBag,i.frontContent,i.htmlSwap.prevFrontIndex),i.htmlSwap.frontStaticRndm=i.htmlSwap.frontBag.pop());i.htmlSwap.doSwapBack&&(i.htmlSwap.backBag=this.prepBag(i.htmlSwap.backBag,i.backContent,i.htmlSwap.prevBackIndex),i.htmlSwap.backStaticRndm=i.htmlSwap.backBag.pop())},prepBag:function(n,t,r){var f,u;for(n=n||[],f=0,u=0;u<t.length;u++)(u!=r||n.length===1)&&(n[f]=u,f++);return i.shuffleArray(n)},getFrontSwapIndex:function(n){var t=0;return n.htmlSwap.frontIsRandom?(n.htmlSwap.frontBag.length===0&&(n.htmlSwap.frontBag=this.prepBag(n.htmlSwap.frontBag,n.frontContent,n.htmlSwap.prevFrontIndex)),t=n.htmlSwap.frontIsInGrid?n.htmlSwap.frontStaticRndm:n.htmlSwap.frontBag.pop()):t=n.htmlSwap.frontIsInGrid?n.htmlSwap.frontStaticIndex:n.htmlSwap.frontIndex,t},getBackSwapIndex:function(n){var t=0;return n.htmlSwap.backIsRandom?(n.htmlSwap.backBag.length===0&&(n.htmlSwap.backBag=this.prepBag(n.htmlSwap.backBag,n.backContent,n.htmlSwap.prevBackIndex)),t=n.htmlSwap.backIsInGrid?n.htmlSwap.backStaticRndm:n.htmlSwap.backBag.pop()):t=n.htmlSwap.backIsInGrid?n.htmlSwap.backStaticIndex:n.htmlSwap.backIndex,t},action:function(n,t,i,r){if(n.htmlSwap.doSwapFront||n.htmlSwap.doSwapBack){var f=n.mode==="flip-list",u=0,e=f?n.listData[Math.max(r,0)].isReversed:n.isReversed;if(f&&r==-1){e?n.htmlSwap.doSwapBack&&(n.htmlSwap.backBag.length===0&&(n.htmlSwap.backBag=this.prepBag(n.htmlSwap.backBag,n.backContent,n.htmlSwap.backStaticRndm)),n.htmlSwap.backStaticRndm=n.htmlSwap.backBag.pop(),n.htmlSwap.backStaticIndex++,n.htmlSwap.backStaticIndex>=n.backContent.length&&(n.htmlSwap.backStaticIndex=0)):n.htmlSwap.doSwapFront&&(n.htmlSwap.frontBag.length===0&&(n.htmlSwap.frontBag=this.prepBag(n.htmlSwap.frontBag,n.frontContent,n.htmlSwap.frontStaticRndm)),n.htmlSwap.frontStaticRndm=n.htmlSwap.frontBag.pop(),n.htmlSwap.frontStaticIndex++,n.htmlSwap.frontStaticIndex>=n.frontContent.length&&(n.htmlSwap.frontStaticIndex=0));return}if(e){if(!n.htmlSwap.doSwapBack)return;u=this.getBackSwapIndex(n);n.htmlSwap.prevBackIndex=u;i.html(n.backContent[n.htmlSwap.backIndex]);n.htmlSwap.backIndex++;n.htmlSwap.backIndex>=n.backContent.length&&(n.htmlSwap.backIndex=0);f||(n.htmlSwap.backStaticIndex++,n.htmlSwap.backStaticIndex>=n.backContent.length&&(n.htmlSwap.backStaticIndex=0))}else{if(!n.htmlSwap.doSwapFront)return;u=this.getFrontSwapIndex(n);n.htmlSwap.prevFrontIndex=u;n.mode==="slide"?n.startNow?i.html(n.frontContent[u]):t.html(n.frontContent[u]):i.html(n.frontContent[u]);n.htmlSwap.frontIndex++;n.htmlSwap.frontIndex>=n.frontContent.length&&(n.htmlSwap.frontIndex=0);f||(n.htmlSwap.frontStaticIndex++,n.htmlSwap.frontStaticIndex>=n.frontContent.length&&(n.htmlSwap.frontStaticIndex=0))}}}},imageSwap:{moduleName:"image",data:{preloadImages:!1,imageCssSelector:">img,>a>img",fadeSwap:!1,frontImages:[],frontIsRandom:!0,frontIsBackgroundImage:!1,frontIsInGrid:!1,backImages:null,backIsRandom:!0,backIsBackgroundImage:!1,backIsInGrid:!1},initData:function(i,r){var u={backBag:[],backIndex:0,backStaticIndex:0,backStaticRndm:-1,frontBag:[],frontIndex:0,frontStaticIndex:0,frontStaticRndm:-1,prevBackIndex:-1,prevFrontIndex:-1},f=i.ignoreDataAttributes;f?(u.imageCssSelector=t.getDataOrDefault(r,"image-css",i.imageCssSelector),u.fadeSwap=t.getDataOrDefault(r,"fadeswap",i.fadeSwap),u.frontIsRandom=t.getDataOrDefault(r,"front-israndom",i.frontIsRandom),u.frontIsInGrid=t.getDataOrDefault(r,"front-isingrid",i.frontIsInGrid),u.frontIsBackgroundImage=t.getDataOrDefault(r,"front-isbg",i.frontIsBackgroundImage),u.backIsRandom=t.getDataOrDefault(r,"back-israndom",i.backIsRandom),u.backIsInGrid=t.getDataOrDefault(r,"back-isingrid",i.backIsInGrid),u.backIsBackgroundImage=t.getDataOrDefault(r,"back-isbg",i.backIsBackgroundImage),u.doSwapFront=n.inArray("image",i.swapFront)>-1&&i.frontImages instanceof Array&&i.frontImages.length>0,u.doSwapBack=n.inArray("image",i.swapBack)>-1&&i.backImages instanceof Array&&i.backImages.length>0,u.alwaysSwapFront=t.getDataOrDefault(r,"front-alwaysswap",i.alwaysSwapFront),u.alwaysSwapBack=t.getDataOrDefault(r,"back-alwaysswap",i.alwaysSwapBack)):(u.imageCssSelector=i.imageCssSelector,u.fadeSwap=i.fadeSwap,u.frontIsRandom=i.frontIsRandom,u.frontIsInGrid=i.frontIsInGrid,u.frontIsBackgroundImage=i.frontIsBackgroundImage,u.backIsRandom=i.backIsRandom,u.backIsInGrid=i.backIsInGrid,u.backIsBackgroundImage=i.backIsBackgroundImage,u.doSwapFront=n.inArray("image",i.swapFront)>-1&&i.frontImages instanceof Array&&i.frontImages.length>0,u.doSwapBack=n.inArray("image",i.swapBack)>-1&&i.backImages instanceof Array&&i.backImages.length>0,u.alwaysSwapFront=i.alwaysSwapFront,u.alwaysSwapBack=i.alwaysSwapBack);i.imgSwap=typeof i.imgSwap!="undefined"?n.extend(u,i.imgSwap):u;i.imgSwap.doSwapFront&&(i.imgSwap.frontBag=this.prepBag(i.imgSwap.frontBag,i.frontImages,i.imgSwap.prevFrontIndex),i.imgSwap.frontStaticRndm=i.imgSwap.frontBag.pop(),i.preloadImages&&n(i.frontImages).metrojs.preloadImages(function(){}));i.imgSwap.doSwapBack&&(i.imgSwap.backBag=this.prepBag(i.imgSwap.backBag,i.backImages,i.imgSwap.prevBackIndex),i.imgSwap.backStaticRndm=i.imgSwap.backBag.pop(),i.preloadImages&&n(i.backImages).metrojs.preloadImages(function(){}))},prepBag:function(n,t,r){var f,u;for(n=n||[],f=0,u=0;u<t.length;u++)(u!=r||t.length===1)&&(n[f]=u,f++);return i.shuffleArray(n)},getFrontSwapIndex:function(n){var t=0;return n.imgSwap.frontIsRandom?(n.imgSwap.frontBag.length===0&&(n.imgSwap.frontBag=this.prepBag(n.imgSwap.frontBag,n.frontImages,n.imgSwap.prevFrontIndex)),t=n.imgSwap.frontIsInGrid?n.imgSwap.frontStaticRndm:n.imgSwap.frontBag.pop()):t=n.imgSwap.frontIsInGrid?n.imgSwap.frontStaticIndex:n.imgSwap.frontIndex,t},getBackSwapIndex:function(n){var t=0;return n.imgSwap.backIsRandom?(n.imgSwap.backBag.length===0&&(n.imgSwap.backBag=this.prepBag(n.imgSwap.backBag,n.backImages,n.imgSwap.prevBackIndex)),t=n.imgSwap.backIsInGrid?n.imgSwap.backStaticRndm:n.imgSwap.backBag.pop()):t=n.imgSwap.backIsInGrid?n.imgSwap.backStaticIndex:n.imgSwap.backIndex,t},setImageProperties:function(t,i,r){var f={},u={};typeof i.src!="undefined"&&(r?f.backgroundImage="url('"+i.src+"')":u.src=i.src);typeof i.alt!="undefined"&&(u.alt=i.alt);typeof i.css=="object"?t.css(n.extend(f,i.css)):t.css(f);typeof i.attr=="object"?t.attr(n.extend(u,i.attr)):t.attr(u)},action:function(n,t,i,r){var c,f,l,e;if(n.imgSwap.doSwapFront||n.imgSwap.doSwapBack){var o=n.mode==="flip-list",a=n.mode=="slide",u=0,h=o?n.listData[Math.max(r,0)].isReversed:n.isReversed;if(o&&r==-1){(n.alwaysSwapFront||!h)&&n.imgSwap.doSwapFront&&(n.imgSwap.frontBag.length===0&&(n.imgSwap.frontBag=this.prepBag(n.imgSwap.frontBag,n.frontImages,n.imgSwap.frontStaticRndm)),n.imgSwap.frontStaticRndm=n.imgSwap.frontBag.pop(),n.imgSwap.frontStaticIndex++,n.imgSwap.frontStaticIndex>=n.frontImages.length&&(n.imgSwap.frontStaticIndex=0));(n.alwaysSwapBack||h)&&n.imgSwap.doSwapBack&&(n.imgSwap.backBag.length===0&&(n.imgSwap.backBag=this.prepBag(n.imgSwap.backBag,n.backImages,n.imgSwap.backStaticRndm)),n.imgSwap.backStaticRndm=n.imgSwap.backBag.pop(),n.imgSwap.backStaticIndex++,n.imgSwap.backStaticIndex>=n.backImages.length&&(n.imgSwap.backStaticIndex=0));return}if(n.alwaysSwapFront||!h){if(!n.imgSwap.doSwapFront)return;u=this.getFrontSwapIndex(n);n.imgSwap.prevFrontIndex=u;c=n.mode==="slide"?t:i;f=c.find(n.imgSwap.imageCssSelector);l=typeof n.frontImages[u]=="object"?n.frontImages[u]:{src:n.frontImages[u]};e=function(t){var i=n.imgSwap.frontIsBackgroundImage;typeof t=="function"&&(i?window.setTimeout(t,100):f[0].onload=t);s.imageSwap.setImageProperties(f,l,i)};n.fadeSwap?f.fadeOut(function(){e(function(){f.fadeIn()})}):e();n.imgSwap.frontIndex++;n.imgSwap.frontIndex>=n.frontImages.length&&(n.imgSwap.frontIndex=0);o||(n.imgSwap.frontStaticIndex++,n.imgSwap.frontStaticIndex>=n.frontImages.length&&(n.imgSwap.frontStaticIndex=0))}if(n.alwaysSwapBack||h){if(!n.imgSwap.doSwapBack)return;u=this.getBackSwapIndex(n);n.imgSwap.prevBackIndex=u;c=i;f=c.find(n.imgSwap.imageCssSelector);l=typeof n.backImages[u]=="object"?n.backImages[u]:{src:n.backImages[u]};e=function(){s.imageSwap.setImageProperties(f,l,n.imgSwap.backIsBackgroundImage)};n.fadeSwap?f.fadeOut(function(){e(function(){f.fadeIn()})}):e();n.imgSwap.backIndex++;n.imgSwap.backIndex>=n.backImages.length&&(n.imgSwap.backIndex=0);o||(n.imgSwap.backStaticIndex++,n.imgSwap.backStaticIndex>=n.backImages.length&&(n.imgSwap.backStaticIndex=0))}}}}};n.fn.metrojs.TileTimer=function(n,t,i){this.timerId=null;this.interval=n;this.action=t;this.count=0;this.repeatCount=typeof i=="undefined"?0:i;this.start=function(t){window.clearTimeout(this.timerId);var i=this;this.timerId=window.setTimeout(function(){i.tick.call(i,n)},t)};this.tick=function(n){this.action(this.count+1);this.count++;this.count>=o&&(this.count=0);(this.repeatCount>0||this.repeatCount==-1)&&(this.count!=this.repeatCount?this.start(n):this.stop())};this.stop=function(){this.timerId=window.clearTimeout(this.timerId);this.reset()};this.resume=function(){(this.repeatCount>0||this.repeatCount==-1)&&this.count!=this.repeatCount&&this.start(n)};this.pause=function(){this.timerId=window.clearTimeout(this.timerId)};this.reset=function(){this.count=0};this.restart=function(n){this.stop();this.start(n)}};jQuery.fn.metrojs.theme={loadDefaultTheme:function(n){var t,i,r;typeof n=="undefined"||n==null?n=jQuery.fn.metrojs.theme.defaults:(t=jQuery.fn.metrojs.theme.defaults,jQuery.extend(t,n),n=t);i=typeof localStorage!="undefined";r=function(n){return typeof window.localStorage[n]!="undefined"&&window.localStorage[n]!=null};!i||r("Metro.JS.AccentColor")&&r("Metro.JS.BaseAccentColor")?i?(n.accentColor=window.localStorage["Metro.JS.AccentColor"],n.baseTheme=window.localStorage["Metro.JS.BaseAccentColor"],jQuery(n.accentCssSelector).addClass(n.accentColor).data("accent",n.accentColor),jQuery(n.baseThemeCssSelector).addClass(n.baseTheme),typeof n.loaded=="function"&&n.loaded(n.baseTheme,n.accentColor)):(jQuery(n.accentCssSelector).addClass(n.accentColor).data("accent",n.accentColor),jQuery(n.baseThemeCssSelector).addClass(n.baseTheme),typeof n.loaded=="function"&&n.loaded(n.baseTheme,n.accentColor),typeof n.preloadAltBaseTheme!="undefined"&&n.preloadAltBaseTheme&&jQuery([n.baseTheme=="dark"?n.metroLightUrl:n.metroDarkUrl]).metrojs.preloadImages(function(){})):(window.localStorage["Metro.JS.AccentColor"]=n.accentColor,window.localStorage["Metro.JS.BaseAccentColor"]=n.baseTheme,jQuery(n.accentCssSelector).addClass(n.accentColor).data("accent",n.accentColor),jQuery(n.baseThemeCssSelector).addClass(n.baseTheme),typeof n.loaded=="function"&&n.loaded(n.baseTheme,n.accentColor),typeof n.preloadAltBaseTheme!="undefined"&&n.preloadAltBaseTheme&&jQuery([n.baseTheme=="dark"?n.metroLightUrl:n.metroDarkUrl]).metrojs.preloadImages(function(){}))},applyTheme:function(n,t,i){var e,r,u,f;typeof i=="undefined"||i==null?i=jQuery.fn.metrojs.theme.defaults:(e=jQuery.fn.metrojs.theme.defaults,i=jQuery.extend({},e,i));typeof n!="undefined"&&n!=null&&(typeof localStorage!="undefined"&&(window.localStorage["Metro.JS.BaseAccentColor"]=n),r=jQuery(i.baseThemeCssSelector),r.length>0&&(n=="dark"?r.addClass("dark").removeClass("light"):n=="light"&&r.addClass("light").removeClass("dark")));typeof t!="undefined"&&t!=null&&(typeof localStorage!="undefined"&&(window.localStorage["Metro.JS.AccentColor"]=t),u=jQuery(i.accentCssSelector),u.length>0&&(f=!1,u.each(function(){var i,n;jQuery(this).addClass(t);i=jQuery(this).data("accent");i!=t&&(n=jQuery(this).attr("class").replace(i,""),n=n.replace(/(\s)+/," "),jQuery(this).attr("class",n),jQuery(this).data("accent",t),f=!0)}),f&&typeof i.accentPicked=="function"&&i.accentPicked(t)))},appendAccentColors:function(t){var r,i;typeof t=="undefined"||t==null?t=jQuery.fn.metrojs.theme.defaults:(r=jQuery.fn.metrojs.theme.defaults,t=jQuery.extend({},r,t));var u="",f=t.accentColors,e=t.accentListTemplate;for(i=0;i<f.length;i++)u+=e.replace(/\{0\}/g,f[i]);n(u).appendTo(t.accentListContainer)},appendBaseThemes:function(t){var r,i;typeof t=="undefined"||t==null?t=jQuery.fn.metrojs.theme.defaults:(r=jQuery.fn.metrojs.theme.defaults,t=jQuery.extend({},r,t));var u="",f=t.baseThemes,e=t.baseThemeListTemplate;for(i=0;i<f.length;i++)u+=e.replace(/\{0\}/g,f[i]);n(u).appendTo(t.baseThemeListContainer)},defaults:{baseThemeCssSelector:"body",accentCssSelector:".tiles",accentColor:"blue",baseTheme:"dark",accentColors:["amber","blue","brown","cobalt","crimson","cyan","magenta","lime","indigo","green","emerald","mango","mauve","olive","orange","pink","red","sienna","steel","teal","violet","yellow"],baseThemes:["light","dark"],accentListTemplate:"<li><a href='javascript:;' title='{0}' class='accent {0}'><\/a><\/li>",accentListContainer:"ul.theme-options,.theme-options>ul",baseThemeListTemplate:"<li><a href='javascript:;' title='{0}' class='accent {0}'><\/a><\/li>",baseThemeListContainer:"ul.base-theme-options,.base-theme-options>ul"}};jQuery.fn.applicationBar=function(t){var i=typeof jQuery.fn.metrojs.theme!="undefined"?jQuery.fn.metrojs.theme.defaults:{},r;if(jQuery.extend(i,jQuery.fn.applicationBar.defaults,t),typeof jQuery.fn.metrojs.theme!="undefined"){r=jQuery.fn.metrojs.theme;i.shouldApplyTheme&&r.loadDefaultTheme(i);var u=i.accentListContainer.replace(","," a,")+" a",f=function(){var n=jQuery(this).attr("class").replace("accent","").replace(" ","");r.applyTheme(null,n,i);typeof i.accentPicked=="function"&&i.accentPicked(n)},e=i.baseThemeListContainer.replace(","," a,")+" a",o=function(){var n=jQuery(this).attr("class").replace("accent","").replace(" ","");r.applyTheme(n,null,i);typeof i.themePicked=="function"&&i.themePicked(n)};if(typeof n.fn.on=="function"){n(this).on("click.appBar",u,f);n(this).on("click.appBar",e,o)}else n(u).live("click.appBar",f),n(e).live("click.appBar",o)}return n(this).each(function(t,r){var f=n(r),u=n.extend({},i);u.collapseHeight=="auto"&&(u.collapseHeight=n(this).outerHeight());navigator.userAgent.match(/(Android|webOS|iPhone|iPod|BlackBerry|PIE|IEMobile)/i)&&(navigator.userAgent.match(/(IEMobile\/1)/i)||navigator.userAgent.match(/(iPhone OS [56789])/i)||f.css({position:"absolute",bottom:"0px"}));u.slideOpen=function(){f.hasClass("expanded")||u.animateAppBar(!1)};u.slideClosed=function(){f.hasClass("expanded")&&u.animateAppBar(!0)};u.animateAppBar=function(n){var r=n?u.collapseHeight:u.expandHeight,t;if(n){if(t=i.collapse(),typeof t!="undefined"&&t===!1)return;f.removeClass("expanded")}else{if(t=i.expand(),typeof t!="undefined"&&t===!1)return;f.hasClass("expanded")||f.addClass("expanded")}f.stop().animate({height:r},{duration:u.duration},function(){n?i.collapsed():i.expanded()})};f.data("ApplicationBar",u);f.find(i.handleSelector).click(function(){u.animateAppBar(f.hasClass("expanded"))});u.bindKeyboard==!0&&jQuery(document.documentElement).keyup(function(n){n.keyCode==38?n.target&&n.target.tagName.match(/INPUT|TEXTAREA|SELECT/i)==null&&(f.hasClass("expanded")||u.animateAppBar(!1)):n.keyCode==40&&n.target&&n.target.tagName.match(/INPUT|TEXTAREA|SELECT/i)==null&&f.hasClass("expanded")&&u.animateAppBar(!0)})})};jQuery.fn.applicationBar.defaults={applyTheme:!0,themePicked:function(){},accentPicked:function(){},loaded:function(){},duration:300,expandHeight:"320px",collapseHeight:"auto",bindKeyboard:!0,handleSelector:"a.etc",metroLightUrl:"images/metroIcons_light.jpg",metroDarkUrl:"images/metroIcons.jpg",preloadAltBaseTheme:!1,expand:function(){},collapse:function(){},expanded:function(){},collapsed:function(){}};n.fn.metrojs.preloadImages=function(t){var i=n(this).toArray(),r=n("<img style='display:none;' />").appendTo("body");n(this).each(function(){var n=this;typeof this=="object"&&(n=this.src);r.attr({src:n}).load(function(){for(var n=0;n<i.length;n++)i[n]==element&&i.splice(n,1);i.length==0&&t()})});r.remove()};n.fn.metrojs.MetroModernizr=function(t){if(typeof t=="undefined"&&(t={useHardwareAccel:!0,useModernizr:typeof Modernizr!="undefined"}),this.isOldJQuery=/^1\.[0123]/.test(n.fn.jquery),this.isOldAndroid=function(){var t,i;try{if(t=navigator.userAgent,t.indexOf("Android")>=0&&(i=parseFloat(t.slice(t.indexOf("Android")+8)),i<2.3))return!0}catch(r){n.error(r)}return!1}(),this.canTransform=!1,this.canTransition=!1,this.canTransform3d=!1,this.canAnimate=!1,this.canTouch=!1,this.canFlip3d=t.useHardwareAccel,t.useHardwareAccel==!0)if(t.useModernizr==!1)if(typeof MetroModernizr!="undefined")this.canTransform=window.MetroModernizr.canTransform,this.canTransition=window.MetroModernizr.canTransition,this.canTransform3d=window.MetroModernizr.canTransform3d,this.canAnimate=window.MetroModernizr.canAnimate,this.canTouch=window.MetroModernizr.canTouch;else{window.MetroModernizr={};var i="metromodernizr",r=document.documentElement,e=document.head||document.getElementsByTagName("head")[0],u=document.createElement(i),o=u.style,s=" -webkit- -moz- -o- -ms- ".split(" "),l="Webkit Moz O ms Khtml".split(" "),f=function(n,t){for(var i in n)if(o[n[i]]!==undefined&&(!t||t(n[i],u)))return!0},h=function(n,t){var i=n.charAt(0).toUpperCase()+n.substr(1),r=(n+" "+l.join(i+" ")+i).split(" ");return!!f(r,t)},a=function(){var n=!!f(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);return n&&"webkitPerspective"in r.style&&(n=c(["@media (",s.join("transform-3d),("),i,")","{#metromodernizr{left:9px;position:absolute;height:3px;}}"].join(""),function(n){return n.offsetHeight===3&&n.offsetLeft===9})),n},c=function(n,t){var f=document.createElement("style"),u=document.createElement("div"),o;return f.textContent=n,e.appendChild(f),u.id=i,r.appendChild(u),o=t(u),f.parentNode.removeChild(f),u.parentNode.removeChild(u),!!o},v=function(){return canTouch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||window.PointerEvent&&window.navigator.maxTouchPoints>0||window.MSPointerEvent&&window.navigator.msMaxTouchPoints>0||c(["@media (",s.join("touch-enabled),("),i,")","{#metromodernizr{top:9px;position:absolute}}"].join(""),function(n){return n.offsetTop===9})};this.canTransform=!!f(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"]);this.canTransition=h("transitionProperty");this.canTransform3d=a();this.canAnimate=h("animationName");this.canTouch=v();window.MetroModernizr.canTransform=this.canTransform;window.MetroModernizr.canTransition=this.canTransition;window.MetroModernizr.canTransform3d=this.canTransform3d;window.MetroModernizr.canAnimate=this.canAnimate;window.MetroModernizr.canTouch=this.canTouch;r=null;e=null;u=null;o=null}else this.canTransform=n("html").hasClass("csstransforms"),this.canTransition=n("html").hasClass("csstransitions"),this.canTransform3d=n("html").hasClass("csstransforms3d"),this.canAnimate=n("html").hasClass("cssanimations"),this.canTouch=n("html").hasClass("touch")||typeof window.navigator.msMaxTouchPoints!="undefined"&&window.navigator.msMaxTouchPoints>0;this.canFlip3d=this.canFlip3d&&this.canAnimate&&this.canTransform&&this.canTransform3d}}(jQuery);
/*!
* @license EaselJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2013 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/
this.createjs=this.createjs||{};createjs.extend=function(n,t){"use strict";function i(){this.constructor=n}return i.prototype=t.prototype,n.prototype=new i};this.createjs=this.createjs||{};createjs.promote=function(n,t){"use strict";var i=n.prototype,r=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__,u;if(r){i[(t+="_")+"constructor"]=r.constructor;for(u in r)i.hasOwnProperty(u)&&"function"==typeof r[u]&&(i[t+u]=r[u])}return n};this.createjs=this.createjs||{};createjs.indexOf=function(n,t){"use strict";for(var i=0,r=n.length;r>i;i++)if(t===n[i])return i;return-1};this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i){this.type=n;this.target=null;this.currentTarget=null;this.eventPhase=0;this.bubbles=!!t;this.cancelable=!!i;this.timeStamp=(new Date).getTime();this.defaultPrevented=!1;this.propagationStopped=!1;this.immediatePropagationStopped=!1;this.removed=!1}var n=t.prototype;n.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0};n.stopPropagation=function(){this.propagationStopped=!0};n.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0};n.remove=function(){this.removed=!0};n.clone=function(){return new t(this.type,this.bubbles,this.cancelable)};n.set=function(n){for(var t in n)this[t]=n[t];return this};n.toString=function(){return"[Event (type="+this.type+")]"};createjs.Event=t}();this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null;this._captureListeners=null}var n=t.prototype;t.initialize=function(t){t.addEventListener=n.addEventListener;t.on=n.on;t.removeEventListener=t.off=n.removeEventListener;t.removeAllEventListeners=n.removeAllEventListeners;t.hasEventListener=n.hasEventListener;t.dispatchEvent=n.dispatchEvent;t._dispatchEvent=n._dispatchEvent;t.willTrigger=n.willTrigger};n.addEventListener=function(n,t,i){var u,r;return u=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{},r=u[n],r&&this.removeEventListener(n,t,i),r=u[n],r?r.push(t):u[n]=[t],t};n.on=function(n,t,i,r,u,f){return t.handleEvent&&(i=i||t,t=t.handleEvent),i=i||this,this.addEventListener(n,function(n){t.call(i,n,u);r&&n.remove()},f)};n.removeEventListener=function(n,t,i){var f=i?this._captureListeners:this._listeners,r,u,e;if(f&&(r=f[n],r))for(u=0,e=r.length;e>u;u++)if(r[u]==t){1==e?delete f[n]:r.splice(u,1);break}};n.off=n.removeEventListener;n.removeAllEventListeners=function(n){n?(this._listeners&&delete this._listeners[n],this._captureListeners&&delete this._captureListeners[n]):this._listeners=this._captureListeners=null};n.dispatchEvent=function(n){var u,i,r,t,f;if("string"==typeof n){if(u=this._listeners,!u||!u[n])return!1;n=new createjs.Event(n)}else n.target&&n.clone&&(n=n.clone());try{n.target=this}catch(e){}if(n.bubbles&&this.parent){for(i=this,r=[i];i.parent;)r.push(i=i.parent);for(f=r.length,t=f-1;t>=0&&!n.propagationStopped;t--)r[t]._dispatchEvent(n,1+(0==t));for(t=1;f>t&&!n.propagationStopped;t++)r[t]._dispatchEvent(n,3)}else this._dispatchEvent(n,2);return n.defaultPrevented};n.hasEventListener=function(n){var t=this._listeners,i=this._captureListeners;return!!(t&&t[n]||i&&i[n])};n.willTrigger=function(n){for(var t=this;t;){if(t.hasEventListener(n))return!0;t=t.parent}return!1};n.toString=function(){return"[EventDispatcher]"};n._dispatchEvent=function(n,t){var f,e=1==t?this._captureListeners:this._listeners,i,u,r;if(n&&e){if(i=e[n.type],!i||!(f=i.length))return;try{n.currentTarget=this}catch(o){}try{n.eventPhase=t}catch(o){}for(n.removed=!1,i=i.slice(),u=0;f>u&&!n.immediatePropagationStopped;u++)r=i[u],r.handleEvent?r.handleEvent(n):r(n),n.removed&&(this.off(n.type,r,1==t),n.removed=!1)}};createjs.EventDispatcher=t}();this.createjs=this.createjs||{},function(){"use strict";function n(){throw"Ticker cannot be instantiated.";}n.RAF_SYNCHED="synched";n.RAF="raf";n.TIMEOUT="timeout";n.useRAF=!1;n.timingMode=null;n.maxDelta=0;n.paused=!1;n.removeEventListener=null;n.removeAllEventListeners=null;n.dispatchEvent=null;n.hasEventListener=null;n._listeners=null;createjs.EventDispatcher.initialize(n);n._addEventListener=n.addEventListener;n.addEventListener=function(){return!n._inited&&n.init(),n._addEventListener.apply(n,arguments)};n._inited=!1;n._startTime=0;n._pausedTime=0;n._ticks=0;n._pausedTicks=0;n._interval=50;n._lastTime=0;n._times=null;n._tickTimes=null;n._timerId=null;n._raf=!0;n.setInterval=function(t){n._interval=t;n._inited&&n._setupTick()};n.getInterval=function(){return n._interval};n.setFPS=function(t){n.setInterval(1e3/t)};n.getFPS=function(){return 1e3/n._interval};try{Object.defineProperties(n,{interval:{get:n.getInterval,set:n.setInterval},framerate:{get:n.getFPS,set:n.setFPS}})}catch(i){console.log(i)}n.init=function(){n._inited||(n._inited=!0,n._times=[],n._tickTimes=[],n._startTime=n._getTime(),n._times.push(n._lastTime=0),n.interval=n._interval)};n.reset=function(){if(n._raf){var t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;t&&t(n._timerId)}else clearTimeout(n._timerId);n.removeAllEventListeners("tick");n._timerId=n._times=n._tickTimes=null;n._startTime=n._lastTime=n._ticks=0;n._inited=!1};n.getMeasuredTickTime=function(t){var u=0,i=n._tickTimes,r;if(!i||i.length<1)return-1;for(t=Math.min(i.length,t||0|n.getFPS()),r=0;t>r;r++)u+=i[r];return u/t};n.getMeasuredFPS=function(t){var i=n._times;return!i||i.length<2?-1:(t=Math.min(i.length-1,t||0|n.getFPS()),1e3/((i[0]-i[t])/t))};n.setPaused=function(t){n.paused=t};n.getPaused=function(){return n.paused};n.getTime=function(t){return n._startTime?n._getTime()-(t?n._pausedTime:0):-1};n.getEventTime=function(t){return n._startTime?(n._lastTime||n._startTime)-(t?n._pausedTime:0):-1};n.getTicks=function(t){return n._ticks-(t?n._pausedTicks:0)};n._handleSynch=function(){n._timerId=null;n._setupTick();n._getTime()-n._lastTime>=.97*(n._interval-1)&&n._tick()};n._handleRAF=function(){n._timerId=null;n._setupTick();n._tick()};n._handleTimeout=function(){n._timerId=null;n._setupTick();n._tick()};n._setupTick=function(){var t,i;if(null==n._timerId){if(t=n.timingMode||n.useRAF&&n.RAF_SYNCHED,(t==n.RAF_SYNCHED||t==n.RAF)&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,i))return n._timerId=i(t==n.RAF?n._handleRAF:n._handleSynch),void(n._raf=!0);n._raf=!1;n._timerId=setTimeout(n._handleTimeout,n._interval)}};n._tick=function(){var f=n.paused,t=n._getTime(),u=t-n._lastTime,i,r;for((n._lastTime=t,n._ticks++,f&&(n._pausedTicks++,n._pausedTime+=u),n.hasEventListener("tick"))&&(i=new createjs.Event("tick"),r=n.maxDelta,i.delta=r&&u>r?r:u,i.paused=f,i.time=t,i.runTime=t-n._pausedTime,n.dispatchEvent(i)),n._tickTimes.unshift(n._getTime()-t);n._tickTimes.length>100;)n._tickTimes.pop();for(n._times.unshift(t);n._times.length>100;)n._times.pop()};var t=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);n._getTime=function(){return(t&&t.call(performance)||(new Date).getTime())-n._startTime};createjs.Ticker=n}();this.createjs=this.createjs||{},function(){"use strict";function n(){throw"UID cannot be instantiated";}n._nextID=0;n.get=function(){return n._nextID++};createjs.UID=n}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i,r,u,f,e,o,s,h){this.Event_constructor(n,t,i);this.stageX=r;this.stageY=u;this.rawX=null==s?r:s;this.rawY=null==h?u:h;this.nativeEvent=f;this.pointerID=e;this.primary=!!o}var n=createjs.extend(t,createjs.Event);n._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x};n._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y};n._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(n,{localX:{get:n._get_localX},localY:{get:n._get_localY},isTouch:{get:n._get_isTouch}})}catch(i){}n.clone=function(){return new t(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)};n.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"};createjs.MouseEvent=createjs.promote(t,"Event")}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i,r,u,f){this.setValues(n,t,i,r,u,f)}var n=t.prototype;t.DEG_TO_RAD=Math.PI/180;t.identity=null;n.setValues=function(n,t,i,r,u,f){return this.a=null==n?1:n,this.b=t||0,this.c=i||0,this.d=null==r?1:r,this.tx=u||0,this.ty=f||0,this};n.append=function(n,t,i,r,u,f){var e=this.a,o=this.b,s=this.c,h=this.d;return(1!=n||0!=t||0!=i||1!=r)&&(this.a=e*n+s*t,this.b=o*n+h*t,this.c=e*i+s*r,this.d=o*i+h*r),this.tx=e*u+s*f+this.tx,this.ty=o*u+h*f+this.ty,this};n.prepend=function(n,t,i,r,u,f){var e=this.a,o=this.c,s=this.tx;return this.a=n*e+i*this.b,this.b=t*e+r*this.b,this.c=n*o+i*this.d,this.d=t*o+r*this.d,this.tx=n*s+i*this.ty+u,this.ty=t*s+r*this.ty+f,this};n.appendMatrix=function(n){return this.append(n.a,n.b,n.c,n.d,n.tx,n.ty)};n.prependMatrix=function(n){return this.prepend(n.a,n.b,n.c,n.d,n.tx,n.ty)};n.appendTransform=function(n,i,r,u,f,e,o,s,h){if(f%360)var a=f*t.DEG_TO_RAD,c=Math.cos(a),l=Math.sin(a);else c=1,l=0;return e||o?(e*=t.DEG_TO_RAD,o*=t.DEG_TO_RAD,this.append(Math.cos(o),Math.sin(o),-Math.sin(e),Math.cos(e),n,i),this.append(c*r,l*r,-l*u,c*u,0,0)):this.append(c*r,l*r,-l*u,c*u,n,i),(s||h)&&(this.tx-=s*this.a+h*this.c,this.ty-=s*this.b+h*this.d),this};n.prependTransform=function(n,i,r,u,f,e,o,s,h){if(f%360)var a=f*t.DEG_TO_RAD,c=Math.cos(a),l=Math.sin(a);else c=1,l=0;return(s||h)&&(this.tx-=s,this.ty-=h),e||o?(e*=t.DEG_TO_RAD,o*=t.DEG_TO_RAD,this.prepend(c*r,l*r,-l*u,c*u,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(e),Math.cos(e),n,i)):this.prepend(c*r,l*r,-l*u,c*u,n,i),this};n.rotate=function(n){n*=t.DEG_TO_RAD;var i=Math.cos(n),r=Math.sin(n),u=this.a,f=this.b;return this.a=u*i+this.c*r,this.b=f*i+this.d*r,this.c=-u*r+this.c*i,this.d=-f*r+this.d*i,this};n.skew=function(n,i){return n*=t.DEG_TO_RAD,i*=t.DEG_TO_RAD,this.append(Math.cos(i),Math.sin(i),-Math.sin(n),Math.cos(n),0,0),this};n.scale=function(n,t){return this.a*=n,this.b*=n,this.c*=t,this.d*=t,this};n.translate=function(n,t){return this.tx+=this.a*n+this.c*t,this.ty+=this.b*n+this.d*t,this};n.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this};n.invert=function(){var t=this.a,i=this.b,r=this.c,u=this.d,f=this.tx,n=t*u-i*r;return this.a=u/n,this.b=-i/n,this.c=-r/n,this.d=t/n,this.tx=(r*this.ty-u*f)/n,this.ty=-(t*this.ty-i*f)/n,this};n.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d};n.equals=function(n){return this.tx===n.tx&&this.ty===n.ty&&this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d};n.transformPoint=function(n,t,i){return i=i||{},i.x=n*this.a+t*this.c+this.tx,i.y=n*this.b+t*this.d+this.ty,i};n.decompose=function(n){null==n&&(n={});n.x=this.tx;n.y=this.ty;n.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);n.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var r=Math.atan2(-this.c,this.d),i=Math.atan2(this.b,this.a),u=Math.abs(1-r/i);return 1e-5>u?(n.rotation=i/t.DEG_TO_RAD,this.a<0&&this.d>=0&&(n.rotation+=n.rotation<=0?180:-180),n.skewX=n.skewY=0):(n.skewX=r/t.DEG_TO_RAD,n.skewY=i/t.DEG_TO_RAD),n};n.copy=function(n){return this.setValues(n.a,n.b,n.c,n.d,n.tx,n.ty)};n.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)};n.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"};t.identity=new t;createjs.Matrix2D=t}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i,r,u){this.setValues(n,t,i,r,u)}var n=t.prototype;n.setValues=function(n,t,i,r,u){return this.visible=null==n?!0:!!n,this.alpha=null==t?1:t,this.shadow=i,this.compositeOperation=i,this.matrix=u||this.matrix&&this.matrix.identity()||new createjs.Matrix2D,this};n.append=function(n,t,i,r,u){return this.alpha*=t,this.shadow=i||this.shadow,this.compositeOperation=r||this.compositeOperation,this.visible=this.visible&&n,u&&this.matrix.appendMatrix(u),this};n.prepend=function(n,t,i,r,u){return this.alpha*=t,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||r,this.visible=this.visible&&n,u&&this.matrix.prependMatrix(u),this};n.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this};n.clone=function(){return new t(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())};createjs.DisplayProps=t}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t){this.setValues(n,t)}var n=t.prototype;n.setValues=function(n,t){return this.x=n||0,this.y=t||0,this};n.copy=function(n){return this.x=n.x,this.y=n.y,this};n.clone=function(){return new t(this.x,this.y)};n.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"};createjs.Point=t}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i,r){this.setValues(n,t,i,r)}var n=t.prototype;n.setValues=function(n,t,i,r){return this.x=n||0,this.y=t||0,this.width=i||0,this.height=r||0,this};n.extend=function(n,t,i,r){return i=i||0,r=r||0,n+i>this.x+this.width&&(this.width=n+i-this.x),t+r>this.y+this.height&&(this.height=t+r-this.y),n<this.x&&(this.width+=this.x-n,this.x=n),t<this.y&&(this.height+=this.y-t,this.y=t),this};n.pad=function(n,t,i,r){return this.x-=n,this.y-=t,this.width+=n+i,this.height+=t+r,this};n.copy=function(n){return this.setValues(n.x,n.y,n.width,n.height)};n.contains=function(n,t,i,r){return i=i||0,r=r||0,n>=this.x&&n+i<=this.x+this.width&&t>=this.y&&t+r<=this.y+this.height};n.union=function(n){return this.clone().extend(n.x,n.y,n.width,n.height)};n.intersection=function(n){var i=n.x,r=n.y,u=i+n.width,f=r+n.height;return this.x>i&&(i=this.x),this.y>r&&(r=this.y),this.x+this.width<u&&(u=this.x+this.width),this.y+this.height<f&&(f=this.y+this.height),i>=u||r>=f?null:new t(i,r,u-i,f-r)};n.intersects=function(n){return n.x<=this.x+this.width&&this.x<=n.x+n.width&&n.y<=this.y+this.height&&this.y<=n.y+n.height};n.isEmpty=function(){return this.width<=0||this.height<=0};n.clone=function(){return new t(this.x,this.y,this.width,this.height)};n.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"};createjs.Rectangle=t}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i,r,u,f,e){n.addEventListener&&(this.target=n,this.overLabel=null==i?"over":i,this.outLabel=null==t?"out":t,this.downLabel=null==r?"down":r,this.play=u,this._isPressed=!1,this._isOver=!1,this._enabled=!1,n.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),f&&(e&&(f.actionsEnabled=!1,f.gotoAndStop&&f.gotoAndStop(e)),n.hitArea=f))}var n=t.prototype;n.setEnabled=function(n){if(n!=this._enabled){var t=this.target;this._enabled=n;n?(t.cursor="pointer",t.addEventListener("rollover",this),t.addEventListener("rollout",this),t.addEventListener("mousedown",this),t.addEventListener("pressup",this)):(t.cursor=null,t.removeEventListener("rollover",this),t.removeEventListener("rollout",this),t.removeEventListener("mousedown",this),t.removeEventListener("pressup",this))}};n.getEnabled=function(){return this._enabled};try{Object.defineProperties(n,{enabled:{get:n.getEnabled,set:n.setEnabled}})}catch(i){}n.toString=function(){return"[ButtonHelper]"};n.handleEvent=function(n){var t,i=this.target,r=n.type;"mousedown"==r?(this._isPressed=!0,t=this.downLabel):"pressup"==r?(this._isPressed=!1,t=this._isOver?this.overLabel:this.outLabel):"rollover"==r?(this._isOver=!0,t=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,t=this._isPressed?this.overLabel:this.outLabel);this.play?i.gotoAndPlay&&i.gotoAndPlay(t):i.gotoAndStop&&i.gotoAndStop(t)};createjs.ButtonHelper=t}();this.createjs=this.createjs||{},function(){"use strict";function n(n,t,i,r){this.color=n||"black";this.offsetX=t||0;this.offsetY=i||0;this.blur=r||0}var t=n.prototype;n.identity=new n("transparent",0,0,0);t.toString=function(){return"[Shadow]"};t.clone=function(){return new n(this.color,this.offsetX,this.offsetY,this.blur)};createjs.Shadow=n}();this.createjs=this.createjs||{},function(){"use strict";function t(n){this.EventDispatcher_constructor();this.complete=!0;this.framerate=0;this._animations=null;this._frames=null;this._images=null;this._data=null;this._loadCount=0;this._frameHeight=0;this._frameWidth=0;this._numFrames=0;this._regX=0;this._regY=0;this._spacing=0;this._margin=0;this._parseData(n)}var n=createjs.extend(t,createjs.EventDispatcher);n.getAnimations=function(){return this._animations.slice()};try{Object.defineProperties(n,{animations:{get:n.getAnimations}})}catch(i){}n.getNumFrames=function(n){if(null==n)return this._frames?this._frames.length:this._numFrames||0;var t=this._data[n];return null==t?0:t.frames.length};n.getAnimation=function(n){return this._data[n]};n.getFrame=function(n){var t;return this._frames&&(t=this._frames[n])?t:null};n.getFrameBounds=function(n,t){var i=this.getFrame(n);return i?(t||new createjs.Rectangle).setValues(-i.regX,-i.regY,i.rect.width,i.rect.height):null};n.toString=function(){return"[SpriteSheet]"};n.clone=function(){throw"SpriteSheet cannot be cloned.";};n._parseData=function(n){var r,h,u,f,e,l,o,s,t,i,c;if(null!=n){if(this.framerate=n.framerate||0,n.images&&(h=n.images.length)>0)for(f=this._images=[],r=0;h>r;r++)e=n.images[r],"string"==typeof e&&(l=e,e=document.createElement("img"),e.src=l),f.push(e),e.getContext||e.complete||(this._loadCount++,this.complete=!1,function(n){e.onload=function(){n._handleImageLoad()}}(this));if(null!=n.frames)if(n.frames instanceof Array)for(this._frames=[],f=n.frames,r=0,h=f.length;h>r;r++)o=f[r],this._frames.push({image:this._images[o[4]?o[4]:0],rect:new createjs.Rectangle(o[0],o[1],o[2],o[3]),regX:o[5]||0,regY:o[6]||0});else u=n.frames,this._frameWidth=u.width,this._frameHeight=u.height,this._regX=u.regX||0,this._regY=u.regY||0,this._spacing=u.spacing||0,this._margin=u.margin||0,this._numFrames=u.count,0==this._loadCount&&this._calculateFrames();if(this._animations=[],null!=(u=n.animations)){this._data={};for(s in u){if(t={name:s},i=u[s],"number"==typeof i)f=t.frames=[i];else if(i instanceof Array)if(1==i.length)t.frames=[i[0]];else for(t.speed=i[3],t.next=i[2],f=t.frames=[],r=i[0];r<=i[1];r++)f.push(r);else t.speed=i.speed,t.next=i.next,c=i.frames,f=t.frames="number"==typeof c?[c]:c.slice(0);(t.next===!0||void 0===t.next)&&(t.next=s);(t.next===!1||f.length<2&&t.next==s)&&(t.next=null);t.speed||(t.speed=1);this._animations.push(s);this._data[s]=t}}}};n._handleImageLoad=function(){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))};n._calculateFrames=function(){var t,e,i;if(!this._frames&&0!=this._frameWidth){this._frames=[];var c=this._numFrames||1e5,r=0,u=this._frameWidth,f=this._frameHeight,h=this._spacing,n=this._margin;n:for(t=0,e=this._images;t<e.length;t++)for(var o=e[t],l=o.width,a=o.height,s=n;a-n-f>=s;){for(i=n;l-n-u>=i;){if(r>=c)break n;r++;this._frames.push({image:o,rect:new createjs.Rectangle(i,s,u,f),regX:this._regX,regY:this._regY});i+=u+h}s+=f+h}this._numFrames=r}};createjs.SpriteSheet=createjs.promote(t,"EventDispatcher")}();this.createjs=this.createjs||{},function(){"use strict";function i(){this.command=null;this._stroke=null;this._strokeStyle=null;this._strokeIgnoreScale=!1;this._fill=null;this._instructions=[];this._commitIndex=0;this._activeInstructions=[];this._dirty=!1;this._storeIndex=0;this.clear()}var n=i.prototype,t=i,r;i.getRGB=function(n,t,i,r){return null!=n&&null==i&&(r=t,i=255&n,t=n>>8&255,n=n>>16&255),null==r?"rgb("+n+","+t+","+i+")":"rgba("+n+","+t+","+i+","+r+")"};i.getHSL=function(n,t,i,r){return null==r?"hsl("+n%360+","+t+"%,"+i+"%)":"hsla("+n%360+","+t+"%,"+i+"%,"+r+")"};i.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63};i.STROKE_CAPS_MAP=["butt","round","square"];i.STROKE_JOINTS_MAP=["miter","round","bevel"];r=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");r.getContext&&(i._ctx=r.getContext("2d"),r.width=r.height=1);n.getInstructions=function(){return this._updateInstructions(),this._instructions};try{Object.defineProperties(n,{instructions:{get:n.getInstructions}})}catch(u){}n.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)};n.draw=function(n,t){this._updateInstructions();for(var r=this._instructions,i=this._storeIndex,u=r.length;u>i;i++)r[i].exec(n,t)};n.drawAsPath=function(n){this._updateInstructions();for(var i,r=this._instructions,t=this._storeIndex,u=r.length;u>t;t++)(i=r[t]).path!==!1&&i.exec(n)};n.moveTo=function(n,i){return this.append(new t.MoveTo(n,i),!0)};n.lineTo=function(n,i){return this.append(new t.LineTo(n,i))};n.arcTo=function(n,i,r,u,f){return this.append(new t.ArcTo(n,i,r,u,f))};n.arc=function(n,i,r,u,f,e){return this.append(new t.Arc(n,i,r,u,f,e))};n.quadraticCurveTo=function(n,i,r,u){return this.append(new t.QuadraticCurveTo(n,i,r,u))};n.bezierCurveTo=function(n,i,r,u,f,e){return this.append(new t.BezierCurveTo(n,i,r,u,f,e))};n.rect=function(n,i,r,u){return this.append(new t.Rect(n,i,r,u))};n.closePath=function(){return this._activeInstructions.length?this.append(new t.ClosePath):this};n.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._stroke=this._fill=null,this._dirty=this._strokeIgnoreScale=!1,this};n.beginFill=function(n){return this._setFill(n?new t.Fill(n):null)};n.beginLinearGradientFill=function(n,i,r,u,f,e){return this._setFill((new t.Fill).linearGradient(n,i,r,u,f,e))};n.beginRadialGradientFill=function(n,i,r,u,f,e,o,s){return this._setFill((new t.Fill).radialGradient(n,i,r,u,f,e,o,s))};n.beginBitmapFill=function(n,i,r){return this._setFill(new t.Fill(null,r).bitmap(n,i))};n.endFill=function(){return this.beginFill()};n.setStrokeStyle=function(n,i,r,u,f){return this._updateInstructions(!0),this._strokeStyle=this.command=new t.StrokeStyle(n,i,r,u,f),this._stroke&&(this._stroke.ignoreScale=f),this._strokeIgnoreScale=f,this};n.beginStroke=function(n){return this._setStroke(n?new t.Stroke(n):null)};n.beginLinearGradientStroke=function(n,i,r,u,f,e){return this._setStroke((new t.Stroke).linearGradient(n,i,r,u,f,e))};n.beginRadialGradientStroke=function(n,i,r,u,f,e,o,s){return this._setStroke((new t.Stroke).radialGradient(n,i,r,u,f,e,o,s))};n.beginBitmapStroke=function(n,i){return this._setStroke((new t.Stroke).bitmap(n,i))};n.endStroke=function(){return this.beginStroke()};n.curveTo=n.quadraticCurveTo;n.drawRect=n.rect;n.drawRoundRect=function(n,t,i,r,u){return this.drawRoundRectComplex(n,t,i,r,u,u,u,u)};n.drawRoundRectComplex=function(n,i,r,u,f,e,o,s){return this.append(new t.RoundRect(n,i,r,u,f,e,o,s))};n.drawCircle=function(n,i,r){return this.append(new t.Circle(n,i,r))};n.drawEllipse=function(n,i,r,u){return this.append(new t.Ellipse(n,i,r,u))};n.drawPolyStar=function(n,i,r,u,f,e){return this.append(new t.PolyStar(n,i,r,u,f,e))};n.append=function(n,t){return this._activeInstructions.push(n),this.command=n,t||(this._dirty=!0),this};n.decodePath=function(n){for(var y,l,u,t,p,w=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],b=[2,2,4,6,0],r=0,k=n.length,e=[],o=0,s=0,f=i.BASE_64;k>r;){var a=n.charAt(r),h=f[a],c=h>>3,v=w[c];if(!v||3&h)throw"bad path data (@"+r+"): "+a;for(y=b[c],c||(o=s=0),e.length=0,r++,l=(h>>2&1)+2,u=0;y>u;u++)t=f[n.charAt(r)],p=t>>5?-1:1,t=(31&t)<<6|f[n.charAt(r+1)],3==l&&(t=t<<6|f[n.charAt(r+2)]),t=p*t/10,u%2?o=t+=o:s=t+=s,e[u]=t,r+=l;v.apply(this,e)}return this};n.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this};n.unstore=function(){return this._storeIndex=0,this};n.clone=function(){var n=new i;return n.command=this.command,n._stroke=this._stroke,n._strokeStyle=this._strokeStyle,n._strokeIgnoreScale=this._strokeIgnoreScale,n._fill=this._fill,n._instructions=this._instructions.slice(),n._commitIndex=this._commitIndex,n._activeInstructions=this._activeInstructions.slice(),n._dirty=this._dirty,n._storeIndex=this._storeIndex,n};n.toString=function(){return"[Graphics]"};n.mt=n.moveTo;n.lt=n.lineTo;n.at=n.arcTo;n.bt=n.bezierCurveTo;n.qt=n.quadraticCurveTo;n.a=n.arc;n.r=n.rect;n.cp=n.closePath;n.c=n.clear;n.f=n.beginFill;n.lf=n.beginLinearGradientFill;n.rf=n.beginRadialGradientFill;n.bf=n.beginBitmapFill;n.ef=n.endFill;n.ss=n.setStrokeStyle;n.s=n.beginStroke;n.ls=n.beginLinearGradientStroke;n.rs=n.beginRadialGradientStroke;n.bs=n.beginBitmapStroke;n.es=n.endStroke;n.dr=n.drawRect;n.rr=n.drawRoundRect;n.rc=n.drawRoundRectComplex;n.dc=n.drawCircle;n.de=n.drawEllipse;n.dp=n.drawPolyStar;n.p=n.decodePath;n._updateInstructions=function(n){var t=this._instructions,u=this._activeInstructions,o=this._commitIndex,f,e,r;if(this._dirty&&u.length){for(t.length=o,t.push(i.beginCmd),f=u.length,e=t.length,t.length=e+f,r=0;f>r;r++)t[r+e]=u[r];this._fill&&t.push(this._fill);this._stroke&&this._strokeStyle&&t.push(this._strokeStyle);this._stroke&&t.push(this._stroke);this._dirty=!1}n&&(u.length=0,this._commitIndex=t.length)};n._setFill=function(n){return this._updateInstructions(!0),(this._fill=n)&&(this.command=n),this};n._setStroke=function(n){return this._updateInstructions(!0),(this._stroke=n)&&(this.command=n,n.ignoreScale=this._strokeIgnoreScale),this};(t.LineTo=function(n,t){this.x=n;this.y=t}).prototype.exec=function(n){n.lineTo(this.x,this.y)};(t.MoveTo=function(n,t){this.x=n;this.y=t}).prototype.exec=function(n){n.moveTo(this.x,this.y)};(t.ArcTo=function(n,t,i,r,u){this.x1=n;this.y1=t;this.x2=i;this.y2=r;this.radius=u}).prototype.exec=function(n){n.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)};(t.Arc=function(n,t,i,r,u,f){this.x=n;this.y=t;this.radius=i;this.startAngle=r;this.endAngle=u;this.anticlockwise=!!f}).prototype.exec=function(n){n.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)};(t.QuadraticCurveTo=function(n,t,i,r){this.cpx=n;this.cpy=t;this.x=i;this.y=r}).prototype.exec=function(n){n.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)};(t.BezierCurveTo=function(n,t,i,r,u,f){this.cp1x=n;this.cp1y=t;this.cp2x=i;this.cp2y=r;this.x=u;this.y=f}).prototype.exec=function(n){n.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)};(t.Rect=function(n,t,i,r){this.x=n;this.y=t;this.w=i;this.h=r}).prototype.exec=function(n){n.rect(this.x,this.y,this.w,this.h)};(t.ClosePath=function(){}).prototype.exec=function(n){n.closePath()};(t.BeginPath=function(){}).prototype.exec=function(n){n.beginPath()};n=(t.Fill=function(n,t){this.style=n;this.matrix=t}).prototype;n.exec=function(n){if(this.style){n.fillStyle=this.style;var t=this.matrix;t&&(n.save(),n.transform(t.a,t.b,t.c,t.d,t.tx,t.ty));n.fill();t&&n.restore()}};n.linearGradient=function(n,t,r,u,f,e){for(var s=this.style=i._ctx.createLinearGradient(r,u,f,e),o=0,h=n.length;h>o;o++)s.addColorStop(t[o],n[o]);return s.props={colors:n,ratios:t,x0:r,y0:u,x1:f,y1:e,type:"linear"},this};n.radialGradient=function(n,t,r,u,f,e,o,s){for(var c=this.style=i._ctx.createRadialGradient(r,u,f,e,o,s),h=0,l=n.length;l>h;h++)c.addColorStop(t[h],n[h]);return c.props={colors:n,ratios:t,x0:r,y0:u,r0:f,x1:e,y1:o,r1:s,type:"radial"},this};n.bitmap=function(n,t){var r=this.style=i._ctx.createPattern(n,t||"");return r.props={image:n,repetition:t,type:"bitmap"},this};n.path=!1;n=(t.Stroke=function(n,t){this.style=n;this.ignoreScale=t}).prototype;n.exec=function(n){this.style&&(n.strokeStyle=this.style,this.ignoreScale&&(n.save(),n.setTransform(1,0,0,1,0,0)),n.stroke(),this.ignoreScale&&n.restore())};n.linearGradient=t.Fill.prototype.linearGradient;n.radialGradient=t.Fill.prototype.radialGradient;n.bitmap=t.Fill.prototype.bitmap;n.path=!1;n=(t.StrokeStyle=function(n,t,i,r){this.width=n;this.caps=t;this.joints=i;this.miterLimit=r}).prototype;n.exec=function(n){n.lineWidth=null==this.width?"1":this.width;n.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:i.STROKE_CAPS_MAP[this.caps];n.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:i.STROKE_JOINTS_MAP[this.joints];n.miterLimit=null==this.miterLimit?"10":this.miterLimit};n.path=!1;(t.RoundRect=function(n,t,i,r,u,f,e,o){this.x=n;this.y=t;this.w=i;this.h=r;this.radiusTL=u;this.radiusTR=f;this.radiusBR=e;this.radiusBL=o}).prototype.exec=function(n){var o=(h>s?s:h)/2,c=0,l=0,a=0,v=0,t=this.x,i=this.y,s=this.w,h=this.h,r=this.radiusTL,u=this.radiusTR,f=this.radiusBR,e=this.radiusBL;0>r&&(r*=c=-1);r>o&&(r=o);0>u&&(u*=l=-1);u>o&&(u=o);0>f&&(f*=a=-1);f>o&&(f=o);0>e&&(e*=v=-1);e>o&&(e=o);n.moveTo(t+s-u,i);n.arcTo(t+s+u*l,i-u*l,t+s,i+u,u);n.lineTo(t+s,i+h-f);n.arcTo(t+s+f*a,i+h+f*a,t+s-f,i+h,f);n.lineTo(t+e,i+h);n.arcTo(t-e*v,i+h+e*v,t,i+h-e,e);n.lineTo(t,i+r);n.arcTo(t-r*c,i-r*c,t+r,i,r);n.closePath()};(t.Circle=function(n,t,i){this.x=n;this.y=t;this.radius=i}).prototype.exec=function(n){n.arc(this.x,this.y,this.radius,0,2*Math.PI)};(t.Ellipse=function(n,t,i,r){this.x=n;this.y=t;this.w=i;this.h=r}).prototype.exec=function(n){var i=this.x,u=this.y,o=this.w,s=this.h,l=.5522848,f=o/2*l,e=s/2*l,h=i+o,c=u+s,r=i+o/2,t=u+s/2;n.moveTo(i,t);n.bezierCurveTo(i,t-e,r-f,u,r,u);n.bezierCurveTo(r+f,u,h,t-e,h,t);n.bezierCurveTo(h,t+e,r+f,c,r,c);n.bezierCurveTo(r-f,c,i,t+e,i,t)};(t.PolyStar=function(n,t,i,r,u,f){this.x=n;this.y=t;this.radius=i;this.sides=r;this.pointSize=u;this.angle=f}).prototype.exec=function(n){var r=this.x,u=this.y,i=this.radius,t=(this.angle||0)/180*Math.PI,o=this.sides,f=1-(this.pointSize||0),s=Math.PI/o,e;for(n.moveTo(r+Math.cos(t)*i,u+Math.sin(t)*i),e=0;o>e;e++)t+=s,1!=f&&n.lineTo(r+Math.cos(t)*i*f,u+Math.sin(t)*i*f),t+=s,n.lineTo(r+Math.cos(t)*i,u+Math.sin(t)*i);n.closePath()};i.beginCmd=new t.BeginPath;createjs.Graphics=i}();this.createjs=this.createjs||{},function(){"use strict";function t(){this.EventDispatcher_constructor();this.alpha=1;this.cacheCanvas=null;this.cacheID=0;this.id=createjs.UID.get();this.mouseEnabled=!0;this.tickEnabled=!0;this.name=null;this.parent=null;this.regX=0;this.regY=0;this.rotation=0;this.scaleX=1;this.scaleY=1;this.skewX=0;this.skewY=0;this.shadow=null;this.visible=!0;this.x=0;this.y=0;this.transformMatrix=null;this.compositeOperation=null;this.snapToPixel=!0;this.filters=null;this.mask=null;this.hitArea=null;this.cursor=null;this._cacheOffsetX=0;this._cacheOffsetY=0;this._filterOffsetX=0;this._filterOffsetY=0;this._cacheScale=1;this._cacheDataURLID=0;this._cacheDataURL=null;this._props=new createjs.DisplayProps;this._rectangle=new createjs.Rectangle;this._bounds=null}var n=createjs.extend(t,createjs.EventDispatcher),i;t._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"];t.suppressCrossDomainErrors=!1;t._snapToPixelEnabled=!1;i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");i.getContext&&(t._hitTestCanvas=i,t._hitTestContext=i.getContext("2d"),i.width=i.height=1);t._nextCacheID=1;n.getStage=function(){for(var n=this,t=createjs.Stage;n.parent;)n=n.parent;return n instanceof t?n:null};try{Object.defineProperties(n,{stage:{get:n.getStage}})}catch(r){}n.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)};n.draw=function(n,t){var i=this.cacheCanvas,r;return t||!i?!1:(r=this._cacheScale,n.drawImage(i,this._cacheOffsetX+this._filterOffsetX,this._cacheOffsetY+this._filterOffsetY,i.width/r,i.height/r),!0)};n.updateContext=function(n){var r=this,u=r.mask,i=r._props.matrix,f,e;u&&u.graphics&&!u.graphics.isEmpty()&&(u.getMatrix(i),n.transform(i.a,i.b,i.c,i.d,i.tx,i.ty),u.graphics.drawAsPath(n),n.clip(),i.invert(),n.transform(i.a,i.b,i.c,i.d,i.tx,i.ty));this.getMatrix(i);f=i.tx;e=i.ty;t._snapToPixelEnabled&&r.snapToPixel&&(f=f+(0>f?-.5:.5)|0,e=e+(0>e?-.5:.5)|0);n.transform(i.a,i.b,i.c,i.d,f,e);n.globalAlpha*=r.alpha;r.compositeOperation&&(n.globalCompositeOperation=r.compositeOperation);r.shadow&&this._applyShadow(n,r.shadow)};n.cache=function(n,t,i,r,u){u=u||1;this.cacheCanvas||(this.cacheCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"));this._cacheWidth=i;this._cacheHeight=r;this._cacheOffsetX=n;this._cacheOffsetY=t;this._cacheScale=u;this.updateCache()};n.updateCache=function(n){var i=this.cacheCanvas;if(!i)throw"cache() must be called before updateCache()";var r=this._cacheScale,s=this._cacheOffsetX*r,h=this._cacheOffsetY*r,f=this._cacheWidth,e=this._cacheHeight,u=i.getContext("2d"),o=this._getFilterBounds();s+=this._filterOffsetX=o.x;h+=this._filterOffsetY=o.y;f=Math.ceil(f*r)+o.width;e=Math.ceil(e*r)+o.height;f!=i.width||e!=i.height?(i.width=f,i.height=e):n||u.clearRect(0,0,f+1,e+1);u.save();u.globalCompositeOperation=n;u.setTransform(r,0,0,r,-s,-h);this.draw(u,!0);this._applyFilters();u.restore();this.cacheID=t._nextCacheID++};n.uncache=function(){this._cacheDataURL=this.cacheCanvas=null;this.cacheID=this._cacheOffsetX=this._cacheOffsetY=this._filterOffsetX=this._filterOffsetY=0;this._cacheScale=1};n.getCacheDataURL=function(){return this.cacheCanvas?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURL=this.cacheCanvas.toDataURL()),this._cacheDataURL):null};n.localToGlobal=function(n,t,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(n,t,i||new createjs.Point)};n.globalToLocal=function(n,t,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(n,t,i||new createjs.Point)};n.localToLocal=function(n,t,i,r){return r=this.localToGlobal(n,t,r),i.globalToLocal(r.x,r.y,r)};n.setTransform=function(n,t,i,r,u,f,e,o,s){return this.x=n||0,this.y=t||0,this.scaleX=null==i?1:i,this.scaleY=null==r?1:r,this.rotation=u||0,this.skewX=f||0,this.skewY=e||0,this.regX=o||0,this.regY=s||0,this};n.getMatrix=function(n){var t=this,i=n&&n.identity()||new createjs.Matrix2D;return t.transformMatrix?i.copy(t.transformMatrix):i.appendTransform(t.x,t.y,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.regX,t.regY)};n.getConcatenatedMatrix=function(n){for(var t=this,i=this.getMatrix(n);t=t.parent;)i.prependMatrix(t.getMatrix(t._props.matrix));return i};n.getConcatenatedDisplayProps=function(n){n=n?n.identity():new createjs.DisplayProps;var t=this,i=t.getMatrix(n.matrix);do n.prepend(t.visible,t.alpha,t.shadow,t.compositeOperation),t!=this&&i.prependMatrix(t.getMatrix(t._props.matrix));while(t=t.parent);return n};n.hitTest=function(n,i){var r=t._hitTestContext,u;return r.setTransform(1,0,0,1,-n,-i),this.draw(r),u=this._testHit(r),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,2,2),u};n.set=function(n){for(var t in n)this[t]=n[t];return this};n.getBounds=function(){var n,t;return this._bounds?this._rectangle.copy(this._bounds):(n=this.cacheCanvas,n)?(t=this._cacheScale,this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,n.width/t,n.height/t)):null};n.getTransformedBounds=function(){return this._getBounds()};n.setBounds=function(n,t,i,r){null==n&&(this._bounds=n);this._bounds=(this._bounds||new createjs.Rectangle).setValues(n,t,i,r)};n.clone=function(){return this._cloneProps(new t)};n.toString=function(){return"[DisplayObject (name="+this.name+")]"};n._cloneProps=function(n){return n.alpha=this.alpha,n.mouseEnabled=this.mouseEnabled,n.tickEnabled=this.tickEnabled,n.name=this.name,n.regX=this.regX,n.regY=this.regY,n.rotation=this.rotation,n.scaleX=this.scaleX,n.scaleY=this.scaleY,n.shadow=this.shadow,n.skewX=this.skewX,n.skewY=this.skewY,n.visible=this.visible,n.x=this.x,n.y=this.y,n.compositeOperation=this.compositeOperation,n.snapToPixel=this.snapToPixel,n.filters=null==this.filters?null:this.filters.slice(0),n.mask=this.mask,n.hitArea=this.hitArea,n.cursor=this.cursor,n._bounds=this._bounds,n};n._applyShadow=function(n,t){t=t||Shadow.identity;n.shadowColor=t.color;n.shadowOffsetX=t.offsetX;n.shadowOffsetY=t.offsetY;n.shadowBlur=t.blur};n._tick=function(n){var t=this._listeners;t&&t.tick&&(n.target=null,n.propagationStopped=n.immediatePropagationStopped=!1,this.dispatchEvent(n))};n._testHit=function(n){try{var i=n.getImageData(0,0,1,1).data[3]>1}catch(r){if(!t.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.";}return i};n._applyFilters=function(){if(this.filters&&0!=this.filters.length&&this.cacheCanvas)for(var t=this.filters.length,i=this.cacheCanvas.getContext("2d"),r=this.cacheCanvas.width,u=this.cacheCanvas.height,n=0;t>n;n++)this.filters[n].applyFilter(i,0,0,r,u)};n._getFilterBounds=function(){var r,u=this.filters,t=this._rectangle.setValues(0,0,0,0),n,i;if(!u||!(r=u.length))return t;for(n=0;r>n;n++)i=this.filters[n],i.getBounds&&i.getBounds(t);return t};n._getBounds=function(n,t){return this._transformBounds(this.getBounds(),n,t)};n._transformBounds=function(n,t,i){if(!n)return n;var r=n.x,u=n.y,a=n.width,v=n.height,f=this._props.matrix;f=i?f.identity():this.getMatrix(f);(r||u)&&f.appendTransform(0,0,1,1,0,0,0,-r,-u);t&&f.prependMatrix(t);var y=a*f.a,p=a*f.b,w=v*f.c,b=v*f.d,c=f.tx,l=f.ty,e=c,s=c,o=l,h=l;return(r=y+c)<e?e=r:r>s&&(s=r),(r=y+w+c)<e?e=r:r>s&&(s=r),(r=w+c)<e?e=r:r>s&&(s=r),(u=p+l)<o?o=u:u>h&&(h=u),(u=p+b+l)<o?o=u:u>h&&(h=u),(u=b+l)<o?o=u:u>h&&(h=u),n.setValues(e,o,s-e,h-o)};n._hasMouseEventListener=function(){for(var i=t._MOUSE_EVENTS,n=0,r=i.length;r>n;n++)if(this.hasEventListener(i[n]))return!0;return!!this.cursor};createjs.DisplayObject=createjs.promote(t,"EventDispatcher")}();this.createjs=this.createjs||{},function(){"use strict";function t(){this.DisplayObject_constructor();this.children=[];this.mouseChildren=!0;this.tickChildren=!0}var n=createjs.extend(t,createjs.DisplayObject);n.getNumChildren=function(){return this.children.length};try{Object.defineProperties(n,{numChildren:{get:n.getNumChildren}})}catch(i){}n.initialize=t;n.isVisible=function(){var n=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&n)};n.draw=function(n,t){var i;if(this.DisplayObject_draw(n,t))return!0;for(var u=this.children.slice(),r=0,f=u.length;f>r;r++)i=u[r],i.isVisible()&&(n.save(),i.updateContext(n),i.draw(n),n.restore());return!0};n.addChild=function(n){var t,i;if(null==n)return n;if(t=arguments.length,t>1){for(i=0;t>i;i++)this.addChild(arguments[i]);return arguments[t-1]}return n.parent&&n.parent.removeChild(n),n.parent=this,this.children.push(n),n.dispatchEvent("added"),n};n.addChildAt=function(n,t){var i=arguments.length,u=arguments[i-1],r;if(0>u||u>this.children.length)return arguments[i-2];if(i>2){for(r=0;i-1>r;r++)this.addChildAt(arguments[r],u+r);return arguments[i-2]}return n.parent&&n.parent.removeChild(n),n.parent=this,this.children.splice(t,0,n),n.dispatchEvent("added"),n};n.removeChild=function(n){var r=arguments.length,t,i;if(r>1){for(t=!0,i=0;r>i;i++)t=t&&this.removeChild(arguments[i]);return t}return this.removeChildAt(createjs.indexOf(this.children,n))};n.removeChildAt=function(n){var f=arguments.length,i,r,t,u;if(f>1){for(i=[],t=0;f>t;t++)i[t]=arguments[t];for(i.sort(function(n,t){return t-n}),r=!0,t=0;f>t;t++)r=r&&this.removeChildAt(i[t]);return r}return 0>n||n>this.children.length-1?!1:(u=this.children[n],u&&(u.parent=null),this.children.splice(n,1),u.dispatchEvent("removed"),!0)};n.removeAllChildren=function(){for(var n=this.children;n.length;)this.removeChildAt(0)};n.getChildAt=function(n){return this.children[n]};n.getChildByName=function(n){for(var i=this.children,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null};n.sortChildren=function(n){this.children.sort(n)};n.getChildIndex=function(n){return createjs.indexOf(this.children,n)};n.swapChildrenAt=function(n,t){var i=this.children,r=i[n],u=i[t];r&&u&&(i[n]=u,i[t]=r)};n.swapChildren=function(n,t){for(var u,f,r=this.children,i=0,e=r.length;e>i&&(r[i]==n&&(u=i),r[i]==t&&(f=i),null==u||null==f);i++);i!=e&&(r[u]=t,r[f]=n)};n.setChildIndex=function(n,t){var r=this.children,u=r.length,i;if(!(n.parent!=this||0>t||t>=u)){for(i=0;u>i&&r[i]!=n;i++);i!=u&&i!=t&&(r.splice(i,1),r.splice(t,0,n))}};n.contains=function(n){for(;n;){if(n==this)return!0;n=n.parent}return!1};n.hitTest=function(n,t){return null!=this.getObjectUnderPoint(n,t)};n.getObjectsUnderPoint=function(n,t,i){var r=[],u=this.localToGlobal(n,t);return this._getObjectsUnderPoint(u.x,u.y,r,i>0,1==i),r};n.getObjectUnderPoint=function(n,t,i){var r=this.localToGlobal(n,t);return this._getObjectsUnderPoint(r.x,r.y,null,i>0,1==i)};n.getBounds=function(){return this._getBounds(null,!0)};n.getTransformedBounds=function(){return this._getBounds()};n.clone=function(n){var i=this._cloneProps(new t);return n&&this._cloneChildren(i),i};n.toString=function(){return"[Container (name="+this.name+")]"};n._tick=function(n){var t,i;if(this.tickChildren)for(t=this.children.length-1;t>=0;t--)i=this.children[t],i.tickEnabled&&i._tick&&i._tick(n);this.DisplayObject__tick(n)};n._cloneChildren=function(n){var i;n.children.length&&n.removeAllChildren();for(var r=n.children,t=0,u=this.children.length;u>t;t++)i=this.children[t].clone(!0),i.parent=n,r.push(i)};n._getObjectsUnderPoint=function(n,i,r,u,f,e){var h,c,o,s,v,l;if(e=e||0,!e&&!this._testMask(this,n,i))return null;c=createjs.DisplayObject._hitTestContext;f=f||u&&this._hasMouseEventListener();for(var y=this.children,p=y.length,a=p-1;a>=0;a--)if(o=y[a],s=o.hitArea,o.visible&&(s||o.isVisible())&&(!u||o.mouseEnabled)&&(s||this._testMask(o,n,i)))if(!s&&o instanceof t){if(v=o._getObjectsUnderPoint(n,i,r,u,f,e+1),!r&&v)return u&&!this.mouseChildren?this:v}else{if(u&&!f&&!o._hasMouseEventListener())continue;if(l=o.getConcatenatedDisplayProps(o._props),h=l.matrix,s&&(h.appendMatrix(s.getMatrix(s._props.matrix)),l.alpha=s.alpha),c.globalAlpha=l.alpha,c.setTransform(h.a,h.b,h.c,h.d,h.tx-n,h.ty-i),(s||o).draw(c),!this._testHit(c))continue;if(c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,2,2),!r)return u&&!this.mouseChildren?this:o;r.push(o)}return null};n._testMask=function(n,t,i){var f=n.mask,r,e,u;return!f||!f.graphics||f.graphics.isEmpty()?!0:(r=this._props.matrix,e=n.parent,r=e?e.getConcatenatedMatrix(r):r.identity(),r=f.getMatrix(f._props.matrix).prependMatrix(r),u=createjs.DisplayObject._hitTestContext,u.setTransform(r.a,r.b,r.c,r.d,r.tx-t,r.ty-i),f.graphics.drawAsPath(u),u.fillStyle="#000",u.fill(),this._testHit(u)?(u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,2,2),!0):!1)};n._getBounds=function(n,t){var i=this.DisplayObject_getBounds(),r,e;if(i)return this._transformBounds(i,n,t);r=this._props.matrix;r=t?r.identity():this.getMatrix(r);n&&r.prependMatrix(n);for(var o=this.children.length,u=null,f=0;o>f;f++)e=this.children[f],e.visible&&(i=e._getBounds(r))&&(u?u.extend(i.x,i.y,i.width,i.height):u=i.clone());return u};createjs.Container=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(n){this.Container_constructor();this.autoClear=!0;this.canvas="string"==typeof n?document.getElementById(n):n;this.mouseX=0;this.mouseY=0;this.drawRect=null;this.snapToPixelEnabled=!1;this.mouseInBounds=!1;this.tickOnUpdate=!0;this.mouseMoveOutside=!1;this.preventSelection=!0;this._pointerData={};this._pointerCount=0;this._primaryPointerID=null;this._mouseOverIntervalID=null;this._nextStage=null;this._prevStage=null;this.enableDOMEvents(!0)}var n=createjs.extend(t,createjs.Container);n._get_nextStage=function(){return this._nextStage};n._set_nextStage=function(n){this._nextStage&&(this._nextStage._prevStage=null);n&&(n._prevStage=this);this._nextStage=n};try{Object.defineProperties(n,{nextStage:{get:n._get_nextStage,set:n._set_nextStage}})}catch(i){}n.update=function(n){if(this.canvas&&(this.tickOnUpdate&&this.tick(n),!this.dispatchEvent("drawstart"))){createjs.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;var i=this.drawRect,t=this.canvas.getContext("2d");t.setTransform(1,0,0,1,0,0);this.autoClear&&(i?t.clearRect(i.x,i.y,i.width,i.height):t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1));t.save();this.drawRect&&(t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.clip());this.updateContext(t);this.draw(t,!1);t.restore();this.dispatchEvent("drawend")}};n.tick=function(n){var i,t;if(this.tickEnabled&&!this.dispatchEvent("tickstart")){if(i=new createjs.Event("tick"),n)for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);this._tick(i);this.dispatchEvent("tickend")}};n.handleEvent=function(n){"tick"==n.type&&this.update(n)};n.clear=function(){if(this.canvas){var n=this.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);n.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}};n.toDataURL=function(n,t){var r,i=this.canvas.getContext("2d"),u=this.canvas.width,f=this.canvas.height,e,o;return n&&(r=i.getImageData(0,0,u,f),e=i.globalCompositeOperation,i.globalCompositeOperation="destination-over",i.fillStyle=n,i.fillRect(0,0,u,f)),o=this.canvas.toDataURL(t||"image/png"),n&&(i.putImageData(r,0,0),i.globalCompositeOperation=e),o};n.enableMouseOver=function(n){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==n&&this._testMouseOver(!0)),null==n)n=20;else if(0>=n)return;var t=this;this._mouseOverIntervalID=setInterval(function(){t._testMouseOver()},1e3/Math.min(50,n))};n.enableDOMEvents=function(n){var i,r,t,f,u;if(null==n&&(n=!0),t=this._eventListeners,!n&&t){for(i in t)r=t[i],r.t.removeEventListener(i,r.f,!1);this._eventListeners=null}else if(n&&!t&&this.canvas){f=window.addEventListener?window:document;u=this;t=this._eventListeners={};t.mouseup={t:f,f:function(n){u._handleMouseUp(n)}};t.mousemove={t:f,f:function(n){u._handleMouseMove(n)}};t.dblclick={t:this.canvas,f:function(n){u._handleDoubleClick(n)}};t.mousedown={t:this.canvas,f:function(n){u._handleMouseDown(n)}};for(i in t)r=t[i],r.t.addEventListener(i,r.f,!1)}};n.clone=function(){throw"Stage cannot be cloned.";};n.toString=function(){return"[Stage (name="+this.name+")]"};n._getElementRect=function(n){var i;try{i=n.getBoundingClientRect()}catch(h){i={top:n.offsetTop,left:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight}}var r=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),u=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),t=window.getComputedStyle?getComputedStyle(n,null):n.currentStyle,f=parseInt(t.paddingLeft)+parseInt(t.borderLeftWidth),e=parseInt(t.paddingTop)+parseInt(t.borderTopWidth),o=parseInt(t.paddingRight)+parseInt(t.borderRightWidth),s=parseInt(t.paddingBottom)+parseInt(t.borderBottomWidth);return{left:i.left+r+f,right:i.right+r-o,top:i.top+u+e,bottom:i.bottom+u-s}};n._getPointerData=function(n){var t=this._pointerData[n];return t||(t=this._pointerData[n]={x:0,y:0}),t};n._handleMouseMove=function(n){n||(n=window.event);this._handlePointerMove(-1,n,n.pageX,n.pageY)};n._handlePointerMove=function(n,t,i,r,u){if((!this._prevStage||void 0!==u)&&this.canvas){var o=this._nextStage,f=this._getPointerData(n),e=f.inBounds;this._updatePointerPosition(n,t,i,r);(e||f.inBounds||this.mouseMoveOutside)&&(-1===n&&f.inBounds==!e&&this._dispatchMouseEvent(this,e?"mouseleave":"mouseenter",!1,n,f,t),this._dispatchMouseEvent(this,"stagemousemove",!1,n,f,t),this._dispatchMouseEvent(f.target,"pressmove",!0,n,f,t));o&&o._handlePointerMove(n,t,i,r,null)}};n._updatePointerPosition=function(n,t,i,r){var f=this._getElementRect(this.canvas),e,o,u;i-=f.left;r-=f.top;e=this.canvas.width;o=this.canvas.height;i/=(f.right-f.left)/e;r/=(f.bottom-f.top)/o;u=this._getPointerData(n);(u.inBounds=i>=0&&r>=0&&e-1>=i&&o-1>=r)?(u.x=i,u.y=r):this.mouseMoveOutside&&(u.x=0>i?0:i>e-1?e-1:i,u.y=0>r?0:r>o-1?o-1:r);u.posEvtObj=t;u.rawX=i;u.rawY=r;(n===this._primaryPointerID||-1===n)&&(this.mouseX=u.x,this.mouseY=u.y,this.mouseInBounds=u.inBounds)};n._handleMouseUp=function(n){this._handlePointerUp(-1,n,!1)};n._handlePointerUp=function(n,t,i,r){var o=this._nextStage,u=this._getPointerData(n),e,f;this._prevStage&&void 0===r||(u.down&&this._dispatchMouseEvent(this,"stagemouseup",!1,n,u,t),u.down=!1,e=null,f=u.target,!r&&(f||o)&&(e=this._getObjectsUnderPoint(u.x,u.y,null,!0)),e==f&&this._dispatchMouseEvent(f,"click",!0,n,u,t),this._dispatchMouseEvent(f,"pressup",!0,n,u,t),i?(n==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[n]):u.target=null,o&&o._handlePointerUp(n,t,i,r||e&&this))};n._handleMouseDown=function(n){this._handlePointerDown(-1,n,n.pageX,n.pageY)};n._handlePointerDown=function(n,t,i,r,u){this.preventSelection&&t.preventDefault();(null==this._primaryPointerID||-1===n)&&(this._primaryPointerID=n);null!=r&&this._updatePointerPosition(n,t,i,r);var e=null,o=this._nextStage,f=this._getPointerData(n);f.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,n,f,t),f.down=!0);u||(e=f.target=this._getObjectsUnderPoint(f.x,f.y,null,!0),this._dispatchMouseEvent(f.target,"mousedown",!0,n,f,t));o&&o._handlePointerDown(n,t,i,r,u||e&&this)};n._testMouseOver=function(n,t,i){var s,u;if(!this._prevStage||void 0!==t){if(s=this._nextStage,!this._mouseOverIntervalID)return void(s&&s._testMouseOver(n,t,i));if(u=this._getPointerData(-1),u&&(n||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var f,r,y,e=u.posEvtObj,p=i||e&&e.target==this.canvas,o=null,l=-1,a="";!t&&(n||this.mouseInBounds&&p)&&(o=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var h=this._mouseOverTarget||[],v=h[h.length-1],c=this._mouseOverTarget=[];for(f=o;f;)c.unshift(f),null!=f.cursor&&(a=f.cursor),f=f.parent;for(this.canvas.style.cursor=a,!t&&i&&(i.canvas.style.cursor=a),r=0,y=c.length;y>r&&c[r]==h[r];r++)l=r;for(v!=o&&this._dispatchMouseEvent(v,"mouseout",!0,-1,u,e),r=h.length-1;r>l;r--)this._dispatchMouseEvent(h[r],"rollout",!1,-1,u,e);for(r=c.length-1;r>l;r--)this._dispatchMouseEvent(c[r],"rollover",!1,-1,u,e);v!=o&&this._dispatchMouseEvent(o,"mouseover",!0,-1,u,e);s&&s._testMouseOver(n,t||o&&this,i||p&&this)}}};n._handleDoubleClick=function(n,t){var i=null,u=this._nextStage,r=this._getPointerData(-1);t||(i=this._getObjectsUnderPoint(r.x,r.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,r,n));u&&u._handleDoubleClick(n,t||i&&this)};n._dispatchMouseEvent=function(n,t,i,r,u,f){if(n&&(i||n.hasEventListener(t))){var e=new createjs.MouseEvent(t,i,!1,u.x,u.y,f,r,r===this._primaryPointerID||-1===r,u.rawX,u.rawY);n.dispatchEvent(e)}};createjs.Stage=createjs.promote(t,"Container")}();this.createjs=this.createjs||{},function(){function t(n){this.DisplayObject_constructor();"string"==typeof n?(this.image=document.createElement("img"),this.image.src=n):this.image=n;this.sourceRect=null}var n=createjs.extend(t,createjs.DisplayObject);n.initialize=t;n.isVisible=function(){var n=this.cacheCanvas||this.image&&(this.image.complete||this.image.getContext||this.image.readyState>=2);return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&n)};n.draw=function(n,t){var f,u;if(this.DisplayObject_draw(n,t)||!this.image)return!0;if(f=this.image,u=this.sourceRect,u){var i=u.x,r=u.y,e=i+u.width,o=r+u.height,s=0,h=0,c=f.width,l=f.height;0>i&&(s-=i,i=0);e>c&&(e=c);0>r&&(h-=r,r=0);o>l&&(o=l);n.drawImage(f,i,r,e-i,o-r,s,h,e-i,o-r)}else n.drawImage(f,0,0);return!0};n.getBounds=function(){var t=this.DisplayObject_getBounds(),n,i;return t?t:(n=this.sourceRect||this.image,i=this.image&&(this.image.complete||this.image.getContext||this.image.readyState>=2),i?this._rectangle.setValues(0,0,n.width,n.height):null)};n.clone=function(){var n=new t(this.image);return this.sourceRect&&(n.sourceRect=this.sourceRect.clone()),this._cloneProps(n),n};n.toString=function(){return"[Bitmap (name="+this.name+")]"};createjs.Bitmap=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t){this.DisplayObject_constructor();this.currentFrame=0;this.currentAnimation=null;this.paused=!0;this.spriteSheet=n;this.currentAnimationFrame=0;this.framerate=0;this._animation=null;this._currentFrame=null;this._skipAdvance=!1;t&&this.gotoAndPlay(t)}var n=createjs.extend(t,createjs.DisplayObject);n.isVisible=function(){var n=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&n)};n.draw=function(n,t){var r,i;return this.DisplayObject_draw(n,t)?!0:(this._normalizeFrame(),r=this.spriteSheet.getFrame(0|this._currentFrame),!r)?!1:(i=r.rect,i.width&&i.height&&n.drawImage(r.image,i.x,i.y,i.width,i.height,-r.regX,-r.regY,i.width,i.height),!0)};n.play=function(){this.paused=!1};n.stop=function(){this.paused=!0};n.gotoAndPlay=function(n){this.paused=!1;this._skipAdvance=!0;this._goto(n)};n.gotoAndStop=function(n){this.paused=!0;this._goto(n)};n.advance=function(n){var t=this.framerate||this.spriteSheet.framerate,i=t&&null!=n?n/(1e3/t):1;this._normalizeFrame(i)};n.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)};n.clone=function(){return this._cloneProps(new t(this.spriteSheet))};n.toString=function(){return"[Sprite (name="+this.name+")]"};n._cloneProps=function(n){return this.DisplayObject__cloneProps(n),n.currentFrame=this.currentFrame,n.currentAnimation=this.currentAnimation,n.paused=this.paused,n.currentAnimationFrame=this.currentAnimationFrame,n.framerate=this.framerate,n._animation=this._animation,n._currentFrame=this._currentFrame,n._skipAdvance=this._skipAdvance,n};n._tick=function(n){this.paused||(this._skipAdvance||this.advance(n&&n.delta),this._skipAdvance=!1);this.DisplayObject__tick(n)};n._normalizeFrame=function(n){var f,u,e;n=n||0;var t,i=this._animation,o=this.paused,r=this._currentFrame;if(i){if(f=i.speed||1,u=this.currentAnimationFrame,t=i.frames.length,u+n*f>=t){if(e=i.next,this._dispatchAnimationEnd(i,r,o,e,t-1))return;if(e)return this._goto(e,n-(t-u)/f);this.paused=!0;u=i.frames.length-1}else u+=n*f;this.currentAnimationFrame=u;this._currentFrame=i.frames[0|u]}else if(r=this._currentFrame+=n,t=this.spriteSheet.getNumFrames(),r>=t&&t>0&&!this._dispatchAnimationEnd(i,r,o,t-1)&&(this._currentFrame-=t)>=t)return this._normalizeFrame();r=0|this._currentFrame;this.currentFrame!=r&&(this.currentFrame=r,this.dispatchEvent("change"))};n._dispatchAnimationEnd=function(n,t,i,r,u){var o=n?n.name:null,f,e;return this.hasEventListener("animationend")&&(f=new createjs.Event("animationend"),f.name=o,f.next=r,this.dispatchEvent(f)),e=this._animation!=n||this._currentFrame!=t,e||i||!this.paused||(this.currentAnimationFrame=u,e=!0),e};n._goto=function(n,t){if(this.currentAnimationFrame=0,isNaN(n)){var i=this.spriteSheet.getAnimation(n);i&&(this._animation=i,this.currentAnimation=n,this._normalizeFrame(t))}else this.currentAnimation=this._animation=null,this._currentFrame=n,this._normalizeFrame()};createjs.Sprite=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(n){this.DisplayObject_constructor();this.graphics=n?n:new createjs.Graphics}var n=createjs.extend(t,createjs.DisplayObject);n.isVisible=function(){var n=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&n)};n.draw=function(n,t){return this.DisplayObject_draw(n,t)?!0:(this.graphics.draw(n,this),!0)};n.clone=function(n){var i=n&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new t(i))};n.toString=function(){return"[Shape (name="+this.name+")]"};createjs.Shape=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t,i){this.DisplayObject_constructor();this.text=n;this.font=t;this.color=i;this.textAlign="left";this.textBaseline="top";this.maxWidth=null;this.outline=0;this.lineHeight=0;this.lineWidth=null}var n=createjs.extend(t,createjs.DisplayObject),i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");i.getContext&&(t._workingContext=i.getContext("2d"),i.width=i.height=1);t.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1};t.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1};n.isVisible=function(){var n=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&n)};n.draw=function(n,t){if(this.DisplayObject_draw(n,t))return!0;var i=this.color||"#000";return this.outline?(n.strokeStyle=i,n.lineWidth=1*this.outline):n.fillStyle=i,this._drawText(this._prepContext(n)),!0};n.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)};n.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")};n.getMeasuredHeight=function(){return this._drawText(null,{}).height};n.getBounds=function(){var i=this.DisplayObject_getBounds();if(i)return i;if(null==this.text||""==this.text)return null;var n=this._drawText(null,{}),r=this.maxWidth&&this.maxWidth<n.width?this.maxWidth:n.width,u=r*t.H_OFFSETS[this.textAlign||"left"],f=this.lineHeight||this.getMeasuredLineHeight(),e=f*t.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(u,e,r,n.height)};n.getMetrics=function(){var n={lines:[]};return n.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),n.vOffset=n.lineHeight*t.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,n,n.lines)};n.clone=function(){return this._cloneProps(new t(this.text,this.font,this.color))};n.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"};n._cloneProps=function(n){return this.DisplayObject__cloneProps(n),n.textAlign=this.textAlign,n.textBaseline=this.textBaseline,n.maxWidth=this.maxWidth,n.outline=this.outline,n.lineHeight=this.lineHeight,n.lineWidth=this.lineWidth,n};n._prepContext=function(n){return n.font=this.font||"10px sans-serif",n.textAlign=this.textAlign||"left",n.textBaseline=this.textBaseline||"top",n};n._drawText=function(n,i,r){var c=!!n,u,f,e,o,p,v;c||(n=t._workingContext,n.save(),this._prepContext(n));for(var l=this.lineHeight||this.getMeasuredLineHeight(),s=0,h=0,y=String(this.text).split(/(?:\r\n|\r|\n)/),a=0,w=y.length;w>a;a++){if(u=y[a],f=null,null!=this.lineWidth&&(f=n.measureText(u).width)>this.lineWidth)for(e=u.split(/(\s)/),u=e[0],f=n.measureText(u).width,o=1,p=e.length;p>o;o+=2)v=n.measureText(e[o]+e[o+1]).width,f+v>this.lineWidth?(c&&this._drawTextLine(n,u,h*l),r&&r.push(u),f>s&&(s=f),u=e[o+1],f=n.measureText(u).width,h++):(u+=e[o]+e[o+1],f+=v);c&&this._drawTextLine(n,u,h*l);r&&r.push(u);i&&null==f&&(f=n.measureText(u).width);f>s&&(s=f);h++}return i&&(i.width=s,i.height=h*l),c||n.restore(),i};n._drawTextLine=function(n,t,i){this.outline?n.strokeText(t,0,i,this.maxWidth||65535):n.fillText(t,0,i,this.maxWidth||65535)};n._getMeasuredWidth=function(n){var i=t._workingContext,r;return i.save(),r=this._prepContext(i).measureText(n).width,i.restore(),r};createjs.Text=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(n,t){this.Container_constructor();this.text=n||"";this.spriteSheet=t;this.lineHeight=0;this.letterSpacing=0;this.spaceWidth=0;this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0}}var n=createjs.extend(t,createjs.Container);t.maxPoolSize=100;t._spritePool=[];n.draw=function(n,t){this.DisplayObject_draw(n,t)||(this._updateText(),this.Container_draw(n,t))};n.getBounds=function(){return this._updateText(),this.Container_getBounds()};n.isVisible=function(){var n=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&0!==this.scaleX&&0!==this.scaleY&&n)};n.clone=function(){return this._cloneProps(new t(this.text,this.spriteSheet))};n.addChild=n.addChildAt=n.removeChild=n.removeChildAt=n.removeAllChildren=function(){};n._cloneProps=function(n){return this.DisplayObject__cloneProps(n),n.lineHeight=this.lineHeight,n.letterSpacing=this.letterSpacing,n.spaceWidth=this.spaceWidth,n};n._getFrameIndex=function(n,t){var i,r=t.getAnimation(n);return r||(n!=(i=n.toUpperCase())||n!=(i=n.toLowerCase())||(i=null),i&&(r=t.getAnimation(i))),r&&r.frames[0]};n._getFrame=function(n,t){var i=this._getFrameIndex(n,t);return null==i?i:t.getFrame(i)};n._getLineHeight=function(n){var t=this._getFrame("1",n)||this._getFrame("T",n)||this._getFrame("L",n)||n.getFrame(0);return t?t.rect.height:1};n._getSpaceWidth=function(n){var t=this._getFrame("1",n)||this._getFrame("l",n)||this._getFrame("e",n)||this._getFrame("a",n)||n.getFrame(0);return t?t.rect.width:1};n._updateText=function(){var n,o=0,w=0,l=this._oldProps,b=!1,a=this.spaceWidth,v=this.lineHeight,u=this.spriteSheet,f=t._spritePool,s=this.children,h=0,c=s.length,e,y,i,k,r,p;for(e in l)l[e]!=this[e]&&(l[e]=this[e],b=!0);if(b){for(y=!!this._getFrame(" ",u),y||a||(a=this._getSpaceWidth(u)),v||(v=this._getLineHeight(u)),i=0,k=this.text.length;k>i;i++)r=this.text.charAt(i)," "!=r||y?"\n"!=r&&"\r"!=r?(p=this._getFrameIndex(r,u),null!=p&&(c>h?n=s[h]:(s.push(n=f.length?f.pop():new createjs.Sprite),n.parent=this,c++),n.spriteSheet=u,n.gotoAndStop(p),n.x=o,n.y=w,h++,o+=n.getBounds().width+this.letterSpacing)):("\r"==r&&"\n"==this.text.charAt(i+1)&&i++,o=0,w+=v):o+=a;for(;c>h;)f.push(n=s.pop()),n.parent=null,c--;f.length>t.maxPoolSize&&(f.length=t.maxPoolSize)}};createjs.BitmapText=createjs.promote(t,"Container")}();this.createjs=this.createjs||{},function(){"use strict";function n(){throw"SpriteSheetUtils cannot be instantiated";}var t=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");t.getContext&&(n._workingCanvas=t,n._workingContext=t.getContext("2d"),t.width=t.height=1);n.addFlippedFrames=function(t,i,r,u){if(i||r||u){var f=0;i&&n._flip(t,++f,!0,!1);r&&n._flip(t,++f,!1,!0);u&&n._flip(t,++f,!0,!0)}};n.extractFrame=function(t,i){var u,r,f,e;return(isNaN(i)&&(i=t.getAnimation(i).frames[0]),u=t.getFrame(i),!u)?null:(r=u.rect,f=n._workingCanvas,f.width=r.width,f.height=r.height,n._workingContext.drawImage(u.image,r.x,r.y,r.width,r.height,0,0,r.width,r.height),e=document.createElement("img"),e.src=f.toDataURL("image/png"),e)};n.mergeAlpha=function(n,t,i){i||(i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"));i.width=Math.max(t.width,n.width);i.height=Math.max(t.height,n.height);var r=i.getContext("2d");return r.save(),r.drawImage(n,0,0),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),r.restore(),i};n._flip=function(t,i,r,u){for(var f,s,h,w,o,y,k,c,p,tt,a=t._images,l=n._workingCanvas,v=n._workingContext,d=a.length/i,e=0;d>e;e++)f=a[e],f.__tmp=e,v.setTransform(1,0,0,1,0,0),v.clearRect(0,0,l.width+1,l.height+1),l.width=f.width,l.height=f.height,v.setTransform(r?-1:1,0,0,u?-1:1,r?f.width:0,u?f.height:0),v.drawImage(f,0,0),s=document.createElement("img"),s.src=l.toDataURL("image/png"),s.width=f.width,s.height=f.height,a.push(s);for(h=t._frames,w=h.length/i,e=0;w>e;e++)f=h[e],o=f.rect.clone(),s=a[f.image.__tmp+d*i],y={image:s,rect:o,regX:f.regX,regY:f.regY},r&&(o.x=s.width-o.x-o.width,y.regX=o.width-f.regX),u&&(o.y=s.height-o.y-o.height,y.regY=o.height-f.regY),h.push(y);var g="_"+(r?"h":"")+(u?"v":""),b=t._animations,nt=t._data,it=b.length/i;for(e=0;it>e;e++){for(k=b[e],f=nt[k],c={name:k+g,speed:f.speed,next:f.next,frames:[]},f.next&&(c.next+=g),h=f.frames,p=0,tt=h.length;tt>p;p++)c.frames.push(h[p]+w*i);nt[c.name]=c;b.push(c.name)}};createjs.SpriteSheetUtils=n}();this.createjs=this.createjs||{},function(){"use strict";function t(){this.EventDispatcher_constructor();this.maxWidth=2048;this.maxHeight=2048;this.spriteSheet=null;this.scale=1;this.padding=1;this.timeSlice=.3;this.progress=-1;this._frames=[];this._animations={};this._data=null;this._nextFrameIndex=0;this._index=0;this._timerID=null;this._scale=1}var n=createjs.extend(t,createjs.EventDispatcher);t.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions";t.ERR_RUNNING="a build is already running";n.addFrame=function(n,i,r,u,f){if(this._data)throw t.ERR_RUNNING;var e=i||n.bounds||n.nominalBounds;return!e&&n.getBounds&&(e=n.getBounds()),e?(r=r||1,this._frames.push({source:n,sourceRect:e,scale:r,funct:u,data:f,index:this._frames.length,height:e.height*r})-1):null};n.addAnimation=function(n,i,r,u){if(this._data)throw t.ERR_RUNNING;this._animations[n]={frames:i,next:r,frequency:u}};n.addMovieClip=function(n,i,r,u,f,e){var h,c,o,l,a,v,k,y,s,p;if(this._data)throw t.ERR_RUNNING;if(h=n.frameBounds,c=i||n.bounds||n.nominalBounds,!c&&n.getBounds&&(c=n.getBounds()),c||h){for(a=this._frames.length,v=n.timeline.duration,o=0;v>o;o++)k=h&&h[o]?h[o]:c,this.addFrame(n,k,r,this._setupMovieClipFrame,{i:o,f:u,d:f});y=n.timeline._labels;s=[];for(p in y)s.push({index:y[p],label:p});if(s.length)for(s.sort(function(n,t){return n.index-t.index}),o=0,l=s.length;l>o;o++){for(var w=s[o].label,d=a+s[o].index,g=a+(o==l-1?v:s[o+1].index),nt=[],b=d;g>b;b++)nt.push(b);(!e||(w=e(w,n,d,g)))&&this.addAnimation(w,nt,!0)}}};n.build=function(){if(this._data)throw t.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet};n.buildAsync=function(n){if(this._data)throw t.ERR_RUNNING;this.timeSlice=n;this._startBuild();var i=this;this._timerID=setTimeout(function(){i._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))};n.stopAsync=function(){clearTimeout(this._timerID);this._data=null};n.clone=function(){throw"SpriteSheetBuilder cannot be cloned.";};n.toString=function(){return"[SpriteSheetBuilder]"};n._startBuild=function(){var s=this.padding||0,e,n,i,f;if(this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale,e=[],this._data={images:[],frames:e,animations:this._animations},n=this._frames.slice(),n.sort(function(n,t){return n.height<=t.height?-1:1}),n[n.length-1].height+2*s>this.maxHeight)throw t.ERR_DIMENSIONS;for(var r=0,u=0,o=0;n.length;)i=this._fillRow(n,r,o,e,s),(i.w>u&&(u=i.w),r+=i.h,i.h&&n.length)||(f=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),f.width=this._getSize(u,this.maxWidth),f.height=this._getSize(r,this.maxHeight),this._data.images[o]=f,i.h||(u=r=0,o++))};n._setupMovieClipFrame=function(n,t){var i=n.actionsEnabled;n.actionsEnabled=!1;n.gotoAndStop(t.i);n.actionsEnabled=i;t.f&&t.f(n,t.d,t.i)};n._getSize=function(n,t){for(var i=4;Math.pow(2,++i)<n;);return Math.min(t,Math.pow(2,i))};n._fillRow=function(n,i,r,u,f){var y=this.maxWidth,w=this.maxHeight;i+=f;for(var b=w-i,s=f,v=0,c=n.length-1;c>=0;c--){var e=n[c],o=this._scale*e.scale,l=e.sourceRect,p=e.source,k=Math.floor(o*l.x-f),d=Math.floor(o*l.y-f),a=Math.ceil(o*l.height+2*f),h=Math.ceil(o*l.width+2*f);if(h>y)throw t.ERR_DIMENSIONS;a>b||s+h>y||(e.img=r,e.rect=new createjs.Rectangle(s,i,h,a),v=v||a,n.splice(c,1),u[e.index]=[s,i,h,a,r,Math.round(-k+o*p.regX-f),Math.round(-d+o*p.regY-f)],s+=h)}return{w:s,h:v}};n._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data);this._data=null;this.progress=1;this.dispatchEvent("complete")};n._run=function(){for(var r,u,n,t=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),f=(new Date).getTime()+t,i=!1;f>(new Date).getTime();)if(!this._drawNext()){i=!0;break}i?this._endBuild():(r=this,this._timerID=setTimeout(function(){r._run()},50-t));u=this.progress=this._index/this._frames.length;this.hasEventListener("progress")&&(n=new createjs.Event("progress"),n.progress=u,this.dispatchEvent(n))};n._drawNext=function(){var n=this._frames[this._index],r=n.scale*this._scale,i=n.rect,u=n.sourceRect,f=this._data.images[n.img],t=f.getContext("2d");return n.funct&&n.funct(n.source,n.data),t.save(),t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.translate(Math.ceil(i.x-u.x*r),Math.ceil(i.y-u.y*r)),t.scale(r,r),n.source.draw(t),t.restore(),++this._index<this._frames.length};createjs.SpriteSheetBuilder=createjs.promote(t,"EventDispatcher")}();this.createjs=this.createjs||{},function(){"use strict";function t(n){this.DisplayObject_constructor();"string"==typeof n&&(n=document.getElementById(n));this.mouseEnabled=!1;var t=n.style;t.position="absolute";t.transformOrigin=t.WebkitTransformOrigin=t.msTransformOrigin=t.MozTransformOrigin=t.OTransformOrigin="0% 0%";this.htmlElement=n;this._oldProps=null}var n=createjs.extend(t,createjs.DisplayObject);n.isVisible=function(){return null!=this.htmlElement};n.draw=function(){return!0};n.cache=function(){};n.uncache=function(){};n.updateCache=function(){};n.hitTest=function(){};n.localToGlobal=function(){};n.globalToLocal=function(){};n.localToLocal=function(){};n.clone=function(){throw"DOMElement cannot be cloned.";};n.toString=function(){return"[DOMElement (name="+this.name+")]"};n._tick=function(n){var t=this.getStage();t&&t.on("drawend",this._handleDrawEnd,this,!0);this.DisplayObject__tick(n)};n._handleDrawEnd=function(){var e=this.htmlElement,f;if(e){var i=e.style,u=this.getConcatenatedDisplayProps(this._props),t=u.matrix,o=u.visible?"visible":"hidden";if(o!=i.visibility&&(i.visibility=o),u.visible){var r=this._oldProps,s=r&&r.matrix,n=1e4;s&&s.equals(t)||(f="matrix("+(t.a*n|0)/n+","+(t.b*n|0)/n+","+(t.c*n|0)/n+","+(t.d*n|0)/n+","+(t.tx+.5|0),i.transform=i.WebkitTransform=i.OTransform=i.msTransform=f+","+(t.ty+.5|0)+")",i.MozTransform=f+"px,"+(t.ty+.5|0)+"px)",r||(r=this._oldProps=new createjs.DisplayProps(!0,NaN)),r.matrix.copy(t));r.alpha!=u.alpha&&(i.opacity=""+(u.alpha*n|0)/n,r.alpha=u.alpha)}}};createjs.DOMElement=createjs.promote(t,"DisplayObject")}();this.createjs=this.createjs||{},function(){"use strict";function t(){}var n=t.prototype;n.getBounds=function(n){return n};n.applyFilter=function(n,t,i,r,u,f,e,o){f=f||n;null==e&&(e=t);null==o&&(o=i);try{var s=n.getImageData(t,i,r,u)}catch(h){return!1}return this._applyFilter(s)?(f.putImageData(s,e,o),!0):!1};n.toString=function(){return"[Filter]"};n.clone=function(){return new t};n._applyFilter=function(){return!0};createjs.Filter=t}();this.createjs=this.createjs||{},function(){"use strict";function n(n,t,i){(isNaN(n)||0>n)&&(n=0);(isNaN(t)||0>t)&&(t=0);(isNaN(i)||1>i)&&(i=1);this.blurX=0|n;this.blurY=0|t;this.quality=0|i}var t=createjs.extend(n,createjs.Filter);n.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1];n.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9];t.getBounds=function(n){var i=0|this.blurX,r=0|this.blurY,t;return 0>=i&&0>=r?n:(t=Math.pow(this.quality,.2),(n||new createjs.Rectangle).pad(i*t+1,r*t+1,i*t+1,r*t+1))};t.clone=function(){return new n(this.blurX,this.blurY,this.quality)};t.toString=function(){return"[BlurFilter]"};t._applyFilter=function(t){var nt=this.blurX>>1,y,v,ut,o,h,c;if(isNaN(nt)||0>nt||(y=this.blurY>>1,isNaN(y)||0>y)||0==nt&&0==y)return!1;v=this.quality;(isNaN(v)||1>v)&&(v=1);v|=0;v>3&&(v=3);1>v&&(v=1);for(var i=t.data,a=0,p=0,e=0,r=0,lt=0,f=0,at=0,w=0,b=0,k=0,d=0,ft=0,et=0,ot=0,l=0,vt=nt+nt+1|0,yt=y+y+1|0,g=0|t.width,st=0|t.height,ht=g-1|0,rt=st-1|0,it=nt+1|0,tt=y+1|0,ct={r:0,b:0,g:0,a:0},s=ct,e=1;vt>e;e++)s=s.n={r:0,b:0,g:0,a:0};for(s.n=ct,ut={r:0,b:0,g:0,a:0},o=ut,e=1;yt>e;e++)o=o.n={r:0,b:0,g:0,a:0};o.n=ut;for(var u=null,pt=0|n.MUL_TABLE[nt],wt=0|n.SHG_TABLE[nt],bt=0|n.MUL_TABLE[y],kt=0|n.SHG_TABLE[y];v-->0;){for(at=f=0,h=pt,c=wt,p=st;--p>-1;){for(w=it*(ft=i[0|f]),b=it*(et=i[f+1|0]),k=it*(ot=i[f+2|0]),d=it*(l=i[f+3|0]),s=ct,e=it;--e>-1;)s.r=ft,s.g=et,s.b=ot,s.a=l,s=s.n;for(e=1;it>e;e++)r=f+((e>ht?ht:e)<<2)|0,w+=s.r=i[r],b+=s.g=i[r+1],k+=s.b=i[r+2],d+=s.a=i[r+3],s=s.n;for(u=ct,a=0;g>a;a++)i[f++]=w*h>>>c,i[f++]=b*h>>>c,i[f++]=k*h>>>c,i[f++]=d*h>>>c,r=at+((r=a+nt+1)<ht?r:ht)<<2,w-=u.r-(u.r=i[r]),b-=u.g-(u.g=i[r+1]),k-=u.b-(u.b=i[r+2]),d-=u.a-(u.a=i[r+3]),u=u.n;at+=g}for(h=bt,c=kt,a=0;g>a;a++){for(f=a<<2|0,w=tt*(ft=i[f])|0,b=tt*(et=i[f+1|0])|0,k=tt*(ot=i[f+2|0])|0,d=tt*(l=i[f+3|0])|0,o=ut,e=0;tt>e;e++)o.r=ft,o.g=et,o.b=ot,o.a=l,o=o.n;for(lt=g,e=1;y>=e;e++)f=lt+a<<2,w+=o.r=i[f],b+=o.g=i[f+1],k+=o.b=i[f+2],d+=o.a=i[f+3],o=o.n,rt>e&&(lt+=g);if(f=a,u=ut,v>0)for(p=0;st>p;p++)r=f<<2,i[r+3]=l=d*h>>>c,l>0?(i[r]=w*h>>>c,i[r+1]=b*h>>>c,i[r+2]=k*h>>>c):i[r]=i[r+1]=i[r+2]=0,r=a+((r=p+tt)<rt?r:rt)*g<<2,w-=u.r-(u.r=i[r]),b-=u.g-(u.g=i[r+1]),k-=u.b-(u.b=i[r+2]),d-=u.a-(u.a=i[r+3]),u=u.n,f+=g;else for(p=0;st>p;p++)r=f<<2,i[r+3]=l=d*h>>>c,l>0?(l=255/l,i[r]=(w*h>>>c)*l,i[r+1]=(b*h>>>c)*l,i[r+2]=(k*h>>>c)*l):i[r]=i[r+1]=i[r+2]=0,r=a+((r=p+tt)<rt?r:rt)*g<<2,w-=u.r-(u.r=i[r]),b-=u.g-(u.g=i[r+1]),k-=u.b-(u.b=i[r+2]),d-=u.a-(u.a=i[r+3]),u=u.n,f+=g}}return!0};createjs.BlurFilter=createjs.promote(n,"Filter")}();this.createjs=this.createjs||{},function(){"use strict";function t(n){this.alphaMap=n;this._alphaMap=null;this._mapData=null}var n=createjs.extend(t,createjs.Filter);n.clone=function(){var n=new t(this.alphaMap);return n._alphaMap=this._alphaMap,n._mapData=this._mapData,n};n.toString=function(){return"[AlphaMapFilter]"};n._applyFilter=function(n){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var i=n.data,r=this._mapData,t=0,u=i.length;u>t;t+=4)i[t+3]=r[t]||0;return!0};n._prepAlphaMap=function(){var i,n,t,r;if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;n=this._alphaMap=this.alphaMap;t=n;n instanceof HTMLCanvasElement?i=t.getContext("2d"):(t=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),t.width=n.width,t.height=n.height,i=t.getContext("2d"),i.drawImage(n,0,0));try{r=i.getImageData(0,0,n.width,n.height)}catch(u){return!1}return this._mapData=r.data,!0};createjs.AlphaMapFilter=createjs.promote(t,"Filter")}();this.createjs=this.createjs||{},function(){"use strict";function n(n){this.mask=n}var t=createjs.extend(n,createjs.Filter);t.applyFilter=function(n,t,i,r,u,f,e,o){return this.mask?(f=f||n,null==e&&(e=t),null==o&&(o=i),f.save(),n!=f?!1:(f.globalCompositeOperation="destination-in",f.drawImage(this.mask,e,o),f.restore(),!0)):!0};t.clone=function(){return new n(this.mask)};t.toString=function(){return"[AlphaMaskFilter]"};createjs.AlphaMaskFilter=createjs.promote(n,"Filter")}();this.createjs=this.createjs||{},function(){"use strict";function n(n,t,i,r,u,f,e,o){this.redMultiplier=null!=n?n:1;this.greenMultiplier=null!=t?t:1;this.blueMultiplier=null!=i?i:1;this.alphaMultiplier=null!=r?r:1;this.redOffset=u||0;this.greenOffset=f||0;this.blueOffset=e||0;this.alphaOffset=o||0}var t=createjs.extend(n,createjs.Filter);t.toString=function(){return"[ColorFilter]"};t.clone=function(){return new n(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)};t._applyFilter=function(n){for(var i=n.data,r=i.length,t=0;r>t;t+=4)i[t]=i[t]*this.redMultiplier+this.redOffset,i[t+1]=i[t+1]*this.greenMultiplier+this.greenOffset,i[t+2]=i[t+2]*this.blueMultiplier+this.blueOffset,i[t+3]=i[t+3]*this.alphaMultiplier+this.alphaOffset;return!0};createjs.ColorFilter=createjs.promote(n,"Filter")}();this.createjs=this.createjs||{},function(){"use strict";function n(n,t,i,r){this.setColor(n,t,i,r)}var t=n.prototype;n.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];n.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];n.LENGTH=n.IDENTITY_MATRIX.length;t.setColor=function(n,t,i,r){return this.reset().adjustColor(n,t,i,r)};t.reset=function(){return this.copy(n.IDENTITY_MATRIX)};t.adjustColor=function(n,t,i,r){return this.adjustHue(r),this.adjustContrast(t),this.adjustBrightness(n),this.adjustSaturation(i)};t.adjustBrightness=function(n){return 0==n||isNaN(n)?this:(n=this._cleanValue(n,255),this._multiplyMatrix([1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1]),this)};t.adjustContrast=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,100);var i;return 0>t?i=127+t/100*127:(i=t%1,i=0==i?n.DELTA_INDEX[t]:n.DELTA_INDEX[t<<0]*(1-i)+n.DELTA_INDEX[(t<<0)+1]*i,i=127*i+127),this._multiplyMatrix([i/127,0,0,0,.5*(127-i),0,i/127,0,0,.5*(127-i),0,0,i/127,0,.5*(127-i),0,0,0,1,0,0,0,0,0,1]),this};t.adjustSaturation=function(n){if(0==n||isNaN(n))return this;n=this._cleanValue(n,100);var t=1+(n>0?3*n/100:n/100),i=.3086,r=.6094,u=.082;return this._multiplyMatrix([i*(1-t)+t,r*(1-t),u*(1-t),0,0,i*(1-t),r*(1-t)+t,u*(1-t),0,0,i*(1-t),r*(1-t),u*(1-t)+t,0,0,0,0,0,1,0,0,0,0,0,1]),this};t.adjustHue=function(n){if(0==n||isNaN(n))return this;n=this._cleanValue(n,180)/180*Math.PI;var t=Math.cos(n),i=Math.sin(n),r=.213,u=.715,f=.072;return this._multiplyMatrix([r+t*(1-r)+i*-r,u+t*-u+i*-u,f+t*-f+i*(1-f),0,0,r+t*-r+.143*i,u+t*(1-u)+.14*i,f+t*-f+i*-.283,0,0,r+t*-r+i*-(1-r),u+t*-u+i*u,f+t*(1-f)+i*f,0,0,0,0,0,1,0,0,0,0,0,1]),this};t.concat=function(t){return t=this._fixMatrix(t),t.length!=n.LENGTH?this:(this._multiplyMatrix(t),this)};t.clone=function(){return(new n).copy(this)};t.toArray=function(){for(var i=[],t=0,r=n.LENGTH;r>t;t++)i[t]=this[t];return i};t.copy=function(t){for(var r=n.LENGTH,i=0;r>i;i++)this[i]=t[i];return this};t.toString=function(){return"[ColorMatrix]"};t._multiplyMatrix=function(n){for(var t,r,f=[],u,i=0;5>i;i++){for(t=0;5>t;t++)f[t]=this[t+5*i];for(t=0;5>t;t++){for(u=0,r=0;5>r;r++)u+=n[t+5*r]*f[r];this[t+5*i]=u}}};t._cleanValue=function(n,t){return Math.min(t,Math.max(-t,n))};t._fixMatrix=function(t){return t instanceof n&&(t=t.toArray()),t.length<n.LENGTH?t=t.slice(0,t.length).concat(n.IDENTITY_MATRIX.slice(t.length,n.LENGTH)):t.length>n.LENGTH&&(t=t.slice(0,n.LENGTH)),t};createjs.ColorMatrix=n}();this.createjs=this.createjs||{},function(){"use strict";function n(n){this.matrix=n}var t=createjs.extend(n,createjs.Filter);t.toString=function(){return"[ColorMatrixFilter]"};t.clone=function(){return new n(this.matrix)};t._applyFilter=function(n){for(var u,f,e,o,r=n.data,s=r.length,t=this.matrix,h=t[0],c=t[1],l=t[2],a=t[3],v=t[4],y=t[5],p=t[6],w=t[7],b=t[8],k=t[9],d=t[10],g=t[11],nt=t[12],tt=t[13],it=t[14],rt=t[15],ut=t[16],ft=t[17],et=t[18],ot=t[19],i=0;s>i;i+=4)u=r[i],f=r[i+1],e=r[i+2],o=r[i+3],r[i]=u*h+f*c+e*l+o*a+v,r[i+1]=u*y+f*p+e*w+o*b+k,r[i+2]=u*d+f*g+e*nt+o*tt+it,r[i+3]=u*rt+f*ut+e*ft+o*et+ot;return!0};createjs.ColorMatrixFilter=createjs.promote(n,"Filter")}();this.createjs=this.createjs||{},function(){"use strict";function n(){throw"Touch cannot be instantiated";}n.isSupported=function(){return!!("ontouchstart"in window||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0)};n.enable=function(t,i,r){return t&&t.canvas&&n.isSupported()?t.__touch?!0:(t.__touch={pointers:{},multitouch:!i,preventDefault:!r,count:0},"ontouchstart"in window?n._IOS_enable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_enable(t),!0):!1};n.disable=function(t){t&&("ontouchstart"in window?n._IOS_disable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_disable(t),delete t.__touch)};n._IOS_enable=function(t){var i=t.canvas,r=t.__touch.f=function(i){n._IOS_handleEvent(t,i)};i.addEventListener("touchstart",r,!1);i.addEventListener("touchmove",r,!1);i.addEventListener("touchend",r,!1);i.addEventListener("touchcancel",r,!1)};n._IOS_disable=function(n){var t=n.canvas,i;t&&(i=n.__touch.f,t.removeEventListener("touchstart",i,!1),t.removeEventListener("touchmove",i,!1),t.removeEventListener("touchend",i,!1),t.removeEventListener("touchcancel",i,!1))};n._IOS_handleEvent=function(n,t){var i,u;if(n){n.__touch.preventDefault&&t.preventDefault&&t.preventDefault();for(var e=t.changedTouches,r=t.type,f=0,o=e.length;o>f;f++)i=e[f],u=i.identifier,i.target==n.canvas&&("touchstart"==r?this._handleStart(n,u,t,i.pageX,i.pageY):"touchmove"==r?this._handleMove(n,u,t,i.pageX,i.pageY):("touchend"==r||"touchcancel"==r)&&this._handleEnd(n,u,t))}};n._IE_enable=function(t){var r=t.canvas,i=t.__touch.f=function(i){n._IE_handleEvent(t,i)};void 0===window.navigator.pointerEnabled?(r.addEventListener("MSPointerDown",i,!1),window.addEventListener("MSPointerMove",i,!1),window.addEventListener("MSPointerUp",i,!1),window.addEventListener("MSPointerCancel",i,!1),t.__touch.preventDefault&&(r.style.msTouchAction="none")):(r.addEventListener("pointerdown",i,!1),window.addEventListener("pointermove",i,!1),window.addEventListener("pointerup",i,!1),window.addEventListener("pointercancel",i,!1),t.__touch.preventDefault&&(r.style.touchAction="none"));t.__touch.activeIDs={}};n._IE_disable=function(n){var t=n.__touch.f;void 0===window.navigator.pointerEnabled?(window.removeEventListener("MSPointerMove",t,!1),window.removeEventListener("MSPointerUp",t,!1),window.removeEventListener("MSPointerCancel",t,!1),n.canvas&&n.canvas.removeEventListener("MSPointerDown",t,!1)):(window.removeEventListener("pointermove",t,!1),window.removeEventListener("pointerup",t,!1),window.removeEventListener("pointercancel",t,!1),n.canvas&&n.canvas.removeEventListener("pointerdown",t,!1))};n._IE_handleEvent=function(n,t){if(n){n.__touch.preventDefault&&t.preventDefault&&t.preventDefault();var i=t.type,r=t.pointerId,u=n.__touch.activeIDs;if("MSPointerDown"==i||"pointerdown"==i){if(t.srcElement!=n.canvas)return;u[r]=!0;this._handleStart(n,r,t,t.pageX,t.pageY)}else u[r]&&("MSPointerMove"==i||"pointermove"==i?this._handleMove(n,r,t,t.pageX,t.pageY):("MSPointerUp"==i||"MSPointerCancel"==i||"pointerup"==i||"pointercancel"==i)&&(delete u[r],this._handleEnd(n,r,t)))}};n._handleStart=function(n,t,i,r,u){var f=n.__touch,e;(f.multitouch||!f.count)&&(e=f.pointers,e[t]||(e[t]=!0,f.count++,n._handlePointerDown(t,i,r,u)))};n._handleMove=function(n,t,i,r,u){n.__touch.pointers[t]&&n._handlePointerMove(t,i,r,u)};n._handleEnd=function(n,t,i){var r=n.__touch,u=r.pointers;u[t]&&(r.count--,n._handlePointerUp(t,i,!0),delete u[t])};createjs.Touch=n}();this.createjs=this.createjs||{},function(){"use strict";var n=createjs.EaselJS=createjs.EaselJS||{};n.version="0.8.0";n.buildDate="Thu, 11 Dec 2014 23:32:09 GMT"}();
/**
 * @license
 * pixi.js - v2.2.0
 * Copyright (c) 2012-2014, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2014-12-12
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){var i=this,n=n||{},t;n.WEBGL_RENDERER=0;n.CANVAS_RENDERER=1;n.VERSION="v2.2.0";n.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};n.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1};n._UID=0;"undefined"!=typeof Float32Array?(n.Float32Array=Float32Array,n.Uint16Array=Uint16Array,n.Uint32Array=Uint32Array,n.ArrayBuffer=ArrayBuffer):(n.Float32Array=Array,n.Uint16Array=Array);n.INTERACTION_FREQUENCY=30;n.AUTO_PREVENT_DEFAULT=!0;n.PI_2=2*Math.PI;n.RAD_TO_DEG=180/Math.PI;n.DEG_TO_RAD=Math.PI/180;n.RETINA_PREFIX="@2x";n.dontSayHello=!1;n.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1};n.sayHello=function(t){if(!n.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["%c %c %c Pixi.js "+n.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,i)}else window.console&&console.log("Pixi.js "+n.VERSION+" - http://www.pixijs.com/");n.dontSayHello=!0}};n.Point=function(n,t){this.x=n||0;this.y=t||0};n.Point.prototype.clone=function(){return new n.Point(this.x,this.y)};n.Point.prototype.set=function(n,t){this.x=n||0;this.y=t||(0!==t?this.x:0)};n.Point.prototype.constructor=n.Point;n.Rectangle=function(n,t,i,r){this.x=n||0;this.y=t||0;this.width=i||0;this.height=r||0};n.Rectangle.prototype.clone=function(){return new n.Rectangle(this.x,this.y,this.width,this.height)};n.Rectangle.prototype.contains=function(n,t){var i,r;return this.width<=0||this.height<=0?!1:(i=this.x,n>=i&&n<=i+this.width&&(r=this.y,t>=r&&t<=r+this.height))?!0:!1};n.Rectangle.prototype.constructor=n.Rectangle;n.EmptyRectangle=new n.Rectangle(0,0,0,0);n.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),t[0]instanceof n.Point){for(var r=[],i=0,u=t.length;u>i;i++)r.push(t[i].x,t[i].y);t=r}this.closed=!0;this.points=t};n.Polygon.prototype.clone=function(){var t=this.points.slice();return new n.Polygon(t)};n.Polygon.prototype.contains=function(n,t){for(var r=!1,e=this.points.length/2,i=0,u=e-1;e>i;u=i++){var o=this.points[2*i],f=this.points[2*i+1],h=this.points[2*u],s=this.points[2*u+1],c=f>t!=s>t&&(h-o)*(t-f)/(s-f)+o>n;c&&(r=!r)}return r};n.Polygon.prototype.constructor=n.Polygon;n.Circle=function(n,t,i){this.x=n||0;this.y=t||0;this.radius=i||0};n.Circle.prototype.clone=function(){return new n.Circle(this.x,this.y,this.radius)};n.Circle.prototype.contains=function(n,t){if(this.radius<=0)return!1;var i=this.x-n,r=this.y-t,u=this.radius*this.radius;return i*=i,r*=r,u>=i+r};n.Circle.prototype.getBounds=function(){return new n.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};n.Circle.prototype.constructor=n.Circle;n.Ellipse=function(n,t,i,r){this.x=n||0;this.y=t||0;this.width=i||0;this.height=r||0};n.Ellipse.prototype.clone=function(){return new n.Ellipse(this.x,this.y,this.width,this.height)};n.Ellipse.prototype.contains=function(n,t){if(this.width<=0||this.height<=0)return!1;var i=(n-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,1>=i+r};n.Ellipse.prototype.getBounds=function(){return new n.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)};n.Ellipse.prototype.constructor=n.Ellipse;n.RoundedRectangle=function(n,t,i,r,u){this.x=n||0;this.y=t||0;this.width=i||0;this.height=r||0;this.radius=u||20};n.RoundedRectangle.prototype.clone=function(){return new n.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)};n.RoundedRectangle.prototype.contains=function(n,t){var i,r;return this.width<=0||this.height<=0?!1:(i=this.x,n>=i&&n<=i+this.width&&(r=this.y,t>=r&&t<=r+this.height))?!0:!1};n.RoundedRectangle.prototype.constructor=n.RoundedRectangle;n.Matrix=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0};n.Matrix.prototype.fromArray=function(n){this.a=n[0];this.b=n[1];this.c=n[3];this.d=n[4];this.tx=n[2];this.ty=n[5]};n.Matrix.prototype.toArray=function(t){this.array||(this.array=new n.Float32Array(9));var i=this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i};n.Matrix.prototype.apply=function(t,i){return i=i||new n.Point,i.x=this.a*t.x+this.c*t.y+this.tx,i.y=this.b*t.x+this.d*t.y+this.ty,i};n.Matrix.prototype.applyInverse=function(t,i){i=i||new n.Point;var r=1/(this.a*this.d+this.c*-this.b);return i.x=this.d*r*t.x+-this.c*r*t.y+(this.ty*this.c-this.tx*this.d)*r,i.y=this.a*r*t.y+-this.b*r*t.x+(-this.ty*this.a+this.tx*this.b)*r,i};n.Matrix.prototype.translate=function(n,t){return this.tx+=n,this.ty+=t,this};n.Matrix.prototype.scale=function(n,t){return this.a*=n,this.d*=t,this.c*=n,this.b*=t,this.tx*=n,this.ty*=t,this};n.Matrix.prototype.rotate=function(n){var t=Math.cos(n),i=Math.sin(n),r=this.a,u=this.c,f=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=u*t-this.d*i,this.d=u*i+this.d*t,this.tx=f*t-this.ty*i,this.ty=f*i+this.ty*t,this};n.Matrix.prototype.append=function(n){var t=this.a,i=this.b,r=this.c,u=this.d;return this.a=n.a*t+n.b*r,this.b=n.a*i+n.b*u,this.c=n.c*t+n.d*r,this.d=n.c*i+n.d*u,this.tx=n.tx*t+n.ty*r+this.tx,this.ty=n.tx*i+n.ty*u+this.ty,this};n.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this};n.identityMatrix=new n.Matrix;n.DisplayObject=function(){this.position=new n.Point;this.scale=new n.Point(1,1);this.pivot=new n.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.buttonMode=!1;this.renderable=!1;this.parent=null;this.stage=null;this.worldAlpha=1;this._interactive=!1;this.defaultCursor="pointer";this.worldTransform=new n.Matrix;this._sr=0;this._cr=1;this.filterArea=null;this._bounds=new n.Rectangle(0,0,1,1);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=!1;this._cacheIsDirty=!1};n.DisplayObject.prototype.constructor=n.DisplayObject;Object.defineProperty(n.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(n){this._interactive=n;this.stage&&(this.stage.dirty=!0)}});Object.defineProperty(n.DisplayObject.prototype,"worldVisible",{get:function(){var n=this;do{if(!n.visible)return!1;n=n.parent}while(n);return!0}});Object.defineProperty(n.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(n){this._mask&&(this._mask.isMask=!1);this._mask=n;this._mask&&(this._mask.isMask=!0)}});Object.defineProperty(n.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(n){var r,t,u,i;if(n){for(r=[],t=0;t<n.length;t++)for(u=n[t].passes,i=0;i<u.length;i++)r.push(u[i]);this._filterBlock={target:this,filterPasses:r}}this._filters=n}});Object.defineProperty(n.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(n){this._cacheAsBitmap!==n&&(n?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=n)}});n.DisplayObject.prototype.updateTransform=function(){var r,o,s,u,f,e,t=this.parent.worldTransform,i=this.worldTransform;this.rotation%n.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),r=this._cr*this.scale.x,o=this._sr*this.scale.x,s=-this._sr*this.scale.y,u=this._cr*this.scale.y,f=this.position.x,e=this.position.y,(this.pivot.x||this.pivot.y)&&(f-=this.pivot.x*r+this.pivot.y*s,e-=this.pivot.x*o+this.pivot.y*u),i.a=r*t.a+o*t.c,i.b=r*t.b+o*t.d,i.c=s*t.a+u*t.c,i.d=s*t.b+u*t.d,i.tx=f*t.a+e*t.c+t.tx,i.ty=f*t.b+e*t.d+t.ty):(r=this.scale.x,u=this.scale.y,f=this.position.x-this.pivot.x*r,e=this.position.y-this.pivot.y*u,i.a=r*t.a,i.b=r*t.b,i.c=u*t.c,i.d=u*t.d,i.tx=f*t.a+e*t.c+t.tx,i.ty=f*t.b+e*t.d+t.ty);this.worldAlpha=this.alpha*this.parent.worldAlpha};n.DisplayObject.prototype.displayObjectUpdateTransform=n.DisplayObject.prototype.updateTransform;n.DisplayObject.prototype.getBounds=function(t){return t=t,n.EmptyRectangle};n.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(n.identityMatrix)};n.DisplayObject.prototype.setStageReference=function(n){this.stage=n;this._interactive&&(this.stage.dirty=!0)};n.DisplayObject.prototype.generateTexture=function(t,i,r){var u=this.getLocalBounds(),f=new n.RenderTexture(0|u.width,0|u.height,r,i,t);return n.DisplayObject._tempMatrix.tx=-u.x,n.DisplayObject._tempMatrix.ty=-u.y,f.render(this,n.DisplayObject._tempMatrix),f};n.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()};n.DisplayObject.prototype.toGlobal=function(n){return this.displayObjectUpdateTransform(),this.worldTransform.apply(n)};n.DisplayObject.prototype.toLocal=function(n,t){return t&&(n=t.toGlobal(n)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(n)};n.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha;t.gl?n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):n.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)};n.DisplayObject.prototype._generateCachedSprite=function(){var t,r,i;this._cacheAsBitmap=!1;t=this.getLocalBounds();this._cachedSprite?this._cachedSprite.texture.resize(0|t.width,0|t.height):(r=new n.RenderTexture(0|t.width,0|t.height),this._cachedSprite=new n.Sprite(r),this._cachedSprite.worldTransform=this.worldTransform);i=this._filters;this._filters=null;this._cachedSprite.filters=i;n.DisplayObject._tempMatrix.tx=-t.x;n.DisplayObject._tempMatrix.ty=-t.y;this._cachedSprite.texture.render(this,n.DisplayObject._tempMatrix,!0);this._cachedSprite.anchor.x=-(t.x/t.width);this._cachedSprite.anchor.y=-(t.y/t.height);this._filters=i;this._cacheAsBitmap=!0};n.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)};n.DisplayObject.prototype._renderWebGL=function(n){n=n};n.DisplayObject.prototype._renderCanvas=function(n){n=n};n.DisplayObject._tempMatrix=new n.Matrix;Object.defineProperty(n.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(n){this.position.x=n}});Object.defineProperty(n.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(n){this.position.y=n}});n.DisplayObjectContainer=function(){n.DisplayObject.call(this);this.children=[]};n.DisplayObjectContainer.prototype=Object.create(n.DisplayObject.prototype);n.DisplayObjectContainer.prototype.constructor=n.DisplayObjectContainer;Object.defineProperty(n.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(n){var t=this.getLocalBounds().width;this.scale.x=0!==t?n/t:1;this._width=n}});Object.defineProperty(n.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(n){var t=this.getLocalBounds().height;this.scale.y=0!==t?n/t:1;this._height=n}});n.DisplayObjectContainer.prototype.addChild=function(n){return this.addChildAt(n,this.children.length)};n.DisplayObjectContainer.prototype.addChildAt=function(n,t){if(t>=0&&t<=this.children.length)return n.parent&&n.parent.removeChild(n),n.parent=this,this.children.splice(t,0,n),this.stage&&n.setStageReference(this.stage),n;throw new Error(n+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);};n.DisplayObjectContainer.prototype.swapChildren=function(n,t){if(n!==t){var i=this.getChildIndex(n),r=this.getChildIndex(t);if(0>i||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=t;this.children[r]=n}};n.DisplayObjectContainer.prototype.getChildIndex=function(n){var t=this.children.indexOf(n);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t};n.DisplayObjectContainer.prototype.setChildIndex=function(n,t){if(0>t||t>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(n);this.children.splice(i,1);this.children.splice(t,0,n)};n.DisplayObjectContainer.prototype.getChildAt=function(n){if(0>n||n>=this.children.length)throw new Error("getChildAt: Supplied index "+n+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[n]};n.DisplayObjectContainer.prototype.removeChild=function(n){var t=this.children.indexOf(n);if(-1!==t)return this.removeChildAt(t)};n.DisplayObjectContainer.prototype.removeChildAt=function(n){var t=this.getChildAt(n);return this.stage&&t.removeStageReference(),t.parent=void 0,this.children.splice(n,1),t};n.DisplayObjectContainer.prototype.removeChildren=function(n,t){var e=n||0,o="number"==typeof t?t:this.children.length,i=o-e,r,u,f;if(i>0&&o>=i){for(r=this.children.splice(e,i),u=0;u<r.length;u++)f=r[u],this.stage&&f.removeStageReference(),f.parent=void 0;return r}if(0===i&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range");};n.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var n=0,t=this.children.length;t>n;n++)this.children[n].updateTransform()};n.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=n.DisplayObjectContainer.prototype.updateTransform;n.DisplayObjectContainer.prototype.getBounds=function(){var l,i;if(0===this.children.length)return n.EmptyRectangle;for(var t,s,h,r=1/0,u=1/0,f=-1/0,e=-1/0,c=!1,o=0,a=this.children.length;a>o;o++)l=this.children[o],l.visible&&(c=!0,t=this.children[o].getBounds(),r=r<t.x?r:t.x,u=u<t.y?u:t.y,s=t.width+t.x,h=t.height+t.y,f=f>s?f:s,e=e>h?e:h);return c?(i=this._bounds,i.x=r,i.y=u,i.width=f-r,i.height=e-u,i):n.EmptyRectangle};n.DisplayObjectContainer.prototype.getLocalBounds=function(){var u=this.worldTransform,t,i,r;for(this.worldTransform=n.identityMatrix,t=0,i=this.children.length;i>t;t++)this.children[t].updateTransform();return r=this.getBounds(),this.worldTransform=u,r};n.DisplayObjectContainer.prototype.setStageReference=function(n){var t,i,r;for(this.stage=n,this._interactive&&(this.stage.dirty=!0),t=0,i=this.children.length;i>t;t++)r=this.children[t],r.setStageReference(n)};n.DisplayObjectContainer.prototype.removeStageReference=function(){for(var i,n=0,t=this.children.length;t>n;n++)i=this.children[n],i.removeStageReference();this._interactive&&(this.stage.dirty=!0);this.stage=null};n.DisplayObjectContainer.prototype._renderWebGL=function(n){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return this._renderCachedSprite(n),void 0;var t,i;if(this._mask||this._filters){for(this._filters&&(n.spriteBatch.flush(),n.filterManager.pushFilter(this._filterBlock)),this._mask&&(n.spriteBatch.stop(),n.maskManager.pushMask(this.mask,n),n.spriteBatch.start()),t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(n);n.spriteBatch.stop();this._mask&&n.maskManager.popMask(this._mask,n);this._filters&&n.filterManager.popFilter();n.spriteBatch.start()}else for(t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(n)}};n.DisplayObjectContainer.prototype._renderCanvas=function(n){var t,i,r;if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return this._renderCachedSprite(n),void 0;for(this._mask&&n.maskManager.pushMask(this._mask,n),t=0,i=this.children.length;i>t;t++)r=this.children[t],r._renderCanvas(n);this._mask&&n.maskManager.popMask(n)}};n.Sprite=function(t){n.DisplayObjectContainer.call(this);this.anchor=new n.Point;this.texture=t||n.Texture.emptyTexture;this._width=0;this._height=0;this.tint=16777215;this.blendMode=n.blendModes.NORMAL;this.shader=null;this.texture.baseTexture.hasLoaded?this.onTextureUpdate():this.texture.on("update",this.onTextureUpdate.bind(this));this.renderable=!0};n.Sprite.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Sprite.prototype.constructor=n.Sprite;Object.defineProperty(n.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(n){this.scale.x=n/this.texture.frame.width;this._width=n}});Object.defineProperty(n.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(n){this.scale.y=n/this.texture.frame.height;this._height=n}});n.Sprite.prototype.setTexture=function(n){this.texture=n;this.cachedTint=16777215};n.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height)};n.Sprite.prototype.getBounds=function(n){var ut=this.texture.frame.width,ft=this.texture.frame.height,l=ut*(1-this.anchor.x),a=ut*-this.anchor.x,v=ft*(1-this.anchor.y),y=ft*-this.anchor.y,s=n||this.worldTransform,f=s.a,p=s.b,w=s.c,e=s.d,h=s.tx,c=s.ty,r=-1/0,u=-1/0,t=1/0,i=1/0,o;if(0===p&&0===w)0>f&&(f*=-1),0>e&&(e*=-1),t=f*a+h,r=f*l+h,i=e*y+c,u=e*v+c;else{var b=f*a+w*y+h,k=e*y+p*a+c,d=f*l+w*y+h,g=e*y+p*l+c,nt=f*l+w*v+h,tt=e*v+p*l+c,it=f*a+w*v+h,rt=e*v+p*a+c;t=t>b?b:t;t=t>d?d:t;t=t>nt?nt:t;t=t>it?it:t;i=i>k?k:i;i=i>g?g:i;i=i>tt?tt:i;i=i>rt?rt:i;r=b>r?b:r;r=d>r?d:r;r=nt>r?nt:r;r=it>r?it:r;u=k>u?k:u;u=g>u?g:u;u=tt>u?tt:u;u=rt>u?rt:u}return o=this._bounds,o.x=t,o.width=r-t,o.y=i,o.height=u-i,this._currentBounds=o,o};n.Sprite.prototype._renderWebGL=function(n){var t,r,i;if(this.visible&&!(this.alpha<=0))if(this._mask||this._filters){for(i=n.spriteBatch,this._filters&&(i.flush(),n.filterManager.pushFilter(this._filterBlock)),this._mask&&(i.stop(),n.maskManager.pushMask(this.mask,n),i.start()),i.render(this),t=0,r=this.children.length;r>t;t++)this.children[t]._renderWebGL(n);i.stop();this._mask&&n.maskManager.popMask(this._mask,n);this._filters&&n.filterManager.popFilter();i.start()}else for(n.spriteBatch.render(this),t=0,r=this.children.length;r>t;t++)this.children[t]._renderWebGL(n)};n.Sprite.prototype._renderCanvas=function(t){var i,r,u,f,e;if(!(this.visible===!1||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){for((this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid)&&(i=this.texture.baseTexture.resolution/t.resolution,t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===n.scaleModes.LINEAR),r=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,u=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,t.roundPixels?(t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution|0,this.worldTransform.ty*t.resolution|0),r=0|r,u=0|u):t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=n.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,r/i,u/i,this.texture.crop.width/i,this.texture.crop.height/i)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,r/i,u/i,this.texture.crop.width/i,this.texture.crop.height/i)),f=0,e=this.children.length;e>f;f++)this.children[f]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}};n.Sprite.fromFrame=function(t){var i=n.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new n.Sprite(i)};n.Sprite.fromImage=function(t,i,r){var u=n.Texture.fromImage(t,i,r);return new n.Sprite(u)};n.SpriteBatch=function(t){n.DisplayObjectContainer.call(this);this.textureThing=t;this.ready=!1};n.SpriteBatch.prototype=Object.create(n.DisplayObjectContainer.prototype);n.SpriteBatch.prototype.constructor=n.SpriteBatch;n.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new n.WebGLFastSpriteBatch(t);this.ready=!0};n.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};n.SpriteBatch.prototype._renderWebGL=function(n){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(n.gl),n.spriteBatch.stop(),n.shaderManager.setShader(n.shaderManager.fastShader),this.fastSpriteBatch.begin(this,n),this.fastSpriteBatch.render(this),n.spriteBatch.start())};n.SpriteBatch.prototype._renderCanvas=function(n){var u,t,o,i,r;if(this.visible&&!(this.alpha<=0)&&this.children.length){u=n.context;u.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var f=this.worldTransform,e=!0,s=0;s<this.children.length;s++)t=this.children[s],t.visible&&(o=t.texture,i=o.frame,(u.globalAlpha=this.worldAlpha*t.alpha,t.rotation%(2*Math.PI)==0)?(e&&(u.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),e=!1),u.drawImage(o.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width*t.scale.x+t.position.x+.5|0,t.anchor.y*-i.height*t.scale.y+t.position.y+.5|0,i.width*t.scale.x,i.height*t.scale.y)):(e||(e=!0),t.displayObjectUpdateTransform(),r=t.worldTransform,n.roundPixels?u.setTransform(r.a,r.b,r.c,r.d,0|r.tx,0|r.ty):u.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),u.drawImage(o.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width+.5|0,t.anchor.y*-i.height+.5|0,i.width,i.height)))}};n.MovieClip=function(t){n.Sprite.call(this,t[0]);this.textures=t;this.animationSpeed=1;this.loop=!0;this.onComplete=null;this.currentFrame=0;this.playing=!1};n.MovieClip.prototype=Object.create(n.Sprite.prototype);n.MovieClip.prototype.constructor=n.MovieClip;Object.defineProperty(n.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}});n.MovieClip.prototype.stop=function(){this.playing=!1};n.MovieClip.prototype.play=function(){this.playing=!0};n.MovieClip.prototype.gotoAndStop=function(n){this.playing=!1;this.currentFrame=n;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])};n.MovieClip.prototype.gotoAndPlay=function(n){this.currentFrame=n;this.playing=!0};n.MovieClip.prototype.updateTransform=function(){if(this.displayObjectContainerUpdateTransform(),this.playing){this.currentFrame+=this.animationSpeed;var n=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length;this.loop||n<this.textures.length?this.setTexture(this.textures[n%this.textures.length]):n>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}};n.MovieClip.fromFrames=function(t){for(var r=[],i=0;i<t.length;i++)r.push(new n.Texture.fromFrame(t[i]));return new n.MovieClip(r)};n.MovieClip.fromImages=function(t){for(var r=[],i=0;i<t.length;i++)r.push(new n.Texture.fromImage(t[i]));return new n.MovieClip(r)};n.FilterBlock=function(){this.visible=!0;this.renderable=!0};n.FilterBlock.prototype.constructor=n.FilterBlock;n.Text=function(t,i){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=1;n.Sprite.call(this,n.Texture.fromCanvas(this.canvas));this.setText(t);this.setStyle(i)};n.Text.prototype=Object.create(n.Sprite.prototype);n.Text.prototype.constructor=n.Text;Object.defineProperty(n.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(n){this.scale.x=n/this.texture.frame.width;this._width=n}});Object.defineProperty(n.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(n){this.scale.y=n/this.texture.frame.height;this._height=n}});n.Text.prototype.setStyle=function(n){n=n||{};n.font=n.font||"bold 20pt Arial";n.fill=n.fill||"black";n.align=n.align||"left";n.stroke=n.stroke||"black";n.strokeThickness=n.strokeThickness||0;n.wordWrap=n.wordWrap||!1;n.wordWrapWidth=n.wordWrapWidth||100;n.dropShadow=n.dropShadow||!1;n.dropShadowAngle=n.dropShadowAngle||Math.PI/6;n.dropShadowDistance=n.dropShadowDistance||4;n.dropShadowColor=n.dropShadowColor||"black";this.style=n;this.dirty=!0};n.Text.prototype.setText=function(n){this.text=n.toString()||" ";this.dirty=!0};n.Text.prototype.updateText=function(){var o,h,c,e,l,t,f,a,v;this.texture.baseTexture.resolution=this.resolution;this.context.font=this.style.font;o=this.text;this.style.wordWrap&&(o=this.wordWrap(this.text));for(var i=o.split(/(?:\r\n|\r|\n)/),u=[],r=0,s=this.determineFontProperties(this.style.font),n=0;n<i.length;n++)h=this.context.measureText(i[n]).width,u[n]=h,r=Math.max(r,h);if(c=r+this.style.strokeThickness,this.style.dropShadow&&(c+=this.style.dropShadowDistance),this.canvas.width=(c+this.context.lineWidth)*this.resolution,e=s.fontSize+this.style.strokeThickness,l=e*i.length,this.style.dropShadow&&(l+=this.style.dropShadowDistance),this.canvas.height=l*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="alphabetic",this.style.dropShadow)for(this.context.fillStyle=this.style.dropShadowColor,a=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,v=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance,n=0;n<i.length;n++)t=this.style.strokeThickness/2,f=this.style.strokeThickness/2+n*e+s.ascent,"right"===this.style.align?t+=r-u[n]:"center"===this.style.align&&(t+=(r-u[n])/2),this.style.fill&&this.context.fillText(i[n],t+a,f+v);for(this.context.fillStyle=this.style.fill,n=0;n<i.length;n++)t=this.style.strokeThickness/2,f=this.style.strokeThickness/2+n*e+s.ascent,"right"===this.style.align?t+=r-u[n]:"center"===this.style.align&&(t+=(r-u[n])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(i[n],t,f),this.style.fill&&this.context.fillText(i[n],t,f);this.updateTexture()};n.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.crop.width=this.texture.frame.width=this.canvas.width;this.texture.crop.height=this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;this.texture.baseTexture.dirty()};n.Text.prototype._renderWebGL=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1);n.Sprite.prototype._renderWebGL.call(this,t)};n.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1);n.Sprite.prototype._renderCanvas.call(this,t)};n.Text.prototype.determineFontProperties=function(t){var r=n.Text.fontPropertiesCache[t],a,i;if(!r){r={};a=n.Text.fontPropertiesCanvas;i=n.Text.fontPropertiesContext;i.font=t;var c=Math.ceil(i.measureText("|Mq").width),u=Math.ceil(i.measureText("M").width),l=2*u;u=1.4*u|0;a.width=c;a.height=l;i.fillStyle="#f00";i.fillRect(0,0,c,l);i.font=t;i.textBaseline="alphabetic";i.fillStyle="#000";i.fillText("|MÉq",0,u);for(var e,v=i.getImageData(0,0,c,l).data,y=v.length,o=4*c,s=0,h=!1,f=0;u>f;f++){for(e=0;o>e;e+=4)if(255!==v[s+e]){h=!0;break}if(h)break;s+=o}for(r.ascent=u-f,s=y-o,h=!1,f=l;f>u;f--){for(e=0;o>e;e+=4)if(255!==v[s+e]){h=!0;break}if(h)break;s-=o}r.descent=f-u;r.descent+=6;r.fontSize=r.ascent+r.descent;n.Text.fontPropertiesCache[t]=r}return r};n.Text.prototype.wordWrap=function(n){for(var o,s,i="",f=n.split("\n"),r=0;r<f.length;r++){for(var e=this.style.wordWrapWidth,u=f[r].split(" "),t=0;t<u.length;t++)o=this.context.measureText(u[t]).width,s=o+this.context.measureText(" ").width,0===t||s>e?(t>0&&(i+="\n"),i+=u[t],e=this.style.wordWrapWidth-o):(e-=s,i+=" "+u[t]);r<f.length-1&&(i+="\n")}return i};n.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),n.Sprite.prototype.getBounds.call(this,t)};n.Text.prototype.destroy=function(n){this.context=null;this.canvas=null;this.texture.destroy(void 0===n?!0:n)};n.Text.fontPropertiesCache={};n.Text.fontPropertiesCanvas=document.createElement("canvas");n.Text.fontPropertiesContext=n.Text.fontPropertiesCanvas.getContext("2d");n.BitmapText=function(t,i){n.DisplayObjectContainer.call(this);this.textWidth=0;this.textHeight=0;this._pool=[];this.setText(t);this.setStyle(i);this.updateText();this.dirty=!1};n.BitmapText.prototype=Object.create(n.DisplayObjectContainer.prototype);n.BitmapText.prototype.constructor=n.BitmapText;n.BitmapText.prototype.setText=function(n){this.text=n||" ";this.dirty=!0};n.BitmapText.prototype.setStyle=function(t){t=t||{};t.align=t.align||"left";this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1];this.fontSize=i.length>=2?parseInt(i[i.length-2],10):n.BitmapText.fonts[this.fontName].size;this.dirty=!0;this.tint=t.tint};n.BitmapText.prototype.updateText=function(){for(var l,u,y,a,r,p,h=n.BitmapText.fonts[this.fontName],i=new n.Point,o=null,f=[],e=0,c=[],v=0,s=this.fontSize/h.size,t=0;t<this.text.length;t++)l=this.text.charCodeAt(t),/(?:\r\n|\r|\n)/.test(this.text.charAt(t))?(c.push(i.x),e=Math.max(e,i.x),v++,i.x=0,i.y+=h.lineHeight,o=null):(u=h.chars[l],u&&(o&&u.kerning[o]&&(i.x+=u.kerning[o]),f.push({texture:u.texture,line:v,charCode:l,position:new n.Point(i.x+u.xOffset,i.y+u.yOffset)}),i.x+=u.xAdvance,o=l));for(c.push(i.x),e=Math.max(e,i.x),y=[],t=0;v>=t;t++)a=0,"right"===this.style.align?a=e-c[t]:"center"===this.style.align&&(a=(e-c[t])/2),y.push(a);var b=this.children.length,w=f.length,k=this.tint||16777215;for(t=0;w>t;t++)r=b>t?this.children[t]:this._pool.pop(),r?r.setTexture(f[t].texture):r=new n.Sprite(f[t].texture),r.position.x=(f[t].position.x+y[f[t].line])*s,r.position.y=f[t].position.y*s,r.scale.x=r.scale.y=s,r.tint=k,r.parent||this.addChild(r);for(;this.children.length>w;)p=this.getChildAt(this.children.length-1),this._pool.push(p),this.removeChild(p);this.textWidth=e*s;this.textHeight=(i.y+h.lineHeight)*s};n.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1);n.DisplayObjectContainer.prototype.updateTransform.call(this)};n.BitmapText.fonts={};n.InteractionData=function(){this.global=new n.Point;this.target=null;this.originalEvent=null};n.InteractionData.prototype.getLocalPosition=function(t,i){var r=t.worldTransform,f=this.global,e=r.a,o=r.c,c=r.tx,s=r.b,h=r.d,l=r.ty,u=1/(e*h+o*-s);return i=i||new n.Point,i.x=h*u*f.x+-o*u*f.y+(l*o-c*h)*u,i.y=e*u*f.y+-s*u*f.x+(-l*e+c*s)*u,i};n.InteractionData.prototype.constructor=n.InteractionData;n.InteractionManager=function(t){this.stage=t;this.mouse=new n.InteractionData;this.touches={};this.tempPoint=new n.Point;this.mouseoverEnabled=!0;this.pool=[];this.interactiveItems=[];this.interactionDOMElement=null;this.onMouseMove=this.onMouseMove.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.onMouseUp=this.onMouseUp.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);this.onTouchMove=this.onTouchMove.bind(this);this.last=0;this.currentCursorStyle="inherit";this.mouseOut=!1;this.resolution=1;this._tempPoint=new n.Point};n.InteractionManager.prototype.constructor=n.InteractionManager;n.InteractionManager.prototype.collectInteractiveSprite=function(n,t){for(var i,u=n.children,f=u.length,r=f-1;r>=0;r--)i=u[r],i._interactive?(t.interactiveChildren=!0,this.interactiveItems.push(i),i.children.length>0&&this.collectInteractiveSprite(i,i)):(i.__iParent=null,i.children.length>0&&this.collectInteractiveSprite(i,t))};n.InteractionManager.prototype.setTarget=function(n){this.target=n;this.resolution=n.resolution;null===this.interactionDOMElement&&this.setTargetDomElement(n.view)};n.InteractionManager.prototype.setTargetDomElement=function(n){this.removeEvents();window.navigator.msPointerEnabled&&(n.style["-ms-content-zooming"]="none",n.style["-ms-touch-action"]="none");this.interactionDOMElement=n;n.addEventListener("mousemove",this.onMouseMove,!0);n.addEventListener("mousedown",this.onMouseDown,!0);n.addEventListener("mouseout",this.onMouseOut,!0);n.addEventListener("touchstart",this.onTouchStart,!0);n.addEventListener("touchend",this.onTouchEnd,!0);n.addEventListener("touchmove",this.onTouchMove,!0);window.addEventListener("mouseup",this.onMouseUp,!0)};n.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))};n.InteractionManager.prototype.update=function(){var f,r,i,t;if(this.target&&(f=Date.now(),r=f-this.last,r=r*n.INTERACTION_FREQUENCY/1e3,!(1>r))){this.last=f;i=0;this.dirty&&this.rebuildInteractiveGraph();var o=this.interactiveItems.length,u="inherit",e=!1;for(i=0;o>i;i++)t=this.interactiveItems[i],t.__hit=this.hitTest(t,this.mouse),this.mouse.target=t,t.__hit&&!e?(t.buttonMode&&(u=t.defaultCursor),t.interactiveChildren||(e=!0),t.__isOver||(t.mouseover&&t.mouseover(this.mouse),t.__isOver=!0)):t.__isOver&&(t.mouseout&&t.mouseout(this.mouse),t.__isOver=!1);this.currentCursorStyle!==u&&(this.currentCursorStyle=u,this.interactionDOMElement.style.cursor=u)}};n.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,n=0;t>n;n++)this.interactiveItems[n].interactiveChildren=!1;this.interactiveItems=[];this.stage.interactive&&this.interactiveItems.push(this.stage);this.collectInteractiveSprite(this.stage,this.stage)};n.InteractionManager.prototype.onMouseMove=function(n){var t,u,i,r;for(this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=n,t=this.interactionDOMElement.getBoundingClientRect(),this.mouse.global.x=(n.clientX-t.left)*(this.target.width/t.width)/this.resolution,this.mouse.global.y=(n.clientY-t.top)*(this.target.height/t.height)/this.resolution,u=this.interactiveItems.length,i=0;u>i;i++)r=this.interactiveItems[i],r.mousemove&&r.mousemove(this.mouse)};n.InteractionManager.prototype.onMouseDown=function(t){var i;this.dirty&&this.rebuildInteractiveGraph();this.mouse.originalEvent=t;n.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var o=this.interactiveItems.length,e=this.mouse.originalEvent,r=2===e.button||3===e.which,u=r?"rightdown":"mousedown",s=r?"rightclick":"click",h=r?"__rightIsDown":"__mouseIsDown",c=r?"__isRightDown":"__isDown",f=0;o>f;f++)if(i=this.interactiveItems[f],(i[u]||i[s])&&(i[h]=!0,i.__hit=this.hitTest(i,this.mouse),i.__hit&&(i[u]&&i[u](this.mouse),i[c]=!0,!i.interactiveChildren)))break};n.InteractionManager.prototype.onMouseOut=function(n){var r,i,t;for(this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=n,r=this.interactiveItems.length,this.interactionDOMElement.style.cursor="inherit",i=0;r>i;i++)t=this.interactiveItems[i],t.__isOver&&(this.mouse.target=t,t.mouseout&&t.mouseout(this.mouse),t.__isOver=!1);this.mouseOut=!0;this.mouse.global.x=-1e4;this.mouse.global.y=-1e4};n.InteractionManager.prototype.onMouseUp=function(n){var t;this.dirty&&this.rebuildInteractiveGraph();this.mouse.originalEvent=n;for(var c=this.interactiveItems.length,s=!1,h=this.mouse.originalEvent,i=2===h.button||3===h.which,r=i?"rightup":"mouseup",u=i?"rightclick":"click",f=i?"rightupoutside":"mouseupoutside",e=i?"__isRightDown":"__isDown",o=0;c>o;o++)t=this.interactiveItems[o],(t[u]||t[r]||t[f])&&(t.__hit=this.hitTest(t,this.mouse),t.__hit&&!s?(t[r]&&t[r](this.mouse),t[e]&&t[u]&&t[u](this.mouse),t.interactiveChildren||(s=!0)):t[e]&&t[f]&&t[f](this.mouse),t[e]=!1)};n.InteractionManager.prototype.hitTest=function(t,i){var p=i.global,r,u,f,s,e,a,v,y;if(!t.worldVisible)return!1;if(t.worldTransform.applyInverse(p,this._tempPoint),u=this._tempPoint.x,f=this._tempPoint.y,i.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(u,f);if(t instanceof n.Sprite){var o,h=t.texture.frame.width,c=t.texture.frame.height,l=-h*t.anchor.x;if(u>l&&l+h>u&&(o=-c*t.anchor.y,f>o&&o+c>f))return!0}else if(t instanceof n.Graphics)for(s=t.graphicsData,r=0;r<s.length;r++)if(e=s[r],e.fill&&e.shape&&e.shape.contains(u,f))return!0;for(a=t.children.length,r=0;a>r;r++)if(v=t.children[r],y=this.hitTest(v,i),y)return i.target=t,!0;return!1};n.InteractionManager.prototype.onTouchMove=function(n){var i,e,u;this.dirty&&this.rebuildInteractiveGraph();for(var t,r=this.interactionDOMElement.getBoundingClientRect(),o=n.changedTouches,f=0,f=0;f<o.length;f++)for(i=o[f],t=this.touches[i.identifier],t.originalEvent=n,t.global.x=(i.clientX-r.left)*(this.target.width/r.width)/this.resolution,t.global.y=(i.clientY-r.top)*(this.target.height/r.height)/this.resolution,!navigator.isCocoonJS||r.left||r.top||n.target.style.width||n.target.style.height||(t.global.x=i.clientX,t.global.y=i.clientY),e=0;e<this.interactiveItems.length;e++)u=this.interactiveItems[e],u.touchmove&&u.__touchData&&u.__touchData[i.identifier]&&u.touchmove(t)};n.InteractionManager.prototype.onTouchStart=function(t){var u,s,e,f,r,h,o,i;for(this.dirty&&this.rebuildInteractiveGraph(),u=this.interactionDOMElement.getBoundingClientRect(),n.AUTO_PREVENT_DEFAULT&&t.preventDefault(),s=t.changedTouches,e=0;e<s.length;e++)for(f=s[e],r=this.pool.pop(),r||(r=new n.InteractionData),r.originalEvent=t,this.touches[f.identifier]=r,r.global.x=(f.clientX-u.left)*(this.target.width/u.width)/this.resolution,r.global.y=(f.clientY-u.top)*(this.target.height/u.height)/this.resolution,!navigator.isCocoonJS||u.left||u.top||t.target.style.width||t.target.style.height||(r.global.x=f.clientX,r.global.y=f.clientY),h=this.interactiveItems.length,o=0;h>o;o++)if(i=this.interactiveItems[o],(i.touchstart||i.tap)&&(i.__hit=this.hitTest(i,r),i.__hit&&(i.touchstart&&i.touchstart(r),i.__isDown=!0,i.__touchData=i.__touchData||{},i.__touchData[f.identifier]=r,!i.interactiveChildren)))break};n.InteractionManager.prototype.onTouchEnd=function(n){var h,f,t;this.dirty&&this.rebuildInteractiveGraph();for(var u=this.interactionDOMElement.getBoundingClientRect(),o=n.changedTouches,e=0;e<o.length;e++){var i=o[e],r=this.touches[i.identifier],s=!1;for(r.global.x=(i.clientX-u.left)*(this.target.width/u.width)/this.resolution,r.global.y=(i.clientY-u.top)*(this.target.height/u.height)/this.resolution,!navigator.isCocoonJS||u.left||u.top||n.target.style.width||n.target.style.height||(r.global.x=i.clientX,r.global.y=i.clientY),h=this.interactiveItems.length,f=0;h>f;f++)t=this.interactiveItems[f],t.__touchData&&t.__touchData[i.identifier]&&(t.__hit=this.hitTest(t,t.__touchData[i.identifier]),r.originalEvent=n,(t.touchend||t.tap)&&(t.__hit&&!s?(t.touchend&&t.touchend(r),t.__isDown&&t.tap&&t.tap(r),t.interactiveChildren||(s=!0)):t.__isDown&&t.touchendoutside&&t.touchendoutside(r),t.__isDown=!1),t.__touchData[i.identifier]=null);this.pool.push(r);this.touches[i.identifier]=null}};n.Stage=function(t){n.DisplayObjectContainer.call(this);this.worldTransform=new n.Matrix;this.interactive=!0;this.interactionManager=new n.InteractionManager(this);this.dirty=!0;this.stage=this;this.stage.hitArea=new n.Rectangle(0,0,1e5,1e5);this.setBackgroundColor(t)};n.Stage.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Stage.prototype.constructor=n.Stage;n.Stage.prototype.setInteractionDelegate=function(n){this.interactionManager.setTargetDomElement(n)};n.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var n=0,t=this.children.length;t>n;n++)this.children[n].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0);this.interactive&&this.interactionManager.update()};n.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0;this.backgroundColorSplit=n.hex2rgb(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i;this.backgroundColorString="#"+i};n.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},function(n){for(var r=0,i=["ms","moz","webkit","o"],t=0;t<i.length&&!n.requestAnimationFrame;++t)n.requestAnimationFrame=n[i[t]+"RequestAnimationFrame"],n.cancelAnimationFrame=n[i[t]+"CancelAnimationFrame"]||n[i[t]+"CancelRequestAnimationFrame"];n.requestAnimationFrame||(n.requestAnimationFrame=function(t){var i=(new Date).getTime(),u=Math.max(0,16-(i-r)),f=n.setTimeout(function(){t(i+u)},u);return r=i+u,f});n.cancelAnimationFrame||(n.cancelAnimationFrame=function(n){clearTimeout(n)});n.requestAnimFrame=n.requestAnimationFrame}(this);n.hex2rgb=function(n){return[(n>>16&255)/255,(n>>8&255)/255,(255&n)/255]};n.rgb2hex=function(n){return(255*n[0]<<16)+(255*n[1]<<8)+255*n[2]};"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(n){function i(){for(var t=arguments.length,f=new Array(t);t--;)f[t]=arguments[t];return f=u.concat(f),r.apply(this instanceof i?this:n,f)}var r=this,t=arguments.length-1,u=[];if(t>0)for(u.length=t;t--;)u[t]=arguments[t+1];if("function"!=typeof r)throw new TypeError;return i.prototype=function f(n){return n&&(f.prototype=n),this instanceof f?void 0:new f}(r.prototype),i}}());n.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],n;if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(n=0;n<t.length;n++)try{return new window.ActiveXObject(t[n])}catch(i){}};n.canUseNewCanvasBlendModes=function(){var t,n;return"undefined"==typeof document?!1:(t=document.createElement("canvas"),t.width=1,t.height=1,n=t.getContext("2d"),n.fillStyle="#000",n.fillRect(0,0,1,1),n.globalCompositeOperation="multiply",n.fillStyle="#fff",n.fillRect(0,0,1,1),0===n.getImageData(0,0,1,1).data[0])};n.getNextPowerOfTwo=function(n){if(n>0&&0==(n&n-1))return n;for(var t=1;n>t;)t<<=1;return t};n.isPowerOfTwo=function(n,t){return n>0&&0==(n&n-1)&&t>0&&0==(t&t-1)};n.EventTarget={call:function(t){t&&(t=t.prototype||t,n.EventTarget.mixin(t))},mixin:function(t){t.listeners=function(n){return this._listeners=this._listeners||{},this._listeners[n]?this._listeners[n].slice():[]};t.emit=t.dispatchEvent=function(t,i){if(this._listeners=this._listeners||{},"object"==typeof t&&(i=t,t=t.type),i&&i.__isEventObject===!0||(i=new n.Event(this,t,i)),this._listeners&&this._listeners[t]){for(var u=this._listeners[t].slice(0),e=u.length,f=u[0],r=0;e>r;f=u[++r])if(f.call(this,i),i.stoppedImmediate)return this;if(i.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,t,i),this};t.on=t.addEventListener=function(n,t){return this._listeners=this._listeners||{},(this._listeners[n]=this._listeners[n]||[]).push(t),this};t.once=function(n,t){function i(){t.apply(r.off(n,i),arguments)}this._listeners=this._listeners||{};var r=this;return i._originalHandler=t,this.on(n,i)};t.off=t.removeEventListener=function(n,t){if(this._listeners=this._listeners||{},!this._listeners[n])return this;for(var i=this._listeners[n],r=t?i.length:0;r-->0;)(i[r]===t||i[r]._originalHandler===t)&&i.splice(r,1);return 0===i.length&&delete this._listeners[n],this};t.removeAllListeners=function(n){return this._listeners=this._listeners||{},this._listeners[n]?(delete this._listeners[n],this):this}}};n.Event=function(n,t,i){this.__isEventObject=!0;this.stopped=!1;this.stoppedImmediate=!1;this.target=n;this.type=t;this.data=i;this.content=i;this.timeStamp=Date.now()};n.Event.prototype.stopPropagation=function(){this.stopped=!0};n.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0};n.autoDetectRenderer=function(t,i,r){t||(t=800);i||(i=600);var u=function(){try{var n=document.createElement("canvas");return!!window.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl"))}catch(t){return!1}}();return u?new n.WebGLRenderer(t,i,r):new n.CanvasRenderer(t,i,r)};n.autoDetectRecommendedRenderer=function(t,i,r){t||(t=800);i||(i=600);var u=function(){try{var n=document.createElement("canvas");return!!window.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl"))}catch(t){return!1}}(),f=/Android/i.test(navigator.userAgent);return u&&!f?new n.WebGLRenderer(t,i,r):new n.CanvasRenderer(t,i,r)};n.PolyK={};n.PolyK.Triangulate=function(t){var a=!0,e=t.length>>1,u,l,f;if(3>e)return[];for(var o=[],r=[],i=0;e>i;i++)r.push(i);for(i=0,u=e;u>3;){var s=r[(i+0)%u],h=r[(i+1)%u],c=r[(i+2)%u],y=t[2*s],p=t[2*s+1],w=t[2*h],b=t[2*h+1],k=t[2*c],d=t[2*c+1],v=!1;if(n.PolyK._convex(y,p,w,b,k,d,a))for(v=!0,l=0;u>l;l++)if(f=r[l],f!==s&&f!==h&&f!==c&&n.PolyK._PointInTriangle(t[2*f],t[2*f+1],y,p,w,b,k,d)){v=!1;break}if(v)o.push(s,h,c),r.splice((i+1)%u,1),u--,i=0;else if(i++>3*u){if(!a)return null;for(o=[],r=[],i=0;e>i;i++)r.push(i);i=0;u=e;a=!1}}return o.push(r[0],r[1],r[2]),o};n.PolyK._PointInTriangle=function(n,t,i,r,u,f,e,o){var s=e-i,h=o-r,c=u-i,l=f-r,v=n-i,y=t-r,p=s*s+h*h,a=s*c+h*l,w=s*v+h*y,b=c*c+l*l,k=c*v+l*y,d=1/(p*b-a*a),g=(b*w-a*k)*d,nt=(p*k-a*w)*d;return g>=0&&nt>=0&&1>g+nt};n.PolyK._convex=function(n,t,i,r,u,f,e){return(t-r)*(u-i)+(i-n)*(f-r)>=0===e};n.initDefaultShaders=function(){};n.CompileVertexShader=function(t,i){return n._CompileShader(t,i,t.VERTEX_SHADER)};n.CompileFragmentShader=function(t,i){return n._CompileShader(t,i,t.FRAGMENT_SHADER)};n._CompileShader=function(n,t,i){var u=t.join("\n"),r=n.createShader(i);return n.shaderSource(r,u),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS)?r:(window.console.log(n.getShaderInfoLog(r)),null)};n.compileProgram=function(t,i,r){var f=n.CompileFragmentShader(t,r),e=n.CompileVertexShader(t,i),u=t.createProgram();return t.attachShader(u,e),t.attachShader(u,f),t.linkProgram(u),t.getProgramParameter(u,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),u};n.PixiShader=function(t){this._UID=n._UID++;this.gl=t;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.firstRun=!0;this.dirty=!0;this.attributes=[];this.init()};n.PixiShader.prototype.constructor=n.PixiShader;n.PixiShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc||n.PixiShader.defaultVertexSrc,this.fragmentSrc),r;t.useProgram(i);this.uSampler=t.getUniformLocation(i,"uSampler");this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.dimensions=t.getUniformLocation(i,"dimensions");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord");this.colorAttribute=t.getAttribLocation(i,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(r in this.uniforms)this.uniforms[r].uniformLocation=t.getUniformLocation(i,r);this.initUniforms();this.program=i};n.PixiShader.prototype.initUniforms=function(){var t,i,r,n;this.textureCount=1;i=this.gl;for(r in this.uniforms)t=this.uniforms[r],n=t.type,"sampler2D"===n?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===n||"mat3"===n||"mat4"===n?(t.glMatrix=!0,t.glValueLength=1,"mat2"===n?t.glFunc=i.uniformMatrix2fv:"mat3"===n?t.glFunc=i.uniformMatrix3fv:"mat4"===n&&(t.glFunc=i.uniformMatrix4fv)):(t.glFunc=i["uniform"+n],t.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)};n.PixiShader.prototype.initSampler2D=function(n){var t;if(n.value&&n.value.baseTexture&&n.value.baseTexture.hasLoaded){if(t=this.gl,t.activeTexture(t["TEXTURE"+this.textureCount]),t.bindTexture(t.TEXTURE_2D,n.value.baseTexture._glTextures[t.id]),n.textureData){var i=n.textureData,e=i.magFilter?i.magFilter:t.LINEAR,o=i.minFilter?i.minFilter:t.LINEAR,u=i.wrapS?i.wrapS:t.CLAMP_TO_EDGE,f=i.wrapT?i.wrapT:t.CLAMP_TO_EDGE,r=i.luminance?t.LUMINANCE:t.RGBA;if(i.repeat&&(u=t.REPEAT,f=t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!!i.flipY),i.width){var s=i.width?i.width:512,h=i.height?i.height:2,c=i.border?i.border:0;t.texImage2D(t.TEXTURE_2D,0,r,s,h,c,r,t.UNSIGNED_BYTE,null)}else t.texImage2D(t.TEXTURE_2D,0,r,t.RGBA,t.UNSIGNED_BYTE,n.value.baseTexture.source);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,u);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,f)}t.uniform1i(n.uniformLocation,this.textureCount);n._init=!0;this.textureCount++}};n.PixiShader.prototype.syncUniforms=function(){var t,i,r;this.textureCount=1;i=this.gl;for(r in this.uniforms)t=this.uniforms[r],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),t.value.baseTexture._dirty[i.id]?n.instances[i.id].updateTexture(t.value.baseTexture):i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))};n.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};n.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"];n.PixiFastShader=function(t){this._UID=n._UID++;this.gl=t;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};n.PixiFastShader.prototype.constructor=n.PixiFastShader;n.PixiFastShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.uSampler=t.getUniformLocation(i,"uSampler");this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.dimensions=t.getUniformLocation(i,"dimensions");this.uMatrix=t.getUniformLocation(i,"uMatrix");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.aPositionCoord=t.getAttribLocation(i,"aPositionCoord");this.aScale=t.getAttribLocation(i,"aScale");this.aRotation=t.getAttribLocation(i,"aRotation");this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord");this.colorAttribute=t.getAttribLocation(i,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute];this.program=i};n.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};n.StripShader=function(t){this._UID=n._UID++;this.gl=t;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};n.StripShader.prototype.constructor=n.StripShader;n.StripShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.uSampler=t.getUniformLocation(i,"uSampler");this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.colorAttribute=t.getAttribLocation(i,"aColor");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord");this.attributes=[this.aVertexPosition,this.aTextureCoord];this.translationMatrix=t.getUniformLocation(i,"translationMatrix");this.alpha=t.getUniformLocation(i,"alpha");this.program=i};n.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};n.PrimitiveShader=function(t){this._UID=n._UID++;this.gl=t;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};n.PrimitiveShader.prototype.constructor=n.PrimitiveShader;n.PrimitiveShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.tintColor=t.getUniformLocation(i,"tint");this.flipY=t.getUniformLocation(i,"flipY");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.colorAttribute=t.getAttribLocation(i,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=t.getUniformLocation(i,"translationMatrix");this.alpha=t.getUniformLocation(i,"alpha");this.program=i};n.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};n.ComplexPrimitiveShader=function(t){this._UID=n._UID++;this.gl=t;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"];this.init()};n.ComplexPrimitiveShader.prototype.constructor=n.ComplexPrimitiveShader;n.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.tintColor=t.getUniformLocation(i,"tint");this.color=t.getUniformLocation(i,"color");this.flipY=t.getUniformLocation(i,"flipY");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=t.getUniformLocation(i,"translationMatrix");this.alpha=t.getUniformLocation(i,"alpha");this.program=i};n.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};n.WebGLGraphics=function(){};n.WebGLGraphics.renderGraphics=function(t,i){var f,r=i.gl,s=i.projection,h=i.offset,u=i.shaderManager.primitiveShader,o,e;for(t.dirty&&n.WebGLGraphics.updateGraphics(t,r),o=t._webGL[r.id],e=0;e<o.data.length;e++)1===o.data[e].mode?(f=o.data[e],i.stencilManager.pushStencil(t,f,i),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(f.indices.length-4)),i.stencilManager.popStencil(t,f,i)):(f=o.data[e],i.shaderManager.setShader(u),u=i.shaderManager.primitiveShader,r.uniformMatrix3fv(u.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform1f(u.flipY,1),r.uniform2f(u.projectionVector,s.x,-s.y),r.uniform2f(u.offsetVector,-h.x,-h.y),r.uniform3fv(u.tintColor,n.hex2rgb(t.tint)),r.uniform1f(u.alpha,t.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,f.buffer),r.vertexAttribPointer(u.aVertexPosition,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(u.colorAttribute,4,r.FLOAT,!1,24,8),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.indexBuffer),r.drawElements(r.TRIANGLE_STRIP,f.indices.length,r.UNSIGNED_SHORT,0))};n.WebGLGraphics.updateGraphics=function(t,i){var u=t._webGL[i.id],e,o,f,r,s;if(u||(u=t._webGL[i.id]={lastIndex:0,data:[],gl:i}),t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,e=0;e<u.data.length;e++)o=u.data[e],o.reset(),n.WebGLGraphics.graphicsDataPool.push(o);u.data=[];u.lastIndex=0}for(e=u.lastIndex;e<t.graphicsData.length;e++)r=t.graphicsData[e],r.type===n.Graphics.POLY?((r.points=r.shape.points.slice(),r.shape.closed&&(r.points[0]!==r.points[r.points.length-2]||r.points[1]!==r.points[r.points.length-1])&&r.points.push(r.points[0],r.points[1]),r.fill&&r.points.length>=6)&&(r.points.length<12?(f=n.WebGLGraphics.switchMode(u,0),s=n.WebGLGraphics.buildPoly(r,f),s||(f=n.WebGLGraphics.switchMode(u,1),n.WebGLGraphics.buildComplexPoly(r,f))):(f=n.WebGLGraphics.switchMode(u,1),n.WebGLGraphics.buildComplexPoly(r,f))),r.lineWidth>0&&(f=n.WebGLGraphics.switchMode(u,0),n.WebGLGraphics.buildLine(r,f))):(f=n.WebGLGraphics.switchMode(u,0),r.type===n.Graphics.RECT?n.WebGLGraphics.buildRectangle(r,f):r.type===n.Graphics.CIRC||r.type===n.Graphics.ELIP?n.WebGLGraphics.buildCircle(r,f):r.type===n.Graphics.RREC&&n.WebGLGraphics.buildRoundedRectangle(r,f)),u.lastIndex++;for(e=0;e<u.data.length;e++)f=u.data[e],f.dirty&&f.upload()};n.WebGLGraphics.switchMode=function(t,i){var r;return t.data.length?(r=t.data[t.data.length-1],(r.mode!==i||1===i)&&(r=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl),r.mode=i,t.data.push(r))):(r=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl),r.mode=i,t.data.push(r)),r.dirty=!0,r};n.WebGLGraphics.buildRectangle=function(t,i){var s=t.shape,r=s.x,u=s.y,h=s.width,c=s.height,p;if(t.fill){var y=n.hex2rgb(t.fillColor),e=t.fillAlpha,l=y[0]*e,a=y[1]*e,v=y[2]*e,f=i.points,w=i.indices,o=f.length/6;f.push(r,u);f.push(l,a,v,e);f.push(r+h,u);f.push(l,a,v,e);f.push(r,u+c);f.push(l,a,v,e);f.push(r+h,u+c);f.push(l,a,v,e);w.push(o,o,o+1,o+2,o+3,o+3)}t.lineWidth&&(p=t.points,t.points=[r,u,r+h,u,r+h,u+c,r,u+c,r,u],n.WebGLGraphics.buildLine(t,i),t.points=p)};n.WebGLGraphics.buildRoundedRectangle=function(t,i){var l=t.shape,u=l.x,f=l.y,s=l.width,h=l.height,o=l.radius,r=[],b;if(r.push(u,f+o),r=r.concat(n.WebGLGraphics.quadraticBezierCurve(u,f+h-o,u,f+h,u+o,f+h)),r=r.concat(n.WebGLGraphics.quadraticBezierCurve(u+s-o,f+h,u+s,f+h,u+s,f+h-o)),r=r.concat(n.WebGLGraphics.quadraticBezierCurve(u+s,f+o,u+s,f,u+s-o,f)),r=r.concat(n.WebGLGraphics.quadraticBezierCurve(u+o,f,u,f,u,f+o)),t.fill){for(var p=n.hex2rgb(t.fillColor),y=t.fillAlpha,k=p[0]*y,d=p[1]*y,g=p[2]*y,w=i.points,a=i.indices,v=w.length/6,c=n.PolyK.Triangulate(r),e=0,e=0;e<c.length;e+=3)a.push(c[e]+v),a.push(c[e]+v),a.push(c[e+1]+v),a.push(c[e+2]+v),a.push(c[e+2]+v);for(e=0;e<r.length;e++)w.push(r[e],r[++e],k,d,g,y)}t.lineWidth&&(b=t.points,t.points=r,n.WebGLGraphics.buildLine(t,i),t.points=b)};n.WebGLGraphics.quadraticBezierCurve=function(n,t,i,r,u,f){function o(n,t,i){var r=t-n;return n+r*i}for(var h,c,l,a,v,y,p=20,w=[],e=0,s=0;p>=s;s++)e=s/p,h=o(n,i,e),c=o(t,r,e),l=o(i,u,e),a=o(r,f,e),v=o(h,l,e),y=o(c,a,e),w.push(v,y);return w};n.WebGLGraphics.buildCircle=function(t,i){var e,o,u=t.shape,c=u.x,l=u.y,d;t.type===n.Graphics.CIRC?(e=u.radius,o=u.radius):(e=u.width,o=u.height);var a=40,s=2*Math.PI/a,r=0;if(t.fill){var v=n.hex2rgb(t.fillColor),f=t.fillAlpha,w=v[0]*f,b=v[1]*f,k=v[2]*f,y=i.points,p=i.indices,h=y.length/6;for(p.push(h),r=0;a+1>r;r++)y.push(c,l,w,b,k,f),y.push(c+Math.sin(s*r)*e,l+Math.cos(s*r)*o,w,b,k,f),p.push(h++,h++);p.push(h-1)}if(t.lineWidth){for(d=t.points,t.points=[],r=0;a+1>r;r++)t.points.push(c+Math.sin(s*r)*e,l+Math.cos(s*r)*o);n.WebGLGraphics.buildLine(t,i);t.points=d}};n.WebGLGraphics.buildLine=function(t,i){var h=0,r=t.points,it,g,ht,ct;if(0!==r.length){if(t.lineWidth%2)for(h=0;h<r.length;h++)r[h]+=.5;it=new n.Point(r[0],r[1]);g=new n.Point(r[r.length-2],r[r.length-1]);it.x===g.x&&it.y===g.y&&(r=r.slice(),r.pop(),r.pop(),g=new n.Point(r[r.length-2],r[r.length-1]),ht=g.x+.5*(it.x-g.x),ct=g.y+.5*(it.y-g.y),r.unshift(ht,ct),r.push(ht,ct));var rt,ut,p,w,e,o,ot,st,u,f,b,k,nt,tt,lt,at,vt,yt,pt,wt,ft,gt,c,s=i.points,bt=i.indices,et=r.length/2,ni=r.length,kt=s.length/6,d=t.lineWidth/2,dt=n.hex2rgb(t.lineColor),l=t.lineAlpha,a=dt[0]*l,v=dt[1]*l,y=dt[2]*l;for(p=r[0],w=r[1],e=r[2],o=r[3],u=-(w-o),f=p-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=d,f*=d,s.push(p-u,w-f,a,v,y,l),s.push(p+u,w+f,a,v,y,l),h=1;et-1>h;h++)p=r[2*(h-1)],w=r[2*(h-1)+1],e=r[2*h],o=r[2*h+1],ot=r[2*(h+1)],st=r[2*(h+1)+1],u=-(w-o),f=p-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=d,f*=d,b=-(o-st),k=e-ot,c=Math.sqrt(b*b+k*k),b/=c,k/=c,b*=d,k*=d,lt=-f+w-(-f+o),at=-u+e-(-u+p),vt=(-u+p)*(-f+o)-(-u+e)*(-f+w),yt=-k+st-(-k+o),pt=-b+e-(-b+ot),wt=(-b+ot)*(-k+o)-(-b+e)*(-k+st),ft=lt*pt-yt*at,Math.abs(ft)<.1?(ft+=10.1,s.push(e-u,o-f,a,v,y,l),s.push(e+u,o+f,a,v,y,l)):(rt=(at*wt-pt*vt)/ft,ut=(yt*vt-lt*wt)/ft,gt=(rt-e)*(rt-e)+(ut-o)+(ut-o),gt>19600?(nt=u-b,tt=f-k,c=Math.sqrt(nt*nt+tt*tt),nt/=c,tt/=c,nt*=d,tt*=d,s.push(e-nt,o-tt),s.push(a,v,y,l),s.push(e+nt,o+tt),s.push(a,v,y,l),s.push(e-nt,o-tt),s.push(a,v,y,l),ni++):(s.push(rt,ut),s.push(a,v,y,l),s.push(e-(rt-e),o-(ut-o)),s.push(a,v,y,l)));for(p=r[2*(et-2)],w=r[2*(et-2)+1],e=r[2*(et-1)],o=r[2*(et-1)+1],u=-(w-o),f=p-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=d,f*=d,s.push(e-u,o-f),s.push(a,v,y,l),s.push(e+u,o+f),s.push(a,v,y,l),bt.push(kt),h=0;ni>h;h++)bt.push(kt++);bt.push(kt-1)}};n.WebGLGraphics.buildComplexPoly=function(t,i){var u=t.points.slice(),l,a;if(!(u.length<6)){l=i.indices;i.points=u;i.alpha=t.fillAlpha;i.color=n.hex2rgb(t.fillColor);for(var f,e,o=1/0,s=-1/0,h=1/0,c=-1/0,r=0;r<u.length;r+=2)f=u[r],e=u[r+1],o=o>f?f:o,s=f>s?f:s,h=h>e?e:h,c=e>c?e:c;for(u.push(o,h,s,h,s,c,o,c),a=u.length/2,r=0;a>r;r++)l.push(r)}};n.WebGLGraphics.buildPoly=function(t,i){var e=t.points,f,r;if(!(e.length<6)){var c=i.points,o=i.indices,l=e.length/2,h=n.hex2rgb(t.fillColor),s=t.fillAlpha,a=h[0]*s,v=h[1]*s,y=h[2]*s,u=n.PolyK.Triangulate(e);if(!u)return!1;for(f=c.length/6,r=0,r=0;r<u.length;r+=3)o.push(u[r]+f),o.push(u[r]+f),o.push(u[r+1]+f),o.push(u[r+2]+f),o.push(u[r+2]+f);for(r=0;l>r;r++)c.push(e[2*r],e[2*r+1],a,v,y,s);return!0}};n.WebGLGraphics.graphicsDataPool=[];n.WebGLGraphicsData=function(n){this.gl=n;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=n.createBuffer();this.indexBuffer=n.createBuffer();this.mode=1;this.alpha=1;this.dirty=!0};n.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[]};n.WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new n.Float32Array(this.points);t.bindBuffer(t.ARRAY_BUFFER,this.buffer);t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW);this.glIndicies=new n.Uint16Array(this.indices);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndicies,t.STATIC_DRAW);this.dirty=!1};n.glContexts=[];n.instances=[];n.WebGLRenderer=function(t,i,r){if(r)for(var u in n.defaultRenderOptions)"undefined"==typeof r[u]&&(r[u]=n.defaultRenderOptions[u]);else r=n.defaultRenderOptions;n.defaultRenderer||(n.sayHello("webGL"),n.defaultRenderer=this);this.type=n.WEBGL_RENDERER;this.resolution=r.resolution;this.transparent=r.transparent;this.autoResize=r.autoResize||!1;this.preserveDrawingBuffer=r.preserveDrawingBuffer;this.clearBeforeRender=r.clearBeforeRender;this.width=t||800;this.height=i||600;this.view=r.view||document.createElement("canvas");this.contextLostBound=this.handleContextLost.bind(this);this.contextRestoredBound=this.handleContextRestored.bind(this);this.view.addEventListener("webglcontextlost",this.contextLostBound,!1);this.view.addEventListener("webglcontextrestored",this.contextRestoredBound,!1);this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer};this.projection=new n.Point;this.offset=new n.Point(0,0);this.shaderManager=new n.WebGLShaderManager;this.spriteBatch=new n.WebGLSpriteBatch;this.maskManager=new n.WebGLMaskManager;this.filterManager=new n.WebGLFilterManager;this.stencilManager=new n.WebGLStencilManager;this.blendModeManager=new n.WebGLBlendModeManager;this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.initContext();this.mapBlendModes()};n.WebGLRenderer.prototype.constructor=n.WebGLRenderer;n.WebGLRenderer.prototype.initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=t.id=n.WebGLRenderer.glContextId++;n.glContexts[this.glContextId]=t;n.instances[this.glContextId]=this;t.disable(t.DEPTH_TEST);t.disable(t.CULL_FACE);t.enable(t.BLEND);this.shaderManager.setContext(t);this.spriteBatch.setContext(t);this.maskManager.setContext(t);this.filterManager.setContext(t);this.blendModeManager.setContext(t);this.stencilManager.setContext(t);this.renderSession.gl=this.gl;this.resize(this.width,this.height)};n.WebGLRenderer.prototype.render=function(n){if(!this.contextLost){this.__stage!==n&&(n.interactive&&n.interactionManager.removeEvents(),this.__stage=n);n.updateTransform();var t=this.gl;n._interactive?n._interactiveEventsAdded||(n._interactiveEventsAdded=!0,n.interactionManager.setTarget(this)):n._interactiveEventsAdded&&(n._interactiveEventsAdded=!1,n.interactionManager.setTarget(this));t.viewport(0,0,this.width,this.height);t.bindFramebuffer(t.FRAMEBUFFER,null);this.clearBeforeRender&&(this.transparent?t.clearColor(0,0,0,0):t.clearColor(n.backgroundColorSplit[0],n.backgroundColorSplit[1],n.backgroundColorSplit[2],1),t.clear(t.COLOR_BUFFER_BIT));this.renderDisplayObject(n,this.projection)}};n.WebGLRenderer.prototype.renderDisplayObject=function(t,i,r){this.renderSession.blendModeManager.setBlendMode(n.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.flipY=r?-1:1;this.renderSession.projection=i;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,r);t._renderWebGL(this.renderSession);this.spriteBatch.end()};n.WebGLRenderer.prototype.resize=function(n,t){this.width=n*this.resolution;this.height=t*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px");this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};n.WebGLRenderer.prototype.updateTexture=function(t){if(t.hasLoaded){var i=this.gl;return t._glTextures[i.id]||(t._glTextures[i.id]=i.createTexture()),i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===n.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t.mipmap&&n.isPowerOfTwo(t.width,t.height)?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST),i.generateMipmap(i.TEXTURE_2D)):i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),t._dirty[i.id]=!1,t._glTextures[i.id]}};n.WebGLRenderer.prototype.handleContextLost=function(n){n.preventDefault();this.contextLost=!0};n.WebGLRenderer.prototype.handleContextRestored=function(){var t,i;this.initContext();for(t in n.TextureCache)i=n.TextureCache[t].baseTexture,i._glTextures=[];this.contextLost=!1};n.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLostBound);this.view.removeEventListener("webglcontextrestored",this.contextRestoredBound);n.glContexts[this.glContextId]=null;this.projection=null;this.offset=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.spriteBatch=null;this.maskManager=null;this.filterManager=null;this.gl=null;this.renderSession=null};n.WebGLRenderer.prototype.mapBlendModes=function(){var t=this.gl;n.blendModesWebGL||(n.blendModesWebGL=[],n.blendModesWebGL[n.blendModes.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],n.blendModesWebGL[n.blendModes.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SCREEN]=[t.SRC_ALPHA,t.ONE],n.blendModesWebGL[n.blendModes.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA])};n.WebGLRenderer.glContextId=0;n.WebGLBlendModeManager=function(){this.currentBlendMode=99999};n.WebGLBlendModeManager.prototype.constructor=n.WebGLBlendModeManager;n.WebGLBlendModeManager.prototype.setContext=function(n){this.gl=n};n.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var i=n.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(i[0],i[1]),!0};n.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};n.WebGLMaskManager=function(){};n.WebGLMaskManager.prototype.constructor=n.WebGLMaskManager;n.WebGLMaskManager.prototype.setContext=function(n){this.gl=n};n.WebGLMaskManager.prototype.pushMask=function(t,i){var r=i.gl;t.dirty&&n.WebGLGraphics.updateGraphics(t,r);t._webGL[r.id].data.length&&i.stencilManager.pushStencil(t,t._webGL[r.id].data[0],i)};n.WebGLMaskManager.prototype.popMask=function(n,t){var i=this.gl;t.stencilManager.popStencil(n,n._webGL[i.id].data[0],t)};n.WebGLMaskManager.prototype.destroy=function(){this.gl=null};n.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=!0;this.count=0};n.WebGLStencilManager.prototype.setContext=function(n){this.gl=n};n.WebGLStencilManager.prototype.pushStencil=function(n,t,i){var r=this.gl,u;this.bindGraphics(n,t,i);0===this.stencilStack.length&&(r.enable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0);this.stencilStack.push(t);u=this.count;r.colorMask(!1,!1,!1,!1);r.stencilFunc(r.ALWAYS,0,255);r.stencilOp(r.KEEP,r.KEEP,r.INVERT);1===t.mode?(r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?(r.stencilFunc(r.EQUAL,255-u,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,u,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(t.indices.length-4)),this.reverse?r.stencilFunc(r.EQUAL,255-(u+1),255):r.stencilFunc(r.EQUAL,u+1,255),this.reverse=!this.reverse):(this.reverse?(r.stencilFunc(r.EQUAL,u,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,255-u,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,u+1,255):r.stencilFunc(r.EQUAL,255-(u+1),255));r.colorMask(!0,!0,!0,!0);r.stencilOp(r.KEEP,r.KEEP,r.KEEP);this.count++};n.WebGLStencilManager.prototype.bindGraphics=function(t,i,r){this._currentGraphics=t;var f,u=this.gl,e=r.projection,o=r.offset;1===i.mode?(f=r.shaderManager.complexPrimitiveShader,r.shaderManager.setShader(f),u.uniform1f(f.flipY,r.flipY),u.uniformMatrix3fv(f.translationMatrix,!1,t.worldTransform.toArray(!0)),u.uniform2f(f.projectionVector,e.x,-e.y),u.uniform2f(f.offsetVector,-o.x,-o.y),u.uniform3fv(f.tintColor,n.hex2rgb(t.tint)),u.uniform3fv(f.color,i.color),u.uniform1f(f.alpha,t.worldAlpha*i.alpha),u.bindBuffer(u.ARRAY_BUFFER,i.buffer),u.vertexAttribPointer(f.aVertexPosition,2,u.FLOAT,!1,8,0),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i.indexBuffer)):(f=r.shaderManager.primitiveShader,r.shaderManager.setShader(f),u.uniformMatrix3fv(f.translationMatrix,!1,t.worldTransform.toArray(!0)),u.uniform1f(f.flipY,r.flipY),u.uniform2f(f.projectionVector,e.x,-e.y),u.uniform2f(f.offsetVector,-o.x,-o.y),u.uniform3fv(f.tintColor,n.hex2rgb(t.tint)),u.uniform1f(f.alpha,t.worldAlpha),u.bindBuffer(u.ARRAY_BUFFER,i.buffer),u.vertexAttribPointer(f.aVertexPosition,2,u.FLOAT,!1,24,0),u.vertexAttribPointer(f.colorAttribute,4,u.FLOAT,!1,24,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i.indexBuffer))};n.WebGLStencilManager.prototype.popStencil=function(n,t,i){var r=this.gl,u;(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)?r.disable(r.STENCIL_TEST):(u=this.count,this.bindGraphics(n,t,i),r.colorMask(!1,!1,!1,!1),1===t.mode?(this.reverse=!this.reverse,this.reverse?(r.stencilFunc(r.EQUAL,255-(u+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,u+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(t.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,u,255):r.stencilFunc(r.EQUAL,255-u,255)):(this.reverse?(r.stencilFunc(r.EQUAL,u+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(u+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,u,255):r.stencilFunc(r.EQUAL,255-u,255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP))};n.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null;this.gl=null};n.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var n=0;n<this.maxAttibs;n++)this.attribState[n]=!1;this.stack=[]};n.WebGLShaderManager.prototype.constructor=n.WebGLShaderManager;n.WebGLShaderManager.prototype.setContext=function(t){this.gl=t;this.primitiveShader=new n.PrimitiveShader(t);this.complexPrimitiveShader=new n.ComplexPrimitiveShader(t);this.defaultShader=new n.PixiShader(t);this.fastShader=new n.PixiFastShader(t);this.stripShader=new n.StripShader(t);this.setShader(this.defaultShader)};n.WebGLShaderManager.prototype.setAttribs=function(n){for(var r,i,t=0;t<this.tempAttribState.length;t++)this.tempAttribState[t]=!1;for(t=0;t<n.length;t++)r=n[t],this.tempAttribState[r]=!0;for(i=this.gl,t=0;t<this.attribState.length;t++)this.attribState[t]!==this.tempAttribState[t]&&(this.attribState[t]=this.tempAttribState[t],this.tempAttribState[t]?i.enableVertexAttribArray(t):i.disableVertexAttribArray(t))};n.WebGLShaderManager.prototype.setShader=function(n){return this._currentId===n._UID?!1:(this._currentId=n._UID,this.currentShader=n,this.gl.useProgram(n.program),this.setAttribs(n.attributes),!0)};n.WebGLShaderManager.prototype.destroy=function(){this.attribState=null;this.tempAttribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};n.WebGLSpriteBatch=function(){var u,r,t,i;for(this.vertSize=5,this.size=2e3,u=16*this.size*this.vertSize,r=6*this.size,this.vertices=new n.ArrayBuffer(u),this.positions=new n.Float32Array(this.vertices),this.colors=new n.Uint32Array(this.vertices),this.indices=new n.Uint16Array(r),this.lastIndexCount=0,t=0,i=0;r>t;t+=6,i+=4)this.indices[t+0]=i+0,this.indices[t+1]=i+1,this.indices[t+2]=i+2,this.indices[t+3]=i+0,this.indices[t+4]=i+2,this.indices[t+5]=i+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=!0;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new n.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])};n.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t;this.vertexBuffer=t.createBuffer();this.indexBuffer=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW);this.currentBlendMode=99999;var i=new n.PixiShader(t);i.fragmentSrc=this.defaultShader.fragmentSrc;i.uniforms={};i.init();this.defaultShader.shaders[t.id]=i};n.WebGLSpriteBatch.prototype.begin=function(n){this.renderSession=n;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};n.WebGLSpriteBatch.prototype.end=function(){this.flush()};n.WebGLSpriteBatch.prototype.render=function(n){var r=n.texture,e,o,u,s,f,b,k,w,nt;if(this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=r.baseTexture),e=r._uvs,e){b=n.anchor.x;k=n.anchor.y;r.trim?(w=r.trim,u=w.x-b*w.width,o=u+r.crop.width,f=w.y-k*w.height,s=f+r.crop.height):(o=r.frame.width*(1-b),u=r.frame.width*-b,s=r.frame.height*(1-k),f=r.frame.height*-k);var t=4*this.currentBatchSize*this.vertSize,d=r.baseTexture.resolution,p=n.worldTransform,h=p.a/d,c=p.b/d,l=p.c/d,a=p.d/d,v=p.tx,y=p.ty,g=this.colors,i=this.positions;this.renderSession.roundPixels?(i[t]=h*u+l*f+v|0,i[t+1]=a*f+c*u+y|0,i[t+5]=h*o+l*f+v|0,i[t+6]=a*f+c*o+y|0,i[t+10]=h*o+l*s+v|0,i[t+11]=a*s+c*o+y|0,i[t+15]=h*u+l*s+v|0,i[t+16]=a*s+c*u+y|0):(i[t]=h*u+l*f+v,i[t+1]=a*f+c*u+y,i[t+5]=h*o+l*f+v,i[t+6]=a*f+c*o+y,i[t+10]=h*o+l*s+v,i[t+11]=a*s+c*o+y,i[t+15]=h*u+l*s+v,i[t+16]=a*s+c*u+y);i[t+2]=e.x0;i[t+3]=e.y0;i[t+7]=e.x1;i[t+8]=e.y1;i[t+12]=e.x2;i[t+13]=e.y2;i[t+17]=e.x3;i[t+18]=e.y3;nt=n.tint;g[t+4]=g[t+9]=g[t+14]=g[t+19]=(nt>>16)+(65280&nt)+((255&nt)<<16)+(255*n.worldAlpha<<24);this.sprites[this.currentBatchSize++]=n}};n.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var f=t.tilingTexture,r;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=f.baseTexture);t._uvs||(t._uvs=new n.TextureUvs);r=t._uvs;t.tilePosition.x%=f.baseTexture.width*t.tileScaleOffset.x;t.tilePosition.y%=f.baseTexture.height*t.tileScaleOffset.y;var o=t.tilePosition.x/(f.baseTexture.width*t.tileScaleOffset.x),s=t.tilePosition.y/(f.baseTexture.height*t.tileScaleOffset.y),it=t.width/f.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),rt=t.height/f.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);r.x0=0-o;r.y0=0-s;r.x1=1*it-o;r.y1=0-s;r.x2=1*it-o;r.y2=1*rt-s;r.x3=0-o;r.y3=1*rt-s;var tt=t.tint,h=(tt>>16)+(65280&tt)+((255&tt)<<16)+(255*t.alpha<<24),u=this.positions,c=this.colors,ut=t.width,ft=t.height,et=t.anchor.x,ot=t.anchor.y,l=ut*(1-et),a=ut*-et,v=ft*(1-ot),y=ft*-ot,i=4*this.currentBatchSize*this.vertSize,p=f.baseTexture.resolution,e=t.worldTransform,w=e.a/p,b=e.b/p,k=e.c/p,d=e.d/p,g=e.tx,nt=e.ty;u[i++]=w*a+k*y+g;u[i++]=d*y+b*a+nt;u[i++]=r.x0;u[i++]=r.y0;c[i++]=h;u[i++]=w*l+k*y+g;u[i++]=d*y+b*l+nt;u[i++]=r.x1;u[i++]=r.y1;c[i++]=h;u[i++]=w*l+k*v+g;u[i++]=d*v+b*l+nt;u[i++]=r.x2;u[i++]=r.y2;c[i++]=h;u[i++]=w*a+k*v+g;u[i++]=d*v+b*a+nt;u[i++]=r.x3;u[i++]=r.y3;c[i++]=h;this.sprites[this.currentBatchSize++]=t};n.WebGLSpriteBatch.prototype.flush=function(){var i,t,u,k,w,b;if(0!==this.currentBatchSize){t=this.gl;this.dirty&&(this.dirty=!1,t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),i=this.defaultShader.shaders[t.id],u=4*this.vertSize,t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,u,0),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,u,8),t.vertexAttribPointer(i.colorAttribute,4,t.UNSIGNED_BYTE,!0,u,16));this.currentBatchSize>.5*this.size?t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices):(k=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),t.bufferSubData(t.ARRAY_BUFFER,0,k));for(var h,c,l,f,e=0,a=0,o=null,v=this.renderSession.blendModeManager.currentBlendMode,r=null,y=!1,p=!1,s=0,d=this.currentBatchSize;d>s;s++)(f=this.sprites[s],h=f.texture.baseTexture,c=f.blendMode,l=f.shader||this.defaultShader,y=v!==c,p=r!==l,(o!==h||y||p)&&(this.renderBatch(o,e,a),a=s,e=0,o=h,y&&(v=c,this.renderSession.blendModeManager.setBlendMode(v)),p))&&(r=l,i=r.shaders[t.id],i||(i=new n.PixiShader(t),i.fragmentSrc=r.fragmentSrc,i.uniforms=r.uniforms,i.init(),r.shaders[t.id]=i),this.renderSession.shaderManager.setShader(i),i.dirty&&i.syncUniforms(),w=this.renderSession.projection,t.uniform2f(i.projectionVector,w.x,w.y),b=this.renderSession.offset,t.uniform2f(i.offsetVector,b.x,b.y)),e++;this.renderBatch(o,e,a);this.currentBatchSize=0}};n.WebGLSpriteBatch.prototype.renderBatch=function(n,t,i){if(0!==t){var r=this.gl;n._dirty[r.id]?this.renderSession.renderer.updateTexture(n):r.bindTexture(r.TEXTURE_2D,n._glTextures[r.id]);r.drawElements(r.TRIANGLES,6*t,r.UNSIGNED_SHORT,12*i);this.renderSession.drawCount++}};n.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=!0};n.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0};n.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null;this.indices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.currentBaseTexture=null;this.gl=null};n.WebGLFastSpriteBatch=function(t){var f,u,i,r;for(this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize,f=4*this.size*this.vertSize,u=6*this.maxSize,this.vertices=new n.Float32Array(f),this.indices=new n.Uint16Array(u),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0,i=0,r=0;u>i;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.renderSession=null;this.shader=null;this.matrix=null;this.setContext(t)};n.WebGLFastSpriteBatch.prototype.constructor=n.WebGLFastSpriteBatch;n.WebGLFastSpriteBatch.prototype.setContext=function(n){this.gl=n;this.vertexBuffer=n.createBuffer();this.indexBuffer=n.createBuffer();n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.indices,n.STATIC_DRAW);n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);n.bufferData(n.ARRAY_BUFFER,this.vertices,n.DYNAMIC_DRAW)};n.WebGLFastSpriteBatch.prototype.begin=function(n,t){this.renderSession=t;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=n.worldTransform.toArray(!0);this.start()};n.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};n.WebGLFastSpriteBatch.prototype.render=function(n){var r=n.children,t=r[0],i,u;if(t.texture._uvs){for(this.currentBaseTexture=t.texture.baseTexture,t.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(t.blendMode)),i=0,u=r.length;u>i;i++)this.renderSprite(r[i]);this.flush()}};n.WebGLFastSpriteBatch.prototype.renderSprite=function(n){var r,h,c,o,u,s,f,t,i,e;n.visible&&(n.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=n.texture.baseTexture,n.texture._uvs))&&(i=this.vertices,(r=n.texture._uvs,h=n.texture.frame.width,c=n.texture.frame.height,n.texture.trim)?(e=n.texture.trim,u=e.x-n.anchor.x*e.width,o=u+n.texture.crop.width,f=e.y-n.anchor.y*e.height,s=f+n.texture.crop.height):(o=n.texture.frame.width*(1-n.anchor.x),u=n.texture.frame.width*-n.anchor.x,s=n.texture.frame.height*(1-n.anchor.y),f=n.texture.frame.height*-n.anchor.y),t=4*this.currentBatchSize*this.vertSize,i[t++]=u,i[t++]=f,i[t++]=n.position.x,i[t++]=n.position.y,i[t++]=n.scale.x,i[t++]=n.scale.y,i[t++]=n.rotation,i[t++]=r.x0,i[t++]=r.y1,i[t++]=n.alpha,i[t++]=o,i[t++]=f,i[t++]=n.position.x,i[t++]=n.position.y,i[t++]=n.scale.x,i[t++]=n.scale.y,i[t++]=n.rotation,i[t++]=r.x1,i[t++]=r.y1,i[t++]=n.alpha,i[t++]=o,i[t++]=s,i[t++]=n.position.x,i[t++]=n.position.y,i[t++]=n.scale.x,i[t++]=n.scale.y,i[t++]=n.rotation,i[t++]=r.x2,i[t++]=r.y2,i[t++]=n.alpha,i[t++]=u,i[t++]=s,i[t++]=n.position.x,i[t++]=n.position.y,i[t++]=n.scale.x,i[t++]=n.scale.y,i[t++]=n.rotation,i[t++]=r.x3,i[t++]=r.y3,i[t++]=n.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush())};n.WebGLFastSpriteBatch.prototype.flush=function(){var n,t;0!==this.currentBatchSize&&(n=this.gl,(this.currentBaseTexture._glTextures[n.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,n),n.bindTexture(n.TEXTURE_2D,this.currentBaseTexture._glTextures[n.id]),this.currentBatchSize>.5*this.size)?n.bufferSubData(n.ARRAY_BUFFER,0,this.vertices):(t=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize),n.bufferSubData(n.ARRAY_BUFFER,0,t)),n.drawElements(n.TRIANGLES,6*this.currentBatchSize,n.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++)};n.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};n.WebGLFastSpriteBatch.prototype.start=function(){var n=this.gl,i,t;n.activeTexture(n.TEXTURE0);n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer);i=this.renderSession.projection;n.uniform2f(this.shader.projectionVector,i.x,i.y);n.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);t=4*this.vertSize;n.vertexAttribPointer(this.shader.aVertexPosition,2,n.FLOAT,!1,t,0);n.vertexAttribPointer(this.shader.aPositionCoord,2,n.FLOAT,!1,t,8);n.vertexAttribPointer(this.shader.aScale,2,n.FLOAT,!1,t,16);n.vertexAttribPointer(this.shader.aRotation,1,n.FLOAT,!1,t,24);n.vertexAttribPointer(this.shader.aTextureCoord,2,n.FLOAT,!1,t,28);n.vertexAttribPointer(this.shader.colorAttribute,1,n.FLOAT,!1,t,36)};n.WebGLFilterManager=function(){this.filterStack=[];this.offsetX=0;this.offsetY=0};n.WebGLFilterManager.prototype.constructor=n.WebGLFilterManager;n.WebGLFilterManager.prototype.setContext=function(n){this.gl=n;this.texturePool=[];this.initShaderBuffers()};n.WebGLFilterManager.prototype.begin=function(n,t){this.renderSession=n;this.defaultShader=n.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=2*i.x;this.height=2*-i.y;this.buffer=t};n.WebGLFilterManager.prototype.pushFilter=function(t){var r=this.gl,e=this.renderSession.projection,o=this.renderSession.offset,s,u,i,f;t._filterArea=t.target.filterArea||t.target.getBounds();this.filterStack.push(t);s=t.filterPasses[0];this.offsetX+=t._filterArea.x;this.offsetY+=t._filterArea.y;u=this.texturePool.pop();u?u.resize(this.width,this.height):u=new n.FilterTexture(this.gl,this.width,this.height);r.bindTexture(r.TEXTURE_2D,u.texture);i=t._filterArea;f=s.padding;i.x-=f;i.y-=f;i.width+=2*f;i.height+=2*f;i.x<0&&(i.x=0);i.width>this.width&&(i.width=this.width);i.y<0&&(i.y=0);i.height>this.height&&(i.height=this.height);r.bindFramebuffer(r.FRAMEBUFFER,u.frameBuffer);r.viewport(0,0,i.width,i.height);e.x=i.width/2;e.y=-i.height/2;o.x=-i.x;o.y=-i.y;r.colorMask(!0,!0,!0,!0);r.clearColor(0,0,0,0);r.clear(r.COLOR_BUFFER_BIT);t._glFilterTexture=u};n.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,r=this.filterStack.pop(),i=r._filterArea,s=r._glFilterTexture,p=this.renderSession.projection,w=this.renderSession.offset,f,u,h,b,k,d,y,e,o;if(r.filterPasses.length>1){for(t.viewport(0,0,i.width,i.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),f=s,u=this.texturePool.pop(),u||(u=new n.FilterTexture(this.gl,this.width,this.height)),u.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND),h=0;h<r.filterPasses.length-1;h++)b=r.filterPasses[h],t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,f.texture),this.applyFilterPass(b,i,i.width,i.height),k=f,f=u,u=k;t.enable(t.BLEND);s=f;this.texturePool.push(u)}d=r.filterPasses[r.filterPasses.length-1];this.offsetX-=i.x;this.offsetY-=i.y;var c=this.width,l=this.height,a=0,v=0,g=this.buffer;0===this.filterStack.length?t.colorMask(!0,!0,!0,!0):(y=this.filterStack[this.filterStack.length-1],i=y._filterArea,c=i.width,l=i.height,a=i.x,v=i.y,g=y._glFilterTexture.frameBuffer);p.x=c/2;p.y=-l/2;w.x=a;w.y=v;i=r._filterArea;e=i.x-a;o=i.y-v;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=e;this.vertexArray[1]=o+i.height;this.vertexArray[2]=e+i.width;this.vertexArray[3]=o+i.height;this.vertexArray[4]=e;this.vertexArray[5]=o;this.vertexArray[6]=e+i.width;this.vertexArray[7]=o;t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray);t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=i.width/this.width;this.uvArray[5]=i.height/this.height;this.uvArray[6]=i.width/this.width;this.uvArray[7]=i.height/this.height;t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);t.viewport(0,0,c,l);t.bindFramebuffer(t.FRAMEBUFFER,g);t.activeTexture(t.TEXTURE0);t.bindTexture(t.TEXTURE_2D,s.texture);this.applyFilterPass(d,i,c,l);this.texturePool.push(s);r._glFilterTexture=null};n.WebGLFilterManager.prototype.applyFilterPass=function(t,i,r,u){var f=this.gl,e=t.shaders[f.id];e||(e=new n.PixiShader(f),e.fragmentSrc=t.fragmentSrc,e.uniforms=t.uniforms,e.init(),t.shaders[f.id]=e);this.renderSession.shaderManager.setShader(e);f.uniform2f(e.projectionVector,r/2,-u/2);f.uniform2f(e.offsetVector,0,0);t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]);e.syncUniforms();f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.vertexAttribPointer(e.aVertexPosition,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);f.vertexAttribPointer(e.aTextureCoord,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);f.vertexAttribPointer(e.colorAttribute,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);this.renderSession.drawCount++};n.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer();this.uvBuffer=t.createBuffer();this.colorBuffer=t.createBuffer();this.indexBuffer=t.createBuffer();this.vertexArray=new n.Float32Array([0,0,1,0,0,1,1,1]);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW);this.uvArray=new n.Float32Array([0,0,1,0,0,1,1,1]);t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer);t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW);this.colorArray=new n.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)};n.WebGLFilterManager.prototype.destroy=function(){var n=this.gl,t;for(this.filterStack=null,this.offsetX=0,this.offsetY=0,t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null;n.deleteBuffer(this.vertexBuffer);n.deleteBuffer(this.uvBuffer);n.deleteBuffer(this.colorBuffer);n.deleteBuffer(this.indexBuffer)};n.FilterTexture=function(t,i,r,u){this.gl=t;this.frameBuffer=t.createFramebuffer();this.texture=t.createTexture();u=u||n.scaleModes.DEFAULT;t.bindTexture(t.TEXTURE_2D,this.texture);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,u===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,u===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0);this.renderBuffer=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer);this.resize(i,r)};n.FilterTexture.prototype.constructor=n.FilterTexture;n.FilterTexture.prototype.clear=function(){var n=this.gl;n.clearColor(0,0,0,0);n.clear(n.COLOR_BUFFER_BIT)};n.FilterTexture.prototype.resize=function(n,t){if(this.width!==n||this.height!==t){this.width=n;this.height=t;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,n,t,0,i.RGBA,i.UNSIGNED_BYTE,null);i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer);i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,t)}};n.FilterTexture.prototype.destroy=function(){var n=this.gl;n.deleteFramebuffer(this.frameBuffer);n.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null};n.CanvasBuffer=function(n,t){this.width=n;this.height=t;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=n;this.canvas.height=t};n.CanvasBuffer.prototype.constructor=n.CanvasBuffer;n.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height)};n.CanvasBuffer.prototype.resize=function(n,t){this.width=this.canvas.width=n;this.height=this.canvas.height=t};n.CanvasMaskManager=function(){};n.CanvasMaskManager.prototype.constructor=n.CanvasMaskManager;n.CanvasMaskManager.prototype.pushMask=function(t,i){var f=i.context;f.save();var e=t.alpha,r=t.worldTransform,u=i.resolution;f.setTransform(r.a*u,r.b*u,r.c*u,r.d*u,r.tx*u,r.ty*u);n.CanvasGraphics.renderGraphicsMask(t,f);f.clip();t.worldAlpha=e};n.CanvasMaskManager.prototype.popMask=function(n){n.context.restore()};n.CanvasTinter=function(){};n.CanvasTinter.getTintedTexture=function(t,i){var r=t.texture,u,f,e;return(i=n.CanvasTinter.roundColor(i),u="#"+("00000"+(0|i).toString(16)).substr(-6),r.tintCache=r.tintCache||{},r.tintCache[u])?r.tintCache[u]:(f=n.CanvasTinter.canvas||document.createElement("canvas"),(n.CanvasTinter.tintMethod(r,i,f),n.CanvasTinter.convertTintToImage)?(e=new Image,e.src=f.toDataURL(),r.tintCache[u]=e):(r.tintCache[u]=f,n.CanvasTinter.canvas=null),f)};n.CanvasTinter.tintWithMultiply=function(n,t,i){var u=i.getContext("2d"),r=n.crop;i.width=r.width;i.height=r.height;u.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6);u.fillRect(0,0,r.width,r.height);u.globalCompositeOperation="multiply";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);u.globalCompositeOperation="destination-atop";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)};n.CanvasTinter.tintWithOverlay=function(n,t,i){var u=i.getContext("2d"),r=n.crop;i.width=r.width;i.height=r.height;u.globalCompositeOperation="copy";u.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6);u.fillRect(0,0,r.width,r.height);u.globalCompositeOperation="destination-atop";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)};n.CanvasTinter.tintWithPerPixel=function(t,i,r){var e=r.getContext("2d"),u=t.crop;r.width=u.width;r.height=u.height;e.globalCompositeOperation="copy";e.drawImage(t.baseTexture.source,u.x,u.y,u.width,u.height,0,0,u.width,u.height);for(var s=n.hex2rgb(i),c=s[0],l=s[1],a=s[2],h=e.getImageData(0,0,u.width,u.height),o=h.data,f=0;f<o.length;f+=4)o[f+0]*=c,o[f+1]*=l,o[f+2]*=a;e.putImageData(h,0,0)};n.CanvasTinter.roundColor=function(t){var r=n.CanvasTinter.cacheStepsPerColorChannel,i=n.hex2rgb(t);return i[0]=Math.min(255,i[0]/r*r),i[1]=Math.min(255,i[1]/r*r),i[2]=Math.min(255,i[2]/r*r),n.rgb2hex(i)};n.CanvasTinter.cacheStepsPerColorChannel=8;n.CanvasTinter.convertTintToImage=!1;n.CanvasTinter.canUseMultiply=n.canUseNewCanvasBlendModes();n.CanvasTinter.tintMethod=n.CanvasTinter.canUseMultiply?n.CanvasTinter.tintWithMultiply:n.CanvasTinter.tintWithPerPixel;n.CanvasRenderer=function(t,i,r){if(r)for(var u in n.defaultRenderOptions)"undefined"==typeof r[u]&&(r[u]=n.defaultRenderOptions[u]);else r=n.defaultRenderOptions;n.defaultRenderer||(n.sayHello("Canvas"),n.defaultRenderer=this);this.type=n.CANVAS_RENDERER;this.resolution=r.resolution;this.clearBeforeRender=r.clearBeforeRender;this.transparent=r.transparent;this.autoResize=r.autoResize||!1;this.width=t||800;this.height=i||600;this.width*=this.resolution;this.height*=this.resolution;this.view=r.view||document.createElement("canvas");this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=!0;this.view.width=this.width*this.resolution;this.view.height=this.height*this.resolution;this.count=0;this.maskManager=new n.CanvasMaskManager;this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1};this.mapBlendModes();this.resize(t,i);"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")};n.CanvasRenderer.prototype.constructor=n.CanvasRenderer;n.CanvasRenderer.prototype.render=function(t){t.updateTransform();this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=n.blendModes.NORMAL;this.context.globalCompositeOperation=n.blendModesCanvas[n.blendModes.NORMAL];navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear());this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)));this.renderDisplayObject(t);t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)))};n.CanvasRenderer.prototype.destroy=function(n){"undefined"==typeof n&&(n=!0);n&&this.view.parent&&this.view.parent.removeChild(this.view);this.view=null;this.context=null;this.maskManager=null;this.renderSession=null};n.CanvasRenderer.prototype.resize=function(n,t){this.width=n*this.resolution;this.height=t*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")};n.CanvasRenderer.prototype.renderDisplayObject=function(n,t){this.renderSession.context=t||this.context;this.renderSession.resolution=this.resolution;n._renderCanvas(this.renderSession)};n.CanvasRenderer.prototype.mapBlendModes=function(){n.blendModesCanvas||(n.blendModesCanvas=[],n.canUseNewCanvasBlendModes()?(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="multiply",n.blendModesCanvas[n.blendModes.SCREEN]="screen",n.blendModesCanvas[n.blendModes.OVERLAY]="overlay",n.blendModesCanvas[n.blendModes.DARKEN]="darken",n.blendModesCanvas[n.blendModes.LIGHTEN]="lighten",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="color-dodge",n.blendModesCanvas[n.blendModes.COLOR_BURN]="color-burn",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="hard-light",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="soft-light",n.blendModesCanvas[n.blendModes.DIFFERENCE]="difference",n.blendModesCanvas[n.blendModes.EXCLUSION]="exclusion",n.blendModesCanvas[n.blendModes.HUE]="hue",n.blendModesCanvas[n.blendModes.SATURATION]="saturation",n.blendModesCanvas[n.blendModes.COLOR]="color",n.blendModesCanvas[n.blendModes.LUMINOSITY]="luminosity"):(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="source-over",n.blendModesCanvas[n.blendModes.SCREEN]="source-over",n.blendModesCanvas[n.blendModes.OVERLAY]="source-over",n.blendModesCanvas[n.blendModes.DARKEN]="source-over",n.blendModesCanvas[n.blendModes.LIGHTEN]="source-over",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="source-over",n.blendModesCanvas[n.blendModes.COLOR_BURN]="source-over",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.DIFFERENCE]="source-over",n.blendModesCanvas[n.blendModes.EXCLUSION]="source-over",n.blendModesCanvas[n.blendModes.HUE]="source-over",n.blendModesCanvas[n.blendModes.SATURATION]="source-over",n.blendModesCanvas[n.blendModes.COLOR]="source-over",n.blendModesCanvas[n.blendModes.LUMINOSITY]="source-over"))};n.CanvasGraphics=function(){};n.CanvasGraphics.renderGraphics=function(t,i){var h=t.worldAlpha,d,f,b;for(t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),d=0;d<t.graphicsData.length;d++){var r=t.graphicsData[d],u=r.shape,p=r._fillTint,w=r._lineTint;if(i.lineWidth=r.lineWidth,r.type===n.Graphics.POLY){for(i.beginPath(),f=u.points,i.moveTo(f[0],f[1]),b=1;b<f.length/2;b++)i.lineTo(f[2*b],f[2*b+1]);u.closed&&i.lineTo(f[0],f[1]);f[0]===f[f.length-2]&&f[1]===f[f.length-1]&&i.closePath();r.fill&&(i.globalAlpha=r.fillAlpha*h,i.fillStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.fill());r.lineWidth&&(i.globalAlpha=r.lineAlpha*h,i.strokeStyle="#"+("00000"+(0|w).toString(16)).substr(-6),i.stroke())}else if(r.type===n.Graphics.RECT)(r.fillColor||0===r.fillColor)&&(i.globalAlpha=r.fillAlpha*h,i.fillStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.fillRect(u.x,u.y,u.width,u.height)),r.lineWidth&&(i.globalAlpha=r.lineAlpha*h,i.strokeStyle="#"+("00000"+(0|w).toString(16)).substr(-6),i.strokeRect(u.x,u.y,u.width,u.height));else if(r.type===n.Graphics.CIRC)i.beginPath(),i.arc(u.x,u.y,u.radius,0,2*Math.PI),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*h,i.fillStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*h,i.strokeStyle="#"+("00000"+(0|w).toString(16)).substr(-6),i.stroke());else if(r.type===n.Graphics.ELIP){var g=2*u.width,nt=2*u.height,v=u.x-g/2,k=u.y-nt/2;i.beginPath();var ft=.5522848,tt=g/2*ft,it=nt/2*ft,rt=v+g,ut=k+nt,y=v+g/2,c=k+nt/2;i.moveTo(v,c);i.bezierCurveTo(v,c-it,y-tt,k,y,k);i.bezierCurveTo(y+tt,k,rt,c-it,rt,c);i.bezierCurveTo(rt,c+it,y+tt,ut,y,ut);i.bezierCurveTo(y-tt,ut,v,c+it,v,c);i.closePath();r.fill&&(i.globalAlpha=r.fillAlpha*h,i.fillStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.fill());r.lineWidth&&(i.globalAlpha=r.lineAlpha*h,i.strokeStyle="#"+("00000"+(0|w).toString(16)).substr(-6),i.stroke())}else if(r.type===n.Graphics.RREC){var e=u.x,o=u.y,l=u.width,a=u.height,s=u.radius,et=Math.min(l,a)/2|0;s=s>et?et:s;i.beginPath();i.moveTo(e,o+s);i.lineTo(e,o+a-s);i.quadraticCurveTo(e,o+a,e+s,o+a);i.lineTo(e+l-s,o+a);i.quadraticCurveTo(e+l,o+a,e+l,o+a-s);i.lineTo(e+l,o+s);i.quadraticCurveTo(e+l,o,e+l-s,o);i.lineTo(e+s,o);i.quadraticCurveTo(e,o,e,o+s);i.closePath();(r.fillColor||0===r.fillColor)&&(i.globalAlpha=r.fillAlpha*h,i.fillStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.fill());r.lineWidth&&(i.globalAlpha=r.lineAlpha*h,i.strokeStyle="#"+("00000"+(0|w).toString(16)).substr(-6),i.stroke())}}};n.CanvasGraphics.renderGraphicsMask=function(t,i){var tt=t.graphicsData.length,b,s,r,e,y;if(0!==tt)for(tt>1&&(tt=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object")),b=0;1>b;b++)if(s=t.graphicsData[b],r=s.shape,s.type===n.Graphics.POLY){for(i.beginPath(),e=r.points,i.moveTo(e[0],e[1]),y=1;y<e.length/2;y++)i.lineTo(e[2*y],e[2*y+1]);e[0]===e[e.length-2]&&e[1]===e[e.length-1]&&i.closePath()}else if(s.type===n.Graphics.RECT)i.beginPath(),i.rect(r.x,r.y,r.width,r.height),i.closePath();else if(s.type===n.Graphics.CIRC)i.beginPath(),i.arc(r.x,r.y,r.radius,0,2*Math.PI),i.closePath();else if(s.type===n.Graphics.ELIP){var k=2*r.width,d=2*r.height,a=r.x-k/2,p=r.y-d/2;i.beginPath();var ut=.5522848,g=k/2*ut,nt=d/2*ut,it=a+k,rt=p+d,v=a+k/2,h=p+d/2;i.moveTo(a,h);i.bezierCurveTo(a,h-nt,v-g,p,v,p);i.bezierCurveTo(v+g,p,it,h-nt,it,h);i.bezierCurveTo(it,h+nt,v+g,rt,v,rt);i.bezierCurveTo(v-g,rt,a,h+nt,a,h);i.closePath()}else if(s.type===n.Graphics.RREC){var w=r.points,u=w[0],f=w[1],c=w[2],l=w[3],o=w[4],ft=Math.min(c,l)/2|0;o=o>ft?ft:o;i.beginPath();i.moveTo(u,f+o);i.lineTo(u,f+l-o);i.quadraticCurveTo(u,f+l,u+o,f+l);i.lineTo(u+c-o,f+l);i.quadraticCurveTo(u+c,f+l,u+c,f+l-o);i.lineTo(u+c,f+o);i.quadraticCurveTo(u+c,f,u+c-o,f);i.lineTo(u+o,f);i.quadraticCurveTo(u,f,u,f+o);i.closePath()}};n.CanvasGraphics.updateGraphicsTint=function(n){if(16777215!==n.tint)for(var f=(n.tint>>16&255)/255,e=(n.tint>>8&255)/255,o=(255&n.tint)/255,i=0;i<n.graphicsData.length;i++){var t=n.graphicsData[i],r=0|t.fillColor,u=0|t.lineColor;t._fillTint=((r>>16&255)/255*f*255<<16)+((r>>8&255)/255*e*255<<8)+(255&r)/255*o*255;t._lineTint=((u>>16&255)/255*f*255<<16)+((u>>8&255)/255*e*255<<8)+(255&u)/255*o*255}};n.Graphics=function(){n.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineWidth=0;this.lineColor=0;this.graphicsData=[];this.tint=16777215;this.blendMode=n.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=!1;this.boundsPadding=0;this._localBounds=new n.Rectangle(0,0,1,1);this.dirty=!0;this.webGLDirty=!1;this.cachedSpriteDirty=!1};n.Graphics.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Graphics.prototype.constructor=n.Graphics;Object.defineProperty(n.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(n){this._cacheAsBitmap=n;this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}});n.Graphics.prototype.lineStyle=function(t,i,r){if(this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=arguments.length<3?1:r,this.currentPath){if(this.currentPath.shape.points.length)return this.drawShape(new n.Polygon(this.currentPath.shape.points.slice(-2))),this;this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha}return this};n.Graphics.prototype.moveTo=function(t,i){return this.drawShape(new n.Polygon([t,i])),this};n.Graphics.prototype.lineTo=function(n,t){return this.currentPath.shape.points.push(n,t),this.dirty=!0,this};n.Graphics.prototype.quadraticCurveTo=function(n,t,i,r){var e,o,s,u;this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);s=20;u=this.currentPath.shape.points;0===u.length&&this.moveTo(0,0);for(var c=u[u.length-2],l=u[u.length-1],f=0,h=1;s>=h;h++)f=h/s,e=c+(n-c)*f,o=l+(t-l)*f,u.push(e+(n+(i-n)*f-e)*f,o+(t+(r-t)*f-o)*f);return this.dirty=!0,this};n.Graphics.prototype.bezierCurveTo=function(n,t,i,r,u,f){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var o,h,l,c,a,y=20,s=this.currentPath.shape.points,p=s[s.length-2],w=s[s.length-1],e=0,v=1;y>=v;v++)e=v/y,o=1-e,h=o*o,l=h*o,c=e*e,a=c*e,s.push(l*p+3*h*e*n+3*o*c*i+a*u,l*w+3*h*e*t+3*o*c*r+a*f);return this.dirty=!0,this};n.Graphics.prototype.arcTo=function(n,t,i,r,u){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(n,t):this.moveTo(n,t);var f=this.currentPath.shape.points,g=f[f.length-2],nt=f[f.length-1],e=nt-t,o=g-n,s=r-t,h=i-n,a=Math.abs(e*h-o*s);if(1e-8>a||0===u)(f[f.length-2]!==n||f[f.length-1]!==t)&&f.push(n,t);else{var p=e*e+o*o,w=s*s+h*h,b=e*s+o*h,c=u*Math.sqrt(p)/a,l=u*Math.sqrt(w)/a,k=c*b/p,d=l*b/w,v=c*h+l*o,y=c*s+l*e,tt=o*(l+k),it=e*(l+k),rt=h*(c+d),ut=s*(c+d),ft=Math.atan2(it-y,tt-v),et=Math.atan2(ut-y,rt-v);this.arc(v+n,y+t,u,ft,et,o*s>h*e)}return this.dirty=!0,this};n.Graphics.prototype.arc=function(n,t,i,r,u,f){var e,o=n+Math.cos(r)*i,s=t+Math.sin(r)*i,h,a;if((this.currentPath?(e=this.currentPath.shape.points,0===e.length?e.push(o,s):(e[e.length-2]!==o||e[e.length-1]!==s)&&e.push(o,s)):(this.moveTo(o,s),e=this.currentPath.shape.points),r===u)||(!f&&r>=u?u+=2*Math.PI:f&&u>=r&&(r+=2*Math.PI),h=f?-1*(r-u):u-r,a=Math.abs(h)/(2*Math.PI)*40,0===h))return this;for(var c=h/(2*a),d=2*c,y=Math.cos(c),p=Math.sin(c),v=a-1,g=v%1/v,l=0;v>=l;l++){var nt=l+g*l,w=c+r+d*nt,b=Math.cos(w),k=-Math.sin(w);e.push((y*b+p*k)*i+n,(y*-k+p*b)*i+t)}return this.dirty=!0,this};n.Graphics.prototype.beginFill=function(n,t){return this.filling=!0,this.fillColor=n||0,this.fillAlpha=void 0===t?1:t,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this};n.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this};n.Graphics.prototype.drawRect=function(t,i,r,u){return this.drawShape(new n.Rectangle(t,i,r,u)),this};n.Graphics.prototype.drawRoundedRect=function(t,i,r,u,f){return this.drawShape(new n.RoundedRectangle(t,i,r,u,f)),this};n.Graphics.prototype.drawCircle=function(t,i,r){return this.drawShape(new n.Circle(t,i,r)),this};n.Graphics.prototype.drawEllipse=function(t,i,r,u){return this.drawShape(new n.Ellipse(t,i,r,u)),this};n.Graphics.prototype.drawPolygon=function(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.drawShape(new n.Polygon(t)),this};n.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this};n.Graphics.prototype.generateTexture=function(t,i){t=t||1;var r=this.getBounds(),u=new n.CanvasBuffer(r.width*t,r.height*t),f=n.Texture.fromCanvas(u.canvas,i);return f.baseTexture.resolution=t,u.context.scale(t,t),u.context.translate(-r.x,-r.y),n.CanvasGraphics.renderGraphics(this,u.context),f};n.Graphics.prototype._renderWebGL=function(t){var r,i,u;if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t),void 0;if((t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode)&&(t.spriteBatch.currentBlendMode=this.blendMode,r=n.blendModesWebGL[t.spriteBatch.currentBlendMode],t.spriteBatch.gl.blendFunc(r[0],r[1])),this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),n.WebGLGraphics.renderGraphics(this,t),this.children.length){for(t.spriteBatch.start(),i=0,u=this.children.length;u>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter();this._mask&&t.maskManager.popMask(this.mask,t);t.drawCount++;t.spriteBatch.start()}};n.Graphics.prototype._renderCanvas=function(t){var u,i,r,f,e;if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,n.Sprite.prototype._renderCanvas.call(this._cachedSprite,t),void 0;for(u=t.context,i=this.worldTransform,this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,u.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),r=t.resolution,u.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r,i.ty*r),n.CanvasGraphics.renderGraphics(this,u),f=0,e=this.children.length;e>f;f++)this.children[f]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}};n.Graphics.prototype.getBounds=function(t){if(this.isMask)return n.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var e=this._localBounds,s=e.x,h=e.width+e.x,c=e.y,l=e.height+e.y,o=t||this.worldTransform,a=o.a,v=o.b,y=o.c,p=o.d,w=o.tx,b=o.ty,rt=a*h+y*l+w,ut=p*l+v*h+b,k=a*s+y*l+w,d=p*l+v*s+b,g=a*s+y*c+w,nt=p*c+v*s+b,tt=a*h+y*c+w,it=p*c+v*h+b,u=rt,f=ut,i=rt,r=ut;return i=i>k?k:i,i=i>g?g:i,i=i>tt?tt:i,r=r>d?d:r,r=r>nt?nt:r,r=r>it?it:r,u=k>u?k:u,u=g>u?g:u,u=tt>u?tt:u,f=d>f?d:f,f=nt>f?nt:f,f=it>f?it:f,this._bounds.x=i,this._bounds.width=u-i,this._bounds.y=r,this._bounds.height=f-r,this._bounds};n.Graphics.prototype.updateLocalBounds=function(){var u=1/0,e=-1/0,f=1/0,o=-1/0,s,v,t,i,h,c,y,l,a;if(this.graphicsData.length)for(y=0;y<this.graphicsData.length;y++){var w=this.graphicsData[y],p=w.type,r=w.lineWidth;if(s=w.shape,p===n.Graphics.RECT||p===n.Graphics.RREC)t=s.x-r/2,i=s.y-r/2,h=s.width+r,c=s.height+r,u=u>t?t:u,e=t+h>e?t+h:e,f=f>i?i:f,o=i+c>o?i+c:o;else if(p===n.Graphics.CIRC)t=s.x,i=s.y,h=s.radius+r/2,c=s.radius+r/2,u=u>t-h?t-h:u,e=t+h>e?t+h:e,f=f>i-c?i-c:f,o=i+c>o?i+c:o;else if(p===n.Graphics.ELIP)t=s.x,i=s.y,h=s.width+r/2,c=s.height+r/2,u=u>t-h?t-h:u,e=t+h>e?t+h:e,f=f>i-c?i-c:f,o=i+c>o?i+c:o;else for(v=s.points,l=0;l<v.length;l+=2)t=v[l],i=v[l+1],u=u>t-r?t-r:u,e=t+r>e?t+r:e,f=f>i-r?i-r:f,o=i+r>o?i+r:o}else u=0,e=0,f=0,o=0;a=this.boundsPadding;this._localBounds.x=u-a;this._localBounds.width=e-u+2*a;this._localBounds.y=f-a;this._localBounds.height=o-f+2*a};n.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds(),i,r;this._cachedSprite?this._cachedSprite.buffer.resize(t.width,t.height):(i=new n.CanvasBuffer(t.width,t.height),r=n.Texture.fromCanvas(i.canvas),this._cachedSprite=new n.Sprite(r),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform);this._cachedSprite.anchor.x=-(t.x/t.width);this._cachedSprite.anchor.y=-(t.y/t.height);this._cachedSprite.buffer.context.translate(-t.x,-t.y);this.worldAlpha=1;n.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};n.Graphics.prototype.updateCachedSpriteTexture=function(){var i=this._cachedSprite,n=i.texture,t=i.buffer.canvas;n.baseTexture.width=t.width;n.baseTexture.height=t.height;n.crop.width=n.frame.width=t.width;n.crop.height=n.frame.height=t.height;i._width=t.width;i._height=t.height;n.baseTexture.dirty()};n.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0);this._cachedSprite=null};n.Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop();this.currentPath=null;var i=new n.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(i),i.type===n.Graphics.POLY&&(i.shape.closed=this.filling,this.currentPath=i),this.dirty=!0,i};n.GraphicsData=function(n,t,i,r,u,f,e){this.lineWidth=n;this.lineColor=t;this.lineAlpha=i;this._lineTint=t;this.fillColor=r;this.fillAlpha=u;this._fillTint=r;this.fill=f;this.shape=e;this.type=e.type};n.Graphics.POLY=0;n.Graphics.RECT=1;n.Graphics.CIRC=2;n.Graphics.ELIP=3;n.Graphics.RREC=4;n.Polygon.prototype.type=n.Graphics.POLY;n.Rectangle.prototype.type=n.Graphics.RECT;n.Circle.prototype.type=n.Graphics.CIRC;n.Ellipse.prototype.type=n.Graphics.ELIP;n.RoundedRectangle.prototype.type=n.Graphics.RREC;n.Strip=function(t){n.DisplayObjectContainer.call(this);this.texture=t;this.uvs=new n.Float32Array([0,1,1,1,1,0,0,1]);this.vertices=new n.Float32Array([0,0,100,0,100,100,0,100]);this.colors=new n.Float32Array([1,1,1,1]);this.indices=new n.Uint16Array([0,1,2,3]);this.dirty=!0;this.blendMode=n.blendModes.NORMAL;this.canvasPadding=0;this.drawMode=n.Strip.DrawModes.TRIANGLE_STRIP};n.Strip.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Strip.prototype.constructor=n.Strip;n.Strip.prototype._renderWebGL=function(n){!this.visible||this.alpha<=0||(n.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(n),n.shaderManager.setShader(n.shaderManager.stripShader),this._renderStrip(n),n.spriteBatch.start())};n.Strip.prototype._initWebGL=function(n){var t=n.gl;this._vertexBuffer=t.createBuffer();this._indexBuffer=t.createBuffer();this._uvBuffer=t.createBuffer();this._colorBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer);t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer);t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)};n.Strip.prototype._renderStrip=function(t){var i=t.gl,u=t.projection,f=t.offset,r=t.shaderManager.stripShader,e=this.drawMode===n.Strip.DrawModes.TRIANGLE_STRIP?i.TRIANGLE_STRIP:i.TRIANGLES;t.blendModeManager.setBlendMode(this.blendMode);i.uniformMatrix3fv(r.translationMatrix,!1,this.worldTransform.toArray(!0));i.uniform2f(r.projectionVector,u.x,-u.y);i.uniform2f(r.offsetVector,-f.x,-f.y);i.uniform1f(r.alpha,this.worldAlpha);this.dirty?(this.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,this._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,this.vertices,i.STATIC_DRAW),i.vertexAttribPointer(r.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this._uvBuffer),i.bufferData(i.ARRAY_BUFFER,this.uvs,i.STATIC_DRAW),i.vertexAttribPointer(r.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),this.texture.baseTexture._dirty[i.id]?t.renderer.updateTexture(this.texture.baseTexture):i.bindTexture(i.TEXTURE_2D,this.texture.baseTexture._glTextures[i.id]),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,this._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices),i.vertexAttribPointer(r.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this._uvBuffer),i.vertexAttribPointer(r.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),this.texture.baseTexture._dirty[i.id]?t.renderer.updateTexture(this.texture.baseTexture):i.bindTexture(i.TEXTURE_2D,this.texture.baseTexture._glTextures[i.id]),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indexBuffer));i.drawElements(e,this.indices.length,i.UNSIGNED_SHORT,0)};n.Strip.prototype._renderCanvas=function(t){var r=t.context,i=this.worldTransform;t.roundPixels?r.setTransform(i.a,i.b,i.c,i.d,0|i.tx,0|i.ty):r.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);this.drawMode===n.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(r):this._renderCanvasTriangles(r)};n.Strip.prototype._renderCanvasTriangleStrip=function(n){var r=this.vertices,u=this.uvs,f=r.length/2,t,i;for(this.count++,t=0;f-2>t;t++)i=2*t,this._renderCanvasDrawTriangle(n,r,u,i,i+2,i+4)};n.Strip.prototype._renderCanvasTriangles=function(n){var r=this.vertices,u=this.uvs,i=this.indices,f=i.length,t;for(this.count++,t=0;f>t;t+=3){var e=2*i[t],o=2*i[t+1],s=2*i[t+2];this._renderCanvasDrawTriangle(n,r,u,e,o,s)}};n.Strip.prototype._renderCanvasDrawTriangle=function(n,t,i,r,u,f){var ot=this.texture.baseTexture.source,rt=this.texture.width,ut=this.texture.height,h=t[r],c=t[u],l=t[f],a=t[r+1],v=t[u+1],y=t[f+1],p=i[r]*rt,w=i[u]*rt,b=i[f]*rt,k=i[r+1]*ut,d=i[u+1]*ut,g=i[f+1]*ut;if(this.canvasPadding>0){var ft=this.canvasPadding/this.worldTransform.a,et=this.canvasPadding/this.worldTransform.d,nt=(h+c+l)/3,tt=(a+v+y)/3,o=h-nt,s=a-tt,e=Math.sqrt(o*o+s*s);h=nt+o/e*(e+ft);a=tt+s/e*(e+et);o=c-nt;s=v-tt;e=Math.sqrt(o*o+s*s);c=nt+o/e*(e+ft);v=tt+s/e*(e+et);o=l-nt;s=y-tt;e=Math.sqrt(o*o+s*s);l=nt+o/e*(e+ft);y=tt+s/e*(e+et)}n.save();n.beginPath();n.moveTo(h,a);n.lineTo(c,v);n.lineTo(l,y);n.closePath();n.clip();var it=p*d+k*b+w*g-d*b-k*w-p*g,st=h*d+k*l+c*g-d*l-k*c-h*g,ht=p*c+h*b+w*l-c*b-h*w-p*l,ct=p*d*l+k*c*b+h*w*g-h*d*b-k*w*l-p*c*g,lt=a*d+k*y+v*g-d*y-k*v-a*g,at=p*v+a*b+w*y-v*b-a*w-p*y,vt=p*d*y+k*v*b+a*w*g-a*d*b-k*w*y-p*v*g;n.transform(st/it,lt/it,ht/it,at/it,ct/it,vt/it);n.drawImage(ot,0,0);n.restore()};n.Strip.prototype.renderStripFlat=function(n){var t=this.context,i=n.vertices,f=i.length/2,u;for(this.count++,t.beginPath(),u=1;f-2>u;u++){var r=2*u,e=i[r],o=i[r+2],s=i[r+4],h=i[r+1],c=i[r+3],l=i[r+5];t.moveTo(e,h);t.lineTo(o,c);t.lineTo(s,l)}t.fillStyle="#FF0000";t.fill();t.closePath()};n.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0};n.Strip.prototype.getBounds=function(t){for(var i,r=t||this.worldTransform,y=r.a,p=r.b,w=r.c,b=r.d,k=r.tx,d=r.ty,o=-1/0,f=-1/0,u=1/0,e=1/0,l=this.vertices,s=0,g=l.length;g>s;s+=2){var a=l[s],v=l[s+1],h=y*a+w*v+k,c=b*v+p*a+d;u=u>h?h:u;e=e>c?c:e;o=h>o?h:o;f=c>f?c:f}return u===-1/0||1/0===f?n.EmptyRectangle:(i=this._bounds,i.x=u,i.width=o-u,i.y=e,i.height=f-e,this._currentBounds=i,i)};n.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1};n.Rope=function(t,i){n.Strip.call(this,t);this.points=i;this.vertices=new n.Float32Array(4*i.length);this.uvs=new n.Float32Array(4*i.length);this.colors=new n.Float32Array(2*i.length);this.indices=new n.Uint16Array(2*i.length);this.refresh()};n.Rope.prototype=Object.create(n.Strip.prototype);n.Rope.prototype.constructor=n.Rope;n.Rope.prototype.refresh=function(){var u=this.points,s,n,r,o,i;if(!(u.length<1)){var t=this.uvs,h=u[0],f=this.indices,e=this.colors;for(this.count-=.2,t[0]=0,t[1]=0,t[2]=0,t[3]=1,e[0]=1,e[1]=1,f[0]=0,f[1]=1,o=u.length,i=1;o>i;i++)s=u[i],n=4*i,r=i/(o-1),i%2?(t[n]=r,t[n+1]=0,t[n+2]=r,t[n+3]=1):(t[n]=r,t[n+1]=0,t[n+2]=r,t[n+3]=1),n=2*i,e[n]=1,e[n+1]=1,n=2*i,f[n]=n,f[n+1]=n+1,h=s}};n.Rope.prototype.updateTransform=function(){var u=this.points,s,e,t;if(!(u.length<1)){e=u[0];t={x:0,y:0};this.count-=.2;for(var i,f,h,c,l,o=this.vertices,a=u.length,r=0;a>r;r++)i=u[r],f=4*r,s=r<u.length-1?u[r+1]:i,t.y=-(s.x-e.x),t.x=s.y-e.y,h=10*(1-r/(a-1)),h>1&&(h=1),c=Math.sqrt(t.x*t.x+t.y*t.y),l=this.texture.height/2,t.x/=c,t.y/=c,t.x*=l,t.y*=l,o[f]=i.x+t.x,o[f+1]=i.y+t.y,o[f+2]=i.x-t.x,o[f+3]=i.y-t.y,e=i;n.DisplayObjectContainer.prototype.updateTransform.call(this)}};n.Rope.prototype.setTexture=function(n){this.texture=n};n.TilingSprite=function(t,i,r){n.Sprite.call(this,t);this._width=i||100;this._height=r||100;this.tileScale=new n.Point(1,1);this.tileScaleOffset=new n.Point(1,1);this.tilePosition=new n.Point(0,0);this.renderable=!0;this.tint=16777215;this.blendMode=n.blendModes.NORMAL};n.TilingSprite.prototype=Object.create(n.Sprite.prototype);n.TilingSprite.prototype.constructor=n.TilingSprite;Object.defineProperty(n.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(n){this._width=n}});Object.defineProperty(n.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(n){this._height=n}});n.TilingSprite.prototype.setTexture=function(n){this.texture!==n&&(this.texture=n,this.refreshTexture=!0,this.cachedTint=16777215)};n.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var i,r;for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(n.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),i=0,r=this.children.length;r>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop();this._filters&&t.filterManager.popFilter();this._mask&&t.maskManager.popMask(this._mask,t);t.spriteBatch.start()}};n.TilingSprite.prototype._renderCanvas=function(t){var i,o,s,u,f,r,e;if(this.visible!==!1&&0!==this.alpha){if(i=t.context,this._mask&&t.maskManager.pushMask(this._mask,i),i.globalAlpha=this.worldAlpha,u=this.worldTransform,f=t.resolution,i.setTransform(u.a*f,u.b*f,u.c*f,u.d*f,u.tx*f,u.ty*f),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=i.createPattern(this.tilingTexture.baseTexture.source,"repeat")}for(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),r=this.tilePosition,e=this.tileScale,r.x%=this.tilingTexture.baseTexture.width,r.y%=this.tilingTexture.baseTexture.height,i.scale(e.x,e.y),i.translate(r.x+this.anchor.x*-this._width,r.y+this.anchor.y*-this._height),i.fillStyle=this.__tilePattern,i.fillRect(-r.x,-r.y,this._width/e.x,this._height/e.y),i.scale(1/e.x,1/e.y),i.translate(-r.x+this.anchor.x*this._width,-r.y+this.anchor.y*this._height),this._mask&&t.maskManager.popMask(t.context),o=0,s=this.children.length;s>o;o++)this.children[o]._renderCanvas(t)}};n.TilingSprite.prototype.getBounds=function(){var rt=this._width,ut=this._height,e=rt*(1-this.anchor.x),o=rt*-this.anchor.x,s=ut*(1-this.anchor.y),h=ut*-this.anchor.y,f=this.worldTransform,c=f.a,l=f.b,a=f.c,v=f.d,y=f.tx,p=f.ty,w=c*o+a*h+y,b=v*h+l*o+p,k=c*e+a*h+y,d=v*h+l*e+p,g=c*e+a*s+y,nt=v*s+l*e+p,tt=c*o+a*s+y,it=v*s+l*o+p,i=-1/0,r=-1/0,n=1/0,t=1/0,u;return n=n>w?w:n,n=n>k?k:n,n=n>g?g:n,n=n>tt?tt:n,t=t>b?b:t,t=t>d?d:t,t=t>nt?nt:t,t=t>it?it:t,i=w>i?w:i,i=k>i?k:i,i=g>i?g:i,i=tt>i?tt:i,r=b>r?b:r,r=d>r?d:r,r=nt>r?nt:r,r=it>r?it:r,u=this._bounds,u.x=n,u.width=i-n,u.y=t,u.height=r-t,this._currentBounds=u,u};n.TilingSprite.prototype.onTextureUpdate=function(){};n.TilingSprite.prototype.generateTilingTexture=function(t){var e;if(this.texture.baseTexture.hasLoaded){var u,f,i=this.originalTexture||this.texture,r=i.frame,s=r.width!==i.baseTexture.width||r.height!==i.baseTexture.height,o=!1;(t?(u=n.getNextPowerOfTwo(r.width),f=n.getNextPowerOfTwo(r.height),(r.width!==u||r.height!==f||i.baseTexture.width!==u||i.baseTexture.height||f)&&(o=!0)):s&&(u=r.width,f=r.height,o=!0),o)?(this.tilingTexture&&this.tilingTexture.isTiling?(e=this.tilingTexture.canvasBuffer,e.resize(u,f),this.tilingTexture.baseTexture.width=u,this.tilingTexture.baseTexture.height=f,this.tilingTexture.needsUpdate=!0):(e=new n.CanvasBuffer(u,f),this.tilingTexture=n.Texture.fromCanvas(e.canvas),this.tilingTexture.canvasBuffer=e,this.tilingTexture.isTiling=!0),e.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,0,0,u,f),this.tileScaleOffset.x=r.width/u,this.tileScaleOffset.y=r.height/f):(this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i);this.refreshTexture=!1;this.originalTexture=this.texture;this.texture=this.tilingTexture;this.tilingTexture.baseTexture._powerOf2=!0}};t={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};t.BoneData=function(n,t){this.name=n;this.parent=t};t.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1};t.SlotData=function(n,t){this.name=n;this.boneData=t};t.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:!1};t.IkConstraintData=function(n){this.name=n;this.bones=[]};t.IkConstraintData.prototype={target:null,bendDirection:1,mix:1};t.Bone=function(n,t,i){this.data=n;this.skeleton=t;this.parent=i;this.setToSetupPose()};t.Bone.yDown=!1;t.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var n=this.parent,u,f;n?(this.worldX=this.x*n.m00+this.y*n.m01+n.worldX,this.worldY=this.x*n.m10+this.y*n.m11+n.worldY,this.data.inheritScale?(this.worldScaleX=n.worldScaleX*this.scaleX,this.worldScaleY=n.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?n.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=n.worldFlipX!=this.flipX,this.worldFlipY=n.worldFlipY!=this.flipY):(u=this.skeleton.flipX,f=this.skeleton.flipY,this.worldX=u?-this.x:this.x,this.worldY=f!=t.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=u!=this.flipX,this.worldFlipY=f!=this.flipY);var e=this.worldRotation*t.degRad,i=Math.cos(e),r=Math.sin(e);this.worldFlipX?(this.m00=-i*this.worldScaleX,this.m01=r*this.worldScaleY):(this.m00=i*this.worldScaleX,this.m01=-r*this.worldScaleY);this.worldFlipY!=t.Bone.yDown?(this.m10=-r*this.worldScaleX,this.m11=-i*this.worldScaleY):(this.m10=r*this.worldScaleX,this.m11=i*this.worldScaleY)},setToSetupPose:function(){var n=this.data;this.x=n.x;this.y=n.y;this.rotation=n.rotation;this.rotationIK=this.rotation;this.scaleX=n.scaleX;this.scaleY=n.scaleY;this.flipX=n.flipX;this.flipY=n.flipY},worldToLocal:function(n){var f=n[0]-this.worldX,e=n[1]-this.worldY,r=this.m00,o=this.m10,s=this.m01,u=this.m11,i;this.worldFlipX!=(this.worldFlipY!=t.Bone.yDown)&&(r=-r,u=-u);i=1/(r*u-s*o);n[0]=f*r*i-e*s*i;n[1]=e*u*i-f*o*i},localToWorld:function(n){var t=n[0],i=n[1];n[0]=t*this.m00+i*this.m01+this.worldX;n[1]=t*this.m10+i*this.m11+this.worldY}};t.Slot=function(n,t){this.data=n;this.bone=t;this.setToSetupPose()};t.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(n){this.attachment=n;this._attachmentTime=this.bone.skeleton.time;this.attachmentVertices.length=0},setAttachmentTime:function(n){this._attachmentTime=this.bone.skeleton.time-n},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var n=this.data;this.r=n.r;this.g=n.g;this.b=n.b;this.a=n.a;for(var i=this.bone.skeleton.data.slots,t=0,r=i.length;r>t;t++)if(i[t]==n){this.setAttachment(n.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(t,n.attachmentName):null);break}}};t.IkConstraint=function(n,t){this.data=n;this.mix=n.mix;this.bendDirection=n.bendDirection;this.bones=[];for(var i=0,r=n.bones.length;r>i;i++)this.bones.push(t.findBone(n.bones[i].name));this.target=t.findBone(n.target.name)};t.IkConstraint.prototype={apply:function(){var n=this.target,i=this.bones;switch(i.length){case 1:t.IkConstraint.apply1(i[0],n.worldX,n.worldY,this.mix);break;case 2:t.IkConstraint.apply2(i[0],i[1],n.worldX,n.worldY,this.bendDirection,this.mix)}}};t.IkConstraint.apply1=function(n,i,r,u){var e=n.data.inheritRotation&&n.parent?n.parent.worldRotation:0,f=n.rotation,o=Math.atan2(r-n.worldY,i-n.worldX)*t.radDeg-e;n.rotationIK=f+(o-f)*u};t.IkConstraint.apply2=function(n,i,r,u,f,e){var c=i.rotation,v=n.rotation,p,w,o,l,h;if(!e)return i.rotationIK=c,n.rotationIK=v,void 0;o=t.temp;l=n.parent;l?(o[0]=r,o[1]=u,l.worldToLocal(o),r=(o[0]-n.x)*l.worldScaleX,u=(o[1]-n.y)*l.worldScaleY):(r-=n.x,u-=n.y);i.parent==n?(p=i.x,w=i.y):(o[0]=i.x,o[1]=i.y,i.parent.localToWorld(o),n.worldToLocal(o),p=o[0],w=o[1]);var b=p*n.worldScaleX,k=w*n.worldScaleY,d=Math.atan2(k,b),y=Math.sqrt(b*b+k*k),a=i.data.length*i.worldScaleX,g=2*y*a;if(.0001>g)return i.rotationIK=c+(Math.atan2(u,r)*t.radDeg-v-c)*e,void 0;h=(r*r+u*u-y*y-a*a)/g;-1>h?h=-1:h>1&&(h=1);var nt=Math.acos(h)*f,tt=y+a*h,it=a*Math.sin(nt),rt=Math.atan2(u*tt-r*it,r*tt+u*it),s=(rt-d)*t.radDeg-v;s>180?s-=360:-180>s&&(s+=360);n.rotationIK=v+s*e;s=(nt+d)*t.radDeg-c;s>180?s-=360:-180>s&&(s+=360);i.rotationIK=c+(s+n.worldRotation-i.parent.worldRotation)*e};t.Skin=function(n){this.name=n;this.attachments={}};t.Skin.prototype={addAttachment:function(n,t,i){this.attachments[n+":"+t]=i},getAttachment:function(n,t){return this.attachments[n+":"+t]},_attachAll:function(n,t){var i,u;for(i in t.attachments){var f=i.indexOf(":"),e=parseInt(i.substring(0,f)),o=i.substring(f+1),r=n.slots[e];r.attachment&&r.attachment.name==o&&(u=this.getAttachment(e,o),u&&r.setAttachment(u))}}};t.Animation=function(n,t,i){this.name=n;this.timelines=t;this.duration=i};t.Animation.prototype={apply:function(n,t,i,r,u){r&&0!=this.duration&&(i%=this.duration,t%=this.duration);for(var e=this.timelines,f=0,o=e.length;o>f;f++)e[f].apply(n,t,i,u,1)},mix:function(n,t,i,r,u,f){r&&0!=this.duration&&(i%=this.duration,t%=this.duration);for(var o=this.timelines,e=0,s=o.length;s>e;e++)o[e].apply(n,t,i,u,f)}};t.Animation.binarySearch=function(n,t,i){var f=0,r=Math.floor(n.length/i)-2,u;if(!r)return i;for(u=r>>>1;;){if(n[(u+1)*i]<=t?f=u+1:r=u,f==r)return(f+1)*i;u=f+r>>>1}};t.Animation.binarySearch1=function(n,t){var u=0,i=n.length-2,r;if(!i)return 1;for(r=i>>>1;;){if(n[r+1]<=t?u=r+1:i=r,u==i)return u+1;r=u+i>>>1}};t.Animation.linearSearch=function(n,t,i){for(var r=0,u=n.length-i;u>=r;r+=i)if(n[r]>t)return r;return-1};t.Curves=function(){this.curves=[]};t.Curves.prototype={setLinear:function(n){this.curves[19*n]=0},setStepped:function(n){this.curves[19*n]=1},setCurve:function(n,t,i,r,u){var e=.1,s=e*e,h=s*e,p=3*e,w=3*s,b=6*s,o=6*h,k=2*-t+r,d=2*-i+u,c=3*(t-r)+1,l=3*(i-u)+1,a=t*p+k*w+c*h,v=i*p+d*w+l*h,g=k*b+c*o,nt=d*b+l*o,rt=c*o,ut=l*o,f=19*n,y=this.curves;y[f++]=2;for(var tt=a,it=v,ft=f+19-1;ft>f;f+=2)y[f]=tt,y[f+1]=it,a+=g,v+=nt,g+=rt,nt+=ut,tt+=a,it+=v},getCurvePercent:function(n,t){var f,e,o;t=0>t?0:t>1?1:t;var r=this.curves,i=19*n,s=r[i];if(0===s)return t;if(1==s)return 0;i++;for(var u=0,h=i,c=i+19-1;c>i;i+=2)if(u=r[i],u>=t)return i==h?(f=0,e=0):(f=r[i-2],e=r[i-1]),e+(r[i+1]-e)*(t-f)/(u-f);return o=r[i-1],o+(1-o)*(t-u)/(1-u)}};t.RotateTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=2*n};t.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(n,t,i){n*=2;this.frames[n]=t;this.frames[n+1]=i},apply:function(n,i,r,u,f){var o=this.frames,s,e;if(!(r<o[0])){if(s=n.bones[this.boneIndex],r>=o[o.length-2]){for(e=s.data.rotation+o[o.length-1]-s.rotation;e>180;)e-=360;for(;-180>e;)e+=360;return s.rotation+=e*f,void 0}var h=t.Animation.binarySearch(o,r,2),l=o[h-1],a=o[h],c=1-(r-a)/(o[h-2]-a);for(c=this.curves.getCurvePercent(h/2-1,c),e=o[h+1]-l;e>180;)e-=360;for(;-180>e;)e+=360;for(e=s.data.rotation+(l+e*c)-s.rotation;e>180;)e-=360;for(;-180>e;)e+=360;s.rotation+=e*f}}};t.TranslateTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=3*n};t.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(n,t,i,r){n*=3;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r},apply:function(n,i,r,u,f){var e=this.frames,o;if(!(r<e[0])){if(o=n.bones[this.boneIndex],r>=e[e.length-3])return o.x+=(o.data.x+e[e.length-2]-o.x)*f,o.y+=(o.data.y+e[e.length-1]-o.y)*f,void 0;var s=t.Animation.binarySearch(e,r,3),c=e[s-2],l=e[s-1],a=e[s],h=1-(r-a)/(e[s+-3]-a);h=this.curves.getCurvePercent(s/3-1,h);o.x+=(o.data.x+c+(e[s+1]-c)*h-o.x)*f;o.y+=(o.data.y+l+(e[s+2]-l)*h-o.y)*f}}};t.ScaleTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=3*n};t.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(n,t,i,r){n*=3;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r},apply:function(n,i,r,u,f){var e=this.frames,o;if(!(r<e[0])){if(o=n.bones[this.boneIndex],r>=e[e.length-3])return o.scaleX+=(o.data.scaleX*e[e.length-2]-o.scaleX)*f,o.scaleY+=(o.data.scaleY*e[e.length-1]-o.scaleY)*f,void 0;var s=t.Animation.binarySearch(e,r,3),c=e[s-2],l=e[s-1],a=e[s],h=1-(r-a)/(e[s+-3]-a);h=this.curves.getCurvePercent(s/3-1,h);o.scaleX+=(o.data.scaleX*(c+(e[s+1]-c)*h)-o.scaleX)*f;o.scaleY+=(o.data.scaleY*(l+(e[s+2]-l)*h)-o.scaleY)*f}}};t.ColorTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=5*n};t.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(n,t,i,r,u,f){n*=5;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r;this.frames[n+3]=u;this.frames[n+4]=f},apply:function(n,i,r,u,f){var e=this.frames,l,a,v,y,c,o;if(!(r<e[0])){if(r>=e[e.length-5])c=e.length-1,l=e[c-3],a=e[c-2],v=e[c-1],y=e[c];else{var s=t.Animation.binarySearch(e,r,5),p=e[s-4],w=e[s-3],b=e[s-2],k=e[s-1],d=e[s],h=1-(r-d)/(e[s-5]-d);h=this.curves.getCurvePercent(s/5-1,h);l=p+(e[s+1]-p)*h;a=w+(e[s+2]-w)*h;v=b+(e[s+3]-b)*h;y=k+(e[s+4]-k)*h}o=n.slots[this.slotIndex];1>f?(o.r+=(l-o.r)*f,o.g+=(a-o.g)*f,o.b+=(v-o.b)*f,o.a+=(y-o.a)*f):(o.r=l,o.g=a,o.b=v,o.a=y)}}};t.AttachmentTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n;this.attachmentNames=[];this.attachmentNames.length=n};t.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(n,t,i){this.frames[n]=t;this.attachmentNames[n]=i},apply:function(n,i,r){var u=this.frames,f,e;if(r<u[0])return i>r&&this.apply(n,i,Number.MAX_VALUE,null,0),void 0;i>r&&(i=-1);f=r>=u[u.length-1]?u.length-1:t.Animation.binarySearch1(u,r)-1;u[f]<i||(e=this.attachmentNames[f],n.slots[this.slotIndex].setAttachment(e?n.getAttachmentBySlotIndex(this.slotIndex,e):null))}};t.EventTimeline=function(n){this.frames=[];this.frames.length=n;this.events=[];this.events.length=n};t.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(n,t,i){this.frames[n]=t;this.events[n]=i},apply:function(n,i,r,u,f){var o,s,e,h,c;if(u){if(o=this.frames,s=o.length,i>r)this.apply(n,i,Number.MAX_VALUE,u,f),i=-1;else if(i>=o[s-1])return;if(!(r<o[0])){if(i<o[0])e=0;else for(e=t.Animation.binarySearch1(o,i),h=o[e];e>0&&o[e-1]==h;)e--;for(c=this.events;s>e&&r>=o[e];e++)u.push(c[e])}}}};t.DrawOrderTimeline=function(n){this.frames=[];this.frames.length=n;this.drawOrders=[];this.drawOrders.length=n};t.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(n,t,i){this.frames[n]=t;this.drawOrders[n]=i},apply:function(n,i,r){var f=this.frames,s,u,e;if(!(r<f[0])){s=r>=f[f.length-1]?f.length-1:t.Animation.binarySearch1(f,r)-1;var h=n.drawOrder,c=n.slots,o=this.drawOrders[s];if(o)for(u=0,e=o.length;e>u;u++)h[u]=n.slots[o[u]];else for(u=0,e=c.length;e>u;u++)h[u]=c[u]}}};t.FfdTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n;this.frameVertices=[];this.frameVertices.length=n};t.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(n,t,i){this.frames[n]=t;this.frameVertices[n]=i},apply:function(n,i,r,u,f){var b=n.slots[this.slotIndex],o,y,p,w,e,l;if(b.attachment==this.attachment&&(o=this.frames,!(r<o[0]))){var v=this.frameVertices,h=v[0].length,s=b.attachmentVertices;if(s.length!=h&&(f=1),s.length=h,r>=o[o.length-1])if(y=v[o.length-1],1>f)for(e=0;h>e;e++)s[e]+=(y[e]-s[e])*f;else for(e=0;h>e;e++)s[e]=y[e];else{var a=t.Animation.binarySearch1(o,r),k=o[a],c=1-(r-k)/(o[a-1]-k);if(c=this.curves.getCurvePercent(a-1,0>c?0:c>1?1:c),p=v[a-1],w=v[a],1>f)for(e=0;h>e;e++)l=p[e],s[e]+=(l+(w[e]-l)*c-s[e])*f;else for(e=0;h>e;e++)l=p[e],s[e]=l+(w[e]-l)*c}}}};t.IkConstraintTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=3*n};t.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(n,t,i,r){n*=3;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r},apply:function(n,i,r,u,f){var e=this.frames,o,a;if(!(r<e[0])){if(o=n.ikConstraints[this.ikConstraintIndex],r>=e[e.length-3])return o.mix+=(e[e.length-2]-o.mix)*f,o.bendDirection=e[e.length-1],void 0;var s=t.Animation.binarySearch(e,r,3),c=e[s+-2],l=e[s],h=1-(r-l)/(e[s+-3]-l);h=this.curves.getCurvePercent(s/3-1,h);a=c+(e[s+1]-c)*h;o.mix+=(a-o.mix)*f;o.bendDirection=e[s+-1]}}};t.FlipXTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=2*n};t.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(n,t,i){n*=2;this.frames[n]=t;this.frames[n+1]=i?1:0},apply:function(n,i,r){var u=this.frames,f;if(r<u[0])return i>r&&this.apply(n,i,Number.MAX_VALUE,null,0),void 0;i>r&&(i=-1);f=(r>=u[u.length-2]?u.length:t.Animation.binarySearch(u,r,2))-2;u[f]<i||(n.bones[boneIndex].flipX=0!=u[f+1])}};t.FlipYTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=2*n};t.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(n,t,i){n*=2;this.frames[n]=t;this.frames[n+1]=i?1:0},apply:function(n,i,r){var u=this.frames,f;if(r<u[0])return i>r&&this.apply(n,i,Number.MAX_VALUE,null,0),void 0;i>r&&(i=-1);f=(r>=u[u.length-2]?u.length:t.Animation.binarySearch(u,r,2))-2;u[f]<i||(n.bones[boneIndex].flipY=0!=u[f+1])}};t.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[];this.ikConstraints=[]};t.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(n){for(var i=this.bones,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null},findBoneIndex:function(n){for(var i=this.bones,t=0,r=i.length;r>t;t++)if(i[t].name==n)return t;return-1},findSlot:function(n){for(var i=this.slots,t=0,r=i.length;r>t;t++)if(i[t].name==n)return slot[t];return null},findSlotIndex:function(n){for(var i=this.slots,t=0,r=i.length;r>t;t++)if(i[t].name==n)return t;return-1},findSkin:function(n){for(var i=this.skins,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null},findEvent:function(n){for(var i=this.events,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null},findAnimation:function(n){for(var i=this.animations,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null},findIkConstraint:function(n){for(var i=this.ikConstraints,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null}};t.Skeleton=function(n){var u,f,i,r;for(this.data=n,this.bones=[],i=0,r=n.bones.length;r>i;i++)u=n.bones[i],f=u.parent?this.bones[n.bones.indexOf(u.parent)]:null,this.bones.push(new t.Bone(u,this,f));for(this.slots=[],this.drawOrder=[],i=0,r=n.slots.length;r>i;i++){var e=n.slots[i],s=this.bones[n.bones.indexOf(e.boneData)],o=new t.Slot(e,s);this.slots.push(o);this.drawOrder.push(o)}for(this.ikConstraints=[],i=0,r=n.ikConstraints.length;r>i;i++)this.ikConstraints.push(new t.IkConstraint(n.ikConstraints[i],this));this.boneCache=[];this.updateCache()};t.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var l=this.ikConstraints,a=l.length,o=a+1,n=this.boneCache,s,h,t,f,r,u,i;for(n.length>o&&(n.length=o),t=0,f=n.length;f>t;t++)n[t].length=0;for(;n.length<o;)n[n.length]=[];s=n[0];h=this.bones;n:for(t=0,f=h.length;f>t;t++){r=h[t];u=r;do{for(i=0;a>i;i++)for(var c=l[i],v=c.bones[0],e=c.bones[c.bones.length-1];;){if(u==e){n[i].push(r);n[i+1].push(r);continue n}if(e==v)break;e=e.parent}u=u.parent}while(u);s[s.length]=r}},updateWorldTransform:function(){for(var t,u,r=this.bones,n=0,e=r.length;e>n;n++)t=r[n],t.rotationIK=t.rotation;for(n=0,u=this.boneCache.length-1;;){for(var f=this.boneCache[n],i=0,o=f.length;o>i;i++)f[i].updateWorldTransform();if(n==u)break;this.ikConstraints[n].apply();n++}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t,i=this.bones,n=0,r=i.length;r>n;n++)i[n].setToSetupPose();for(var u=this.ikConstraints,n=0,r=u.length;r>n;n++)t=u[n],t.bendDirection=t.data.bendDirection,t.mix=t.data.mix},setSlotsToSetupPose:function(){for(var t=this.slots,i=this.drawOrder,n=0,r=t.length;r>n;n++)i[n]=t[n],t[n].setToSetupPose(n)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(n){for(var i=this.bones,t=0,r=i.length;r>t;t++)if(i[t].data.name==n)return i[t];return null},findBoneIndex:function(n){for(var i=this.bones,t=0,r=i.length;r>t;t++)if(i[t].data.name==n)return t;return-1},findSlot:function(n){for(var i=this.slots,t=0,r=i.length;r>t;t++)if(i[t].data.name==n)return i[t];return null},findSlotIndex:function(n){for(var i=this.slots,t=0,r=i.length;r>t;t++)if(i[t].data.name==n)return t;return-1},setSkinByName:function(n){var t=this.data.findSkin(n);if(!t)throw"Skin not found: "+n;this.setSkin(t)},setSkin:function(n){var i,r,u;if(n)if(this.skin)n._attachAll(this,this.skin);else for(var f=this.slots,t=0,e=f.length;e>t;t++)i=f[t],r=i.data.attachmentName,r&&(u=n.getAttachment(t,r),u&&i.setAttachment(u));this.skin=n},getAttachmentBySlotName:function(n,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(n),t)},getAttachmentBySlotIndex:function(n,t){if(this.skin){var i=this.skin.getAttachment(n,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(n,t):null},setAttachment:function(n,t){for(var u,r,f=this.slots,i=0,e=f.length;e>i;i++)if(u=f[i],u.data.name==n){if(r=null,t&&(r=this.getAttachmentBySlotIndex(i,t),!r))throw"Attachment not found: "+t+", for slot: "+n;return u.setAttachment(r),void 0}throw"Slot not found: "+n;},findIkConstraint:function(n){for(var i=this.ikConstraints,t=0,r=i.length;r>t;t++)if(i[t].data.name==n)return i[t];return null},update:function(n){this.time+=n}};t.EventData=function(n){this.name=n};t.EventData.prototype={intValue:0,floatValue:0,stringValue:null};t.Event=function(n){this.data=n};t.Event.prototype={intValue:0,floatValue:0,stringValue:null};t.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3};t.RegionAttachment=function(n){this.name=n;this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};t.RegionAttachment.prototype={type:t.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(n,t,i,r,u){var f=this.uvs;u?(f[2]=n,f[3]=r,f[4]=n,f[5]=t,f[6]=i,f[7]=t,f[0]=i,f[1]=r):(f[0]=n,f[1]=r,f[2]=n,f[3]=t,f[4]=i,f[5]=t,f[6]=i,f[7]=r)},updateOffset:function(){var e=this.width/this.regionOriginalWidth*this.scaleX,o=this.height/this.regionOriginalHeight*this.scaleY,u=-this.width/2*this.scaleX+this.regionOffsetX*e,f=-this.height/2*this.scaleY+this.regionOffsetY*o,s=u+this.regionWidth*e,h=f+this.regionHeight*o,c=this.rotation*t.degRad,i=Math.cos(c),r=Math.sin(c),l=u*i+this.x,a=u*r,v=f*i+this.y,y=f*r,p=s*i+this.x,w=s*r,b=h*i+this.y,k=h*r,n=this.offset;n[0]=l-y;n[1]=v+a;n[2]=l-k;n[3]=b+a;n[4]=p-k;n[5]=b+w;n[6]=p-y;n[7]=v+w},computeVertices:function(n,t,i,r){n+=i.worldX;t+=i.worldY;var f=i.m00,e=i.m01,o=i.m10,s=i.m11,u=this.offset;r[0]=u[0]*f+u[1]*e+n;r[1]=u[0]*o+u[1]*s+t;r[2]=u[2]*f+u[3]*e+n;r[3]=u[2]*o+u[3]*s+t;r[4]=u[4]*f+u[5]*e+n;r[5]=u[4]*o+u[5]*s+t;r[6]=u[6]*f+u[7]*e+n;r[7]=u[6]*o+u[7]*s+t}};t.MeshAttachment=function(n){this.name=n};t.MeshAttachment.prototype={type:t.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var u=this.regionU2-this.regionU,r=this.regionV2-this.regionV,i=this.regionUVs.length,n;if(this.uvs&&this.uvs.length==i||(this.uvs=new t.Float32Array(i)),this.regionRotate)for(n=0;i>n;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n+1]*u,this.uvs[n+1]=this.regionV+r-this.regionUVs[n]*r;else for(n=0;i>n;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n]*u,this.uvs[n+1]=this.regionV+this.regionUVs[n+1]*r},computeWorldVertices:function(n,t,i,r){var f=i.bone,u,o,s;n+=f.worldX;t+=f.worldY;var c=f.m00,l=f.m01,a=f.m10,v=f.m11,e=this.vertices,h=e.length;for(i.attachmentVertices.length==h&&(e=i.attachmentVertices),u=0;h>u;u+=2)o=e[u],s=e[u+1],r[u]=o*c+s*l+n,r[u+1]=o*a+s*v+t}};t.SkinnedMeshAttachment=function(n){this.name=n};t.SkinnedMeshAttachment.prototype={type:t.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var u=this.regionU2-this.regionU,r=this.regionV2-this.regionV,i=this.regionUVs.length,n;if(this.uvs&&this.uvs.length==i||(this.uvs=new t.Float32Array(i)),this.regionRotate)for(n=0;i>n;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n+1]*u,this.uvs[n+1]=this.regionV+r-this.regionUVs[n]*r;else for(n=0;i>n;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n]*u,this.uvs[n+1]=this.regionV+this.regionUVs[n+1]*r},computeWorldVertices:function(n,t,i,r){var p,o,s,u,h,c,l,k=i.bone.skeleton.bones,a=this.weights,y=this.bones,v=0,f=0,e=0,w=0,d=y.length,b;if(i.attachmentVertices.length)for(b=i.attachmentVertices;d>f;v+=2){for(o=0,s=0,p=y[f++]+f;p>f;f++,e+=3,w+=2)u=k[y[f]],h=a[e]+b[w],c=a[e+1]+b[w+1],l=a[e+2],o+=(h*u.m00+c*u.m01+u.worldX)*l,s+=(h*u.m10+c*u.m11+u.worldY)*l;r[v]=o+n;r[v+1]=s+t}else for(;d>f;v+=2){for(o=0,s=0,p=y[f++]+f;p>f;f++,e+=3)u=k[y[f]],h=a[e],c=a[e+1],l=a[e+2],o+=(h*u.m00+c*u.m01+u.worldX)*l,s+=(h*u.m10+c*u.m11+u.worldY)*l;r[v]=o+n;r[v+1]=s+t}}};t.BoundingBoxAttachment=function(n){this.name=n;this.vertices=[]};t.BoundingBoxAttachment.prototype={type:t.AttachmentType.boundingbox,computeWorldVertices:function(n,t,i,r){var e,o;n+=i.worldX;t+=i.worldY;for(var s=i.m00,h=i.m01,c=i.m10,l=i.m11,f=this.vertices,u=0,a=f.length;a>u;u+=2)e=f[u],o=f[u+1],r[u]=e*s+o*h+n,r[u+1]=e*c+o*l+t}};t.AnimationStateData=function(n){this.skeletonData=n;this.animationToMixTime={}};t.AnimationStateData.prototype={defaultMix:0,setMixByName:function(n,t,i){var u=this.skeletonData.findAnimation(n),r;if(!u)throw"Animation not found: "+n;if(r=this.skeletonData.findAnimation(t),!r)throw"Animation not found: "+t;this.setMix(u,r,i)},setMix:function(n,t,i){this.animationToMixTime[n.name+":"+t.name]=i},getMix:function(n,t){var i=n.name+":"+t.name;return this.animationToMixTime.hasOwnProperty(i)?this.animationToMixTime[i]:this.defaultMix}};t.TrackEntry=function(){};t.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null};t.AnimationState=function(n){this.data=n;this.tracks=[];this.events=[]};t.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(n){var i,t,u,r;for(n*=this.timeScale,i=0;i<this.tracks.length;i++)t=this.tracks[i],t&&((t.time+=n*t.timeScale,t.previous)&&(u=n*t.previous.timeScale,t.previous.time+=u,t.mixTime+=u),r=t.next,r?(r.time=t.lastTime-r.delay,r.time>=0&&this.setCurrent(i,r)):!t.loop&&t.lastTime>=t.endTime&&this.clearTrack(i))},apply:function(n){for(var t,u,o,s,h,v,c,l,i=0;i<this.tracks.length;i++)if(t=this.tracks[i],t){this.events.length=0;var r=t.time,a=t.lastTime,f=t.endTime,e=t.loop;for(!e&&r>f&&(r=f),u=t.previous,u?(o=u.time,!u.loop&&o>u.endTime&&(o=u.endTime),u.animation.apply(n,o,o,u.loop,null),s=t.mixTime/t.mixDuration*t.mix,s>=1&&(s=1,t.previous=null),t.animation.mix(n,t.lastTime,r,e,this.events,s)):1==t.mix?t.animation.apply(n,t.lastTime,r,e,this.events):t.animation.mix(n,t.lastTime,r,e,this.events,t.mix),h=0,v=this.events.length;v>h;h++)c=this.events[h],t.onEvent&&t.onEvent(i,c),this.onEvent&&this.onEvent(i,c);(e?a%f>r%f:f>a&&r>=f)&&(l=Math.floor(r/f),t.onComplete&&t.onComplete(i,l),this.onComplete&&this.onComplete(i,l));t.lastTime=t.time}},clearTracks:function(){for(var n=0,t=this.tracks.length;t>n;n++)this.clearTrack(n);this.tracks.length=0},clearTrack:function(n){if(!(n>=this.tracks.length)){var t=this.tracks[n];t&&(t.onEnd&&t.onEnd(n),this.onEnd&&this.onEnd(n),this.tracks[n]=null)}},_expandToIndex:function(n){if(n<this.tracks.length)return this.tracks[n];for(;n>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(n,t){var i=this._expandToIndex(n),r;i&&(r=i.previous,i.previous=null,i.onEnd&&i.onEnd(n),this.onEnd&&this.onEnd(n),t.mixDuration=this.data.getMix(i.animation,t.animation),t.mixDuration>0&&(t.mixTime=0,t.previous=r&&i.mixTime/i.mixDuration<.5?r:i));this.tracks[n]=t;t.onStart&&t.onStart(n);this.onStart&&this.onStart(n)},setAnimationByName:function(n,t,i){var r=this.data.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;return this.setAnimation(n,r,i)},setAnimation:function(n,i,r){var u=new t.TrackEntry;return u.animation=i,u.loop=r,u.endTime=i.duration,this.setCurrent(n,u),u},addAnimationByName:function(n,t,i,r){var u=this.data.skeletonData.findAnimation(t);if(!u)throw"Animation not found: "+t;return this.addAnimation(n,u,i,r)},addAnimation:function(n,i,r,u){var e=new t.TrackEntry,f;if(e.animation=i,e.loop=r,e.endTime=i.duration,f=this._expandToIndex(n),f){for(;f.next;)f=f.next;f.next=e}else this.tracks[n]=e;return 0>=u&&(f?u+=f.endTime-this.data.getMix(f.animation,i):u=0),e.delay=u,e},getCurrent:function(n){return n>=this.tracks.length?null:this.tracks[n]}};t.SkeletonJson=function(n){this.attachmentLoader=n};t.SkeletonJson.prototype={scale:1,readSkeletonData:function(n,i){var r=new t.SkeletonData,c,u,k,d,e,b,ct,s,f,h,a,nt,tt,it,v,rt,vt,ut,p,lt,ft,et,ot,w,st,ht;r.name=i;c=n.skeleton;c&&(r.hash=c.hash,r.version=c.spine,r.width=c.width||0,r.height=c.height||0);for(var y=n.bones,e=0,b=y.length;b>e;e++){if(u=y[e],k=null,u.parent&&(k=r.findBone(u.parent),!k))throw"Parent bone not found: "+u.parent;f=new t.BoneData(u.name,k);f.length=(u.length||0)*this.scale;f.x=(u.x||0)*this.scale;f.y=(u.y||0)*this.scale;f.rotation=u.rotation||0;f.scaleX=u.hasOwnProperty("scaleX")?u.scaleX:1;f.scaleY=u.hasOwnProperty("scaleY")?u.scaleY:1;f.inheritScale=u.hasOwnProperty("inheritScale")?u.inheritScale:!0;f.inheritRotation=u.hasOwnProperty("inheritRotation")?u.inheritRotation:!0;r.bones.push(f)}if(d=n.ik,d)for(e=0,b=d.length;b>e;e++){for(var o=d[e],l=new t.IkConstraintData(o.name),y=o.bones,g=0,yt=y.length;yt>g;g++){if(ct=r.findBone(y[g]),!ct)throw"IK bone not found: "+y[g];l.bones.push(ct)}if(l.target=r.findBone(o.target),!l.target)throw"Target bone not found: "+o.target;l.bendDirection=!o.hasOwnProperty("bendPositive")||o.bendPositive?1:-1;l.mix=o.hasOwnProperty("mix")?o.mix:1;r.ikConstraints.push(l)}for(var at=n.slots,e=0,b=at.length;b>e;e++){if(s=at[e],f=r.findBone(s.bone),!f)throw"Slot bone not found: "+s.bone;h=new t.SlotData(s.name,f);a=s.color;a&&(h.r=this.toColor(a,0),h.g=this.toColor(a,1),h.b=this.toColor(a,2),h.a=this.toColor(a,3));h.attachmentName=s.attachment;h.additiveBlending=s.additive&&"true"==s.additive;r.slots.push(h)}nt=n.skins;for(tt in nt)if(nt.hasOwnProperty(tt)){it=nt[tt];v=new t.Skin(tt);for(rt in it)if(it.hasOwnProperty(rt)){vt=r.findSlotIndex(rt);ut=it[rt];for(p in ut)ut.hasOwnProperty(p)&&(lt=this.readAttachment(v,p,ut[p]),lt&&v.addAttachment(vt,p,lt))}r.skins.push(v);"default"==v.name&&(r.defaultSkin=v)}ft=n.events;for(et in ft)ft.hasOwnProperty(et)&&(ot=ft[et],w=new t.EventData(et),w.intValue=ot.int||0,w.floatValue=ot.float||0,w.stringValue=ot.string||null,r.events.push(w));st=n.animations;for(ht in st)st.hasOwnProperty(ht)&&this.readAnimation(ht,st[ht],r);return r},readAttachment:function(n,i,r){var e,f,u,y,w;i=r.name||i;var a=t.AttachmentType[r.type||"region"],l=r.path||i,o=this.scale;if(a==t.AttachmentType.region)return(e=this.attachmentLoader.newRegionAttachment(n,i,l),!e)?null:(e.path=l,e.x=(r.x||0)*o,e.y=(r.y||0)*o,e.scaleX=r.hasOwnProperty("scaleX")?r.scaleX:1,e.scaleY=r.hasOwnProperty("scaleY")?r.scaleY:1,e.rotation=r.rotation||0,e.width=(r.width||0)*o,e.height=(r.height||0)*o,f=r.color,f&&(e.r=this.toColor(f,0),e.g=this.toColor(f,1),e.b=this.toColor(f,2),e.a=this.toColor(f,3)),e.updateOffset(),e);if(a==t.AttachmentType.mesh)return u=this.attachmentLoader.newMeshAttachment(n,i,l),u?(u.path=l,u.vertices=this.getFloatArray(r,"vertices",o),u.triangles=this.getIntArray(r,"triangles"),u.regionUVs=this.getFloatArray(r,"uvs",1),u.updateUVs(),f=r.color,f&&(u.r=this.toColor(f,0),u.g=this.toColor(f,1),u.b=this.toColor(f,2),u.a=this.toColor(f,3)),u.hullLength=2*(r.hull||0),r.edges&&(u.edges=this.getIntArray(r,"edges")),u.width=(r.width||0)*o,u.height=(r.height||0)*o,u):null;if(a==t.AttachmentType.skinnedmesh){if(u=this.attachmentLoader.newSkinnedMeshAttachment(n,i,l),!u)return null;u.path=l;for(var k=this.getFloatArray(r,"uvs",1),h=this.getFloatArray(r,"vertices",1),c=[],v=[],s=0,p=h.length;p>s;)for(y=0|h[s++],v[v.length]=y,w=s+4*y;w>s;)v[v.length]=h[s],c[c.length]=h[s+1]*o,c[c.length]=h[s+2]*o,c[c.length]=h[s+3],s+=4;return u.bones=v,u.weights=c,u.triangles=this.getIntArray(r,"triangles"),u.regionUVs=k,u.updateUVs(),f=r.color,f&&(u.r=this.toColor(f,0),u.g=this.toColor(f,1),u.b=this.toColor(f,2),u.a=this.toColor(f,3)),u.hullLength=2*(r.hull||0),r.edges&&(u.edges=this.getIntArray(r,"edges")),u.width=(r.width||0)*o,u.height=(r.height||0)*o,u}if(a==t.AttachmentType.boundingbox){for(var b=this.attachmentLoader.newBoundingBoxAttachment(n,i),h=r.vertices,s=0,p=h.length;p>s;s++)b.vertices.push(h[s]*o);return b}throw"Unknown attachment type: "+a;},readAnimation:function(n,i,r){var a=[],c=0,ii=i.slots,b,lt,tt,ut,at,l,s,vt,yt,u,pt,wt,ri,ui,hi,d,fi,bt,ei,kt,f,dt,v,oi,ft,nt,gt,k,ni,ot,ti,p,o,st,y,rt,ht;for(b in ii)if(ii.hasOwnProperty(b)){d=ii[b];p=r.findSlotIndex(b);for(l in d)if(d.hasOwnProperty(l))if(s=d[l],"color"==l){u=new t.ColorTimeline(s.length);u.slotIndex=p;for(var h=0,e=0,w=s.length;w>e;e++){var f=s[e],ct=f.color,ci=this.toColor(ct,0),li=this.toColor(ct,1),ai=this.toColor(ct,2),vi=this.toColor(ct,3);u.setFrame(h,f.time,ci,li,ai,vi);this.readCurve(u,h,f);h++}a.push(u);c=Math.max(c,u.frames[5*u.getFrameCount()-5])}else{if("attachment"!=l)throw"Invalid timeline type for a slot: "+l+" ("+b+")";u=new t.AttachmentTimeline(s.length);u.slotIndex=p;for(var h=0,e=0,w=s.length;w>e;e++)f=s[e],u.setFrame(h++,f.time,f.name);a.push(u);c=Math.max(c,u.frames[u.getFrameCount()-1])}}lt=i.bones;for(tt in lt)if(lt.hasOwnProperty(tt)){if(ut=r.findBoneIndex(tt),-1==ut)throw"Bone not found: "+tt;at=lt[tt];for(l in at)if(at.hasOwnProperty(l))if(s=at[l],"rotate"==l){u=new t.RotateTimeline(s.length);u.boneIndex=ut;for(var h=0,e=0,w=s.length;w>e;e++)f=s[e],u.setFrame(h,f.time,f.angle),this.readCurve(u,h,f),h++;a.push(u);c=Math.max(c,u.frames[2*u.getFrameCount()-2])}else if("translate"==l||"scale"==l){vt=1;"scale"==l?u=new t.ScaleTimeline(s.length):(u=new t.TranslateTimeline(s.length),vt=this.scale);u.boneIndex=ut;for(var h=0,e=0,w=s.length;w>e;e++){var f=s[e],yt=(f.x||0)*vt,yi=(f.y||0)*vt;u.setFrame(h,f.time,yt,yi);this.readCurve(u,h,f);h++}a.push(u);c=Math.max(c,u.frames[3*u.getFrameCount()-3])}else{if("flipX"!=l&&"flipY"!=l)throw"Invalid timeline type for a bone: "+l+" ("+tt+")";yt="flipX"==l;u=yt?new t.FlipXTimeline(s.length):new t.FlipYTimeline(s.length);u.boneIndex=ut;for(var pi=yt?"x":"y",h=0,e=0,w=s.length;w>e;e++)f=s[e],u.setFrame(h,f.time,f[pi]||!1),h++;a.push(u);c=Math.max(c,u.frames[2*u.getFrameCount()-2])}}pt=i.ik;for(wt in pt)if(pt.hasOwnProperty(wt)){var wi=r.findIkConstraint(wt),s=pt[wt],u=new t.IkConstraintTimeline(s.length);u.ikConstraintIndex=r.ikConstraints.indexOf(wi);for(var h=0,e=0,w=s.length;w>e;e++){var f=s[e],bi=f.hasOwnProperty("mix")?f.mix:1,ki=!f.hasOwnProperty("bendPositive")||f.bendPositive?1:-1;u.setFrame(h,f.time,bi,ki);this.readCurve(u,h,f);h++}a.push(u);c=Math.max(c,u.frames[3*u.frameCount-3])}ri=i.ffd;for(ui in ri){hi=r.findSkin(ui);d=ri[ui];for(b in d){p=r.findSlotIndex(b);fi=d[b];for(bt in fi){var s=fi[bt],u=new t.FfdTimeline(s.length),g=hi.getAttachment(p,bt);if(!g)throw"FFD attachment not found: "+bt;u.slotIndex=p;u.attachment=g;kt=g.type==t.AttachmentType.mesh;ei=kt?g.vertices.length:g.weights.length/3*2;for(var h=0,e=0,w=s.length;w>e;e++){if(f=s[e],f.vertices){if(dt=f.vertices,v=[],v.length=ei,oi=f.offset||0,ft=dt.length,1==this.scale)for(o=0;ft>o;o++)v[o+oi]=dt[o];else for(o=0;ft>o;o++)v[o+oi]=dt[o]*this.scale;if(kt)for(var di=g.vertices,o=0,ft=v.length;ft>o;o++)v[o]+=di[o]}else kt?v=g.vertices:(v=[],v.length=ei);u.setFrame(h,f.time,v);this.readCurve(u,h,f);h++}a[a.length]=u;c=Math.max(c,u.frames[u.frameCount-1])}}}if(nt=i.drawOrder,nt||(nt=i.draworder),nt){for(var u=new t.DrawOrderTimeline(nt.length),et=r.slots.length,h=0,e=0,w=nt.length;w>e;e++){if(gt=nt[e],k=null,gt.offsets){for(k=[],k.length=et,o=et-1;o>=0;o--)k[o]=-1;ni=gt.offsets;ot=[];ot.length=et-ni.length;for(var it=0,si=0,o=0,ft=ni.length;ft>o;o++){if(ti=ni[o],p=r.findSlotIndex(ti.slot),-1==p)throw"Slot not found: "+ti.slot;for(;it!=p;)ot[si++]=it++;k[it+ti.offset]=it++}for(;et>it;)ot[si++]=it++;for(o=et-1;o>=0;o--)-1==k[o]&&(k[o]=ot[--si])}u.setFrame(h++,gt.time,k)}a.push(u);c=Math.max(c,u.frames[u.getFrameCount()-1])}if(st=i.events,st){for(var u=new t.EventTimeline(st.length),h=0,e=0,w=st.length;w>e;e++){if(y=st[e],rt=r.findEvent(y.name),!rt)throw"Event not found: "+y.name;ht=new t.Event(rt);ht.intValue=y.hasOwnProperty("int")?y.int:rt.intValue;ht.floatValue=y.hasOwnProperty("float")?y.float:rt.floatValue;ht.stringValue=y.hasOwnProperty("string")?y.string:rt.stringValue;u.setFrame(h++,y.time,ht)}a.push(u);c=Math.max(c,u.frames[u.getFrameCount()-1])}r.animations.push(new t.Animation(n,a,c))},readCurve:function(n,t,i){var r=i.curve;r?"stepped"==r?n.curves.setStepped(t):r instanceof Array&&n.curves.setCurve(t,r[0],r[1],r[2],r[3]):n.curves.setLinear(t)},toColor:function(n,t){if(8!=n.length)throw"Color hexidecimal length must be 8, recieved: "+n;return parseInt(n.substring(2*t,2*t+2),16)/255},getFloatArray:function(n,i,r){var f=n[i],e=new t.Float32Array(f.length),u=0,o=f.length;if(1==r)for(;o>u;u++)e[u]=f[u];else for(;o>u;u++)e[u]=f[u]*r;return e},getIntArray:function(n,i){for(var u=n[i],f=new t.Uint16Array(u.length),r=0,e=u.length;e>r;r++)f[r]=0|u[r];return f}};t.Atlas=function(n,i){var e,r,u,o,f,s,h,c,l,a;for(this.textureLoader=i,this.pages=[],this.regions=[],e=new t.AtlasReader(n),r=[],r.length=4,u=null;;){if(o=e.readLine(),null===o)break;(o=e.trim(o),o.length)?u?(f=new t.AtlasRegion,f.name=o,f.page=u,f.rotate="true"==e.readValue(),e.readTuple(r),s=parseInt(r[0]),h=parseInt(r[1]),e.readTuple(r),c=parseInt(r[0]),l=parseInt(r[1]),f.u=s/u.width,f.v=h/u.height,f.rotate?(f.u2=(s+l)/u.width,f.v2=(h+c)/u.height):(f.u2=(s+c)/u.width,f.v2=(h+l)/u.height),f.x=s,f.y=h,f.width=Math.abs(c),f.height=Math.abs(l),4==e.readTuple(r)&&(f.splits=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],4==e.readTuple(r)&&(f.pads=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],e.readTuple(r))),f.originalWidth=parseInt(r[0]),f.originalHeight=parseInt(r[1]),e.readTuple(r),f.offsetX=parseInt(r[0]),f.offsetY=parseInt(r[1]),f.index=parseInt(e.readValue()),this.regions.push(f)):(u=new t.AtlasPage,u.name=o,2==e.readTuple(r)&&(u.width=parseInt(r[0]),u.height=parseInt(r[1]),e.readTuple(r)),u.format=t.Atlas.Format[r[0]],e.readTuple(r),u.minFilter=t.Atlas.TextureFilter[r[0]],u.magFilter=t.Atlas.TextureFilter[r[1]],a=e.readValue(),u.uWrap=t.Atlas.TextureWrap.clampToEdge,u.vWrap=t.Atlas.TextureWrap.clampToEdge,"x"==a?u.uWrap=t.Atlas.TextureWrap.repeat:"y"==a?u.vWrap=t.Atlas.TextureWrap.repeat:"xy"==a&&(u.uWrap=u.vWrap=t.Atlas.TextureWrap.repeat),i.load(u,o,this),this.pages.push(u)):u=null}};t.Atlas.prototype={findRegion:function(n){for(var i=this.regions,t=0,r=i.length;r>t;t++)if(i[t].name==n)return i[t];return null},dispose:function(){for(var t=this.pages,n=0,i=t.length;i>n;n++)this.textureLoader.unload(t[n].rendererObject)},updateUVs:function(n){for(var t,r=this.regions,i=0,u=r.length;u>i;i++)t=r[i],t.page==n&&(t.u=t.x/n.width,t.v=t.y/n.height,t.rotate?(t.u2=(t.x+t.height)/n.width,t.v2=(t.y+t.width)/n.height):(t.u2=(t.x+t.width)/n.width,t.v2=(t.y+t.height)/n.height))}};t.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};t.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};t.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};t.AtlasPage=function(){};t.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};t.AtlasRegion=function(){};t.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};t.AtlasReader=function(n){this.lines=n.split(/\r\n|\r|\n/)};t.AtlasReader.prototype={index:0,trim:function(n){return n.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var n=this.readLine(),t=n.indexOf(":");if(-1==t)throw"Invalid line: "+n;return this.trim(n.substring(t+1))},readTuple:function(n){var r=this.readLine(),f=r.indexOf(":"),t,i,u;if(-1==f)throw"Invalid line: "+r;for(t=0,i=f+1;3>t;t++){if(u=r.indexOf(",",i),-1==u)break;n[t]=this.trim(r.substr(i,u-i));i=u+1}return n[t]=this.trim(r.substring(i)),t+1}};t.AtlasAttachmentLoader=function(n){this.atlas=n};t.AtlasAttachmentLoader.prototype={newRegionAttachment:function(n,i,r){var u=this.atlas.findRegion(r),f;if(!u)throw"Region not found in atlas: "+r+" (region attachment: "+i+")";return f=new t.RegionAttachment(i),f.rendererObject=u,f.setUVs(u.u,u.v,u.u2,u.v2,u.rotate),f.regionOffsetX=u.offsetX,f.regionOffsetY=u.offsetY,f.regionWidth=u.width,f.regionHeight=u.height,f.regionOriginalWidth=u.originalWidth,f.regionOriginalHeight=u.originalHeight,f},newMeshAttachment:function(n,i,r){var f=this.atlas.findRegion(r),u;if(!f)throw"Region not found in atlas: "+r+" (mesh attachment: "+i+")";return u=new t.MeshAttachment(i),u.rendererObject=f,u.regionU=f.u,u.regionV=f.v,u.regionU2=f.u2,u.regionV2=f.v2,u.regionRotate=f.rotate,u.regionOffsetX=f.offsetX,u.regionOffsetY=f.offsetY,u.regionWidth=f.width,u.regionHeight=f.height,u.regionOriginalWidth=f.originalWidth,u.regionOriginalHeight=f.originalHeight,u},newSkinnedMeshAttachment:function(n,i,r){var f=this.atlas.findRegion(r),u;if(!f)throw"Region not found in atlas: "+r+" (skinned mesh attachment: "+i+")";return u=new t.SkinnedMeshAttachment(i),u.rendererObject=f,u.regionU=f.u,u.regionV=f.v,u.regionU2=f.u2,u.regionV2=f.v2,u.regionRotate=f.rotate,u.regionOffsetX=f.offsetX,u.regionOffsetY=f.offsetY,u.regionWidth=f.width,u.regionHeight=f.height,u.regionOriginalWidth=f.originalWidth,u.regionOriginalHeight=f.originalHeight,u},newBoundingBoxAttachment:function(n,i){return new t.BoundingBoxAttachment(i)}};t.SkeletonBounds=function(){this.polygonPool=[];this.polygons=[];this.boundingBoxes=[]};t.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(n,i){var c=n.slots,v=c.length,y=n.x,p=n.y,l=this.boundingBoxes,e=this.polygonPool,o=this.polygons,a,r,h,u,f,s;for(l.length=0,r=0,a=o.length;a>r;r++)e.push(o[r]);for(o.length=0,r=0;v>r;r++)h=c[r],u=h.attachment,u.type==t.AttachmentType.boundingbox&&(l.push(u),s=e.length,s>0?(f=e[s-1],e.splice(s-1,1)):f=[],o.push(f),f.length=u.vertices.length,u.computeWorldVertices(y,p,h.bone,f));i&&this.aabbCompute()},aabbCompute:function(){for(var o,s,h=this.polygons,t=Number.MAX_VALUE,i=Number.MAX_VALUE,r=Number.MIN_VALUE,u=Number.MIN_VALUE,f=0,c=h.length;c>f;f++)for(var e=h[f],n=0,l=e.length;l>n;n+=2)o=e[n],s=e[n+1],t=Math.min(t,o),i=Math.min(i,s),r=Math.max(r,o),u=Math.max(u,s);this.minX=t;this.minY=i;this.maxX=r;this.maxY=u},aabbContainsPoint:function(n,t){return n>=this.minX&&n<=this.maxX&&t>=this.minY&&t<=this.maxY},aabbIntersectsSegment:function(n,t,i,r){var e=this.minX,o=this.minY,s=this.maxX,h=this.maxY,c,u,f;return e>=n&&e>=i||o>=t&&o>=r||n>=s&&i>=s||t>=h&&r>=h?!1:(c=(r-t)/(i-n),u=c*(e-n)+t,u>o&&h>u)?!0:(u=c*(s-n)+t,u>o&&h>u)?!0:(f=(o-t)/c+n,f>e&&s>f?!0:(f=(h-t)/c+n,f>e&&s>f?!0:!1))},aabbIntersectsSkeleton:function(n){return this.minX<n.maxX&&this.maxX>n.minX&&this.minY<n.maxY&&this.maxY>n.minY},containsPoint:function(n,t){for(var r=this.polygons,i=0,u=r.length;u>i;i++)if(this.polygonContainsPoint(r[i],n,t))return this.boundingBoxes[i];return null},intersectsSegment:function(n,t,i,r){for(var f=this.polygons,u=0,e=f.length;e>u;u++)if(f[u].intersectsSegment(n,t,i,r))return this.boundingBoxes[u];return null},polygonContainsPoint:function(n,t,i){for(var u,f,s,h=n.length,e=h-2,o=!1,r=0;h>r;r+=2)u=n[r+1],f=n[e+1],(i>u&&f>=i||i>f&&u>=i)&&(s=n[r],s+(i-u)/(f-u)*(n[e]-s)<t&&(o=!o)),e=r;return o},polygonIntersectsSegment:function(n,t,i,r,u){for(var f,a=n.length,v=t-r,y=i-u,p=t*u-i*r,o=n[a-2],s=n[a-1],l=0;a>l;l+=2){var h=n[l],c=n[l+1],w=o*c-s*h,b=o-h,k=s-c,d=v*k-y*b,e=(p*b-v*w)/d;if((e>=o&&h>=e||e>=h&&o>=e)&&(e>=t&&r>=e||e>=r&&t>=e)&&(f=(p*k-y*w)/d,(f>=s&&c>=f||f>=c&&s>=f)&&(f>=i&&u>=f||f>=u&&i>=f)))return!0;o=h;s=c}return!1},getPolygon:function(n){var t=this.boundingBoxes.indexOf(n);return-1==t?null:this.polygons[t]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};t.Bone.yDown=!0;n.AnimCache={};n.SpineTextureLoader=function(t,i){n.EventTarget.call(this);this.basePath=t;this.crossorigin=i;this.loadingCount=0};n.SpineTextureLoader.prototype=n.SpineTextureLoader;n.SpineTextureLoader.prototype.load=function(t,i){if(t.rendererObject=n.BaseTexture.fromImage(this.basePath+"/"+i,this.crossorigin),!t.rendererObject.hasLoaded){var r=this;++r.loadingCount;t.rendererObject.addEventListener("loaded",function(){--r.loadingCount;r.dispatchEvent({type:"loadedBaseTexture",content:r})})}};n.SpineTextureLoader.prototype.unload=function(n){n.destroy(!0)};n.Spine=function(i){var f,h,c,o,s;if(n.DisplayObjectContainer.call(this),this.spineData=n.AnimCache[i],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+i);for(this.skeleton=new t.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new t.AnimationStateData(this.spineData),this.state=new t.AnimationState(this.stateData),this.slotContainers=[],f=0,h=this.skeleton.drawOrder.length;h>f;f++){var r=this.skeleton.drawOrder[f],u=r.attachment,e=new n.DisplayObjectContainer;if(this.slotContainers.push(e),this.addChild(e),u instanceof t.RegionAttachment)c=u.rendererObject.name,o=this.createSprite(r,u),r.currentSprite=o,r.currentSpriteName=c,e.addChild(o);else{if(!(u instanceof t.MeshAttachment))continue;s=this.createMesh(r,u);r.currentMesh=s;r.currentMeshName=u.name;e.addChild(s)}}this.autoUpdate=!0};n.Spine.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Spine.prototype.constructor=n.Spine;Object.defineProperty(n.Spine.prototype,"autoUpdate",{get:function(){return this.updateTransform===n.Spine.prototype.autoUpdateTransform},set:function(t){this.updateTransform=t?n.Spine.prototype.autoUpdateTransform:n.DisplayObjectContainer.prototype.updateTransform}});n.Spine.prototype.update=function(i){var c,o,a,e,s,v;this.state.update(i);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();for(var l=this.skeleton.drawOrder,h=0,y=l.length;y>h;h++){var r=l[h],u=r.attachment,f=this.slotContainers[h];if(u){if(c=u.type,c===t.AttachmentType.region)u.rendererObject&&(!r.currentSpriteName||r.currentSpriteName!==u.name)&&(o=u.rendererObject.name,(void 0!==r.currentSprite&&(r.currentSprite.visible=!1),r.sprites=r.sprites||{},void 0!==r.sprites[o])?r.sprites[o].visible=!0:(a=this.createSprite(r,u),f.addChild(a)),r.currentSprite=r.sprites[o],r.currentSpriteName=o),e=r.bone,f.position.x=e.worldX+u.x*e.m00+u.y*e.m01,f.position.y=e.worldY+u.x*e.m10+u.y*e.m11,f.scale.x=e.worldScaleX,f.scale.y=e.worldScaleY,f.rotation=-(r.bone.worldRotation*t.degRad),r.currentSprite.tint=n.rgb2hex([r.r,r.g,r.b]);else{if(c!==t.AttachmentType.skinnedmesh){f.visible=!1;continue}r.currentMeshName&&r.currentMeshName===u.name||(s=u.name,(void 0!==r.currentMesh&&(r.currentMesh.visible=!1),r.meshes=r.meshes||{},void 0!==r.meshes[s])?r.meshes[s].visible=!0:(v=this.createMesh(r,u),f.addChild(v)),r.currentMesh=r.meshes[s],r.currentMeshName=s);u.computeWorldVertices(r.bone.skeleton.x,r.bone.skeleton.y,r,r.currentMesh.vertices)}f.visible=!0;f.alpha=r.a}else f.visible=!1}};n.Spine.prototype.autoUpdateTransform=function(){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now();this.update(t);n.DisplayObjectContainer.prototype.updateTransform.call(this)};n.Spine.prototype.createSprite=function(i,r){var u=r.rendererObject,e=u.page.rendererObject,o=new n.Rectangle(u.x,u.y,u.rotate?u.height:u.width,u.rotate?u.width:u.height),s=new n.Texture(e,o),f=new n.Sprite(s),h=u.rotate?.5*Math.PI:0;return f.scale.set(u.width/u.originalWidth,u.height/u.originalHeight),f.rotation=h-r.rotation*t.degRad,f.anchor.x=f.anchor.y=.5,i.sprites=i.sprites||{},i.sprites[u.name]=f,f};n.Spine.prototype.createMesh=function(t,i){var u=i.rendererObject,f=u.page.rendererObject,e=new n.Texture(f),r=new n.Strip(e);return r.drawMode=n.Strip.DrawModes.TRIANGLES,r.canvasPadding=1.5,r.vertices=new n.Float32Array(i.uvs.length),r.uvs=i.uvs,r.indices=i.triangles,t.meshes=t.meshes||{},t.meshes[i.name]=r,r};n.BaseTextureCache={};n.BaseTextureCacheIdGenerator=0;n.BaseTexture=function(t,i){if(this.resolution=1,this.width=100,this.height=100,this.scaleMode=i||n.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this._UID=n._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty();else{var r=this;this.source.onload=function(){r.hasLoaded=!0;r.width=r.source.naturalWidth||r.source.width;r.height=r.source.naturalHeight||r.source.height;r.dirty();r.dispatchEvent({type:"loaded",content:r})};this.source.onerror=function(){r.dispatchEvent({type:"error",content:r})}}this.imageUrl=null;this._powerOf2=!1}};n.BaseTexture.prototype.constructor=n.BaseTexture;n.EventTarget.mixin(n.BaseTexture.prototype);n.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete n.BaseTextureCache[this.imageUrl],delete n.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete n.BaseTextureCache[this.source._pixiId];this.source=null;this.unloadFromGPU()};n.BaseTexture.prototype.updateSourceImage=function(n){this.hasLoaded=!1;this.source.src=null;this.source.src=n};n.BaseTexture.prototype.dirty=function(){for(var n=0;n<this._glTextures.length;n++)this._dirty[n]=!0};n.BaseTexture.prototype.unloadFromGPU=function(){var t,i,r;for(this.dirty(),t=this._glTextures.length-1;t>=0;t--)i=this._glTextures[t],r=n.glContexts[t],r&&i&&r.deleteTexture(i);this._glTextures.length=0;this.dirty()};n.BaseTexture.fromImage=function(t,i,r){var u=n.BaseTextureCache[t],f;return(void 0===i&&-1===t.indexOf("data:")&&(i=!0),u)||(f=new Image,i&&(f.crossOrigin=""),f.src=t,u=new n.BaseTexture(f,r),u.imageUrl=t,n.BaseTextureCache[t]=u,-1!==t.indexOf(n.RETINA_PREFIX+".")&&(u.resolution=2)),u};n.BaseTexture.fromCanvas=function(t,i){t._pixiId||(t._pixiId="canvas_"+n.TextureCacheIdGenerator++);var r=n.BaseTextureCache[t._pixiId];return r||(r=new n.BaseTexture(t,i),n.BaseTextureCache[t._pixiId]=r),r};n.TextureCache={};n.FrameCache={};n.TextureCacheIdGenerator=0;n.Texture=function(t,i,r,u){this.noFrame=!1;i||(this.noFrame=!0,i=new n.Rectangle(0,0,1,1));t instanceof n.Texture&&(t=t.baseTexture);this.baseTexture=t;this.frame=i;this.trim=u;this.valid=!1;this.requiresUpdate=!1;this._uvs=null;this.width=0;this.height=0;this.crop=r||new n.Rectangle(0,0,1,1);t.hasLoaded?(this.noFrame&&(i=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(i)):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))};n.Texture.prototype.constructor=n.Texture;n.EventTarget.mixin(n.Texture.prototype);n.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded);this.noFrame&&(this.frame=new n.Rectangle(0,0,t.width,t.height));this.setFrame(this.frame);this.dispatchEvent({type:"update",content:this})};n.Texture.prototype.destroy=function(n){n&&this.baseTexture.destroy();this.valid=!1};n.Texture.prototype.setFrame=function(n){if(this.noFrame=!1,this.frame=n,this.width=n.width,this.height=n.height,this.crop.x=n.x,this.crop.y=n.y,this.crop.width=n.width,this.crop.height=n.height,!this.trim&&(n.x+n.width>this.baseTexture.width||n.y+n.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=n&&n.width&&n.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height);this.valid&&this._updateUvs()};n.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new n.TextureUvs);var t=this.crop,i=this.baseTexture.width,r=this.baseTexture.height;this._uvs.x0=t.x/i;this._uvs.y0=t.y/r;this._uvs.x1=(t.x+t.width)/i;this._uvs.y1=t.y/r;this._uvs.x2=(t.x+t.width)/i;this._uvs.y2=(t.y+t.height)/r;this._uvs.x3=t.x/i;this._uvs.y3=(t.y+t.height)/r};n.Texture.fromImage=function(t,i,r){var u=n.TextureCache[t];return u||(u=new n.Texture(n.BaseTexture.fromImage(t,i,r)),n.TextureCache[t]=u),u};n.Texture.fromFrame=function(t){var i=n.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return i};n.Texture.fromCanvas=function(t,i){var r=n.BaseTexture.fromCanvas(t,i);return new n.Texture(r)};n.Texture.addTextureToCache=function(t,i){n.TextureCache[i]=t};n.Texture.removeTextureFromCache=function(t){var i=n.TextureCache[t];return delete n.TextureCache[t],delete n.BaseTextureCache[t],i};n.TextureUvs=function(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0};n.Texture.emptyTexture=new n.Texture(new n.BaseTexture);n.RenderTexture=function(t,i,r,u,f){if(this.width=t||100,this.height=i||100,this.resolution=f||1,this.frame=new n.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new n.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new n.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=u||n.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,n.Texture.call(this,this.baseTexture,new n.Rectangle(0,0,this.width,this.height)),this.renderer=r||n.defaultRenderer,this.renderer.type===n.WEBGL_RENDERER){var e=this.renderer.gl;this.baseTexture._dirty[e.id]=!1;this.textureBuffer=new n.FilterTexture(e,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode);this.baseTexture._glTextures[e.id]=this.textureBuffer.texture;this.render=this.renderWebGL;this.projection=new n.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new n.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0;this._updateUvs()};n.RenderTexture.prototype=Object.create(n.Texture.prototype);n.RenderTexture.prototype.constructor=n.RenderTexture;n.RenderTexture.prototype.resize=function(t,i,r){(t!==this.width||i!==this.height)&&(this.valid=t>0&&i>0,this.width=this.frame.width=this.crop.width=t,this.height=this.frame.height=this.crop.height=i,r&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===n.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))};n.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===n.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())};n.RenderTexture.prototype.renderWebGL=function(n,t,i){var r,u;if(this.valid){r=n.worldTransform;r.identity();r.translate(0,2*this.projection.y);t&&r.append(t);r.scale(1,-1);n.worldAlpha=1;for(var e=n.children,f=0,o=e.length;o>f;f++)e[f].updateTransform();u=this.renderer.gl;u.viewport(0,0,this.width*this.resolution,this.height*this.resolution);u.bindFramebuffer(u.FRAMEBUFFER,this.textureBuffer.frameBuffer);i&&this.textureBuffer.clear();this.renderer.spriteBatch.dirty=!0;this.renderer.renderDisplayObject(n,this.projection,this.textureBuffer.frameBuffer);this.renderer.spriteBatch.dirty=!0}};n.RenderTexture.prototype.renderCanvas=function(n,t,i){var r,e,o;if(this.valid){r=n.worldTransform;r.identity();t&&r.append(t);n.worldAlpha=1;for(var f=n.children,u=0,s=f.length;s>u;u++)f[u].updateTransform();i&&this.textureBuffer.clear();e=this.textureBuffer.context;o=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(n,e);this.renderer.resolution=o}};n.RenderTexture.prototype.getImage=function(){var n=new Image;return n.src=this.getBase64(),n};n.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};n.RenderTexture.prototype.getCanvas=function(){var u,f;if(this.renderer.type===n.WEBGL_RENDERER){var t=this.renderer.gl,i=this.textureBuffer.width,r=this.textureBuffer.height,e=new Uint8Array(4*i*r);return t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,i,r,t.RGBA,t.UNSIGNED_BYTE,e),t.bindFramebuffer(t.FRAMEBUFFER,null),u=new n.CanvasBuffer(i,r),f=u.context.getImageData(0,0,i,r),f.data.set(e),u.context.putImageData(f,0,0),u.canvas}return this.textureBuffer.canvas};n.RenderTexture.tempMatrix=new n.Matrix;n.VideoTexture=function(t,i){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0);n.BaseTexture.call(this,t,i);this.autoUpdate=!1;this.updateBound=this._onUpdate.bind(this);t.complete||(this._onCanPlay=this.onCanPlay.bind(this),t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this.onPlayStart.bind(this)),t.addEventListener("pause",this.onPlayStop.bind(this)))};n.VideoTexture.prototype=Object.create(n.BaseTexture.prototype);n.VideoTexture.constructor=n.VideoTexture;n.VideoTexture.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this.updateBound),this.dirty())};n.VideoTexture.prototype.onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this.updateBound),this.autoUpdate=!0)};n.VideoTexture.prototype.onPlayStop=function(){this.autoUpdate=!1};n.VideoTexture.prototype.onCanPlay=function(){"canplaythrough"===event.type&&(this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.dispatchEvent({type:"loaded",content:this}))))};n.VideoTexture.prototype.destroy=function(){this.source&&this.source._pixiId&&(n.BaseTextureCache[this.source._pixiId]=null,delete n.BaseTextureCache[this.source._pixiId],this.source._pixiId=null,delete this.source._pixiId);n.BaseTexture.prototype.destroy.call(this)};n.VideoTexture.baseTextureFromVideo=function(t,i){t._pixiId||(t._pixiId="video_"+n.TextureCacheIdGenerator++);var r=n.BaseTextureCache[t._pixiId];return r||(r=new n.VideoTexture(t,i),n.BaseTextureCache[t._pixiId]=r),r};n.VideoTexture.textureFromVideo=function(t,i){var r=n.VideoTexture.baseTextureFromVideo(t,i);return new n.Texture(r)};n.VideoTexture.fromUrl=function(t,i){var r=document.createElement("video");return r.src=t,r.autoPlay=!0,r.play(),n.VideoTexture.textureFromVideo(r,i)};n.AssetLoader=function(t,i){this.assetURLs=t;this.crossorigin=i;this.loadersByType={jpg:n.ImageLoader,jpeg:n.ImageLoader,png:n.ImageLoader,gif:n.ImageLoader,webp:n.ImageLoader,json:n.JsonLoader,atlas:n.AtlasLoader,anim:n.SpineLoader,xml:n.BitmapFontLoader,fnt:n.BitmapFontLoader}};n.EventTarget.mixin(n.AssetLoader.prototype);n.AssetLoader.prototype.constructor=n.AssetLoader;n.AssetLoader.prototype._getDataType=function(n){var i="data:",f=n.slice(0,i.length).toLowerCase(),r,u,t;return f===i?(r=n.slice(i.length),u=r.indexOf(","),-1===u)?null:(t=r.slice(0,u).split(";")[0],t&&"text/plain"!==t.toLowerCase()?t.split("/").pop().toLowerCase():"txt"):null};n.AssetLoader.prototype.load=function(){function f(n){e.onAssetLoaded(n.data.content)}var e=this,t,i,n,r,u;for(this.loadCount=this.assetURLs.length,t=0;t<this.assetURLs.length;t++){if(i=this.assetURLs[t],n=this._getDataType(i),n||(n=i.split("?").shift().split(".").pop().toLowerCase()),r=this.loadersByType[n],!r)throw new Error(n+" is an unsupported file type");u=new r(i,this.crossorigin);u.on("loaded",f);u.load()}};n.AssetLoader.prototype.onAssetLoaded=function(n){this.loadCount--;this.emit("onProgress",{content:this,loader:n});this.onProgress&&this.onProgress(n);this.loadCount||(this.emit("onComplete",{content:this}),this.onComplete&&this.onComplete())};n.JsonLoader=function(n,t){this.url=n;this.crossorigin=t;this.baseUrl=n.replace(/[^\/]*$/,"");this.loaded=!1};n.JsonLoader.prototype.constructor=n.JsonLoader;n.EventTarget.mixin(n.JsonLoader.prototype);n.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){},this.ajaxRequest.onload=this.onJSONLoaded.bind(this)):(this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onreadystatechange=this.onReadyStateChanged.bind(this));this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.send()};n.JsonLoader.prototype.onReadyStateChanged=function(){4!==this.ajaxRequest.readyState||200!==this.ajaxRequest.status&&-1!==window.location.href.indexOf("http")||this.onJSONLoaded()};n.JsonLoader.prototype.onJSONLoaded=function(){var r,u,o,s;if(!this.ajaxRequest.responseText)return this.onError(),void 0;if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var a=this.baseUrl+this.json.meta.image,e=new n.ImageLoader(a,this.crossorigin),f=this.json.frames;this.texture=e.texture.baseTexture;e.addEventListener("loaded",this.onLoaded.bind(this));for(r in f)if(u=f[r].frame,u){var c=new n.Rectangle(u.x,u.y,u.w,u.h),v=c.clone(),l=null;f[r].trimmed&&(o=f[r].sourceSize,s=f[r].spriteSourceSize,l=new n.Rectangle(s.x,s.y,o.w,o.h));n.TextureCache[r]=new n.Texture(this.texture,c,v,l)}e.load()}else if(this.json.bones)if(n.AnimCache[this.url])this.onLoaded();else{var y=this.url.substr(0,this.url.lastIndexOf("."))+".atlas",h=new n.JsonLoader(y,this.crossorigin),i=this;h.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return this.onError(),void 0;var r=new n.SpineTextureLoader(this.url.substring(0,this.url.lastIndexOf("/"))),u=new t.Atlas(this.ajaxRequest.responseText,r),e=new t.AtlasAttachmentLoader(u),o=new t.SkeletonJson(e),f=o.readSkeletonData(i.json);n.AnimCache[i.url]=f;i.spine=f;i.spineAtlas=u;i.spineAtlasLoader=h;r.loadingCount>0?r.addEventListener("loadedBaseTexture",function(n){n.content.content.loadingCount<=0&&i.onLoaded()}):i.onLoaded()};h.load()}else this.onLoaded()};n.JsonLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};n.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};n.AtlasLoader=function(n,t){this.url=n;this.baseUrl=n.replace(/[^\/]*$/,"");this.crossorigin=t;this.loaded=!1};n.AtlasLoader.constructor=n.AtlasLoader;n.EventTarget.mixin(n.AtlasLoader.prototype);n.AtlasLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this);this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};n.AtlasLoader.prototype.onAtlasLoaded=function(){var e,h,a,s,o;if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};for(var u=this.ajaxRequest.responseText.split(/\r?\n/),f=-3,c=0,i=null,l=!1,t=0,r=0,v=this.onLoaded.bind(this),t=0;t<u.length;t++)(u[t]=u[t].replace(/^\s+|\s+$/g,""),""===u[t]&&(l=t+1),u[t].length>0)&&(l===t?(this.atlas.meta.image.push(u[t]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),f=-3):f>0&&(f%7==1?(null!=i&&(this.atlas.frames[c][i.name]=i),i={name:u[t],frame:{}}):(e=u[t].split(" "),f%7==3?(i.frame.x=Number(e[1].replace(",","")),i.frame.y=Number(e[2])):f%7==4?(i.frame.w=Number(e[1].replace(",","")),i.frame.h=Number(e[2])):f%7==5&&(h={x:0,y:0,w:Number(e[1].replace(",","")),h:Number(e[2])},h.w>i.frame.w||h.h>i.frame.h?(i.trimmed=!0,i.realSize=h):i.trimmed=!1))),f++);if(null!=i&&(this.atlas.frames[c][i.name]=i),this.atlas.meta.image.length>0){for(this.images=[],r=0;r<this.atlas.meta.image.length;r++){a=this.baseUrl+this.atlas.meta.image[r];s=this.atlas.frames[r];this.images.push(new n.ImageLoader(a,this.crossorigin));for(t in s)o=s[t].frame,o&&(n.TextureCache[t]=new n.Texture(this.images[r].texture.baseTexture,{x:o.x,y:o.y,width:o.w,height:o.h}),s[t].trimmed&&(n.TextureCache[t].realSize=s[t].realSize,n.TextureCache[t].trim.x=0,n.TextureCache[t].trim.y=0))}for(this.currentImageId=0,r=0;r<this.images.length;r++)this.images[r].on("loaded",v);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()};n.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.emit("loaded",{content:this}))};n.AtlasLoader.prototype.onError=function(){this.emit("error",{content:this})};n.SpriteSheetLoader=function(n,t){this.url=n;this.crossorigin=t;this.baseUrl=n.replace(/[^\/]*$/,"");this.texture=null;this.frames={}};n.SpriteSheetLoader.prototype.constructor=n.SpriteSheetLoader;n.EventTarget.mixin(n.SpriteSheetLoader.prototype);n.SpriteSheetLoader.prototype.load=function(){var t=this,i=new n.JsonLoader(this.url,this.crossorigin);i.on("loaded",function(n){t.json=n.data.content.json;t.onLoaded()});i.load()};n.SpriteSheetLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};n.ImageLoader=function(t,i){this.texture=n.Texture.fromImage(t,i);this.frames=[]};n.ImageLoader.prototype.constructor=n.ImageLoader;n.EventTarget.mixin(n.ImageLoader.prototype);n.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.on("loaded",this.onLoaded.bind(this))};n.ImageLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};n.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,r){var u,e;this.frames=[];for(var s=Math.floor(this.texture.width/t),h=Math.floor(this.texture.height/i),o=0,f=0;h>f;f++)for(u=0;s>u;u++,o++)e=new n.Texture(this.texture.baseTexture,{x:u*t,y:f*i,width:t,height:i}),this.frames.push(e),r&&(n.TextureCache[r+"-"+o]=e);this.load()};n.BitmapFontLoader=function(n,t){this.url=n;this.crossorigin=t;this.baseUrl=n.replace(/[^\/]*$/,"");this.texture=null};n.BitmapFontLoader.prototype.constructor=n.BitmapFontLoader;n.EventTarget.mixin(n.BitmapFontLoader.prototype);n.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this);this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml");this.ajaxRequest.send(null)};n.BitmapFontLoader.prototype.onXMLLoaded=function(){var r,h,o,c,e,i,t,s,a,f;if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){r=this.ajaxRequest.responseXML;(!r||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)&&("function"==typeof DOMParser?(h=new DOMParser,r=h.parseFromString(this.ajaxRequest.responseText,"text/xml")):(o=document.createElement("div"),o.innerHTML=this.ajaxRequest.responseText,r=o));c=this.baseUrl+r.getElementsByTagName("page")[0].getAttribute("file");e=new n.ImageLoader(c,this.crossorigin);this.texture=e.texture.baseTexture;var u={},l=r.getElementsByTagName("info")[0],v=r.getElementsByTagName("common")[0];for(u.font=l.getAttribute("face"),u.size=parseInt(l.getAttribute("size"),10),u.lineHeight=parseInt(v.getAttribute("lineHeight"),10),u.chars={},i=r.getElementsByTagName("char"),t=0;t<i.length;t++)s=parseInt(i[t].getAttribute("id"),10),a=new n.Rectangle(parseInt(i[t].getAttribute("x"),10),parseInt(i[t].getAttribute("y"),10),parseInt(i[t].getAttribute("width"),10),parseInt(i[t].getAttribute("height"),10)),u.chars[s]={xOffset:parseInt(i[t].getAttribute("xoffset"),10),yOffset:parseInt(i[t].getAttribute("yoffset"),10),xAdvance:parseInt(i[t].getAttribute("xadvance"),10),kerning:{},texture:n.TextureCache[s]=new n.Texture(this.texture,a)};for(f=r.getElementsByTagName("kerning"),t=0;t<f.length;t++){var y=parseInt(f[t].getAttribute("first"),10),p=parseInt(f[t].getAttribute("second"),10),w=parseInt(f[t].getAttribute("amount"),10);u.chars[p].kerning[y]=w}n.BitmapText.fonts[u.font]=u;e.addEventListener("loaded",this.onLoaded.bind(this));e.load()}};n.BitmapFontLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};n.SpineLoader=function(n,t){this.url=n;this.crossorigin=t;this.loaded=!1};n.SpineLoader.prototype.constructor=n.SpineLoader;n.EventTarget.mixin(n.SpineLoader.prototype);n.SpineLoader.prototype.load=function(){var t=this,i=new n.JsonLoader(this.url,this.crossorigin);i.on("loaded",function(n){t.json=n.data.content.json;t.onLoaded()});i.load()};n.SpineLoader.prototype.onLoaded=function(){this.loaded=!0;this.emit("loaded",{content:this})};n.AbstractFilter=function(n,t){this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.uniforms=t||{};this.fragmentSrc=n||[]};n.AbstractFilter.prototype.constructor=n.AbstractFilter;n.AbstractFilter.prototype.syncUniforms=function(){for(var n=0,t=this.shaders.length;t>n;n++)this.shaders[n].dirty=!0};n.AlphaMaskFilter=function(t){n.AbstractFilter.call(this);this.passes=[this];t.baseTexture._powerOf2=!0;this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction));this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]};n.AlphaMaskFilter.prototype=Object.create(n.AbstractFilter.prototype);n.AlphaMaskFilter.prototype.constructor=n.AlphaMaskFilter;n.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height;this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(n.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(n){this.uniforms.mask.value=n}});n.ColorMatrixFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]};n.ColorMatrixFilter.prototype=Object.create(n.AbstractFilter.prototype);n.ColorMatrixFilter.prototype.constructor=n.ColorMatrixFilter;Object.defineProperty(n.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(n){this.uniforms.matrix.value=n}});n.GrayFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={gray:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]};n.GrayFilter.prototype=Object.create(n.AbstractFilter.prototype);n.GrayFilter.prototype.constructor=n.GrayFilter;Object.defineProperty(n.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(n){this.uniforms.gray.value=n}});n.DisplacementFilter=function(t){n.AbstractFilter.call(this);this.passes=[this];t.baseTexture._powerOf2=!0;this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction));this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]};n.DisplacementFilter.prototype=Object.create(n.AbstractFilter.prototype);n.DisplacementFilter.prototype.constructor=n.DisplacementFilter;n.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height;this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(n.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(n){this.uniforms.displacementMap.value=n}});Object.defineProperty(n.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(n){this.uniforms.scale.value=n}});Object.defineProperty(n.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(n){this.uniforms.offset.value=n}});n.PixelateFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new n.Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]};n.PixelateFilter.prototype=Object.create(n.AbstractFilter.prototype);n.PixelateFilter.prototype.constructor=n.PixelateFilter;Object.defineProperty(n.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(n){this.dirty=!0;this.uniforms.pixelSize.value=n}});n.BlurXFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]};n.BlurXFilter.prototype=Object.create(n.AbstractFilter.prototype);n.BlurXFilter.prototype.constructor=n.BlurXFilter;Object.defineProperty(n.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.dirty=!0;this.uniforms.blur.value=1/7e3*n}});n.BlurYFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]};n.BlurYFilter.prototype=Object.create(n.AbstractFilter.prototype);n.BlurYFilter.prototype.constructor=n.BlurYFilter;Object.defineProperty(n.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.uniforms.blur.value=1/7e3*n}});n.BlurFilter=function(){this.blurXFilter=new n.BlurXFilter;this.blurYFilter=new n.BlurYFilter;this.passes=[this.blurXFilter,this.blurYFilter]};n.BlurFilter.prototype=Object.create(n.AbstractFilter.prototype);n.BlurFilter.prototype.constructor=n.BlurFilter;Object.defineProperty(n.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(n){this.blurXFilter.blur=this.blurYFilter.blur=n}});Object.defineProperty(n.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(n){this.blurXFilter.blur=n}});Object.defineProperty(n.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(n){this.blurYFilter.blur=n}});n.InvertFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]};n.InvertFilter.prototype=Object.create(n.AbstractFilter.prototype);n.InvertFilter.prototype.constructor=n.InvertFilter;Object.defineProperty(n.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(n){this.uniforms.invert.value=n}});n.SepiaFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={sepia:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]};n.SepiaFilter.prototype=Object.create(n.AbstractFilter.prototype);n.SepiaFilter.prototype.constructor=n.SepiaFilter;Object.defineProperty(n.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(n){this.uniforms.sepia.value=n}});n.TwistFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]};n.TwistFilter.prototype=Object.create(n.AbstractFilter.prototype);n.TwistFilter.prototype.constructor=n.TwistFilter;Object.defineProperty(n.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(n){this.dirty=!0;this.uniforms.offset.value=n}});Object.defineProperty(n.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(n){this.dirty=!0;this.uniforms.radius.value=n}});Object.defineProperty(n.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(n){this.dirty=!0;this.uniforms.angle.value=n}});n.ColorStepFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={step:{type:"1f",value:5}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]};n.ColorStepFilter.prototype=Object.create(n.AbstractFilter.prototype);n.ColorStepFilter.prototype.constructor=n.ColorStepFilter;Object.defineProperty(n.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(n){this.uniforms.step.value=n}});n.DotScreenFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]};n.DotScreenFilter.prototype=Object.create(n.AbstractFilter.prototype);n.DotScreenFilter.prototype.constructor=n.DotScreenFilter;Object.defineProperty(n.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(n){this.dirty=!0;this.uniforms.scale.value=n}});Object.defineProperty(n.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(n){this.dirty=!0;this.uniforms.angle.value=n}});n.CrossHatchFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]};n.CrossHatchFilter.prototype=Object.create(n.AbstractFilter.prototype);n.CrossHatchFilter.prototype.constructor=n.CrossHatchFilter;Object.defineProperty(n.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.uniforms.blur.value=1/7e3*n}});n.RGBSplitFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]};n.RGBSplitFilter.prototype=Object.create(n.AbstractFilter.prototype);n.RGBSplitFilter.prototype.constructor=n.RGBSplitFilter;Object.defineProperty(n.RGBSplitFilter.prototype,"red",{get:function(){return this.uniforms.red.value},set:function(n){this.uniforms.red.value=n}});Object.defineProperty(n.RGBSplitFilter.prototype,"green",{get:function(){return this.uniforms.green.value},set:function(n){this.uniforms.green.value=n}});Object.defineProperty(n.RGBSplitFilter.prototype,"blue",{get:function(){return this.uniforms.blue.value},set:function(n){this.uniforms.blue.value=n}});"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports.PIXI=n):"undefined"!=typeof define&&define.amd?define(n):i.PIXI=n}).call(this),function(){"use strict";var u=this,r,n,s,t,f,h;r=typeof exports!="undefined"?exports:u.Springy={};var i=r.Graph=function(){this.nodeSet={};this.nodes=[];this.edges=[];this.adjacency={};this.nextNodeId=0;this.nextEdgeId=0;this.eventListeners=[]},e=r.Node=function(n,t){this.id=n;this.data=t!==undefined?t:{}},o=r.Edge=function(n,t,i,r){this.id=n;this.source=t;this.target=i;this.data=r!==undefined?r:{}};i.prototype.addNode=function(n){return n.id in this.nodeSet||this.nodes.push(n),this.nodeSet[n.id]=n,this.notify(),n};i.prototype.addNodes=function(){for(var t,i,n=0;n<arguments.length;n++)t=arguments[n],i=new e(t,{label:t}),this.addNode(i)};i.prototype.addEdge=function(n){var t=!1;return this.edges.forEach(function(i){n.id===i.id&&(t=!0)}),t||this.edges.push(n),n.source.id in this.adjacency||(this.adjacency[n.source.id]={}),n.target.id in this.adjacency[n.source.id]||(this.adjacency[n.source.id][n.target.id]=[]),t=!1,this.adjacency[n.source.id][n.target.id].forEach(function(i){n.id===i.id&&(t=!0)}),t||this.adjacency[n.source.id][n.target.id].push(n),this.notify(),n};i.prototype.addEdges=function(){for(var n,i,r,u,t=0;t<arguments.length;t++){if(n=arguments[t],i=this.nodeSet[n[0]],i==undefined)throw new TypeError("invalid node name: "+n[0]);if(r=this.nodeSet[n[1]],r==undefined)throw new TypeError("invalid node name: "+n[1]);u=n[2];this.newEdge(i,r,u)}};i.prototype.newNode=function(n){var t=new e(this.nextNodeId++,n);return this.addNode(t),t};i.prototype.newEdge=function(n,t,i){var r=new o(this.nextEdgeId++,n,t,i);return this.addEdge(r),r};i.prototype.loadJSON=function(n){(typeof n=="string"||n instanceof String)&&(n=JSON.parse(n));("nodes"in n||"edges"in n)&&(this.addNodes.apply(this,n.nodes),this.addEdges.apply(this,n.edges))};i.prototype.getEdges=function(n,t){return n.id in this.adjacency&&t.id in this.adjacency[n.id]?this.adjacency[n.id][t.id]:[]};i.prototype.removeNode=function(n){n.id in this.nodeSet&&delete this.nodeSet[n.id];for(var t=this.nodes.length-1;t>=0;t--)this.nodes[t].id===n.id&&this.nodes.splice(t,1);this.detachNode(n)};i.prototype.detachNode=function(n){var t=this.edges.slice();t.forEach(function(t){(t.source.id===n.id||t.target.id===n.id)&&this.removeEdge(t)},this);this.notify()};i.prototype.removeEdge=function(n){for(var t,i,f,u,r=this.edges.length-1;r>=0;r--)this.edges[r].id===n.id&&this.edges.splice(r,1);for(t in this.adjacency){for(i in this.adjacency[t]){for(f=this.adjacency[t][i],u=f.length-1;u>=0;u--)this.adjacency[t][i][u].id===n.id&&this.adjacency[t][i].splice(u,1);this.adjacency[t][i].length==0&&delete this.adjacency[t][i]}h(this.adjacency[t])&&delete this.adjacency[t]}this.notify()};i.prototype.merge=function(n){var t=[];n.nodes.forEach(function(n){t.push(this.addNode(new e(n.id,n.data)))},this);n.edges.forEach(function(n){var i=t[n.from],r=t[n.to],u=n.directed?u=n.type+"-"+i.id+"-"+r.id:i.id<r.id?n.type+"-"+i.id+"-"+r.id:n.type+"-"+r.id+"-"+i.id,f=this.addEdge(new o(u,i,r,n.data));f.data.type=n.type},this)};i.prototype.filterNodes=function(n){var t=this.nodes.slice();t.forEach(function(t){n(t)||this.removeNode(t)},this)};i.prototype.filterEdges=function(n){var t=this.edges.slice();t.forEach(function(t){n(t)||this.removeEdge(t)},this)};i.prototype.addGraphListener=function(n){this.eventListeners.push(n)};i.prototype.notify=function(){this.eventListeners.forEach(function(n){n.graphChanged()})};n=r.Layout={};n.ForceDirected=function(n,t,i,r){this.graph=n;this.stiffness=t;this.repulsion=i;this.damping=r;this.nodePoints={};this.edgeSprings={}};n.ForceDirected.prototype.point=function(i){if(!(i.id in this.nodePoints)){var r=i.data.mass!==undefined?i.data.mass:1;this.nodePoints[i.id]=new n.ForceDirected.Point(t.random(),r)}return this.nodePoints[i.id]};n.ForceDirected.prototype.spring=function(t){var f;if(!(t.id in this.edgeSprings)){var u=t.data.length!==undefined?t.data.length:1,i=!1,r=this.graph.getEdges(t.source,t.target);if(r.forEach(function(n){i===!1&&n.id in this.edgeSprings&&(i=this.edgeSprings[n.id])},this),i!==!1)return new n.ForceDirected.Spring(i.point1,i.point2,0,0);if(f=this.graph.getEdges(t.target,t.source),r.forEach(function(n){i===!1&&n.id in this.edgeSprings&&(i=this.edgeSprings[n.id])},this),i!==!1)return new n.ForceDirected.Spring(i.point2,i.point1,0,0);this.edgeSprings[t.id]=new n.ForceDirected.Spring(this.point(t.source),this.point(t.target),u,this.stiffness)}return this.edgeSprings[t.id]};n.ForceDirected.prototype.eachNode=function(n){var t=this;this.graph.nodes.forEach(function(i){n.call(t,i,t.point(i))})};n.ForceDirected.prototype.eachEdge=function(n){var t=this;this.graph.edges.forEach(function(i){n.call(t,i,t.spring(i))})};n.ForceDirected.prototype.eachSpring=function(n){var t=this;this.graph.edges.forEach(function(i){n.call(t,t.spring(i))})};n.ForceDirected.prototype.applyCoulombsLaw=function(){this.eachNode(function(n,t){this.eachNode(function(n,i){if(t!==i){var u=t.p.subtract(i.p),r=u.magnitude()+.1,f=u.normalise();t.applyForce(f.multiply(this.repulsion).divide(r*r*.5));i.applyForce(f.multiply(this.repulsion).divide(r*r*-.5))}})})};n.ForceDirected.prototype.applyHookesLaw=function(){this.eachSpring(function(n){var t=n.point2.p.subtract(n.point1.p),i=n.length-t.magnitude(),r=t.normalise();n.point1.applyForce(r.multiply(n.k*i*-.5));n.point2.applyForce(r.multiply(n.k*i*.5))})};n.ForceDirected.prototype.attractToCentre=function(){this.eachNode(function(n,t){var i=t.p.multiply(-1);t.applyForce(i.multiply(this.repulsion/50))})};n.ForceDirected.prototype.updateVelocity=function(n){this.eachNode(function(i,r){r.v=r.v.add(r.a.multiply(n)).multiply(this.damping);r.a=new t(0,0)})};n.ForceDirected.prototype.updatePosition=function(n){this.eachNode(function(t,i){i.p=i.p.add(i.v.multiply(n))})};n.ForceDirected.prototype.totalEnergy=function(){var n=0;return this.eachNode(function(t,i){var r=i.v.magnitude();n+=.5*i.m*r*r}),n};s=function(n,t){return function(){return n.apply(t,arguments)}};r.requestAnimationFrame=s(u.requestAnimationFrame||u.webkitRequestAnimationFrame||u.mozRequestAnimationFrame||u.oRequestAnimationFrame||u.msRequestAnimationFrame||function(n){u.setTimeout(n,10)},u);n.ForceDirected.prototype.start=function(n,t,i){var u=this;this._started||(this._started=!0,this._stop=!1,i!==undefined&&i(),r.requestAnimationFrame(function f(){u.applyCoulombsLaw();u.applyHookesLaw();u.attractToCentre();u.updateVelocity(.03);u.updatePosition(.03);n!==undefined&&n();u._stop||u.totalEnergy()<.01?(u._started=!1,t!==undefined&&t()):r.requestAnimationFrame(f)}))};n.ForceDirected.prototype.stop=function(){this._stop=!0};n.ForceDirected.prototype.nearest=function(n){var t={node:null,point:null,distance:null},i=this;return this.graph.nodes.forEach(function(r){var u=i.point(r),f=u.p.subtract(n).magnitude();(t.distance===null||f<t.distance)&&(t={node:r,point:u,distance:f})}),t};n.ForceDirected.prototype.getBoundingBox=function(){var n=new t(-2,-2),i=new t(2,2),r;return this.eachNode(function(t,r){r.p.x<n.x&&(n.x=r.p.x);r.p.y<n.y&&(n.y=r.p.y);r.p.x>i.x&&(i.x=r.p.x);r.p.y>i.y&&(i.y=r.p.y)}),r=i.subtract(n).multiply(.07),{bottomleft:n.subtract(r),topright:i.add(r)}};t=r.Vector=function(n,t){this.x=n;this.y=t};t.random=function(){return new t(10*(Math.random()-.5),10*(Math.random()-.5))};t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)};t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y)};t.prototype.multiply=function(n){return new t(this.x*n,this.y*n)};t.prototype.divide=function(n){return new t(this.x/n||0,this.y/n||0)};t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};t.prototype.normal=function(){return new t(-this.y,this.x)};t.prototype.normalise=function(){return this.divide(this.magnitude())};n.ForceDirected.Point=function(n,i){this.p=n;this.m=i;this.v=new t(0,0);this.a=new t(0,0)};n.ForceDirected.Point.prototype.applyForce=function(n){this.a=this.a.add(n.divide(this.m))};n.ForceDirected.Spring=function(n,t,i,r){this.point1=n;this.point2=t;this.length=i;this.k=r};f=r.Renderer=function(n,t,i,r,u,f){this.layout=n;this.clear=t;this.drawEdge=i;this.drawNode=r;this.onRenderStop=u;this.onRenderStart=f;this.layout.graph.addGraphListener(this)};f.prototype.graphChanged=function(){this.start()};f.prototype.start=function(){var n=this;this.layout.start(function(){n.clear();n.layout.eachEdge(function(t,i){n.drawEdge(t,i.point1.p,i.point2.p)});n.layout.eachNode(function(t,i){n.drawNode(t,i.p)})},this.onRenderStart,this.onRenderStop)};f.prototype.stop=function(){this.layout.stop()};Array.prototype.forEach||(Array.prototype.forEach=function(n,t){var u,i,r,f,e;if(this==null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,{}.toString.call(n)!="[object Function]")throw new TypeError(n+" is not a function");for(t&&(u=t),i=0;i<f;)i in r&&(e=r[i],n.call(u,e,i,r)),i++});h=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}}.call(this),function(){jQuery.fn.springy=function(n){function c(n,t,i,r){var f=(r.y-i.y)*(t.x-n.x)-(r.x-i.x)*(t.y-n.y),u,e;return f===0?!1:(u=((r.x-i.x)*(n.y-i.y)-(r.y-i.y)*(n.x-i.x))/f,e=((t.x-n.x)*(n.y-i.y)-(t.y-n.y)*(n.x-i.x))/f,u<0||u>1||e<0||e>1)?!1:new Springy.Vector(n.x+u*(t.x-n.x),n.y+u*(t.y-n.y))}function et(n,t,i,r,u){var e={x:i.x,y:i.y},o={x:i.x+r,y:i.y},s={x:i.x,y:i.y+u},h={x:i.x+r,y:i.y+u},f;return(f=c(n,t,e,o))?f:(f=c(n,t,o,h))?f:(f=c(n,t,h,s))?f:(f=c(n,t,s,e))?f:!1}var l=this.graph=n.graph||new Springy.Graph,y="12px Verdana, sans-serif",b="12px Verdana, sans-serif",k=n.stiffness||400,d=n.repulsion||400,g=n.damping||.5,p=n.nodeSelected||null,r={},nt=!0,u=this[0],t=u.getContext("2d"),o=this.layout=new Springy.Layout.ForceDirected(l,k,d,g),i=o.getBoundingBox(),a={bottomleft:new Springy.Vector(-2,-2),topright:new Springy.Vector(2,2)},h;Springy.requestAnimationFrame(function tt(){a=o.getBoundingBox();i={bottomleft:i.bottomleft.add(a.bottomleft.subtract(i.bottomleft).divide(10)),topright:i.topright.add(a.topright.subtract(i.topright).divide(10))};Springy.requestAnimationFrame(tt)});var f=function(n){var t=i.topright.subtract(i.bottomleft),r=n.subtract(i.bottomleft).divide(t.x).x*u.width,f=n.subtract(i.bottomleft).divide(t.y).y*u.height;return new Springy.Vector(r,f)},v=function(n){var t=i.topright.subtract(i.bottomleft),r=n.x/u.width*t.x+i.bottomleft.x,f=n.y/u.height*t.y+i.bottomleft.y;return new Springy.Vector(r,f)},s=null,w=null,e=null;jQuery(u).mousedown(function(n){var t=jQuery(this).offset(),i=v({x:n.pageX-t.left,y:n.pageY-t.top});s=w=e=o.nearest(i);s.node!==null&&(e.point.m=1e4,p&&p(s.node));h.start()});jQuery(u).dblclick(function(n){var t=jQuery(this).offset(),i=v({x:n.pageX-t.left,y:n.pageY-t.top});s=o.nearest(i);node=s.node;node&&node.data&&node.data.ondoubleclick&&node.data.ondoubleclick()});jQuery(u).mousemove(function(n){var i=jQuery(this).offset(),t=v({x:n.pageX-i.left,y:n.pageY-i.top});w=o.nearest(t);e!==null&&e.node!==null&&(e.point.p.x=t.x,e.point.p.y=t.y);h.start()});jQuery(window).bind("mouseup",function(){e=null});var it=function(n){var i=n.data.label!==undefined?n.data.label:n.id,r;return n._width&&n._width[i]?n._width[i]:(t.save(),t.font=n.data.font!==undefined?n.data.font:y,r=t.measureText(i).width,t.restore(),n._width||(n._width={}),n._width[i]=r+5,r)},rt=function(){return 16},ut=function(n){return n.data.image.width!==undefined?n.data.image.width:r[n.data.image.src].object.width},ft=function(n){return n.data.image.height!==undefined?n.data.image.height:r[n.data.image.src].object.height};return Springy.Node.prototype.getHeight=function(){return this.data.image==undefined?rt(this):this.data.image.src in r&&r[this.data.image.src].loaded?ft(this):10},Springy.Node.prototype.getWidth=function(){return this.data.image==undefined?it(this):this.data.image.src in r&&r[this.data.image.src].loaded?ut(this):10},h=this.renderer=new Springy.Renderer(o,function(){t.clearRect(0,0,u.width,u.height)},function(n,i,r){for(var a,k,s,vt,d,g,h,tt,it,v,rt=f(i).x,ut=f(i).y,y=f(r).x,p=f(r).y,ft=new Springy.Vector(y-rt,p-ut),ot=ft.normal().normalise(),w=l.getEdges(n.source,n.target),yt=l.getEdges(n.target,n.source),pt=w.length+yt.length,st=0,c=0;c<w.length;c++)w[c].id===n.id&&(st=c);var ht=8,ct=ot.multiply(-((pt-1)*ht)/2+st*ht),u=f(i).add(ct),e=f(r).add(ct),lt=n.target.getWidth()+6,at=n.target.getHeight()+6,o=et(u,e,{x:y-lt/2,y:p-at/2},lt,at);o||(o=e);a=n.data.color!==undefined?n.data.color:"#000000";vt=n.data.weight!==undefined?n.data.weight:1;t.lineWidth=Math.max(vt*2,.1);k=1+t.lineWidth;s=8;d=n.data.directional!==undefined?n.data.directional:!0;g=d?o.subtract(ft.normalise().multiply(s*.5)):e;t.strokeStyle=a;t.beginPath();t.moveTo(u.x,u.y);t.lineTo(g.x,g.y);t.stroke();d&&(t.save(),t.fillStyle=a,t.translate(o.x,o.y),t.rotate(Math.atan2(p-ut,y-rt)),t.beginPath(),t.moveTo(-s,k),t.lineTo(0,0),t.lineTo(-s,-k),t.lineTo(-s*.8,-0),t.closePath(),t.fill(),t.restore());n.data.label!==undefined&&(text=n.data.label,t.save(),t.textAlign="center",t.textBaseline="top",t.font=n.data.font!==undefined?n.data.font:b,t.fillStyle=a,h=Math.atan2(e.y-u.y,e.x-u.x),tt=-12,nt&&(h>Math.PI/2||h<-Math.PI/2)&&(tt=12,h+=Math.PI),it=u.add(e).divide(2).add(ot.multiply(tt)),t.translate(it.x,it.y),t.rotate(h),v="#444",n.data.hasOwnProperty("textColor")?v=n.data.textColor:n.data.hasOwnProperty("color")&&(v=n.data.color),t.fillStyle=v,t.fillText(text,0,-2),t.restore())},function(n,i){var u=f(i),a,e,l;t.save();var h=n.getWidth(),c=n.getHeight(),o=h+6,s=c+6;t.clearRect(u.x-o/2,u.y-s/2,o,s);t.fillStyle=n.data.color!==undefined?n.data.color:"#fff";t.strokeStyle="#444";t.lineWidth=1;t.fillRect(u.x-o/2,u.y-s/2,o,s);t.strokeRect(u.x-o/2,u.y-s/2,o,s);n.data.image==undefined?(t.textAlign="left",t.textBaseline="top",t.font=n.data.font!==undefined?n.data.font:y,t.fillStyle="#000000",a=n.data.label!==undefined?n.data.label:n.id,t.fillText(a,u.x-h/2,u.y-c/2)):(e=n.data.image.src,e in r?r[e].loaded&&t.drawImage(r[e].object,u.x-h/2,u.y-c/2,h,c):(r[e]={},l=new Image,r[e].object=l,l.addEventListener("load",function(){r[e].loaded=!0}),l.src=e));t.restore()}),h.start(),this}}(),function(n){"use strict";var t={};t.version="1.1.0";t.author="max huang";n.obelisk=t}(window),function(n){"use strict";var i,t;i=function(){this.initialize()};t=i.prototype;t.inner=null;t.border=null;t.borderHighlight=null;t.left=null;t.right=null;t.horizontal=null;t.leftSlope=null;t.rightSlope=null;t.initialize=function(){return this};t.toString=function(){return"[AbstractColor]"};n.AbstractColor=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r,u){this.initialize(n,t,i,r,u)};t=i.prototype=new n.AbstractColor;t.BRIGHTNESS_GAIN=-20;t.initialize=function(t,i,r,u,f){return this.border=n.ColorGeom.get32(t===undefined?8882055:t),this.borderHighlight=n.ColorGeom.get32(i===undefined?16777215:i),this.left=n.ColorGeom.get32(r===undefined?13225936:r),this.right=n.ColorGeom.get32(u===undefined?14935011:u),this.horizontal=n.ColorGeom.get32(f===undefined?15658992:f),this};t.getByHorizontalColor=function(t){return new i(n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*4),n.ColorGeom.applyBrightness(t,0,!0),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*2),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN),t)};t.toString=function(){return"[CubeColor]"};n.CubeColor=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractColor;t.BRIGHTNESS_GAIN=-20;t.initialize=function(t,i,r,u){return this.border=n.ColorGeom.get32(t===undefined?9737880:t),this.borderHighlight=n.ColorGeom.get32(i===undefined?16777215:i),this.left=n.ColorGeom.get32(r===undefined?15132905:r),this.right=n.ColorGeom.get32(u===undefined?15658992:u),this};t.getByRightColor=function(t){return new i(n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*4),n.ColorGeom.applyBrightness(t,0,!0),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN),t)};t.toString=function(){return"[PyramidColor]"};n.PyramidColor=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t){this.initialize(n,t)};t=i.prototype=new n.AbstractColor;t.BRIGHTNESS_GAIN=-20;t.initialize=function(t,i){return this.border=n.ColorGeom.get32(t===undefined?8882055:t),this.inner=n.ColorGeom.get32(i===undefined?15658734:i),this};t.getByInnerColor=function(t){return new n.SideColor(n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*4),t)};t.toString=function(){return"[SideColor]"};n.SideColor=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r,u,f){this.initialize(n,t,i,r,u,f)};t=i.prototype=new n.AbstractColor;t.BRIGHTNESS_GAIN=-20;t.initialize=function(t,i,r,u,f,e){return this.border=n.ColorGeom.get32(t===undefined?9737880:t),this.borderHighlight=n.ColorGeom.get32(i===undefined?16777215:i),this.left=n.ColorGeom.get32(r===undefined?13225936:r),this.right=n.ColorGeom.get32(u===undefined?15132905:u),this.leftSlope=n.ColorGeom.get32(f===undefined?14408667:f),this.rightSlope=n.ColorGeom.get32(e===undefined?14408667:e),this};t.getByHorizontalColor=function(t){return new n.SlopeColor(n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*4),n.ColorGeom.applyBrightness(t,0,!0),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*2),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*1.5),n.ColorGeom.applyBrightness(t,this.BRIGHTNESS_GAIN*.5))};t.toString=function(){return"[SlopeColor]"};n.SlopeColor=i}(obelisk),function(n){"use strict";var i,t;i=function(){this.initialize()};t=i.prototype;t.xAxis=null;t.yAxis=null;t.zAxis=null;t.tall=!1;t.initialize=function(){return this};t.toString=function(){return"[AbstractDimension]"};n.AbstractDimension=i}(obelisk),function(n){"use strict";var t,i;t=function(n,t){this.initialize(n,t)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t){if(this.xAxis=n||30,this.yAxis=t||30,this.xAxis%2==1||this.yAxis%2==1)throw new Error("x,yAxis must be even number");if(this.xAxis<=4||this.yAxis<=4)throw new Error("dimension is too small");return this};i.toString=function(){return"[BrickDimension]"};n.BrickDimension=t}(obelisk),function(n){"use strict";var t,i;t=function(n,t,i){this.initialize(n,t,i)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t,i){if(this.xAxis=n||30,this.yAxis=t||30,this.zAxis=i||30,this.xAxis%2==1||this.yAxis%2==1)throw new Error("x,yAxis must be even number");if(this.xAxis<=4||this.yAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this};i.toString=function(){return"[CubeDimension]"};n.CubeDimension=t}(obelisk),function(n){"use strict";var t,i;t=function(n,t){this.initialize(n,t)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t){if(this.xAxis=n||30,this.yAxis=n||30,this.tall=t||!1,this.xAxis%2==1)throw new Error("axis must be even number");if(this.xAxis<=4)throw new Error("dimension is too small");return this};i.toString=function(){return"[PyramidDimension]"};n.PyramidDimension=t}(obelisk),function(n){"use strict";var t,i;t=function(n,t){this.initialize(n,t)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t){if(this.xAxis=n||30,this.zAxis=t||30,this.xAxis%2==1)throw new Error("xAxis must be even number");if(this.xAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this};i.toString=function(){return"[SideXDimension]"};n.SideXDimension=t}(obelisk),function(n){"use strict";var t,i;t=function(n,t){this.initialize(n,t)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t){if(this.yAxis=n||30,this.zAxis=t||30,this.yAxis%2==1)throw new Error("yAxis must be even number");if(this.yAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this};i.toString=function(){return"[SideYDimension]"};n.SideYDimension=t}(obelisk),function(n){"use strict";var t,i;t=function(n,t){this.initialize(n,t)};i=t.prototype=new n.AbstractDimension;i.initialize=function(n,t){if(this.xAxis=n||30,this.yAxis=t||30,this.xAxis%2==1||this.yAxis%2==1)throw new Error("xAxis and yAxis must be even number");if(this.xAxis<=4||this.yAxis<=4)throw new Error("dimension is too small");return this};i.toString=function(){return"[SlopeDimension]"};n.SlopeDimension=t}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i){this.initialize(n,t,i)};t=i.prototype;t.imageData=null;t.canvas=null;t.context=null;t.initialize=function(t,i,r){if(t===undefined||i===undefined)throw new Error("BitmapData width or height is missing");return this.canvas=r?n.CanvasManager.getDefaultCanvas():n.CanvasManager.getNewCanvas(),this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",i),this.context=this.canvas.getContext("2d"),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.imageData=this.context.createImageData(t,i),this};t.setPixel=function(n,t,i){var r=(t*this.imageData.width+n)*4;this.setPixelByIndex(r,i)};t.setPixelByIndex=function(n,t){var i=this.imageData.data;i[n]=t>>>16&255;i[n+1]=t>>>8&255;i[n+2]=t>>>0&255;i[n+3]=t>>>24&255};t.checkPixelAvailable=function(n,t){var i=(t*this.imageData.width+n)*4;return this.imageData.data[i+3]===0};t.floodFill=function(n,t,i){if((i>>>24&255)!=0){var l=n,e=t,h=[],f=[],s=[],u,r,a,v,c=this.imageData.width,p=this.imageData.height,o,y;if(!(l<0)&&!(e<0)&&!(l>=c)&&!(e>=p)){if(!this.checkPixelAvailable(l,e))throw new Error("Start point for flood fill is already filled");for(u=l;u>=0;u-=1){for(r=e;r>=0;r-=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else{if(r===e&&this.checkPixelAvailable(u+1,r-1))for(v=this.checkPixelAvailable(u,r-1)?r-1:this.checkPixelAvailable(u+1,r-2)?r-2:-1,r=v;r>=0;r-=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else break;break}for(r=e;r<p;r+=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else{if(r===e&&this.checkPixelAvailable(u+1,r+1))for(v=this.checkPixelAvailable(u,r+1)?r+1:this.checkPixelAvailable(u+1,r+2)?r+2:p,r=v;r<p;r+=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else break;break}for(u===l&&(s=f.concat()),a=!1,o=0;o<s.length;o+=1){for(y=0;y<s.length;y+=1)if(f[y]===s[o]){a=!0;e=s[o];break}if(a)break}if(a)s=f.concat(),f=[];else break}for(l=n,e=t,s=[],f=[],u=l;u<c;u+=1){for(r=e;r>=0;r-=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else{if(r===e&&this.checkPixelAvailable(u-1,r-1))for(v=this.checkPixelAvailable(u,r-1)?r-1:this.checkPixelAvailable(u-1,r-2)?r-2:-1,r=v;r>=0;r-=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else break;break}for(r=e;r<p;r+=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else{if(r===e&&this.checkPixelAvailable(u-1,r+1))for(v=this.checkPixelAvailable(u,r+1)?r+1:this.checkPixelAvailable(u-1,r+2)?r+2:p,r=v;r<p;r+=1)if(this.checkPixelAvailable(u,r))h.push((r*c+u)*4),f.push(r);else break;break}for(u===l&&(s=f.concat()),a=!1,o=0;o<s.length;o+=1){for(y=0;y<s.length;y+=1)if(f[y]===s[o]){a=!0;e=s[o];break}if(a)break}if(a)s=f.concat(),f=[];else break}for(o=0;o<h.length;o+=1)this.setPixelByIndex(h[o],i)}}};t.toString=function(){return"[BitmapData]"};n.BitmapData=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t){this.initialize(n,t)};t=i.prototype;t.x=null;t.y=null;t.canvas=null;t.initialize=function(t,i){if(!t)throw new Error("Primitive is not defined");var r=i||new n.Point3D;return this.canvas=t.canvas,this.x=t.matrix.tx+r.x-r.y,this.y=t.matrix.ty+Math.floor(r.x/2+r.y/2)-r.z,this};t.toString=function(){return"[PixelObject]"};n.PixelObject=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t){this.initialize(n,t)};t=i.prototype;t.canvas=null;t.context=null;t.point=null;t.initialize=function(t,i){if(!t)throw new Error("Canvas is not defined");try{t instanceof jQuery&&(t=t.get(0))}catch(r){}return this.canvas=t,this.context=this.canvas.getContext("2d"),this.point=i||new n.Point(0,0),this};t.renderObject=function(t,i){var r=new n.PixelObject(t,i);this.context.drawImage(r.canvas,this.point.x+r.x,this.point.y+r.y)};t.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};t.toString=function(){return"[PixelView]"};n.PixelView=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r,u,f){this.initialize(n,t,i,r,u,f)};t=i.prototype;t.a=1;t.b=0;t.c=0;t.d=1;t.tx=0;t.ty=0;t.initialize=function(n,t,i,r,u,f){return this.a=n===undefined?1:n,this.b=t||0,this.c=i||0,this.d=r===undefined?1:r,this.tx=u||0,this.ty=f||0,this};t.toString=function(){return"[Matrix]"};n.Matrix=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t){this.initialize(n,t)};t=i.prototype;t.x=0;t.y=0;t.initialize=function(n,t){return this.x=n===undefined?0:n,this.y=t===undefined?0:t,this};t.toString=function(){return"[Point x : "+this.x+", y : "+this.y+"]"};n.Point=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i){this.initialize(n,t,i)};t=i.prototype;t.x=0;t.y=0;t.z=0;t.initialize=function(n,t,i){return this.x=n===undefined?0:n,this.y=t===undefined?0:t,this.z=i===undefined?0:i,this};t.toGlobalCoordinates=function(t){var i=new n.Point(this.x-this.y,Math.floor(this.x/2+this.y/2)-this.z);return t!==undefined&&(i.x=i.x+t.x,i.y=i.y+t.y),i};t.toString=function(){return"[Point3D x : "+this.x+", y : "+this.y+", z: "+this.z+"]"};n.Point3D=i}(obelisk),function(n){"use strict";var i,t;i=function(){this.initialize()};t=i.prototype;t.canvas=null;t.w=null;t.h=null;t.dimension=null;t.color=null;t.border=null;t.bitmapData=null;t.useDefaultCanvas=null;t.matrix=null;t.initialize=function(){return this};t.toString=function(){return"[AbstractPrimitive]"};n.AbstractPrimitive=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.BrickDimension:t;this.color=i===undefined?new n.SideColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=(this.dimension.xAxis+this.dimension.yAxis)/2;this.w-=2;this.h-=1;this.matrix=new n.Matrix;this.matrix.tx=-this.dimension.yAxis+2;this.matrix.ty=0};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var r,u,f,e,n,t,i;for(r=this.dimension.yAxis-2,u=0,f=this.dimension.xAxis-1,e=this.h-1,i=this.border?this.color.border:this.color.inner,n=0;n<this.dimension.xAxis;n+=1)this.bitmapData.setPixel(r+n,u+Math.floor(n/2),i),this.bitmapData.setPixel(f-n,e-Math.floor(n/2),i);for(t=0;t<this.dimension.yAxis;t+=1)this.bitmapData.setPixel(r+1-t,u+Math.floor(t/2),i),this.bitmapData.setPixel(f-1+t,e-Math.floor(t/2),i);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)};t.toString=function(){return"[Brick]"};n.Brick=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.CubeDimension:t;this.color=i===undefined?new n.CubeColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.dimension.zAxis+(this.dimension.xAxis+this.dimension.yAxis)/2;this.w-=2;this.h-=1;this.matrix=new n.Matrix;this.matrix.tx=-this.dimension.yAxis+2;this.matrix.ty=-this.dimension.zAxis};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.canvas=this.bitmapData.canvas};t.build=function(){var l,a,v,e,r,c,u,i,o,s,t,f,h;if(l=new n.Brick(new n.BrickDimension(this.dimension.xAxis,this.dimension.yAxis),new n.SideColor(this.color.border,this.color.horizontal),this.border),a=new n.SideX(new n.SideXDimension(this.dimension.xAxis,this.dimension.zAxis),new n.SideColor(this.color.border,this.color.left),this.border),v=new n.SideY(new n.SideYDimension(this.dimension.yAxis,this.dimension.zAxis),new n.SideColor(this.color.border,this.color.right),this.border),e=new n.PixelObject(l),r=new n.PixelObject(a),c=new n.PixelObject(v),u=this.bitmapData.context,u.drawImage(e.canvas,e.x+this.dimension.yAxis-2,e.y),u.drawImage(r.canvas,r.x,r.y+this.dimension.zAxis+this.dimension.yAxis/2-1),u.drawImage(c.canvas,c.x+this.w-2,r.y+this.dimension.zAxis+this.dimension.xAxis/2-1),i=new n.BitmapData(this.w,this.h),this.border){for(o=this.dimension.xAxis-2,s=(this.dimension.xAxis+this.dimension.yAxis)/2-2,t=0;t<this.dimension.xAxis-2;t+=1)i.setPixel(o+1-t,s-Math.floor(t/2),this.color.borderHighlight);for(f=0;f<this.dimension.yAxis-2;f+=1)i.setPixel(o+f,s-Math.floor(f/2),this.color.borderHighlight);for(h=0;h<this.dimension.zAxis;h+=1)i.setPixel(o,s+h,this.color.borderHighlight)}else for(t=0;t<this.dimension.zAxis;t+=1)i.setPixel(this.dimension.xAxis-2,(this.dimension.xAxis+this.dimension.yAxis)/2-1+t,this.color.left);i.context.putImageData(i.imageData,0,0);u.drawImage(i.canvas,0,0)};t.toString=function(){return"[Cube]"};n.Cube=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.hSize=null;t.hOffset=null;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.PyramidDimension:t;this.color=i===undefined?new n.PyramidColor:i;this.hSize=this.dimension.tall?this.dimension.xAxis*2:this.dimension.xAxis;this.hOffset=this.dimension.tall?-3:-2};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.hSize+this.dimension.xAxis/2;this.w-=2;this.h+=this.hOffset;this.matrix=new n.Matrix;this.matrix.tx=-this.dimension.xAxis+2;this.matrix.ty=-this.hSize/2+2-(this.dimension.tall?this.dimension.xAxis/2:1)};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var n,o,h,t,i,s,r,u,f,e;for(n=this.border?this.color.border:this.color.left,o=this.border?this.color.border:this.color.right,h=this.border?this.color.borderHighlight:n,s=0;s<this.hSize+this.dimension.xAxis/2-4;s+=1)this.bitmapData.setPixel(this.dimension.xAxis-2,s+3+this.hOffset,h);for(t=0;t<this.dimension.xAxis;t+=1)this.bitmapData.setPixel(t,this.hSize+Math.floor(t/2)+this.hOffset,n);for(i=0;i<this.dimension.xAxis;i+=1)this.bitmapData.setPixel(i+this.dimension.xAxis-2,this.hSize+this.dimension.xAxis/2-Math.floor(i/2)-1+this.hOffset,o);if(this.dimension.tall){for(f=0;f<this.hSize-2;f+=1)this.bitmapData.setPixel(Math.floor(f/2),this.hSize-f+this.hOffset,n);for(e=2;e<this.hSize;e+=1)this.bitmapData.setPixel(Math.floor(e/2)+this.dimension.xAxis-2,e+1+this.hOffset,o)}else{for(r=0;r<this.hSize;r+=1)this.bitmapData.setPixel(r,this.hSize-r+this.hOffset,n);for(u=0;u<this.hSize;u+=1)this.bitmapData.setPixel(u+this.hSize-2,u+1+this.hOffset,o)}this.border||this.bitmapData.setPixel(this.dimension.xAxis-2,this.hSize+this.dimension.xAxis/2-1+this.hOffset,n);this.bitmapData.floodFill(this.dimension.xAxis-1,this.hSize+Math.floor((this.dimension.xAxis-1)/2)+this.hOffset-1,this.color.right);this.bitmapData.floodFill(this.dimension.xAxis-3,this.hSize+Math.floor((this.dimension.xAxis-1)/2)+this.hOffset-2,this.color.left)};t.toString=function(){return"[Pyramid]"};n.Pyramid=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SideXDimension:t;this.color=i===undefined?new n.SideColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis;this.h=this.dimension.zAxis+this.dimension.xAxis/2;this.matrix=new n.Matrix;this.matrix.tx=0;this.matrix.ty=-this.dimension.zAxis};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var r,u,f,e,n,t,i;for(r=0,u=this.dimension.zAxis,f=this.dimension.xAxis-1,e=this.h-this.dimension.zAxis-1,i=this.border?this.color.border:this.color.inner,n=0;n<this.dimension.xAxis;n+=1)this.bitmapData.setPixel(r+n,u+Math.floor(n/2),i),this.bitmapData.setPixel(f-n,e-Math.floor(n/2),i);for(t=0;t<this.dimension.zAxis;t+=1)this.bitmapData.setPixel(r,u-t,i),this.bitmapData.setPixel(f,e+t,i);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)};t.toString=function(){return"[SideX]"};n.SideX=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SideYDimension:t;this.color=i===undefined?new n.SideColor:i};t.initRectangle=function(){this.w=this.dimension.yAxis;this.h=this.dimension.zAxis+this.dimension.yAxis/2;this.matrix=new n.Matrix;this.matrix.tx=-this.dimension.yAxis+2;this.matrix.ty=-this.dimension.zAxis};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var r,u,f,e,n,t,i;for(r=0,u=this.h-this.dimension.zAxis-1,f=this.dimension.yAxis-1,e=this.dimension.zAxis,i=this.border?this.color.border:this.color.inner,n=0;n<this.dimension.yAxis;n+=1)this.bitmapData.setPixel(r+n,u-Math.floor(n/2),i),this.bitmapData.setPixel(f-n,e+Math.floor(n/2),i);for(t=0;t<this.dimension.zAxis;t+=1)this.bitmapData.setPixel(r,u+t,i),this.bitmapData.setPixel(f,e-t,i);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)};t.toString=function(){return"[SideY]"};n.SideY=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SlopeDimension:t;this.color=i===undefined?new n.SlopeColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.dimension.xAxis*2+this.dimension.yAxis/2;this.w-=2;this.h-=3;this.matrix=new n.Matrix;this.matrix.tx=-(this.dimension.yAxis-2);this.matrix.ty=-(this.dimension.xAxis*3/2-2)};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var e,i,r,n,f,t,u;for(e=this.border?this.color.border:this.color.left,i=this.border?this.color.border:this.color.rightSlope,n=0;n<this.dimension.yAxis;n+=1)this.bitmapData.setPixel(n,this.dimension.yAxis/2-Math.floor(n/2)-1,i),this.bitmapData.setPixel(n+this.dimension.xAxis-2,this.h-Math.floor(n/2)-1,i);for(r=0;r<this.dimension.xAxis;r+=1)this.bitmapData.setPixel(r,this.h-this.dimension.xAxis/2+Math.floor(r/2),e);for(f=this.dimension.yAxis/2-1;f<this.h-this.dimension.xAxis/2;f+=1)this.bitmapData.setPixel(0,f,e);for(t=0;t<this.dimension.xAxis*2-2;t+=1)this.bitmapData.setPixel(this.dimension.yAxis-1+Math.floor(t/2),t,i),this.bitmapData.setPixel(1+Math.floor(t/2),this.dimension.yAxis/2+t-1,i);if(this.bitmapData.floodFill(this.dimension.yAxis-2,1,this.color.rightSlope),this.bitmapData.floodFill(this.dimension.xAxis-3,this.h-3,this.color.left),this.bitmapData.setPixel(this.dimension.xAxis-2,this.h-2,this.color.left),this.border)for(u=1;u<this.dimension.xAxis*2-3;u+=1)this.bitmapData.setPixel(1+Math.floor(u/2),this.dimension.yAxis/2+u-1,this.color.borderHighlight)};t.toString=function(){return"[SlopeEast]"};n.SlopeEast=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SlopeDimension:t;this.color=i===undefined?new n.SlopeColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.dimension.yAxis*3/2+this.dimension.xAxis/2;this.w-=2;this.h-=3;this.matrix=new n.Matrix;this.matrix.tx=-(this.dimension.yAxis-2);this.matrix.ty=-(this.dimension.yAxis-2)};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.canvas=this.bitmapData.canvas};t.build=function(){var s,u,h,c,f,o,t,e,i,r;for(s=this.border?this.color.border:this.color.left,u=this.border?this.color.border:this.color.right,h=this.border?this.color.borderHighlight:this.color.left,c=new n.SideX(new n.SideXDimension(this.dimension.xAxis,this.h-this.dimension.xAxis/2),new n.SideColor(s,this.color.left)),f=new n.PixelObject(c),o=this.bitmapData.context,o.drawImage(f.canvas,f.x,f.y+this.h-this.dimension.xAxis/2),t=new n.BitmapData(this.w,this.h),e=this.h-this.dimension.yAxis*3/2+2;e<this.h;e+=1)t.setPixel(this.dimension.xAxis-1,e,u);for(i=1;i<this.dimension.yAxis;i+=1)t.setPixel(this.dimension.xAxis+i-2,this.h-Math.floor(i/2)-1,u),t.setPixel(this.dimension.xAxis+i-2,this.dimension.xAxis/2-2+i,u);for(t.floodFill(this.dimension.xAxis+1,this.h-3,this.color.right),r=this.dimension.xAxis/2;r<this.h-1;r+=1)t.setPixel(this.dimension.xAxis-1,r,this.color.right),t.setPixel(this.dimension.xAxis-2,r,h);t.context.putImageData(t.imageData,0,0);o.drawImage(t.canvas,0,0)};t.toString=function(){return"[SlopeNorth]"};n.SlopeNorth=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SlopeDimension:t;this.color=i===undefined?new n.SlopeColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.dimension.xAxis/2+this.dimension.yAxis*2;this.w-=2;this.h-=3;this.matrix=new n.Matrix;this.matrix.tx=-(this.dimension.yAxis-2);this.matrix.ty=-(this.dimension.yAxis*3/2-2)};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0);this.canvas=this.bitmapData.canvas};t.build=function(){var i,e,r,n,f,t,u;for(i=this.border?this.color.border:this.color.leftSlope,e=this.border?this.color.border:this.color.right,n=0;n<this.dimension.xAxis;n+=1)this.bitmapData.setPixel(n,this.dimension.yAxis*2+Math.floor(n/2)-3,i),this.bitmapData.setPixel(n+this.dimension.yAxis-2,Math.floor(n/2),i);for(r=0;r<this.dimension.yAxis;r+=1)this.bitmapData.setPixel(this.dimension.xAxis-2+r,this.h-Math.floor(r/2)-1,e);for(f=this.dimension.xAxis/2-1;f<this.h-this.dimension.yAxis/2;f+=1)this.bitmapData.setPixel(this.w-1,f,e);for(t=0;t<this.dimension.yAxis*2-2;t+=1)this.bitmapData.setPixel(Math.floor(t/2),this.dimension.yAxis*2-t-3,i),this.bitmapData.setPixel(this.dimension.xAxis-2+Math.floor(t/2),this.h-t-1,i);if(this.bitmapData.floodFill(this.dimension.yAxis-1,1,this.color.leftSlope),this.bitmapData.floodFill(this.dimension.xAxis,this.h-3,this.color.right),this.bitmapData.setPixel(this.dimension.xAxis-1,this.h-2,this.color.right),this.border)for(u=1;u<this.dimension.yAxis*2-3;u+=1)this.bitmapData.setPixel(this.dimension.xAxis-2+Math.floor(u/2),this.h-u-1,this.color.borderHighlight)};t.toString=function(){return"[SlopeSouth]"};n.SlopeSouth=i}(obelisk),function(n){"use strict";var i,t;i=function(n,t,i,r){this.initialize(n,t,i,r)};t=i.prototype=new n.AbstractPrimitive;t.initialize=function(n,t,i,r){return this.initRender(n,t,i,r),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this};t.initRender=function(t,i,r,u){this.useDefaultCanvas=u||!1;this.border=r||r===undefined;this.dimension=t===undefined?new n.SlopeDimension:t;this.color=i===undefined?new n.SlopeColor:i};t.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis;this.h=this.dimension.xAxis*3/2+this.dimension.yAxis/2;this.w-=2;this.h-=3;this.matrix=new n.Matrix;this.matrix.tx=-(this.dimension.yAxis-2);this.matrix.ty=-(this.dimension.xAxis-2)};t.initBitmapData=function(){this.bitmapData=new n.BitmapData(this.w,this.h,this.useDefaultCanvas)};t.renderBitmapDataForCanvas=function(){this.canvas=this.bitmapData.canvas};t.build=function(){var r,s,h,c,u,o,t,f,i,e;for(r=this.border?this.color.border:this.color.left,s=this.border?this.color.border:this.color.right,h=this.border?this.color.borderHighlight:this.color.left,c=new n.SideY(new n.SideYDimension(this.dimension.yAxis,this.h-this.dimension.yAxis/2),new n.SideColor(s,this.color.right)),u=new n.PixelObject(c),o=this.bitmapData.context,o.drawImage(u.canvas,u.x+this.w-2,u.y+this.h-this.dimension.yAxis/2),t=new n.BitmapData(this.w,this.h),f=this.h-this.dimension.xAxis*3/2+2;f<this.h;f+=1)t.setPixel(this.dimension.xAxis-2,f,r);for(i=0;i<this.dimension.xAxis-1;i+=1)t.setPixel(i,this.dimension.xAxis+this.dimension.yAxis/2-3+Math.floor(i/2),r),t.setPixel(i,this.dimension.xAxis+this.dimension.yAxis/2-3-i,r);for(t.floodFill(this.dimension.xAxis-3,this.h-3,this.color.left),e=this.dimension.yAxis/2;e<this.h-1;e+=1)t.setPixel(this.dimension.xAxis-2,e,h);t.context.putImageData(t.imageData,0,0);o.drawImage(t.canvas,0,0)};t.toString=function(){return"[SlopeWest]"};n.SlopeWest=i}(obelisk),function(n,t){"use strict";var r,i;r=function(){throw new Error("CanvasManager is a static Class, cannot be instanced.");};i=r;i.defaultCanvas=null;i.getDefaultCanvas=function(){return i.defaultCanvas=i.defaultCanvas||t.createElement("canvas"),i.defaultCanvas};i.getNewCanvas=function(){return t.createElement("canvas")};i.toString=function(){return"[CanvasManager]"};n.CanvasManager=r}(obelisk,document),function(n){"use strict";var t,i;t=function(){throw new Error("CanvasTool is a static Class, cannot be instanced.");};i=t;i.getPixel=function(n,t,i){var r,u,f,e,o;return r=n.data,u=(i*n.width+t)*4,f=r[u],e=r[u+1],o=r[u+2],f<<16|e<<8|o};i.toString=function(){return"[CanvasTool]"};n.CanvasTool=t}(obelisk),function(n){"use strict";var i,t;i=function(){throw new Error("ColorGeom is a static Class, cannot be instanced.");};t=i;t.get32=function(n){return n<4278190080?n+4278190080:n};t.applyBrightness=function(n,t,i){var h,r,u,f,e,o,s;return h=n>>>24&255,r=n>>>16&255,u=n>>>8&255,f=n&255,e=(r*313524>>20)+(u*615514>>20)+(f*119538>>20),s=-(155189*r>>20)-(303038*u>>20)+(458227*f>>20),o=(644874*r>>20)-(540016*u>>20)-(104857*f>>20),i?e=60+Math.pow(e,1.2):e+=t,r=e+(1195376*o>>20),u=e-(408944*s>>20)-(608174*o>>20),f=e+(2128609*s>>20),r=Math.max(0,Math.min(r,255)),u=Math.max(0,Math.min(u,255)),f=Math.max(0,Math.min(f,255)),h<<24|r<<16|u<<8|f};t.toString=function(){return"[ColorGeom]"};n.ColorGeom=i}(obelisk),function(n){"use strict";var i,t;i=function(){throw new Error("ColorPattern is a static Class, cannot be instanced.");};t=i;t.GRASS_GREEN=13434624;t.YELLOW=16776960;t.WINE_RED=16711833;t.PINK=16743615;t.PURPLE=13369599;t.BLUE=52479;t.GRAY=15658734;t.BLACK=6710886;t.FINE_COLORS=[t.GRASS_GREEN,t.YELLOW,t.WINE_RED,t.PINK,t.PURPLE,t.BLUE,t.GRAY,t.BLACK];t.getRandomComfortableColor=function(){return t.FINE_COLORS[Math.floor(Math.random()*t.FINE_COLORS.length)]};t.toString=function(){return"[ColorPattern]"};n.ColorPattern=i}(obelisk);
/*!	
* FitText.js 1.1
*
* Copyright 2011, Dave Rupert http://daverupert.com
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
*
* Date: Thu May 05 14:23:00 2011 -0600
*/
(function(n){n.fn.fitText=function(t,i){var u=t||1,r=n.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},i);return this.each(function(){var t=n(this),i=function(){t.css("font-size",Math.max(Math.min(t.width()/(u*10),parseFloat(r.maxFontSize)),parseFloat(r.minFontSize)))};i();n(window).on("resize",i)})}})(jQuery);
/*!	
* Lettering.JS 0.6.1
*
* Copyright 2010, Dave Rupert http://daverupert.com
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
*
* Thanks to Paul Irish - http://paulirish.com - for the feedback.
*
* Date: Mon Sep 20 17:14:00 2010 -0600
*/
(function(n){function t(t,i,r,u){var f=t.text().split(i),e="";f.length&&(n(f).each(function(n,t){e+='<span class="'+r+(n+1)+'">'+t+"<\/span>"+u}),t.empty().append(e))}var i={init:function(){return this.each(function(){t(n(this),"","char","")})},words:function(){return this.each(function(){t(n(this)," ","word"," ")})},lines:function(){return this.each(function(){var i="eefec303079ad17405c889e092e105b0";t(n(this).children("br").replaceWith(i).end(),i,"line","")})}};n.fn.lettering=function(t){return t&&i[t]?i[t].apply(this,[].slice.call(arguments,1)):t==="letters"||!t?i.init.apply(this,[].slice.call(arguments,0)):(n.error("Method "+t+" does not exist on jQuery.lettering"),this)}})(jQuery),function(n){"use strict";function t(t){return/In/.test(t)||n.inArray(t,n.fn.textillate.defaults.inEffects)>=0}function i(t){return/Out/.test(t)||n.inArray(t,n.fn.textillate.defaults.outEffects)>=0}function r(t){var r=t.attributes||[],i={};return r.length?(n.each(r,function(n,t){/^data-in-*/.test(t.nodeName)?(i.in=i.in||{},i.in[t.nodeName.replace(/data-in-/,"")]=t.nodeValue):/^data-out-*/.test(t.nodeName)?(i.out=i.out||{},i.out[t.nodeName.replace(/data-out-/,"")]=t.nodeValue):/^data-*/.test(t.nodeName)&&(i[t.nodeName]=t.nodeValue)}),i):i}function f(n){for(var i,r,t=n.length;t;i=parseInt(Math.random()*t),r=n[--t],n[t]=n[i],n[i]=r);return n}function e(n,t,i){n.addClass("animated "+t).css("visibility","visible").show();n.one("animationend webkitAnimationEnd oAnimationEnd",function(){n.removeClass("animated "+t);i&&i()})}function u(r,u,o){var h=this,s=r.length;if(!s){o&&o();return}u.shuffle&&(r=f(r));u.reverse&&(r=r.toArray().reverse());n.each(r,function(r,f){function c(){t(u.effect)?h.css("visibility","visible"):i(u.effect)&&h.css("visibility","hidden");s-=1;!s&&o&&o()}var h=n(f),l=u.sync?u.delay:u.delay*r*u.delayScale;h.text()?setTimeout(function(){e(h,u.effect,c)},l):c()})}var o=function(f,e){var o=this,s=n(f);o.init=function(){o.$texts=s.find(e.selector);o.$texts.length||(o.$texts=n('<ul class="texts"><li>'+s.html()+"<\/li><\/ul>"),s.html(o.$texts));o.$texts.hide();o.$current=n("<span>").text(o.$texts.find(":first-child").html()).prependTo(s);t(e.effect)?o.$current.css("visibility","hidden"):i(e.effect)&&o.$current.css("visibility","visible");o.setOptions(e);setTimeout(function(){o.options.autoStart&&o.start()},o.options.initialDelay)};o.setOptions=function(n){o.options=n};o.triggerEvent=function(t){var i=n.Event(t+".tlt");return s.trigger(i,o),i};o.in=function(f,e){f=f||0;var c=o.$texts.find(":nth-child("+(f+1)+")"),s=n.extend({},o.options,r(c)),h;c.addClass("current");o.triggerEvent("inAnimationBegin");o.$current.text(c.html()).lettering("words");o.$current.find('[class^="word"]').css({display:"inline-block","-webkit-transform":"translate3d(0,0,0)","-moz-transform":"translate3d(0,0,0)","-o-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"}).each(function(){n(this).lettering()});h=o.$current.find('[class^="char"]').css("display","inline-block");t(s.in.effect)?h.css("visibility","hidden"):i(s.in.effect)&&h.css("visibility","visible");o.currentIndex=f;u(h,s.in,function(){o.triggerEvent("inAnimationEnd");s.in.callback&&s.in.callback();e&&e(o)})};o.out=function(t){var f=o.$texts.find(":nth-child("+(o.currentIndex+1)+")"),e=o.$current.find('[class^="char"]'),i=n.extend({},o.options,r(f));o.triggerEvent("outAnimationBegin");u(e,i.out,function(){f.removeClass("current");o.triggerEvent("outAnimationEnd");i.out.callback&&i.out.callback();t&&t(o)})};o.start=function(n){o.triggerEvent("start"),function t(n){o.in(n,function(){var i=o.$texts.children().length;n+=1;!o.options.loop&&n>=i?(o.options.callback&&o.options.callback(),o.triggerEvent("end")):(n=n%i,setTimeout(function(){o.out(function(){t(n)})},o.options.minDisplayTime))})}(n||0)};o.init()};n.fn.textillate=function(t,i){return this.each(function(){var f=n(this),u=f.data("textillate"),e=n.extend(!0,{},n.fn.textillate.defaults,r(this),typeof t=="object"&&t);u?typeof t=="string"?u[t].apply(u,[].concat(i)):u.setOptions.call(u,e):f.data("textillate",u=new o(this,e))})};n.fn.textillate.defaults={selector:".texts",loop:!1,minDisplayTime:2e3,initialDelay:0,"in":{effect:"fadeInLeftBig",delayScale:1.5,delay:50,sync:!1,reverse:!1,shuffle:!1,callback:function(){}},out:{effect:"hinge",delayScale:1.5,delay:50,sync:!1,reverse:!1,shuffle:!1,callback:function(){}},autoStart:!0,inEffects:[],outEffects:["hinge"],callback:function(){}}}(jQuery);
/*! FileSaver.js
 *  A saveAs() FileSaver implementation.
 *  2014-01-24
 *
 *  By Eli Grey, http://eligrey.com
 *  License: X11/MIT
 *    See LICENSE.md
 */
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
saveAs=saveAs||typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(n){"use strict";if(typeof navigator=="undefined"||!/MSIE [1-9]\./.test(navigator.userAgent)){var i=n.document,v=function(){return n.URL||n.webkitURL||n},y=n.URL||n.webkitURL||n,r=i.createElementNS("http://www.w3.org/1999/xhtml","a"),p=!n.externalHost&&"download"in r,b=function(t){var r=i.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,n,0,0,0,0,0,!1,!1,!1,!1,0,null);t.dispatchEvent(r)},f=n.webkitRequestFileSystem,h=n.requestFileSystem||f||n.mozRequestFileSystem,w=function(t){(n.setImmediate||n.setTimeout)(function(){throw t;},0)},e="application/octet-stream",c=0,u=[],o=function(){for(var t=u.length,n;t--;)n=u[t],typeof n=="string"?y.revokeObjectURL(n):n.remove();u.length=0},s=function(n,t,i){var r,u;for(t=[].concat(t),r=t.length;r--;)if(u=n["on"+t[r]],typeof u=="function")try{u.call(n,i||n)}catch(f){w(f)}},l=function(t,o){var l=this,k=t.type,g=!1,y,b,nt=function(){var n=v().createObjectURL(t);return u.push(n),n},tt=function(){s(l,"writestart progress write writeend".split(" "))},a=function(){(g||!y)&&(y=nt(t));b?b.location.href=y:window.open(y,"_blank");l.readyState=l.DONE;tt()},w=function(n){return function(){if(l.readyState!==l.DONE)return n.apply(this,arguments)}},it={create:!0,exclusive:!1},rt,d;if(l.readyState=l.INIT,o||(o="download"),p){y=nt(t);i=n.document;r=i.createElementNS("http://www.w3.org/1999/xhtml","a");r.href=y;r.download=o;d=i.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,n,0,0,0,0,0,!1,!1,!1,!1,0,null);r.dispatchEvent(d);l.readyState=l.DONE;tt();return}if(n.chrome&&k&&k!==e&&(rt=t.slice||t.webkitSlice,t=rt.call(t,0,t.size,e),g=!0),f&&o!=="download"&&(o+=".download"),(k===e||f)&&(b=n),!h){a();return}c+=t.size;h(n.TEMPORARY,c,w(function(n){n.root.getDirectory("saved",it,w(function(n){var i=function(){n.getFile(o,it,w(function(n){n.createWriter(w(function(i){i.onwriteend=function(t){b.location.href=n.toURL();u.push(n);l.readyState=l.DONE;s(l,"writeend",t)};i.onerror=function(){var n=i.error;n.code!==n.ABORT_ERR&&a()};"writestart progress write abort".split(" ").forEach(function(n){i["on"+n]=l["on"+n]});i.write(t);l.abort=function(){i.abort();l.readyState=l.DONE};l.readyState=l.WRITING}),a)}),a)};n.getFile(o,{create:!1},w(function(n){n.remove();i()}),w(function(n){n.code===n.NOT_FOUND_ERR?i():a()}))}),a)}),a)},t=l.prototype,a=function(n,t){return new l(n,t)};return t.abort=function(){var n=this;n.readyState=n.DONE;s(n,"abort")},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,n.addEventListener("unload",o,!1),a.unload=function(){o();n.removeEventListener("unload",o,!1)},a}}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content);typeof module!="undefined"&&module!==null?module.exports=saveAs:typeof define!="undefined"&&define!==null&&define.amd!=null&&define([],function(){return saveAs}),function(n,t){typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?module.exports=t():n.indexed=t()}(this,function(){function n(n){return{processCB:function(n,t){if(n&&typeof n=="function"){var i=t===!1?!0:!1;n(i,t)}else console.error("Improper callback")},parseQuery:function(n){var t=[];return Array.isArray(n)||(n=[n]),n.forEach(function(n){var i=Object.keys(n),r;typeof n[i]=="object"?(r=Object.keys(n[i]),t.push({field:i[0],operand:r[0],value:n[i][r]})):t.push({field:i[0],operand:"$eq",value:n[i]})}),t},checkType:function(n){return{}.toString.call(n).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},create:function(t){var r=this,i=window.indexedDB.open(n);i.onupgradeneeded=function(t){var i=t.target.result;i.createObjectStore(n,{keyPath:"_id",autoIncrement:!1})};i.onsuccess=function(n){n.target.result.close();r.processCB(t,!0)};i.onerror=function(){r.processCB(t,!1)}},insert:function(t,i){var r=this,u=window.indexedDB.open(n);u.onsuccess=function(u){function h(){f<t.length?(t[f]._id=(new Date).getTime()+f,o.put(t[f]).onsuccess=h,f++):r.find(s,i)}var e=u.target.result,l=e.transaction([n],r.IDBTransactionModes.READ_WRITE),o=l.objectStore(n),f,s,c;r.checkType(t)==="array"?(f=0,s={_id:{$gte:(new Date).getTime()}},h()):(t._id=(new Date).getTime(),c=o.put(t).onsuccess=function(){r.find({_id:t._id},i);e.close()},c.onerror=function(){r.processCB(i,!1)})};u.onerror=function(){r.processCB(i,!1)}},traverse:function(t,i,r){var u=this,f=window.indexedDB.open(n);f.onsuccess=function(f){var o=f.target.result,s=o.transaction([n],u.IDBTransactionModes.READ_WRITE),c=s.objectStore(n),l=IDBKeyRange.lowerBound(0),h=c.openCursor(l),e=[];h.onsuccess=function(n){function s(n,t,i){switch(t){case"$gt":return n>i;case"$lt":return n<i;case"$gte":return n>=i;case"$lte":return n<=i;case"$ne":return n!=i;case"$eq":return n==i;case"$like":return new RegExp(i,"i").test(n)}}var r=n.target.result,f,o;if(r){if(t){if(o=!0,t.forEach(function(n){o=o&&s(r.value[n.field],n.operand,n.value)}),o){if(u.checkType(i)==="object"){for(f in i)r.value[f]=i[f];r.update(r.value)}i==="delete"&&r.delete(r.value._id);e.push(r.value)}}else{if(u.checkType(i)==="object"){for(f in i)r.value[f]=i[f];r.update(r.value)}i==="delete"&&r.delete(r.value._id);e.push(r.value)}r.continue()}};s.oncomplete=function(){u.processCB(r,e);o.close()};h.onerror=function(){u.processCB(r,!1)}};f.onerror=function(){u.processCB(r,!1)}},find:function(){var t=!1,n;arguments.length===1&&typeof arguments[0]=="function"?n=arguments[0]:(t=this.parseQuery(arguments[0]),n=arguments[1]);this.traverse(t,!1,n)},update:function(){var i=!1,n,t;arguments.length===2&&typeof arguments[1]=="function"?(n=arguments[0],t=arguments[1]):(i=this.parseQuery(arguments[0]),n=arguments[1],t=arguments[2]);this.traverse(i,n,t)},"delete":function(){var t=!1,n;arguments.length===1&&typeof arguments[0]=="function"?n=arguments[0]:(t=this.parseQuery(arguments[0]),n=arguments[1]);this.traverse(t,"delete",n)},drop:function(t){var i=this,r=window.indexedDB.deleteDatabase(n);r.onsuccess=function(){i.processCB(t,!0);i.create()};r.onblocked=function(){i.processCB(t,!1)};r.onerror=function(){i.processCB(t,!1)}},IDBTransactionModes:{READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"}}}return window.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB,n});
//! moment.js
//! version : 2.9.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(n){function it(n,t,i){switch(arguments.length){case 2:return null!=n?n:t;case 3:return null!=n?n:null!=t?t:i;default:throw new Error("Implement me");}}function p(n,t){return uf.call(n,t)}function ot(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function ri(n){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+n)}function o(n,t){var i=!0;return w(function(){return i&&(ri(n),i=!1),t.apply(this,arguments)},t)}function dr(n,t){br[n]||(ri(t),br[n]=!0)}function ui(n,t){return function(i){return r(n.call(this,i),t)}}function gr(n,t){return function(i){return this.localeData().ordinal(n.call(this,i),t)}}function nu(n,t){var r,f,u=12*(t.year()-n.year())+(t.month()-n.month()),i=n.clone().add(u,"months");return 0>t-i?(r=n.clone().add(u-1,"months"),f=(t-i)/(i-r)):(r=n.clone().add(u+1,"months"),f=(t-i)/(r-i)),-(u+f)}function tu(n,t,i){var r;return null==i?t:null!=n.meridiemHour?n.meridiemHour(t,i):null!=n.isPM?(r=n.isPM(i),r&&12>t&&(t+=12),r||12!==t||(t=0),t):t}function fi(){}function rt(n,i){i!==!1&&pi(n);ei(this,n);this._d=new Date(+n._d);ii===!1&&(ii=!0,t.updateOffset(this),ii=!1)}function st(n){var i=li(n),r=i.year||0,u=i.quarter||0,f=i.month||0,e=i.week||0,o=i.day||0,s=i.hour||0,h=i.minute||0,c=i.second||0,l=i.millisecond||0;this._milliseconds=+l+1e3*c+6e4*h+36e5*s;this._days=+o+7*e;this._months=+f+3*u+12*r;this._data={};this._locale=t.localeData();this._bubble()}function w(n,t){for(var i in t)p(t,i)&&(n[i]=t[i]);return p(t,"toString")&&(n.toString=t.toString),p(t,"valueOf")&&(n.valueOf=t.valueOf),n}function ei(n,t){var u,i,r;if("undefined"!=typeof t._isAMomentObject&&(n._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(n._i=t._i),"undefined"!=typeof t._f&&(n._f=t._f),"undefined"!=typeof t._l&&(n._l=t._l),"undefined"!=typeof t._strict&&(n._strict=t._strict),"undefined"!=typeof t._tzm&&(n._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(n._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(n._offset=t._offset),"undefined"!=typeof t._pf&&(n._pf=t._pf),"undefined"!=typeof t._locale&&(n._locale=t._locale),ft.length>0)for(u in ft)i=ft[u],r=t[i],"undefined"!=typeof r&&(n[i]=r);return n}function s(n){return 0>n?Math.ceil(n):Math.floor(n)}function r(n,t,i){for(var r=""+Math.abs(n),u=n>=0;r.length<t;)r="0"+r;return(u?i?"+":"":"-")+r}function oi(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+12*(t.year()-n.year()),n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function iu(n,t){var i;return t=lt(t,n),n.isBefore(t)?i=oi(n,t):(i=oi(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function si(n,i){return function(r,u){var f,e;return null===u||isNaN(+u)||(dr(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period)."),e=r,r=u,u=e),r="string"==typeof r?+r:r,f=t.duration(r,u),hi(this,f,n),this}}function hi(n,i,r,u){var o=i._milliseconds,f=i._days,e=i._months;u=null==u?!0:u;o&&n._d.setTime(+n._d+o*r);f&&rr(n,"Date",bt(n,"Date")+f*r);e&&ir(n,bt(n,"Month")+e*r);u&&t.updateOffset(n,f||e)}function ut(n){return"[object Array]"===Object.prototype.toString.call(n)}function ht(n){return"[object Date]"===Object.prototype.toString.call(n)||n instanceof Date}function ci(n,t,r){for(var e=Math.min(n.length,t.length),o=Math.abs(n.length-t.length),f=0,u=0;e>u;u++)(r&&n[u]!==t[u]||!r&&i(n[u])!==i(t[u]))&&f++;return f+o}function f(n){if(n){var t=n.toLowerCase().replace(/(.)s$/,"$1");n=ne[n]||te[t]||t}return n}function li(n){var i,t,r={};for(t in n)p(n,t)&&(i=f(t),i&&(r[i]=n[t]));return r}function ru(i){var r,u;if(0===i.indexOf("week"))r=7,u="day";else{if(0!==i.indexOf("month"))return;r=12;u="month"}t[i]=function(f,e){var o,s,c=t._locale[i],h=[];if("number"==typeof f&&(e=f,f=n),s=function(n){var i=t().utc().set(u,n);return c.call(t._locale,i,f||"")},null!=e)return s(e);for(o=0;r>o;o++)h.push(s(o));return h}}function i(n){var t=+n,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function ct(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function ai(n,i,r){return b(t([n,11,31+i-r]),i,r).week}function vi(n){return yi(n)?366:365}function yi(n){return n%4==0&&n%100!=0||n%400==0}function pi(n){var t;n._a&&-2===n._pf.overflow&&(t=n._a[a]<0||n._a[a]>11?a:n._a[h]<1||n._a[h]>ct(n._a[l],n._a[a])?h:n._a[e]<0||n._a[e]>24||24===n._a[e]&&(0!==n._a[d]||0!==n._a[g]||0!==n._a[nt])?e:n._a[d]<0||n._a[d]>59?d:n._a[g]<0||n._a[g]>59?g:n._a[nt]<0||n._a[nt]>999?nt:-1,n._pf._overflowDayOfYear&&(l>t||t>h)&&(t=h),n._pf.overflow=t)}function wi(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length&&t._pf.bigHour===n)),t._isValid}function bi(n){return n?n.toLowerCase().replace("_","-"):n}function uu(n){for(var i,t,f,r,u=0;u<n.length;){for(r=bi(n[u]).split("-"),i=r.length,t=bi(n[u+1]),t=t?t.split("-"):null;i>0;){if(f=ki(r.slice(0,i).join("-")))return f;if(t&&t.length>=i&&ci(r,t,!0)>=i-1)break;i--}u++}return null}function ki(n){var i=null;if(!tt[n]&&sr)try{i=t.locale();require("./locale/"+n);t.locale(i)}catch(r){}return tt[n]}function lt(n,i){var r,u;return i._isUTC?(r=i.clone(),u=(t.isMoment(n)||ht(n)?+n:+t(n))-+r,r._d.setTime(+r._d+u),t.updateOffset(r,!1),r):t(n).local()}function fu(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function eu(n){for(var i=n.match(hr),t=0,r=i.length;r>t;t++)i[t]=v[i[t]]?v[i[t]]:fu(i[t]);return function(u){var f="";for(t=0;r>t;t++)f+=i[t]instanceof Function?i[t].call(u,n):i[t];return f}}function at(n,t){return n.isValid()?(t=di(t,n.localeData()),ti[t]||(ti[t]=eu(t)),ti[t](n)):n.localeData().invalidDate()}function di(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(et.lastIndex=0;i>=0&&et.test(n);)n=n.replace(et,r),et.lastIndex=0,i-=1;return n}function ou(n,t){var i=t._strict;switch(n){case"Q":return lr;case"DDDD":return vr;case"YYYY":case"GGGG":case"gggg":return i?wf:hf;case"Y":case"G":case"g":return kf;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?bf:cf;case"S":if(i)return lr;case"SS":if(i)return ar;case"SSS":if(i)return vr;case"DDD":return sf;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return af;case"a":case"A":return t._locale._meridiemParse;case"x":return yf;case"X":return pf;case"Z":case"ZZ":return dt;case"T":return vf;case"SSSS":return lf;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?ar:cr;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return cr;case"Do":return i?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return new RegExp(vu(au(n.replace("\\","")),"i"))}}function vt(n){n=n||"";var r=n.match(dt)||[],f=r[r.length-1]||[],t=(f+"").match(gf)||["-",0,0],u=+(60*t[1])+i(t[2]);return"+"===t[0]?u:-u}function su(n,r,u){var o,f=u._a;switch(n){case"Q":null!=r&&(f[a]=3*(i(r)-1));break;case"M":case"MM":null!=r&&(f[a]=i(r)-1);break;case"MMM":case"MMMM":o=u._locale.monthsParse(r,n,u._strict);null!=o?f[a]=o:u._pf.invalidMonth=r;break;case"D":case"DD":null!=r&&(f[h]=i(r));break;case"Do":null!=r&&(f[h]=i(parseInt(r.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=r&&(u._dayOfYear=i(r));break;case"YY":f[l]=t.parseTwoDigitYear(r);break;case"YYYY":case"YYYYY":case"YYYYYY":f[l]=i(r);break;case"a":case"A":u._meridiem=r;break;case"h":case"hh":u._pf.bigHour=!0;case"H":case"HH":f[e]=i(r);break;case"m":case"mm":f[d]=i(r);break;case"s":case"ss":f[g]=i(r);break;case"S":case"SS":case"SSS":case"SSSS":f[nt]=i(1e3*("0."+r));break;case"x":u._d=new Date(i(r));break;case"X":u._d=new Date(1e3*parseFloat(r));break;case"Z":case"ZZ":u._useUTC=!0;u._tzm=vt(r);break;case"dd":case"ddd":case"dddd":o=u._locale.weekdaysParse(r);null!=o?(u._w=u._w||{},u._w.d=o):u._pf.invalidWeekday=r;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":n=n.substr(0,1);case"gggg":case"GGGG":case"GGGGG":n=n.substr(0,2);r&&(u._w=u._w||{},u._w[n]=i(r));break;case"gg":case"GG":u._w=u._w||{};u._w[n]=t.parseTwoDigitYear(r)}}function hu(n){var i,o,f,u,r,e,s;i=n._w;null!=i.GG||null!=i.W||null!=i.E?(r=1,e=4,o=it(i.GG,n._a[l],b(t(),1,4).year),f=it(i.W,1),u=it(i.E,1)):(r=n._locale._week.dow,e=n._locale._week.doy,o=it(i.gg,n._a[l],b(t(),r,e).year),f=it(i.w,1),null!=i.d?(u=i.d,r>u&&++f):u=null!=i.e?i.e+r:r);s=tf(o,f,u,e,r);n._a[l]=s.year;n._dayOfYear=s.dayOfYear}function yt(n){var t,i,r,u,f=[];if(!n._d){for(r=lu(n),n._w&&null==n._a[h]&&null==n._a[a]&&hu(n),n._dayOfYear&&(u=it(n._a[l],r[l]),n._dayOfYear>vi(u)&&(n._pf._overflowDayOfYear=!0),i=wt(u,0,n._dayOfYear),n._a[a]=i.getUTCMonth(),n._a[h]=i.getUTCDate()),t=0;3>t&&null==n._a[t];++t)n._a[t]=f[t]=r[t];for(;7>t;t++)n._a[t]=f[t]=null==n._a[t]?2===t?1:0:n._a[t];24===n._a[e]&&0===n._a[d]&&0===n._a[g]&&0===n._a[nt]&&(n._nextDay=!0,n._a[e]=0);n._d=(n._useUTC?wt:ku).apply(null,f);null!=n._tzm&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[e]=24)}}function cu(n){var t;n._d||(t=li(n._i),n._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],yt(n))}function lu(n){var t=new Date;return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function pt(i){if(i._f===t.ISO_8601)return void gi(i);i._a=[];i._pf.empty=!0;for(var r,f,h,u=""+i._i,l=u.length,c=0,s=di(i._f,i._locale).match(hr)||[],o=0;o<s.length;o++)f=s[o],r=(u.match(ou(f,i))||[])[0],r&&(h=u.substr(0,u.indexOf(r)),h.length>0&&i._pf.unusedInput.push(h),u=u.slice(u.indexOf(r)+r.length),c+=r.length),v[f]?(r?i._pf.empty=!1:i._pf.unusedTokens.push(f),su(f,r,i)):i._strict&&!r&&i._pf.unusedTokens.push(f);i._pf.charsLeftOver=l-c;u.length>0&&i._pf.unusedInput.push(u);i._pf.bigHour===!0&&i._a[e]<=12&&(i._pf.bigHour=n);i._a[e]=tu(i._locale,i._a[e],i._meridiem);yt(i);pi(i)}function au(n){return n.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u})}function vu(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function yu(n){var t,f,u,r,i;if(0===n._f.length)return n._pf.invalidFormat=!0,void(n._d=new Date(NaN));for(r=0;r<n._f.length;r++)i=0,t=ei({},n),null!=n._useUTC&&(t._useUTC=n._useUTC),t._pf=ot(),t._f=n._f[r],pt(t),wi(t)&&(i+=t._pf.charsLeftOver,i+=10*t._pf.unusedTokens.length,t._pf.score=i,(null==u||u>i)&&(u=i,f=t));w(n,f||t)}function gi(n){var t,i,r=n._i,u=df.exec(r);if(u){for(n._pf.iso=!0,t=0,i=gt.length;i>t;t++)if(gt[t][1].exec(r)){n._f=gt[t][0]+(u[6]||" ");break}for(t=0,i=ni.length;i>t;t++)if(ni[t][1].exec(r)){n._f+=ni[t][0];break}r.match(dt)&&(n._f+="Z");pt(n)}else n._isValid=!1}function pu(n){gi(n);n._isValid===!1&&(delete n._isValid,t.createFromInputFallback(n))}function wu(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function bu(i){var u,r=i._i;r===n?i._d=new Date:ht(r)?i._d=new Date(+r):null!==(u=ff.exec(r))?i._d=new Date(+u[1]):"string"==typeof r?pu(i):ut(r)?(i._a=wu(r.slice(0),function(n){return parseInt(n,10)}),yt(i)):"object"==typeof r?cu(i):"number"==typeof r?i._d=new Date(r):t.createFromInputFallback(i)}function ku(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return 1970>n&&o.setFullYear(n),o}function wt(n){var t=new Date(Date.UTC.apply(null,arguments));return 1970>n&&t.setUTCFullYear(n),t}function du(n,t){if("string"==typeof n)if(isNaN(n)){if(n=t.weekdaysParse(n),"number"!=typeof n)return null}else n=parseInt(n,10);return n}function gu(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function nf(n,i,r){var u=t.duration(n).abs(),c=k(u.as("s")),e=k(u.as("m")),o=k(u.as("h")),s=k(u.as("d")),h=k(u.as("M")),l=k(u.as("y")),f=c<y.s&&["s",c]||1===e&&["m"]||e<y.m&&["mm",e]||1===o&&["h"]||o<y.h&&["hh",o]||1===s&&["d"]||s<y.d&&["dd",s]||1===h&&["M"]||h<y.M&&["MM",h]||1===l&&["y"]||["yy",l];return f[2]=i,f[3]=+n>0,f[4]=r,gu.apply({},f)}function b(n,i,r){var f,e=r-i,u=r-n.day();return u>e&&(u-=7),e-7>u&&(u+=7),f=t(n).add(u,"d"),{week:Math.ceil(f.dayOfYear()/7),year:f.year()}}function tf(n,t,i,r,u){var o,e,f=wt(n,0,1).getUTCDay();return f=0===f?7:f,i=null!=i?i:u,o=u-f+(f>r?7:0)-(u>f?7:0),e=7*(t-1)+(i-u)+o+1,{year:e>0?n:n-1,dayOfYear:e>0?e:vi(n-1)+e}}function nr(i){var u,r=i._i,f=i._f;return i._locale=i._locale||t.localeData(i._l),null===r||f===n&&""===r?t.invalid({nullInput:!0}):("string"==typeof r&&(i._i=r=i._locale.preparse(r)),t.isMoment(r)?new rt(r,!0):(f?ut(f)?yu(i):pt(i):bu(i),u=new rt(i),u._nextDay&&(u.add(1,"d"),u._nextDay=n),u))}function tr(n,i){var u,r;if(1===i.length&&ut(i[0])&&(i=i[0]),!i.length)return t();for(u=i[0],r=1;r<i.length;++r)i[r][n](u)&&(u=i[r]);return u}function ir(n,t){var i;return"string"==typeof t&&(t=n.localeData().monthsParse(t),"number"!=typeof t)?n:(i=Math.min(n.date(),ct(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n)}function bt(n,t){return n._d["get"+(n._isUTC?"UTC":"")+t]()}function rr(n,t,i){return"Month"===t?ir(n,i):n._d["set"+(n._isUTC?"UTC":"")+t](i)}function c(n,i){return function(r){return null!=r?(rr(this,n,r),t.updateOffset(this,i),this):bt(this,n)}}function ur(n){return 400*n/146097}function fr(n){return 146097*n/400}function rf(n){t.duration.fn[n]=function(){return this._data[n]}}function er(n){"undefined"==typeof ender&&(or=kt.moment,kt.moment=n?o("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",t):t)}for(var t,or,u,kt="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,k=Math.round,uf=Object.prototype.hasOwnProperty,l=0,a=1,h=2,e=3,d=4,g=5,nt=6,tt={},ft=[],sr="undefined"!=typeof module&&module&&module.exports,ff=/^\/?Date\((\-?\d+)/i,ef=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,of=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,hr=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,et=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cr=/\d\d?/,sf=/\d{1,3}/,hf=/\d{1,4}/,cf=/[+\-]?\d{1,6}/,lf=/\d+/,af=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,dt=/Z|[\+\-]\d\d:?\d\d/gi,vf=/T/i,yf=/[\+\-]?\d+/,pf=/[\+\-]?\d+(\.\d{1,3})?/,lr=/\d/,ar=/\d\d/,vr=/\d{3}/,wf=/\d{4}/,bf=/[+-]?\d{6}/,kf=/[+-]?\d+/,df=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ni=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],gf=/([\+\-]|\d\d)/gi,yr=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ne={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},te={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ti={},y={s:45,m:45,h:22,d:26,M:11},pr="DDD w W M D d".split(" "),wr="M D H h m s w W".split(" "),v={M:function(){return this.month()+1},MMM:function(n){return this.localeData().monthsShort(this,n)},MMMM:function(n){return this.localeData().months(this,n)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(n){return this.localeData().weekdaysMin(this,n)},ddd:function(n){return this.localeData().weekdaysShort(this,n)},dddd:function(n){return this.localeData().weekdays(this,n)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return r(this.year()%100,2)},YYYY:function(){return r(this.year(),4)},YYYYY:function(){return r(this.year(),5)},YYYYYY:function(){var n=this.year(),t=n>=0?"+":"-";return t+r(Math.abs(n),6)},gg:function(){return r(this.weekYear()%100,2)},gggg:function(){return r(this.weekYear(),4)},ggggg:function(){return r(this.weekYear(),5)},GG:function(){return r(this.isoWeekYear()%100,2)},GGGG:function(){return r(this.isoWeekYear(),4)},GGGGG:function(){return r(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return i(this.milliseconds()/100)},SS:function(){return r(i(this.milliseconds()/10),2)},SSS:function(){return r(this.milliseconds(),3)},SSSS:function(){return r(this.milliseconds(),3)},Z:function(){var n=this.utcOffset(),t="+";return 0>n&&(n=-n,t="-"),t+r(i(n/60),2)+":"+r(i(n)%60,2)},ZZ:function(){var n=this.utcOffset(),t="+";return 0>n&&(n=-n,t="-"),t+r(i(n/60),2)+r(i(n)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},br={},kr=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],ii=!1;pr.length;)u=pr.pop(),v[u+"o"]=gr(v[u],u);for(;wr.length;)u=wr.pop(),v[u+u]=ui(v[u],2);for(v.DDDD=ui(v.DDD,3),w(fi.prototype,{set:function(n){var t;for(var i in n)t=n[i],"function"==typeof t?this[i]=t:this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(n){return this._months[n.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(n){return this._monthsShort[n.month()]},monthsParse:function(n,i,r){var u,f,e;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),u=0;12>u;u++)if((f=t.utc([2e3,u]),r&&!this._longMonthsParse[u]&&(this._longMonthsParse[u]=new RegExp("^"+this.months(f,"").replace(".","")+"$","i"),this._shortMonthsParse[u]=new RegExp("^"+this.monthsShort(f,"").replace(".","")+"$","i")),r||this._monthsParse[u]||(e="^"+this.months(f,"")+"|^"+this.monthsShort(f,""),this._monthsParse[u]=new RegExp(e.replace(".",""),"i")),r&&"MMMM"===i&&this._longMonthsParse[u].test(n))||r&&"MMM"===i&&this._shortMonthsParse[u].test(n)||!r&&this._monthsParse[u].test(n))return u},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(n){return this._weekdays[n.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(n){return this._weekdaysShort[n.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(n){return this._weekdaysMin[n.day()]},weekdaysParse:function(n){var i,r,u;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(r=t([2e3,1]).day(i),u="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(u.replace(".",""),"i")),this._weekdaysParse[i].test(n))return i},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(n){var t=this._longDateFormat[n];return!t&&this._longDateFormat[n.toUpperCase()]&&(t=this._longDateFormat[n.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n]=t),t},isPM:function(n){return"p"===(n+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(n,t,i){var r=this._calendar[n];return"function"==typeof r?r.apply(t,[i]):r},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(n,t,i,r){var u=this._relativeTime[i];return"function"==typeof u?u(n,t,i,r):u.replace(/%d/i,n)},pastFuture:function(n,t){var i=this._relativeTime[n>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(n){return this._ordinal.replace("%d",n)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(n){return n},postformat:function(n){return n},week:function(n){return b(n,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),t=function(t,i,r,u){var f;return"boolean"==typeof r&&(u=r,r=n),f={},f._isAMomentObject=!0,f._i=t,f._f=i,f._l=r,f._strict=u,f._isUTC=!1,f._pf=ot(),nr(f)},t.suppressDeprecationWarnings=!1,t.createFromInputFallback=o("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),t.min=function(){var n=[].slice.call(arguments,0);return tr("isBefore",n)},t.max=function(){var n=[].slice.call(arguments,0);return tr("isAfter",n)},t.utc=function(t,i,r,u){var f;return"boolean"==typeof r&&(u=r,r=n),f={},f._isAMomentObject=!0,f._useUTC=!0,f._isUTC=!0,f._l=r,f._i=t,f._f=i,f._strict=u,f._pf=ot(),nr(f).utc()},t.unix=function(n){return t(1e3*n)},t.duration=function(n,r){var o,c,s,l,u=n,f=null;return t.isDuration(n)?u={ms:n._milliseconds,d:n._days,M:n._months}:"number"==typeof n?(u={},r?u[r]=n:u.milliseconds=n):(f=ef.exec(n))?(o="-"===f[1]?-1:1,u={y:0,d:i(f[h])*o,h:i(f[e])*o,m:i(f[d])*o,s:i(f[g])*o,ms:i(f[nt])*o}):(f=of.exec(n))?(o="-"===f[1]?-1:1,s=function(n){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*o},u={y:s(f[2]),M:s(f[3]),d:s(f[4]),h:s(f[5]),m:s(f[6]),s:s(f[7]),w:s(f[8])}):null==u?u={}:"object"==typeof u&&("from"in u||"to"in u)&&(l=iu(t(u.from),t(u.to)),u={},u.ms=l.milliseconds,u.M=l.months),c=new st(u),t.isDuration(n)&&p(n,"_locale")&&(c._locale=n._locale),c},t.version="2.9.0",t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.ISO_8601=function(){},t.momentProperties=ft,t.updateOffset=function(){},t.relativeTimeThreshold=function(t,i){return y[t]===n?!1:i===n?y[t]:(y[t]=i,!0)},t.lang=o("moment.lang is deprecated. Use moment.locale instead.",function(n,i){return t.locale(n,i)}),t.locale=function(n,i){var r;return n&&(r="undefined"!=typeof i?t.defineLocale(n,i):t.localeData(n),r&&(t.duration._locale=t._locale=r)),t._locale._abbr},t.defineLocale=function(n,i){return null!==i?(i.abbr=n,tt[n]||(tt[n]=new fi),tt[n].set(i),t.locale(n),tt[n]):(delete tt[n],null)},t.langData=o("moment.langData is deprecated. Use moment.localeData instead.",function(n){return t.localeData(n)}),t.localeData=function(n){var i;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return t._locale;if(!ut(n)){if(i=ki(n))return i;n=[n]}return uu(n)},t.isMoment=function(n){return n instanceof rt||null!=n&&p(n,"_isAMomentObject")},t.isDuration=function(n){return n instanceof st},u=kr.length-1;u>=0;--u)ru(kr[u]);t.normalizeUnits=function(n){return f(n)};t.invalid=function(n){var i=t.utc(NaN);return null!=n?w(i._pf,n):i._pf.userInvalidated=!0,i};t.parseZone=function(){return t.apply(null,arguments).parseZone()};t.parseTwoDigitYear=function(n){return i(n)+(i(n)>68?1900:2e3)};t.isDate=ht;w(t.fn=rt.prototype,{clone:function(){return t(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var n=t(this).utc();return 0<n.year()&&n.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():at(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):at(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var n=this;return[n.year(),n.month(),n.date(),n.hours(),n.minutes(),n.seconds(),n.milliseconds()]},isValid:function(){return wi(this)},isDSTShifted:function(){return this._a?this.isValid()&&ci(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray())>0:!1},parsingFlags:function(){return w({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(n){return this.utcOffset(0,n)},local:function(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(n){var i=at(this,n||t.defaultFormat);return this.localeData().postformat(i)},add:si(1,"add"),subtract:si(-1,"subtract"),diff:function(n,t,i){var r,u,e=lt(n,this),o=6e4*(e.utcOffset()-this.utcOffset());return t=f(t),"year"===t||"month"===t||"quarter"===t?(u=nu(this,e),"quarter"===t?u/=3:"year"===t&&(u/=12)):(r=this-e,u="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-o)/864e5:"week"===t?(r-o)/6048e5:r),i?u:s(u)},from:function(n,i){return t.duration({to:this,from:n}).locale(this.locale()).humanize(!i)},fromNow:function(n){return this.from(t(),n)},calendar:function(n){var r=n||t(),u=lt(r,this).startOf("day"),i=this.diff(u,"days",!0),f=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(this.localeData().calendar(f,this,t(r)))},isLeapYear:function(){return yi(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=n?(n=du(n,this.localeData()),this.add(n-t,"d")):t},month:c("Month",!0),startOf:function(n){switch(n=f(n)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===n?this.weekday(0):"isoWeek"===n&&this.isoWeekday(1),"quarter"===n&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=f(t),t===n||"millisecond"===t?this:this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(n,i){var r;return i=f("undefined"!=typeof i?i:"millisecond"),"millisecond"===i?(n=t.isMoment(n)?n:t(n),+this>+n):(r=t.isMoment(n)?+n:+t(n),r<+this.clone().startOf(i))},isBefore:function(n,i){var r;return i=f("undefined"!=typeof i?i:"millisecond"),"millisecond"===i?(n=t.isMoment(n)?n:t(n),+n>+this):(r=t.isMoment(n)?+n:+t(n),+this.clone().endOf(i)<r)},isBetween:function(n,t,i){return this.isAfter(n,i)&&this.isBefore(t,i)},isSame:function(n,i){var r;return i=f(i||"millisecond"),"millisecond"===i?(n=t.isMoment(n)?n:t(n),+this==+n):(r=+t(n),+this.clone().startOf(i)<=r&&r<=+this.clone().endOf(i))},min:o("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(n){return n=t.apply(null,arguments),this>n?this:n}),max:o("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(n){return n=t.apply(null,arguments),n>this?this:n}),zone:o("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(n,t){return null!=n?("string"!=typeof n&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}),utcOffset:function(n,i){var r,u=this._offset||0;return null!=n?("string"==typeof n&&(n=vt(n)),Math.abs(n)<16&&(n=60*n),!this._isUTC&&i&&(r=this._dateUtcOffset()),this._offset=n,this._isUTC=!0,null!=r&&this.add(r,"m"),u!==n&&(!i||this._changeInProgress?hi(this,t.duration(n-u,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?u:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(vt(this._i)),this},hasAlignedHourOffset:function(n){return n=n?t(n).utcOffset():0,(this.utcOffset()-n)%60==0},daysInMonth:function(){return ct(this.year(),this.month())},dayOfYear:function(n){var i=k((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return null==n?i:this.add(n-i,"d")},quarter:function(n){return null==n?Math.ceil((this.month()+1)/3):this.month(3*(n-1)+this.month()%3)},weekYear:function(n){var t=b(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==n?t:this.add(n-t,"y")},isoWeekYear:function(n){var t=b(this,1,4).year;return null==n?t:this.add(n-t,"y")},week:function(n){var t=this.localeData().week(this);return null==n?t:this.add(7*(n-t),"d")},isoWeek:function(n){var t=b(this,1,4).week;return null==n?t:this.add(7*(n-t),"d")},weekday:function(n){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==n?t:this.add(n-t,"d")},isoWeekday:function(n){return null==n?this.day()||7:this.day(this.day()%7?n:n-7)},isoWeeksInYear:function(){return ai(this.year(),1,4)},weeksInYear:function(){var n=this.localeData()._week;return ai(this.year(),n.dow,n.doy)},get:function(n){return n=f(n),this[n]()},set:function(n,t){var i;if("object"==typeof n)for(i in n)this.set(i,n[i]);else n=f(n),"function"==typeof this[n]&&this[n](t);return this},locale:function(i){var r;return i===n?this._locale._abbr:(r=t.localeData(i),null!=r&&(this._locale=r),this)},lang:o("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===n?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}});t.fn.millisecond=t.fn.milliseconds=c("Milliseconds",!1);t.fn.second=t.fn.seconds=c("Seconds",!1);t.fn.minute=t.fn.minutes=c("Minutes",!1);t.fn.hour=t.fn.hours=c("Hours",!0);t.fn.date=c("Date",!0);t.fn.dates=o("dates accessor is deprecated. Use date instead.",c("Date",!0));t.fn.year=c("FullYear",!0);t.fn.years=o("years accessor is deprecated. Use year instead.",c("FullYear",!0));t.fn.days=t.fn.day;t.fn.months=t.fn.month;t.fn.weeks=t.fn.week;t.fn.isoWeeks=t.fn.isoWeek;t.fn.quarters=t.fn.quarter;t.fn.toJSON=t.fn.toISOString;t.fn.isUTC=t.fn.isUtc;w(t.duration.fn=st.prototype,{_bubble:function(){var u,f,e,o=this._milliseconds,t=this._days,i=this._months,n=this._data,r=0;n.milliseconds=o%1e3;u=s(o/1e3);n.seconds=u%60;f=s(u/60);n.minutes=f%60;e=s(f/60);n.hours=e%24;t+=s(e/24);r=s(ur(t));t-=s(fr(r));i+=s(t/30);t%=30;r+=s(i/12);i%=12;n.days=t;n.months=i;n.years=r},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*i(this._months/12)},humanize:function(n){var t=nf(this,!n,this.localeData());return n&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(n,i){var r=t.duration(n,i);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(n,i){var r=t.duration(n,i);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(n){return n=f(n),this[n.toLowerCase()+"s"]()},as:function(n){var t,i;if(n=f(n),"month"===n||"year"===n)return t=this._days+this._milliseconds/864e5,i=this._months+12*ur(t),"month"===n?i:i/12;switch(t=this._days+Math.round(fr(this._months/12)),n){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 1440*t+this._milliseconds/6e4;case"second":return 86400*t+this._milliseconds/1e3;case"millisecond":return Math.floor(864e5*t)+this._milliseconds;default:throw new Error("Unknown unit "+n);}},lang:t.fn.lang,locale:t.fn.locale,toIsoString:o("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var r=Math.abs(this.years()),u=Math.abs(this.months()),f=Math.abs(this.days()),n=Math.abs(this.hours()),t=Math.abs(this.minutes()),i=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(r?r+"Y":"")+(u?u+"M":"")+(f?f+"D":"")+(n||t||i?"T":"")+(n?n+"H":"")+(t?t+"M":"")+(i?i+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}});t.duration.fn.toString=t.duration.fn.toISOString;for(u in yr)p(yr,u)&&rf(u.toLowerCase());t.duration.fn.asMilliseconds=function(){return this.as("ms")};t.duration.fn.asSeconds=function(){return this.as("s")};t.duration.fn.asMinutes=function(){return this.as("m")};t.duration.fn.asHours=function(){return this.as("h")};t.duration.fn.asDays=function(){return this.as("d")};t.duration.fn.asWeeks=function(){return this.as("weeks")};t.duration.fn.asMonths=function(){return this.as("M")};t.duration.fn.asYears=function(){return this.as("y")};t.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,r=1===i(n%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return n+r}});sr?module.exports=t:"function"==typeof define&&define.amd?(define(function(n,i,r){return r.config&&r.config()&&r.config().noGlobal===!0&&(kt.moment=or),t}),er(!0)):er()}).call(this),function(n){var t=!!~navigator.userAgent.indexOf(" AppleWebKit/");n.fn.console=function(i){function nt(){u=0;r="";l=0;ai();p=n('<div class="jquery-console-prompt-box"><\/div>');var t=n('<span class="jquery-console-prompt-label"><\/span>'),i=f.continuedPrompt?ni:f.promptLabel;p.append(t.text(i).show());t.html(t.html().replace(" ","&nbsp;"));ot=n('<span class="jquery-console-prompt"><\/span>');p.append(ot);e.append(p);s()}function ii(n){return(n.keyCode==ut.tab||n.keyCode==192)&&n.altKey}function vt(n){if(w.length!=0){l+=n;l<0?l=w.length:l>w.length&&(l=0);var t=r;r=l==0?k:w[l-1];i.historyPreserveColumn?r.length<u+1?u=r.length:u==0&&(u=r.length):u=r.length;s()}}function yt(){vt(-1)}function pt(){vt(1)}function ri(n){w.push(n);k=""}function b(){return u<r.length?(r=r.substring(0,u)+r.substring(u+1),k=r,!0):!1}function ui(){v(-1)&&(b(),s())}function wt(){b()&&s()}function fi(){while(b())s()}function ei(){f.promptText("")}function bt(){e.children(".jquery-console-prompt-box, .jquery-console-message").remove();f.report(" ");f.promptText("");f.focus()}function oi(){while(u<r.length&&!y(r[u]))b(),s();while(u<r.length&&y(r[u]))b(),s()}function si(){var t=r.split("\n"),i=t.slice(-1)[0],u=i.match(/^(\s*)/g)[0],n="\n"+u;r+=n;v(n.length);s()}function hi(){var t=r,n;typeof i.commandValidate=="function"?(n=i.commandValidate(t),n==!0||n==!1?n&&kt():h(n,"jquery-console-message-error")):kt()}function st(){var n=jQuery.fn.jquery.split("."),t=parseInt(n[0]),i=parseInt(n[1]);t==1&&i>6||t>1?e.prop({scrollTop:e.prop("scrollHeight")}):e.attr({scrollTop:e.attr("scrollHeight")})}function ci(){typeof i.cancelHandle=="function"&&i.cancelHandle()}function kt(){var t,n;typeof i.commandHandle=="function"&&(li(),ri(r),t=r,f.continuedPrompt?c?c+="\n"+r:c=r:c=undefined,c&&(t=c),n=i.commandHandle(t,function(n){h(n)}),f.continuedPrompt&&!c&&(c=r),typeof n=="boolean"?n?h():h("Command failed.","jquery-console-message-error"):typeof n=="string"?h(n,"jquery-console-message-success"):typeof n=="object"&&n.length?h(n):f.continuedPrompt&&h())}function li(){d=!1}function ai(){d=!0}function h(t,i){var f,r;if(u=-1,s(),typeof t=="string")ht(t,i);else if(n.isArray(t))for(f in t)r=t[f],ht(r.msg,r.className);else e.append(t);nt()}function vi(n,t){var i=r;p.remove();h(n,t);f.promptText(i)}function ht(t,i){var r=n('<div class="jquery-console-message"><\/div>');i&&r.addClass(i);r.filledText(t).hide();e.append(r);r.show()}function v(n){return u+n>=0&&u+n<=r.length?(u+=n,!0):!1}function tt(){return v(1)?(s(),!0):!1}function it(){return v(-1)?(s(),!0):!1}function dt(){v(-u)&&s()}function gt(){v(r.length-u)&&s()}function yi(){while(u<r.length&&!y(r[u])&&tt());while(u<r.length&&y(r[u])&&tt());}function pi(){while(u-1>=0&&!y(r[u-1])&&it());while(u-1>=0&&y(r[u-1])&&it());}function y(n){if(typeof n=="string"){var t=n.charCodeAt();return t>="A".charCodeAt()&&t<="Z".charCodeAt()||t>="a".charCodeAt()&&t<="z".charCodeAt()||t>="0".charCodeAt()&&t<="9".charCodeAt()}return!1}function wi(){typeof i.completeHandle=="function"?bi():ki()}function bi(){var t,e,c,u,n,a,s;if(typeof i.completeHandle=="function")if(t=i.completeHandle(r),e=t.length,e===1)f.promptText(r+t[0]);else if(e>1&&i.cols){for(c=r,u=0,n=0;n<e;n++)u=Math.max(u,t[n].length);u+=2;var v=Math.floor(i.cols/u),o="",l=0;for(n=0;n<e;n++){for(a=t[n],o+=t[n],s=a.length;s<u;s++)o+=" ";++l>=v&&(o+="\n",l=0)}h(o,"jquery-console-message-value");f.promptText(c)}}function ki(){typeof i.completeIssuer=="function"&&i.completeIssuer(r)}function di(n,t){var e=t.length,c,u,r,a,s;if(e===1)f.promptText(n+t[0]);else if(e>1&&i.cols){for(c=n,u=0,r=0;r<e;r++)u=Math.max(u,t[r].length);u+=2;var v=Math.floor(i.cols/u),o="",l=0;for(r=0;r<e;r++){for(a=t[r],o+=t[r],s=a.length;s<u;s++)o+=" ";++l>=v&&(o+="\n",l=0)}h(o,"jquery-console-message-value");f.promptText(c)}}function gi(){}function s(){var n=r,i="",f,t,e;u>0&&n==""?i=at:u==r.length?i=rt(n)+at:(f=n.substring(0,u),t=n.substring(u,u+1),t&&(t='<span class="jquery-console-cursor">'+rt(t)+"<\/span>"),e=n.substring(u+1),i=rt(f)+t+rt(e));ot.html(i);st()}function rt(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br />")}var ut={37:it,39:tt,38:yt,40:pt,8:ui,46:wt,35:gt,36:dt,13:hi,18:gi,9:wi},ft={65:dt,69:gt,68:wt,78:pt,80:yt,66:it,70:tt,75:fi,76:bt,85:ei},g;i.ctrlCodes&&n.extend(ft,i.ctrlCodes);var ct={70:yi,66:pi,68:oi},lt={13:si},at='<span class="jquery-console-cursor">&nbsp;<\/span>',et=n(this),e=n('<div class="jquery-console-inner"><\/div>'),o=n('<textarea autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="jquery-console-typer"><\/textarea>'),p,ot,ni=i&&i.continuedPromptLabel?i.continuedPromptLabel:"> ",u=0,r="",k="",c="",ti=i.fadeOnReset!==undefined?i.fadeOnReset:!0,w=[],l=0,a=0,d=!0,f={};return function(){f.promptLabel=i&&i.promptLabel?i.promptLabel:"> ";et.append(e);e.append(o);o.css({position:"absolute",top:0,left:"-9999px"});i.welcomeMessage&&ht(i.welcomeMessage,"jquery-console-welcome");nt();i.autofocus&&(e.addClass("jquery-console-focus"),o.focus(),setTimeout(function(){e.addClass("jquery-console-focus");o.focus()},100));f.inner=e;f.typer=o;f.scrollToBottom=st;f.report=vi;f.showCompletion=di;f.clearScreen=bt}(),f.reset=function(){var t=typeof i.welcomeMessage!="undefined",r=function(){e.find("div").each(function(){t?t=!1:n(this).remove()})};ti?e.parent().fadeOut(function(){r();nt();e.parent().fadeIn(g)}):(r(),nt(),g())},g=function(){e.addClass("jquery-console-focus");o.focus()},f.focus=function(){g()},f.notice=function(t,i){var r=n('<div class="notice"><\/div>').append(n("<div><\/div>").text(t)).css({visibility:"hidden"}),u,f,o;return et.append(r),u=!0,i=="fadeout"?setTimeout(function(){r.fadeOut(function(){r.remove()})},4e3):i=="prompt"&&(f=n('<br/><div class="action"><a href="javascript:">OK<\/a><div class="clear"><\/div><\/div>'),r.append(f),u=!1,f.click(function(){r.fadeOut(function(){r.remove();e.css({opacity:1})})})),o=r.height(),r.css({height:"0px",visibility:"visible"}).animate({height:o+"px"},function(){u||e.css({opacity:.5})}),r.css("cursor","default"),r},et.click(function(){return window.getSelection().toString()?!1:(e.addClass("jquery-console-focus"),e.removeClass("jquery-console-nofocus"),t?o.focusWithoutScrolling():o.css("position","fixed").focus(),st(),!1)}),o.blur(function(){e.removeClass("jquery-console-focus");e.addClass("jquery-console-nofocus")}),o.bind("paste",function(){o.val("");setTimeout(function(){o.consoleInsert(o.val());o.val("")},0)}),o.keydown(function(n){a=0;var t=n.keyCode;if(n.ctrlKey&&t==67)return a=t,ci(),!1;if(d){if(n.shiftKey&&t in lt)return a=t,lt[t](),!1;if(n.altKey&&t in ct)return a=t,ct[t](),!1;if(n.ctrlKey&&t in ft)return a=t,ft[t](),!1;if(t in ut)return a=t,ut[t](),!1}}),o.keypress(function(n){var u=n.keyCode||n.which;if(ii(n))return!1;if((n.ctrlKey||n.metaKey)&&String.fromCharCode(u).toLowerCase()=="v")return!0;if(d&&a!=u&&u>=32){if(a)return!1;(typeof i.charInsertTrigger=="undefined"||typeof i.charInsertTrigger=="function"&&i.charInsertTrigger(u,r))&&o.consoleInsert(u)}if(t)return!1}),o.consoleInsert=function(n){var t=typeof n=="number"?String.fromCharCode(n):n,i=r.substring(0,u),f=r.substring(u);r=i+t+f;v(t.length);k=r;s()},f.promptText=function(n){return typeof n=="string"&&(r=n,u=r.length,s()),r},f};n.fn.filledText=function(t){return n(this).text(t),n(this).html(n(this).html().replace(/\t/g,"&nbsp;&nbsp;").replace(/\n/g,"<br/>")),this};n.fn.focusWithoutScrolling=function(){var t=window.scrollX,i=window.scrollY;n(this).focus();window.scrollTo(t,i)}}(jQuery);
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 2.1.1
 *
 * Copyright 2016 Nick Downie
 * Released under the MIT license
 * https://github.com/chartjs/Chart.js/blob/master/LICENSE.md
 */
(function e(n,t,i){function r(u,e){var s,h,o;if(!t[u]){if(!n[u]){if(s=typeof require=="function"&&require,!e&&s)return s(u,!0);if(f)return f(u,!0);h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h;}o=t[u]={exports:{}};n[u][0].call(o.exports,function(t){var i=n[u][1][t];return r(i?i:t)},o,o.exports,e,n,t,i)}return t[u].exports}for(var f=typeof require=="function"&&require,u=0;u<i.length;u++)r(i[u]);return r})({1:[function(n,t){function u(n){var t;if(n){var f=[0,0,0],e=1,u=n.match(/^#([a-fA-F0-9]{3})$/);if(u)for(u=u[1],t=0;t<f.length;t++)f[t]=parseInt(u[t]+u[t],16);else if(u=n.match(/^#([a-fA-F0-9]{6})$/))for(u=u[1],t=0;t<f.length;t++)f[t]=parseInt(u.slice(t*2,t*2+2),16);else if(u=n.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(t=0;t<f.length;t++)f[t]=parseInt(u[t+1]);e=parseFloat(u[4])}else if(u=n.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(t=0;t<f.length;t++)f[t]=Math.round(parseFloat(u[t+1])*2.55);e=parseFloat(u[4])}else if(u=n.match(/(\w+)/)){if(u[1]=="transparent")return[0,0,0,0];if(f=r[u[1]],!f)return}for(t=0;t<f.length;t++)f[t]=i(f[t],0,255);return e=e||e==0?i(e,0,1):1,f[3]=e,f}}function f(n){var r,t;if(n&&(r=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,t=n.match(r),t)){var u=parseFloat(t[4]),f=i(parseInt(t[1]),0,360),e=i(parseFloat(t[2]),0,100),o=i(parseFloat(t[3]),0,100),s=i(isNaN(u)?1:u,0,1);return[f,e,o,s]}}function h(n){var r,t;if(n&&(r=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,t=n.match(r),t)){var u=parseFloat(t[4]),f=i(parseInt(t[1]),0,360),e=i(parseFloat(t[2]),0,100),o=i(parseFloat(t[3]),0,100),s=i(isNaN(u)?1:u,0,1);return[f,e,o,s]}}function v(n){var t=u(n);return t&&t.slice(0,3)}function y(n){var t=f(n);return t&&t.slice(0,3)}function p(n){var t=u(n);return t?t[3]:(t=f(n))||(t=h(n))?t[3]:void 0}function w(n){return"#"+e(n[0])+e(n[1])+e(n[2])}function b(n,t){return t<1||n[3]&&n[3]<1?c(n,t):"rgb("+n[0]+", "+n[1]+", "+n[2]+")"}function c(n,t){return t===undefined&&(t=n[3]!==undefined?n[3]:1),"rgba("+n[0]+", "+n[1]+", "+n[2]+", "+t+")"}function k(n,t){if(t<1||n[3]&&n[3]<1)return l(n,t);var i=Math.round(n[0]/255*100),r=Math.round(n[1]/255*100),u=Math.round(n[2]/255*100);return"rgb("+i+"%, "+r+"%, "+u+"%)"}function l(n,t){var i=Math.round(n[0]/255*100),r=Math.round(n[1]/255*100),u=Math.round(n[2]/255*100);return"rgba("+i+"%, "+r+"%, "+u+"%, "+(t||n[3]||1)+")"}function d(n,t){return t<1||n[3]&&n[3]<1?a(n,t):"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)"}function a(n,t){return t===undefined&&(t=n[3]!==undefined?n[3]:1),"hsla("+n[0]+", "+n[1]+"%, "+n[2]+"%, "+t+")"}function g(n,t){return t===undefined&&(t=n[3]!==undefined?n[3]:1),"hwb("+n[0]+", "+n[1]+"%, "+n[2]+"%"+(t!==undefined&&t!==1?", "+t:"")+")"}function nt(n){return o[n.slice(0,3)]}function i(n,t,i){return Math.min(Math.max(t,n),i)}function e(n){var t=n.toString(16).toUpperCase();return t.length<2?"0"+t:t}var r=n("color-name"),o,s;t.exports={getRgba:u,getHsla:f,getRgb:v,getHsl:y,getHwb:h,getAlpha:p,hexString:w,rgbString:b,rgbaString:c,percentString:k,percentaString:l,hslString:d,hslaString:a,hwbString:g,keyword:nt};o={};for(s in r)o[r[s]]=s},{"color-name":5}],2:[function(n,t){var u=n("color-convert"),i=n("chartjs-color-string"),r=function(n){var t;if(n instanceof r)return n;if(!(this instanceof r))return new r(n);if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},typeof n=="string")if(t=i.getRgba(n),t)this.setValues("rgb",t);else if(t=i.getHsla(n))this.setValues("hsl",t);else if(t=i.getHwb(n))this.setValues("hwb",t);else throw new Error('Unable to parse color from string "'+n+'"');else if(typeof n=="object")if(t=n,t.r!==undefined||t.red!==undefined)this.setValues("rgb",t);else if(t.l!==undefined||t.lightness!==undefined)this.setValues("hsl",t);else if(t.v!==undefined||t.value!==undefined)this.setValues("hsv",t);else if(t.w!==undefined||t.whiteness!==undefined)this.setValues("hwb",t);else if(t.c!==undefined||t.cyan!==undefined)this.setValues("cmyk",t);else throw new Error("Unable to parse color from object "+JSON.stringify(n));};r.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){return this.values.alpha!==1?this.values.hwb.concat([this.values.alpha]):this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var n=this.values.rgb;return n.concat([this.values.alpha])},hslaArray:function(){var n=this.values.hsl;return n.concat([this.values.alpha])},alpha:function(n){return n===undefined?this.values.alpha:(this.setValues("alpha",n),this)},red:function(n){return this.setChannel("rgb",0,n)},green:function(n){return this.setChannel("rgb",1,n)},blue:function(n){return this.setChannel("rgb",2,n)},hue:function(n){return this.setChannel("hsl",0,n)},saturation:function(n){return this.setChannel("hsl",1,n)},lightness:function(n){return this.setChannel("hsl",2,n)},saturationv:function(n){return this.setChannel("hsv",1,n)},whiteness:function(n){return this.setChannel("hwb",1,n)},blackness:function(n){return this.setChannel("hwb",2,n)},value:function(n){return this.setChannel("hsv",2,n)},cyan:function(n){return this.setChannel("cmyk",0,n)},magenta:function(n){return this.setChannel("cmyk",1,n)},yellow:function(n){return this.setChannel("cmyk",2,n)},black:function(n){return this.setChannel("cmyk",3,n)},hexString:function(){return i.hexString(this.values.rgb)},rgbString:function(){return i.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return i.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return i.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return i.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return i.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return i.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return i.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){return this.values.rgb[0]<<16|this.values.rgb[1]<<8|this.values.rgb[2]},luminosity:function(){for(var i,r=this.values.rgb,n=[],t=0;t<r.length;t++)i=r[t]/255,n[t]=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4);return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(n){var t=this.luminosity(),i=n.luminosity();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)},level:function(n){var t=this.contrast(n);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var n=this.values.rgb,t=(n[0]*299+n[1]*587+n[2]*114)/1e3;return t<128},light:function(){return!this.dark()},negate:function(){for(var t=[],n=0;n<3;n++)t[n]=255-this.values.rgb[n];return this.setValues("rgb",t),this},lighten:function(n){return this.values.hsl[2]+=this.values.hsl[2]*n,this.setValues("hsl",this.values.hsl),this},darken:function(n){return this.values.hsl[2]-=this.values.hsl[2]*n,this.setValues("hsl",this.values.hsl),this},saturate:function(n){return this.values.hsl[1]+=this.values.hsl[1]*n,this.setValues("hsl",this.values.hsl),this},desaturate:function(n){return this.values.hsl[1]-=this.values.hsl[1]*n,this.setValues("hsl",this.values.hsl),this},whiten:function(n){return this.values.hwb[1]+=this.values.hwb[1]*n,this.setValues("hwb",this.values.hwb),this},blacken:function(n){return this.values.hwb[2]+=this.values.hwb[2]*n,this.setValues("hwb",this.values.hwb),this},greyscale:function(){var n=this.values.rgb,t=n[0]*.3+n[1]*.59+n[2]*.11;return this.setValues("rgb",[t,t,t]),this},clearer:function(n){return this.setValues("alpha",this.values.alpha-this.values.alpha*n),this},opaquer:function(n){return this.setValues("alpha",this.values.alpha+this.values.alpha*n),this},rotate:function(n){var t=this.values.hsl[0];return t=(t+n)%360,t=t<0?360+t:t,this.values.hsl[0]=t,this.setValues("hsl",this.values.hsl),this},mix:function(n,t){var i,o;t=1-(t==null?.5:t);var r=t*2-1,f=this.alpha()-n.alpha(),e=((r*f==-1?r:(r+f)/(1+r*f))+1)/2,s=1-e,u=this.rgbArray(),h=n.rgbArray();for(i=0;i<u.length;i++)u[i]=u[i]*e+h[i]*s;return this.setValues("rgb",u),o=this.alpha()*t+n.alpha()*(1-t),this.setValues("alpha",o),this},toJSON:function(){return this.rgb()},clone:function(){return new r(this.rgb())}};r.prototype.getValues=function(n){for(var i={},t=0;t<n.length;t++)i[n.charAt(t)]=this.values[n][t];return this.values.alpha!=1&&(i.a=this.values.alpha),i};r.prototype.setValues=function(n,t){var o={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},s={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},f=1,h,r,i,e;if(n=="alpha")f=t;else if(t.length)this.values[n]=t.slice(0,n.length),f=t[n.length];else if(t[n.charAt(0)]!==undefined){for(i=0;i<n.length;i++)this.values[n][i]=t[n.charAt(i)];f=t.a}else if(t[o[n][0]]!==undefined){for(h=o[n],i=0;i<n.length;i++)this.values[n][i]=t[h[i]];f=t.alpha}if(this.values.alpha=Math.max(0,Math.min(1,f!==undefined?f:this.values.alpha)),n!="alpha"){for(i=0;i<n.length;i++)e=Math.max(0,Math.min(s[n][i],this.values[n][i])),this.values[n][i]=Math.round(e);for(r in o)for(r!=n&&(this.values[r]=u[n][r](this.values[n])),i=0;i<r.length;i++)e=Math.max(0,Math.min(s[r][i],this.values[r][i])),this.values[r][i]=Math.round(e);return!0}};r.prototype.setSpace=function(n,t){var i=t[0];return i===undefined?this.getValues(n):(typeof i=="number"&&(i=Array.prototype.slice.call(t)),this.setValues(n,i),this)};r.prototype.setChannel=function(n,t,i){return i===undefined?this.values[n][t]:(this.values[n][t]=i,this.setValues(n,this.values[n]),this)};window.Color=t.exports=r},{"chartjs-color-string":1,"color-convert":4}],3:[function(n,t){function u(n){var u=n[0]/255,f=n[1]/255,e=n[2]/255,r=Math.min(u,f,e),t=Math.max(u,f,e),o=t-r,i,h,s;return t==r?i=0:u==t?i=(f-e)/o:f==t?i=2+(e-u)/o:e==t&&(i=4+(u-f)/o),i=Math.min(i*60,360),i<0&&(i+=360),s=(r+t)/2,h=t==r?0:s<=.5?o/(t+r):o/(2-t-r),[i,h*100,s*100]}function c(n){var r=n[0],u=n[1],f=n[2],o=Math.min(r,u,f),i=Math.max(r,u,f),e=i-o,t,s,h;return s=i==0?0:e/i*100,i==o?t=0:r==i?t=(u-f)/e:u==i?t=2+(f-r)/e:f==i&&(t=4+(r-u)/e),t=Math.min(t*60,360),t<0&&(t+=360),h=i/255*100,[t,s,h]}function f(n){var i=n[0],r=n[1],t=n[2],f=u(n)[0],e=1/255*Math.min(i,Math.min(r,t)),t=1-1/255*Math.max(i,Math.max(r,t));return[f,e*100,t*100]}function e(n){var i=n[0]/255,r=n[1]/255,u=n[2]/255,f,e,o,t;return t=Math.min(1-i,1-r,1-u),f=(1-i-t)/(1-t)||0,e=(1-r-t)/(1-t)||0,o=(1-u-t)/(1-t)||0,[f*100,e*100,o*100,t*100]}function o(n){return nt[JSON.stringify(n)]}function y(n){var t=n[0]/255,i=n[1]/255,r=n[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92;i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var u=t*.4124+i*.3576+r*.1805,f=t*.2126+i*.7152+r*.0722,e=t*.0193+i*.1192+r*.9505;return[u*100,f*100,e*100]}function p(n){var u=y(n),i=u[0],t=u[1],r=u[2],f,e,o;return i/=95.047,t/=100,r/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,f=116*t-16,e=500*(i-t),o=200*(t-r),[f,e,o]}function ft(n){return k(p(n))}function l(n){var h=n[0]/360,o=n[1]/100,i=n[2]/100,r,f,t,s,u,e;if(o==0)return u=i*255,[u,u,u];for(f=i<.5?i*(1+o):i+o-i*o,r=2*i-f,s=[0,0,0],e=0;e<3;e++)t=h+1/3*-(e-1),t<0&&t++,t>1&&t--,u=6*t<1?r+(f-r)*6*t:2*t<1?f:3*t<2?r+(f-r)*(2/3-t)*6:r,s[e]=u*255;return s}function et(n){var f=n[0],i=n[1]/100,t=n[2]/100,r,u;return t===0?[0,0,0]:(t*=2,i*=t<=1?t:2-t,u=(t+i)/2,r=2*i/(t+i),[f,r*100,u*100])}function ot(n){return f(l(n))}function st(n){return e(l(n))}function ht(n){return o(l(n))}function a(n){var r=n[0]/60,u=n[1]/100,t=n[2]/100,s=Math.floor(r)%6,o=r-Math.floor(r),i=255*t*(1-u),f=255*t*(1-u*o),e=255*t*(1-u*(1-o)),t=255*t;switch(s){case 0:return[t,e,i];case 1:return[f,t,i];case 2:return[i,t,e];case 3:return[i,f,t];case 4:return[e,i,t];case 5:return[t,i,f]}}function ct(n){var f=n[0],r=n[1]/100,u=n[2]/100,i,t;return t=(2-r)*u,i=r*u,i/=t<=1?t:2-t,i=i||0,t/=2,[f,i*100,t*100]}function lt(n){return f(a(n))}function at(n){return e(a(n))}function vt(n){return o(a(n))}function s(n){var h=n[0]/360,t=n[1]/100,o=n[2]/100,s=t+o,f,i,e,u;s>1&&(t/=s,o/=s);f=Math.floor(6*h);i=1-o;e=6*h-f;(f&1)!=0&&(e=1-e);u=t+e*(i-t);switch(f){default:case 6:case 0:r=i;g=u;b=t;break;case 1:r=u;g=i;b=t;break;case 2:r=t;g=i;b=u;break;case 3:r=t;g=u;b=i;break;case 4:r=u;g=t;b=i;break;case 5:r=i;g=t;b=u}return[r*255,g*255,b*255]}function yt(n){return u(s(n))}function pt(n){return c(s(n))}function wt(n){return e(s(n))}function bt(n){return o(s(n))}function h(n){var f=n[0]/100,e=n[1]/100,o=n[2]/100,t=n[3]/100,i,r,u;return i=1-Math.min(1,f*(1-t)+t),r=1-Math.min(1,e*(1-t)+t),u=1-Math.min(1,o*(1-t)+t),[i*255,r*255,u*255]}function kt(n){return u(h(n))}function dt(n){return c(h(n))}function gt(n){return f(h(n))}function ni(n){return o(h(n))}function it(n){var u=n[0]/100,f=n[1]/100,e=n[2]/100,t,i,r;return t=u*3.2406+f*-1.5372+e*-.4986,i=u*-.9689+f*1.8758+e*.0415,r=u*.0557+f*-.204+e*1.057,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:t=t*12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i=i*12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=r*12.92,t=Math.min(Math.max(0,t),1),i=Math.min(Math.max(0,i),1),r=Math.min(Math.max(0,r),1),[t*255,i*255,r*255]}function rt(n){var i=n[0],t=n[1],r=n[2],u,f,e;return i/=95.047,t/=100,r/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,u=116*t-16,f=500*(i-t),e=200*(t-r),[u,f,e]}function ti(n){return k(rt(n))}function w(n){var f=n[0],e=n[1],o=n[2],r,i,u,t;return f<=8?(i=f*100/903.3,t=7.787*(i/100)+16/116):(i=100*Math.pow((f+16)/116,3),t=Math.pow(i/100,1/3)),r=r/95.047<=.008856?r=95.047*(e/500+t-16/116)/7.787:95.047*Math.pow(e/500+t,3),u=u/108.883<=.008859?u=108.883*(t-o/200-16/116)/7.787:108.883*Math.pow(t-o/200,3),[r,i,u]}function k(n){var e=n[0],i=n[1],r=n[2],u,t,f;return u=Math.atan2(r,i),t=u*180/Math.PI,t<0&&(t+=360),f=Math.sqrt(i*i+r*r),[e,f,t]}function ut(n){return it(w(n))}function d(n){var f=n[0],i=n[1],e=n[2],r,u,t;return t=e/180*Math.PI,r=i*Math.cos(t),u=i*Math.sin(t),[f,r,u]}function ii(n){return w(d(n))}function ri(n){return ut(d(n))}function i(n){return v[n]}function ui(n){return u(i(n))}function fi(n){return c(i(n))}function ei(n){return f(i(n))}function oi(n){return e(i(n))}function si(n){return p(i(n))}function hi(n){return y(i(n))}var v,nt,tt;t.exports={rgb2hsl:u,rgb2hsv:c,rgb2hwb:f,rgb2cmyk:e,rgb2keyword:o,rgb2xyz:y,rgb2lab:p,rgb2lch:ft,hsl2rgb:l,hsl2hsv:et,hsl2hwb:ot,hsl2cmyk:st,hsl2keyword:ht,hsv2rgb:a,hsv2hsl:ct,hsv2hwb:lt,hsv2cmyk:at,hsv2keyword:vt,hwb2rgb:s,hwb2hsl:yt,hwb2hsv:pt,hwb2cmyk:wt,hwb2keyword:bt,cmyk2rgb:h,cmyk2hsl:kt,cmyk2hsv:dt,cmyk2hwb:gt,cmyk2keyword:ni,keyword2rgb:i,keyword2hsl:ui,keyword2hsv:fi,keyword2hwb:ei,keyword2cmyk:oi,keyword2lab:si,keyword2xyz:hi,xyz2rgb:it,xyz2lab:rt,xyz2lch:ti,lab2xyz:w,lab2rgb:ut,lab2lch:k,lch2lab:d,lch2xyz:ii,lch2rgb:ri};v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};nt={};for(tt in v)nt[JSON.stringify(v[tt])]=tt},{}],4:[function(n,t){var f=n("./conversions"),i=function(){return new u},r,u;for(r in f){i[r+"Raw"]=function(n){return function(t){return typeof t=="number"&&(t=Array.prototype.slice.call(arguments)),f[n](t)}}(r);var o=/(\w+)2(\w+)/.exec(r),e=o[1],s=o[2];i[e]=i[e]||{};i[e][s]=i[r]=function(n){return function(t){var i,r;if(typeof t=="number"&&(t=Array.prototype.slice.call(arguments)),i=f[n](t),typeof i=="string"||i===undefined)return i;for(r=0;r<i.length;r++)i[r]=Math.round(i[r]);return i}}(r)}u=function(){this.convs={}};u.prototype.routeSpace=function(n,t){var i=t[0];return i===undefined?this.getValues(n):(typeof i=="number"&&(i=Array.prototype.slice.call(t)),this.setValues(n,i))};u.prototype.setValues=function(n,t){return this.space=n,this.convs={},this.convs[n]=t,this};u.prototype.getValues=function(n){var t=this.convs[n],r,u;return t||(r=this.space,u=this.convs[r],t=i[r][n](u),this.convs[n]=t),t};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(n){u.prototype[n]=function(){return this.routeSpace(n,arguments)}});t.exports=i},{"./conversions":3}],5:[function(n,t){t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],6:[function(n,t,i){
//! moment.js
//! version : 2.13.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(n,r){typeof i=="object"&&typeof t!="undefined"?t.exports=r():typeof define=="function"&&define.amd?define(r):n.moment=r()})(this,function(){"use strict";function r(){return tf.apply(null,arguments)}function ys(n){tf=n}function bt(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function yi(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function rf(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function k(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function kt(n,t){for(var i in t)k(t,i)&&(n[i]=t[i]);return k(t,"toString")&&(n.toString=t.toString),k(t,"valueOf")&&(n.valueOf=t.valueOf),n}function ut(n,t,i,r){return le(n,t,i,r,!0).utc()}function ps(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function o(n){return n._pf==null&&(n._pf=ps()),n._pf}function yr(n){if(n._isValid==null){var t=o(n),i=uf.call(t.parsedDateParts,function(n){return n!=null});n._isValid=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);n._strict&&(n._isValid=n._isValid&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined)}return n._isValid}function pi(n){var t=ut(NaN);return n!=null?kt(o(t),n):o(t).userInvalidated=!0,t}function b(n){return n===void 0}function pr(n,t){var u,i,r;if(b(t._isAMomentObject)||(n._isAMomentObject=t._isAMomentObject),b(t._i)||(n._i=t._i),b(t._f)||(n._f=t._f),b(t._l)||(n._l=t._l),b(t._strict)||(n._strict=t._strict),b(t._tzm)||(n._tzm=t._tzm),b(t._isUTC)||(n._isUTC=t._isUTC),b(t._offset)||(n._offset=t._offset),b(t._pf)||(n._pf=o(t)),b(t._locale)||(n._locale=t._locale),wi.length>0)for(u in wi)i=wi[u],r=t[i],b(r)||(n[i]=r);return n}function hi(n){pr(this,n);this._d=new Date(n._d!=null?n._d.getTime():NaN);bi===!1&&(bi=!0,r.updateOffset(this),bi=!1)}function lt(n){return n instanceof hi||n!=null&&n._isAMomentObject!=null}function d(n){return n<0?Math.ceil(n):Math.floor(n)}function s(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=d(t)),i}function ff(n,t,i){for(var f=Math.min(n.length,t.length),e=Math.abs(n.length-t.length),u=0,r=0;r<f;r++)(i&&n[r]!==t[r]||!i&&s(n[r])!==s(t[r]))&&u++;return u+e}function ef(n){r.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+n)}function nt(n,t){var i=!0;return kt(function(){return r.deprecationHandler!=null&&r.deprecationHandler(null,n),i&&(ef(n+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),i=!1),t.apply(this,arguments)},t)}function br(n,t){r.deprecationHandler!=null&&r.deprecationHandler(n,t);wr[n]||(ef(t),wr[n]=!0)}function at(n){return n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function of(n){return Object.prototype.toString.call(n)==="[object Object]"}function ws(n){var t;for(var i in n)t=n[i],at(t)?this[i]=t:this["_"+i]=t;this._config=n;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function kr(n,t){var r=kt({},n);for(var i in t)k(t,i)&&(of(n[i])&&of(t[i])?(r[i]={},kt(r[i],n[i]),kt(r[i],t[i])):t[i]!=null?r[i]=t[i]:delete r[i]);return r}function dr(n){n!=null&&this.set(n)}function hf(n){return n?n.toLowerCase().replace("_","-"):n}function bs(n){for(var r=0,i,t,f,u;r<n.length;){for(u=hf(n[r]).split("-"),i=u.length,t=hf(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=cf(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&ff(u,t,!0)>=i-1)break;i--}r++}return null}function cf(i){var r=null;if(!v[i]&&typeof t!="undefined"&&t&&t.exports)try{r=ki._abbr;n("./locale/"+i);ui(r)}catch(u){}return v[i]}function ui(n,t){var i;return n&&(i=b(t)?vt(n):lf(n,t),i&&(ki=i)),ki._abbr}function lf(n,t){return t!==null?(t.abbr=n,v[n]!=null?(br("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),t=kr(v[n]._config,t)):t.parentLocale!=null&&(v[t.parentLocale]!=null?t=kr(v[t.parentLocale]._config,t):br("parentLocaleUndefined","specified parentLocale is not defined yet")),v[n]=new dr(t),ui(n),v[n]):(delete v[n],null)}function ks(n,t){if(t!=null){var i;v[n]!=null&&(t=kr(v[n]._config,t));i=new dr(t);i.parentLocale=v[n];v[n]=i;ui(n)}else v[n]!=null&&(v[n].parentLocale!=null?v[n]=v[n].parentLocale:v[n]!=null&&delete v[n]);return v[n]}function vt(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return ki;if(!bt(n)){if(t=cf(n),t)return t;n=[n]}return bs(n)}function ds(){return sf(v)}function w(n,t){var i=n.toLowerCase();fi[i]=fi[i+"s"]=fi[t]=n}function tt(n){return typeof n=="string"?fi[n]||fi[n.toLowerCase()]:undefined}function af(n){var r={},t;for(var i in n)k(n,i)&&(t=tt(i),t&&(r[t]=n[i]));return r}function ei(n,t){return function(i){return i!=null?(vf(this,n,i),r.updateOffset(this,t),this):di(this,n)}}function di(n,t){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+t]():NaN}function vf(n,t,i){n.isValid()&&n._d["set"+(n._isUTC?"UTC":"")+t](i)}function yf(n,t){var i;if(typeof n=="object")for(i in n)this.set(i,n[i]);else if(n=tt(n),at(this[n]))return this[n](t);return this}function ot(n,t,i){var r=""+Math.abs(n),u=t-r.length,f=n>=0;return(f?i?"+":"":"-")+Math.pow(10,Math.max(0,u)).toString().substr(1)+r}function f(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(oi[n]=u);t&&(oi[t[0]]=function(){return ot(u.apply(this,arguments),t[1],t[2])});i&&(oi[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function gs(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function nh(n){for(var t=n.match(pf),i=0,r=t.length;i<r;i++)t[i]=oi[t[i]]?oi[t[i]]:gs(t[i]);return function(i){for(var f="",u=0;u<r;u++)f+=t[u]instanceof Function?t[u].call(i,n):t[u];return f}}function nu(n,t){return n.isValid()?(t=wf(t,n.localeData()),gr[t]=gr[t]||nh(t),gr[t](n)):n.localeData().invalidDate()}function wf(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(gi.lastIndex=0;i>=0&&gi.test(n);)n=n.replace(gi,r),gi.lastIndex=0,i-=1;return n}function u(n,t,i){ru[n]=at(t)?t:function(n){return n&&i?i:t}}function ih(n,t){return k(ru,n)?ru[n](t._strict,t._locale):new RegExp(rh(n))}function rh(n){return dt(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}))}function dt(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function c(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),typeof t=="number"&&(r=function(n,i){i[t]=s(n)}),i=0;i<n.length;i++)fr[n[i]]=r}function li(n,t){c(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function uh(n,t,i){t!=null&&k(fr,n)&&fr[n](t,i._a,i,n)}function uu(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function oh(n,t){return bt(this._months)?this._months[n.month()]:this._months[fu.test(t)?"format":"standalone"][n.month()]}function sh(n,t){return bt(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[fu.test(t)?"format":"standalone"][n.month()]}function hh(n,t,i){var u,r,e,f=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],u=0;u<12;++u)e=ut([2e3,u]),this._shortMonthsParse[u]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[u]=this.months(e,"").toLocaleLowerCase();return i?t==="MMM"?(r=y.call(this._shortMonthsParse,f),r!==-1?r:null):(r=y.call(this._longMonthsParse,f),r!==-1?r:null):t==="MMM"?(r=y.call(this._shortMonthsParse,f),r!==-1)?r:(r=y.call(this._longMonthsParse,f),r!==-1?r:null):(r=y.call(this._longMonthsParse,f),r!==-1)?r:(r=y.call(this._shortMonthsParse,f),r!==-1?r:null)}function ch(n,t,i){var r,u,f;if(this._monthsParseExact)return hh.call(this,n,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=ut([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function ie(n,t){var i;if(!n.isValid())return n;if(typeof t=="string")if(/^\d+$/.test(t))t=s(t);else if(t=n.localeData().monthsParse(t),typeof t!="number")return n;return i=Math.min(n.date(),uu(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n}function re(n){return n!=null?(ie(this,n),r.updateOffset(this,!0),this):di(this,"Month")}function lh(){return uu(this.year(),this.month())}function ah(n){return this._monthsParseExact?(k(this,"_monthsRegex")||ee.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex}function vh(n){return this._monthsParseExact?(k(this,"_monthsRegex")||ee.call(this),n?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex}function ee(){function f(n,t){return t.length-n.length}for(var i=[],r=[],t=[],u,n=0;n<12;n++)u=ut([2e3,n]),i.push(this.monthsShort(u,"")),r.push(this.months(u,"")),t.push(this.months(u,"")),t.push(this.monthsShort(u,""));for(i.sort(f),r.sort(f),t.sort(f),n=0;n<12;n++)i[n]=dt(i[n]),r[n]=dt(r[n]),t[n]=dt(t[n]);this._monthsRegex=new RegExp("^("+t.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function eu(n){var i,t=n._a;return t&&o(n).overflow===-2&&(i=t[st]<0||t[st]>11?st:t[ft]<1||t[ft]>uu(t[it],t[st])?ft:t[p]<0||t[p]>24||t[p]===24&&(t[rt]!==0||t[ht]!==0||t[gt]!==0)?p:t[rt]<0||t[rt]>59?rt:t[ht]<0||t[ht]>59?ht:t[gt]<0||t[gt]>999?gt:-1,o(n)._overflowDayOfYear&&(i<it||i>ft)&&(i=ft),o(n)._overflowWeeks&&i===-1&&(i=fh),o(n)._overflowWeekday&&i===-1&&(i=eh),o(n).overflow=i),n}function oe(n){var t,r,e=n._i,i=yh.exec(e)||ph.exec(e),s,f,u,h;if(i){for(o(n).iso=!0,t=0,r=er.length;t<r;t++)if(er[t][1].exec(i[1])){f=er[t][0];s=er[t][2]!==!1;break}if(f==null){n._isValid=!1;return}if(i[3]){for(t=0,r=ou.length;t<r;t++)if(ou[t][1].exec(i[3])){u=(i[2]||" ")+ou[t][0];break}if(u==null){n._isValid=!1;return}}if(!s&&u!=null){n._isValid=!1;return}if(i[4])if(wh.exec(i[4]))h="Z";else{n._isValid=!1;return}n._f=f+(u||"")+(h||"");cu(n)}else n._isValid=!1}function kh(n){var t=bh.exec(n._i);if(t!==null){n._d=new Date(+t[1]);return}oe(n);n._isValid===!1&&(delete n._isValid,r.createFromInputFallback(n))}function dh(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<100&&n>=0&&isFinite(o.getFullYear())&&o.setFullYear(n),o}function or(n){var t=new Date(Date.UTC.apply(null,arguments));return n<100&&n>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(n),t}function ai(n){return se(n)?366:365}function se(n){return n%4==0&&n%100!=0||n%400==0}function gh(){return se(this.year())}function sr(n,t,i){var r=7+t-i,u=(7+or(n,0,r).getUTCDay()-t)%7;return-u+r-1}function he(n,t,i,r,u){var s=(7+i-r)%7,h=sr(n,r,u),f=1+7*(t-1)+s+h,e,o;return f<=0?(e=n-1,o=ai(e)+f):f>ai(n)?(e=n+1,o=f-ai(n)):(e=n,o=f),{year:e,dayOfYear:o}}function vi(n,t,i){var e=sr(n.year(),t,i),r=Math.floor((n.dayOfYear()-e-1)/7)+1,f,u;return r<1?(u=n.year()-1,f=r+ni(u,t,i)):r>ni(n.year(),t,i)?(f=r-ni(n.year(),t,i),u=n.year()+1):(u=n.year(),f=r),{week:f,year:u}}function ni(n,t,i){var r=sr(n,t,i),u=sr(n+1,t,i);return(ai(n)-r+u)/7}function si(n,t,i){return n!=null?n:t!=null?t:i}function nc(n){var t=new Date(r.now());return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function hu(n){var t,i,r=[],u,f;if(!n._d){for(u=nc(n),n._w&&n._a[ft]==null&&n._a[st]==null&&tc(n),n._dayOfYear&&(f=si(n._a[it],u[it]),n._dayOfYear>ai(f)&&(o(n)._overflowDayOfYear=!0),i=or(f,0,n._dayOfYear),n._a[st]=i.getUTCMonth(),n._a[ft]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=u[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[p]===24&&n._a[rt]===0&&n._a[ht]===0&&n._a[gt]===0&&(n._nextDay=!0,n._a[p]=0);n._d=(n._useUTC?or:dh).apply(null,r);n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[p]=24)}}function tc(n){var t,e,u,i,r,f,h,s;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(r=1,f=4,e=si(t.GG,n._a[it],vi(a(),1,4).year),u=si(t.W,1),i=si(t.E,1),(i<1||i>7)&&(s=!0)):(r=n._locale._week.dow,f=n._locale._week.doy,e=si(t.gg,n._a[it],vi(a(),r,f).year),u=si(t.w,1),t.d!=null?(i=t.d,(i<0||i>6)&&(s=!0)):t.e!=null?(i=t.e+r,(t.e<0||t.e>6)&&(s=!0)):i=r);u<1||u>ni(e,r,f)?o(n)._overflowWeeks=!0:s!=null?o(n)._overflowWeekday=!0:(h=he(e,u,i,r,f),n._a[it]=h.year,n._dayOfYear=h.dayOfYear)}function cu(n){if(n._f===r.ISO_8601){oe(n);return}n._a=[];o(n).empty=!0;for(var t=""+n._i,i,u,s,c=t.length,h=0,e=wf(n._f,n._locale).match(pf)||[],f=0;f<e.length;f++)u=e[f],i=(t.match(ih(u,n))||[])[0],i&&(s=t.substr(0,t.indexOf(i)),s.length>0&&o(n).unusedInput.push(s),t=t.slice(t.indexOf(i)+i.length),h+=i.length),oi[u]?(i?o(n).empty=!1:o(n).unusedTokens.push(u),uh(u,i,n)):n._strict&&!i&&o(n).unusedTokens.push(u);o(n).charsLeftOver=c-h;t.length>0&&o(n).unusedInput.push(t);o(n).bigHour===!0&&n._a[p]<=12&&n._a[p]>0&&(o(n).bigHour=undefined);o(n).parsedDateParts=n._a.slice(0);o(n).meridiem=n._meridiem;n._a[p]=ic(n._locale,n._a[p],n._meridiem);hu(n);eu(n)}function ic(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function rc(n){var t,f,u,r,i;if(n._f.length===0){o(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=pr({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],cu(t),yr(t))&&(i+=o(t).charsLeftOver,i+=o(t).unusedTokens.length*10,o(t).score=i,(u==null||i<u)&&(u=i,f=t));kt(n,f||t)}function uc(n){if(!n._d){var t=af(n._i);n._a=rf([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)});hu(n)}}function fc(n){var t=new hi(eu(ce(n)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function ce(n){var t=n._i,i=n._f;return(n._locale=n._locale||vt(n._l),t===null||i===undefined&&t==="")?pi({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),lt(t))?new hi(eu(t)):(bt(i)?rc(n):i?cu(n):yi(t)?n._d=t:ec(n),yr(n)||(n._d=null),n)}function ec(n){var t=n._i;t===undefined?n._d=new Date(r.now()):yi(t)?n._d=new Date(t.valueOf()):typeof t=="string"?kh(n):bt(t)?(n._a=rf(t.slice(0),function(n){return parseInt(n,10)}),hu(n)):typeof t=="object"?uc(n):typeof t=="number"?n._d=new Date(t):r.createFromInputFallback(n)}function le(n,t,i,r,u){var f={};return typeof i=="boolean"&&(r=i,i=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,fc(f)}function a(n,t,i,r){return le(n,t,i,r,!1)}function ye(n,t){var r,i;if(t.length===1&&bt(t[0])&&(t=t[0]),!t.length)return a();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][n](r))&&(r=t[i]);return r}function oc(){var n=[].slice.call(arguments,0);return ye("isBefore",n)}function sc(){var n=[].slice.call(arguments,0);return ye("isAfter",n)}function hr(n){var t=af(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=vt();this._bubble()}function lu(n){return n instanceof hr}function we(n,t){f(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+ot(~~(n/60),2)+t+ot(~~n%60,2)})}function au(n,t){var r=(t||"").match(n)||[],f=r[r.length-1]||[],i=(f+"").match(be)||["-",0,0],u=+(i[1]*60)+s(i[2]);return i[0]==="+"?u:-u}function vu(n,t){var i,u;return t._isUTC?(i=t.clone(),u=(lt(n)||yi(n)?n.valueOf():a(n).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+u),r.updateOffset(i,!1),i):a(n).local()}function yu(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function hc(n,t){var i=this._offset||0,u;return this.isValid()?n!=null?(typeof n=="string"?n=au(ur,n):Math.abs(n)<16&&(n=n*60),!this._isUTC&&t&&(u=yu(this)),this._offset=n,this._isUTC=!0,u!=null&&this.add(u,"m"),i!==n&&(!t||this._changeInProgress?ro(this,yt(n-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:yu(this):n!=null?this:NaN}function cc(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function lc(n){return this.utcOffset(0,n)}function ac(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(yu(this),"m")),this}function vc(){return this._tzm?this.utcOffset(this._tzm):typeof this._i=="string"&&this.utcOffset(au(th,this._i)),this}function yc(n){return this.isValid()?(n=n?a(n).utcOffset():0,(this.utcOffset()-n)%60==0):!1}function pc(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wc(){var n,t;return b(this._isDSTShifted)?(n={},pr(n,this),n=ce(n),n._a?(t=n._isUTC?ut(n._a):a(n._a),this._isDSTShifted=this.isValid()&&ff(n._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted):this._isDSTShifted}function bc(){return this.isValid()?!this._isUTC:!1}function kc(){return this.isValid()?this._isUTC:!1}function ke(){return this.isValid()?this._isUTC&&this._offset===0:!1}function yt(n,t){var i=n,r=null,u,f,e;return lu(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:typeof n=="number"?(i={},t?i[t]=n:i.milliseconds=n):(r=de.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:s(r[ft])*u,h:s(r[p])*u,m:s(r[rt])*u,s:s(r[ht])*u,ms:s(r[gt])*u}):(r=ge.exec(n))?(u=r[1]==="-"?-1:1,i={y:ti(r[2],u),M:ti(r[3],u),w:ti(r[4],u),d:ti(r[5],u),h:ti(r[6],u),m:ti(r[7],u),s:ti(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(e=dc(a(i.from),a(i.to)),i={},i.ms=e.milliseconds,i.M=e.months),f=new hr(i),lu(n)&&k(n,"_locale")&&(f._locale=n._locale),f}function ti(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function no(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function dc(n,t){var i;return(n.isValid()&&t.isValid())?(t=vu(t,n),n.isBefore(t)?i=no(n,t):(i=no(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function to(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function io(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(br(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=yt(i,r),ro(this,u,n),this}}function ro(n,t,i,u){var o=t._milliseconds,f=to(t._days),e=to(t._months);n.isValid()&&(u=u==null?!0:u,o&&n._d.setTime(n._d.valueOf()+o*i),f&&vf(n,"Date",di(n,"Date")+f*i),e&&ie(n,di(n,"Month")+e*i),u&&r.updateOffset(n,f||e))}function gc(n,t){var u=n||a(),f=vu(u,this).startOf("day"),i=this.diff(f,"days",!0),r=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse",e=t&&(at(t[r])?t[r]():t[r]);return this.format(e||this.localeData().calendar(r,this,a(u)))}function nl(){return new hi(this)}function tl(n,t){var i=lt(n)?n:a(n);return(this.isValid()&&i.isValid())?(t=tt(b(t)?"millisecond":t),t==="millisecond"?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf()):!1}function il(n,t){var i=lt(n)?n:a(n);return(this.isValid()&&i.isValid())?(t=tt(b(t)?"millisecond":t),t==="millisecond"?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf()):!1}function rl(n,t,i,r){return r=r||"()",(r[0]==="("?this.isAfter(n,i):!this.isBefore(n,i))&&(r[1]===")"?this.isBefore(t,i):!this.isAfter(t,i))}function ul(n,t){var i=lt(n)?n:a(n),r;return(this.isValid()&&i.isValid())?(t=tt(t||"millisecond"),t==="millisecond"?this.valueOf()===i.valueOf():(r=i.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf())):!1}function fl(n,t){return this.isSame(n,t)||this.isAfter(n,t)}function el(n,t){return this.isSame(n,t)||this.isBefore(n,t)}function ol(n,t,i){var f,e,u,r;return this.isValid()?(f=vu(n,this),!f.isValid())?NaN:(e=(f.utcOffset()-this.utcOffset())*6e4,t=tt(t),t==="year"||t==="month"||t==="quarter"?(r=sl(this,f),t==="quarter"?r=r/3:t==="year"&&(r=r/12)):(u=this-f,r=t==="second"?u/1e3:t==="minute"?u/6e4:t==="hour"?u/36e5:t==="day"?(u-e)/864e5:t==="week"?(u-e)/6048e5:u),i?r:d(r)):NaN}function sl(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)||0}function hl(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function cl(){var n=this.clone().utc();return 0<n.year()&&n.year()<=9999?at(Date.prototype.toISOString)?this.toDate().toISOString():nu(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):nu(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ll(n){n||(n=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=nu(this,n);return this.localeData().postformat(t)}function al(n,t){return this.isValid()&&(lt(n)&&n.isValid()||a(n).isValid())?yt({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function vl(n){return this.from(a(),n)}function yl(n,t){return this.isValid()&&(lt(n)&&n.isValid()||a(n).isValid())?yt({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pl(n){return this.to(a(),n)}function eo(n){var t;return n===undefined?this._locale._abbr:(t=vt(n),t!=null&&(this._locale=t),this)}function oo(){return this._locale}function wl(n){n=tt(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function bl(n){return(n=tt(n),n===undefined||n==="millisecond")?this:(n==="date"&&(n="day"),this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms"))}function kl(){return this._d.valueOf()-(this._offset||0)*6e4}function dl(){return Math.floor(this.valueOf()/1e3)}function gl(){return this._offset?new Date(this.valueOf()):this._d}function na(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function ta(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function ia(){return this.isValid()?this.toISOString():null}function ra(){return yr(this)}function ua(){return kt({},o(this))}function fa(){return o(this).overflow}function ea(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function cr(n,t){f(0,[n,n.length],0,t)}function oa(n){return so.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function sa(n){return so.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function ha(){return ni(this.year(),1,4)}function ca(){var n=this.localeData()._week;return ni(this.year(),n.dow,n.doy)}function so(n,t,i,r,u){var f;return n==null?vi(this,r,u).year:(f=ni(n,r,u),t>f&&(t=f),la.call(this,n,t,i,r,u))}function la(n,t,i,r,u){var e=he(n,t,i,r,u),f=or(e.year,0,e.dayOfYear);return this.year(f.getUTCFullYear()),this.month(f.getUTCMonth()),this.date(f.getUTCDate()),this}function aa(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function va(n){return vi(n,this._week.dow,this._week.doy).week}function ya(){return this._week.dow}function pa(){return this._week.doy}function wa(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function ba(n){var t=vi(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function ka(n,t){return typeof n!="string"?n:isNaN(n)?(n=t.weekdaysParse(n),typeof n=="number")?n:null:parseInt(n,10)}function da(n,t){return bt(this._weekdays)?this._weekdays[n.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][n.day()]}function ga(n){return this._weekdaysShort[n.day()]}function nv(n){return this._weekdaysMin[n.day()]}function tv(n,t,i){var f,r,e,u=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;f<7;++f)e=ut([2e3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(e,"").toLocaleLowerCase();return i?t==="dddd"?(r=y.call(this._weekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=y.call(this._shortWeekdaysParse,u),r!==-1?r:null):(r=y.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="dddd"?(r=y.call(this._weekdaysParse,u),r!==-1)?r:(r=y.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=y.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=y.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=y.call(this._weekdaysParse,u),r!==-1)?r:(r=y.call(this._minWeekdaysParse,u),r!==-1?r:null):(r=y.call(this._minWeekdaysParse,u),r!==-1)?r:(r=y.call(this._weekdaysParse,u),r!==-1)?r:(r=y.call(this._shortWeekdaysParse,u),r!==-1?r:null)}function iv(n,t,i){var r,u,f;if(this._weekdaysParseExact)return tv.call(this,n,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++)if((u=ut([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(u,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(u,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(u,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(f="^"+this.weekdays(u,"")+"|^"+this.weekdaysShort(u,"")+"|^"+this.weekdaysMin(u,""),this._weekdaysParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="dddd"&&this._fullWeekdaysParse[r].test(n))||i&&t==="ddd"&&this._shortWeekdaysParse[r].test(n)||i&&t==="dd"&&this._minWeekdaysParse[r].test(n)||!i&&this._weekdaysParse[r].test(n))return r}function rv(n){if(!this.isValid())return n!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=ka(n,this.localeData()),this.add(n-t,"d")):t}function uv(n){if(!this.isValid())return n!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function fv(n){return this.isValid()?n==null?this.day()||7:this.day(this.day()%7?n:n-7):n!=null?this:NaN}function ev(n){return this._weekdaysParseExact?(k(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex}function ov(n){return this._weekdaysParseExact?(k(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}function sv(n){return this._weekdaysParseExact?(k(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}function bu(){function u(n,t){return t.length-n.length}for(var e=[],i=[],r=[],t=[],f,o,s,h,n=0;n<7;n++)f=ut([2e3,1]).day(n),o=this.weekdaysMin(f,""),s=this.weekdaysShort(f,""),h=this.weekdays(f,""),e.push(o),i.push(s),r.push(h),t.push(o),t.push(s),t.push(h);for(e.sort(u),i.sort(u),r.sort(u),t.sort(u),n=0;n<7;n++)i[n]=dt(i[n]),r[n]=dt(r[n]),t[n]=dt(t[n]);this._weekdaysRegex=new RegExp("^("+t.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hv(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function ku(){return this.hours()%12||12}function cv(){return this.hours()||24}function wo(n,t){f(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function bo(n,t){return t._meridiemParse}function lv(n){return(n+"").toLowerCase().charAt(0)==="p"}function av(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function vv(n,t){t[gt]=s(("0."+n)*1e3)}function yv(){return this._isUTC?"UTC":""}function pv(){return this._isUTC?"Coordinated Universal Time":""}function wv(n){return a(n*1e3)}function bv(){return a.apply(null,arguments).parseZone()}function kv(n,t,i){var r=this._calendar[n];return at(r)?r.call(t,i):r}function dv(n){var t=this._longDateFormat[n],i=this._longDateFormat[n.toUpperCase()];return t||!i?t:(this._longDateFormat[n]=i.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n])}function gv(){return this._invalidDate}function ny(n){return this._ordinal.replace("%d",n)}function ss(n){return n}function ty(n,t,i,r){var u=this._relativeTime[i];return at(u)?u(n,t,i,r):u.replace(/%d/i,n)}function iy(n,t){var i=this._relativeTime[n>0?"future":"past"];return at(i)?i(t):i.replace(/%s/i,t)}function lr(n,t,i,r){var u=vt(),f=ut().set(r,t);return u[i](f,n)}function cs(n,t,i){if(typeof n=="number"&&(t=n,n=undefined),n=n||"",t!=null)return lr(n,t,i,"month");for(var u=[],r=0;r<12;r++)u[r]=lr(n,r,i,"month");return u}function gu(n,t,i,r){var o,f,u,e;if(typeof n=="boolean"?(typeof t=="number"&&(i=t,t=undefined),t=t||""):(t=n,i=t,n=!1,typeof t=="number"&&(i=t,t=undefined),t=t||""),o=vt(),f=n?o._week.dow:0,i!=null)return lr(t,(i+f)%7,r,"day");for(e=[],u=0;u<7;u++)e[u]=lr(t,(u+f)%7,r,"day");return e}function ry(n,t){return cs(n,t,"months")}function uy(n,t){return cs(n,t,"monthsShort")}function fy(n,t,i){return gu(n,t,i,"weekdays")}function ey(n,t,i){return gu(n,t,i,"weekdaysShort")}function oy(n,t,i){return gu(n,t,i,"weekdaysMin")}function sy(){var n=this._data;return this._milliseconds=et(this._milliseconds),this._days=et(this._days),this._months=et(this._months),n.milliseconds=et(n.milliseconds),n.seconds=et(n.seconds),n.minutes=et(n.minutes),n.hours=et(n.hours),n.months=et(n.months),n.years=et(n.years),this}function ls(n,t,i,r){var u=yt(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function hy(n,t){return ls(this,n,t,1)}function cy(n,t){return ls(this,n,t,-1)}function as(n){return n<0?Math.floor(n):Math.ceil(n)}function ly(){var r=this._milliseconds,n=this._days,t=this._months,i=this._data,u,f,e,s,o;return r>=0&&n>=0&&t>=0||r<=0&&n<=0&&t<=0||(r+=as(nf(t)+n)*864e5,n=0,t=0),i.milliseconds=r%1e3,u=d(r/1e3),i.seconds=u%60,f=d(u/60),i.minutes=f%60,e=d(f/60),i.hours=e%24,n+=d(e/24),o=d(vs(n)),t+=o,n-=as(nf(o)),s=d(t/12),t%=12,i.days=n,i.months=t,i.years=s,this}function vs(n){return n*4800/146097}function nf(n){return n*146097/4800}function ay(n){var t,r,i=this._milliseconds;if(n=tt(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+vs(t),n==="month"?r:r/12;t=this._days+Math.round(nf(this._months));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function vy(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+s(this._months/12)*31536e6}function wt(n){return function(){return this.as(n)}}function tp(n){return n=tt(n),this[n+"s"]()}function ii(n){return function(){return this._data[n]}}function hp(){return d(this.days()/7)}function cp(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function lp(n,t,i){var r=yt(n).abs(),h=ri(r.as("s")),f=ri(r.as("m")),e=ri(r.as("h")),o=ri(r.as("d")),s=ri(r.as("M")),c=ri(r.as("y")),u=h<ct.s&&["s",h]||f<=1&&["m"]||f<ct.m&&["mm",f]||e<=1&&["h"]||e<ct.h&&["hh",e]||o<=1&&["d"]||o<ct.d&&["dd",o]||s<=1&&["M"]||s<ct.M&&["MM",s]||c<=1&&["y"]||["yy",c];return u[2]=t,u[3]=+n>0,u[4]=i,cp.apply(null,u)}function ap(n,t){return ct[n]===undefined?!1:t===undefined?ct[n]:(ct[n]=t,!0)}function vp(n){var t=this.localeData(),i=lp(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function vr(){var t=ar(this._milliseconds)/1e3,a=ar(this._days),i=ar(this._months),n,e,o;n=d(t/60);e=d(n/60);t%=60;n%=60;o=d(i/12);i%=12;var s=o,h=i,c=a,r=e,u=n,f=t,l=this.asSeconds();return l?(l<0?"-":"")+"P"+(s?s+"Y":"")+(h?h+"M":"")+(c?c+"D":"")+(r||u||f?"T":"")+(r?r+"H":"")+(u?u+"M":"")+(f?f+"S":""):"P0D"}var tf,uf,wi,bi,wr,sf,v,ki,fi,fr,fu,ne,te,ue,fe,su,ae,ve,pe,be,de,ge,uo,fo,pu,ho,wu,co,lo,ao,vo,yo,po,ko,go,ns,ts,pt,is,i,du,rs,us,fs,es,os,hs,e,et,ri,ct,ar,h;uf=Array.prototype.some?Array.prototype.some:function(n){for(var i=Object(this),r=i.length>>>0,t=0;t<r;t++)if(t in i&&n.call(this,i[t],t,i))return!0;return!1};wi=r.momentProperties=[];bi=!1;wr={};r.suppressDeprecationWarnings=!1;r.deprecationHandler=null;sf=Object.keys?Object.keys:function(n){var t,i=[];for(t in n)k(n,t)&&i.push(t);return i};v={};fi={};var pf=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,gi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,gr={},oi={};var bf=/\d/,g=/\d\d/,kf=/\d{3}/,tu=/\d{4}/,nr=/[+-]?\d{6}/,l=/\d\d?/,df=/\d\d\d\d?/,gf=/\d\d\d\d\d\d?/,tr=/\d{1,3}/,iu=/\d{1,4}/,ir=/[+-]?\d{1,6}/,rr=/[+-]?\d+/,th=/Z|[+-]\d\d:?\d\d/gi,ur=/Z|[+-]\d\d(?::?\d\d)?/gi,ci=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ru={};fr={};var it=0,st=1,ft=2,p=3,rt=4,ht=5,gt=6,fh=7,eh=8,y;y=Array.prototype.indexOf?Array.prototype.indexOf:function(n){for(var t=0;t<this.length;++t)if(this[t]===n)return t;return-1};f("M",["MM",2],"Mo",function(){return this.month()+1});f("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});f("MMMM",0,0,function(n){return this.localeData().months(this,n)});w("month","M");u("M",l);u("MM",l,g);u("MMM",function(n,t){return t.monthsShortRegex(n)});u("MMMM",function(n,t){return t.monthsRegex(n)});c(["M","MM"],function(n,t){t[st]=s(n)-1});c(["MMM","MMMM"],function(n,t,i,r){var u=i._locale.monthsParse(n,r,i._strict);u!=null?t[st]=u:o(i).invalidMonth=n});fu=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/;ne="January_February_March_April_May_June_July_August_September_October_November_December".split("_");te="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");ue=ci;fe=ci;var yh=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,ph=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,wh=/Z|[+-]\d\d(?::?\d\d)?/,er=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ou=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],bh=/^\/?Date\((\-?\d+)/i;for(r.createFromInputFallback=nt("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),f("Y",0,0,function(){var n=this.year();return n<=9999?""+n:"+"+n}),f(0,["YY",2],0,function(){return this.year()%100}),f(0,["YYYY",4],0,"year"),f(0,["YYYYY",5],0,"year"),f(0,["YYYYYY",6,!0],0,"year"),w("year","y"),u("Y",rr),u("YY",l,g),u("YYYY",iu,tu),u("YYYYY",ir,nr),u("YYYYYY",ir,nr),c(["YYYYY","YYYYYY"],it),c("YYYY",function(n,t){t[it]=n.length===2?r.parseTwoDigitYear(n):s(n)}),c("YY",function(n,t){t[it]=r.parseTwoDigitYear(n)}),c("Y",function(n,t){t[it]=parseInt(n,10)}),r.parseTwoDigitYear=function(n){return s(n)+(s(n)>68?1900:2e3)},su=ei("FullYear",!0),r.ISO_8601=function(){},ae=nt("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var n=a.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:pi()}),ve=nt("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var n=a.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:pi()}),pe=function(){return Date.now?Date.now():+new Date},we("Z",":"),we("ZZ",""),u("Z",ur),u("ZZ",ur),c(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=au(ur,n)}),be=/([\+\-]|\d\d)/gi,r.updateOffset=function(){},de=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,ge=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/,yt.fn=hr.prototype,uo=io(1,"add"),fo=io(-1,"subtract"),r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]",pu=nt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)}),f(0,["gg",2],0,function(){return this.weekYear()%100}),f(0,["GG",2],0,function(){return this.isoWeekYear()%100}),cr("gggg","weekYear"),cr("ggggg","weekYear"),cr("GGGG","isoWeekYear"),cr("GGGGG","isoWeekYear"),w("weekYear","gg"),w("isoWeekYear","GG"),u("G",rr),u("g",rr),u("GG",l,g),u("gg",l,g),u("GGGG",iu,tu),u("gggg",iu,tu),u("GGGGG",ir,nr),u("ggggg",ir,nr),li(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=s(n)}),li(["gg","GG"],function(n,t,i,u){t[u]=r.parseTwoDigitYear(n)}),f("Q",0,"Qo","quarter"),w("quarter","Q"),u("Q",bf),c("Q",function(n,t){t[st]=(s(n)-1)*3}),f("w",["ww",2],"wo","week"),f("W",["WW",2],"Wo","isoWeek"),w("week","w"),w("isoWeek","W"),u("w",l),u("ww",l,g),u("W",l),u("WW",l,g),li(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=s(n)}),ho={dow:0,doy:6},f("D",["DD",2],"Do","date"),w("date","D"),u("D",l),u("DD",l,g),u("Do",function(n,t){return n?t._ordinalParse:t._ordinalParseLenient}),c(["D","DD"],ft),c("Do",function(n,t){t[ft]=s(n.match(l)[0],10)}),wu=ei("Date",!0),f("d",0,"do","day"),f("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)}),f("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)}),f("dddd",0,0,function(n){return this.localeData().weekdays(this,n)}),f("e",0,0,"weekday"),f("E",0,0,"isoWeekday"),w("day","d"),w("weekday","e"),w("isoWeekday","E"),u("d",l),u("e",l),u("E",l),u("dd",function(n,t){return t.weekdaysMinRegex(n)}),u("ddd",function(n,t){return t.weekdaysShortRegex(n)}),u("dddd",function(n,t){return t.weekdaysRegex(n)}),li(["dd","ddd","dddd"],function(n,t,i,r){var u=i._locale.weekdaysParse(n,r,i._strict);u!=null?t.d=u:o(i).invalidWeekday=n}),li(["d","e","E"],function(n,t,i,r){t[r]=s(n)}),co="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),lo="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),ao="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),vo=ci,yo=ci,po=ci,f("DDD",["DDDD",3],"DDDo","dayOfYear"),w("dayOfYear","DDD"),u("DDD",tr),u("DDDD",kf),c(["DDD","DDDD"],function(n,t,i){i._dayOfYear=s(n)}),f("H",["HH",2],0,"hour"),f("h",["hh",2],0,ku),f("k",["kk",2],0,cv),f("hmm",0,0,function(){return""+ku.apply(this)+ot(this.minutes(),2)}),f("hmmss",0,0,function(){return""+ku.apply(this)+ot(this.minutes(),2)+ot(this.seconds(),2)}),f("Hmm",0,0,function(){return""+this.hours()+ot(this.minutes(),2)}),f("Hmmss",0,0,function(){return""+this.hours()+ot(this.minutes(),2)+ot(this.seconds(),2)}),wo("a",!0),wo("A",!1),w("hour","h"),u("a",bo),u("A",bo),u("H",l),u("h",l),u("HH",l,g),u("hh",l,g),u("hmm",df),u("hmmss",gf),u("Hmm",df),u("Hmmss",gf),c(["H","HH"],p),c(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n}),c(["h","hh"],function(n,t,i){t[p]=s(n);o(i).bigHour=!0}),c("hmm",function(n,t,i){var r=n.length-2;t[p]=s(n.substr(0,r));t[rt]=s(n.substr(r));o(i).bigHour=!0}),c("hmmss",function(n,t,i){var r=n.length-4,u=n.length-2;t[p]=s(n.substr(0,r));t[rt]=s(n.substr(r,2));t[ht]=s(n.substr(u));o(i).bigHour=!0}),c("Hmm",function(n,t){var i=n.length-2;t[p]=s(n.substr(0,i));t[rt]=s(n.substr(i))}),c("Hmmss",function(n,t){var i=n.length-4,r=n.length-2;t[p]=s(n.substr(0,i));t[rt]=s(n.substr(i,2));t[ht]=s(n.substr(r))}),ko=/[ap]\.?m?\.?/i,go=ei("Hours",!0),f("m",["mm",2],0,"minute"),w("minute","m"),u("m",l),u("mm",l,g),c(["m","mm"],rt),ns=ei("Minutes",!1),f("s",["ss",2],0,"second"),w("second","s"),u("s",l),u("ss",l,g),c(["s","ss"],ht),ts=ei("Seconds",!1),f("S",0,0,function(){return~~(this.millisecond()/100)}),f(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),f(0,["SSS",3],0,"millisecond"),f(0,["SSSS",4],0,function(){return this.millisecond()*10}),f(0,["SSSSS",5],0,function(){return this.millisecond()*100}),f(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),f(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),f(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),f(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),w("millisecond","ms"),u("S",tr,bf),u("SS",tr,g),u("SSS",tr,kf),pt="SSSS";pt.length<=9;pt+="S")u(pt,/\d+/);for(pt="S";pt.length<=9;pt+="S")c(pt,vv);is=ei("Milliseconds",!1);f("z",0,0,"zoneAbbr");f("zz",0,0,"zoneName");i=hi.prototype;i.add=uo;i.calendar=gc;i.clone=nl;i.diff=ol;i.endOf=bl;i.format=ll;i.from=al;i.fromNow=vl;i.to=yl;i.toNow=pl;i.get=yf;i.invalidAt=fa;i.isAfter=tl;i.isBefore=il;i.isBetween=rl;i.isSame=ul;i.isSameOrAfter=fl;i.isSameOrBefore=el;i.isValid=ra;i.lang=pu;i.locale=eo;i.localeData=oo;i.max=ve;i.min=ae;i.parsingFlags=ua;i.set=yf;i.startOf=wl;i.subtract=fo;i.toArray=na;i.toObject=ta;i.toDate=gl;i.toISOString=cl;i.toJSON=ia;i.toString=hl;i.unix=dl;i.valueOf=kl;i.creationData=ea;i.year=su;i.isLeapYear=gh;i.weekYear=oa;i.isoWeekYear=sa;i.quarter=i.quarters=aa;i.month=re;i.daysInMonth=lh;i.week=i.weeks=wa;i.isoWeek=i.isoWeeks=ba;i.weeksInYear=ca;i.isoWeeksInYear=ha;i.date=wu;i.day=i.days=rv;i.weekday=uv;i.isoWeekday=fv;i.dayOfYear=hv;i.hour=i.hours=go;i.minute=i.minutes=ns;i.second=i.seconds=ts;i.millisecond=i.milliseconds=is;i.utcOffset=hc;i.utc=lc;i.local=ac;i.parseZone=vc;i.hasAlignedHourOffset=yc;i.isDST=pc;i.isDSTShifted=wc;i.isLocal=bc;i.isUtcOffset=kc;i.isUtc=ke;i.isUTC=ke;i.zoneAbbr=yv;i.zoneName=pv;i.dates=nt("dates accessor is deprecated. Use date instead.",wu);i.months=nt("months accessor is deprecated. Use month instead",re);i.years=nt("years accessor is deprecated. Use year instead",su);i.zone=nt("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",cc);du=i;rs={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};us={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};fs="Invalid date";es="%d";os=/\d{1,2}/;hs={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};e=dr.prototype;e._calendar=rs;e.calendar=kv;e._longDateFormat=us;e.longDateFormat=dv;e._invalidDate=fs;e.invalidDate=gv;e._ordinal=es;e.ordinal=ny;e._ordinalParse=os;e.preparse=ss;e.postformat=ss;e._relativeTime=hs;e.relativeTime=ty;e.pastFuture=iy;e.set=ws;e.months=oh;e._months=ne;e.monthsShort=sh;e._monthsShort=te;e.monthsParse=ch;e._monthsRegex=fe;e.monthsRegex=vh;e._monthsShortRegex=ue;e.monthsShortRegex=ah;e.week=va;e._week=ho;e.firstDayOfYear=pa;e.firstDayOfWeek=ya;e.weekdays=da;e._weekdays=co;e.weekdaysMin=nv;e._weekdaysMin=ao;e.weekdaysShort=ga;e._weekdaysShort=lo;e.weekdaysParse=iv;e._weekdaysRegex=vo;e.weekdaysRegex=ev;e._weekdaysShortRegex=yo;e.weekdaysShortRegex=ov;e._weekdaysMinRegex=po;e.weekdaysMinRegex=sv;e.isPM=lv;e._meridiemParse=ko;e.meridiem=av;ui("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=s(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});r.lang=nt("moment.lang is deprecated. Use moment.locale instead.",ui);r.langData=nt("moment.langData is deprecated. Use moment.localeData instead.",vt);et=Math.abs;var yy=wt("ms"),py=wt("s"),wy=wt("m"),by=wt("h"),ky=wt("d"),dy=wt("w"),gy=wt("M"),np=wt("y");var ip=ii("milliseconds"),rp=ii("seconds"),up=ii("minutes"),fp=ii("hours"),ep=ii("days"),op=ii("months"),sp=ii("years");return ri=Math.round,ct={s:45,m:45,h:22,d:26,M:11},ar=Math.abs,h=hr.prototype,h.abs=sy,h.add=hy,h.subtract=cy,h.as=ay,h.asMilliseconds=yy,h.asSeconds=py,h.asMinutes=wy,h.asHours=by,h.asDays=ky,h.asWeeks=dy,h.asMonths=gy,h.asYears=np,h.valueOf=vy,h._bubble=ly,h.get=tp,h.milliseconds=ip,h.seconds=rp,h.minutes=up,h.hours=fp,h.days=ep,h.weeks=hp,h.months=op,h.years=sp,h.humanize=vp,h.toISOString=vr,h.toString=vr,h.toJSON=vr,h.locale=eo,h.localeData=oo,h.toIsoString=nt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",vr),h.lang=pu,f("X",0,0,"unix"),f("x",0,0,"valueOf"),u("x",rr),u("X",/[+-]?\d+(\.\d{1,3})?/),c("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),c("x",function(n,t,i){i._d=new Date(s(n))}),r.version="2.13.0",ys(a),r.fn=du,r.min=oc,r.max=sc,r.now=pe,r.utc=ut,r.unix=wv,r.months=ry,r.isDate=yi,r.locale=ui,r.invalid=pi,r.duration=yt,r.isMoment=lt,r.weekdays=fy,r.parseZone=bv,r.localeData=vt,r.isDuration=lu,r.monthsShort=uy,r.weekdaysMin=oy,r.defineLocale=lf,r.updateLocale=ks,r.locales=ds,r.weekdaysShort=ey,r.normalizeUnits=tt,r.relativeTimeThreshold=ap,r.prototype=du,r})},{}],7:[function(n,t){var i=n("./core/core.js")();n("./core/core.helpers")(i);n("./core/core.element")(i);n("./core/core.animation")(i);n("./core/core.controller")(i);n("./core/core.datasetController")(i);n("./core/core.layoutService")(i);n("./core/core.legend")(i);n("./core/core.plugin.js")(i);n("./core/core.scale")(i);n("./core/core.scaleService")(i);n("./core/core.title")(i);n("./core/core.tooltip")(i);n("./controllers/controller.bar")(i);n("./controllers/controller.bubble")(i);n("./controllers/controller.doughnut")(i);n("./controllers/controller.line")(i);n("./controllers/controller.polarArea")(i);n("./controllers/controller.radar")(i);n("./scales/scale.category")(i);n("./scales/scale.linear")(i);n("./scales/scale.logarithmic")(i);n("./scales/scale.radialLinear")(i);n("./scales/scale.time")(i);n("./elements/element.arc")(i);n("./elements/element.line")(i);n("./elements/element.point")(i);n("./elements/element.rectangle")(i);n("./charts/Chart.Bar")(i);n("./charts/Chart.Bubble")(i);n("./charts/Chart.Doughnut")(i);n("./charts/Chart.Line")(i);n("./charts/Chart.PolarArea")(i);n("./charts/Chart.Radar")(i);n("./charts/Chart.Scatter")(i);window.Chart=t.exports=i},{"./charts/Chart.Bar":8,"./charts/Chart.Bubble":9,"./charts/Chart.Doughnut":10,"./charts/Chart.Line":11,"./charts/Chart.PolarArea":12,"./charts/Chart.Radar":13,"./charts/Chart.Scatter":14,"./controllers/controller.bar":15,"./controllers/controller.bubble":16,"./controllers/controller.doughnut":17,"./controllers/controller.line":18,"./controllers/controller.polarArea":19,"./controllers/controller.radar":20,"./core/core.animation":21,"./core/core.controller":22,"./core/core.datasetController":23,"./core/core.element":24,"./core/core.helpers":25,"./core/core.js":26,"./core/core.layoutService":27,"./core/core.legend":28,"./core/core.plugin.js":29,"./core/core.scale":30,"./core/core.scaleService":31,"./core/core.title":32,"./core/core.tooltip":33,"./elements/element.arc":34,"./elements/element.line":35,"./elements/element.point":36,"./elements/element.rectangle":37,"./scales/scale.category":38,"./scales/scale.linear":39,"./scales/scale.logarithmic":40,"./scales/scale.radialLinear":41,"./scales/scale.time":42}],8:[function(n,t){"use strict";t.exports=function(n){n.Bar=function(t,i){return i.type="bar",new n(t,i)}}},{}],9:[function(n,t){"use strict";t.exports=function(n){n.Bubble=function(t,i){return i.type="bubble",new n(t,i)}}},{}],10:[function(n,t){"use strict";t.exports=function(n){n.Doughnut=function(t,i){return i.type="doughnut",new n(t,i)}}},{}],11:[function(n,t){"use strict";t.exports=function(n){n.Line=function(t,i){return i.type="line",new n(t,i)}}},{}],12:[function(n,t){"use strict";t.exports=function(n){n.PolarArea=function(t,i){return i.type="polarArea",new n(t,i)}}},{}],13:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i={aspectRatio:1};n.Radar=function(r,u){return u.options=t.configMerge(i,u.options),u.type="radar",new n(r,u)}}},{}],14:[function(n,t){"use strict";t.exports=function(n){var t={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-1"}],yAxes:[{type:"linear",position:"left",id:"y-axis-1"}]},tooltips:{callbacks:{title:function(){return""},label:function(n){return"("+n.xLabel+", "+n.yLabel+")"}}}};n.defaults.scatter=t;n.controllers.scatter=n.controllers.line;n.Scatter=function(t,i){return i.type="scatter",new n(t,i)}}},{}],15:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.bar={hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}};n.controllers.bar=n.DatasetController.extend({initialize:function(t,i){n.DatasetController.prototype.initialize.call(this,t,i);this.getMeta().bar=!0},getBarCount:function(){var n=0;return t.each(this.chart.data.datasets,function(t,i){var r=this.chart.getDatasetMeta(i);r.bar&&this.chart.isDatasetVisible(i)&&++n},this),n},addElements:function(){var i=this.getMeta();t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Rectangle({_chart:this.chart.chart,_datasetIndex:this.index,_index:r})},this)},addElementAndReset:function(t){var i=new n.elements.Rectangle({_chart:this.chart.chart,_datasetIndex:this.index,_index:t}),r=this.getBarCount();this.getMeta().data.splice(t,0,i);this.updateElement(i,t,!0,r)},update:function(n){var i=this.getBarCount();t.each(this.getMeta().data,function(t,r){this.updateElement(t,r,n,i)},this)},updateElement:function(n,i,r,u){var o=this.getMeta(),s=this.getScaleForId(o.xAxisID),f=this.getScaleForId(o.yAxisID),e;e=f.min<0&&f.max<0?f.getPixelForValue(f.max):f.min>0&&f.max>0?f.getPixelForValue(f.min):f.getPixelForValue(0);t.extend(n,{_chart:this.chart.chart,_xScale:s,_yScale:f,_datasetIndex:this.index,_index:i,_model:{x:this.calculateBarX(i,this.index),y:r?e:this.calculateBarY(i,this.index),label:this.chart.data.labels[i],datasetLabel:this.getDataset().label,base:r?e:this.calculateBarBase(this.index,i),width:this.calculateBarWidth(u),backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.rectangle.backgroundColor),borderSkipped:n.custom&&n.custom.borderSkipped?n.custom.borderSkipped:this.chart.options.elements.rectangle.borderSkipped,borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.rectangle.borderColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.rectangle.borderWidth)}});n.pivot()},calculateBarBase:function(n,t){var c=this.getMeta(),a=this.getScaleForId(c.xAxisID),i=this.getScaleForId(c.yAxisID),r=0,l,u,e,o,f,s,h;if(i.options.stacked){if(l=this.chart.data.datasets[n].data[t],l<0)for(u=0;u<n;u++)e=this.chart.data.datasets[u],o=this.chart.getDatasetMeta(u),o.bar&&o.yAxisID===i.id&&this.chart.isDatasetVisible(u)&&(r+=e.data[t]<0?e.data[t]:0);else for(f=0;f<n;f++)s=this.chart.data.datasets[f],h=this.chart.getDatasetMeta(f),h.bar&&h.yAxisID===i.id&&this.chart.isDatasetVisible(f)&&(r+=s.data[t]>0?s.data[t]:0);return i.getPixelForValue(r)}return r=i.getPixelForValue(i.min),i.beginAtZero||i.min<=0&&i.max>=0||i.min>=0&&i.max<=0?r=i.getPixelForValue(0,0):i.min<0&&i.max<0&&(r=i.getPixelForValue(i.max)),r},getRuler:function(){var r=this.getMeta(),n=this.getScaleForId(r.xAxisID),c=this.getScaleForId(r.yAxisID),u=this.getBarCount(),i=function(){for(var i=n.getPixelForTick(1)-n.getPixelForTick(0),t=2;t<this.getDataset().data.length;t++)i=Math.min(n.getPixelForTick(t)-n.getPixelForTick(t-1),i);return i}.call(this),f=i*n.options.categoryPercentage,h=(i-i*n.options.categoryPercentage)/2,t=f/u,e,o,s;return n.ticks.length!==this.chart.data.labels.length&&(e=n.ticks.length/this.chart.data.labels.length,t=t*e),o=t*n.options.barPercentage,s=t-t*n.options.barPercentage,{datasetCount:u,tickWidth:i,categoryWidth:f,categorySpacing:h,fullBarWidth:t,barWidth:o,barSpacing:s}},calculateBarWidth:function(){var t=this.getScaleForId(this.getMeta().xAxisID),n=this.getRuler();return t.options.stacked?n.categoryWidth:n.barWidth},getBarIndex:function(n){for(var i=0,r,t=0;t<n;++t)r=this.chart.getDatasetMeta(t),r.bar&&this.chart.isDatasetVisible(t)&&++i;return i},calculateBarX:function(n,t){var u=this.getMeta(),o=this.getScaleForId(u.yAxisID),f=this.getScaleForId(u.xAxisID),e=this.getBarIndex(t),i=this.getRuler(),r=f.getPixelForValue(null,n,t,this.chart.isCombo);return(r-=this.chart.isCombo?i.tickWidth/2:0,f.options.stacked)?r+i.categoryWidth/2+i.categorySpacing:r+i.barWidth/2+i.categorySpacing+i.barWidth*e+i.barSpacing/2+i.barSpacing*e},calculateBarY:function(n,t){var h=this.getMeta(),c=this.getScaleForId(h.xAxisID),r=this.getScaleForId(h.yAxisID),u=this.getDataset().data[n],e,o,i,f,s;if(r.options.stacked){for(e=0,o=0,i=0;i<t;i++)f=this.chart.data.datasets[i],s=this.chart.getDatasetMeta(i),s.bar&&s.yAxisID===r.id&&this.chart.isDatasetVisible(i)&&(f.data[n]<0?o+=f.data[n]||0:e+=f.data[n]||0);return u<0?r.getPixelForValue(o+u):r.getPixelForValue(e+u)}return r.getPixelForValue(u)},draw:function(n){var i=n||1;t.each(this.getMeta().data,function(n,t){var r=this.getDataset().data[t];r===null||r===undefined||isNaN(r)||n.transition(i).draw()},this)},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.hoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.hoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.hoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;n._model.backgroundColor=n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.rectangle.backgroundColor);n._model.borderColor=n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.rectangle.borderColor);n._model.borderWidth=n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.rectangle.borderWidth)}});n.defaults.horizontalBar={hover:{mode:"label"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}]}};n.controllers.horizontalBar=n.controllers.bar.extend({updateElement:function(n,i,r,u){var o=this.getMeta(),f=this.getScaleForId(o.xAxisID),s=this.getScaleForId(o.yAxisID),e;e=f.min<0&&f.max<0?f.getPixelForValue(f.max):f.min>0&&f.max>0?f.getPixelForValue(f.min):f.getPixelForValue(0);t.extend(n,{_chart:this.chart.chart,_xScale:f,_yScale:s,_datasetIndex:this.index,_index:i,_model:{x:r?e:this.calculateBarX(i,this.index),y:this.calculateBarY(i,this.index),label:this.chart.data.labels[i],datasetLabel:this.getDataset().label,base:r?e:this.calculateBarBase(this.index,i),height:this.calculateBarHeight(u),backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.rectangle.backgroundColor),borderSkipped:n.custom&&n.custom.borderSkipped?n.custom.borderSkipped:this.chart.options.elements.rectangle.borderSkipped,borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.rectangle.borderColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.rectangle.borderWidth)},draw:function(){function h(n){return c[(o+n)%4]}var t=this._chart.ctx,n=this._view,s=n.height/2,r=n.y-s,u=n.y+s,f=n.base-(n.base-n.x),e=n.borderWidth/2,i;n.borderWidth&&(r+=e,u-=e,f+=e);t.beginPath();t.fillStyle=n.backgroundColor;t.strokeStyle=n.borderColor;t.lineWidth=n.borderWidth;var c=[[n.base,u],[n.base,r],[f,r],[f,u]],o=["bottom","left","top","right"].indexOf(n.borderSkipped,0);for(o===-1&&(o=0),t.moveTo.apply(t,h(0)),i=1;i<4;i++)t.lineTo.apply(t,h(i));t.fill();n.borderWidth&&t.stroke()},inRange:function(n,t){var i=this._view,r=!1;return i&&(r=i.x<i.base?t>=i.y-i.height/2&&t<=i.y+i.height/2&&n>=i.x&&n<=i.base:t>=i.y-i.height/2&&t<=i.y+i.height/2&&n>=i.base&&n<=i.x),r}});n.pivot()},calculateBarBase:function(n,t){var c=this.getMeta(),i=this.getScaleForId(c.xAxisID),a=this.getScaleForId(c.yAxisID),r=0,l,u,e,o,f,s,h;if(i.options.stacked){if(l=this.chart.data.datasets[n].data[t],l<0)for(u=0;u<n;u++)e=this.chart.data.datasets[u],o=this.chart.getDatasetMeta(u),o.bar&&o.xAxisID===i.id&&this.chart.isDatasetVisible(u)&&(r+=e.data[t]<0?e.data[t]:0);else for(f=0;f<n;f++)s=this.chart.data.datasets[f],h=this.chart.getDatasetMeta(f),h.bar&&h.xAxisID===i.id&&this.chart.isDatasetVisible(f)&&(r+=s.data[t]>0?s.data[t]:0);return i.getPixelForValue(r)}return r=i.getPixelForValue(i.min),i.beginAtZero||i.min<=0&&i.max>=0||i.min>=0&&i.max<=0?r=i.getPixelForValue(0,0):i.min<0&&i.max<0&&(r=i.getPixelForValue(i.max)),r},getRuler:function(){var r=this.getMeta(),c=this.getScaleForId(r.xAxisID),n=this.getScaleForId(r.yAxisID),u=this.getBarCount(),i=function(){for(var i=n.getPixelForTick(1)-n.getPixelForTick(0),t=2;t<this.getDataset().data.length;t++)i=Math.min(n.getPixelForTick(t)-n.getPixelForTick(t-1),i);return i}.call(this),f=i*n.options.categoryPercentage,h=(i-i*n.options.categoryPercentage)/2,t=f/u,e,o,s;return n.ticks.length!==this.chart.data.labels.length&&(e=n.ticks.length/this.chart.data.labels.length,t=t*e),o=t*n.options.barPercentage,s=t-t*n.options.barPercentage,{datasetCount:u,tickHeight:i,categoryHeight:f,categorySpacing:h,fullBarHeight:t,barHeight:o,barSpacing:s}},calculateBarHeight:function(){var t=this.getScaleForId(this.getMeta().yAxisID),n=this.getRuler();return t.options.stacked?n.categoryHeight:n.barHeight},calculateBarX:function(n,t){var h=this.getMeta(),r=this.getScaleForId(h.xAxisID),c=this.getScaleForId(h.yAxisID),u=this.getDataset().data[n],e,o,i,f,s;if(r.options.stacked){for(e=0,o=0,i=0;i<t;i++)f=this.chart.data.datasets[i],s=this.chart.getDatasetMeta(i),s.bar&&s.xAxisID===r.id&&this.chart.isDatasetVisible(i)&&(f.data[n]<0?o+=f.data[n]||0:e+=f.data[n]||0);return u<0?r.getPixelForValue(o+u):r.getPixelForValue(e+u)}return r.getPixelForValue(u)},calculateBarY:function(n,t){var u=this.getMeta(),f=this.getScaleForId(u.yAxisID),o=this.getScaleForId(u.xAxisID),e=this.getBarIndex(t),i=this.getRuler(),r=f.getPixelForValue(null,n,t,this.chart.isCombo);return(r-=this.chart.isCombo?i.tickHeight/2:0,f.options.stacked)?r+i.categoryHeight/2+i.categorySpacing:r+i.barHeight/2+i.categorySpacing+i.barHeight*e+i.barSpacing/2+i.barSpacing*e}})}},{}],16:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.bubble={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(n,t){var r=t.datasets[n.datasetIndex].label||"",i=t.datasets[n.datasetIndex].data[n.index];return r+": ("+i.x+", "+i.y+", "+i.r+")"}}}};n.controllers.bubble=n.DatasetController.extend({addElements:function(){var i=this.getMeta();t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:r})},this)},addElementAndReset:function(t){var i=new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.getMeta().data.splice(t,0,i);this.updateElement(i,t,!0)},update:function(n){var r=this.getMeta(),u=r.data,i=this.getScaleForId(r.yAxisID),e=this.getScaleForId(r.xAxisID),f;f=i.min<0&&i.max<0?i.getPixelForValue(i.max):i.min>0&&i.max>0?i.getPixelForValue(i.min):i.getPixelForValue(0);t.each(u,function(t,i){this.updateElement(t,i,n)},this)},updateElement:function(n,i,r){var e=this.getMeta(),u=this.getScaleForId(e.yAxisID),f=this.getScaleForId(e.xAxisID),o;o=u.min<0&&u.max<0?u.getPixelForValue(u.max):u.min>0&&u.max>0?u.getPixelForValue(u.min):u.getPixelForValue(0);t.extend(n,{_chart:this.chart.chart,_xScale:f,_yScale:u,_datasetIndex:this.index,_index:i,_model:{x:r?f.getPixelForDecimal(.5):f.getPixelForValue(this.getDataset().data[i],i,this.index,this.chart.isCombo),y:r?o:u.getPixelForValue(this.getDataset().data[i],i,this.index),radius:r?0:n.custom&&n.custom.radius?n.custom.radius:this.getRadius(this.getDataset().data[i]),backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.point.backgroundColor),borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.point.borderColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.point.borderWidth),hitRadius:n.custom&&n.custom.hitRadius?n.custom.hitRadius:t.getValueAtIndexOrDefault(this.getDataset().hitRadius,i,this.chart.options.elements.point.hitRadius)}});n._model.skip=n.custom&&n.custom.skip?n.custom.skip:isNaN(n._model.x)||isNaN(n._model.y);n.pivot()},getRadius:function(n){return n.r||this.chart.options.elements.point.radius},draw:function(n){var i=n||1;t.each(this.getMeta().data,function(n){n.transition(i);n.draw()})},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.radius=n.custom&&n.custom.hoverRadius?n.custom.hoverRadius:t.getValueAtIndexOrDefault(i.hoverRadius,r,this.chart.options.elements.point.hoverRadius)+this.getRadius(this.getDataset().data[n._index]);n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.hoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.hoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.hoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;n._model.radius=n.custom&&n.custom.radius?n.custom.radius:this.getRadius(this.getDataset().data[n._index]);n._model.backgroundColor=n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.point.backgroundColor);n._model.borderColor=n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.point.borderColor);n._model.borderWidth=n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.point.borderWidth)}})}},{}],17:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.doughnut={animation:{animateRotate:!0,animateScale:!1},aspectRatio:1,hover:{mode:"single"},legendCallback:function(n){var t=[],i;if(t.push('<ul class="'+n.id+'-legend">'),n.data.datasets.length)for(i=0;i<n.data.datasets[0].data.length;++i)t.push('<li><span style="background-color:'+n.data.datasets[0].backgroundColor[i]+'"><\/span>'),n.data.labels[i]&&t.push(n.data.labels[i]),t.push("<\/li>");return t.push("<\/ul>"),t.join("")},legend:{labels:{generateLabels:function(n){var i=n.data;return i.labels.length&&i.datasets.length?i.labels.map(function(r,u){var o=n.getDatasetMeta(0),e=i.datasets[0],f=o.data[u],s=f.custom&&f.custom.backgroundColor?f.custom.backgroundColor:t.getValueAtIndexOrDefault(e.backgroundColor,u,this.chart.options.elements.arc.backgroundColor),h=f.custom&&f.custom.borderColor?f.custom.borderColor:t.getValueAtIndexOrDefault(e.borderColor,u,this.chart.options.elements.arc.borderColor),c=f.custom&&f.custom.borderWidth?f.custom.borderWidth:t.getValueAtIndexOrDefault(e.borderWidth,u,this.chart.options.elements.arc.borderWidth);return{text:r,fillStyle:s,strokeStyle:h,lineWidth:c,hidden:isNaN(e.data[u])||o.data[u].hidden,index:u}},this):[]}},onClick:function(n,t){for(var f=t.index,r=this.chart,u,i=0,e=(r.data.datasets||[]).length;i<e;++i)u=r.getDatasetMeta(i),u.data[f].hidden=!u.data[f].hidden;r.update()}},cutoutPercentage:50,rotation:Math.PI*-.5,circumference:Math.PI*2,tooltips:{callbacks:{title:function(){return""},label:function(n,t){return t.labels[n.index]+": "+t.datasets[n.datasetIndex].data[n.index]}}}};n.defaults.pie=t.clone(n.defaults.doughnut);t.extend(n.defaults.pie,{cutoutPercentage:0});n.controllers.doughnut=n.controllers.pie=n.DatasetController.extend({linkScales:function(){},addElements:function(){var i=this.getMeta();t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:r})},this)},addElementAndReset:function(i,r){var u=new n.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:i});r&&t.isArray(this.getDataset().backgroundColor)&&this.getDataset().backgroundColor.splice(i,0,r);this.getMeta().data.splice(i,0,u);this.updateElement(u,i,!0)},getRingIndex:function(n){for(var i=0,t=0;t<n;++t)this.chart.isDatasetVisible(t)&&++i;return i},update:function(n){var c=this.chart.chartArea.right-this.chart.chartArea.left-this.chart.options.elements.arc.borderWidth,l=this.chart.chartArea.bottom-this.chart.chartArea.top-this.chart.options.elements.arc.borderWidth,a=Math.min(c,l),h={x:0,y:0},i;if(this.chart.options.circumference<Math.PI*2){i=this.chart.options.rotation%(Math.PI*2)+Math.PI*2*(i>=Math.PI?-1:i<-Math.PI?1:0);var r=i+this.chart.options.circumference,u={x:Math.cos(i),y:Math.sin(i)},f={x:Math.cos(r),y:Math.sin(r)},y=i<=0&&0<=r||i<=Math.PI*2&&Math.PI*2<=r,p=i<=Math.PI*.5&&Math.PI*.5<=r||i<=Math.PI*2.5&&Math.PI*2.5<=r,w=i<=-Math.PI&&-Math.PI<=r||i<=Math.PI&&Math.PI<=r,b=i<=-Math.PI*.5&&-Math.PI*.5<=r||i<=Math.PI*1.5&&Math.PI*1.5<=r,e=this.chart.options.cutoutPercentage/100,o={x:w?-1:Math.min(u.x*(u.x<0?1:e),f.x*(f.x<0?1:e)),y:b?-1:Math.min(u.y*(u.y<0?1:e),f.y*(f.y<0?1:e))},s={x:y?1:Math.max(u.x*(u.x>0?1:e),f.x*(f.x>0?1:e)),y:p?1:Math.max(u.y*(u.y>0?1:e),f.y*(f.y>0?1:e))},v={width:(s.x-o.x)*.5,height:(s.y-o.y)*.5};a=Math.min(c/v.width,l/v.height);h={x:(s.x+o.x)*-.5,y:(s.y+o.y)*-.5}}this.chart.outerRadius=Math.max(a/2,0);this.chart.innerRadius=Math.max(this.chart.options.cutoutPercentage?this.chart.outerRadius/100*this.chart.options.cutoutPercentage:1,0);this.chart.radiusLength=(this.chart.outerRadius-this.chart.innerRadius)/this.chart.getVisibleDatasetCount();this.chart.offsetX=h.x*this.chart.outerRadius;this.chart.offsetY=h.y*this.chart.outerRadius;this.getMeta().total=this.calculateTotal();this.outerRadius=this.chart.outerRadius-this.chart.radiusLength*this.getRingIndex(this.index);this.innerRadius=this.outerRadius-this.chart.radiusLength;t.each(this.getMeta().data,function(t,i){this.updateElement(t,i,n)},this)},updateElement:function(n,i,r){var u=(this.chart.chartArea.left+this.chart.chartArea.right)/2,f=(this.chart.chartArea.top+this.chart.chartArea.bottom)/2,e=this.chart.options.rotation,o=this.chart.options.rotation,s=r&&this.chart.options.animation.animateRotate?0:n.hidden?0:this.calculateCircumference(this.getDataset().data[i])*(this.chart.options.circumference/(2*Math.PI)),h=r&&this.chart.options.animation.animateScale?0:this.innerRadius,c=r&&this.chart.options.animation.animateScale?0:this.outerRadius;t.extend(n,{_chart:this.chart.chart,_datasetIndex:this.index,_index:i,_model:{x:u+this.chart.offsetX,y:f+this.chart.offsetY,startAngle:e,endAngle:o,circumference:s,outerRadius:c,innerRadius:h,backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.arc.backgroundColor),hoverBackgroundColor:n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(this.getDataset().hoverBackgroundColor,i,this.chart.options.elements.arc.hoverBackgroundColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.arc.borderWidth),borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.arc.borderColor),label:t.getValueAtIndexOrDefault(this.getDataset().label,i,this.chart.data.labels[i])}});r&&this.chart.options.animation.animateRotate||(n._model.startAngle=i===0?this.chart.options.rotation:this.getMeta().data[i-1]._model.endAngle,n._model.endAngle=n._model.startAngle+n._model.circumference);n.pivot()},draw:function(n){var i=n||1;t.each(this.getMeta().data,function(n){n.transition(i).draw()})},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.hoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.hoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.hoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;n._model.backgroundColor=n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.arc.backgroundColor);n._model.borderColor=n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.arc.borderColor);n._model.borderWidth=n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.arc.borderWidth)},calculateTotal:function(){var r=this.getDataset(),u=this.getMeta(),i=0,n;return t.each(u.data,function(t,u){n=r.data[u];isNaN(n)||t.hidden||(i+=Math.abs(n))}),i},calculateCircumference:function(n){var t=this.getMeta().total;return t>0&&!isNaN(n)?Math.PI*2*(n/t):0}})}},{}],18:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.line={showLines:!0,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}};n.controllers.line=n.DatasetController.extend({addElements:function(){var i=this.getMeta();i.dataset=i.dataset||new n.elements.Line({_chart:this.chart.chart,_datasetIndex:this.index,_points:i.data});t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:r})},this)},addElementAndReset:function(t){var i=new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.getMeta().data.splice(t,0,i);this.updateElement(i,t,!0);this.chart.options.showLines&&this.chart.options.elements.line.tension!==0&&this.updateBezierControlPoints()},update:function(n){var u=this.getMeta(),i=u.dataset,f=u.data,r=this.getScaleForId(u.yAxisID),o=this.getScaleForId(u.xAxisID),e;e=r.min<0&&r.max<0?r.getPixelForValue(r.max):r.min>0&&r.max>0?r.getPixelForValue(r.min):r.getPixelForValue(0);this.chart.options.showLines&&(i._scale=r,i._datasetIndex=this.index,i._children=f,this.getDataset().tension!==undefined&&this.getDataset().lineTension===undefined&&(this.getDataset().lineTension=this.getDataset().tension),i._model={tension:i.custom&&i.custom.tension?i.custom.tension:t.getValueOrDefault(this.getDataset().lineTension,this.chart.options.elements.line.tension),backgroundColor:i.custom&&i.custom.backgroundColor?i.custom.backgroundColor:this.getDataset().backgroundColor||this.chart.options.elements.line.backgroundColor,borderWidth:i.custom&&i.custom.borderWidth?i.custom.borderWidth:this.getDataset().borderWidth||this.chart.options.elements.line.borderWidth,borderColor:i.custom&&i.custom.borderColor?i.custom.borderColor:this.getDataset().borderColor||this.chart.options.elements.line.borderColor,borderCapStyle:i.custom&&i.custom.borderCapStyle?i.custom.borderCapStyle:this.getDataset().borderCapStyle||this.chart.options.elements.line.borderCapStyle,borderDash:i.custom&&i.custom.borderDash?i.custom.borderDash:this.getDataset().borderDash||this.chart.options.elements.line.borderDash,borderDashOffset:i.custom&&i.custom.borderDashOffset?i.custom.borderDashOffset:this.getDataset().borderDashOffset||this.chart.options.elements.line.borderDashOffset,borderJoinStyle:i.custom&&i.custom.borderJoinStyle?i.custom.borderJoinStyle:this.getDataset().borderJoinStyle||this.chart.options.elements.line.borderJoinStyle,fill:i.custom&&i.custom.fill?i.custom.fill:this.getDataset().fill!==undefined?this.getDataset().fill:this.chart.options.elements.line.fill,scaleTop:r.top,scaleBottom:r.bottom,scaleZero:e},i.pivot());t.each(f,function(t,i){this.updateElement(t,i,n)},this);this.chart.options.showLines&&this.chart.options.elements.line.tension!==0&&this.updateBezierControlPoints()},getPointBackgroundColor:function(n,i){var r=this.chart.options.elements.point.backgroundColor,u=this.getDataset();return n.custom&&n.custom.backgroundColor?r=n.custom.backgroundColor:u.pointBackgroundColor?r=t.getValueAtIndexOrDefault(u.pointBackgroundColor,i,r):u.backgroundColor&&(r=u.backgroundColor),r},getPointBorderColor:function(n,i){var r=this.chart.options.elements.point.borderColor,u=this.getDataset();return n.custom&&n.custom.borderColor?r=n.custom.borderColor:u.pointBorderColor?r=t.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,i,r):u.borderColor&&(r=u.borderColor),r},getPointBorderWidth:function(n,i){var r=this.chart.options.elements.point.borderWidth,u=this.getDataset();return n.custom&&n.custom.borderWidth!==undefined?r=n.custom.borderWidth:u.pointBorderWidth!==undefined?r=t.getValueAtIndexOrDefault(u.pointBorderWidth,i,r):u.borderWidth!==undefined&&(r=u.borderWidth),r},updateElement:function(n,i,r){var f=this.getMeta(),u=this.getScaleForId(f.yAxisID),e=this.getScaleForId(f.xAxisID),o;o=u.min<0&&u.max<0?u.getPixelForValue(u.max):u.min>0&&u.max>0?u.getPixelForValue(u.min):u.getPixelForValue(0);n._chart=this.chart.chart;n._xScale=e;n._yScale=u;n._datasetIndex=this.index;n._index=i;this.getDataset().radius!==undefined&&this.getDataset().pointRadius===undefined&&(this.getDataset().pointRadius=this.getDataset().radius);this.getDataset().hitRadius!==undefined&&this.getDataset().pointHitRadius===undefined&&(this.getDataset().pointHitRadius=this.getDataset().hitRadius);n._model={x:e.getPixelForValue(this.getDataset().data[i],i,this.index,this.chart.isCombo),y:r?o:this.calculatePointY(this.getDataset().data[i],i,this.index,this.chart.isCombo),radius:n.custom&&n.custom.radius?n.custom.radius:t.getValueAtIndexOrDefault(this.getDataset().pointRadius,i,this.chart.options.elements.point.radius),pointStyle:n.custom&&n.custom.pointStyle?n.custom.pointStyle:t.getValueAtIndexOrDefault(this.getDataset().pointStyle,i,this.chart.options.elements.point.pointStyle),backgroundColor:this.getPointBackgroundColor(n,i),borderColor:this.getPointBorderColor(n,i),borderWidth:this.getPointBorderWidth(n,i),tension:f.dataset._model?f.dataset._model.tension:0,hitRadius:n.custom&&n.custom.hitRadius?n.custom.hitRadius:t.getValueAtIndexOrDefault(this.getDataset().pointHitRadius,i,this.chart.options.elements.point.hitRadius)};n._model.skip=n.custom&&n.custom.skip?n.custom.skip:isNaN(n._model.x)||isNaN(n._model.y)},calculatePointY:function(n,t,i){var s=this.getMeta(),c=this.getScaleForId(s.xAxisID),u=this.getScaleForId(s.yAxisID),e,o,r,f,h;if(u.options.stacked){for(e=0,o=0,r=0;r<i;r++)f=this.chart.data.datasets[r],h=this.chart.getDatasetMeta(r),h.type==="line"&&this.chart.isDatasetVisible(r)&&(f.data[t]<0?o+=f.data[t]||0:e+=f.data[t]||0);return n<0?u.getPixelForValue(o+n):u.getPixelForValue(e+n)}return u.getPixelForValue(n)},updateBezierControlPoints:function(){var n=this.getMeta();t.each(n.data,function(i,r){var u=t.splineCurve(t.previousItem(n.data,r)._model,i._model,t.nextItem(n.data,r)._model,n.dataset._model.tension);i._model.controlPointPreviousX=Math.max(Math.min(u.previous.x,this.chart.chartArea.right),this.chart.chartArea.left);i._model.controlPointPreviousY=Math.max(Math.min(u.previous.y,this.chart.chartArea.bottom),this.chart.chartArea.top);i._model.controlPointNextX=Math.max(Math.min(u.next.x,this.chart.chartArea.right),this.chart.chartArea.left);i._model.controlPointNextY=Math.max(Math.min(u.next.y,this.chart.chartArea.bottom),this.chart.chartArea.top);i.pivot()},this)},draw:function(n){var i=this.getMeta(),r=n||1;t.each(i.data,function(n){n.transition(r)});this.chart.options.showLines&&i.dataset.transition(r).draw();t.each(i.data,function(n){n.draw()})},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.radius=n.custom&&n.custom.hoverRadius?n.custom.hoverRadius:t.getValueAtIndexOrDefault(i.pointHoverRadius,r,this.chart.options.elements.point.hoverRadius);n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.pointHoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.pointHoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.pointHoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;this.getDataset().radius!==undefined&&this.getDataset().pointRadius===undefined&&(this.getDataset().pointRadius=this.getDataset().radius);n._model.radius=n.custom&&n.custom.radius?n.custom.radius:t.getValueAtIndexOrDefault(this.getDataset().pointRadius,i,this.chart.options.elements.point.radius);n._model.backgroundColor=this.getPointBackgroundColor(n,i);n._model.borderColor=this.getPointBorderColor(n,i);n._model.borderWidth=this.getPointBorderWidth(n,i)}})}},{}],19:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.polarArea={scale:{type:"radialLinear",lineArc:!0},animation:{animateRotate:!0,animateScale:!0},aspectRatio:1,legendCallback:function(n){var t=[],i;if(t.push('<ul class="'+n.id+'-legend">'),n.data.datasets.length)for(i=0;i<n.data.datasets[0].data.length;++i)t.push('<li><span style="background-color:'+n.data.datasets[0].backgroundColor[i]+'">'),n.data.labels[i]&&t.push(n.data.labels[i]),t.push("<\/span><\/li>");return t.push("<\/ul>"),t.join("")},legend:{labels:{generateLabels:function(n){var i=n.data;return i.labels.length&&i.datasets.length?i.labels.map(function(r,u){var o=n.getDatasetMeta(0),e=i.datasets[0],f=o.data[u],s=f.custom&&f.custom.backgroundColor?f.custom.backgroundColor:t.getValueAtIndexOrDefault(e.backgroundColor,u,this.chart.options.elements.arc.backgroundColor),h=f.custom&&f.custom.borderColor?f.custom.borderColor:t.getValueAtIndexOrDefault(e.borderColor,u,this.chart.options.elements.arc.borderColor),c=f.custom&&f.custom.borderWidth?f.custom.borderWidth:t.getValueAtIndexOrDefault(e.borderWidth,u,this.chart.options.elements.arc.borderWidth);return{text:r,fillStyle:s,strokeStyle:h,lineWidth:c,hidden:isNaN(e.data[u])||o.data[u].hidden,index:u}},this):[]}},onClick:function(n,t){for(var f=t.index,r=this.chart,u,i=0,e=(r.data.datasets||[]).length;i<e;++i)u=r.getDatasetMeta(i),u.data[f].hidden=!u.data[f].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(n,t){return t.labels[n.index]+": "+n.yLabel}}}};n.controllers.polarArea=n.DatasetController.extend({linkScales:function(){},addElements:function(){var i=this.getMeta();t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:r})},this)},addElementAndReset:function(t){var i=new n.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.getMeta().data.splice(t,0,i);this.updateElement(i,t,!0)},update:function(n){var i=this.getMeta(),r=Math.min(this.chart.chartArea.right-this.chart.chartArea.left,this.chart.chartArea.bottom-this.chart.chartArea.top);this.chart.outerRadius=Math.max((r-this.chart.options.elements.arc.borderWidth/2)/2,0);this.chart.innerRadius=Math.max(this.chart.options.cutoutPercentage?this.chart.outerRadius/100*this.chart.options.cutoutPercentage:1,0);this.chart.radiusLength=(this.chart.outerRadius-this.chart.innerRadius)/this.chart.getVisibleDatasetCount();this.outerRadius=this.chart.outerRadius-this.chart.radiusLength*this.index;this.innerRadius=this.outerRadius-this.chart.radiusLength;i.count=this.countVisibleElements();t.each(i.data,function(t,i){this.updateElement(t,i,n)},this)},updateElement:function(n,i,r){for(var e=this.calculateCircumference(this.getDataset().data[i]),o=(this.chart.chartArea.left+this.chart.chartArea.right)/2,s=(this.chart.chartArea.top+this.chart.chartArea.bottom)/2,h=0,l=this.getMeta(),u=0;u<i;++u)isNaN(this.getDataset().data[u])||l.data[u].hidden||++h;var a=n.hidden?0:this.chart.scale.getDistanceFromCenterForValue(this.getDataset().data[i]),f=-.5*Math.PI+e*h,c=f+(n.hidden?0:e),v={x:o,y:s,innerRadius:0,outerRadius:this.chart.options.animation.animateScale?0:this.chart.scale.getDistanceFromCenterForValue(this.getDataset().data[i]),startAngle:this.chart.options.animation.animateRotate?Math.PI*-.5:f,endAngle:this.chart.options.animation.animateRotate?Math.PI*-.5:c,backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.arc.backgroundColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.arc.borderWidth),borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.arc.borderColor),label:t.getValueAtIndexOrDefault(this.chart.data.labels,i,this.chart.data.labels[i])};t.extend(n,{_chart:this.chart.chart,_datasetIndex:this.index,_index:i,_scale:this.chart.scale,_model:r?v:{x:o,y:s,innerRadius:0,outerRadius:a,startAngle:f,endAngle:c,backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.arc.backgroundColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.arc.borderWidth),borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.arc.borderColor),label:t.getValueAtIndexOrDefault(this.chart.data.labels,i,this.chart.data.labels[i])}});n.pivot()},draw:function(n){var i=n||1;t.each(this.getMeta().data,function(n){n.transition(i).draw()})},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.hoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.hoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.hoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;n._model.backgroundColor=n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().backgroundColor,i,this.chart.options.elements.arc.backgroundColor);n._model.borderColor=n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().borderColor,i,this.chart.options.elements.arc.borderColor);n._model.borderWidth=n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().borderWidth,i,this.chart.options.elements.arc.borderWidth)},countVisibleElements:function(){var i=this.getDataset(),r=this.getMeta(),n=0;return t.each(r.data,function(t,r){isNaN(i.data[r])||t.hidden||n++}),n},calculateCircumference:function(n){var t=this.getMeta().count;return t>0&&!isNaN(n)?2*Math.PI/t:0}})}},{}],20:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.radar={scale:{type:"radialLinear"},elements:{line:{tension:0}}};n.controllers.radar=n.DatasetController.extend({linkScales:function(){},addElements:function(){var i=this.getMeta();i.dataset=i.dataset||new n.elements.Line({_chart:this.chart.chart,_datasetIndex:this.index,_points:i.data,_loop:!0});t.each(this.getDataset().data,function(t,r){i.data[r]=i.data[r]||new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:r,_model:{x:0,y:0}})},this)},addElementAndReset:function(t){var i=new n.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.getMeta().data.splice(t,0,i);this.updateElement(i,t,!0);this.updateBezierControlPoints()},update:function(n){var u=this.getMeta(),i=u.dataset,f=u.data,r=this.chart.scale,e;e=r.min<0&&r.max<0?r.getPointPositionForValue(0,r.max):r.min>0&&r.max>0?r.getPointPositionForValue(0,r.min):r.getPointPositionForValue(0,0);this.getDataset().tension!==undefined&&this.getDataset().lineTension===undefined&&(this.getDataset().lineTension=this.getDataset().tension);t.extend(u.dataset,{_datasetIndex:this.index,_children:f,_model:{tension:i.custom&&i.custom.tension?i.custom.tension:t.getValueOrDefault(this.getDataset().lineTension,this.chart.options.elements.line.tension),backgroundColor:i.custom&&i.custom.backgroundColor?i.custom.backgroundColor:this.getDataset().backgroundColor||this.chart.options.elements.line.backgroundColor,borderWidth:i.custom&&i.custom.borderWidth?i.custom.borderWidth:this.getDataset().borderWidth||this.chart.options.elements.line.borderWidth,borderColor:i.custom&&i.custom.borderColor?i.custom.borderColor:this.getDataset().borderColor||this.chart.options.elements.line.borderColor,fill:i.custom&&i.custom.fill?i.custom.fill:this.getDataset().fill!==undefined?this.getDataset().fill:this.chart.options.elements.line.fill,borderCapStyle:i.custom&&i.custom.borderCapStyle?i.custom.borderCapStyle:this.getDataset().borderCapStyle||this.chart.options.elements.line.borderCapStyle,borderDash:i.custom&&i.custom.borderDash?i.custom.borderDash:this.getDataset().borderDash||this.chart.options.elements.line.borderDash,borderDashOffset:i.custom&&i.custom.borderDashOffset?i.custom.borderDashOffset:this.getDataset().borderDashOffset||this.chart.options.elements.line.borderDashOffset,borderJoinStyle:i.custom&&i.custom.borderJoinStyle?i.custom.borderJoinStyle:this.getDataset().borderJoinStyle||this.chart.options.elements.line.borderJoinStyle,scaleTop:r.top,scaleBottom:r.bottom,scaleZero:e}});u.dataset.pivot();t.each(f,function(t,i){this.updateElement(t,i,n)},this);this.updateBezierControlPoints()},updateElement:function(n,i,r){var u=this.chart.scale.getPointPositionForValue(i,this.getDataset().data[i]);t.extend(n,{_datasetIndex:this.index,_index:i,_scale:this.chart.scale,_model:{x:r?this.chart.scale.xCenter:u.x,y:r?this.chart.scale.yCenter:u.y,tension:n.custom&&n.custom.tension?n.custom.tension:t.getValueOrDefault(this.getDataset().tension,this.chart.options.elements.line.tension),radius:n.custom&&n.custom.radius?n.custom.radius:t.getValueAtIndexOrDefault(this.getDataset().pointRadius,i,this.chart.options.elements.point.radius),backgroundColor:n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,i,this.chart.options.elements.point.backgroundColor),borderColor:n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,i,this.chart.options.elements.point.borderColor),borderWidth:n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,i,this.chart.options.elements.point.borderWidth),pointStyle:n.custom&&n.custom.pointStyle?n.custom.pointStyle:t.getValueAtIndexOrDefault(this.getDataset().pointStyle,i,this.chart.options.elements.point.pointStyle),hitRadius:n.custom&&n.custom.hitRadius?n.custom.hitRadius:t.getValueAtIndexOrDefault(this.getDataset().hitRadius,i,this.chart.options.elements.point.hitRadius)}});n._model.skip=n.custom&&n.custom.skip?n.custom.skip:isNaN(n._model.x)||isNaN(n._model.y)},updateBezierControlPoints:function(){var n=this.getMeta();t.each(n.data,function(i,r){var u=t.splineCurve(t.previousItem(n.data,r,!0)._model,i._model,t.nextItem(n.data,r,!0)._model,i._model.tension);i._model.controlPointPreviousX=Math.max(Math.min(u.previous.x,this.chart.chartArea.right),this.chart.chartArea.left);i._model.controlPointPreviousY=Math.max(Math.min(u.previous.y,this.chart.chartArea.bottom),this.chart.chartArea.top);i._model.controlPointNextX=Math.max(Math.min(u.next.x,this.chart.chartArea.right),this.chart.chartArea.left);i._model.controlPointNextY=Math.max(Math.min(u.next.y,this.chart.chartArea.bottom),this.chart.chartArea.top);i.pivot()},this)},draw:function(n){var i=this.getMeta(),r=n||1;t.each(i.data,function(n){n.transition(r)});i.dataset.transition(r).draw();t.each(i.data,function(n){n.draw()})},setHoverStyle:function(n){var i=this.chart.data.datasets[n._datasetIndex],r=n._index;n._model.radius=n.custom&&n.custom.hoverRadius?n.custom.hoverRadius:t.getValueAtIndexOrDefault(i.pointHoverRadius,r,this.chart.options.elements.point.hoverRadius);n._model.backgroundColor=n.custom&&n.custom.hoverBackgroundColor?n.custom.hoverBackgroundColor:t.getValueAtIndexOrDefault(i.pointHoverBackgroundColor,r,t.color(n._model.backgroundColor).saturate(.5).darken(.1).rgbString());n._model.borderColor=n.custom&&n.custom.hoverBorderColor?n.custom.hoverBorderColor:t.getValueAtIndexOrDefault(i.pointHoverBorderColor,r,t.color(n._model.borderColor).saturate(.5).darken(.1).rgbString());n._model.borderWidth=n.custom&&n.custom.hoverBorderWidth?n.custom.hoverBorderWidth:t.getValueAtIndexOrDefault(i.pointHoverBorderWidth,r,n._model.borderWidth)},removeHoverStyle:function(n){var r=this.chart.data.datasets[n._datasetIndex],i=n._index;n._model.radius=n.custom&&n.custom.radius?n.custom.radius:t.getValueAtIndexOrDefault(this.getDataset().radius,i,this.chart.options.elements.point.radius);n._model.backgroundColor=n.custom&&n.custom.backgroundColor?n.custom.backgroundColor:t.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,i,this.chart.options.elements.point.backgroundColor);n._model.borderColor=n.custom&&n.custom.borderColor?n.custom.borderColor:t.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,i,this.chart.options.elements.point.borderColor);n._model.borderWidth=n.custom&&n.custom.borderWidth?n.custom.borderWidth:t.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,i,this.chart.options.elements.point.borderWidth)}})}},{}],21:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.global.animation={duration:1e3,easing:"easeOutQuart",onProgress:t.noop,onComplete:t.noop};n.Animation=n.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});n.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(n,t,i,r){r||(n.animating=!0);for(var u=0;u<this.animations.length;++u)if(this.animations[u].chartInstance===n){this.animations[u].animationObject=t;return}this.animations.push({chartInstance:n,animationObject:t});this.animations.length===1&&this.requestAnimationFrame()},cancelAnimation:function(n){var i=t.findIndex(this.animations,function(t){return t.chartInstance===n});i!==-1&&(this.animations.splice(i,1),n.animating=!1)},requestAnimationFrame:function(){var n=this;n.request===null&&(n.request=t.requestAnimFrame.call(window,function(){n.request=null;n.startDigest()}))},startDigest:function(){var u=Date.now(),t=0,n,i,r;for(this.dropFrames>1&&(t=Math.floor(this.dropFrames),this.dropFrames=this.dropFrames%1),n=0;n<this.animations.length;)this.animations[n].animationObject.currentStep===null&&(this.animations[n].animationObject.currentStep=0),this.animations[n].animationObject.currentStep+=1+t,this.animations[n].animationObject.currentStep>this.animations[n].animationObject.numSteps&&(this.animations[n].animationObject.currentStep=this.animations[n].animationObject.numSteps),this.animations[n].animationObject.render(this.animations[n].chartInstance,this.animations[n].animationObject),this.animations[n].animationObject.onAnimationProgress&&this.animations[n].animationObject.onAnimationProgress.call&&this.animations[n].animationObject.onAnimationProgress.call(this.animations[n].chartInstance,this.animations[n]),this.animations[n].animationObject.currentStep===this.animations[n].animationObject.numSteps?(this.animations[n].animationObject.onAnimationComplete&&this.animations[n].animationObject.onAnimationComplete.call&&this.animations[n].animationObject.onAnimationComplete.call(this.animations[n].chartInstance,this.animations[n]),this.animations[n].chartInstance.animating=!1,this.animations.splice(n,1)):++n;i=Date.now();r=(i-u)/this.frameDuration;this.dropFrames+=r;this.animations.length>0&&this.requestAnimationFrame()}}}},{}],22:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.types={};n.instances={};n.controllers={};n.Controller=function(i){return this.chart=i,this.config=i.config,this.options=this.config.options=t.configMerge(n.defaults.global,n.defaults[this.config.type],this.config.options||{}),this.id=t.uid(),Object.defineProperty(this,"data",{get:function(){return this.config.data}}),n.instances[this.id]=this,this.options.responsive&&this.resize(!0),this.initialize(),this};t.extend(n.Controller.prototype,{initialize:function(){return n.pluginService.notifyPlugins("beforeInit",[this]),this.bindEvents(),this.ensureScalesHaveIDs(),this.buildOrUpdateControllers(),this.buildScales(),this.buildSurroundingItems(),this.updateLayout(),this.resetElements(),this.initToolTip(),this.update(),n.pluginService.notifyPlugins("afterInit",[this]),this},clear:function(){return t.clear(this.chart),this},stop:function(){return n.animationService.cancelAnimation(this),this},resize:function(n){var r=this.chart.canvas,i=t.getMaximumWidth(this.chart.canvas),u=this.options.maintainAspectRatio&&isNaN(this.chart.aspectRatio)===!1&&isFinite(this.chart.aspectRatio)&&this.chart.aspectRatio!==0?i/this.chart.aspectRatio:t.getMaximumHeight(this.chart.canvas),f=this.chart.width!==i||this.chart.height!==u;return f?(r.width=this.chart.width=i,r.height=this.chart.height=u,t.retinaScale(this.chart),n||(this.stop(),this.update(this.options.responsiveAnimationDuration)),this):this},ensureScalesHaveIDs:function(){var n="x-axis-",i="y-axis-";this.options.scales&&(this.options.scales.xAxes&&this.options.scales.xAxes.length&&t.each(this.options.scales.xAxes,function(t,i){t.id=t.id||n+i}),this.options.scales.yAxes&&this.options.scales.yAxes.length&&t.each(this.options.scales.yAxes,function(n,t){n.id=n.id||i+t}))},buildScales:function(){var i,r;this.scales={};this.options.scales&&(this.options.scales.xAxes&&this.options.scales.xAxes.length&&t.each(this.options.scales.xAxes,function(i){var f=t.getValueOrDefault(i.type,"category"),u=n.scaleService.getScaleConstructor(f),r;u&&(r=new u({ctx:this.chart.ctx,options:i,chart:this,id:i.id}),this.scales[r.id]=r)},this),this.options.scales.yAxes&&this.options.scales.yAxes.length&&t.each(this.options.scales.yAxes,function(i){var f=t.getValueOrDefault(i.type,"linear"),u=n.scaleService.getScaleConstructor(f),r;u&&(r=new u({ctx:this.chart.ctx,options:i,chart:this,id:i.id}),this.scales[r.id]=r)},this));this.options.scale&&(i=n.scaleService.getScaleConstructor(this.options.scale.type),i&&(r=new i({ctx:this.chart.ctx,options:this.options.scale,chart:this}),this.scale=r,this.scales.radialScale=r));n.scaleService.addScalesToLayout(this)},buildSurroundingItems:function(){this.options.title&&(this.titleBlock=new n.Title({ctx:this.chart.ctx,options:this.options.title,chart:this}),n.layoutService.addBox(this,this.titleBlock));this.options.legend&&(this.legend=new n.Legend({ctx:this.chart.ctx,options:this.options.legend,chart:this}),n.layoutService.addBox(this,this.legend))},updateLayout:function(){n.layoutService.update(this,this.chart.width,this.chart.height)},buildOrUpdateControllers:function(){var i=[],u=[],r;if(t.each(this.data.datasets,function(t,r){var f=this.getDatasetMeta(r);f.type||(f.type=t.type||this.config.type);i.push(f.type);f.controller?f.controller.updateIndex(r):(f.controller=new n.controllers[f.type](this,r),u.push(f.controller))},this),i.length>1)for(r=1;r<i.length;r++)if(i[r]!==i[r-1]){this.isCombo=!0;break}return u},resetElements:function(){t.each(this.data.datasets,function(n,t){this.getDatasetMeta(t).controller.reset()},this)},update:function(i,r){n.pluginService.notifyPlugins("beforeUpdate",[this]);this.tooltip._data=this.data;var u=this.buildOrUpdateControllers();t.each(this.data.datasets,function(n,t){this.getDatasetMeta(t).controller.buildOrUpdateElements()},this);n.layoutService.update(this,this.chart.width,this.chart.height);t.each(u,function(n){n.reset()});t.each(this.data.datasets,function(n,t){this.getDatasetMeta(t).controller.update()},this);this.render(i,r);n.pluginService.notifyPlugins("afterUpdate",[this])},render:function(i,r){if(n.pluginService.notifyPlugins("beforeRender",[this]),this.options.animation&&(typeof i!="undefined"&&i!==0||typeof i=="undefined"&&this.options.animation.duration!==0)){var u=new n.Animation;u.numSteps=(i||this.options.animation.duration)/16.66;u.easing=this.options.animation.easing;u.render=function(n,i){var u=t.easingEffects[i.easing],r=i.currentStep/i.numSteps,f=u(r);n.draw(f,r,i.currentStep)};u.onAnimationProgress=this.options.animation.onProgress;u.onAnimationComplete=this.options.animation.onComplete;n.animationService.addAnimation(this,u,i,r)}else this.draw(),this.options.animation&&this.options.animation.onComplete&&this.options.animation.onComplete.call&&this.options.animation.onComplete.call(this);return this},draw:function(i){var r=i||1;this.clear();n.pluginService.notifyPlugins("beforeDraw",[this,r]);t.each(this.boxes,function(n){n.draw(this.chartArea)},this);this.scale&&this.scale.draw();this.chart.ctx.save();this.chart.ctx.beginPath();this.chart.ctx.rect(this.chartArea.left,this.chartArea.top,this.chartArea.right-this.chartArea.left,this.chartArea.bottom-this.chartArea.top);this.chart.ctx.clip();t.each(this.data.datasets,function(n,t){this.isDatasetVisible(t)&&this.getDatasetMeta(t).controller.draw(i)},this,!0);this.chart.ctx.restore();this.tooltip.transition(r).draw();n.pluginService.notifyPlugins("afterDraw",[this,r])},getElementAtEvent:function(n){var r=t.getRelativePosition(n,this.chart),i=[];return t.each(this.data.datasets,function(n,u){if(this.isDatasetVisible(u)){var f=this.getDatasetMeta(u);t.each(f.data,function(n){if(n.inRange(r.x,r.y))return i.push(n),i})}},this),i},getElementsAtEvent:function(n){var r=t.getRelativePosition(n,this.chart),i=[],u=function(){var n,i,t;if(this.data.datasets)for(n=0;n<this.data.datasets.length;n++)if(i=this.getDatasetMeta(n),this.isDatasetVisible(n))for(t=0;t<i.data.length;t++)if(i.data[t].inRange(r.x,r.y))return i.data[t]}.call(this);return u?(t.each(this.data.datasets,function(n,t){if(this.isDatasetVisible(t)){var r=this.getDatasetMeta(t);i.push(r.data[u._index])}},this),i):i},getDatasetAtEvent:function(n){var t=this.getElementAtEvent(n);return t.length>0&&(t=this.getDatasetMeta(t[0]._datasetIndex).data),t},getDatasetMeta:function(n){var t=this.data.datasets[n],i;return t._meta||(t._meta={}),i=t._meta[this.id],i||(i=t._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,n=0,i=this.data.datasets.length;n<i;++n)this.isDatasetVisible(n)&&t++;return t},isDatasetVisible:function(n){var t=this.getDatasetMeta(n);return typeof t.hidden=="boolean"?!t.hidden:!this.data.datasets[n].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroy:function(){this.clear();t.unbindEvents(this,this.events);t.removeResizeListener(this.chart.canvas.parentNode);var i=this.chart.canvas;i.width=this.chart.width;i.height=this.chart.height;this.chart.originalDevicePixelRatio!==undefined&&this.chart.ctx.scale(1/this.chart.originalDevicePixelRatio,1/this.chart.originalDevicePixelRatio);i.style.width=this.chart.originalCanvasStyleWidth;i.style.height=this.chart.originalCanvasStyleHeight;n.pluginService.notifyPlugins("destroy",[this]);delete n.instances[this.id]},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)},initToolTip:function(){this.tooltip=new n.Tooltip({_chart:this.chart,_chartInstance:this,_data:this.data,_options:this.options},this)},bindEvents:function(){t.bindEvents(this,this.options.events,function(n){this.eventHandler(n)})},eventHandler:function(n){var u,f,i,r,e;if(this.lastActive=this.lastActive||[],this.lastTooltipActive=this.lastTooltipActive||[],n.type==="mouseout"?(this.active=[],this.tooltipActive=[]):(u=this,f=function(t){switch(t){case"single":return u.getElementAtEvent(n);case"label":return u.getElementsAtEvent(n);case"dataset":return u.getDatasetAtEvent(n);default:return n}},this.active=f(this.options.hover.mode),this.tooltipActive=f(this.options.tooltips.mode)),this.options.hover.onHover&&this.options.hover.onHover.call(this,this.active),(n.type==="mouseup"||n.type==="click")&&(this.options.onClick&&this.options.onClick.call(this,n,this.active),this.legend&&this.legend.handleEvent&&this.legend.handleEvent(n)),this.lastActive.length)switch(this.options.hover.mode){case"single":this.getDatasetMeta(this.lastActive[0]._datasetIndex).controller.removeHoverStyle(this.lastActive[0],this.lastActive[0]._datasetIndex,this.lastActive[0]._index);break;case"label":case"dataset":for(i=0;i<this.lastActive.length;i++)this.lastActive[i]&&this.getDatasetMeta(this.lastActive[i]._datasetIndex).controller.removeHoverStyle(this.lastActive[i],this.lastActive[i]._datasetIndex,this.lastActive[i]._index)}if(this.active.length&&this.options.hover.mode)switch(this.options.hover.mode){case"single":this.getDatasetMeta(this.active[0]._datasetIndex).controller.setHoverStyle(this.active[0]);break;case"label":case"dataset":for(r=0;r<this.active.length;r++)this.active[r]&&this.getDatasetMeta(this.active[r]._datasetIndex).controller.setHoverStyle(this.active[r])}return(this.options.tooltips.enabled||this.options.tooltips.custom)&&(this.tooltip.initialize(),this.tooltip._active=this.tooltipActive,this.tooltip.update(!0)),this.tooltip.pivot(),this.animating||(t.each(this.active,function(n,t){n!==this.lastActive[t]&&(e=!0)},this),t.each(this.tooltipActive,function(n,t){n!==this.lastTooltipActive[t]&&(e=!0)},this),(this.lastActive.length!==this.active.length||this.lastTooltipActive.length!==this.tooltipActive.length||e)&&(this.stop(),(this.options.tooltips.enabled||this.options.tooltips.custom)&&this.tooltip.update(!0),this.render(this.options.hover.animationDuration,!0))),this.lastActive=this.active,this.lastTooltipActive=this.tooltipActive,this}})}},{}],23:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t=i.noop;n.DatasetController=function(n,t){this.initialize.call(this,n,t)};i.extend(n.DatasetController.prototype,{initialize:function(n,t){this.chart=n;this.index=t;this.linkScales();this.addElements()},updateIndex:function(n){this.index=n},linkScales:function(){var n=this.getMeta(),t=this.getDataset();n.xAxisID===null&&(n.xAxisID=t.xAxisID||this.chart.options.scales.xAxes[0].id);n.yAxisID===null&&(n.yAxisID=t.yAxisID||this.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(n){return this.chart.scales[n]},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var u=this.getMeta(),r=u.data,n=this.getDataset().data.length,t=r.length,i;if(n<t)r.splice(n,t-n);else if(n>t)for(i=t;i<n;++i)this.addElementAndReset(i)},addElements:t,addElementAndReset:t,draw:t,removeHoverStyle:t,setHoverStyle:t,update:t});n.DatasetController.extend=i.inherits}},{}],24:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.elements={};n.Element=function(n){t.extend(this,n);this.initialize.apply(this,arguments)};t.extend(n.Element.prototype,{initialize:function(){this.hidden=!1},pivot:function(){return this._view||(this._view=t.clone(this._model)),this._start=t.clone(this._view),this},transition:function(n){return(this._view||(this._view=t.clone(this._model)),n===1)?(this._view=this._model,this._start=null,this):(this._start||this.pivot(),t.each(this._model,function(i,r){var f,u;if(r[0]!=="_"&&this._model.hasOwnProperty(r))if(this._view.hasOwnProperty(r)){if(i!==this._view[r])if(typeof i=="string")try{f=t.color(this._start[r]).mix(t.color(this._model[r]),n);this._view[r]=f.rgbString()}catch(e){this._view[r]=i}else typeof i=="number"?(u=this._start[r]!==undefined&&isNaN(this._start[r])===!1?this._start[r]:0,this._view[r]=(this._model[r]-u)*n+u):this._view[r]=i}else this._view[r]=typeof i!="number"||isNaN(this._view[r])?i:i*n},this),this)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return t.isNumber(this._model.x)&&t.isNumber(this._model.y)}});n.Element.extend=t.inherits}},{}],25:[function(n,t){"use strict";var i=n("chartjs-color");t.exports=function(n){function u(n,t,i){var r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!=-1&&(r=r/100*t.parentNode[i])):r=n,r}function f(n,t,i){var e,r=document.defaultView.getComputedStyle(n)[t],f=document.defaultView.getComputedStyle(n.parentNode)[t],o=r!==null&&r!=="none",s=f!==null&&f!=="none";return(o||s)&&(e=Math.min(o?u(r,n,i):Number.POSITIVE_INFINITY,s?u(f,n.parentNode,i):Number.POSITIVE_INFINITY)),e}var t=n.helpers={},r;t.each=function(n,i,r,u){var f,e,o;if(t.isArray(n))if(e=n.length,u)for(f=e-1;f>=0;f--)i.call(r,n[f],f);else for(f=0;f<e;f++)i.call(r,n[f],f);else if(typeof n=="object")for(o=Object.keys(n),e=o.length,f=0;f<e;f++)i.call(r,n[o[f]],o[f])};t.clone=function(n){var i={};return t.each(n,function(r,u){n.hasOwnProperty(u)&&(i[u]=t.isArray(r)?r.slice(0):typeof r=="object"&&r!==null?t.clone(r):r)}),i};t.extend=function(n){for(var u=arguments.length,r=[],i=1;i<u;i++)r.push(arguments[i]);return t.each(r,function(i){t.each(i,function(t,r){i.hasOwnProperty(r)&&(n[r]=t)})}),n};t.configMerge=function(i){var r=t.clone(i);return t.each(Array.prototype.slice.call(arguments,1),function(i){t.each(i,function(u,f){if(i.hasOwnProperty(f))if(f==="scales")r[f]=t.scaleMerge(r.hasOwnProperty(f)?r[f]:{},u);else if(f==="scale")r[f]=t.configMerge(r.hasOwnProperty(f)?r[f]:{},n.scaleService.getScaleDefaults(u.type),u);else if(r.hasOwnProperty(f)&&t.isArray(r[f])&&t.isArray(u)){var e=r[f];t.each(u,function(n,i){i<e.length?e[i]=typeof e[i]=="object"&&e[i]!==null&&typeof n=="object"&&n!==null?t.configMerge(e[i],n):n:e.push(n)})}else r[f]=r.hasOwnProperty(f)&&typeof r[f]=="object"&&r[f]!==null&&typeof u=="object"?t.configMerge(r[f],u):u})}),r};t.extendDeep=function(){function n(i){return t.each(arguments,function(r){r!==i&&t.each(r,function(t,r){i[r]&&i[r].constructor&&i[r].constructor===Object?n(i[r],t):i[r]=t})}),i}return n.apply(this,arguments)};t.scaleMerge=function(i,r){var u=t.clone(i);return t.each(r,function(i,f){r.hasOwnProperty(f)&&(f==="xAxes"||f==="yAxes"?u.hasOwnProperty(f)?t.each(i,function(i,r){var o=t.getValueOrDefault(i.type,f==="xAxes"?"category":"linear"),e=n.scaleService.getScaleDefaults(o);r>=u[f].length||!u[f][r].type?u[f].push(t.configMerge(e,i)):u[f][r]=i.type&&i.type!==u[f][r].type?t.configMerge(u[f][r],e,i):t.configMerge(u[f][r],i)}):(u[f]=[],t.each(i,function(i){var r=t.getValueOrDefault(i.type,f==="xAxes"?"category":"linear");u[f].push(t.configMerge(n.scaleService.getScaleDefaults(r),i))})):u[f]=u.hasOwnProperty(f)&&typeof u[f]=="object"&&u[f]!==null&&typeof i=="object"?t.configMerge(u[f],i):i)}),u};t.getValueAtIndexOrDefault=function(n,i,r){return n===undefined||n===null?r:t.isArray(n)?i<n.length?n[i]:r:n};t.getValueOrDefault=function(n,t){return n===undefined?t:n};t.indexOf=function(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1};t.where=function(n,i){var r=[];return t.each(n,function(n){i(n)&&r.push(n)}),r};t.findIndex=function(n,t,i){var u=-1,r;if(Array.prototype.findIndex)u=n.findIndex(t,i);else for(r=0;r<n.length;++r)if(i=i!==undefined?i:n,t.call(i,n[r],r,n)){u=r;break}return u};t.findNextWhere=function(n,t,i){var r,u;for((i===undefined||i===null)&&(i=-1),r=i+1;r<n.length;r++)if(u=n[r],t(u))return u};t.findPreviousWhere=function(n,t,i){var r,u;for((i===undefined||i===null)&&(i=n.length),r=i-1;r>=0;r--)if(u=n[r],t(u))return u};t.inherits=function(n){var r=this,i=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return r.apply(this,arguments)},u=function(){this.constructor=i};return u.prototype=r.prototype,i.prototype=new u,i.extend=t.inherits,n&&t.extend(i.prototype,n),i.__super__=r.prototype,i};t.noop=function(){};t.uid=function(){var n=0;return function(){return n++}}();t.warn=function(n){console&&typeof console.warn=="function"&&console.warn(n)};t.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};t.almostEquals=function(n,t,i){return Math.abs(n-t)<i};t.max=function(n){return n.reduce(function(n,t){return isNaN(t)?n:Math.max(n,t)},Number.NEGATIVE_INFINITY)};t.min=function(n){return n.reduce(function(n,t){return isNaN(t)?n:Math.min(n,t)},Number.POSITIVE_INFINITY)};t.sign=function(n){return Math.sign?Math.sign(n):(n=+n,n===0||isNaN(n))?n:n>0?1:-1};t.log10=function(n){return Math.log10?Math.log10(n):Math.log(n)/Math.LN10};t.toRadians=function(n){return n*(Math.PI/180)};t.toDegrees=function(n){return n*(180/Math.PI)};t.getAngleFromPoint=function(n,t){var i=t.x-n.x,r=t.y-n.y,f=Math.sqrt(i*i+r*r),u=Math.atan2(r,i);return u<-.5*Math.PI&&(u+=2*Math.PI),{angle:u,distance:f}};t.aliasPixel=function(n){return n%2==0?0:.5};t.splineCurve=function(n,t,i,r){var f=n.skip?t:n,u=t,e=i.skip?t:i,h=Math.sqrt(Math.pow(u.x-f.x,2)+Math.pow(u.y-f.y,2)),c=Math.sqrt(Math.pow(e.x-u.x,2)+Math.pow(e.y-u.y,2)),o=h/(h+c),s=c/(h+c),l,a;return o=isNaN(o)?0:o,s=isNaN(s)?0:s,l=r*o,a=r*s,{previous:{x:u.x-l*(e.x-f.x),y:u.y-l*(e.y-f.y)},next:{x:u.x+a*(e.x-f.x),y:u.y+a*(e.y-f.y)}}};t.nextItem=function(n,t,i){return i?t>=n.length-1?n[0]:n[t+1]:t>=n.length-1?n[n.length-1]:n[t+1]};t.previousItem=function(n,t,i){return i?t<=0?n[n.length-1]:n[t-1]:t<=0?n[0]:n[t-1]};t.niceNum=function(n,i){var u=Math.floor(t.log10(n)),r=n/Math.pow(10,u),f;return f=i?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10,f*Math.pow(10,u)};r=t.easingEffects={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return-1*n*(n-2)},easeInOutQuad:function(n){return(n/=1/2)<1?1/2*n*n:-1/2*(--n*(n-2)-1)},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return 1*((n=n/1-1)*n*n+1)},easeInOutCubic:function(n){return(n/=1/2)<1?1/2*n*n*n:1/2*((n-=2)*n*n+2)},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return-1*((n=n/1-1)*n*n*n-1)},easeInOutQuart:function(n){return(n/=1/2)<1?1/2*n*n*n*n:-1/2*((n-=2)*n*n*n-2)},easeInQuint:function(n){return 1*(n/=1)*n*n*n*n},easeOutQuint:function(n){return 1*((n=n/1-1)*n*n*n*n+1)},easeInOutQuint:function(n){return(n/=1/2)<1?1/2*n*n*n*n*n:1/2*((n-=2)*n*n*n*n+2)},easeInSine:function(n){return-1*Math.cos(n/1*(Math.PI/2))+1},easeOutSine:function(n){return 1*Math.sin(n/1*(Math.PI/2))},easeInOutSine:function(n){return-1/2*(Math.cos(Math.PI*n/1)-1)},easeInExpo:function(n){return n===0?1:1*Math.pow(2,10*(n/1-1))},easeOutExpo:function(n){return n===1?1:1*(-Math.pow(2,-10*n)+1)},easeInOutExpo:function(n){return n===0?0:n===1?1:(n/=1/2)<1?1/2*Math.pow(2,10*(n-1)):1/2*(-Math.pow(2,-10*--n)+2)},easeInCirc:function(n){return n>=1?n:-1*(Math.sqrt(1-(n/=1)*n)-1)},easeOutCirc:function(n){return 1*Math.sqrt(1-(n=n/1-1)*n)},easeInOutCirc:function(n){return(n/=1/2)<1?-1/2*(Math.sqrt(1-n*n)-1):1/2*(Math.sqrt(1-(n-=2)*n)+1)},easeInElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)))},easeOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*n)*Math.sin((n*1-r)*2*Math.PI/t)+1)},easeInOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1/2)==2?1:(t||(t=1*.3*1.5),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),n<1)?-.5*i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t):i*Math.pow(2,-10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)*.5+1},easeInBack:function(n){var t=1.70158;return 1*(n/=1)*n*((t+1)*n-t)},easeOutBack:function(n){var t=1.70158;return 1*((n=n/1-1)*n*((t+1)*n+t)+1)},easeInOutBack:function(n){var t=1.70158;return(n/=1/2)<1?1/2*n*n*(((t*=1.525)+1)*n-t):1/2*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:function(n){return 1-r.easeOutBounce(1-n)},easeOutBounce:function(n){return(n/=1)<1/2.75?1*7.5625*n*n:n<2/2.75?1*(7.5625*(n-=1.5/2.75)*n+.75):n<2.5/2.75?1*(7.5625*(n-=2.25/2.75)*n+.9375):1*(7.5625*(n-=2.625/2.75)*n+.984375)},easeInOutBounce:function(n){return n<1/2?r.easeInBounce(n*2)*.5:r.easeOutBounce(n*2-1)*.5+1*.5}};t.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)}}();t.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(n){return window.clearTimeout(n,1e3/60)}}();t.getRelativePosition=function(n,i){var e,o,u=n.originalEvent||n,r=n.currentTarget||n.srcElement,f=r.getBoundingClientRect();u.touches&&u.touches.length>0?(e=u.touches[0].clientX,o=u.touches[0].clientY):(e=u.clientX,o=u.clientY);var s=parseFloat(t.getStyle(r,"padding-left")),h=parseFloat(t.getStyle(r,"padding-top")),c=parseFloat(t.getStyle(r,"padding-right")),l=parseFloat(t.getStyle(r,"padding-bottom")),a=f.right-f.left-s-c,v=f.bottom-f.top-h-l;return e=Math.round((e-f.left-s)/a*r.width/i.currentDevicePixelRatio),o=Math.round((o-f.top-h)/v*r.height/i.currentDevicePixelRatio),{x:e,y:o}};t.addEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i};t.removeEvent=function(n,i,r){n.removeEventListener?n.removeEventListener(i,r,!1):n.detachEvent?n.detachEvent("on"+i,r):n["on"+i]=t.noop};t.bindEvents=function(n,i,r){n.events||(n.events={});t.each(i,function(i){n.events[i]=function(){r.apply(n,arguments)};t.addEvent(n.chart.canvas,i,n.events[i])})};t.unbindEvents=function(n,i){t.each(i,function(i,r){t.removeEvent(n.chart.canvas,r,i)})};t.getConstraintWidth=function(n){return f(n,"max-width","clientWidth")};t.getConstraintHeight=function(n){return f(n,"max-height","clientHeight")};t.getMaximumWidth=function(n){var i=n.parentNode,f=parseInt(t.getStyle(i,"padding-left"))+parseInt(t.getStyle(i,"padding-right")),r=i.clientWidth-f,u=t.getConstraintWidth(n);return u!==undefined&&(r=Math.min(r,u)),r};t.getMaximumHeight=function(n){var i=n.parentNode,f=parseInt(t.getStyle(i,"padding-top"))+parseInt(t.getStyle(i,"padding-bottom")),r=i.clientHeight-f,u=t.getConstraintHeight(n);return u!==undefined&&(r=Math.min(r,u)),r};t.getStyle=function(n,t){return n.currentStyle?n.currentStyle[t]:document.defaultView.getComputedStyle(n,null).getPropertyValue(t)};t.retinaScale=function(n){var i=n.ctx,r=n.canvas.width,u=n.canvas.height,t=n.currentDevicePixelRatio=window.devicePixelRatio||1;t!==1&&(i.canvas.height=u*t,i.canvas.width=r*t,i.scale(t,t),n.originalDevicePixelRatio=n.originalDevicePixelRatio||t);i.canvas.style.width=r+"px";i.canvas.style.height=u+"px"};t.clear=function(n){n.ctx.clearRect(0,0,n.width,n.height)};t.fontString=function(n,t,i){return t+" "+n+"px "+i};t.longestText=function(n,i,r,u){var f,e,o;if(u=u||{},u.data=u.data||{},u.garbageCollect=u.garbageCollect||[],u.font!==i&&(u.data={},u.garbageCollect=[],u.font=i),n.font=i,f=0,t.each(r,function(t){if(t!==undefined&&t!==null){var i=u.data[t];i||(i=u.data[t]=n.measureText(t).width,u.garbageCollect.push(t));i>f&&(f=i)}}),e=u.garbageCollect.length/2,e>r.length){for(o=0;o<e;o++)delete u.data[u.garbageCollect[o]];u.garbageCollect.splice(0,e)}return f};t.drawRoundedRectangle=function(n,t,i,r,u,f){n.beginPath();n.moveTo(t+f,i);n.lineTo(t+r-f,i);n.quadraticCurveTo(t+r,i,t+r,i+f);n.lineTo(t+r,i+u-f);n.quadraticCurveTo(t+r,i+u,t+r-f,i+u);n.lineTo(t+f,i+u);n.quadraticCurveTo(t,i+u,t,i+u-f);n.lineTo(t,i+f);n.quadraticCurveTo(t,i,t+f,i);n.closePath()};t.color=function(t){return i?t instanceof CanvasGradient?i(n.defaults.global.defaultColor):i(t):(console.log("Color.js not found!"),t)};t.addResizeListener=function(n,t){var i=document.createElement("iframe"),r="chartjs-hidden-iframe";i.classlist?i.classlist.add(r):i.setAttribute("class",r);i.style.width="100%";i.style.display="block";i.style.border=0;i.style.height=0;i.style.margin=0;i.style.position="absolute";i.style.left=0;i.style.right=0;i.style.top=0;i.style.bottom=0;n.insertBefore(i,n.firstChild);(i.contentWindow||i).onresize=function(){t&&t()}};t.removeResizeListener=function(n){var t=n.querySelector(".chartjs-hidden-iframe");t&&t.parentNode.removeChild(t)};t.isArray=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"};t.pushAllIfDefined=function(n,i){typeof n!="undefined"&&(t.isArray(n)?i.push.apply(i,n):i.push(n))};t.callCallback=function(n,t,i){n&&typeof n.call=="function"&&n.apply(i,t)}}},{"chartjs-color":2}],26:[function(n,t){"use strict";t.exports=function(){var n=function(t,i){this.config=i;t.length&&t[0].getContext&&(t=t[0]);t.getContext&&(t=t.getContext("2d"));this.ctx=t;this.canvas=t.canvas;this.width=t.canvas.width||parseInt(n.helpers.getStyle(t.canvas,"width"))||n.helpers.getMaximumWidth(t.canvas);this.height=t.canvas.height||parseInt(n.helpers.getStyle(t.canvas,"height"))||n.helpers.getMaximumHeight(t.canvas);this.aspectRatio=this.width/this.height;(isNaN(this.aspectRatio)||isFinite(this.aspectRatio)===!1)&&(this.aspectRatio=i.aspectRatio!==undefined?i.aspectRatio:2);this.originalCanvasStyleWidth=t.canvas.style.width;this.originalCanvasStyleHeight=t.canvas.style.height;n.helpers.retinaScale(this);i&&(this.controller=new n.Controller(this));var r=this;return n.helpers.addResizeListener(t.canvas.parentNode,function(){r.controller&&r.controller.config.options.responsive&&r.controller.resize()}),this.controller?this.controller:this};return n.defaults={global:{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"single",animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},legendCallback:function(n){var t=[],i;for(t.push('<ul class="'+n.id+'-legend">'),i=0;i<n.data.datasets.length;i++)t.push('<li><span style="background-color:'+n.data.datasets[i].backgroundColor+'"><\/span>'),n.data.datasets[i].label&&t.push(n.data.datasets[i].label),t.push("<\/li>");return t.push("<\/ul>"),t.join("")}}},n}},{}],27:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.layoutService={defaults:{},addBox:function(n,t){n.boxes||(n.boxes=[]);n.boxes.push(t)},removeBox:function(n,t){n.boxes&&n.boxes.splice(n.boxes.indexOf(t),1)},update:function(n,i,r){function ht(n){var t,i=n.isHorizontal();i?(t=n.update(n.options.fullWidth?k:u,st),f-=t.height):(t=n.update(ot,rt),u-=t.width);tt.push({horizontal:i,minSize:t,box:n})}function ut(n){var i=t.findNextWhere(tt,function(t){return t.box===n}),r;i&&(n.isHorizontal()?(r={left:e,right:y,top:0,bottom:0},n.update(n.options.fullWidth?k:u,nt/2,r)):n.update(i.minSize.width,f))}function ct(n){var i=t.findNextWhere(tt,function(t){return t.box===n}),r={left:0,right:0,top:o,bottom:p};i&&n.update(i.minSize.width,f,r)}function it(n){n.isHorizontal()?(n.left=n.options.fullWidth?s:e,n.right=n.options.fullWidth?i-s:e+u,n.top=g,n.bottom=g+n.height,g=n.bottom):(n.left=d,n.right=d+n.width,n.top=o,n.bottom=o+f,d=n.right)}var w,b;if(n){var s=0,v=0,h=t.where(n.boxes,function(n){return n.options.position==="left"}),c=t.where(n.boxes,function(n){return n.options.position==="right"}),l=t.where(n.boxes,function(n){return n.options.position==="top"}),a=t.where(n.boxes,function(n){return n.options.position==="bottom"}),ft=t.where(n.boxes,function(n){return n.options.position==="chartArea"});l.sort(function(n,t){return(t.options.fullWidth?1:0)-(n.options.fullWidth?1:0)});a.sort(function(n,t){return(n.options.fullWidth?1:0)-(t.options.fullWidth?1:0)});var k=i-2*s,nt=r-2*v,et=k/2,rt=nt/2,ot=(i-et)/(h.length+c.length),st=(r-rt)/(l.length+a.length),u=k,f=nt,tt=[];t.each(h.concat(c,l,a),ht);var e=s,y=s,o=v,p=v;t.each(h.concat(c),ut);t.each(h,function(n){e+=n.width});t.each(c,function(n){y+=n.width});t.each(l.concat(a),ut);t.each(l,function(n){o+=n.height});t.each(a,function(n){p+=n.height});t.each(h.concat(c),ct);e=s;y=s;o=v;p=v;t.each(h,function(n){e+=n.width});t.each(c,function(n){y+=n.width});t.each(l,function(n){o+=n.height});t.each(a,function(n){p+=n.height});w=r-o-p;b=i-e-y;(b!==u||w!==f)&&(t.each(h,function(n){n.height=w}),t.each(c,function(n){n.height=w}),t.each(l,function(n){n.options.fullWidth||(n.width=b)}),t.each(a,function(n){n.options.fullWidth||(n.width=b)}),f=w,u=b);var d=s,g=v;t.each(h.concat(l),it);d+=u;g+=f;t.each(c,it);t.each(a,it);n.chartArea={left:e,top:o,right:e+u,bottom:o+f};t.each(ft,function(t){t.left=n.chartArea.left;t.top=n.chartArea.top;t.right=n.chartArea.right;t.bottom=n.chartArea.bottom;t.update(u,f)})}}}}},{}],28:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i=t.noop;n.defaults.global.legend={display:!0,position:"top",fullWidth:!0,reverse:!1,onClick:function(n,t){var r=t.datasetIndex,i=this.chart,u=i.getDatasetMeta(r);u.hidden=u.hidden===null?!i.data.datasets[r].hidden:null;i.update()},labels:{boxWidth:40,padding:10,generateLabels:function(n){var i=n.data;return t.isArray(i.datasets)?i.datasets.map(function(t,i){return{text:t.label,fillStyle:t.backgroundColor,hidden:!n.isDatasetVisible(i),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,datasetIndex:i}},this):[]}}};n.Legend=n.Element.extend({initialize:function(n){t.extend(this,n);this.legendHitBoxes=[];this.doughnutMode=!1},beforeUpdate:i,update:function(n,t,i){return this.beforeUpdate(),this.maxWidth=n,this.maxHeight=t,this.margins=i,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeBuildLabels(),this.buildLabels(),this.afterBuildLabels(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:i,beforeSetDimensions:i,setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height);this.paddingLeft=0;this.paddingTop=0;this.paddingRight=0;this.paddingBottom=0;this.minSize={width:0,height:0}},afterSetDimensions:i,beforeBuildLabels:i,buildLabels:function(){this.legendItems=this.options.labels.generateLabels.call(this,this.chart);this.options.reverse&&this.legendItems.reverse()},afterBuildLabels:i,beforeFit:i,fit:function(){var l=this.options,i=l.labels,o=l.display,e=this.ctx,s=n.defaults.global,h=t.getValueOrDefault,f=h(i.fontSize,s.defaultFontSize),v=h(i.fontStyle,s.defaultFontStyle),y=h(i.fontFamily,s.defaultFontFamily),p=t.fontString(f,v,y),w=this.legendHitBoxes=[],r=this.minSize,a=this.isHorizontal(),u,c;a?(r.width=this.maxWidth,r.height=o?10:0):(r.width=o?10:0,r.height=this.maxHeight);o&&a&&(u=this.lineWidths=[0],c=this.legendItems.length?f+i.padding:0,e.textAlign="left",e.textBaseline="top",e.font=p,t.each(this.legendItems,function(n,t){var r=i.boxWidth+f/2+e.measureText(n.text).width;u[u.length-1]+r+i.padding>=this.width&&(c+=f+i.padding,u[u.length]=this.left);w[t]={left:0,top:0,width:r,height:f};u[u.length-1]+=r+i.padding},this),r.height+=c);this.width=r.width;this.height=r.height},afterFit:i,isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},draw:function(){var a=this.options,f=a.labels,e=n.defaults.global,h=e.elements.line,c=this.width,v=this.lineWidths,s,l;if(a.display){var i=this.ctx,o={x:this.left+(c-v[0])/2,y:this.top+f.padding,line:0},r=t.getValueOrDefault,y=r(f.fontColor,e.defaultFontColor),u=r(f.fontSize,e.defaultFontSize),p=r(f.fontStyle,e.defaultFontStyle),w=r(f.fontFamily,e.defaultFontFamily),b=t.fontString(u,p,w);this.isHorizontal()&&(i.textAlign="left",i.textBaseline="top",i.lineWidth=.5,i.strokeStyle=y,i.fillStyle=y,i.font=b,s=f.boxWidth,l=this.legendHitBoxes,t.each(this.legendItems,function(n,t){var p=i.measureText(n.text).width,w=s+u/2+p,a=o.x,y=o.y;a+w>=c&&(y=o.y+=u+f.padding,o.line++,a=o.x=this.left+(c-v[o.line])/2);i.save();i.fillStyle=r(n.fillStyle,e.defaultColor);i.lineCap=r(n.lineCap,h.borderCapStyle);i.lineDashOffset=r(n.lineDashOffset,h.borderDashOffset);i.lineJoin=r(n.lineJoin,h.borderJoinStyle);i.lineWidth=r(n.lineWidth,h.borderWidth);i.strokeStyle=r(n.strokeStyle,e.defaultColor);i.setLineDash&&i.setLineDash(r(n.lineDash,h.borderDash));i.strokeRect(a,y,s,u);i.fillRect(a,y,s,u);i.restore();l[t].left=a;l[t].top=y;i.fillText(n.text,s+u/2+a,y);n.hidden&&(i.beginPath(),i.lineWidth=2,i.moveTo(s+u/2+a,y+u/2),i.lineTo(s+u/2+a+p,y+u/2),i.stroke());o.x+=w+f.padding},this))}},handleEvent:function(n){var o=t.getRelativePosition(n,this.chart.chart),u=o.x,f=o.y,s=this.options,e,r,i;if(u>=this.left&&u<=this.right&&f>=this.top&&f<=this.bottom)for(e=this.legendHitBoxes,r=0;r<e.length;++r)if(i=e[r],u>=i.left&&u<=i.left+i.width&&f>=i.top&&f<=i.top+i.height){s.onClick&&s.onClick.call(this,n,this.legendItems[r]);break}}})}},{}],29:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t;n.plugins=[];n.pluginService={register:function(t){var i=n.plugins;i.indexOf(t)===-1&&i.push(t)},remove:function(t){var i=n.plugins,r=i.indexOf(t);r!==-1&&i.splice(r,1)},notifyPlugins:function(t,r,u){i.each(n.plugins,function(n){n[t]&&typeof n[t]=="function"&&n[t].apply(u,r)},u)}};t=i.noop;n.PluginBase=n.Element.extend({beforeInit:t,afterInit:t,beforeUpdate:t,afterUpdate:t,beforeDraw:t,afterDraw:t,destroy:t})}},{}],30:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.scale={display:!0,position:"left",gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",offsetGridLines:!1},scaleLabel:{labelString:"",display:!1},ticks:{beginAtZero:!1,maxRotation:50,mirror:!1,padding:10,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,callback:function(n){return""+n}}};n.Scale=n.Element.extend({beforeUpdate:function(){t.callCallback(this.options.beforeUpdate,[this])},update:function(n,i,r){return this.beforeUpdate(),this.maxWidth=n,this.maxHeight=i,this.margins=t.extend({left:0,right:0,top:0,bottom:0},r),this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this.beforeBuildTicks(),this.buildTicks(),this.afterBuildTicks(),this.beforeTickToLabelConversion(),this.convertTicksToLabels(),this.afterTickToLabelConversion(),this.beforeCalculateTickRotation(),this.calculateTickRotation(),this.afterCalculateTickRotation(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:function(){t.callCallback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){t.callCallback(this.options.beforeSetDimensions,[this])},setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height);this.paddingLeft=0;this.paddingTop=0;this.paddingRight=0;this.paddingBottom=0},afterSetDimensions:function(){t.callCallback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){t.callCallback(this.options.beforeDataLimits,[this])},determineDataLimits:t.noop,afterDataLimits:function(){t.callCallback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){t.callCallback(this.options.beforeBuildTicks,[this])},buildTicks:t.noop,afterBuildTicks:function(){t.callCallback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){t.callCallback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){this.ticks=this.ticks.map(function(n,t,i){return this.options.ticks.userCallback?this.options.ticks.userCallback(n,t,i):this.options.ticks.callback(n,t,i)},this)},afterTickToLabelConversion:function(){t.callCallback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){t.callCallback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var i=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),l=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaults.global.defaultFontStyle),a=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaults.global.defaultFontFamily),o=t.fontString(i,l,a),r,s,u;if(this.ctx.font=o,r=this.ctx.measureText(this.ticks[0]).width,s=this.ctx.measureText(this.ticks[this.ticks.length-1]).width,this.labelRotation=0,this.paddingRight=0,this.paddingLeft=0,this.options.display&&this.isHorizontal()){this.paddingRight=s/2+3;this.paddingLeft=r/2+3;this.longestTextCache||(this.longestTextCache={});for(var f=t.longestText(this.ctx,o,this.ticks,this.longestTextCache),h=f,e,c,v=this.getPixelForTick(1)-this.getPixelForTick(0)-6;h>v&&this.labelRotation<this.options.ticks.maxRotation;){if(e=Math.cos(t.toRadians(this.labelRotation)),c=Math.sin(t.toRadians(this.labelRotation)),u=e*r,u+i/2>this.yLabelWidth&&(this.paddingLeft=u+i/2),this.paddingRight=i/2,c*f>this.maxHeight){this.labelRotation--;break}this.labelRotation++;h=e*f}}this.margins&&(this.paddingLeft=Math.max(this.paddingLeft-this.margins.left,0),this.paddingRight=Math.max(this.paddingRight-this.margins.right,0))},afterCalculateTickRotation:function(){t.callCallback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){t.callCallback(this.options.beforeFit,[this])},fit:function(){var r,e,s;this.minSize={width:0,height:0};var i=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),h=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaults.global.defaultFontStyle),c=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaults.global.defaultFontFamily),f=t.fontString(i,h,c),u=t.getValueOrDefault(this.options.scaleLabel.fontSize,n.defaults.global.defaultFontSize),l=t.getValueOrDefault(this.options.scaleLabel.fontStyle,n.defaults.global.defaultFontStyle),a=t.getValueOrDefault(this.options.scaleLabel.fontFamily,n.defaults.global.defaultFontFamily),w=t.fontString(u,l,a);if(this.minSize.width=this.isHorizontal()?this.isFullWidth()?this.maxWidth-this.margins.left-this.margins.right:this.maxWidth:this.options.gridLines.tickMarkLength,this.minSize.height=this.isHorizontal()?this.options.gridLines.tickMarkLength:this.maxHeight,this.options.scaleLabel.display&&(this.isHorizontal()?this.minSize.height+=u*1.5:this.minSize.width+=u*1.5),this.options.ticks.display&&this.options.display)if(this.longestTextCache||(this.longestTextCache={}),r=t.longestText(this.ctx,f,this.ticks,this.longestTextCache),this.isHorizontal()){this.longestLabelWidth=r;e=Math.sin(t.toRadians(this.labelRotation))*this.longestLabelWidth+1.5*i;this.minSize.height=Math.min(this.maxHeight,this.minSize.height+e);this.ctx.font=f;var o=this.ctx.measureText(this.ticks[0]).width,v=this.ctx.measureText(this.ticks[this.ticks.length-1]).width,y=Math.cos(t.toRadians(this.labelRotation)),p=Math.sin(t.toRadians(this.labelRotation));this.paddingLeft=this.labelRotation!==0?y*o+3:o/2+3;this.paddingRight=this.labelRotation!==0?p*(i/2)+3:v/2+3}else s=this.maxWidth-this.minSize.width,this.options.ticks.mirror||(r+=this.options.ticks.padding),r<s?this.minSize.width+=r:this.minSize.width=this.maxWidth,this.paddingTop=i/2,this.paddingBottom=i/2;this.margins&&(this.paddingLeft=Math.max(this.paddingLeft-this.margins.left,0),this.paddingTop=Math.max(this.paddingTop-this.margins.top,0),this.paddingRight=Math.max(this.paddingRight-this.margins.right,0),this.paddingBottom=Math.max(this.paddingBottom-this.margins.bottom,0));this.width=this.minSize.width;this.height=this.minSize.height},afterFit:function(){t.callCallback(this.options.afterFit,[this])},isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},isFullWidth:function(){return this.options.fullWidth},getRightValue:function i(n){return n===null||typeof n=="undefined"?NaN:typeof n=="number"&&isNaN(n)?NaN:typeof n=="object"?n instanceof Date?n:i(this.isHorizontal()?n.x:n.y):n},getLabelForIndex:t.noop,getPixelForValue:t.noop,getValueForPixel:t.noop,getPixelForTick:function(n,t){var u,f;if(this.isHorizontal()){var e=this.width-(this.paddingLeft+this.paddingRight),i=e/Math.max(this.ticks.length-(this.options.gridLines.offsetGridLines?0:1),1),r=i*n+this.paddingLeft;return t&&(r+=i/2),u=this.left+Math.round(r),u+(this.isFullWidth()?this.margins.left:0)}return f=this.height-(this.paddingTop+this.paddingBottom),this.top+n*(f/(this.ticks.length-1))},getPixelForDecimal:function(n){if(this.isHorizontal()){var t=this.width-(this.paddingLeft+this.paddingRight),i=t*n+this.paddingLeft,r=this.left+Math.round(i);return r+(this.isFullWidth()?this.margins.left:0)}return this.top+n*this.height},draw:function(i){var u,e,r,o,s,p,h,nt,tt,it,rt,ut;if(this.options.display){e=this.labelRotation!==0;p=this.options.ticks.autoSkip;this.options.ticks.maxTicksLimit&&(h=this.options.ticks.maxTicksLimit);var ft=t.getValueOrDefault(this.options.ticks.fontColor,n.defaults.global.defaultFontColor),w=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),et=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaults.global.defaultFontStyle),ot=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaults.global.defaultFontFamily),b=t.fontString(w,et,ot),c=this.options.gridLines.tickMarkLength,k=t.getValueOrDefault(this.options.scaleLabel.fontColor,n.defaults.global.defaultFontColor),f=t.getValueOrDefault(this.options.scaleLabel.fontSize,n.defaults.global.defaultFontSize),st=t.getValueOrDefault(this.options.scaleLabel.fontStyle,n.defaults.global.defaultFontStyle),ht=t.getValueOrDefault(this.options.scaleLabel.fontFamily,n.defaults.global.defaultFontFamily),d=t.fontString(f,st,ht),ct=Math.cos(t.toRadians(this.labelRotation)),lt=Math.sin(t.toRadians(this.labelRotation)),g=this.longestLabelWidth*ct,at=w*lt;if(this.ctx.fillStyle=ft,this.isHorizontal()){if(u=!0,nt=this.options.position==="bottom"?this.top:this.bottom-c,tt=this.options.position==="bottom"?this.top+c:this.bottom,r=!1,(g/2+this.options.ticks.autoSkipPadding)*this.ticks.length>this.width-(this.paddingLeft+this.paddingRight)&&(r=1+Math.floor((g/2+this.options.ticks.autoSkipPadding)*this.ticks.length/(this.width-(this.paddingLeft+this.paddingRight)))),h&&this.ticks.length>h)while(!r||this.ticks.length/(r||1)>h)r||(r=1),r+=1;p||(r=!1);t.each(this.ticks,function(n,f){var h=this.ticks.length===f+1,l=r>1&&f%r>0||f%r==0&&f+r>this.ticks.length,o,s;(!l||h)&&n!==undefined&&n!==null&&(o=this.getPixelForTick(f),s=this.getPixelForTick(f,this.options.gridLines.offsetGridLines),this.options.gridLines.display&&(f===(typeof this.zeroLineIndex!="undefined"?this.zeroLineIndex:0)?(this.ctx.lineWidth=this.options.gridLines.zeroLineWidth,this.ctx.strokeStyle=this.options.gridLines.zeroLineColor,u=!0):u&&(this.ctx.lineWidth=this.options.gridLines.lineWidth,this.ctx.strokeStyle=this.options.gridLines.color,u=!1),o+=t.aliasPixel(this.ctx.lineWidth),this.ctx.beginPath(),this.options.gridLines.drawTicks&&(this.ctx.moveTo(o,nt),this.ctx.lineTo(o,tt)),this.options.gridLines.drawOnChartArea&&(this.ctx.moveTo(o,i.top),this.ctx.lineTo(o,i.bottom)),this.ctx.stroke()),this.options.ticks.display&&(this.ctx.save(),this.ctx.translate(s,e?this.top+12:this.options.position==="top"?this.bottom-c:this.top+c),this.ctx.rotate(t.toRadians(this.labelRotation)*-1),this.ctx.font=b,this.ctx.textAlign=e?"right":"center",this.ctx.textBaseline=e?"middle":this.options.position==="top"?"bottom":"top",this.ctx.fillText(n,0,0),this.ctx.restore()))},this);this.options.scaleLabel.display&&(this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=k,this.ctx.font=d,o=this.left+(this.right-this.left)/2,s=this.options.position==="bottom"?this.bottom-f/2:this.top+f/2,this.ctx.fillText(this.options.scaleLabel.labelString,o,s))}else u=!0,it=this.options.position==="right"?this.left:this.right-5,rt=this.options.position==="right"?this.left+5:this.right,t.each(this.ticks,function(n,r){var f,e,o;n!==undefined&&n!==null&&(f=this.getPixelForTick(r),this.options.gridLines.display&&(r===(typeof this.zeroLineIndex!="undefined"?this.zeroLineIndex:0)?(this.ctx.lineWidth=this.options.gridLines.zeroLineWidth,this.ctx.strokeStyle=this.options.gridLines.zeroLineColor,u=!0):u&&(this.ctx.lineWidth=this.options.gridLines.lineWidth,this.ctx.strokeStyle=this.options.gridLines.color,u=!1),f+=t.aliasPixel(this.ctx.lineWidth),this.ctx.beginPath(),this.options.gridLines.drawTicks&&(this.ctx.moveTo(it,f),this.ctx.lineTo(rt,f)),this.options.gridLines.drawOnChartArea&&(this.ctx.moveTo(i.left,f),this.ctx.lineTo(i.right,f)),this.ctx.stroke()),this.options.ticks.display&&(o=this.getPixelForTick(r,this.options.gridLines.offsetGridLines),this.ctx.save(),this.options.position==="left"?this.options.ticks.mirror?(e=this.right+this.options.ticks.padding,this.ctx.textAlign="left"):(e=this.right-this.options.ticks.padding,this.ctx.textAlign="right"):this.options.ticks.mirror?(e=this.left-this.options.ticks.padding,this.ctx.textAlign="right"):(e=this.left+this.options.ticks.padding,this.ctx.textAlign="left"),this.ctx.translate(e,o),this.ctx.rotate(t.toRadians(this.labelRotation)*-1),this.ctx.font=b,this.ctx.textBaseline="middle",this.ctx.fillText(n,0,0),this.ctx.restore()))},this),this.options.scaleLabel.display&&(o=this.options.position==="left"?this.left+f/2:this.right-f/2,s=this.top+(this.bottom-this.top)/2,ut=this.options.position==="left"?-.5*Math.PI:.5*Math.PI,this.ctx.save(),this.ctx.translate(o,s),this.ctx.rotate(ut),this.ctx.textAlign="center",this.ctx.fillStyle=k,this.ctx.font=d,this.ctx.textBaseline="middle",this.ctx.fillText(this.options.scaleLabel.labelString,0,0),this.ctx.restore());this.ctx.lineWidth=this.options.gridLines.lineWidth;this.ctx.strokeStyle=this.options.gridLines.color;var l=this.left,a=this.right,v=this.top,y=this.bottom;this.isHorizontal()?(v=y=this.options.position==="top"?this.bottom:this.top,v+=t.aliasPixel(this.ctx.lineWidth),y+=t.aliasPixel(this.ctx.lineWidth)):(l=a=this.options.position==="left"?this.right:this.left,l+=t.aliasPixel(this.ctx.lineWidth),a+=t.aliasPixel(this.ctx.lineWidth));this.ctx.beginPath();this.ctx.moveTo(l,v);this.ctx.lineTo(a,y);this.ctx.stroke()}}})}},{}],31:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.scaleService={constructors:{},defaults:{},registerScaleType:function(n,i,r){this.constructors[n]=i;this.defaults[n]=t.clone(r)},getScaleConstructor:function(n){return this.constructors.hasOwnProperty(n)?this.constructors[n]:undefined},getScaleDefaults:function(i){return this.defaults.hasOwnProperty(i)?t.scaleMerge(n.defaults.scale,this.defaults[i]):{}},addScalesToLayout:function(i){t.each(i.scales,function(t){n.layoutService.addBox(i,t)})}}}},{}],32:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t;n.defaults.global.title={display:!1,position:"top",fullWidth:!0,fontStyle:"bold",padding:10,text:""};t=i.noop;n.Title=n.Element.extend({initialize:function(t){i.extend(this,t);this.options=i.configMerge(n.defaults.global.title,t.options);this.legendHitBoxes=[]},beforeUpdate:t,update:function(n,t,i){return this.beforeUpdate(),this.maxWidth=n,this.maxHeight=t,this.margins=i,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeBuildLabels(),this.buildLabels(),this.afterBuildLabels(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:t,beforeSetDimensions:t,setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height);this.paddingLeft=0;this.paddingTop=0;this.paddingRight=0;this.paddingBottom=0;this.minSize={width:0,height:0}},afterSetDimensions:t,beforeBuildLabels:t,buildLabels:t,afterBuildLabels:t,beforeFit:t,fit:function(){var s=this.ctx,e=i.getValueOrDefault,r=this.options,o=n.defaults.global,u=r.display,f=e(r.fontSize,o.defaultFontSize),t=this.minSize;this.isHorizontal()?(t.width=this.maxWidth,t.height=u?f+r.padding*2:0):(t.width=u?f+r.padding*2:0,t.height=this.maxHeight);this.width=t.width;this.height=t.height},afterFit:t,isHorizontal:function(){var n=this.options.position;return n==="top"||n==="bottom"},draw:function(){var t=this.ctx,u=i.getValueOrDefault,r=this.options,f=n.defaults.global;if(r.display){var e=u(r.fontSize,f.defaultFontSize),c=u(r.fontStyle,f.defaultFontStyle),l=u(r.fontFamily,f.defaultFontFamily),a=i.fontString(e,c,l),h=0,o,s;t.fillStyle=u(r.fontColor,f.defaultFontColor);t.font=a;this.isHorizontal()?(o=this.left+(this.right-this.left)/2,s=this.top+(this.bottom-this.top)/2):(o=r.position==="left"?this.left+e/2:this.right-e/2,s=this.top+(this.bottom-this.top)/2,h=Math.PI*(r.position==="left"?-.5:.5));t.save();t.translate(o,s);t.rotate(h);t.textAlign="center";t.textBaseline="middle";t.fillText(r.text,0,0);t.restore()}}})}},{}],33:[function(n,t){"use strict";t.exports=function(n){function i(n,i){return i&&(t.isArray(i)?n=n.concat(i):n.push(i)),n}var t=n.helpers;n.defaults.global.tooltips={enabled:!0,custom:null,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleColor:"#fff",titleAlign:"left",bodySpacing:2,bodyColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,yAlign:"center",xAlign:"center",caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",callbacks:{beforeTitle:t.noop,title:function(n,t){var i="";return n.length>0&&(n[0].xLabel?i=n[0].xLabel:t.labels.length>0&&n[0].index<t.labels.length&&(i=t.labels[n[0].index])),i},afterTitle:t.noop,beforeBody:t.noop,beforeLabel:t.noop,label:function(n,t){var i=t.datasets[n.datasetIndex].label||"";return i+": "+n.yLabel},afterLabel:t.noop,afterBody:t.noop,beforeFooter:t.noop,footer:t.noop,afterFooter:t.noop}};n.Tooltip=n.Element.extend({initialize:function(){var i=this._options;t.extend(this,{_model:{xPadding:i.tooltips.xPadding,yPadding:i.tooltips.yPadding,xAlign:i.tooltips.yAlign,yAlign:i.tooltips.xAlign,bodyColor:i.tooltips.bodyColor,_bodyFontFamily:t.getValueOrDefault(i.tooltips.bodyFontFamily,n.defaults.global.defaultFontFamily),_bodyFontStyle:t.getValueOrDefault(i.tooltips.bodyFontStyle,n.defaults.global.defaultFontStyle),_bodyAlign:i.tooltips.bodyAlign,bodyFontSize:t.getValueOrDefault(i.tooltips.bodyFontSize,n.defaults.global.defaultFontSize),bodySpacing:i.tooltips.bodySpacing,titleColor:i.tooltips.titleColor,_titleFontFamily:t.getValueOrDefault(i.tooltips.titleFontFamily,n.defaults.global.defaultFontFamily),_titleFontStyle:t.getValueOrDefault(i.tooltips.titleFontStyle,n.defaults.global.defaultFontStyle),titleFontSize:t.getValueOrDefault(i.tooltips.titleFontSize,n.defaults.global.defaultFontSize),_titleAlign:i.tooltips.titleAlign,titleSpacing:i.tooltips.titleSpacing,titleMarginBottom:i.tooltips.titleMarginBottom,footerColor:i.tooltips.footerColor,_footerFontFamily:t.getValueOrDefault(i.tooltips.footerFontFamily,n.defaults.global.defaultFontFamily),_footerFontStyle:t.getValueOrDefault(i.tooltips.footerFontStyle,n.defaults.global.defaultFontStyle),footerFontSize:t.getValueOrDefault(i.tooltips.footerFontSize,n.defaults.global.defaultFontSize),_footerAlign:i.tooltips.footerAlign,footerSpacing:i.tooltips.footerSpacing,footerMarginTop:i.tooltips.footerMarginTop,caretSize:i.tooltips.caretSize,cornerRadius:i.tooltips.cornerRadius,backgroundColor:i.tooltips.backgroundColor,opacity:0,legendColorBackground:i.tooltips.multiKeyBackground}})},getTitle:function(){var t=this._options.tooltips.callbacks.beforeTitle.apply(this,arguments),r=this._options.tooltips.callbacks.title.apply(this,arguments),u=this._options.tooltips.callbacks.afterTitle.apply(this,arguments),n=[];return n=i(n,t),n=i(n,r),i(n,u)},getBeforeBody:function(){var n=this._options.tooltips.callbacks.beforeBody.apply(this,arguments);return t.isArray(n)?n:n!==undefined?[n]:[]},getBody:function(n,i){var r=[];return t.each(n,function(n){t.pushAllIfDefined(this._options.tooltips.callbacks.beforeLabel.call(this,n,i),r);t.pushAllIfDefined(this._options.tooltips.callbacks.label.call(this,n,i),r);t.pushAllIfDefined(this._options.tooltips.callbacks.afterLabel.call(this,n,i),r)},this),r},getAfterBody:function(){var n=this._options.tooltips.callbacks.afterBody.apply(this,arguments);return t.isArray(n)?n:n!==undefined?[n]:[]},getFooter:function(){var t=this._options.tooltips.callbacks.beforeFooter.apply(this,arguments),r=this._options.tooltips.callbacks.footer.apply(this,arguments),u=this._options.tooltips.callbacks.afterFooter.apply(this,arguments),n=[];return n=i(n,t),n=i(n,r),i(n,u)},getAveragePosition:function(n){var i,u,f,e,r;if(!n.length)return!1;for(i=[],u=[],t.each(n,function(n){if(n){var t=n.tooltipPosition();i.push(t.x);u.push(t.y)}}),f=0,e=0,r=0;r<i.length;r++)f+=i[r],e+=u[r];return{x:Math.round(f/i.length),y:Math.round(e/i.length)}},update:function(n){var f,e;if(this._active.length){this._model.opacity=1;var i=this._active[0],o=[],u,r=[];this._options.tooltips.mode==="single"?(f=i._yScale||i._scale,r.push({xLabel:i._xScale?i._xScale.getLabelForIndex(i._index,i._datasetIndex):"",yLabel:f?f.getLabelForIndex(i._index,i._datasetIndex):"",index:i._index,datasetIndex:i._datasetIndex}),u=this.getAveragePosition(this._active)):(t.each(this._data.datasets,function(n,t){var e,u,f;this._chartInstance.isDatasetVisible(t)&&(e=this._chartInstance.getDatasetMeta(t),u=e.data[i._index],u&&(f=i._yScale||i._scale,r.push({xLabel:u._xScale?u._xScale.getLabelForIndex(u._index,u._datasetIndex):"",yLabel:f?f.getLabelForIndex(u._index,u._datasetIndex):"",index:i._index,datasetIndex:t})))},this),t.each(this._active,function(n){n&&o.push({borderColor:n._view.borderColor,backgroundColor:n._view.backgroundColor})},null),u=this.getAveragePosition(this._active));t.extend(this._model,{title:this.getTitle(r,this._data),beforeBody:this.getBeforeBody(r,this._data),body:this.getBody(r,this._data),afterBody:this.getAfterBody(r,this._data),footer:this.getFooter(r,this._data)});t.extend(this._model,{x:Math.round(u.x),y:Math.round(u.y),caretPadding:t.getValueOrDefault(u.padding,2),labelColors:o});e=this.getTooltipSize(this._model);this.determineAlignment(e);t.extend(this._model,this.getBackgroundPoint(this._model,e))}else this._model.opacity=0;return n&&this._options.tooltips.custom&&this._options.tooltips.custom.call(this,this._model),this},getTooltipSize:function(n){var r=this._chart.ctx,i={height:n.yPadding*2,width:0},u=n.body.length+n.beforeBody.length+n.afterBody.length;return i.height+=n.title.length*n.titleFontSize,i.height+=(n.title.length-1)*n.titleSpacing,i.height+=n.title.length?n.titleMarginBottom:0,i.height+=u*n.bodyFontSize,i.height+=u?(u-1)*n.bodySpacing:0,i.height+=n.footer.length?n.footerMarginTop:0,i.height+=n.footer.length*n.footerFontSize,i.height+=n.footer.length?(n.footer.length-1)*n.footerSpacing:0,r.font=t.fontString(n.titleFontSize,n._titleFontStyle,n._titleFontFamily),t.each(n.title,function(n){i.width=Math.max(i.width,r.measureText(n).width)}),r.font=t.fontString(n.bodyFontSize,n._bodyFontStyle,n._bodyFontFamily),t.each(n.beforeBody.concat(n.afterBody),function(n){i.width=Math.max(i.width,r.measureText(n).width)}),t.each(n.body,function(t){i.width=Math.max(i.width,r.measureText(t).width+(this._options.tooltips.mode!=="single"?n.bodyFontSize+2:0))},this),r.font=t.fontString(n.footerFontSize,n._footerFontStyle,n._footerFontFamily),t.each(n.footer,function(n){i.width=Math.max(i.width,r.measureText(n).width)}),i.width+=2*n.xPadding,i},determineAlignment:function(n){this._model.y<n.height?this._model.yAlign="top":this._model.y>this._chart.height-n.height&&(this._model.yAlign="bottom");var t,i,u,f,r,e=this,o=(this._chartInstance.chartArea.left+this._chartInstance.chartArea.right)/2,s=(this._chartInstance.chartArea.top+this._chartInstance.chartArea.bottom)/2;this._model.yAlign==="center"?(t=function(n){return n<=o},i=function(n){return n>o}):(t=function(t){return t<=n.width/2},i=function(t){return t>=e._chart.width-n.width/2});u=function(t){return t+n.width>e._chart.width};f=function(t){return t-n.width<0};r=function(n){return n<=s?"top":"bottom"};t(this._model.x)?(this._model.xAlign="left",u(this._model.x)&&(this._model.xAlign="center",this._model.yAlign=r(this._model.y))):i(this._model.x)&&(this._model.xAlign="right",f(this._model.x)&&(this._model.xAlign="center",this._model.yAlign=r(this._model.y)))},getBackgroundPoint:function(n,t){var i={x:n.x,y:n.y};return n.xAlign==="right"?i.x-=t.width:n.xAlign==="center"&&(i.x-=t.width/2),n.yAlign==="top"?i.y+=n.caretPadding+n.caretSize:i.y-=n.yAlign==="bottom"?t.height+n.caretPadding+n.caretSize:t.height/2,n.yAlign==="center"?n.xAlign==="left"?i.x+=n.caretPadding+n.caretSize:n.xAlign==="right"&&(i.x-=n.caretPadding+n.caretSize):n.xAlign==="left"?i.x-=n.cornerRadius+n.caretPadding:n.xAlign==="right"&&(i.x+=n.cornerRadius+n.caretPadding),i},drawCaret:function(n,i,r){var u=this._view,s=this._chart.ctx,f,e,h,o,c,l,a;u.yAlign==="center"?(u.xAlign==="left"?(f=n.x,e=f-u.caretSize,h=f):(f=n.x+i.width,e=f+u.caretSize,h=f),c=n.y+i.height/2,o=c-u.caretSize,l=c+u.caretSize):(u.xAlign==="left"?(f=n.x+u.cornerRadius,e=f+u.caretSize,h=e+u.caretSize):u.xAlign==="right"?(f=n.x+i.width-u.cornerRadius,e=f-u.caretSize,h=e-u.caretSize):(e=n.x+i.width/2,f=e-u.caretSize,h=e+u.caretSize),u.yAlign==="top"?(o=n.y,c=o-u.caretSize,l=o):(o=n.y+i.height,c=o+u.caretSize,l=o));a=t.color(u.backgroundColor);s.fillStyle=a.alpha(r*a.alpha()).rgbString();s.beginPath();s.moveTo(f,o);s.lineTo(e,c);s.lineTo(h,l);s.closePath();s.fill()},drawTitle:function(n,i,r,u){if(i.title.length){r.textAlign=i._titleAlign;r.textBaseline="top";var f=t.color(i.titleColor);r.fillStyle=f.alpha(u*f.alpha()).rgbString();r.font=t.fontString(i.titleFontSize,i._titleFontStyle,i._titleFontFamily);t.each(i.title,function(t,u){r.fillText(t,n.x,n.y);n.y+=i.titleFontSize+i.titleSpacing;u+1===i.title.length&&(n.y+=i.titleMarginBottom-i.titleSpacing)})}},drawBody:function(n,i,r,u){r.textAlign=i._bodyAlign;r.textBaseline="top";var f=t.color(i.bodyColor);r.fillStyle=f.alpha(u*f.alpha()).rgbString();r.font=t.fontString(i.bodyFontSize,i._bodyFontStyle,i._bodyFontFamily);t.each(i.beforeBody,function(t){r.fillText(t,n.x,n.y);n.y+=i.bodyFontSize+i.bodySpacing});t.each(i.body,function(f,e){this._options.tooltips.mode!=="single"&&(r.fillStyle=t.color(i.legendColorBackground).alpha(u).rgbaString(),r.fillRect(n.x,n.y,i.bodyFontSize,i.bodyFontSize),r.strokeStyle=t.color(i.labelColors[e].borderColor).alpha(u).rgbaString(),r.strokeRect(n.x,n.y,i.bodyFontSize,i.bodyFontSize),r.fillStyle=t.color(i.labelColors[e].backgroundColor).alpha(u).rgbaString(),r.fillRect(n.x+1,n.y+1,i.bodyFontSize-2,i.bodyFontSize-2),r.fillStyle=t.color(i.bodyColor).alpha(u).rgbaString());r.fillText(f,n.x+(this._options.tooltips.mode!=="single"?i.bodyFontSize+2:0),n.y);n.y+=i.bodyFontSize+i.bodySpacing},this);t.each(i.afterBody,function(t){r.fillText(t,n.x,n.y);n.y+=i.bodyFontSize});n.y-=i.bodySpacing},drawFooter:function(n,i,r,u){if(i.footer.length){n.y+=i.footerMarginTop;r.textAlign=i._footerAlign;r.textBaseline="top";var f=t.color(i.footerColor);r.fillStyle=f.alpha(u*f.alpha()).rgbString();r.font=t.fontString(i.footerFontSize,i._footerFontStyle,i._footerFontFamily);t.each(i.footer,function(t){r.fillText(t,n.x,n.y);n.y+=i.footerFontSize+i.footerSpacing})}},draw:function(){var r=this._chart.ctx,n=this._view,e;if(n.opacity!==0){var o=n.caretPadding,f=this.getTooltipSize(n),i={x:n.x,y:n.y},u=Math.abs(n.opacity<.001)?0:n.opacity;this._options.tooltips.enabled&&(e=t.color(n.backgroundColor),r.fillStyle=e.alpha(u*e.alpha()).rgbString(),t.drawRoundedRectangle(r,i.x,i.y,f.width,f.height,n.cornerRadius),r.fill(),this.drawCaret(i,f,u,o),i.x+=n.xPadding,i.y+=n.yPadding,this.drawTitle(i,n,r,u),this.drawBody(i,n,r,u),this.drawFooter(i,n,r,u))}}})}},{}],34:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t=n.defaults.global;t.elements.arc={backgroundColor:t.defaultColor,borderColor:"#fff",borderWidth:2};n.elements.Arc=n.Element.extend({inLabelRange:function(n){var t=this._view;return t?Math.pow(n-t.x,2)<Math.pow(t.radius+t.hoverRadius,2):!1},inRange:function(n,t){var r=this._view,h,c;if(r){for(var o=i.getAngleFromPoint(r,{x:n,y:t}),u=o.angle,s=o.distance,e=r.startAngle,f=r.endAngle;f<e;)f+=2*Math.PI;while(u>f)u-=2*Math.PI;while(u<e)u+=2*Math.PI;return h=u>=e&&u<=f,c=s>=r.innerRadius&&s<=r.outerRadius,h&&c}return!1},tooltipPosition:function(){var n=this._view,t=n.startAngle+(n.endAngle-n.startAngle)/2,i=(n.outerRadius-n.innerRadius)/2+n.innerRadius;return{x:n.x+Math.cos(t)*i,y:n.y+Math.sin(t)*i}},draw:function(){var t=this._chart.ctx,n=this._view,i=n.startAngle,r=n.endAngle;t.beginPath();t.arc(n.x,n.y,n.outerRadius,i,r);t.arc(n.x,n.y,n.innerRadius,r,i,!0);t.closePath();t.strokeStyle=n.borderColor;t.lineWidth=n.borderWidth;t.fillStyle=n.backgroundColor;t.fill();t.lineJoin="bevel";n.borderWidth&&t.stroke()}})}},{}],35:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers;n.defaults.global.elements.line={tension:.4,backgroundColor:n.defaults.global.defaultColor,borderWidth:3,borderColor:n.defaults.global.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",fill:!0};n.elements.Line=n.Element.extend({lineToNextPoint:function(n,t,i,r,u){var f=this._chart.ctx;t._view.skip?r.call(this,n,t,i):n._view.skip?u.call(this,n,t,i):t._view.tension===0?f.lineTo(t._view.x,t._view.y):f.bezierCurveTo(n._view.controlPointNextX,n._view.controlPointNextY,t._view.controlPointPreviousX,t._view.controlPointPreviousY,t._view.x,t._view.y)},draw:function(){function o(n){u._view.skip||f._view.skip?n&&i.lineTo(e._view.scaleZero.x,e._view.scaleZero.y):i.bezierCurveTo(f._view.controlPointNextX,f._view.controlPointNextY,u._view.controlPointPreviousX,u._view.controlPointPreviousY,u._view.x,u._view.y)}var e=this,r=this._view,i=this._chart.ctx,u=this._children[0],f=this._children[this._children.length-1];i.save();this._children.length>0&&r.fill&&(i.beginPath(),t.each(this._children,function(n,u){var e=t.previousItem(this._children,u),f=t.nextItem(this._children,u);u===0?(this._loop?i.moveTo(r.scaleZero.x,r.scaleZero.y):i.moveTo(n._view.x,r.scaleZero),n._view.skip?this._loop||i.moveTo(f._view.x,this._view.scaleZero):i.lineTo(n._view.x,n._view.y)):this.lineToNextPoint(e,n,f,function(n,t,r){this._loop?i.lineTo(this._view.scaleZero.x,this._view.scaleZero.y):(i.lineTo(n._view.x,this._view.scaleZero),i.moveTo(r._view.x,this._view.scaleZero))},function(n,t){i.lineTo(t._view.x,t._view.y)})},this),this._loop?o(!0):(i.lineTo(this._children[this._children.length-1]._view.x,r.scaleZero),i.lineTo(this._children[0]._view.x,r.scaleZero)),i.fillStyle=r.backgroundColor||n.defaults.global.defaultColor,i.closePath(),i.fill());i.lineCap=r.borderCapStyle||n.defaults.global.elements.line.borderCapStyle;i.setLineDash&&i.setLineDash(r.borderDash||n.defaults.global.elements.line.borderDash);i.lineDashOffset=r.borderDashOffset||n.defaults.global.elements.line.borderDashOffset;i.lineJoin=r.borderJoinStyle||n.defaults.global.elements.line.borderJoinStyle;i.lineWidth=r.borderWidth||n.defaults.global.elements.line.borderWidth;i.strokeStyle=r.borderColor||n.defaults.global.defaultColor;i.beginPath();t.each(this._children,function(n,r){var u=t.previousItem(this._children,r),f=t.nextItem(this._children,r);r===0?i.moveTo(n._view.x,n._view.y):this.lineToNextPoint(u,n,f,function(n,t,r){i.moveTo(r._view.x,r._view.y)},function(n,t){i.moveTo(t._view.x,t._view.y)})},this);this._loop&&this._children.length>0&&o();i.stroke();i.restore()}})}},{}],36:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t=n.defaults.global;t.elements.point={radius:3,pointStyle:"circle",backgroundColor:t.defaultColor,borderWidth:1,borderColor:t.defaultColor,hitRadius:1,hoverRadius:4,hoverBorderWidth:1};n.elements.Point=n.Element.extend({inRange:function(n,t){var i=this._view;return i?Math.pow(n-i.x,2)+Math.pow(t-i.y,2)<Math.pow(i.hitRadius+i.radius,2):!1},inLabelRange:function(n){var t=this._view;return t?Math.pow(n-t.x,2)<Math.pow(t.radius+t.hitRadius,2):!1},tooltipPosition:function(){var n=this._view;return{x:n.x,y:n.y,padding:n.radius+n.borderWidth}},draw:function(){var e=this._view,u=e.x,f=e.y,t=this._chart.ctx,h,r,o,s,c,l;if(!e.skip){if(h=e.pointStyle,typeof h=="object"&&(h.toString()==="[object HTMLImageElement]"||h.toString()==="[object HTMLCanvasElement]")){t.drawImage(h,u-h.width/2,f-h.height/2);return}if(!isNaN(e.radius)&&e.radius>0){t.strokeStyle=e.borderColor||n.defaults.global.defaultColor;t.lineWidth=i.getValueOrDefault(e.borderWidth,n.defaults.global.elements.point.borderWidth);t.fillStyle=e.backgroundColor||n.defaults.global.defaultColor;r=e.radius;switch(h){default:t.beginPath();t.arc(u,f,r,0,Math.PI*2);t.closePath();t.fill();break;case"triangle":t.beginPath();c=3*r/Math.sqrt(3);l=c*Math.sqrt(3)/2;t.moveTo(u-c/2,f+l/3);t.lineTo(u+c/2,f+l/3);t.lineTo(u,f-2*l/3);t.closePath();t.fill();break;case"rect":t.fillRect(u-1/Math.SQRT2*r,f-1/Math.SQRT2*r,2/Math.SQRT2*r,2/Math.SQRT2*r);t.strokeRect(u-1/Math.SQRT2*r,f-1/Math.SQRT2*r,2/Math.SQRT2*r,2/Math.SQRT2*r);break;case"rectRot":t.translate(u,f);t.rotate(Math.PI/4);t.fillRect(-1/Math.SQRT2*r,-1/Math.SQRT2*r,2/Math.SQRT2*r,2/Math.SQRT2*r);t.strokeRect(-1/Math.SQRT2*r,-1/Math.SQRT2*r,2/Math.SQRT2*r,2/Math.SQRT2*r);t.setTransform(1,0,0,1,0,0);break;case"cross":t.beginPath();t.moveTo(u,f+r);t.lineTo(u,f-r);t.moveTo(u-r,f);t.lineTo(u+r,f);t.closePath();break;case"crossRot":t.beginPath();o=Math.cos(Math.PI/4)*r;s=Math.sin(Math.PI/4)*r;t.moveTo(u-o,f-s);t.lineTo(u+o,f+s);t.moveTo(u-o,f+s);t.lineTo(u+o,f-s);t.closePath();break;case"star":t.beginPath();t.moveTo(u,f+r);t.lineTo(u,f-r);t.moveTo(u-r,f);t.lineTo(u+r,f);o=Math.cos(Math.PI/4)*r;s=Math.sin(Math.PI/4)*r;t.moveTo(u-o,f-s);t.lineTo(u+o,f+s);t.moveTo(u-o,f+s);t.lineTo(u+o,f-s);t.closePath();break;case"line":t.beginPath();t.moveTo(u-r,f);t.lineTo(u+r,f);t.closePath();break;case"dash":t.beginPath();t.moveTo(u,f);t.lineTo(u+r,f);t.closePath()}t.stroke()}}}})}},{}],37:[function(n,t){"use strict";t.exports=function(n){var i=n.helpers,t=n.defaults.global;t.elements.rectangle={backgroundColor:t.defaultColor,borderWidth:0,borderColor:t.defaultColor,borderSkipped:"bottom"};n.elements.Rectangle=n.Element.extend({draw:function(){function h(n){return c[(o+n)%4]}var t=this._chart.ctx,n=this._view,s=n.width/2,r=n.x-s,u=n.x+s,f=n.base-(n.base-n.y),e=n.borderWidth/2,i;n.borderWidth&&(r+=e,u-=e,f+=e);t.beginPath();t.fillStyle=n.backgroundColor;t.strokeStyle=n.borderColor;t.lineWidth=n.borderWidth;var c=[[r,n.base],[r,f],[u,f],[u,n.base]],o=["bottom","left","top","right"].indexOf(n.borderSkipped,0);for(o===-1&&(o=0),t.moveTo.apply(t,h(0)),i=1;i<4;i++)t.lineTo.apply(t,h(i));t.fill();n.borderWidth&&t.stroke()},height:function(){var n=this._view;return n.base-n.y},inRange:function(n,t){var i=this._view;return i?i.y<i.base?n>=i.x-i.width/2&&n<=i.x+i.width/2&&t>=i.y&&t<=i.base:n>=i.x-i.width/2&&n<=i.x+i.width/2&&t>=i.base&&t<=i.y:!1},inLabelRange:function(n){var t=this._view;return t?n>=t.x-t.width/2&&n<=t.x+t.width/2:!1},tooltipPosition:function(){var n=this._view;return{x:n.x,y:n.y}}})}},{}],38:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i=n.Scale.extend({determineDataLimits:function(){this.minIndex=0;this.maxIndex=this.chart.data.labels.length-1;var n;this.options.ticks.min!==undefined&&(n=t.indexOf(this.chart.data.labels,this.options.ticks.min),this.minIndex=n!==-1?n:this.minIndex);this.options.ticks.max!==undefined&&(n=t.indexOf(this.chart.data.labels,this.options.ticks.max),this.maxIndex=n!==-1?n:this.maxIndex);this.min=this.chart.data.labels[this.minIndex];this.max=this.chart.data.labels[this.maxIndex]},buildTicks:function(){this.ticks=this.minIndex===0&&this.maxIndex===this.chart.data.labels.length-1?this.chart.data.labels:this.chart.data.labels.slice(this.minIndex,this.maxIndex+1)},getLabelForIndex:function(n){return this.ticks[n]},getPixelForValue:function(n,t,i,r){var u=Math.max(this.maxIndex+1-this.minIndex-(this.options.gridLines.offsetGridLines?0:1),1);if(this.isHorizontal()){var h=this.width-(this.paddingLeft+this.paddingRight),f=h/u,e=f*(t-this.minIndex)+this.paddingLeft;return this.options.gridLines.offsetGridLines&&r&&(e+=f/2),this.left+Math.round(e)}var c=this.height-(this.paddingTop+this.paddingBottom),o=c/u,s=o*(t-this.minIndex)+this.paddingTop;return this.options.gridLines.offsetGridLines&&r&&(s+=o/2),this.top+Math.round(s)},getPixelForTick:function(n,t){return this.getPixelForValue(this.ticks[n],n+this.minIndex,null,t)},getValueForPixel:function(n){var r=Math.max(this.ticks.length-(this.options.gridLines.offsetGridLines?0:1),1),t=this.isHorizontal(),u=t?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),i=u/r;return this.options.gridLines.offsetGridLines&&(n-=i/2),n-=t?this.paddingLeft:this.paddingTop,n<=0?0:Math.round(n/i)}});n.scaleService.registerScaleType("category",i,{position:"bottom"})}},{}],39:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i={position:"left",ticks:{callback:function(n,i,r){var e=r.length>3?r[2]-r[1]:r[1]-r[0],o,u,f;return Math.abs(e)>1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),o=t.log10(Math.abs(e)),u="",n!==0?(f=-1*Math.floor(o),f=Math.max(Math.min(f,20),0),u=n.toFixed(f)):u="0",u}}},r=n.Scale.extend({determineDataLimits:function(){var i,r;if(this.min=null,this.max=null,this.options.stacked){var n={},u=!1,f=!1;t.each(this.chart.data.datasets,function(i,r){var e=this.chart.getDatasetMeta(r),o,s;n[e.type]===undefined&&(n[e.type]={positiveValues:[],negativeValues:[]});o=n[e.type].positiveValues;s=n[e.type].negativeValues;this.chart.isDatasetVisible(r)&&(this.isHorizontal()?e.xAxisID===this.id:e.yAxisID===this.id)&&t.each(i.data,function(n,t){var i=+this.getRightValue(n);isNaN(i)||e.data[t].hidden||(o[t]=o[t]||0,s[t]=s[t]||0,this.options.relativePoints?o[t]=100:i<0?(f=!0,s[t]+=i):(u=!0,o[t]+=i))},this)},this);t.each(n,function(n){var i=n.positiveValues.concat(n.negativeValues),r=t.min(i),u=t.max(i);this.min=this.min===null?r:Math.min(this.min,r);this.max=this.max===null?u:Math.max(this.max,u)},this)}else t.each(this.chart.data.datasets,function(n,i){var r=this.chart.getDatasetMeta(i);this.chart.isDatasetVisible(i)&&(this.isHorizontal()?r.xAxisID===this.id:r.yAxisID===this.id)&&t.each(n.data,function(n,t){var i=+this.getRightValue(n);isNaN(i)||r.data[t].hidden||(this.min===null?this.min=i:i<this.min&&(this.min=i),this.max===null?this.max=i:i>this.max&&(this.max=i))},this)},this);this.options.ticks.beginAtZero&&(i=t.sign(this.min),r=t.sign(this.max),i<0&&r<0?this.max=0:i>0&&r>0&&(this.min=0));this.options.ticks.min!==undefined?this.min=this.options.ticks.min:this.options.ticks.suggestedMin!==undefined&&(this.min=Math.min(this.min,this.options.ticks.suggestedMin));this.options.ticks.max!==undefined?this.max=this.options.ticks.max:this.options.ticks.suggestedMax!==undefined&&(this.max=Math.max(this.max,this.options.ticks.suggestedMax));this.min===this.max&&(this.min--,this.max++)},buildTicks:function(){var u,o,i,s,h,f;this.ticks=[];this.isHorizontal()?u=Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.width/50)):(o=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),u=Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.height/(2*o))));u=Math.max(2,u);s=this.options.ticks.fixedStepSize&&this.options.ticks.fixedStepSize>0||this.options.ticks.stepSize&&this.options.ticks.stepSize>0;s?i=t.getValueOrDefault(this.options.ticks.fixedStepSize,this.options.ticks.stepSize):(h=t.niceNum(this.max-this.min,!1),i=t.niceNum(h/(u-1),!0));var e=Math.floor(this.min/i)*i,c=Math.ceil(this.max/i)*i,r=(c-e)/i;for(r=t.almostEquals(r,Math.round(r),i/1e3)?Math.round(r):Math.ceil(r),this.ticks.push(this.options.ticks.min!==undefined?this.options.ticks.min:e),f=1;f<r;++f)this.ticks.push(e+f*i);this.ticks.push(this.options.ticks.max!==undefined?this.options.ticks.max:c);(this.options.position==="left"||this.options.position==="right")&&this.ticks.reverse();this.max=t.max(this.ticks);this.min=t.min(this.ticks);this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max)},getLabelForIndex:function(n,t){return+this.getRightValue(this.chart.data.datasets[t].data[n])},convertTicksToLabels:function(){this.ticksAsNumbers=this.ticks.slice();this.zeroLineIndex=this.ticks.indexOf(0);n.Scale.prototype.convertTicksToLabels.call(this)},getPixelForValue:function(n){var i=+this.getRightValue(n),t,r=this.end-this.start,u,f;return this.isHorizontal()?(u=this.width-(this.paddingLeft+this.paddingRight),t=this.left+u/r*(i-this.start),Math.round(t+this.paddingLeft)):(f=this.height-(this.paddingTop+this.paddingBottom),t=this.bottom-this.paddingBottom-f/r*(i-this.start),Math.round(t))},getValueForPixel:function(n){var t,i,r;return this.isHorizontal()?(i=this.width-(this.paddingLeft+this.paddingRight),t=(n-this.left-this.paddingLeft)/i):(r=this.height-(this.paddingTop+this.paddingBottom),t=(this.bottom-this.paddingBottom-n)/r),this.start+(this.end-this.start)*t},getPixelForTick:function(n,t){return this.getPixelForValue(this.ticksAsNumbers[n],null,null,t)}});n.scaleService.registerScaleType("linear",r,i)}},{}],40:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i={position:"left",ticks:{callback:function(t,i,r){var u=t/Math.pow(10,Math.floor(n.helpers.log10(t)));return u===1||u===2||u===5||i===0||i===r.length-1?t.toExponential():""}}},r=n.Scale.extend({determineDataLimits:function(){if(this.min=null,this.max=null,this.options.stacked){var n={};t.each(this.chart.data.datasets,function(i,r){var u=this.chart.getDatasetMeta(r);this.chart.isDatasetVisible(r)&&(this.isHorizontal()?u.xAxisID===this.id:u.yAxisID===this.id)&&(n[u.type]===undefined&&(n[u.type]=[]),t.each(i.data,function(t,i){var r=n[u.type],f=+this.getRightValue(t);isNaN(f)||u.data[i].hidden||(r[i]=r[i]||0,this.options.relativePoints?r[i]=100:r[i]+=f)},this))},this);t.each(n,function(n){var i=t.min(n),r=t.max(n);this.min=this.min===null?i:Math.min(this.min,i);this.max=this.max===null?r:Math.max(this.max,r)},this)}else t.each(this.chart.data.datasets,function(n,i){var r=this.chart.getDatasetMeta(i);this.chart.isDatasetVisible(i)&&(this.isHorizontal()?r.xAxisID===this.id:r.yAxisID===this.id)&&t.each(n.data,function(n,t){var i=+this.getRightValue(n);isNaN(i)||r.data[t].hidden||(this.min===null?this.min=i:i<this.min&&(this.min=i),this.max===null?this.max=i:i>this.max&&(this.max=i))},this)},this);this.min=this.options.ticks.min!==undefined?this.options.ticks.min:this.min;this.max=this.options.ticks.max!==undefined?this.options.ticks.max:this.max;this.min===this.max&&(this.min!==0&&this.min!==null?(this.min=Math.pow(10,Math.floor(t.log10(this.min))-1),this.max=Math.pow(10,Math.floor(t.log10(this.max))+1)):(this.min=1,this.max=10))},buildTicks:function(){var n,i,r,u;for(this.ticks=[],n=this.options.ticks.min!==undefined?this.options.ticks.min:Math.pow(10,Math.floor(t.log10(this.min)));n<this.max;)this.ticks.push(n),i=Math.floor(t.log10(n)),r=Math.floor(n/Math.pow(10,i))+1,r===10&&(r=1,++i),n=r*Math.pow(10,i);u=this.options.ticks.max!==undefined?this.options.ticks.max:n;this.ticks.push(u);(this.options.position==="left"||this.options.position==="right")&&this.ticks.reverse();this.max=t.max(this.ticks);this.min=t.min(this.ticks);this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max)},convertTicksToLabels:function(){this.tickValues=this.ticks.slice();n.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(n,t){return+this.getRightValue(this.chart.data.datasets[t].data[n])},getPixelForTick:function(n,t){return this.getPixelForValue(this.tickValues[n],null,null,t)},getPixelForValue:function(n){var i,r=+this.getRightValue(n),u=t.log10(this.end)-t.log10(this.start),f,e;return this.isHorizontal()?r===0?i=this.left+this.paddingLeft:(f=this.width-(this.paddingLeft+this.paddingRight),i=this.left+f/u*(t.log10(r)-t.log10(this.start))+this.paddingLeft):r===0?i=this.top+this.paddingTop:(e=this.height-(this.paddingTop+this.paddingBottom),i=this.bottom-this.paddingBottom-e/u*(t.log10(r)-t.log10(this.start))),i},getValueForPixel:function(n){var r=t.log10(this.end)-t.log10(this.start),i,u,f;return this.isHorizontal()?(u=this.width-(this.paddingLeft+this.paddingRight),i=this.start*Math.pow(10,(n-this.left-this.paddingLeft)*r/u)):(f=this.height-(this.paddingTop+this.paddingBottom),i=Math.pow(10,(this.bottom-this.paddingBottom-n)*r/f)/this.start),i}});n.scaleService.registerScaleType("logarithmic",r,i)}},{}],41:[function(n,t){"use strict";t.exports=function(n){var t=n.helpers,i={display:!0,animate:!0,lineArc:!1,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2},pointLabels:{fontSize:10,callback:function(n){return n}}},r=n.Scale.extend({getValueCount:function(){return this.chart.data.labels.length},setDimensions:function(){this.width=this.maxWidth;this.height=this.maxHeight;this.xCenter=Math.round(this.width/2);this.yCenter=Math.round(this.height/2);var i=t.min([this.height,this.width]),r=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize);this.drawingArea=this.options.display?i/2-(r/2+this.options.ticks.backdropPaddingY):i/2},determineDataLimits:function(){if(this.min=null,this.max=null,t.each(this.chart.data.datasets,function(n,i){if(this.chart.isDatasetVisible(i)){var r=this.chart.getDatasetMeta(i);t.each(n.data,function(n,t){var i=+this.getRightValue(n);isNaN(i)||r.data[t].hidden||(this.min===null?this.min=i:i<this.min&&(this.min=i),this.max===null?this.max=i:i>this.max&&(this.max=i))},this)}},this),this.options.ticks.beginAtZero){var n=t.sign(this.min),i=t.sign(this.max);n<0&&i<0?this.max=0:n>0&&i>0&&(this.min=0)}this.options.ticks.min!==undefined?this.min=this.options.ticks.min:this.options.ticks.suggestedMin!==undefined&&(this.min=Math.min(this.min,this.options.ticks.suggestedMin));this.options.ticks.max!==undefined?this.max=this.options.ticks.max:this.options.ticks.suggestedMax!==undefined&&(this.max=Math.max(this.max,this.options.ticks.suggestedMax));this.min===this.max&&(this.min--,this.max++)},buildTicks:function(){var e,r,u;this.ticks=[];e=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize);r=Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*e)));r=Math.max(2,r);var s=t.niceNum(this.max-this.min,!1),i=t.niceNum(s/(r-1),!0),f=Math.floor(this.min/i)*i,o=Math.ceil(this.max/i)*i,h=Math.ceil((o-f)/i);for(this.ticks.push(this.options.ticks.min!==undefined?this.options.ticks.min:f),u=1;u<h;++u)this.ticks.push(f+u*i);this.ticks.push(this.options.ticks.max!==undefined?this.options.ticks.max:o);this.max=t.max(this.ticks);this.min=t.min(this.ticks);this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max);this.zeroLineIndex=this.ticks.indexOf(0)},convertTicksToLabels:function(){n.Scale.prototype.convertTicksToLabels.call(this);this.pointLabels=this.chart.data.labels.map(this.options.pointLabels.callback,this)},getLabelForIndex:function(n,t){return+this.getRightValue(this.chart.data.datasets[t].data[n])},fit:function(){var a=t.getValueOrDefault(this.options.pointLabels.fontSize,n.defaults.global.defaultFontSize),k=t.getValueOrDefault(this.options.pointLabels.fontStyle,n.defaults.global.defaultFontStyle),d=t.getValueOrDefault(this.options.pointLabels.fontFamily,n.defaults.global.defaultFontFamily),g=t.fontString(a,k,d),v=t.min([this.height/2-a-5,this.width/2]),r,i,u,o,s=this.width,c,y,h=0,l,p,w,b,f,e;for(this.ctx.font=g,i=0;i<this.getValueCount();i++)r=this.getPointPosition(i,v),u=this.ctx.measureText(this.pointLabels[i]?this.pointLabels[i]:"").width+5,i===0||i===this.getValueCount()/2?(o=u/2,r.x+o>s&&(s=r.x+o,c=i),r.x-o<h&&(h=r.x-o,l=i)):i<this.getValueCount()/2?r.x+u>s&&(s=r.x+u,c=i):i>this.getValueCount()/2&&r.x-u<h&&(h=r.x-u,l=i);w=h;b=Math.ceil(s-this.width);y=this.getIndexAngle(c);p=this.getIndexAngle(l);f=b/Math.sin(y+Math.PI/2);e=w/Math.sin(p+Math.PI/2);f=t.isNumber(f)?f:0;e=t.isNumber(e)?e:0;this.drawingArea=Math.round(v-(e+f)/2);this.setCenterPoint(e,f)},setCenterPoint:function(n,t){var i=this.width-t-this.drawingArea,r=n+this.drawingArea;this.xCenter=Math.round((r+i)/2+this.left);this.yCenter=Math.round(this.height/2+this.top)},getIndexAngle:function(n){var t=Math.PI*2/this.getValueCount();return n*t-Math.PI/2},getDistanceFromCenterForValue:function(n){if(n===null)return 0;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-n)*t:(n-this.min)*t},getPointPosition:function(n,t){var i=this.getIndexAngle(n);return{x:Math.round(Math.cos(i)*t)+this.xCenter,y:Math.round(Math.sin(i)*t)+this.yCenter}},getPointPositionForValue:function(n,t){return this.getPointPosition(n,this.getDistanceFromCenterForValue(t))},draw:function(){var i,r,f;if(this.options.display&&(i=this.ctx,t.each(this.ticks,function(r,u){var o,s,f,e,c;if(u>0||this.options.reverse){if(o=this.getDistanceFromCenterForValue(this.ticks[u]),s=this.yCenter-o,this.options.gridLines.display)if(i.strokeStyle=this.options.gridLines.color,i.lineWidth=this.options.gridLines.lineWidth,this.options.lineArc)i.beginPath(),i.arc(this.xCenter,this.yCenter,o,0,Math.PI*2),i.closePath(),i.stroke();else{for(i.beginPath(),f=0;f<this.getValueCount();f++)e=this.getPointPosition(f,this.getDistanceFromCenterForValue(this.ticks[u])),f===0?i.moveTo(e.x,e.y):i.lineTo(e.x,e.y);i.closePath();i.stroke()}if(this.options.ticks.display){var l=t.getValueOrDefault(this.options.ticks.fontColor,n.defaults.global.defaultFontColor),h=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),a=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaults.global.defaultFontStyle),v=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaults.global.defaultFontFamily),y=t.fontString(h,a,v);i.font=y;this.options.ticks.showLabelBackdrop&&(c=i.measureText(r).width,i.fillStyle=this.options.ticks.backdropColor,i.fillRect(this.xCenter-c/2-this.options.ticks.backdropPaddingX,s-h/2-this.options.ticks.backdropPaddingY,c+this.options.ticks.backdropPaddingX*2,h+this.options.ticks.backdropPaddingY*2));i.textAlign="center";i.textBaseline="middle";i.fillStyle=l;i.fillText(r,this.xCenter,s)}}},this),!this.options.lineArc))for(i.lineWidth=this.options.angleLines.lineWidth,i.strokeStyle=this.options.angleLines.color,r=this.getValueCount()-1;r>=0;r--){this.options.angleLines.display&&(f=this.getPointPosition(r,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max)),i.beginPath(),i.moveTo(this.xCenter,this.yCenter),i.lineTo(f.x,f.y),i.stroke(),i.closePath());var o=this.getPointPosition(r,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max)+5),h=t.getValueOrDefault(this.options.pointLabels.fontColor,n.defaults.global.defaultFontColor),c=t.getValueOrDefault(this.options.pointLabels.fontSize,n.defaults.global.defaultFontSize),l=t.getValueOrDefault(this.options.pointLabels.fontStyle,n.defaults.global.defaultFontStyle),a=t.getValueOrDefault(this.options.pointLabels.fontFamily,n.defaults.global.defaultFontFamily),v=t.fontString(c,l,a);i.font=v;i.fillStyle=h;var s=this.pointLabels.length,e=this.pointLabels.length/2,u=e/2,y=r<u||r>s-u,p=r===u||r===s-u;i.textAlign=r===0?"center":r===e?"center":r<e?"left":"right";i.textBaseline=p?"middle":y?"bottom":"top";i.fillText(this.pointLabels[r]?this.pointLabels[r]:"",o.x,o.y)}}});n.scaleService.registerScaleType("radialLinear",r,i)}},{}],42:[function(n,t){"use strict";var i=n("moment");i=typeof i=="function"?i:window.moment;t.exports=function(n){var t=n.helpers,r={units:[{name:"millisecond",steps:[1,2,5,10,20,50,100,250,500]},{name:"second",steps:[1,2,5,10,30]},{name:"minute",steps:[1,2,5,10,30]},{name:"hour",steps:[1,2,3,6,12]},{name:"day",steps:[1,2,5]},{name:"week",maxStep:4},{name:"month",maxStep:3},{name:"quarter",maxStep:4},{name:"year",maxStep:!1}]},u=n.Scale.extend({initialize:function(){if(!i)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");n.Scale.prototype.initialize.call(this)},getLabelMoment:function(n,t){return this.labelMoments[n][t]},determineDataLimits:function(){this.labelMoments=[];var n=[];this.chart.data.labels&&this.chart.data.labels.length>0?(t.each(this.chart.data.labels,function(t){var i=this.parseTime(t);i.isValid()&&(this.options.time.round&&i.startOf(this.options.time.round),n.push(i))},this),this.firstTick=i.min.call(this,n),this.lastTick=i.max.call(this,n)):(this.firstTick=null,this.lastTick=null);t.each(this.chart.data.datasets,function(r,u){var f=[],e=this.chart.isDatasetVisible(u);typeof r.data[0]=="object"?t.each(r.data,function(n){var t=this.parseTime(this.getRightValue(n));t.isValid()&&(this.options.time.round&&t.startOf(this.options.time.round),f.push(t),e&&(this.firstTick=this.firstTick!==null?i.min(this.firstTick,t):t,this.lastTick=this.lastTick!==null?i.max(this.lastTick,t):t))},this):f=n;this.labelMoments.push(f)},this);this.options.time.min&&(this.firstTick=this.parseTime(this.options.time.min));this.options.time.max&&(this.lastTick=this.parseTime(this.options.time.max));this.firstTick=(this.firstTick||i()).clone();this.lastTick=(this.lastTick||i()).clone()},buildTicks:function(){var u,f,i,e,a,v,h,y,o,c,p;this.ctx.save();var l=t.getValueOrDefault(this.options.ticks.fontSize,n.defaults.global.defaultFontSize),w=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaults.global.defaultFontStyle),b=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaults.global.defaultFontFamily),k=t.fontString(l,w,b);if(this.ctx.font=k,this.ticks=[],this.unitScale=1,this.scaleSizeInUnits=0,this.options.time.unit)this.tickUnit=this.options.time.unit||"day",this.displayFormat=this.options.time.displayFormats[this.tickUnit],this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0),this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,1);else{var d=this.isHorizontal()?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),g=this.tickFormatFunction(this.firstTick,0,[]),s=this.ctx.measureText(g).width,nt=Math.cos(t.toRadians(this.options.ticks.maxRotation)),tt=Math.sin(t.toRadians(this.options.ticks.maxRotation));for(s=s*nt+l*tt,u=d/s,this.tickUnit="millisecond",this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0),this.displayFormat=this.options.time.displayFormats[this.tickUnit],f=0,i=r.units[f];f<r.units.length;)if(this.unitScale=1,t.isArray(i.steps)&&Math.ceil(this.scaleSizeInUnits/u)<t.max(i.steps)){for(e=0;e<i.steps.length;++e)if(i.steps[e]>=Math.ceil(this.scaleSizeInUnits/u)){this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,i.steps[e]);break}break}else if(i.maxStep===!1||Math.ceil(this.scaleSizeInUnits/u)<i.maxStep){this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,Math.ceil(this.scaleSizeInUnits/u));break}else++f,i=r.units[f],this.tickUnit=i.name,a=this.firstTick.diff(this.firstTick.clone().startOf(this.tickUnit),this.tickUnit,!0),v=this.lastTick.clone().add(1,this.tickUnit).startOf(this.tickUnit).diff(this.lastTick,this.tickUnit,!0),this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0)+a+v,this.displayFormat=this.options.time.displayFormats[i.name]}for(this.options.time.min?h=this.firstTick.clone().startOf(this.tickUnit):(this.firstTick.startOf(this.tickUnit),h=this.firstTick),this.options.time.max||(y=this.lastTick.clone().startOf(this.tickUnit),y.diff(this.lastTick,this.tickUnit,!0)!==0&&this.lastTick.add(1,this.tickUnit).startOf(this.tickUnit)),this.smallestLabelSeparation=this.width,t.each(this.chart.data.datasets,function(n,t){for(var i=1;i<this.labelMoments[t].length;i++)this.smallestLabelSeparation=Math.min(this.smallestLabelSeparation,this.labelMoments[t][i].diff(this.labelMoments[t][i-1],this.tickUnit,!0))},this),this.options.time.displayFormat&&(this.displayFormat=this.options.time.displayFormat),this.ticks.push(this.firstTick.clone()),o=1;o<=this.scaleSizeInUnits;++o){if(c=h.clone().add(o,this.tickUnit),this.options.time.max&&c.diff(this.lastTick,this.tickUnit,!0)>=0)break;o%this.unitScale==0&&this.ticks.push(c)}p=this.ticks[this.ticks.length-1].diff(this.lastTick,this.tickUnit);(p!==0||this.scaleSizeInUnits===0)&&(this.options.time.max?(this.ticks.push(this.lastTick.clone()),this.scaleSizeInUnits=this.lastTick.diff(this.ticks[0],this.tickUnit,!0)):(this.ticks.push(this.lastTick.clone()),this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0)));this.ctx.restore()},getLabelForIndex:function(n,t){var i=this.chart.data.labels&&n<this.chart.data.labels.length?this.chart.data.labels[n]:"";return typeof this.chart.data.datasets[t].data[0]=="object"&&(i=this.getRightValue(this.chart.data.datasets[t].data[n])),this.options.time.tooltipFormat&&(i=this.parseTime(i).format(this.options.time.tooltipFormat)),i},tickFormatFunction:function(n,t,i){var r=n.format(this.displayFormat);return this.options.ticks.userCallback?this.options.ticks.userCallback(r,t,i):r},convertTicksToLabels:function(){this.tickMoments=this.ticks;this.ticks=this.ticks.map(this.tickFormatFunction,this)},getPixelForValue:function(n,t,i){var u=n&&n.isValid&&n.isValid()?n:this.getLabelMoment(i,t),f,r;if(u){if(f=u.diff(this.firstTick,this.tickUnit,!0),r=f/this.scaleSizeInUnits,this.isHorizontal()){var e=this.width-(this.paddingLeft+this.paddingRight),c=e/Math.max(this.ticks.length-1,1),s=e*r+this.paddingLeft;return this.left+Math.round(s)}var o=this.height-(this.paddingTop+this.paddingBottom),l=o/Math.max(this.ticks.length-1,1),h=o*r+this.paddingTop;return this.top+Math.round(h)}},getPixelForTick:function(n,t){return this.getPixelForValue(this.tickMoments[n],null,null,t)},getValueForPixel:function(n){var r=this.isHorizontal()?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),t=(n-(this.isHorizontal()?this.left+this.paddingLeft:this.top+this.paddingTop))/r;return t*=this.scaleSizeInUnits,this.firstTick.clone().add(i.duration(t,this.tickUnit).asSeconds(),"seconds")},parseTime:function(n){return typeof this.options.time.parser=="string"?i(n,this.options.time.parser):typeof this.options.time.parser=="function"?this.options.time.parser(n):typeof n.getMonth=="function"||typeof n=="number"?i(n):n.isValid&&n.isValid()?n:typeof this.options.time.format!="string"&&this.options.time.format.call?(console.warn("options.time.format is deprecated and replaced by options.time.parser. See http://nnnick.github.io/Chart.js/docs-v2/#scales-time-scale"),this.options.time.format(n)):i(n,this.options.time.format)}});n.scaleService.registerScaleType("time",u,{position:"bottom",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm:ss a",hour:"MMM D, hA",day:"ll",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1}})}},{moment:6}]},{},[7]),function(){"use strict";function st(n){return n.valueOf()/a-.5+b}function e(n){return new Date((n+.5-b)*a)}function o(n){return st(n)-k}function d(i,r){return u(n(i)*t(s)-l(r)*n(s),t(i))}function v(i,r){return p(n(r)*t(s)+t(r)*n(s)*n(i))}function g(i,r,f){return u(n(i),t(i)*n(r)-l(f)*t(r))}function nt(i,r,u){return p(n(r)*n(u)+t(r)*t(u)*t(i))}function tt(n,t){return i*(280.16+360.9856235*n)-t}function ht(n){return n<0&&(n=0),.0002967/Math.tan(n+.00312536/(n+.08901179))}function it(n){return i*(357.5291+.98560028*n)}function rt(t){var r=i*(1.9148*n(t)+.02*n(2*t)+.0003*n(3*t)),u=i*102.9372;return t+r+u+f}function ut(n){var i=it(n),t=rt(i);return{dec:v(t,0),ra:d(t,0)}}function ct(n,t){return Math.round(n-y-t/(2*f))}function ft(n,t,i){return y+(n+t)/(2*f)+i}function et(t,i,r){return k+t+.0053*n(i)-.0069*n(2*r)}function lt(i,r,u){return w((n(i)-n(r)*n(u))/(t(r)*t(u)))}function at(n,t,i,r,u,f,e){var o=lt(n,i,r),s=ft(o,t,u);return et(s,f,e)}function ot(r){var o=i*(218.316+13.176396*r),u=i*(134.963+13.064993*r),s=i*(93.272+13.22935*r),f=o+i*6.289*n(u),e=i*5.128*n(s),h=385001-20905*t(u);return{ra:d(f,e),dec:v(f,e),dist:h}}function c(n,t){return new Date(n.valueOf()+t*a/24)}var f=Math.PI,n=Math.sin,t=Math.cos,l=Math.tan,p=Math.asin,u=Math.atan2,w=Math.acos,i=f/180,a=864e5,b=2440588,k=2451545,s=i*23.4397,r={},h,y;r.getPosition=function(n,t,r){var h=i*-r,f=i*t,e=o(n),u=ut(e),s=tt(e,h)-u.ra;return{azimuth:g(s,f,u.dec),altitude:nt(s,f,u.dec)}};h=r.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];r.addTime=function(n,t,i){h.push([n,t,i])};y=.0009;r.getTimes=function(n,t,r){for(var c=i*-r,g=i*t,nt=o(n),w=ct(nt,c),b=ft(0,c,w),l=it(b),a=rt(l),tt=v(a,0),u=et(b,l,a),s,y,d,p={solarNoon:e(u),nadir:e(u-.5)},f=0,k=h.length;f<k;f+=1)s=h[f],y=at(s[0]*i,c,g,tt,w,l,a),d=u-(y-u),p[s[1]]=e(d),p[s[2]]=e(y);return p};r.getMoonPosition=function(r,f,e){var y=i*-e,a=i*f,v=o(r),s=ot(v),h=tt(v,y)-s.ra,c=nt(h,a,s.dec),p=u(n(h),l(a)*t(s.dec)-n(s.dec)*t(h));return c=c+ht(c),{azimuth:g(h,a,s.dec),altitude:c,distance:s.dist,parallacticAngle:p}};r.getMoonIllumination=function(i){var e=o(i),r=ut(e),f=ot(e),s=149598e3,h=w(n(r.dec)*n(f.dec)+t(r.dec)*t(f.dec)*t(r.ra-f.ra)),c=u(s*n(h),f.dist-s*t(h)),l=u(t(r.dec)*n(r.ra-f.ra),n(r.dec)*t(f.dec)-t(r.dec)*n(f.dec)*t(r.ra-f.ra));return{fraction:(1+t(c))/2,phase:.5+.5*c*(l<0?-1:1)/Math.PI,angle:l}};r.getMoonTimes=function(n,t,u,f){var s=new Date(n),d,a,g,nt,h,l,v,y,p,tt,it,w,o,b,rt,e,k;for(f?s.setUTCHours(0,0,0,0):s.setHours(0,0,0,0),d=.133*i,a=r.getMoonPosition(s,t,u).altitude-d,e=1;e<=24;e+=2){if(g=r.getMoonPosition(c(s,e),t,u).altitude-d,nt=r.getMoonPosition(c(s,e+1),t,u).altitude-d,v=(a+nt)/2-g,y=(nt-a)/2,p=-y/(2*v),tt=(v*p+y)*p+g,it=y*y-4*v*g,w=0,it>=0&&(rt=Math.sqrt(it)/(Math.abs(v)*2),o=p-rt,b=p+rt,Math.abs(o)<=1&&w++,Math.abs(b)<=1&&w++,o<-1&&(o=b)),w===1?a<0?h=e+o:l=e+o:w===2&&(h=e+(tt<0?b:o),l=e+(tt<0?o:b)),h&&l)break;a=nt}return k={},h&&(k.rise=c(s,h)),l&&(k.set=c(s,l)),h||l||(k[tt>0?"alwaysUp":"alwaysDown"]=!0),k};typeof define=="function"&&define.amd?define(r):typeof module!="undefined"?module.exports=r:window.SunCalc=r}();
/*! JSON Editor v0.6.14 - JSON Schema -> HTML Editor
 * By Jeremy Dorn - https://github.com/jdorn/json-editor/
 * Released under the MIT license
 *
 * Date: 2014-06-11
 */
(function(){var u;(function(){var n=!1,t=/xyz/.test(function(){postMessage("xyz")})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(i){function u(){!n&&this.init&&this.init.apply(this,arguments)}var e=this.prototype,f,r;n=!0;f=new this;n=!1;for(r in i)f[r]=typeof i[r]=="function"&&typeof e[r]=="function"&&t.test(i[r])?function(n,t){return function(){var r=this._super,i;return this._super=e[n],i=t.apply(this,arguments),this._super=r,i}}(r,i[r]):i[r];return u.prototype=f,u.prototype.constructor=u,u.extend=arguments.callee,u}})(),function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=window.Event.prototype;window.CustomEvent=n}(),function(){for(var i=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();var f=function(n){if(n.constructor&&!n.hasOwnProperty("constructor")&&!n.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1;for(var t in n);return t===undefined||n.hasOwnProperty(t)},i=function(n){for(var r,t,u=1;u<arguments.length;u++){r=arguments[u];for(t in r)r[t]&&f(r[t])?(n[t]=n[t]||{},i(n[t],r[t])):n[t]=r[t]}return n},t=function(n,t){if(n){var i;if(typeof n.length!="undefined"){for(i=0;i<n.length;i++)if(t(i,n[i])===!1)return}else for(i in n)if(n.hasOwnProperty(i)&&t(i,n[i])===!1)return}},r=function(n,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!0);n.dispatchEvent(i)},e=function(n,t){var i=new CustomEvent(t,{bubbles:!0,cancelable:!0});n.dispatchEvent(i)},n=function(t,r){r=i({},n.defaults.options,r||{});this.element=t;this.options=r;this.init()};n.prototype={init:function(){var t=this,i,r;if(this.ready=!1,i=n.defaults.themes[this.options.theme||n.defaults.theme],!i)throw"Unknown theme "+(this.options.theme||n.defaults.theme);this.schema=this.options.schema;this.theme=new i;this.template=this.options.template;this.uuid=0;this.__data={};r=n.defaults.iconlibs[this.options.iconlib||n.defaults.iconlib];r&&(this.iconlib=new r);this.root_container=this.theme.getContainer();this.element.appendChild(this.root_container);this.validator=new n.Validator(this.schema,{ajax:this.options.ajax,refs:this.options.refs,no_additional_properties:this.options.no_additional_properties,required_by_default:this.options.required_by_default});this.validator.ready(function(n){if(!t.ready){t.schema=n;var i=t.getEditorClass(t.schema);t.root=t.createEditor(i,{jsoneditor:t,schema:t.schema,container:t.root_container,required:!0});t.options.startval&&t.root.setValue(t.options.startval);t.validation_results=t.validator.validate(t.root.getValue());t.root.showValidationErrors(t.validation_results);t.ready=!0;requestAnimationFrame(function(){t.validation_results=t.validator.validate(t.root.getValue());t.root.showValidationErrors(t.validation_results);t.trigger("ready");t.trigger("change")})}})},getValue:function(){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before getting the value";return this.root.getValue()},setValue:function(n){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before setting the value";return this.root.setValue(n),this},validate:function(n){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before validating";return arguments.length===1?this.validator.validate(n):this.validation_results},destroy:function(){this.destroyed||this.ready&&(this.schema=null,this.options=null,this.root.destroy(),this.root=null,this.root_container=null,this.validator=null,this.validation_results=null,this.theme=null,this.iconlib=null,this.template=null,this.__data=null,this.ready=!1,this.element.innerHTML="",this.destroyed=!0)},on:function(n,t){this.callbacks=this.callbacks||{};this.callbacks[n]=this.callbacks[n]||[];this.callbacks[n].push(t)},off:function(n,t){var r,i;if(n&&t){for(this.callbacks=this.callbacks||{},this.callbacks[n]=this.callbacks[n]||[],r=[],i=0;i<this.callbacks[n].length;i++)this.callbacks[n][i]!==t&&r.push(this.callbacks[n][i]);this.callbacks[n]=r}else n?(this.callbacks=this.callbacks||{},this.callbacks[n]=[]):this.callbacks={}},trigger:function(n){if(this.callbacks&&this.callbacks[n]&&this.callbacks[n].length)for(var t=0;t<this.callbacks[n].length;t++)this.callbacks[n][t]()},getEditorClass:function(i){var r;if(t(n.defaults.resolvers,function(t,u){var f=u(i);if(f&&n.defaults.editors[f])return r=f,!1}),!r)throw"Unknown editor for schema "+JSON.stringify(i);if(!n.defaults.editors[r])throw"Unknown editor "+r;return n.defaults.editors[r]},createEditor:function(n,t){return t=i({},n.options||{},t),new n(t)},onChange:function(){if(this.ready&&!this.firing_change){this.firing_change=!0;var n=this;requestAnimationFrame(function(){n.firing_change=!1;n.validation_results=n.validator.validate(n.root.getValue());n.root.showValidationErrors(n.validation_results);n.trigger("change")})}},compileTemplate:function(t,i){i=i||n.defaults.template;var r;if(typeof i=="string"){if(!n.defaults.templates[i])throw"Unknown template engine "+i;if(r=n.defaults.templates[i](),!r)throw"Template engine "+i+" missing required library.";}else r=i;if(!r)throw"No template engine set";if(!r.compile)throw"Invalid template engine set";return r.compile(t)},_data:function(n,t,i){if(arguments.length===3){var r;n.hasAttribute("data-jsoneditor-"+t)?r=n.getAttribute("data-jsoneditor-"+t):(r=this.uuid++,n.setAttribute("data-jsoneditor-"+t,r));this.__data[r]=i}else return n.hasAttribute("data-jsoneditor-"+t)?this.__data[n.getAttribute("data-jsoneditor-"+t)]:null},registerEditor:function(n){return this.editors=this.editors||{},this.editors[n.path]=n,this},unregisterEditor:function(n){return this.editors=this.editors||{},this.editors[n.path]=null,this},getEditor:function(n){if(this.editors)return this.editors[n]},watch:function(n,t){return this.watchlist=this.watchlist||{},this.watchlist[n]=this.watchlist[n]||[],this.watchlist[n].push(t),this},unwatch:function(n,t){var r,i;if(!this.watchlist||!this.watchlist[n])return this;if(!t)return this.watchlist[n]=null,this;for(r=[],i=0;i<this.watchlist[n].length;i++)if(this.watchlist[n][i]===t)continue;else r.push(this.watchlist[n][i]);return this.watchlist[n]=r.length?r:null,this},notifyWatchers:function(n){if(!this.watchlist||!this.watchlist[n])return this;for(var t=0;t<this.watchlist[n].length;t++)this.watchlist[n][t]()},isEnabled:function(){return!this.root||this.root.isEnabled()},enable:function(){this.root.enable()},disable:function(){this.root.disable()}};n.defaults={themes:{},templates:{},iconlibs:{},editors:{},resolvers:[],custom_validators:[]};n.Validator=Class.extend({init:function(n,t){this.original_schema=n;this.options=t||{};this.refs=this.options.refs||{};this.ready_callbacks=[];this.options.ready&&this.ready(this.options.ready);this.getRefs()},ready:function(n){return this.is_ready?n.apply(this,[this.expanded]):this.ready_callbacks.push(n),this},getRefs:function(){var n=this;this._getRefs(this.original_schema,function(i){n.schema=i;n.expanded=n.expandSchema(n.schema);n.is_ready=!0;t(n.ready_callbacks,function(t,i){i.apply(n,[n.expanded])})})},_getRefs:function(n,r){var u=this,a=n===this.original_schema,e,o,s,c,l,f,h;if(n=i({},n),a&&n.definitions)l=n.definitions,delete n.definitions,e=o=0,s=function(n){if(o>=e){if(c)return;c=!0;u._getRefs(n,r)}},t(l,function(){e++}),e?t(l,function(t,i){u._getRefs(i,function(i){u.refs["#/definitions/"+t]=i;o++;s(n)})}):s(n);else if(n.$ref)if(f=n.$ref,delete n.$ref,u.refs[f]&&u.refs[f]instanceof Array)u.refs[f].push(function(){n=i({},u.refs[f],n);r(n)});else if(u.refs[f])n=i({},u.refs[f],n),r(n);else{if(!u.options.ajax)throw"Must set ajax option to true to load external url "+f;h=new XMLHttpRequest;h.open("GET",f,!0);h.onreadystatechange=function(){if(h.readyState==4){if(h.status===200){var e=JSON.parse(h.responseText);u.refs[f]=[];u._getRefs(e,function(e){var o=u.refs[f];u.refs[f]=e;n=i({},u.refs[f],n);r(n);t(o,function(n,t){t()})});return}throw"Failed to fetch ref via ajax- "+f;}};h.send()}else e=o=0,s=function(n){if(o>=e){if(c)return;c=!0;r(n)}},t(n,function(n,i){typeof i=="object"&&i&&i instanceof Array?t(i,function(n,t){typeof t!="object"||!t||t instanceof Array||e++}):typeof i=="object"&&i&&e++}),e?t(n,function(i,r){typeof r=="object"&&r&&r instanceof Array?t(r,function(t,r){typeof r!="object"||!r||r instanceof Array||u._getRefs(r,function(r){n[i][t]=r;o++;s(n)})}):typeof r=="object"&&r&&u._getRefs(r,function(t){n[i]=t;o++;s(n)})}):s(n)},validate:function(n){return this._validateSchema(this.schema,n)},_validateSchema:function(r,u,f){var o=[],s,e,h,p=JSON.stringify(u),l,c,v,a,y;if(f=f||"root",r=i({},r),r.required&&r.required===!0){if(typeof u=="undefined")return o.push({path:f,property:"required",message:"Property must be set"}),o}else if(typeof u=="undefined")if(this.options.required_by_default)o.push({path:f,property:"required",message:"Property must be set"});else return o;if(r.enum){for(s=!1,e=0;e<r.enum.length;e++)p===JSON.stringify(r.enum[e])&&(s=!0);s||o.push({path:f,property:"enum",message:"Value must be one of the enumerated values"})}if(r.extends)for(e=0;e<r.extends.length;e++)o=o.concat(this._validateSchema(r.extends[e],u,f));if(r.allOf)for(e=0;e<r.allOf.length;e++)o=o.concat(this._validateSchema(r.allOf[e],u,f));if(r.anyOf){for(s=!1,e=0;e<r.anyOf.length;e++)if(!this._validateSchema(r.anyOf[e],u,f).length){s=!0;break}s||o.push({path:f,property:"anyOf",message:"Value must validate against at least one of the provided schemas"})}if(r.oneOf){for(s=0,l=[],e=0;e<r.oneOf.length;e++){for(c=this._validateSchema(r.oneOf[e],u,f),c.length||s++,h=0;h<c.length;h++)c[h].path=f+".oneOf["+e+"]"+c[h].path.substr(f.length);l=l.concat(c)}s!==1&&(o.push({path:f,property:"oneOf",message:"Value must validate against exactly one of the provided schemas. It currently validates against "+s+" of the schemas."}),o=o.concat(l))}if(r.not&&(this._validateSchema(r.not,u,f).length||o.push({path:f,property:"not",message:"Value must not validate against the provided schema"})),r.type)if(r.type instanceof Array){for(s=!1,e=0;e<r.type.length;e++)if(this._checkType(r.type[e],u)){s=!0;break}s||o.push({path:f,property:"type",message:"Value must be one of the provided types"})}else this._checkType(r.type,u)||o.push({path:f,property:"type",message:"Value must be of type "+r.type});if(r.disallow)if(r.disallow instanceof Array){for(s=!0,e=0;e<r.disallow.length;e++)if(this._checkType(r.disallow[e],u)){s=!1;break}s||o.push({path:f,property:"disallow",message:"Value must not be one of the provided disallowed types"})}else this._checkType(r.disallow,u)&&o.push({path:f,property:"disallow",message:"Value must not be of type "+r.disallow});if(typeof u=="number")(r.multipleOf||r.divisibleBy)&&(s=u/(r.multipleOf||r.divisibleBy),s!==Math.floor(s)&&o.push({path:f,property:r.multipleOf?"multipleOf":"divisibleBy",message:"Value must be a multiple of "+(r.multipleOf||r.divisibleBy)})),r.maximum&&(r.exclusiveMaximum&&u>=r.maximum?o.push({path:f,property:"maximum",message:"Value must be less than "+r.maximum}):!r.exclusiveMaximum&&u>r.maximum&&o.push({path:f,property:"maximum",message:"Value must be at most "+r.maximum})),r.minimum&&(r.exclusiveMinimum&&u<=r.minimum?o.push({path:f,property:"minimum",message:"Value must be greater than "+r.minimum}):!r.exclusiveMinimum&&u<r.minimum&&o.push({path:f,property:"minimum",message:"Value must be at least "+r.minimum}));else if(typeof u=="string")r.maxLength&&(u+"").length>r.maxLength&&o.push({path:f,property:"maxLength",message:"Value must be at most "+r.maxLength+" characters long"}),r.minLength&&(u+"").length<r.minLength&&o.push({path:f,property:"minLength",message:"Value must be at least "+r.minLength+" characters long"}),r.pattern&&(new RegExp(r.pattern).test(u)||o.push({path:f,property:"pattern",message:"Value must match the provided pattern"}));else if(typeof u=="object"&&u!==null&&u instanceof Array){if(r.items)if(r.items instanceof Array)for(e=0;e<u.length;e++)if(r.items[e])o=o.concat(this._validateSchema(r.items[e],u[e],f+"."+e));else if(r.additionalItems===!0)break;else if(r.additionalItems)o=o.concat(this._validateSchema(r.additionalItems,u[e],f+"."+e));else if(r.additionalItems===!1){o.push({path:f,property:"additionalItems",message:"No additional items allowed in this array"});break}else break;else for(e=0;e<u.length;e++)o=o.concat(this._validateSchema(r.items,u[e],f+"."+e));if(r.maxItems&&u.length>r.maxItems&&o.push({path:f,property:"maxItems",message:"Value must have at most "+r.maxItems+" items"}),r.minItems&&u.length<r.minItems&&o.push({path:f,property:"minItems",message:"Value must have at least "+r.minItems+" items"}),r.uniqueItems)for(v={},e=0;e<u.length;e++){if(s=JSON.stringify(u[e]),v[s]){o.push({path:f,property:"uniqueItems",message:"Array must have unique items"});break}v[s]=!0}}else if(typeof u=="object"&&u!==null){if(r.maxProperties){s=0;for(e in u)u.hasOwnProperty(e)&&s++;s>r.maxProperties&&o.push({path:f,property:"maxProperties",message:"Object must have at most "+r.maxProperties+" properties"})}if(r.minProperties){s=0;for(e in u)u.hasOwnProperty(e)&&s++;s<r.minProperties&&o.push({path:f,property:"minProperties",message:"Object must have at least "+r.minProperties+" properties"})}if(r.required&&r.required instanceof Array)for(e=0;e<r.required.length;e++)typeof u[r.required[e]]=="undefined"&&o.push({path:f,property:"required",message:"Object is missing the required property "+r.required[e]});if(a={},r.properties)for(e in r.properties)r.properties.hasOwnProperty(e)&&(a[e]=!0,o=o.concat(this._validateSchema(r.properties[e],u[e],f+"."+e)));if(r.patternProperties)for(e in r.patternProperties)if(r.patternProperties.hasOwnProperty(e)){y=new RegExp(e);for(h in u)u.hasOwnProperty(h)&&y.test(h)&&(a[h]=!0,o=o.concat(this._validateSchema(r.patternProperties[e],u[h],f+"."+h)))}if(typeof r.additionalProperties!="undefined"||!this.options.no_additional_properties||r.oneOf||r.anyOf||(r.additionalProperties=!1),typeof r.additionalProperties!="undefined")for(e in u)if(u.hasOwnProperty(e)&&!a[e])if(r.additionalProperties)if(r.additionalProperties===!0)break;else o=o.concat(this._validateSchema(r.additionalProperties,u[e],f+"."+e));else{o.push({path:f,property:"additionalProperties",message:"No additional properties allowed, but property "+e+" is set"});break}if(r.dependencies)for(e in r.dependencies)if(r.dependencies.hasOwnProperty(e)&&typeof u[e]!="undefined")if(r.dependencies[e]instanceof Array)for(h=0;h<r.dependencies[e].length;h++)typeof u[r.dependencies[e][h]]=="undefined"&&o.push({path:f,property:"dependencies",message:"Must have property "+r.dependencies[e][h]});else o=o.concat(this._validateSchema(r.dependencies[e],u,f))}return t(n.defaults.custom_validators,function(n,t){o=o.concat(t(r,u,f))}),o},_checkType:function(n,t){return typeof n=="string"?n==="string"?typeof t=="string":n==="number"?typeof t=="number":n==="integer"?typeof t=="number"&&t===Math.floor(t):n==="boolean"?typeof t=="boolean":n==="array"?t instanceof Array:n==="object"?t!==null&&!(t instanceof Array)&&typeof t=="object":n==="null"?t===null:!0:!this._validateSchema(n,t).length},expandSchema:function(n){var u=this,f=n,r,e;if(typeof n.type=="object"&&(n.type instanceof Array?t(n.type,function(t,i){typeof i=="object"&&(n.type[t]=u.expandSchema(i))}):n.type=u.expandSchema(n.type)),typeof n.disallow=="object"&&(n.disallow instanceof Array?t(n.disallow,function(t,i){typeof i=="object"&&(n.disallow[t]=u.expandSchema(i))}):n.disallow=u.expandSchema(n.disallow)),n.anyOf&&t(n.anyOf,function(t,i){n.anyOf[t]=u.expandSchema(i)}),n.dependencies&&t(n.dependencies,function(t,i){typeof i!="object"||i instanceof Array||(n.dependencies[t]=u.expandSchema(i))}),n.items&&(n.items instanceof Array?t(n.items,function(t,i){typeof i=="object"&&(n.items[t]=u.expandSchema(i))}):n.items=u.expandSchema(n.items)),n.properties&&t(n.properties,function(t,i){typeof i!="object"||i instanceof Array||(n.properties[t]=u.expandSchema(i))}),n.patternProperties&&t(n.patternProperties,function(t,i){typeof i!="object"||i instanceof Array||(n.patternProperties[t]=u.expandSchema(i))}),n.not&&(n.not=this.expandSchema(n.not)),n.additionalProperties&&typeof n.additionalProperties=="object"&&(n.additionalProperties=u.expandSchema(n.additionalProperties)),n.additionalItems&&typeof n.additionalItems=="object"&&(n.additionalItems=u.expandSchema(n.additionalItems)),n.allOf){for(r=0;r<n.allOf.length;r++)f=this.extend(f,this.expandSchema(n.allOf[r]));delete f.allOf}if(n.extends){if(n.extends instanceof Array)for(r=0;r<n.extends.length;r++)f=this.extend(f,this.expandSchema(n.extends[r]));else f=this.extend(f,this.expandSchema(n.extends));delete f.extends}if(n.oneOf)for(e=i({},f),delete e.oneOf,r=0;r<n.oneOf.length;r++)f.oneOf[r]=this.extend(this.expandSchema(n.oneOf[r]),e);return f},extend:function(n,r){n=i({},n);r=i({},r);var f=this,u={};return t(n,function(n,t){typeof r[n]!="undefined"?n==="required"&&typeof t=="object"&&t instanceof Array?u.required=t.concat(r[n]).reduce(function(n,t){return n.indexOf(t)<0&&n.push(t),n},[]):n==="type"?(typeof t!="object"&&(t=[t]),typeof r.type!="object"&&(r.type=[r.type]),u.type=t.filter(function(n){return r.type.indexOf(n)!==-1}),u.type.length===1&&typeof u.type[0]=="string"&&(u.type=u.type[0])):u[n]=typeof t=="object"&&t instanceof Array?t.filter(function(t){return r[n].indexOf(t)!==-1}):typeof t=="object"&&t!==null?f.extend(t,r[n]):t:u[n]=t}),t(r,function(t,i){typeof n[t]=="undefined"&&(u[t]=i)}),u}});n.AbstractEditor=Class.extend({fireChangeHeaderEvent:function(){e(this.container,"change_header_text")},onChildEditorChange:function(){if(this.watch_listener)if(this.watch_listener(),this.jsoneditor.notifyWatchers(this.path),this.parent)this.parent.onChildEditorChange(this);else this.jsoneditor.onChange()},register:function(){this.jsoneditor.registerEditor(this)},unregister:function(){this.jsoneditor&&this.jsoneditor.unregisterEditor(this)},getNumColumns:function(){return 12},init:function(n){var t=this,u,r,f,s,h,e,o;if(this.container=n.container,this.jsoneditor=n.jsoneditor,this.theme=this.jsoneditor.theme,this.template_engine=this.jsoneditor.template,this.iconlib=this.jsoneditor.iconlib,this.options=i({},this.options||{},n.schema.options||{},n),this.schema=this.options.schema,n.path||this.schema.id||(this.schema.id="root"),this.path=n.path||"root",this.formname=n.formname||this.path.replace(/\.([^.]+)/g,"[$1]"),this.jsoneditor.options.form_name_root&&(this.formname=this.formname.replace(/^root\[/,this.jsoneditor.options.form_name_root+"[")),this.schema.id&&this.container.setAttribute("data-schemaid",this.schema.id),this.schema.type&&typeof this.schema.type=="string"&&this.container.setAttribute("data-schematype",this.schema.type),this.container.setAttribute("data-schemapath",this.path),this.jsoneditor._data(this.container,"editor",this),this.key=this.path.split(".").pop(),this.parent=n.parent,this.link_watchers=[],this.register(),this.isRequired()||this.options.compact||!0||(this.title_links=this.theme.getFloatRightLinkHolder(),this.container.appendChild(this.title_links),this.addremove=this.theme.getLink("remove "+this.getTitle()),this.title_links.appendChild(this.addremove),this.addremove.addEventListener("click",function(n){if(n.preventDefault(),n.stopPropagation(),!t.disabled)if(t.property_removed?t.addProperty():t.removeProperty(),t.parent)t.parent.onChildEditorChange(t);else t.jsoneditor.onChange()})),this.watched={},this.schema.vars&&(this.schema.watch=this.schema.vars),this.watched_values={},this.watch_listener=function(){t.refreshWatchedFieldValues()&&t.onWatchedFieldChange()},this.schema.watch)for(e in this.schema.watch)if(this.schema.watch.hasOwnProperty(e)){if(u=this.schema.watch[e],u instanceof Array?r=[u[0]].concat(u[1].split(".")):(r=u.split("."),t.theme.closest(t.container,'[data-schemaid="'+r[0]+'"]')||r.unshift("#")),f=r.shift(),f==="#"&&(f=t.jsoneditor.schema.id||"root"),s=t.theme.closest(t.container,'[data-schemaid="'+f+'"]'),!s)throw"Could not find ancestor node with id "+f;h=s.getAttribute("data-schemapath")+"."+r.join(".");t.jsoneditor.watch(h,t.watch_listener);t.watched[e]=h}if(this.schema.headerTemplate&&(this.header_template=this.jsoneditor.compileTemplate(this.schema.headerTemplate,this.template_engine)),this.build(),!this.no_link_holder&&(this.link_holder=this.theme.getLinksHolder(),this.container.appendChild(this.link_holder),this.schema.links))for(o=0;o<this.schema.links.length;o++)this.addLink(this.getLink(this.schema.links[o]));this.setValue(this.getDefault(),!0);this.updateHeaderText();this.watch_listener()},getButton:function(n,t,i){var u="json-editor-btn-"+t,r;return t=this.iconlib?this.iconlib.getIcon(t):null,!t&&i&&(n=i,i=null),r=this.theme.getButton(n,t,i),r.className+=" "+u+" ",r},setButtonText:function(n,t,i,r){return i=this.iconlib?this.iconlib.getIcon(i):null,!i&&r&&(t=r,r=null),this.theme.setButtonText(n,t,i,r)},addLink:function(n){this.link_holder&&this.link_holder.appendChild(n)},getLink:function(n){var t,i,o=n.mediaType||"application/javascript",u=o.split("/")[0],f=this.jsoneditor.compileTemplate(n.href,this.template_engine),e,r;return u==="image"?(t=this.theme.getBlockLinkHolder(),i=document.createElement("a"),i.setAttribute("target","_blank"),e=document.createElement("img"),this.theme.createImageLink(t,i,e),this.link_watchers.push(function(t){var r=f(t);i.setAttribute("href",r);i.setAttribute("title",n.rel||r);e.setAttribute("src",r)})):["audio","video"].indexOf(u)>=0?(t=this.theme.getBlockLinkHolder(),i=this.theme.getBlockLink(),i.setAttribute("target","_blank"),r=document.createElement(u),r.setAttribute("controls","controls"),this.theme.createMediaLink(t,i,r),this.link_watchers.push(function(t){var u=f(t);i.setAttribute("href",u);i.textContent=n.rel||u;r.setAttribute("src",u)})):(t=this.theme.getBlockLink(),t.setAttribute("target","_blank"),t.textContent=n.rel,this.link_watchers.push(function(i){var r=f(i);t.setAttribute("href",r);t.textContent=n.rel||r})),t},refreshWatchedFieldValues:function(){var r,u,n;if(this.watched_values){var t={},i=!1,f=this;if(this.watched)for(n in this.watched)this.watched.hasOwnProperty(n)&&(u=f.jsoneditor.getEditor(this.watched[n]),r=u?u.getValue():null,f.watched_values[n]!==r&&(i=!0),t[n]=r);return t.self=this.getValue(),this.watched_values.self!==t.self&&(i=!0),this.watched_values=t,i}},getWatchedFieldValues:function(){return this.watched_values},updateHeaderText:function(){this.header&&(this.header.textContent=this.getHeaderText())},getHeaderText:function(n){return this.header_text?this.header_text:n?this.schema.title:this.getTitle()},onWatchedFieldChange:function(){var n,r,t;if(this.header_template&&(n=i(this.getWatchedFieldValues(),{key:this.key,i:this.key,title:this.getTitle()}),r=this.header_template(n),r!==this.header_text&&(this.header_text=r,this.updateHeaderText(),this.fireChangeHeaderEvent())),this.link_watchers.length)for(n=this.getWatchedFieldValues(),t=0;t<this.link_watchers.length;t++)this.link_watchers[t](n)},build:function(){},isValid:function(n){n()},setValue:function(n){this.value=n},getValue:function(){return this.value},refreshValue:function(){},getChildEditors:function(){return!1},destroy:function(){var n=this;this.unregister(this);t(this.watched,function(t,i){n.jsoneditor.unwatch(i,n.watch_listener)});this.watched=null;this.watched_values=null;this.watch_listener=null;this.header_text=null;this.header_template=null;this.value=null;this.container.parentNode&&this.container.parentNode.removeChild(this.container);this.container=null;this.jsoneditor=null;this.schema=null;this.path=null;this.key=null;this.parent=null},isRequired:function(){return typeof this.options.required!="undefined"?this.options.required:typeof this.schema.required=="boolean"?this.schema.required:this.jsoneditor.options.required_by_default?!0:!1},getDefault:function(){return this.schema.default||null},getTheme:function(){return this.theme},getSchema:function(){return this.schema},getContainer:function(){return this.container},getTitle:function(){return this.schema.title||this.key},getPath:function(){return this.path},getParent:function(){return this.parent},enable:function(){this.addremove&&(this.addremove.style.opacity="");this.disabled=!1},disable:function(){this.addremove&&(this.addremove.style.opacity=".6");this.disabled=!0},isEnabled:function(){return!this.disabled},getOption:function(n,t){return typeof this.options[n]!="undefined"?this.options[n]:t},getDisplayText:function(n){var u=[],i={},r;return t(n,function(n,t){t.title&&(i[t.title]=i[t.title]||0,i[t.title]++);t.description&&(i[t.description]=i[t.description]||0,i[t.description]++);t.format&&(i[t.format]=i[t.format]||0,i[t.format]++);t.type&&(i[t.type]=i[t.type]||0,i[t.type]++)}),t(n,function(n,t){var r;r=typeof t=="string"?t:t.title&&i[t.title]<=1?t.title:t.format&&i[t.format]<=1?t.format:t.type&&i[t.type]<=1?t.type:t.description&&i[t.description]<=1?t.descripton:t.title?t.title:t.format?t.format:t.type?t.type:t.description?t.description:JSON.stringify(t).length<50?JSON.stringify(t):"type";u.push(r)}),r={},t(u,function(n,t){r[t]=r[t]||0;r[t]++;i[t]>1&&(u[n]=t+" "+r[t])}),u},showValidationErrors:function(){}});n.defaults.editors.null=n.AbstractEditor.extend({getValue:function(){return null},setValue:function(){this.jsoneditor.notifyWatchers(this.path)},getNumColumns:function(){return 2}});n.defaults.editors.string=n.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},register:function(){(this._super(),this.input)&&this.input.setAttribute("name",this.formname)},unregister:function(){(this._super(),this.input)&&this.input.removeAttribute("name")},setValue:function(n,t,i){var u=this,r,f;if((!this.template||i)&&(n=n||"",typeof n=="object"&&(n=JSON.stringify(n)),typeof n!="string"&&(n=""+n),n!==this.serialized)&&(r=this.sanitize(n),this.select_options&&this.select_options.indexOf(r)<0&&(r=this.select_options[0]),this.input.value!==r)){if(this.input.value=r,this.sceditor_instance?this.sceditor_instance.val(r):this.epiceditor?this.epiceditor.importFile(null,r):this.ace_editor&&this.ace_editor.setValue(r),f=i||this.getValue()!==n,this.refreshValue(),f)if(u.parent)u.parent.onChildEditorChange(u);else u.jsoneditor.onChange();this.watch_listener();this.jsoneditor.notifyWatchers(this.path)}},removeProperty:function(){this._super();this.input.style.display="none";this.description&&(this.description.style.display="none");this.theme.disableLabel(this.label)},addProperty:function(){this._super();this.input.style.display="";this.description&&(this.description.style.display="");this.theme.enableLabel(this.label)},getNumColumns:function(){var t=Math.ceil(this.getTitle().length/5),n;return n=this.input_type==="textarea"?6:["text","email"].indexOf(this.input_type)>=0?4:2,Math.min(12,Math.max(t,n))},build:function(){var t=this,n;if(this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.format=this.schema.format,!this.format&&this.schema.media&&this.schema.media.type&&(this.format=this.schema.media.type.replace(/(^(application|text)\/(x-)?(script\.)?)|(-source$)/g,"")),this.schema.enum)this.input_type="select",this.select_options=this.schema.enum,this.input=this.theme.getSelectInput(this.select_options);else if(this.schema.enumSource){if(this.input_type="select",this.input=this.theme.getSelectInput([]),this.enumSource=[],this.schema.enumSource instanceof Array)for(n=0;n<this.schema.enumSource.length;n++)this.enumSource[n]=typeof this.schema.enumSource[n]=="string"?{source:this.schema.enumSource[n]}:this.schema.enumSource[n]instanceof Array?this.schema.enumSource[n]:i({},this.schema.enumSource[n]);else this.enumSource=this.schema.enumValue?[{source:this.schema.enumSource,value:this.schema.enumValue}]:[{source:this.schema.enumSource}];for(n=0;n<this.enumSource.length;n++)this.enumSource[n]&&(this.enumSource[n].value=this.jsoneditor.compileTemplate(this.enumSource[n].value,this.template_engine)),this.enumSource[n].title&&(this.enumSource[n].title=this.jsoneditor.compileTemplate(this.enumSource[n].title,this.template_engine)),this.enumSource[n].fillter&&(this.enumSource[n].filter=this.jsoneditor.compileTemplate(this.enumSource[n].filter,this.template_engine))}else if(this.format)if(this.format==="textarea")this.input_type="textarea",this.input=this.theme.getTextareaInput();else if(this.format==="range"){this.input_type="range";var r=this.schema.minimum||0,u=this.schema.maximum||Math.max(100,r+1),f=1;this.schema.multipleOf&&(r%this.schema.multipleOf&&(r=Math.ceil(r/this.schema.multipleOf)*this.schema.multipleOf),u%this.schema.multipleOf&&(u=Math.floor(u/this.schema.multipleOf)*this.schema.multipleOf),f=this.schema.multipleOf);this.input=this.theme.getRangeInput(r,u,f)}else["actionscript","batchfile","bbcode","c","c++","cpp","coffee","csharp","css","dart","django","ejs","erlang","golang","handlebars","haskell","haxe","html","ini","jade","java","javascript","json","less","lisp","lua","makefile","markdown","matlab","mysql","objectivec","pascal","perl","pgsql","php","python","r","ruby","sass","scala","scss","smarty","sql","stylus","svg","twig","vbscript","xml","yaml"].indexOf(this.format)>=0?(this.input_type=this.format,this.source_code=!0,this.input=this.theme.getTextareaInput()):(this.input_type=this.format,this.input=this.theme.getFormInputField(this.input_type));else this.input_type="text",this.input=this.theme.getFormInputField(this.input_type);typeof this.schema.maxLength!="undefined"&&this.input.setAttribute("maxlength",this.schema.maxLength);typeof this.schema.pattern!="undefined"?this.input.setAttribute("pattern",this.schema.pattern):typeof this.schema.minLength!="undefined"&&this.input.setAttribute("pattern",".{"+this.schema.minLength+",}");this.getOption("compact")&&this.container.setAttribute("class",this.container.getAttribute("class")+" compact");(this.schema.readOnly||this.schema.readonly||this.schema.template)&&(this.always_disabled=!0,this.input.disabled=!0);this.input.addEventListener("change",function(n){if(n.preventDefault(),n.stopPropagation(),t.schema.template){this.value=t.value;return}var i=this.value,r=t.sanitize(i);if(i!==r&&(this.value=r),t.refreshValue(),t.watch_listener(),t.jsoneditor.notifyWatchers(t.path),t.parent)t.parent.onChildEditorChange(t);else t.jsoneditor.onChange()});this.format&&this.input.setAttribute("data-schemaformat",this.format);this.control=this.getTheme().getFormControl(this.label,this.input,this.description);this.container.appendChild(this.control);this.input_type==="select"&&window.$&&$.fn&&$.fn.select2&&$(this.input).select2();requestAnimationFrame(function(){t.afterInputReady()});this.register();this.schema.template?(this.template=this.jsoneditor.compileTemplate(this.schema.template,this.template_engine),this.refreshValue(),this.jsoneditor.notifyWatchers(this.path)):(this.refreshValue(),this.jsoneditor.notifyWatchers(this.path))},enable:function(){this.always_disabled||(this.input.disabled=!1);this._super()},disable:function(){this.input.disabled=!0;this._super()},afterInputReady:function(){var t=this,u,r;if(this.source_code)if(this.options.wysiwyg&&["html","bbcode"].indexOf(this.input_type)>=0&&window.$&&$.fn&&$.fn.sceditor)u=i({},{plugins:t.input_type==="html"?"xhtml":"bbcode",emoticonsEnabled:!1,width:"100%",height:300},n.plugins.sceditor),$(t.input).sceditor(u),t.sceditor_instance=$(t.input).sceditor("instance"),t.sceditor_instance.blur(function(){var n=$("<div>"+t.sceditor_instance.val()+"<\/div>");if($("#sceditor-start-marker,#sceditor-end-marker,.sceditor-nlf",n).remove(),t.input.value=n.html(),t.value=t.input.value,t.parent)t.parent.onChildEditorChange(t);else t.jsoneditor.onChange();t.jsoneditor.notifyWatchers(t.path)});else if(this.input_type==="markdown"&&window.EpicEditor){this.epiceditor_container=document.createElement("div");this.input.parentNode.insertBefore(this.epiceditor_container,this.input);this.input.style.display="none";u=i({},n.plugins.epiceditor,{container:this.epiceditor_container,clientSideStorage:!1});this.epiceditor=new EpicEditor(u).load();this.epiceditor.importFile(null,this.getValue());this.epiceditor.on("update",function(){var n=t.epiceditor.exportFile();if(t.input.value=n,t.value=n,t.parent)t.parent.onChildEditorChange(t);else t.jsoneditor.onChange();t.jsoneditor.notifyWatchers(t.path)})}else if(window.ace){r=this.input_type;(r==="cpp"||r==="c++"||r==="c")&&(r="c_cpp");this.ace_container=document.createElement("div");this.ace_container.style.width="100%";this.ace_container.style.position="relative";this.ace_container.style.height="400px";this.input.parentNode.insertBefore(this.ace_container,this.input);this.input.style.display="none";this.ace_editor=ace.edit(this.ace_container);this.ace_editor.setValue(this.getValue());n.plugins.ace.theme&&this.ace_editor.setTheme("ace/theme/"+n.plugins.ace.theme);r=ace.require("ace/mode/"+r);r&&this.ace_editor.getSession().setMode(new r.Mode);this.ace_editor.on("change",function(){var n=t.ace_editor.getValue();if(t.input.value=n,t.refreshValue(),t.parent)t.parent.onChildEditorChange(t);else t.jsoneditor.onChange();t.jsoneditor.notifyWatchers(t.path)})}t.theme.afterInputReady(t.input)},refreshValue:function(){this.value=this.input.value;typeof this.value!="string"&&(this.value="");this.serialized=this.value},destroy:function(){this.sceditor_instance?this.sceditor_instance.destroy():this.epiceditor?this.epiceditor.unload():this.ace_editor&&this.ace_editor.destroy();this.template=null;this.input.parentNode&&this.input.parentNode.removeChild(this.input);this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label);this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description);this._super()},sanitize:function(n){return n},onWatchedFieldChange:function(){var c=this,f,n,i,u,t,r,o,s,e,h;if(this.template&&(f=this.getWatchedFieldValues(),this.setValue(this.template(f),!1,!0)),this.enumSource){for(f=this.getWatchedFieldValues(),i=[],u=[],t=0;t<this.enumSource.length;t++)if(this.enumSource[t]instanceof Array)i=i.concat(this.enumSource[t]),u=u.concat(this.enumSource[t]);else if(f[this.enumSource[t].source]){if(r=f[this.enumSource[t].source],this.enumSource[t].slice&&(r=Array.prototype.slice.apply(r,this.enumSource[t].slice)),this.enumSource[t].filter){for(o=[],n=0;n<r.length;n++)filter({i:n,item:r[n]})&&o.push(r[n]);r=o}for(s=[],e=[],n=0;n<r.length;n++)h=r[n],e[n]=this.enumSource[t].value?this.enumSource[t].value({i:n,item:h}):r[n],s[n]=this.enumSource[t].title?this.enumSource[t].title({i:n,item:h}):e[n];i=i.concat(e);u=u.concat(s)}if(this.theme.setSelectOptions(this.input,i,u),this.select_options=i,i.indexOf(this.value)!==-1)this.input.value=this.value;else{if(this.input.value=i[0],this.value=i[0]||"",this.parent)this.parent.onChildEditorChange(this);else this.jsoneditor.onChange();this.jsoneditor.notifyWatchers(this.path)}}this._super()},showValidationErrors:function(n){var r=this,i=[];t(n,function(n,t){t.path===r.path&&i.push(t.message)});i.length?this.theme.addInputError(this.input,i.join(". ")+"."):this.theme.removeInputError(this.input)}});n.defaults.editors.number=n.defaults.editors.string.extend({getDefault:function(){return this.schema.default||0},sanitize:function(n){return(n+"").replace(/[^0-9\.\-]/g,"")},getNumColumns:function(){return 2},getValue:function(){return this.value*1}});n.defaults.editors.integer=n.defaults.editors.number.extend({sanitize:function(n){return n=n+"",n.replace(/[^0-9\-]/g,"")},getNumColumns:function(){return 2}});n.defaults.editors.object=n.AbstractEditor.extend({getDefault:function(){return i({},this.schema.default||{})},getChildEditors:function(){return this.editors},register:function(){if(this._super(),this.editors)for(var n in this.editors)this.editors.hasOwnProperty(n)&&this.editors[n].register()},unregister:function(){if(this._super(),this.editors)for(var n in this.editors)this.editors.hasOwnProperty(n)&&this.editors[n].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.maxwidth),3)},enable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!1),this.addproperty_button&&(this.addproperty_button.disabled=!1),this._super(),this.editors)for(var n in this.editors)this.editors.hasOwnProperty(n)&&this.editors[n].enable()},disable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!0),this.addproperty_button&&(this.addproperty_button.disabled=!0),this.hideEditJSON(),this._super(),this.editors)for(var n in this.editors)this.editors.hasOwnProperty(n)&&this.editors[n].disable()},layoutEditors:function(){var h=this,i,r,f,n,u,o,s,e;if(this.row_container){if(this.format==="grid"){for(n=[],t(this.editors,function(t,i){var u;if(!i.property_removed){var r=!1,e=i.options.hidden?0:i.getNumColumns(),f=i.options.hidden?0:i.container.offsetHeight;for(u=0;u<n.length;u++)n[u].width+e<=12&&(!f||n[u].minh*.5<f&&n[u].maxh*2>f)&&(r=u);r===!1&&(n.push({width:0,minh:999999,maxh:0,editors:[]}),r=n.length-1);n[r].editors.push({key:t,width:e,height:f});n[r].width+=e;n[r].minh=Math.min(n[r].minh,f);n[r].maxh=Math.max(n[r].maxh,f)}}),i=0;i<n.length;i++)if(n[i].width<12){for(u=!1,o=0,r=0;r<n[i].editors.length;r++)u===!1?u=r:n[i].editors[r].width>n[i].editors[u].width&&(u=r),n[i].editors[r].width*=12/n[i].width,n[i].editors[r].width=Math.floor(n[i].editors[r].width),o+=n[i].editors[r].width;o<12&&(n[i].editors[u].width+=12-o);n[i].width=12}if(this.layout===JSON.stringify(n))return!1;for(this.layout=JSON.stringify(n),f=document.createElement("div"),i=0;i<n.length;i++)for(s=this.theme.getGridRow(),f.appendChild(s),r=0;r<n[i].editors.length;r++)e=this.editors[n[i].editors[r].key],e.options.hidden?e.container.style.display="none":this.theme.setGridColumnSize(e.container,n[i].editors[r].width),s.appendChild(e.container)}else f=document.createElement("div"),t(this.editors,function(n,t){if(!t.property_removed){var i=h.theme.getGridRow();f.appendChild(i);t.options.hidden?t.container.style.display="none":h.theme.setGridColumnSize(t.container,12);i.appendChild(t.container)}});this.row_container.innerHTML="";this.row_container.appendChild(f)}},build:function(){var n,f,e,i,u;if(this.editors={},n=this,this.format=this.getOption("layout")||this.getOption("object_layout")||this.schema.format||this.jsoneditor.options.object_layout||"normal",this.schema.properties=this.schema.properties||{},this.minwidth=0,this.maxwidth=0,this.getOption("table_row",!1))this.editor_holder=this.container,t(this.schema.properties,function(t,i){var f=n.jsoneditor.getEditorClass(i,n.jsoneditor),u=n.editor_holder.appendChild(n.getTheme().getTableCell()),r;n.editors[t]=n.jsoneditor.createEditor(f,{jsoneditor:n.jsoneditor,schema:i,container:u,path:n.path+"."+t,parent:n,compact:!0});r=n.editors[t].options.hidden?0:n.editors[t].getNumColumns();n.minwidth+=r;n.maxwidth+=r;n.editors[t].options.hidden&&(u.style.display="none")}),this.no_link_holder=!0;else if(this.getOption("table",!1))throw"Not supported yet";else this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.getTheme().getHeader(this.header),this.container.appendChild(this.title),this.container.style.position="relative",this.editjson_holder=this.theme.getModal(),this.editjson_textarea=this.theme.getTextareaInput(),this.editjson_textarea.style.height="170px",this.editjson_textarea.style.width="300px",this.editjson_textarea.style.display="block",this.editjson_save=this.getButton("Save","save","Save"),this.editjson_save.addEventListener("click",function(){n.saveJSON()}),this.editjson_cancel=this.getButton("Cancel","cancel","Cancel"),this.editjson_cancel.addEventListener("click",function(){n.hideEditJSON()}),this.editjson_holder.appendChild(this.editjson_textarea),this.editjson_holder.appendChild(this.editjson_save),this.editjson_holder.appendChild(this.editjson_cancel),this.addproperty_holder=this.theme.getModal(),this.addproperty_list=document.createElement("div"),this.addproperty_list.style.width="295px",this.addproperty_list.style.maxHeight="160px",this.addproperty_list.style.padding="5px 0",this.addproperty_list.style.overflowY="auto",this.addproperty_list.style.overflowX="hidden",this.addproperty_list.style.paddingLeft="5px",this.addproperty_add=this.getButton("add","add","add"),this.addproperty_input=this.theme.getFormInputField("text"),this.addproperty_input.setAttribute("placeholder","Property name..."),this.addproperty_input.style.width="220px",this.addproperty_input.style.marginBottom="0",this.addproperty_input.style.display="inline-block",this.addproperty_add.addEventListener("click",function(){if(n.addproperty_input.value){if(n.editors[n.addproperty_input.value]){alert("there is already a property with that name");return}n.addObjectProperty(n.addproperty_input.value);n.addPropertyCheckbox(n.addproperty_input.value);n.editors[n.addproperty_input.value]&&n.editors[n.addproperty_input.value].disable()}}),this.addproperty_holder.appendChild(this.addproperty_list),this.addproperty_holder.appendChild(this.addproperty_input),this.addproperty_holder.appendChild(this.addproperty_add),f=document.createElement("div"),f.style.clear="both",this.addproperty_holder.appendChild(f),this.schema.description&&(this.description=this.getTheme().getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),this.editor_holder=this.getTheme().getIndentedPanel(),this.editor_holder.style.paddingBottom="0",this.container.appendChild(this.editor_holder),this.row_container=this.theme.getGridContainer(),this.editor_holder.appendChild(this.row_container),t(this.schema.properties,function(t,i){var f=n.jsoneditor.getEditorClass(i,n.jsoneditor),r=n.getTheme().getGridColumn(),u;n.row_container.appendChild(r);n.schema.required&&n.schema.required instanceof Array&&(u=n.schema.required.indexOf(t)>=0);n.editors[t]=n.jsoneditor.createEditor(f,{jsoneditor:n.jsoneditor,schema:i,container:r,path:n.path+"."+t,parent:n,required:u});n.minwidth=Math.max(n.minwidth,n.editors[t].getNumColumns());n.maxwidth+=n.editors[t].getNumColumns()}),this.title_controls=this.getTheme().getHeaderButtonHolder(),this.editjson_controls=this.getTheme().getHeaderButtonHolder(),this.addproperty_controls=this.getTheme().getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.title.appendChild(this.editjson_controls),this.title.appendChild(this.addproperty_controls),this.collapsed=!1,this.toggle_button=this.getButton("","collapse","Collapse"),this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener("click",function(){n.collapsed?(n.editor_holder.style.display="",n.collapsed=!1,n.setButtonText(n.toggle_button,"","collapse","Collapse")):(n.editor_holder.style.display="none",n.collapsed=!0,n.setButtonText(n.toggle_button,"","expand","Expand"))}),this.options.collapsed&&r(this.toggle_button,"click"),this.schema.options&&typeof this.schema.options.disable_collapse!="undefined"?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.editjson_button=this.getButton("JSON","edit","Edit JSON"),this.editjson_button.addEventListener("click",function(){n.toggleEditJSON()}),this.editjson_controls.appendChild(this.editjson_button),this.editjson_controls.appendChild(this.editjson_holder),this.schema.options&&typeof this.schema.options.disable_edit_json!="undefined"?this.schema.options.disable_edit_json&&(this.editjson_button.style.display="none"):this.jsoneditor.options.disable_edit_json&&(this.editjson_button.style.display="none"),this.addproperty_button=this.getButton("Properties","edit","Object Properties"),this.addproperty_button.addEventListener("click",function(){n.toggleAddProperty()}),this.addproperty_controls.appendChild(this.addproperty_button),this.addproperty_controls.appendChild(this.addproperty_holder),this.refreshAddProperties();for(e={},i=Object.keys(this.editors),i=i.sort(function(t,i){var r=n.editors[t].schema.propertyOrder,u=n.editors[i].schema.propertyOrder;return typeof r!="number"&&(r=1e3),typeof u!="number"&&(u=1e3),r-u}),u=0;u<i.length;u++)e[i[u]]=this.editors[i[u]];this.editors=e;this.layoutEditors();this.layoutEditors();this.jsoneditor.notifyWatchers(this.path)},showEditJSON:function(){this.editjson_holder&&(this.hideAddProperty(),this.editjson_holder.style.left=this.editjson_button.offsetLeft+"px",this.editjson_holder.style.top=this.editjson_button.offsetTop+this.editjson_button.offsetHeight+"px",this.editjson_textarea.value=JSON.stringify(this.getValue(),null,2),this.disable(),this.editjson_holder.style.display="",this.editjson_button.disabled=!1,this.editing_json=!0)},hideEditJSON:function(){this.editjson_holder&&this.editing_json&&(this.editjson_holder.style.display="none",this.enable(),this.editing_json=!1)},saveJSON:function(){if(this.editjson_holder)try{var n=JSON.parse(this.editjson_textarea.value);this.setValue(n);this.hideEditJSON()}catch(t){alert("invalid JSON");throw t;}},toggleEditJSON:function(){this.editing_json?this.hideEditJSON():this.showEditJSON()},addPropertyCheckbox:function(n){var u=this.editors[n],i,t,f,r;if(u)return i=this,t=i.theme.getCheckbox(),t.style.width="auto",f=i.theme.getCheckboxLabel(n),r=i.theme.getFormControl(f,t),r.style.paddingBottom=r.style.marginBottom=r.style.paddingTop=r.style.marginTop=0,r.style.height="auto",i.addproperty_list.appendChild(r),t.checked=!u.property_removed,u.isRequired()&&(t.disabled=!0),t.addEventListener("change",function(){t.checked?i.addObjectProperty(n):i.removeObjectProperty(n)}),t},showAddProperty:function(){if(this.addproperty_holder){this.hideEditJSON();this.addproperty_holder.style.left=this.addproperty_button.offsetLeft+"px";this.addproperty_holder.style.top=this.addproperty_button.offsetTop+this.addproperty_button.offsetHeight+"px";this.addproperty_list.innerHTML="";var n=this;this.addproperty_checkboxes={};t(this.editors,function(t){n.addproperty_checkboxes[t]=n.addPropertyCheckbox(t)});this.disable();this.adding_property=!0;this.addproperty_button.disabled=!1;this.addproperty_holder.style.display="";this.refreshAddProperties()}},hideAddProperty:function(){this.addproperty_holder&&this.adding_property&&(this.addproperty_holder.style.display="none",this.enable(),this.adding_property=!1)},toggleAddProperty:function(){this.adding_property?this.hideAddProperty():this.showAddProperty()},removeObjectProperty:function(n){if(this.editors[n])if(this.editors[n].property_removed=!0,this.editors[n].unregister(),this.refreshValue(),this.layoutEditors(),this.jsoneditor.notifyWatchers(this.path),this.parent)this.parent.onChildEditorChange(this);else this.jsoneditor.onChange()},addObjectProperty:function(n){var r=this,u,f,o,e;if(this.editors[n])if(this.editors[n].property_removed)this.editors[n].property_removed=!1,this.editors[n].register(),this.jsoneditor.notifyWatchers(this.editors[n].path);else return;else u={},f=!1,r.schema.patternProperties&&t(r.schema.patternProperties,function(t,r){var e=new RegExp(t);e.test(n)&&(f=!0,u=i(u,r))}),f||typeof r.schema.additionalProperties!="object"||(u=i(u,r.schema.additionalProperties)),o=r.jsoneditor.getEditorClass(u,r.jsoneditor),e=r.getTheme().getChildEditorHolder(),r.editor_holder.appendChild(e),r.editors[n]=r.jsoneditor.createEditor(o,{jsoneditor:r.jsoneditor,schema:u,container:e,path:r.path+"."+n,parent:r,required:!1}),r.editors[n].not_core=!0;if(r.refreshValue(),r.jsoneditor.notifyWatchers(r.path),r.parent)r.parent.onChildEditorChange(r);else r.jsoneditor.onChange();r.layoutEditors()},onChildEditorChange:function(n){this.refreshValue();this._super(n)},canHaveAdditionalProperties:function(){return this.schema.additionalProperties!==!1&&!this.jsoneditor.options.no_additional_properties},destroy:function(){t(this.editors,function(n,t){t.destroy()});this.editor_holder.innerHTML="";this.title&&this.title.parentNode.removeChild(this.title);this.error_holder&&this.error_holder.parentNode.removeChild(this.error_holder);this.editors=null;this.editor_holder.parentNode.removeChild(this.editor_holder);this.editor_holder=null;this._super()},refreshValue:function(){this.value={};this.serialized="";var r=this,u=0,i=!1,n=this.editors;t(this.editors,function(t,r){r.property_removed&&r.not_core&&(n={},i=!0)});t(this.editors,function(t,f){if(f.property_removed){if(!f.not_core&&i)n[t]=f;else if(f.not_core){var e=f.container;f.destroy();e.parentNode&&e.parentNode.removeChild(e)}return}i&&(n[t]=f);u++;r.value[t]=f.getValue()});this.editors=n;this.adding_property&&this.refreshAddProperties()},refreshAddProperties:function(){if(this.options.disable_properties||this.jsoneditor.options.disable_properties){this.addproperty_controls.style.display="none";return}var i=!1,u=!1,r=0,n,t=!1;for(n in this.editors)this.editors.hasOwnProperty(n)&&(this.editors[n].property_removed||r++);i=this.canHaveAdditionalProperties()&&!(typeof this.schema.maxProperties!="undefined"&&r>=this.schema.maxProperties);for(n in this.editors)this.editors.hasOwnProperty(n)&&(this.editors[n].isRequired()?this.addproperty_checkboxes&&this.addproperty_checkboxes[n]&&(this.addproperty_checkboxes[n].disabled=!0):typeof this.schema.minProperties!="undefined"&&r<=this.schema.minProperties?this.addproperty_checkboxes&&this.addproperty_checkboxes[n]?(this.addproperty_checkboxes[n].disabled=this.addproperty_checkboxes[n].checked,this.addproperty_checkboxes[n].checked||(t=!0)):this.editors[n].property_removed&&i&&(t=!0):this.editors[n].property_removed?this.addproperty_checkboxes&&this.addproperty_checkboxes[n]?i?(this.addproperty_checkboxes[n].disabled=!1,t=!0):this.addproperty_checkboxes[n].disabled=!0:i&&(t=!0):(this.addproperty_checkboxes&&this.addproperty_checkboxes[n]&&(this.addproperty_checkboxes[n].disabled=!1),t=!0,u=!0));if(this.canHaveAdditionalProperties()&&(t=!0),this.addproperty_checkboxes)for(n in this.addproperty_checkboxes)this.addproperty_checkboxes.hasOwnProperty(n)&&(this.editors[n]||(t=!0,this.addproperty_checkboxes[n].disabled=!i&&!u));t?this.canHaveAdditionalProperties()?this.addproperty_add.disabled=i?!1:!0:(this.addproperty_add.style.display="none",this.addproperty_input.style.display="none"):(this.hideAddProperty(),this.addproperty_controls.style.display="none")},setValue:function(n,i){var r=this;n=n||{};(typeof n!="object"||n instanceof Array)&&(n={});t(this.editors,function(t,u){if(typeof n[t]!="undefined")u.property_removed&&r.addObjectProperty(t),u.setValue(n[t],i);else{if(!i&&!u.property_removed&&!u.isRequired()){r.removeObjectProperty(t);return}u.setValue(u.getDefault(),i)}});this.canHaveAdditionalProperties()&&t(n,function(n,t){r.editors[n]||(r.addObjectProperty(n),r.editors[n]&&r.editors[n].setValue(t,i))});this.refreshValue();this.jsoneditor.notifyWatchers(this.path)},showValidationErrors:function(n){var r=this,i=[],u=[],f;t(n,function(n,t){t.path===r.path?i.push(t):u.push(t)});this.error_holder&&(i.length?(f=[],this.error_holder.innerHTML="",this.error_holder.style.display="",t(i,function(n,t){r.error_holder.appendChild(r.theme.getErrorMessage(t.message))})):this.error_holder.style.display="none");this.getOption("table_row")&&(i.length?this.theme.addTableRowError(this.container):this.theme.removeTableRowError(this.container));t(this.editors,function(n,t){t.showValidationErrors(u)})}});n.defaults.editors.array=n.AbstractEditor.extend({getDefault:function(){return this.schema.default||[]},register:function(){if(this._super(),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].register()},unregister:function(){if(this._super(),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].unregister()},getNumColumns:function(){var n=this.getItemInfo(0);return this.tabs_holder?Math.max(Math.min(12,n.width+2),4):n.width},addProperty:function(){this._super();this.row_holder.style.display="";this.tabs_holder&&(this.tabs_holder.style.display="");this.controls.style.display="";this.title_controls.style.display="";this.theme.enableHeader(this.title)},removeProperty:function(){this._super();this.row_holder.style.display="none";this.tabs_holder&&(this.tabs_holder.style.display="none");this.controls.style.display="none";this.title_controls.style.display="none";this.theme.disableHeader(this.title)},enable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!1),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!1),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!1),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].enable(),this.rows[n].moveup_button&&(this.rows[n].moveup_button.disabled=!1),this.rows[n].movedown_button&&(this.rows[n].movedown_button.disabled=!1),this.rows[n].delete_button&&(this.rows[n].delete_button.disabled=!1);this._super()},disable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!0),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!0),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!0),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].disable(),this.rows[n].moveup_button&&(this.rows[n].moveup_button.disabled=!0),this.rows[n].movedown_button&&(this.rows[n].movedown_button.disabled=!0),this.rows[n].delete_button&&(this.rows[n].delete_button.disabled=!0);this._super()},build:function(){this.rows=[];this.row_cache=[];var n=this;this.getOption("compact",!1)?(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder)):(this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),this.schema.format==="tabs"?(this.controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.controls),this.tabs_holder=this.theme.getTabHolder(),this.container.appendChild(this.tabs_holder),this.row_holder=this.theme.getTabContentHolder(this.tabs_holder),this.active_tab=null):(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls)));this.row_holder.addEventListener("change_header_text",function(){n.refreshTabs(!0)});this.addControls();this.jsoneditor.notifyWatchers(this.path)},onChildEditorChange:function(n){this.refreshValue();this._super(n)},getItemTitle:function(){return this.schema.items&&this.schema.items.title||"item"},getItemSchema:function(n){if(this.schema.items instanceof Array)if(n>=this.schema.items.length){if(this.schema.additionalItems===!0)return{};if(this.schema.additionalItems)return i({},this.schema.additionalItems)}else return i({},this.schema.items[n]);else return this.schema.items?i({},this.schema.items):{}},getItemInfo:function(n){var u=this.getItemSchema(n),r,t,i;return(this.item_info=this.item_info||{},r=JSON.stringify(u),typeof this.item_info[r]!="undefined")?this.item_info[r]:(t=document.createElement("div"),this.container.appendChild(t),t.addEventListener("change_header_text",function(n){n.preventDefault();n.stopPropagation()}),i=this.jsoneditor.getEditorClass(u,this.jsoneditor),i=this.jsoneditor.createEditor(i,{jsoneditor:this.jsoneditor,schema:u,container:t,path:this.path+"."+n,parent:this,required:!0}),this.item_info[r]={child_editors:i.getChildEditors()?!0:!1,title:u.title||"item",width:i.getNumColumns(),"default":i.getDefault()},i.destroy(),t.parentNode&&t.parentNode.removeChild(t),this.item_info[r])},getElementEditor:function(n){var u=this.getItemInfo(n),r=this.getItemSchema(n),f,i,t;return r.title=u.title+" "+n,f=this.jsoneditor.getEditorClass(r,this.jsoneditor),i=this.tabs_holder?this.theme.getTabContent():u.child_editors?this.theme.getChildEditorHolder():this.theme.getIndentedPanel(),this.row_holder.appendChild(i),t=this.jsoneditor.createEditor(f,{jsoneditor:this.jsoneditor,schema:r,container:i,path:this.path+"."+n,parent:this,required:!0}),t.title_controls||(t.array_controls=this.theme.getButtonHolder(),i.appendChild(t.array_controls)),t},destroy:function(){this.empty(!0);this.title&&this.title.parentNode.removeChild(this.title);this.description&&this.description.parentNode.removeChild(this.description);this.row_holder&&this.row_holder.parentNode.removeChild(this.row_holder);this.controls&&this.controls.parentNode.removeChild(this.controls);this.panel&&this.panel.parentNode.removeChild(this.panel);this.rows=this.row_cache=this.title=this.description=this.row_holder=this.panel=this.controls=null;this._super()},empty:function(n){if(this.rows){var i=this;t(this.rows,function(t,r){n&&(r.tab&&r.tab.parentNode&&r.tab.parentNode.removeChild(r.tab),i.destroyRow(r,!0),i.row_cache[t]=null);i.rows[t]=null});i.rows=[];n&&(i.row_cache=[])}},destroyRow:function(n,t){var i=n.container;t?(n.destroy(),i.parentNode&&i.parentNode.removeChild(i),n.tab&&n.tab.parentNode&&n.tab.parentNode.removeChild(n.tab)):(n.tab&&(n.tab.style.display="none"),i.style.display="none",n.unregister())},getMax:function(){return this.schema.items instanceof Array&&this.schema.additionalItems===!1?Math.min(this.schema.items.length,this.schema.maxItems||Infinity):this.schema.maxItems||Infinity},refreshTabs:function(n){var i=this;t(this.rows,function(t,r){r.tab&&(n?r.tab_text.textContent=r.getHeaderText():r.tab===i.active_tab?(i.theme.markTabActive(r.tab),r.container.style.display=""):(i.theme.markTabInactive(r.tab),r.container.style.display="none"))})},setValue:function(n){var f,i,r,u;if(n=n||[],n instanceof Array||(n=[n]),f=JSON.stringify(n),f!==this.serialized){if(this.schema.minItems)while(n.length<this.schema.minItems)n.push(this.getItemInfo(n.length).default);for(this.getMax()&&n.length>this.getMax()&&(n=n.slice(0,this.getMax())),i=this,t(n,function(n,t){i.rows[n]?i.rows[n].setValue(t):i.row_cache[n]?(i.rows[n]=i.row_cache[n],i.rows[n].setValue(t),i.rows[n].container.style.display="",i.rows[n].tab&&(i.rows[n].tab.style.display=""),i.rows[n].register()):i.addRow(t)}),r=n.length;r<i.rows.length;r++)i.destroyRow(i.rows[r]),i.rows[r]=null;i.rows=i.rows.slice(0,n.length);u=null;t(i.rows,function(n,t){if(t.tab===i.active_tab)return u=t.tab,!1});!u&&i.rows.length&&(u=i.rows[0].tab);i.active_tab=u;i.refreshValue();i.refreshTabs();i.jsoneditor.notifyWatchers(i.path)}},refreshValue:function(){var i=this,r=this.value?this.value.length:0,n;this.value=[];t(this.rows,function(n,t){i.value[n]=t.getValue()});r!==this.value.length&&(n=this.schema.minItems&&this.schema.minItems>=this.rows.length,t(this.rows,function(t,r){r.movedown_button.style.display=t===i.rows.length-1?"none":"";r.delete_button.style.display=n?"none":"";i.value[t]=r.getValue()}),this.value.length?this.value.length===1?(this.remove_all_rows_button.style.display="none",this.delete_last_row_button.style.display=n?"none":""):n?(this.delete_last_row_button.style.display="none",this.delete_last_row_button.style.display="none"):(this.delete_last_row_button.style.display="",this.remove_all_rows_button.style.display=""):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none"),this.add_row_button.style.display=this.getMax()&&this.getMax()<=this.rows.length?"none":"")},addRow:function(n){var i=this,r=this.rows.length,u;i.rows[r]=this.getElementEditor(r);i.row_cache[r]=i.rows[r];i.tabs_holder&&(i.rows[r].tab_text=document.createElement("span"),i.rows[r].tab_text.textContent=i.rows[r].getHeaderText(),i.rows[r].tab=i.theme.getTab(i.rows[r].tab_text),i.rows[r].tab.addEventListener("click",function(n){i.active_tab=i.rows[r].tab;i.refreshTabs();n.preventDefault();n.stopPropagation()}),i.theme.addTab(i.tabs_holder,i.rows[r].tab));i.rows[r].delete_button=this.getButton(i.getItemTitle(),"delete","Delete "+i.getItemTitle());i.rows[r].delete_button.className+=" delete";i.rows[r].delete_button.setAttribute("data-i",r);i.rows[r].delete_button.addEventListener("click",function(){var u=this.getAttribute("data-i")*1,f=i.getValue(),r=[],n=null;if(t(f,function(t,f){if(t===u){i.rows[t].tab===i.active_tab&&(i.rows[t+1]?n=i.rows[t+1].tab:t&&(n=i.rows[t-1].tab));return}r.push(f)}),i.setValue(r),n&&(i.active_tab=n,i.refreshTabs()),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});i.rows[r].moveup_button=this.getButton("","moveup","Move up");i.rows[r].moveup_button.className+=" moveup";i.rows[r].moveup_button.setAttribute("data-i",r);i.rows[r].moveup_button.addEventListener("click",function(){var n=this.getAttribute("data-i")*1,t,r;if(!(n<=0))if(t=i.getValue(),r=t[n-1],t[n-1]=t[n],t[n]=r,i.setValue(t),i.active_tab=i.rows[n-1].tab,i.refreshTabs(),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});i.rows[r].movedown_button=this.getButton("","movedown","Move down");i.rows[r].movedown_button.className+=" movedown";i.rows[r].movedown_button.setAttribute("data-i",r);i.rows[r].movedown_button.addEventListener("click",function(){var n=this.getAttribute("data-i")*1,t=i.getValue(),r;if(!(n>=t.length-1))if(r=t[n+1],t[n+1]=t[n],t[n]=r,i.setValue(t),i.active_tab=i.rows[n+1].tab,i.refreshTabs(),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});u=i.rows[r].title_controls||i.rows[r].array_controls;u&&(u.appendChild(i.rows[r].delete_button),r&&u.appendChild(i.rows[r].moveup_button),u.appendChild(i.rows[r].movedown_button));n&&i.rows[r].setValue(n);i.refreshTabs()},addControls:function(){var n=this,t,i;this.collapsed=!1;this.toggle_button=this.getButton("","collapse","Collapse");this.title_controls.appendChild(this.toggle_button);t=n.row_holder.style.display;i=n.controls.style.display;this.toggle_button.addEventListener("click",function(){n.collapsed?(n.collapsed=!1,n.row_holder.style.display=t,n.tabs_holder&&(n.tabs_holder.style.display=""),n.controls.style.display=i,n.setButtonText(this,"","collapse","Collapse")):(n.collapsed=!0,n.row_holder.style.display="none",n.tabs_holder&&(n.tabs_holder.style.display="none"),n.controls.style.display="none",n.setButtonText(this,"","expand","Expand"))});this.options.collapsed&&r(this.toggle_button,"click");this.schema.options&&typeof this.schema.options.disable_collapse!="undefined"?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none");this.add_row_button=this.getButton(this.getItemTitle(),"add","Add "+this.getItemTitle());this.add_row_button.addEventListener("click",function(){var t=n.rows.length;if(n.row_cache[t]?(n.rows[t]=n.row_cache[t],n.rows[t].container.style.display="",n.rows[t].tab&&(n.rows[t].tab.style.display=""),n.rows[t].register()):n.addRow(),n.active_tab=n.rows[t].tab,n.refreshTabs(),n.refreshValue(),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange();n.jsoneditor.notifyWatchers(n.path)});n.controls.appendChild(this.add_row_button);this.delete_last_row_button=this.getButton("Last "+this.getItemTitle(),"delete","Delete Last "+this.getItemTitle());this.delete_last_row_button.addEventListener("click",function(){var i=n.getValue(),t=null;if(n.rows.length>1&&n.rows[n.rows.length-1].tab===n.active_tab&&(t=n.rows[n.rows.length-2].tab),i.pop(),n.setValue(i),t&&(n.active_tab=t,n.refreshTabs()),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});n.controls.appendChild(this.delete_last_row_button);this.remove_all_rows_button=this.getButton("All","delete","Delete All");this.remove_all_rows_button.addEventListener("click",function(){if(n.setValue([]),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});n.controls.appendChild(this.remove_all_rows_button);n.tabs&&(this.add_row_button.style.width="100%",this.add_row_button.style.textAlign="left",this.add_row_button.style.marginBottom="3px",this.delete_last_row_button.style.width="100%",this.delete_last_row_button.style.textAlign="left",this.delete_last_row_button.style.marginBottom="3px",this.remove_all_rows_button.style.width="100%",this.remove_all_rows_button.style.textAlign="left",this.remove_all_rows_button.style.marginBottom="3px")},showValidationErrors:function(n){var i=this,r=[],u=[],f;t(n,function(n,t){t.path===i.path?r.push(t):u.push(t)});this.error_holder&&(r.length?(f=[],this.error_holder.innerHTML="",this.error_holder.style.display="",t(r,function(n,t){i.error_holder.appendChild(i.theme.getErrorMessage(t.message))})):this.error_holder.style.display="none");t(this.rows,function(n,t){t.showValidationErrors(u)})}});n.defaults.editors.table=n.defaults.editors.array.extend({addProperty:function(){this._super();this.value.length&&(this.table.style.display="")},removeProperty:function(){this._super();this.table.style.display="none"},register:function(){if(this._super(),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].register()},unregister:function(){if(this._super(),this.rows)for(var n=0;n<this.rows.length;n++)this.rows[n].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.width),3)},build:function(){var n,i;this.rows=[];n=this;this.schema.items=this.schema.items||[];this.table=this.theme.getTable();this.container.appendChild(this.table);this.thead=this.theme.getTableHead();this.table.appendChild(this.thead);this.header_row=this.theme.getTableRow();this.thead.appendChild(this.header_row);this.row_holder=this.theme.getTableBody();this.table.appendChild(this.row_holder);i=this.getElementEditor(0,!0);this.item_default=i.getDefault();this.item_title=this.schema.items.title||"row";this.width=i.getNumColumns();i.getChildEditors()&&(this.item_has_child_editors=!0);this.getOption("compact",!1)?(this.panel=document.createElement("div"),this.container.appendChild(this.panel)):(this.title=this.theme.getHeader(this.getTitle()),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.panel.appendChild(this.description)),this.error_holder=document.createElement("div"),this.panel.appendChild(this.error_holder));this.panel.appendChild(this.table);this.controls=this.theme.getButtonHolder();this.panel.appendChild(this.controls);this.item_has_child_editors?t(i.getChildEditors(),function(t,i){var r=n.theme.getTableHeaderCell(i.getTitle());i.options.hidden&&(r.style.display="none");n.header_row.appendChild(r)}):n.header_row.appendChild(n.theme.getTableHeaderCell(this.item_title));i.destroy();this.row_holder.innerHTML="";n.header_row.appendChild(n.theme.getTableHeaderCell(" "));this.addControls();this.jsoneditor.notifyWatchers(this.path)},onChildEditorChange:function(){this.refreshValue();this._super()},getItemDefault:function(){return i({},{"default":this.item_default}).default},getItemTitle:function(){return this.item_title},getElementEditor:function(n,t){var e=i({},this.schema.items),o=this.jsoneditor.getEditorClass(e,this.jsoneditor),u=this.row_holder.appendChild(this.theme.getTableRow()),f=u,r;return this.item_has_child_editors||(f=this.theme.getTableCell(),u.appendChild(f)),t&&f.addEventListener("change_header_text",function(n){n.preventDefault();n.stopPropagation()}),r=this.jsoneditor.createEditor(o,{jsoneditor:this.jsoneditor,schema:e,container:f,path:this.path+"."+n,parent:this,compact:!0,table_row:!0}),r.controls_cell=u.appendChild(this.theme.getTableCell()),r.row=u,r.table_controls=this.theme.getButtonHolder(),r.controls_cell.appendChild(r.table_controls),r.table_controls.style.margin=0,r.table_controls.style.padding=0,r},destroy:function(){this.innerHTML="";this.title&&this.title.parentNode.removeChild(this.title);this.description&&this.description.parentNode.removeChild(this.description);this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder);this.table.parentNode.removeChild(this.table);this.panel&&this.panel.parentNode.removeChild(this.panel);this.rows=this.title=this.description=this.row_holder=this.table=this.panel=null;this._super()},empty:function(){if(this.rows){var n=this;t(this.rows,function(t,i){n.item_has_child_editors||i.row.parentNode.removeChild(i.row);i.destroy();n.rows[t]=null});n.rows=[]}},setValue:function(n){var e,u,i,r,f;if(n=n||[],this.schema.minItems)while(n.length<this.schema.minItems)n.push(this.getItemDefault());if(this.schema.maxItems&&n.length>this.schema.maxItems&&(n=n.slice(0,this.schema.maxItems)),e=JSON.stringify(n),e!==this.serialized){for(u=!1,i=this,t(n,function(n,t){i.rows[n]?i.rows[n].setValue(t):(i.addRow(t),u=!0)}),r=n.length;r<i.rows.length;r++)f=i.rows[r].container,i.item_has_child_editors||i.rows[r].row.parentNode.removeChild(i.rows[r].row),i.rows[r].destroy(),f.parentNode&&f.parentNode.removeChild(f),i.rows[r]=null,u=!0;i.rows=i.rows.slice(0,n.length);i.refreshValue();u&&i.refreshRowButtons();i.jsoneditor.notifyWatchers(i.path)}},refreshRowButtons:function(){var i=this,n=this.schema.minItems&&this.schema.minItems>=this.rows.length;t(this.rows,function(t,r){r.movedown_button.style.display=t===i.rows.length-1?"none":"";r.delete_button.style.display=n?"none":""});this.value.length?this.value.length===1?(this.table.style.display="",this.remove_all_rows_button.style.display="none",this.delete_last_row_button.style.display=n?"none":""):(this.table.style.display="",n?(this.delete_last_row_button.style.display="none",this.delete_last_row_button.style.display="none"):(this.delete_last_row_button.style.display="",this.remove_all_rows_button.style.display="")):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none",this.table.style.display="none");this.add_row_button.style.display=this.schema.maxItems&&this.schema.maxItems<=this.rows.length?"none":""},refreshValue:function(){var n=this;this.value=[];t(this.rows,function(t,i){n.value[t]=i.getValue()});this.serialized=JSON.stringify(this.value)},addRow:function(n){var i=this,r=this.rows.length,u;i.rows[r]=this.getElementEditor(r);i.rows[r].delete_button=this.getButton("","delete","Delete");i.rows[r].delete_button.className+=" delete";i.rows[r].delete_button.setAttribute("data-i",r);i.rows[r].delete_button.addEventListener("click",function(){var r=this.getAttribute("data-i")*1,u=i.getValue(),n=[];if(t(u,function(t,i){t!==r&&n.push(i)}),i.setValue(n),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});i.rows[r].moveup_button=this.getButton("","moveup","Move up");i.rows[r].moveup_button.className+=" moveup";i.rows[r].moveup_button.setAttribute("data-i",r);i.rows[r].moveup_button.addEventListener("click",function(){var t=this.getAttribute("data-i")*1,n,r;if(!(t<=0))if(n=i.getValue(),r=n[t-1],n[t-1]=n[t],n[t]=r,i.setValue(n),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});i.rows[r].movedown_button=this.getButton("","movedown","Move down");i.rows[r].movedown_button.className+=" movedown";i.rows[r].movedown_button.setAttribute("data-i",r);i.rows[r].movedown_button.addEventListener("click",function(){var t=this.getAttribute("data-i")*1,n=i.getValue(),r;if(!(t>=n.length-1))if(r=n[t+1],n[t+1]=n[t],n[t]=r,i.setValue(n),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()});u=i.rows[r].table_controls;u.appendChild(i.rows[r].delete_button);r&&u.appendChild(i.rows[r].moveup_button);u.appendChild(i.rows[r].movedown_button);n&&i.rows[r].setValue(n);i.jsoneditor.notifyWatchers(i.path)},addControls:function(){var n=this;this.collapsed=!1;this.toggle_button=this.getButton("","collapse","Collapse");this.title_controls.appendChild(this.toggle_button);this.toggle_button.addEventListener("click",function(t){t.preventDefault();t.stopPropagation();n.collapsed?(n.collapsed=!1,n.panel.style.display="",n.setButtonText(this,"","collapse","Collapse")):(n.collapsed=!0,n.panel.style.display="none",n.setButtonText(this,"","expand","Expand"))});this.options.collapsed&&r(this.toggle_button,"click");this.schema.options&&typeof this.schema.options.disable_collapse!="undefined"?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none");this.add_row_button=this.getButton(this.getItemTitle(),"add","Add "+this.getItemTitle());this.add_row_button.addEventListener("click",function(t){if(t.preventDefault(),t.stopPropagation(),n.addRow(),n.refreshValue(),n.refreshRowButtons(),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});n.controls.appendChild(this.add_row_button);this.delete_last_row_button=this.getButton("Last "+this.getItemTitle(),"delete","Delete Last "+this.getItemTitle());this.delete_last_row_button.addEventListener("click",function(t){t.preventDefault();t.stopPropagation();var i=n.getValue();if(i.pop(),n.setValue(i),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});n.controls.appendChild(this.delete_last_row_button);this.remove_all_rows_button=this.getButton("All","delete","Delete All");this.remove_all_rows_button.addEventListener("click",function(t){if(t.preventDefault(),t.stopPropagation(),n.setValue([]),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});n.controls.appendChild(this.remove_all_rows_button)}});n.defaults.editors.multiple=n.AbstractEditor.extend({getDefault:function(){return this.schema.default||null},register:function(){if(this.editors){for(var n=0;n<this.editors.length;n++)this.editors[n]&&this.editors[n].unregister();this.editors[this.type]&&this.editors[this.type].register()}this._super()},getNumColumns:function(){return Math.max(this.editors[this.type].getNumColumns(),4)},enable:function(){if(this.editors)for(var n=0;n<this.editors.length;n++)this.editors[n]&&this.editors[n].enable();this.switcher.disabled=!1;this._super()},disable:function(){if(this.editors)for(var n=0;n<this.editors.length;n++)this.editors[n]&&this.editors[n].disable();this.switcher.disabled=!0;this._super()},unregister:function(){if(this._super(),this.editors)for(var n=0;n<this.editors.length;n++)this.editors[n]&&this.editors[n].unregister()},switchEditor:function(n){var i=this,r;if(this.editors[n]||this.buildChildEditor(n),i.type=n,i.register(),r=i.getValue(),t(i.editors,function(n,t){t&&(i.type===n?(t.setValue(r,!0),t.container.style.display=""):t.container.style.display="none")}),i.refreshValue(),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange()},buildChildEditor:function(n){var t=this,r=this.types[n],f=t.theme.getChildEditorHolder(),u,e;t.editor_holder.appendChild(f);typeof r=="string"?(u=i({},t.schema),u.type=r):(u=i({},t.schema,r),r.required&&r.required instanceof Array&&t.schema.required&&t.schema.required instanceof Array&&(u.required=t.schema.required.concat(r.required)));e=t.jsoneditor.getEditorClass(u,t.jsoneditor);t.editors[n]=t.jsoneditor.createEditor(e,{jsoneditor:t.jsoneditor,schema:u,container:f,path:t.path,parent:t,required:!0});t.editors[n].header&&(t.editors[n].header.style.display="none");t.editors[n].option=t.switcher_options[n];f.addEventListener("change_header_text",function(){t.refreshHeaderText()});n!==t.type&&(f.style.display="none")},build:function(){var r=this,e=this.container,u,f;this.header=this.label=this.theme.getFormInputLabel(this.getTitle());this.container.appendChild(this.header);this.types=[];this.schema.oneOf?(this.oneOf=!0,this.types=this.schema.oneOf,delete this.schema.oneOf):(this.schema.type&&this.schema.type!=="any"?this.types=this.schema.type instanceof Array?this.schema.type:[this.schema.type]:(this.types=["string","number","integer","boolean","object","array","null"],this.schema.disallow&&(u=this.schema.disallow,typeof schema.disallow=="object"&&schema.disallow instanceof Array||(u=[this.schema.disallow]),f=[],t(this.types,function(n,t){u.indexOf(t)===-1&&f.push(t)}),this.types=f)),delete this.schema.type);this.display_text=this.getDisplayText(this.types);this.switcher=this.theme.getSwitcher(this.display_text);e.appendChild(this.switcher);this.switcher.addEventListener("change",function(n){n.preventDefault();n.stopPropagation();r.switchEditor(r.display_text.indexOf(this.value))});this.switcher.style.marginBottom=0;this.switcher.style.width="auto";this.switcher.style.display="inline-block";this.switcher.style.marginLeft="5px";this.editor_holder=document.createElement("div");e.appendChild(this.editor_holder);this.type=0;this.editors=[];this.validators=[];this.switcher_options=this.theme.getSwitcherOptions(this.switcher);t(this.types,function(t,u){r.editors[t]=!1;var f;typeof u=="string"?(f=i({},r.schema),f.type=u):(f=i({},r.schema,u),u.required&&u.required instanceof Array&&r.schema.required&&r.schema.required instanceof Array&&(f.required=r.schema.required.concat(u.required)));r.validators[t]=new n.Validator(f,{required_by_default:r.jsoneditor.options.required_by_default,no_additional_properties:r.jsoneditor.options.no_additional_properties})});this.switchEditor(0);this.refreshValue();this.refreshHeaderText();this.register()},onChildEditorChange:function(){this.editors[this.type]&&(this.refreshHeaderText(),this.refreshValue());this._super()},refreshHeaderText:function(){var n=[],i;t(this.validators,function(t,i){n.push(i.schema)});i=this.getDisplayText(n);t(this.switcher_options,function(n,t){t.textContent=i[n]})},refreshValue:function(){this.value=this.editors[this.type].getValue()},setValue:function(n,i){var r=this;t(this.validators,function(t,i){if(!i.validate(n).length)return r.type=t,r.switcher.value=r.display_text[t],!1});this.switchEditor(this.type);this.editors[this.type].setValue(n,i);this.refreshValue();this.jsoneditor.notifyWatchers(this.path)},destroy:function(){t(this.editors,function(n,t){t&&t.destroy()});this.editor_holder.parentNode.removeChild(this.editor_holder);this.switcher.parentNode.removeChild(this.switcher);this._super()},showValidationErrors:function(n){var r=this;this.oneOf?t(this.editors,function(u,f){if(f){var e=r.path+".oneOf["+u+"]",o=[];t(n,function(n,t){if(t.path.substr(0,e.length)===e){var u=i({},t);u.path=r.path+u.path.substr(e.length);o.push(u)}});f.showValidationErrors(o)}}):t(this.editors,function(t,i){i&&i.showValidationErrors(n)})}});n.defaults.editors.enum=n.AbstractEditor.extend({getDefault:function(){return this.schema.enum[0]},addProperty:function(){this._super();this.display_area.style.display="";this.theme.enableHeader(this.title)},removeProperty:function(){this._super();this.display_area.style.display="none";this.theme.disableHeader(this.title)},getNumColumns:function(){return 4},build:function(){var i=this.getContainer(),n,t;for(this.title=this.header=this.label=this.getTheme().getFormInputLabel(this.getTitle()),this.container.appendChild(this.title),this.options.enum_titles=this.options.enum_titles||[],this.enum=this.schema.enum,this.selected=0,this.select_options=[],this.html_values=[],n=this,t=0;t<this.enum.length;t++)this.select_options[t]=this.options.enum_titles[t]||"Value "+(t+1),this.html_values[t]=this.getHTML(this.enum[t]);this.switcher=this.theme.getSwitcher(this.select_options);this.container.appendChild(this.switcher);this.switcher.style.width="auto";this.switcher.style.display="inline-block";this.switcher.style.marginLeft="5px";this.switcher.style.marginBottom=0;this.display_area=this.theme.getIndentedPanel();this.display_area.style.paddingTop=0;this.display_area.style.paddingBottom=0;this.container.appendChild(this.display_area);this.switcher.addEventListener("change",function(){if(n.selected=n.select_options.indexOf(this.value),n.value=n.enum[n.selected],n.refreshValue(),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange()});this.value=this.enum[0];this.refreshValue();this.jsoneditor.notifyWatchers(this.path);this.enum.length===1&&(this.switcher.style.display="none")},refreshValue:function(){var n=this,i;if(n.selected=-1,i=JSON.stringify(this.value),t(this.enum,function(t,r){if(i===JSON.stringify(r))return n.selected=t,!1}),n.selected<0){n.setValue(n.enum[0]);return}this.switcher.value=this.select_options[this.selected];this.display_area.innerHTML=this.html_values[this.selected]},enable:function(){this.always_disabled||(this.switcher.disabled=!1);this._super()},disable:function(){this.switcher.disabled=!0;this._super()},getHTML:function(n){var r=this,i;return n===null?"<em>null<\/em>":typeof n=="object"?(i="",t(n,function(t,u){var f=r.getHTML(u);n instanceof Array||(f="<div><em>"+t+"<\/em>: "+f+"<\/div>");i+="<li>"+f+"<\/li>"}),i=n instanceof Array?"<ol>"+i+"<\/ol>":"<ul style='margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;'>"+i+"<\/ul>"):typeof n=="boolean"?n?"true":"false":typeof n=="string"?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n},setValue:function(n){this.value!==n&&(this.value=n,this.refreshValue(),this.jsoneditor.notifyWatchers(this.path))},destroy:function(){this.display_area.parentNode.removeChild(this.display_area);this.title.parentNode.removeChild(this.title);this.switcher.parentNode.removeChild(this.switcher);this._super()}});n.defaults.editors.select=n.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},setValue:function(n){n=this.typecast(n||"");var t=n;(this.enum_values.indexOf(t)<0&&(t=this.enum_values[0]),this.value!==t)&&(this.input.value=this.enum_options[this.enum_values.indexOf(t)],this.value=t,this.jsoneditor.notifyWatchers(this.path))},register:function(){(this._super(),this.input)&&this.input.setAttribute("name",this.formname)},unregister:function(){(this._super(),this.input)&&this.input.removeAttribute("name")},getNumColumns:function(){for(var n=this.getTitle().length,t=0;t<this.enum_options.length;t++)n=Math.max(n,this.enum_options[t].length+4);return Math.min(12,Math.max(n/7,2))},typecast:function(n){return this.schema.type==="boolean"?!!n:this.schema.type==="number"?1*n:this.schema.type==="integer"?Math.floor(n*1):""+n},getValue:function(){return this.value},removeProperty:function(){this._super();this.input.style.display="none";this.description&&(this.description.style.display="none");this.theme.disableLabel(this.label)},addProperty:function(){this._super();this.input.style.display="";this.description&&(this.description.style.display="");this.theme.enableLabel(this.label)},build:function(){var n=this;if(this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.input_type="select",this.enum_options=[],this.enum_values=[],this.enum_display=[],this.schema.enum)t(this.schema.enum,function(t,i){n.enum_options[t]=""+i;n.enum_display[t]=""+i;n.enum_values[t]=n.typecast(i)});else if(this.schema.type==="boolean")n.enum_display=["true","false"],n.enum_options=["1",""],n.enum_values=[!0,!1];else throw"'select' editor requires the enum property to be set.";this.getOption("compact")&&this.container.setAttribute("class",this.container.getAttribute("class")+" compact");this.input=this.theme.getSelectInput(this.enum_options);this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display);(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0);this.input.addEventListener("change",function(t){t.preventDefault();t.stopPropagation();var i=this.value,r=i;if(n.enum_options.indexOf(i)===-1&&(r=n.enum_options[0]),n.value=n.enum_values[n.enum_options.indexOf(i)],n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange();n.jsoneditor.notifyWatchers(n.path)});this.control=this.getTheme().getFormControl(this.label,this.input,this.description);this.container.appendChild(this.control);this.value=this.enum_values[0];window.$&&$.fn&&$.fn.select2&&this.enum_options.length>2&&$(this.input).select2();this.register();n.theme.afterInputReady(n.input);this.jsoneditor.notifyWatchers(this.path)},enable:function(){this.always_disabled||(this.input.disabled=!1);this._super()},disable:function(){this.input.disabled=!0;this._super()},destroy:function(){this.label&&this.label.parentNode.removeChild(this.label);this.description&&this.description.parentNode.removeChild(this.description);this.input.parentNode.removeChild(this.input);this._super()}});n.defaults.editors.multiselect=n.AbstractEditor.extend({getDefault:function(){return[]},build:function(){var i=this,n,r,t,u;for(this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.select_options={},this.select_values={},r=this.schema.items.enum||[],t=[],n=0;n<r.length;n++)this.sanitize(r[n])===r[n]&&(t.push(r[n]+""),this.select_values[r[n]+""]=r[n]);if(!this.schema.format&&t.length<8||this.schema.format==="checkbox"){for(this.input_type="checkboxes",this.inputs={},this.controls={},n=0;n<t.length;n++)this.inputs[t[n]]=this.theme.getCheckbox(),this.select_options[t[n]]=this.inputs[t[n]],u=this.theme.getCheckboxLabel(t[n]),this.controls[t[n]]=this.theme.getFormControl(u,this.inputs[t[n]]);this.control=this.theme.getMultiCheckboxHolder(this.controls,this.label,this.description)}else{for(this.input_type="select",this.input=this.theme.getSelectInput(t),this.input.multiple=!0,this.input.size=Math.min(10,t.length),n=0;n<t.length;n++)this.select_options[t[n]]=this.input.children[n];(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0);this.control=this.getTheme().getFormControl(this.label,this.input,this.description)}this.container.appendChild(this.control);this.control.addEventListener("change",function(r){r.preventDefault();r.stopPropagation();var u=[];for(n=0;n<t.length;n++)(i.select_options[t[n]].selected||i.select_options[t[n]].checked)&&u.push(i.select_values[t[n]]);if(i.updateValue(u),i.parent)i.parent.onChildEditorChange(i);else i.jsoneditor.onChange();i.jsoneditor.notifyWatchers(i.path)})},setValue:function(n){var t;for(n=n||[],typeof n!="object"?n=[n]:n instanceof Array||(n=[]),t=0;t<n.length;t++)typeof n[t]!="string"&&(n[t]+="");for(t in this.select_options)this.select_options.hasOwnProperty(t)&&(this.select_options[t][this.input_type==="select"?"selected":"checked"]=n.indexOf(t)!==-1);if(this.updateValue(n))if(this.parent)this.onChildEditorChange(this);else this.jsoneditor.onChange();this.jsoneditor.notifyWatchers(this.path)},register:function(){(this._super(),this.input)&&this.input.setAttribute("name",this.formname)},unregister:function(){(this._super(),this.input)&&this.input.removeAttribute("name")},getNumColumns:function(){var n=this.getTitle().length;for(var t in this.select_values)this.select_values.hasOwnProperty(t)&&(n=Math.max(n,(this.select_values[t]+"").length+4));return Math.min(12,Math.max(n/7,2))},updateValue:function(n){for(var r,i=!1,u=[],t=0;t<n.length;t++){if(!this.select_options[n[t]+""]){i=!0;continue}r=this.sanitize(this.select_values[n[t]]);u.push(r);r!==n[t]&&(i=!0)}return this.value=u,i},sanitize:function(n){return this.schema.items.type==="number"?1*n:this.schema.items.type==="integer"?Math.floor(n*1):""+n},enable:function(){this.always_disabled||(this.input.disabled=!1);this._super()},disable:function(){this.input.disabled=!0;this._super()}});n.defaults.editors.base64=n.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},getNumColumns:function(){return 4},build:function(){var n=this;if(this.title=this.header=this.label=this.getTheme().getFormInputLabel(this.getTitle()),this.input=this.theme.getFormInputField("hidden"),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!window.FileReader)throw"FileReader required for base64 editor";this.uploader=this.theme.getFormInputField("file");this.uploader.addEventListener("change",function(t){if(t.preventDefault(),t.stopPropagation(),this.files&&this.files.length){var i=new FileReader;i.onload=function(t){if(n.value=t.target.result,n.refreshPreview(),n.watch_listener(),n.jsoneditor.notifyWatchers(n.path),n.parent)n.parent.onChildEditorChange(n);else n.jsoneditor.onChange();i=null};i.readAsDataURL(this.files[0])}})}this.preview=this.theme.getFormInputDescription(this.schema.description);this.container.appendChild(this.preview);this.control=this.getTheme().getFormControl(this.label,this.uploader||this.input,this.preview);this.container.appendChild(this.control);this.register()},refreshPreview:function(){var n,t;this.last_preview!==this.value&&(this.last_preview=this.value,this.preview.innerHTML="",this.value)&&(n=this.value.match(/^data:([^;,]+)[;,]/),n&&(n=n[1]),n?(this.preview.innerHTML="<strong>Type:<\/strong> "+n+", <strong>Size:<\/strong> "+Math.floor((this.value.length-this.value.split(",")[0].length-1)/1.33333)+" bytes",n.substr(0,5)==="image"&&(this.preview.innerHTML+="<br>",t=document.createElement("img"),t.style.maxWidth="100%",t.style.maxHeight="100px",t.src=this.value,this.preview.appendChild(t))):this.preview.innerHTML="<em>Invalid data URI<\/em>")},enable:function(){this.uploader&&(this.uploader.disabled=!1);this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0);this._super()},setValue:function(n){this.value!==n&&(this.value=n,this.input.value=this.value,this.refreshPreview(),this.watch_listener(),this.jsoneditor.notifyWatchers(this.path))},destroy:function(){this.preview.parentNode.removeChild(this.preview);this.title.parentNode.removeChild(this.title);this.input.parentNode.removeChild(this.input);this.uploader&&this.uploader.parentNode.removeChild(this.uploader);this._super()}});n.AbstractTheme=Class.extend({getContainer:function(){return document.createElement("div")},getFloatRightLinkHolder:function(){var n=document.createElement("div");return n.style=n.style||{},n.style.float="right",n.style["margin-left"]="10px",n},getModal:function(){var n=document.createElement("div");return n.style.backgroundColor="white",n.style.border="1px solid black",n.style.boxShadow="3px 3px black",n.style.position="absolute",n.style.zIndex="10",n.style.display="none",n},getGridContainer:function(){return document.createElement("div")},getGridRow:function(){var n=document.createElement("div");return n.className="row",n},getGridColumn:function(){return document.createElement("div")},setGridColumnSize:function(){},getLink:function(n){var t=document.createElement("a");return t.setAttribute("href","#"),t.appendChild(document.createTextNode(n)),t},disableHeader:function(n){n.style.color="#ccc"},disableLabel:function(n){n.style.color="#ccc"},enableHeader:function(n){n.style.color=""},enableLabel:function(n){n.style.color=""},getFormInputLabel:function(n){var t=document.createElement("label");return t.appendChild(document.createTextNode(n)),t},getCheckboxLabel:function(n){var t=this.getFormInputLabel(n);return t.style.fontWeight="normal",t},getHeader:function(n){var t=document.createElement("h3");return typeof n=="string"?t.textContent=n:t.appendChild(n),t},getCheckbox:function(){var n=this.getFormInputField("checkbox");return n.style.display="inline-block",n.style.width="auto",n},getMultiCheckboxHolder:function(n,t,i){var u=document.createElement("div"),r;t.style.display="block";u.appendChild(t);for(r in n)n.hasOwnProperty(r)&&(n[r].style.display="inline-block",n[r].style.marginRight="20px",u.appendChild(n[r]));return i&&u.appendChild(i),u},getSelectInput:function(n){var t=document.createElement("select");return n&&this.setSelectOptions(t,n),t},getSwitcher:function(n){var t=this.getSelectInput(n);return t.style.backgroundColor="transparent",t.style.height="auto",t.style.fontStyle="italic",t.style.fontWeight="normal",t.style.padding="0 0 0 3px",t},getSwitcherOptions:function(n){return n.getElementsByTagName("option")},setSwitcherOptions:function(n,t,i){this.setSelectOptions(n,t,i)},setSelectOptions:function(n,t,i){var r,u;for(i=i||[],n.innerHTML="",r=0;r<t.length;r++)u=document.createElement("option"),u.setAttribute("value",t[r]),u.textContent=i[r]||t[r],n.appendChild(u)},getTextareaInput:function(){var n=document.createElement("textarea");return n.style=n.style||{},n.style.width="100%",n.style.height="300px",n.style.boxSizing="border-box",n},getRangeInput:function(n,t,i){var r=this.getFormInputField("range");return r.setAttribute("min",n),r.setAttribute("max",t),r.setAttribute("step",i),r},getFormInputField:function(n){var t=document.createElement("input");return t.setAttribute("type",n),t},afterInputReady:function(){},getFormControl:function(n,t,i){var r=document.createElement("div");return r.className="form-control",n&&r.appendChild(n),t.type==="checkbox"?n.insertBefore(t,n.firstChild):r.appendChild(t),i&&r.appendChild(i),r},getIndentedPanel:function(){var n=document.createElement("div");return n.style=n.style||{},n.style.paddingLeft="10px",n.style.marginLeft="10px",n.style.borderLeft="1px solid #ccc",n},getChildEditorHolder:function(){return document.createElement("div")},getDescription:function(n){var t=document.createElement("p");return t.appendChild(document.createTextNode(n)),t},getCheckboxDescription:function(n){return this.getDescription(n)},getFormInputDescription:function(n){return this.getDescription(n)},getHeaderButtonHolder:function(){return this.getButtonHolder()},getButtonHolder:function(){return document.createElement("div")},getButton:function(n,t,i){var r=document.createElement("button");return this.setButtonText(r,n,t,i),r},setButtonText:function(n,t,i,r){n.innerHTML="";i&&(n.appendChild(i),n.innerHTML+=" ");n.appendChild(document.createTextNode(t));r&&n.setAttribute("title",r)},getTable:function(){return document.createElement("table")},getTableRow:function(){return document.createElement("tr")},getTableHead:function(){return document.createElement("thead")},getTableBody:function(){return document.createElement("tbody")},getTableHeaderCell:function(n){var t=document.createElement("th");return t.textContent=n,t},getTableCell:function(){return document.createElement("td")},getErrorMessage:function(n){var t=document.createElement("p");return t.style=t.style||{},t.style.color="red",t.appendChild(document.createTextNode(n)),t},addInputError:function(){},removeInputError:function(){},addTableRowError:function(){},removeTableRowError:function(){},getTabHolder:function(){var n=document.createElement("div");return n.innerHTML="<div style='float: left; width: 130px;' class='tabs'><\/div><div class='content' style='margin-left: 130px;'><\/div><div style='clear:both;'><\/div>",n},applyStyles:function(n,t){n.style=n.style||{};for(var i in t)t.hasOwnProperty(i)&&(n.style[i]=t[i])},closest:function(n,t){for(var r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector,i;n&&n!==document;)try{if(i=r.bind(n),i(t))return n;n=n.parentNode}catch(u){return!1}return!1},getTab:function(n){var t=document.createElement("div");return t.appendChild(n),t.style=t.style||{},this.applyStyles(t,{border:"1px solid #ccc",borderWidth:"1px 0 1px 1px",textAlign:"center",lineHeight:"30px",borderRadius:"5px",borderBottomRightRadius:0,borderTopRightRadius:0,fontWeight:"bold",cursor:"pointer"}),t},getTabContentHolder:function(n){return n.children[1]},getTabContent:function(){return this.getIndentedPanel()},markTabActive:function(n){this.applyStyles(n,{opacity:1,background:"white"})},markTabInactive:function(n){this.applyStyles(n,{opacity:.5,background:""})},addTab:function(n,t){n.children[0].appendChild(t)},getBlockLink:function(){var n=document.createElement("a");return n.style.display="block",n},getBlockLinkHolder:function(){return document.createElement("div")},getLinksHolder:function(){return document.createElement("div")},createMediaLink:function(n,t,i){n.appendChild(t);i.style.width="100%";n.appendChild(i)},createImageLink:function(n,t,i){n.appendChild(t);t.appendChild(i)}});n.defaults.themes.bootstrap2=n.AbstractTheme.extend({getRangeInput:function(n,t,i){return this._super(n,t,i)},getGridContainer:function(){var n=document.createElement("div");return n.className="container-fluid",n},getGridRow:function(){var n=document.createElement("div");return n.className="row-fluid",n},getFormInputLabel:function(n){var t=this._super(n);return t.style.display="inline-block",t.style.fontWeight="bold",t},setGridColumnSize:function(n,t){n.className="span"+t},getSelectInput:function(n){var t=this._super(n);return t.style.width="auto",t.style.maxWidth="98%",t},getFormInputField:function(n){var t=this._super(n);return t.style.width="98%",t},afterInputReady:function(n){n.controlgroup||(n.controlgroup=this.closest(n,".control-group"),n.controls=this.closest(n,".controls"),this.closest(n,".compact")&&(n.controlgroup.className=n.controlgroup.className.replace(/control-group/g,"").replace(/[ ]{2,}/g," "),n.controls.className=n.controlgroup.className.replace(/controls/g,"").replace(/[ ]{2,}/g," "),n.style.marginBottom=0))},getIndentedPanel:function(){var n=document.createElement("div");return n.className="well well-small",n},getFormInputDescription:function(n){var t=document.createElement("p");return t.className="help-inline",t.textContent=n,t},getFormControl:function(n,t,i){var u=document.createElement("div"),r;return u.className="control-group",r=document.createElement("div"),r.className="controls",n&&t.getAttribute("type")==="checkbox"?(u.appendChild(r),n.className+=" checkbox",n.appendChild(t),r.appendChild(n),r.style.height="30px"):(n&&(n.className+=" control-label",u.appendChild(n)),r.appendChild(t),u.appendChild(r)),i&&r.appendChild(i),u},getHeaderButtonHolder:function(){var n=this.getButtonHolder();return n.style.marginLeft="10px",n},getButtonHolder:function(){var n=document.createElement("div");return n.className="btn-group",n},getButton:function(n,t,i){var r=this._super(n,t,i);return r.className+=" btn btn-default",r},getTable:function(){var n=document.createElement("table");return n.className="table table-bordered",n.style.width="auto",n.style.maxWidth="none",n},addInputError:function(n,t){n.controlgroup&&n.controls&&(n.controlgroup.className+=" error",n.errmsg?n.errmsg.style.display="":(n.errmsg=document.createElement("p"),n.errmsg.className="help-block errormsg",n.controls.appendChild(n.errmsg)),n.errmsg.textContent=t)},removeInputError:function(n){n.errmsg&&(n.errmsg.style.display="none",n.controlgroup.className=n.controlgroup.className.replace(/\s?error/g,""))},getTabHolder:function(){var n=document.createElement("div");return n.className="tabbable tabs-left",n.innerHTML="<ul class='nav nav-tabs span2' style='margin-right: 0;'><\/ul><div class='tab-content span10' style='overflow:visible;'><\/div>",n},getTab:function(n){var i=document.createElement("li"),t=document.createElement("a");return t.setAttribute("href","#"),t.appendChild(n),i.appendChild(t),i},getTabContentHolder:function(n){return n.children[1]},getTabContent:function(){var n=document.createElement("div");return n.className="tab-pane active",n},markTabActive:function(n){n.className+=" active"},markTabInactive:function(n){n.className=n.className.replace(/\s?active/g,"")},addTab:function(n,t){n.children[0].appendChild(t)}});n.defaults.themes.bootstrap3=n.AbstractTheme.extend({getSelectInput:function(n){var t=this._super(n);return t.className+="form-control",t},setGridColumnSize:function(n,t){n.className="col-md-"+t},afterInputReady:function(n){n.controlgroup||(n.controlgroup=this.closest(n,".form-group"),this.closest(n,".compact")&&(n.controlgroup.style.marginBottom=0))},getTextareaInput:function(){var n=document.createElement("textarea");return n.className="form-control",n},getRangeInput:function(n,t,i){return this._super(n,t,i)},getFormInputField:function(n){var t=this._super(n);return n!=="checkbox"&&(t.className+="form-control"),t},getFormControl:function(n,t,i){var r=document.createElement("div");return n&&t.type==="checkbox"?(r.className+=" checkbox",n.appendChild(t),n.style.fontSize="14px",r.style.marginTop="0",r.appendChild(n)):(r.className+=" form-group",n&&(n.className+=" control-label",r.appendChild(n)),r.appendChild(t)),i&&r.appendChild(i),r},getIndentedPanel:function(){var n=document.createElement("div");return n.className="well well-sm",n},getFormInputDescription:function(n){var t=document.createElement("p");return t.className="help-block",t.textContent=n,t},getHeaderButtonHolder:function(){var n=this.getButtonHolder();return n.style.marginLeft="10px",n},getButtonHolder:function(){var n=document.createElement("div");return n.className="btn-group",n},getButton:function(n,t,i){var r=this._super(n,t,i);return r.className+="btn btn-default",r},getTable:function(){var n=document.createElement("table");return n.className="table table-bordered",n.style.width="auto",n.style.maxWidth="none",n},addInputError:function(n,t){n.controlgroup&&(n.controlgroup.className+=" has-error",n.errmsg?n.errmsg.style.display="":(n.errmsg=document.createElement("p"),n.errmsg.className="help-block errormsg",n.controlgroup.appendChild(n.errmsg)),n.errmsg.textContent=t)},removeInputError:function(n){n.errmsg&&(n.errmsg.style.display="none",n.controlgroup.className=n.controlgroup.className.replace(/\s?has-error/g,""))},getTabHolder:function(){var n=document.createElement("div");return n.innerHTML="<div class='tabs list-group col-md-2'><\/div><div class='col-md-10'><\/div>",n.className="rows",n},getTab:function(n){var t=document.createElement("a");return t.className="list-group-item",t.setAttribute("href","#"),t.appendChild(n),t},markTabActive:function(n){n.className+=" active"},markTabInactive:function(n){n.className=n.className.replace(/\s?active/g,"")}});n.defaults.themes.foundation=n.AbstractTheme.extend({getChildEditorHolder:function(){var n=document.createElement("div");return n.style.marginBottom="15px",n},getSelectInput:function(n){var t=this._super(n);return t.style.minWidth="none",t.style.padding="5px",t.style.marginTop="3px",t},getSwitcher:function(n){var t=this._super(n);return t.style.paddingRight="8px",t},afterInputReady:function(n){this.closest(n,".compact")&&(n.style.marginBottom=0);n.group=this.closest(n,".form-control")},getFormInputLabel:function(n){var t=this._super(n);return t.style.display="inline-block",t},getFormInputField:function(n){var t=this._super(n);return t.style.width="100%",t.style.marginBottom=n==="checkbox"?"0":"12px",t},getFormInputDescription:function(n){var t=document.createElement("p");return t.textContent=n,t.style.marginTop="-10px",t.style.fontStyle="italic",t},getIndentedPanel:function(){var n=document.createElement("div");return n.className="panel",n},getHeaderButtonHolder:function(){var n=this.getButtonHolder();return n.style.display="inline-block",n.style.marginLeft="10px",n.style.verticalAlign="middle",n},getButtonHolder:function(){var n=document.createElement("div");return n.className="button-group",n},getButton:function(n,t,i){var r=this._super(n,t,i);return r.className+=" small button",r},addInputError:function(n,t){n.group&&(n.group.className+=" error",n.errmsg?n.errmsg.style.display="":(n.insertAdjacentHTML("afterend",'<small class="errormsg"><\/small>'),n.errmsg=n.parentNode.getElementsByClassName("errormsg")[0]),n.errmsg.textContent=t)},removeInputError:function(n){n.errmsg&&(n.group.className=n.group.className.replace(/ error/g,""),n.errmsg.style.display="none")}});n.defaults.themes.foundation3=n.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var n=this._super();return n.style.fontSize=".6em",n},getFormInputLabel:function(n){var t=this._super(n);return t.style.fontWeight="bold",t},getTabHolder:function(){var n=document.createElement("div");return n.className="row",n.innerHTML="<dl class='tabs vertical two columns'><\/dl><div class='tabs-content ten columns'><\/div>",n},setGridColumnSize:function(n,t){n.className="columns "+["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"][t]},getTab:function(n){var i=document.createElement("dd"),t=document.createElement("a");return t.setAttribute("href","#"),t.appendChild(n),i.appendChild(t),i},getTabContentHolder:function(n){return n.children[1]},getTabContent:function(){var n=document.createElement("div");return n.className="content active",n.style.paddingLeft="5px",n},markTabActive:function(n){n.className+=" active"},markTabInactive:function(n){n.className=n.className.replace(/\s*active/g,"")},addTab:function(n,t){n.children[0].appendChild(t)}});n.defaults.themes.foundation4=n.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var n=this._super();return n.style.fontSize=".6em",n},setGridColumnSize:function(n,t){n.className="columns large-"+t},getFormInputDescription:function(n){var t=this._super(n);return t.style.fontSize=".8rem",t},getFormInputLabel:function(n){var t=this._super(n);return t.style.fontWeight="bold",t}});n.defaults.themes.foundation5=n.defaults.themes.foundation.extend({getFormInputDescription:function(n){var t=this._super(n);return t.style.fontSize=".8rem",t},setGridColumnSize:function(n,t){n.className="columns medium-"+t},getButton:function(n,t,i){var r=this._super(n,t,i);return r.className=r.className.replace(/\s*small/g,"")+" tiny",r},getTabHolder:function(){var n=document.createElement("div");return n.innerHTML="<dl class='tabs vertical'><\/dl><div class='tabs-content'><\/div>",n},getTab:function(n){var i=document.createElement("dd"),t=document.createElement("a");return t.setAttribute("href","#"),t.appendChild(n),i.appendChild(t),i},getTabContentHolder:function(n){return n.children[1]},getTabContent:function(){var n=document.createElement("div");return n.className="content active",n.style.paddingLeft="5px",n},markTabActive:function(n){n.className+=" active"},markTabInactive:function(n){n.className=n.className.replace(/\s*active/g,"")},addTab:function(n,t){n.children[0].appendChild(t)}});n.defaults.themes.html=n.AbstractTheme.extend({getFormInputLabel:function(n){var t=this._super(n);return t.style.display="block",t.style.marginBottom="3px",t.style.fontWeight="bold",t},getFormInputDescription:function(n){var t=this._super(n);return t.style.fontSize=".8em",t.style.margin=0,t.style.display="inline-block",t.style.fontStyle="italic",t},getIndentedPanel:function(){var n=this._super();return n.style.border="1px solid #ddd",n.style.padding="5px",n.style.margin="5px",n.style.borderRadius="3px",n},getChildEditorHolder:function(){var n=this._super();return n.style.marginBottom="8px",n},getHeaderButtonHolder:function(){var n=this.getButtonHolder();return n.style.display="inline-block",n.style.marginLeft="10px",n.style.fontSize=".8em",n.style.verticalAlign="middle",n},getTable:function(){var n=this._super();return n.style.borderBottom="1px solid #ccc",n.style.marginBottom="5px",n},addInputError:function(n,t){if(n.style.borderColor="red",n.errmsg)n.errmsg.style.display="block";else{var i=this.closest(n,".form-control");n.errmsg=document.createElement("div");n.errmsg.setAttribute("class","errmsg");n.errmsg.style=n.errmsg.style||{};n.errmsg.style.color="red";i.appendChild(n.errmsg)}n.errmsg.innerHTML="";n.errmsg.appendChild(document.createTextNode(t))},removeInputError:function(n){n.style.borderColor="";n.errmsg&&(n.errmsg.style.display="none")}});n.defaults.themes.jqueryui=n.AbstractTheme.extend({getTable:function(){var n=this._super();return n.setAttribute("cellpadding",5),n.setAttribute("cellspacing",0),n},getTableHeaderCell:function(n){var t=this._super(n);return t.className="ui-state-active",t.style.fontWeight="bold",t},getTableCell:function(){var n=this._super();return n.className="ui-widget-content",n},getHeaderButtonHolder:function(){var n=this.getButtonHolder();return n.style.marginLeft="10px",n.style.fontSize=".6em",n.style.display="inline-block",n},getFormInputDescription:function(n){var t=this.getDescription(n);return t.style.marginLeft="10px",t.style.display="inline-block",t},getFormControl:function(n,t,i){var r=this._super(n,t,i);return t.type==="checkbox"?(r.style.lineHeight="25px",r.style.padding="3px 0"):r.style.padding="4px 0 8px 0",r},getDescription:function(n){var t=document.createElement("span");return t.style.fontSize=".8em",t.style.fontStyle="italic",t.textContent=n,t},getButtonHolder:function(){var n=document.createElement("div");return n.className="ui-buttonset",n.style.fontSize=".7em",n},getFormInputLabel:function(n){var t=document.createElement("label");return t.style.fontWeight="bold",t.style.display="block",t.textContent=n,t},getButton:function(n,t,i){var r=document.createElement("button"),u;return r.className="ui-button ui-widget ui-state-default ui-corner-all",t&&!n?(r.className+=" ui-button-icon-only",t.className+=" ui-button-icon-primary ui-icon-primary",r.appendChild(t)):t?(r.className+=" ui-button-text-icon-primary",t.className+=" ui-button-icon-primary ui-icon-primary",r.appendChild(t)):r.className+=" ui-button-text-only",u=document.createElement("span"),u.className="ui-button-text",u.textContent=n||i||".",r.appendChild(u),r.setAttribute("title",i),r},setButtonText:function(n,t,i,r){n.innerHTML="";n.className="ui-button ui-widget ui-state-default ui-corner-all";i&&!t?(n.className+=" ui-button-icon-only",i.className+=" ui-button-icon-primary ui-icon-primary",n.appendChild(i)):i?(n.className+=" ui-button-text-icon-primary",i.className+=" ui-button-icon-primary ui-icon-primary",n.appendChild(i)):n.className+=" ui-button-text-only";var u=document.createElement("span");u.className="ui-button-text";u.textContent=t||r||".";n.appendChild(u);n.setAttribute("title",r)},getIndentedPanel:function(){var n=document.createElement("div");return n.className="ui-widget-content ui-corner-all",n.style.padding="1em 1.4em",n.style.marginBottom="20px",n},afterInputReady:function(n){n.controls||(n.controls=this.closest(n,".form-control"))},addInputError:function(n,t){n.controls&&(n.errmsg?n.errmsg.style.display="":(n.errmsg=document.createElement("div"),n.errmsg.className="ui-state-error",n.controls.appendChild(n.errmsg)),n.errmsg.textContent=t)},removeInputError:function(n){n.errmsg&&(n.errmsg.style.display="none")},markTabActive:function(n){n.className=n.className.replace(/\s*ui-widget-header/g,"")+" ui-state-active"},markTabInactive:function(n){n.className=n.className.replace(/\s*ui-state-active/g,"")+" ui-widget-header"}});n.AbstractIconLib=Class.extend({mapping:{collapse:"",expand:"","delete":"",edit:"",add:"",cancel:"",save:"",moveup:"",movedown:""},icon_prefix:"",getIconClass:function(n){return this.mapping[n]?this.icon_prefix+this.mapping[n]:null},getIcon:function(n){var i=this.getIconClass(n),t;return i?(t=document.createElement("i"),t.className=i,t):null}});n.defaults.iconlibs.bootstrap2=n.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-up","delete":"trash",edit:"pencil",add:"plus",cancel:"ban-circle",save:"ok",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"});n.defaults.iconlibs.bootstrap3=n.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right","delete":"remove",edit:"pencil",add:"plus",cancel:"floppy-remove",save:"floppy-saved",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"glyphicon glyphicon-"});n.defaults.iconlibs.fontawesome3=n.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right","delete":"remove",edit:"pencil",add:"plus",cancel:"ban-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"});n.defaults.iconlibs.fontawesome4=n.AbstractIconLib.extend({mapping:{collapse:"caret-square-o-down",expand:"caret-square-o-right","delete":"times",edit:"pencil",add:"plus",cancel:"ban",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fa fa-"});n.defaults.iconlibs.foundation2=n.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus","delete":"remove",edit:"edit",add:"add-doc",cancel:"error",save:"checkmark",moveup:"up-arrow",movedown:"down-arrow"},icon_prefix:"foundicon-"});n.defaults.iconlibs.foundation3=n.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus","delete":"x",edit:"pencil",add:"page-add",cancel:"x-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fi-"});n.defaults.iconlibs.jqueryui=n.AbstractIconLib.extend({mapping:{collapse:"triangle-1-s",expand:"triangle-1-e","delete":"trash",edit:"pencil",add:"plusthick",cancel:"closethick",save:"disk",moveup:"arrowthick-1-n",movedown:"arrowthick-1-s"},icon_prefix:"ui-icon ui-icon-"});n.defaults.templates.default=function(){var n=function(r){var u={};return t(r,function(r,f){if(typeof f=="object"&&f!==null){var e={};t(f,function(n,t){e[r+"."+n]=t});i(u,n(e))}else u[r]=f}),u};return{compile:function(i){return function(r){var f=n(r),u=i+"";return t(f,function(n,t){u=u.replace(new RegExp("{{\\s*"+n+"\\s*}}","g"),t)}),u}}}};n.defaults.templates.ejs=function(){return window.EJS?{compile:function(n){var t=new EJS({text:n});return function(n){return t.render(n)}}}:!1};n.defaults.templates.handlebars=function(){return window.Handlebars};n.defaults.templates.hogan=function(){return window.Hogan?{compile:function(n){var t=Hogan.compile(n);return function(n){return t.render(n)}}}:!1};n.defaults.templates.markup=function(){return!window.Mark||!window.Mark.up?!1:{compile:function(n){return function(t){return Mark.up(n,t)}}}};n.defaults.templates.mustache=function(){return window.Mustache?{compile:function(n){return function(t){return Mustache.render(n,t)}}}:!1};n.defaults.templates.swig=function(){return window.swig};n.defaults.templates.underscore=function(){return window._?{compile:function(n){return function(t){return _.template(n,t)}}}:!1};n.defaults.theme="html";n.defaults.template="default";n.defaults.options={};n.plugins={ace:{theme:""},epiceditor:{},sceditor:{}};for(u in n.defaults.editors)n.defaults.editors.hasOwnProperty(u)&&(n.defaults.editors[u].options=n.defaults.editors.options||{});n.defaults.resolvers.unshift(function(n){if(typeof n.type!="string")return"multiple"});n.defaults.resolvers.unshift(function(n){if(typeof n.type=="string")return n.type});n.defaults.resolvers.unshift(function(n){if(n.type==="boolean")return"select"});n.defaults.resolvers.unshift(function(n){if(n.type==="any")return"multiple"});n.defaults.resolvers.unshift(function(n){if(n.type==="string"&&n.media&&n.media.binaryEncoding==="base64")return"base64"});n.defaults.resolvers.unshift(function(n){if(n.type=="array"&&n.format=="table")return"table"});n.defaults.resolvers.unshift(function(n){if(n.enum){if(n.type==="array"||n.type==="object")return"enum";if(n.type==="number"||n.type==="integer"||n.type==="string")return"select"}});n.defaults.resolvers.unshift(function(n){if(n.type==="array"&&n.items&&!(n.items instanceof Array)&&n.uniqueItems&&n.items.enum&&["string","number","integer"].indexOf(n.items.type)>=0)return"multiselect"});n.defaults.resolvers.unshift(function(n){if(n.oneOf)return"multiple"});(window.jQuery||window.Zepto)&&(window.$=window.$||{},$.jsoneditor=n.defaults,(window.jQuery||window.Zepto).fn.jsoneditor=function(t){var r=this,i=this.data("jsoneditor");if(t==="value"){if(!i)throw"Must initialize jsoneditor before getting/setting the value";if(arguments.length>1)i.setValue(arguments[1]);else return i.getValue()}else{if(t==="validate"){if(!i)throw"Must initialize jsoneditor before validating";return arguments.length>1?i.validate(arguments[1]):i.validate()}if(t==="destroy")i&&(i.destroy(),this.data("jsoneditor",null));else{i&&i.destroy();i=new n(this.get(0),t);this.data("jsoneditor",i);i.on("change",function(){r.trigger("change")});i.on("ready",function(){r.trigger("ready")})}}return this});window.JSONEditor=n})();!function(){function al(n){return n&&(n.ownerDocument||n.document||n).documentElement}function bt(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function gi(n,t){return t>n?-1:n>t?1:n>=t?0:NaN}function oi(n){return null===n?NaN:+n}function lt(n){return!isNaN(n)}function vl(n){return{left:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;n(t[f],i)<0?r=f+1:u=f}return r},right:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;n(t[f],i)>0?u=f:r=f+1}return r}}}function ek(n){return n.length}function ok(n){for(var t=1;n*t%1;)t*=10;return t}function yl(n,t){for(var i in t)Object.defineProperty(n.prototype,i,{value:t[i],enumerable:!1})}function at(){this._=Object.create(null)}function lr(n){return(n+="")===ib||n[0]===te?te+n:n}function yu(n){return(n+="")[0]===te?n.slice(1):n}function pl(n){return lr(n)in this._}function wl(n){return(n=lr(n))in this._&&delete this._[n]}function bl(){var n=[];for(var t in this._)n.push(yu(t));return n}function kl(){var n=0;for(var t in this._)++n;return n}function dl(){for(var n in this._)return!1;return!0}function oo(){this._=Object.create(null)}function v(n){return n}function sk(n,t,i){return function(){var r=i.apply(t,arguments);return r===t?n:r}}function so(n,t){var i,u,r;if(t in n)return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0,u=tc.length;u>i;++i)if(r=tc[i]+t,r in n)return r}function l(){}function ho(){}function gl(n){function r(){for(var i,r=t,u=-1,f=r.length;++u<f;)(i=r[u].on)&&i.apply(this,arguments);return n}var t=[],i=new at;return r.on=function(r,u){var e,f=i.get(r);return arguments.length<2?f&&f.on:(f&&(f.on=null,t=t.slice(0,e=t.indexOf(f)).concat(t.slice(e+1)),i.remove(r)),u&&t.push(i.set(r,{on:u})),n)},r}function kt(){n.event.preventDefault()}function co(){for(var i,t=n.event;i=t.sourceEvent;)t=i;return t}function lo(t){for(var i=new ho,r=0,u=arguments.length;++r<u;)i[arguments[r]]=gl(i);return i.of=function(r,u){return function(f){try{var e=f.sourceEvent=n.event;f.target=t;n.event=f;i[f.type].apply(r,u)}finally{n.event=e}}},i}function dt(n){return ie(n,e),n}function ao(n){return"function"==typeof n?n:function(){return ic(n,this)}}function na(n){return"function"==typeof n?n:function(){return rc(n,this)}}function ta(t,i){function r(){this.removeAttribute(t)}function u(){this.removeAttributeNS(t.space,t.local)}function f(){this.setAttribute(t,i)}function e(){this.setAttributeNS(t.space,t.local,i)}function o(){var n=i.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=i.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=n.ns.qualify(t),null==i?t.local?u:r:"function"==typeof i?t.local?s:o:t.local?e:f}function ia(n){return n.trim().replace(/\s+/g," ")}function ra(t){return new RegExp("(?:^|\\s+)"+n.requote(t)+"(?:\\s+|$)","g")}function ua(n){return(n+"").trim().split(/^|\s+/)}function fa(n,t){function r(){for(var r=-1;++r<i;)n[r](this,t)}function u(){for(var r=-1,u=t.apply(this,arguments);++r<i;)n[r](this,u)}n=ua(n).map(hk);var i=n.length;return"function"==typeof t?u:r}function hk(n){var t=ra(n);return function(i,r){if(u=i.classList)return r?u.add(n):u.remove(n);var u=i.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||i.setAttribute("class",ia(u+" "+n))):i.setAttribute("class",ia(u.replace(t," ")))}}function ea(n,t,i){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,i)}function f(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,i)}return null==t?r:"function"==typeof t?f:u}function oa(n,t){function i(){delete this[n]}function r(){this[n]=t}function u(){var i=t.apply(this,arguments);null==i?delete this[n]:this[n]=i}return null==t?i:"function"==typeof t?u:r}function sa(t){function i(){var n=this.ownerDocument,i=this.namespaceURI;return i?n.createElementNS(i,t):n.createElement(t)}function r(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=n.ns.qualify(t)).local?r:i}function ck(){var n=this.parentNode;n&&n.removeChild(this)}function vo(n){return{__data__:n}}function ha(n){return function(){return uc(this,n)}}function lk(n){return arguments.length||(n=gi),function(t,i){return t&&i?n(t.__data__,i.__data__):!t-!i}}function vt(n,t){for(var i=0,u=n.length;u>i;i++)for(var f,e=n[i],r=0,o=e.length;o>r;r++)(f=e[r])&&t(f,r,i);return n}function ca(n){return ie(n,st),n}function ak(n){var t,i;return function(r,u,f){var e,o=n[f].update,s=o.length;for(f!=i&&(i=f,t=0),u>=t&&(t=u+1);!(e=o[t])&&++t<s;);return e}}function la(t,i,r){function o(){var n=this[u];n&&(this.removeEventListener(t,n,n.$),delete this[u])}function h(){var n=s(i,ot(arguments));o.call(this);this.addEventListener(t,this[u]=n,n.$=r);n._=i}function c(){var u,f=new RegExp("^__on([^.]+)"+n.requote(t)+"$"),i,r;for(i in this)(u=i.match(f))&&(r=this[i],this.removeEventListener(u[1],r,r.$),delete this[i])}var u="__on"+t,f=t.indexOf("."),s=aa,e;return f>0&&(t=t.slice(0,f)),e=ue.get(t),e&&(t=e,s=vk),f?i?h:o:i?l:c}function aa(t,i){return function(r){var u=n.event;n.event=r;i[0]=this.__data__;try{t.apply(this,i)}finally{n.event=u}}}function vk(n,t){var i=aa(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||i.call(t,n)}}function pu(t){var i=".dragsuppress-"+ ++rb,f="click"+i,u=n.select(bt(t)).on("touchmove"+i,kt).on("dragstart"+i,kt).on("selectstart"+i,kt),r,e;return(null==yi&&(yi="onselectstart"in t?!1:so(t.style,"userSelect")),yi)&&(r=al(t).style,e=r[yi],r[yi]="none"),function(n){if(u.on(i,null),yi&&(r[yi]=e),n){var t=function(){u.on(f,null)};u.on(f,function(){kt();t()},!0);setTimeout(t,0)}}}function yo(t,i){var u,r,f,e,o;return(i.changedTouches&&(i=i.changedTouches[0]),u=t.ownerSVGElement||t,u.createSVGPoint)?(r=u.createSVGPoint(),0>fe&&(f=bt(t),(f.scrollX||f.scrollY)&&(u=n.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),e=u[0][0].getScreenCTM(),fe=!(e.f||e.e),u.remove())),fe?(r.x=i.pageX,r.y=i.pageY):(r.x=i.clientX,r.y=i.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]):(o=t.getBoundingClientRect(),[i.clientX-o.left-t.clientLeft,i.clientY-o.top-t.clientTop])}function yk(){return n.event.changedTouches[0].identifier}function va(n){return n>0?1:0>n?-1:0}function po(n,t,i){return(t[0]-n[0])*(i[1]-n[1])-(t[1]-n[1])*(i[0]-n[0])}function ya(n){return n>1?0:-1>n?f:Math.acos(n)}function gt(n){return n>1?h:-1>n?-h:Math.asin(n)}function pk(n){return((n=Math.exp(n))-1/n)/2}function pa(n){return((n=Math.exp(n))+1/n)/2}function wk(n){return((n=Math.exp(2*n))-1)/(n+1)}function wa(n){return(n=Math.sin(n/2))*n}function si(){}function ft(n,t,i){return this instanceof ft?(this.h=+n,this.s=+t,void(this.l=+i)):arguments.length<2?n instanceof ft?new ft(n.h,n.s,n.l):ga(""+n,nv,ft):new ft(n,t,i)}function wo(n,t,i){function e(n){return n>360?n-=360:0>n&&(n+=360),60>n?r+(u-r)*n/60:180>n?u:240>n?r+(u-r)*(240-n)/60:r}function f(n){return Math.round(255*e(n))}var r,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,i=0>i?0:i>1?1:i,u=.5>=i?i*(1+t):i+t-i*t,r=2*i-u,new b(f(n+120),f(n),f(n-120))}function nt(t,i,r){return this instanceof nt?(this.h=+t,this.c=+i,void(this.l=+r)):arguments.length<2?t instanceof nt?new nt(t.h,t.c,t.l):t instanceof tt?ka(t.l,t.a,t.b):ka((t=tv((t=n.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new nt(t,i,r)}function bo(n,t,i){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new tt(i,Math.cos(n*=u)*t,Math.sin(n)*t)}function tt(n,t,i){return this instanceof tt?(this.l=+n,this.a=+t,void(this.b=+i)):arguments.length<2?n instanceof tt?new tt(n.l,n.a,n.b):n instanceof nt?bo(n.h,n.c,n.l):tv((n=b(n)).r,n.g,n.b):new tt(n,t,i)}function ba(n,t,i){var r=(n+16)/116,u=r+t/500,f=r-i/200;return u=ko(u)*fb,r=ko(r)*eb,f=ko(f)*ob,new b(ns(3.2404542*u-1.5371385*r-.4985314*f),ns(-.969266*u+1.8760108*r+.041556*f),ns(.0556434*u-.2040259*r+1.0572252*f))}function ka(n,t,i){return n>0?new nt(Math.atan2(i,t)*s,Math.sqrt(t*t+i*i),n):new nt(NaN,NaN,n)}function ko(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function go(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function ns(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function b(n,t,i){return this instanceof b?(this.r=~~n,this.g=~~t,void(this.b=~~i)):arguments.length<2?n instanceof b?new b(n.r,n.g,n.b):ga(""+n,b,wo):new b(n,t,i)}function da(n){return new b(n>>16,n>>8&255,255&n)}function wu(n){return da(n)+""}function nr(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function ga(n,t,i){var s,u,r,f=0,e=0,o=0;if(s=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()))switch(u=s[2].split(","),s[1]){case"hsl":return i(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(is(u[0]),is(u[1]),is(u[2]))}return(r=eu.get(n))?t(r.r,r.g,r.b):(null==n||"#"!==n.charAt(0)||isNaN(r=parseInt(n.slice(1),16))||(4===n.length?(f=(3840&r)>>4,f=f>>4|f,e=240&r,e=e>>4|e,o=15&r,o=o<<4|o):7===n.length&&(f=(16711680&r)>>16,e=(65280&r)>>8,o=255&r)),t(f,e,o))}function nv(n,t,i){var f,s,e=Math.min(n/=255,t/=255,i/=255),r=Math.max(n,t,i),u=r-e,o=(r+e)/2;return u?(s=.5>o?u/(r+e):u/(2-r-e),f=n==r?(t-i)/u+(i>t?6:0):t==r?(i-n)/u+2:(n-t)/u+4,f*=60):(f=NaN,s=o>0&&1>o?0:f),new ft(f,s,o)}function tv(n,t,i){n=ts(n);t=ts(t);i=ts(i);var u=go((.4124564*n+.3575761*t+.1804375*i)/fb),r=go((.2126729*n+.7151522*t+.072175*i)/eb),f=go((.0193339*n+.119192*t+.9503041*i)/ob);return tt(116*r-16,500*(u-r),200*(r-f))}function ts(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function is(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function o(n){return"function"==typeof n?n:function(){return n}}function rs(n){return function(t,i,r){return 2===arguments.length&&"function"==typeof i&&(r=i,i=null),bu(t,i,n,r)}}function bu(t,i,r,u){function c(){var t,n=e.status;if(!n&&kk(e)||n>=200&&300>n||304===n){try{t=r.call(f,e)}catch(i){return void s.error.call(f,i)}s.load.call(f,t)}else s.error.call(f,e)}var f={},s=n.dispatch("beforesend","progress","load","error"),o={},e=new XMLHttpRequest,h=null;return!this.XDomainRequest||"withCredentials"in e||!/^(http(s)?:)?\/\//.test(t)||(e=new XDomainRequest),"onload"in e?e.onload=e.onerror=c:e.onreadystatechange=function(){e.readyState>3&&c()},e.onprogress=function(t){var i=n.event;n.event=t;try{s.progress.call(f,e)}finally{n.event=i}},f.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?o[n]:(null==t?delete o[n]:o[n]=t+"",f)},f.mimeType=function(n){return arguments.length?(i=null==n?null:n+"",f):i},f.responseType=function(n){return arguments.length?(h=n,f):h},f.response=function(n){return r=n,f},["get","post"].forEach(function(n){f[n]=function(){return f.send.apply(f,[n].concat(ot(arguments)))}}),f.send=function(n,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),e.open(n,t,!0),null==i||"accept"in o||(o.accept=i+",*/*"),e.setRequestHeader)for(var c in o)e.setRequestHeader(c,o[c]);return null!=i&&e.overrideMimeType&&e.overrideMimeType(i),null!=h&&(e.responseType=h),null!=u&&f.on("error",u).on("load",function(n){u(null,n)}),s.beforesend.call(f,e),e.send(null==r?null:r),f},f.abort=function(){return e.abort(),f},n.rebind(f,s,"on"),null==u?f:f.get(bk(u))}function bk(n){return 1===n.length?function(t,i){n(null==t?i:null)}:n}function kk(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function ku(n,t,i){var u=arguments.length,f,r;return 2>u&&(t=0),3>u&&(i=Date.now()),f=i+t,r={c:n,t:f,n:null},ae?ae.n=r:le=r,ae=r,ve||(ye=clearTimeout(ye),ve=1,hc(us)),r}function us(){var t=iv(),n=rv()-t;n>24?(isFinite(n)&&(clearTimeout(ye),ye=setTimeout(us,n)),ve=0):(ve=1,hc(us))}function iv(){for(var t=Date.now(),n=le;n;)t>=n.t&&n.c(t-n.t)&&(n.c=null),n=n.n;return t}function rv(){for(var t,n=le,i=1/0;n;)n.c?(n.t<i&&(i=n.t),n=(t=n).n):n=t?t.n=n.n:le=n.n;return ae=t,i}function fs(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function dk(n,t){var i=Math.pow(10,3*r(8-t));return{scale:t>8?function(n){return n/i}:function(n){return n*i},symbol:n}}function gk(t){var e=t.decimal,r=t.thousands,i=t.grouping,u=t.currency,f=i&&r?function(n,t){for(var f=n.length,o=[],s=0,u=i[0],e=0;f>0&&u>0&&(e+u+1>t&&(u=Math.max(1,t-e)),o.push(n.substring(f-=u,f+u)),!((e+=u+1)>t));)u=i[s=(s+1)%i.length];return o.reverse().join(r)}:v;return function(t){var o=hb.exec(t),y=o[1]||" ",s=o[2]||">",b=o[3]||"-",k=o[4]||"",l=o[5],p=+o[6],w=o[7],r=o[8],i=o[9],h=1,a="",c="",d=!1,g=!0,v;switch(r&&(r=+r.substring(1)),(l||"0"===y&&"="===s)&&(l=y="0",s="="),i){case"n":w=!0;i="g";break;case"%":h=100;c="%";i="f";break;case"p":h=100;c="%";i="r";break;case"b":case"o":case"x":case"X":"#"===k&&(a="0"+i.toLowerCase());case"c":g=!1;case"d":d=!0;r=0;break;case"s":h=-1;i="r"}return"$"===k&&(a=u[0],c=u[1]),"r"!=i||r||(i="g"),null!=r&&("g"==i?r=Math.max(1,Math.min(21,r)):("e"==i||"f"==i)&&(r=Math.max(0,Math.min(20,r)))),i=rut.get(i)||nd,v=l&&w,function(t){var ft=c,k,ut,u,nt,it,rt,tt,o;return d&&t%1?"":(k=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===b?"":b,0>h?(ut=n.formatPrefix(t,r),t=ut.scale(t),ft=ut.symbol+c):t*=h,t=i(t,r),it=t.lastIndexOf("."),0>it?(rt=g?t.lastIndexOf("e"):-1,0>rt?(u=t,nt=""):(u=t.substring(0,rt),nt=t.substring(rt))):(u=t.substring(0,it),nt=e+t.substring(it+1)),!l&&w&&(u=f(u,1/0)),tt=a.length+u.length+nt.length+(v?0:k.length),o=p>tt?new Array(tt=p-tt+1).join(y):"",v&&(u=f(o+u,o.length?p-nt.length:1/0)),k+=a,t=u+nt,("<"===s?k+t+o:">"===s?o+k+t:"^"===s?o.substring(0,tt>>=1)+k+t+o.substring(tt):k+(v?t:o+t))+ft)}}}function nd(n){return n+""}function yt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function hi(n,t,i){function e(t){var i=n(t),r=f(i,1);return r-t>t-i?i:r}function u(i){return t(i=n(new y(i-1)),1),i}function f(n,i){return t(n=new y(+n),i),n}function o(n,r,f){var e=u(n),o=[];if(f>1)for(;r>e;)i(e)%f||o.push(new Date(+e)),t(e,1);else for(;r>e;)o.push(new Date(+e)),t(e,1);return o}function s(n,t,i){try{y=yt;var r=new yt;return r._=n,o(r,t,i)}finally{y=Date}}n.floor=n;n.round=e;n.ceil=u;n.offset=f;n.range=o;var r=n.utc=du(n);return r.floor=r,r.round=du(e),r.ceil=du(u),r.offset=du(f),r.range=s,n}function du(n){return function(t,i){try{y=yt;var r=new yt;return r._=t,n(r,i)._}finally{y=Date}}}function td(t){function r(n){function t(t){for(var f,o,h,e=[],r=-1,s=0;++r<i;)37===n.charCodeAt(r)&&(e.push(n.slice(s,r)),null!=(o=cb[f=n.charAt(++r)])&&(f=n.charAt(++r)),(h=u[f])&&(f=h(t,null==o?"e"===f?" ":"0":o)),e.push(f),s=r+1);return e.push(n.slice(s,r)),e.join("")}var i=n.length;return t.parse=function(t){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=f(i,n,t,0),u,r;return e!=t.length?null:("p"in i&&(i.H=i.H%12+12*i.p),u=null!=i.Z&&y!==yt,r=new(u?yt:y),"j"in i?r.setFullYear(i.y,0,i.j):"W"in i||"U"in i?("w"in i||(i.w="W"in i?1:0),r.setFullYear(i.y,0,1),r.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(r.getDay()+5)%7:i.w+7*i.U-(r.getDay()+6)%7)):r.setFullYear(i.y,i.m,i.d),r.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),u?r._:r)},t.toString=function(){return n},t}function f(n,t,i,r){for(var f,e,o,u=0,s=t.length,h=i.length;s>u;){if(r>=h)return-1;if(f=t.charCodeAt(u++),37===f){if(o=t.charAt(u++),e=k[o in cb?t.charAt(u++):o],!e||(r=e(n,i,r))<0)return-1}else if(f!=i.charCodeAt(r++))return-1}return r}function d(n,t,i){v.lastIndex=0;var r=v.exec(t.slice(i));return r?(n.w=ct.get(r[0].toLowerCase()),i+r[0].length):-1}function g(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i));return r?(n.w=ht.get(r[0].toLowerCase()),i+r[0].length):-1}function nt(n,t,i){b.lastIndex=0;var r=b.exec(t.slice(i));return r?(n.m=at.get(r[0].toLowerCase()),i+r[0].length):-1}function tt(n,t,i){p.lastIndex=0;var r=p.exec(t.slice(i));return r?(n.m=lt.get(r[0].toLowerCase()),i+r[0].length):-1}function it(n,t,i){return f(n,u.c.toString(),t,i)}function rt(n,t,i){return f(n,u.x.toString(),t,i)}function ut(n,t,i){return f(n,u.X.toString(),t,i)}function ft(n,t,i){var r=l.get(t.slice(i,i+=2).toLowerCase());return null==r?-1:(n.p=r,i)}var et=t.dateTime,ot=t.date,st=t.time,c=t.periods,e=t.days,o=t.shortDays,s=t.months,h=t.shortMonths,u,k;r.utc=function(n){function t(n){try{y=yt;var t=new y;return t._=n,i(t)}finally{y=Date}}var i=r(n);return t.parse=function(n){try{y=yt;var t=i.parse(n);return t&&t._}finally{y=Date}},t.toString=i.toString,t};r.multi=r.utc.multi=wd;var l=n.map(),a=gu(e),ht=nf(e),v=gu(o),ct=nf(o),p=gu(s),lt=nf(s),b=gu(h),at=nf(h);return c.forEach(function(n,t){l.set(n.toLowerCase(),t)}),u={a:function(n){return o[n.getDay()]},A:function(n){return e[n.getDay()]},b:function(n){return h[n.getMonth()]},B:function(n){return s[n.getMonth()]},c:r(et),d:function(n,t){return w(n.getDate(),t,2)},e:function(n,t){return w(n.getDate(),t,2)},H:function(n,t){return w(n.getHours(),t,2)},I:function(n,t){return w(n.getHours()%12||12,t,2)},j:function(n,t){return w(1+i.dayOfYear(n),t,3)},L:function(n,t){return w(n.getMilliseconds(),t,3)},m:function(n,t){return w(n.getMonth()+1,t,2)},M:function(n,t){return w(n.getMinutes(),t,2)},p:function(n){return c[+(n.getHours()>=12)]},S:function(n,t){return w(n.getSeconds(),t,2)},U:function(n,t){return w(i.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return w(i.mondayOfYear(n),t,2)},x:r(ot),X:r(st),y:function(n,t){return w(n.getFullYear()%100,t,2)},Y:function(n,t){return w(n.getFullYear()%1e4,t,4)},Z:yd,"%":function(){return"%"}},k={a:d,A:g,b:nt,B:tt,c:it,d:uv,e:uv,H:fv,I:fv,j:cd,L:vd,m:hd,M:ld,p:ft,S:ad,U:rd,w:id,W:ud,x:rt,X:ut,y:ed,Y:fd,Z:od,"%":pd},r}function w(n,t,i){var u=0>n?"-":"",r=(u?-n:n)+"",f=r.length;return u+(i>f?new Array(i-f+1).join(t)+r:r)}function gu(t){return new RegExp("^(?:"+t.map(n.requote).join("|")+")","i")}function nf(n){for(var i=new at,t=-1,r=n.length;++t<r;)i.set(n[t].toLowerCase(),t);return i}function id(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+1));return r?(n.w=+r[0],i+r[0].length):-1}function rd(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i));return r?(n.U=+r[0],i+r[0].length):-1}function ud(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i));return r?(n.W=+r[0],i+r[0].length):-1}function fd(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+4));return r?(n.y=+r[0],i+r[0].length):-1}function ed(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.y=sd(+r[0]),i+r[0].length):-1}function od(n,t,i){return/^[+-]\d{4}$/.test(t=t.slice(i,i+5))?(n.Z=-t,i+5):-1}function sd(n){return n+(n>68?1900:2e3)}function hd(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.m=r[0]-1,i+r[0].length):-1}function uv(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.d=+r[0],i+r[0].length):-1}function cd(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+3));return r?(n.j=+r[0],i+r[0].length):-1}function fv(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.H=+r[0],i+r[0].length):-1}function ld(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.M=+r[0],i+r[0].length):-1}function ad(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+2));return r?(n.S=+r[0],i+r[0].length):-1}function vd(n,t,i){c.lastIndex=0;var r=c.exec(t.slice(i,i+3));return r?(n.L=+r[0],i+r[0].length):-1}function yd(n){var t=n.getTimezoneOffset(),i=t>0?"-":"+",u=r(t)/60|0,f=r(t)%60;return i+w(u,"0",2)+w(f,"0",2)}function pd(n,t,i){lb.lastIndex=0;var r=lb.exec(t.slice(i,i+1));return r?i+r[0].length:-1}function wd(n){for(var i=n.length,t=-1;++t<i;)n[t][0]=this(n[t][0]);return function(t){for(var r=0,i=n[r];!i[1](t);)i=n[++r];return i[0](t)}}function es(){}function ev(n,t,i){var r=i.s=n+t,u=r-n,f=r-u;i.t=n-f+(t-u)}function tf(n,t){n&&ac.hasOwnProperty(n.type)&&ac[n.type](n,t)}function os(n,t,i){var r,u=-1,f=n.length-i;for(t.lineStart();++u<f;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function ov(n,t){var i=-1,r=n.length;for(t.polygonStart();++i<r;)os(n[i],t,1);t.polygonEnd()}function bd(){function r(r,e){r*=u;e=e*u/2+f/4;var o=r-n,s=o>=0?1:-1,h=s*o,c=Math.cos(e),l=Math.sin(e),a=i*l,v=t*c+a*Math.cos(h),y=a*s*Math.sin(h);ti.add(Math.atan2(y,v));n=r;t=c;i=l}var e,o,n,t,i;k.point=function(s,h){k.point=r;n=(e=s)*u;t=Math.cos(h=(o=h)*u/2+f/4);i=Math.sin(h)};k.lineEnd=function(){r(e,o)}}function ci(n){var t=n[0],i=n[1],r=Math.cos(i);return[r*Math.cos(t),r*Math.sin(t),Math.sin(i)]}function rf(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function tr(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function ss(n,t){n[0]+=t[0];n[1]+=t[1];n[2]+=t[2]}function uf(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function ff(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t;n[1]/=t;n[2]/=t}function ef(n){return[Math.atan2(n[1],n[0]),gt(n[2])]}function of(n,i){return r(n[0]-i[0])<t&&r(n[1]-i[1])<t}function hs(n,t){n*=u;var i=Math.cos(t*=u);ar(i*Math.cos(n),i*Math.sin(n),Math.sin(t))}function ar(n,t,i){++su;pi+=(n-pi)/su;wi+=(t-wi)/su;wt+=(i-wt)/su}function sv(){function r(r,f){r*=u;var c=Math.cos(f*=u),o=c*Math.cos(r),s=c*Math.sin(r),h=Math.sin(f),e=Math.atan2(Math.sqrt((e=t*h-i*s)*e+(e=i*o-n*h)*e+(e=n*s-t*o)*e),n*o+t*s+i*h);we+=e;ii+=e*(n+(n=o));ri+=e*(t+(t=s));ct+=e*(i+(i=h));ar(n,t,i)}var n,t,i;rt.point=function(f,e){f*=u;var o=Math.cos(e*=u);n=o*Math.cos(f);t=o*Math.sin(f);i=Math.sin(e);rt.point=r;ar(n,t,i)}}function hv(){rt.point=hs}function kd(){function r(r,f){r*=u;var p=Math.cos(f*=u),e=p*Math.cos(r),o=p*Math.sin(r),s=Math.sin(f),c=t*s-i*o,l=i*e-n*s,a=n*o-t*e,v=Math.sqrt(c*c+l*l+a*a),w=n*e+t*o+i*s,y=v&&-ya(w)/v,h=Math.atan2(v,w);or+=y*c;sr+=y*l;ui+=y*a;we+=h;ii+=h*(n+(n=e));ri+=h*(t+(t=o));ct+=h*(i+(i=s));ar(n,t,i)}var f,e,n,t,i;rt.point=function(o,s){f=o;e=s;rt.point=r;o*=u;var h=Math.cos(s*=u);n=h*Math.cos(o);t=h*Math.sin(o);i=Math.sin(s);ar(n,t,i)};rt.lineEnd=function(){r(f,e);rt.lineEnd=hv;rt.point=hs}}function cv(n,t){function i(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(i.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),i}function vr(){return!0}function lv(n,t,i,r,u){var h=[],s=[],o,l,v,f,c,a,e;if(n.forEach(function(n){var o,i,f,e,t,r;if(!((o=n.length-1)<=0)){if(i=n[0],f=n[o],of(i,f)){for(u.lineStart(),e=0;o>e;++e)u.point((i=n[e])[0],i[1]);return void u.lineEnd()}t=new sf(i,n,null,!0);r=new sf(i,null,t,!1);t.o=r;h.push(t);s.push(r);t=new sf(f,n,null,!1);r=new sf(f,null,t,!0);t.o=r;h.push(t);s.push(r)}}),s.sort(t),av(h),av(s),h.length){for(var e=0,y=i,a=s.length;a>e;++e)s[e].e=y=!y;for(v=h[0];;){for(f=v,c=!0;f.v;)if((f=f.n)===v)return;o=f.z;u.lineStart();do{if(f.v=f.o.v=!0,f.e){if(c)for(e=0,a=o.length;a>e;++e)u.point((l=o[e])[0],l[1]);else r(f.x,f.n.x,1,u);f=f.n}else{if(c)for(o=f.p.z,e=o.length-1;e>=0;--e)u.point((l=o[e])[0],l[1]);else r(f.x,f.p.x,-1,u);f=f.p}f=f.o;o=f.z;c=!c}while(!f.v);u.lineEnd()}}}function av(n){if(r=n.length){for(var r,t,u=0,i=n[0];++u<r;)i.n=t=n[u],t.p=i,i=t;i.n=t=n[0];t.p=i}}function sf(n,t,i,r){this.x=n;this.z=t;this.o=i;this.e=r;this.v=!1;this.n=this.p=null}function vv(t,i,r,u){return function(f,e){function v(n,i){var r=f(n,i);t(n=r[0],i=r[1])&&e.point(n,i)}function d(n,t){var i=f(n,t);y.point(i[0],i[1])}function p(){o.point=d;y.lineStart()}function w(){o.point=v;y.lineEnd()}function b(n,t){c.push([n,t]);var i=f(n,t);a.point(i[0],i[1])}function g(){a.lineStart();c=[]}function nt(){var f,t,r;b(c[0][0],c[0][1]);a.lineEnd();var i,u=a.clean(),n=k.buffer(),t=n.length;if(c.pop(),l.push(c),c=null,t)if(1&u){if(i=n[0],t=i.length-1,r=-1,t>0){for(s||(e.polygonStart(),s=!0),e.lineStart();++r<t;)e.point((f=i[r])[0],f[1]);e.lineEnd()}}else t>1&&2&u&&n.push(n.pop().concat(n.shift())),h.push(n.filter(dd))}var h,l,c,y=i(e),tt=f.invert(u[0],u[1]),o={point:v,lineStart:p,lineEnd:w,polygonStart:function(){o.point=b;o.lineStart=g;o.lineEnd=nt;h=[];l=[]},polygonEnd:function(){o.point=v;o.lineStart=p;o.lineEnd=w;h=n.merge(h);var t=rg(tt,l);h.length?(s||(e.polygonStart(),s=!0),lv(h,gd,t,r,e)):t&&(s||(e.polygonStart(),s=!0),e.lineStart(),r(null,null,1,e),e.lineEnd());s&&(e.polygonEnd(),s=!1);h=l=null},sphere:function(){e.polygonStart();e.lineStart();r(null,null,1,e);e.lineEnd();e.polygonEnd()}},k=yv(),a=i(k),s=!1;return o}}function dd(n){return n.length>1}function yv(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,i){t.push([n,i])},lineEnd:l,buffer:function(){var i=n;return n=[],t=null,i},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function gd(n,i){return((n=n.x)[0]<0?n[1]-h-t:h-n[1])-((i=i.x)[0]<0?i[1]-h-t:h-i[1])}function ng(n){var o,u=NaN,i=NaN,e=NaN;return{lineStart:function(){n.lineStart();o=1},point:function(s,c){var l=s>0?f:-f,a=r(s-u);r(a-f)<t?(n.point(u,i=(i+c)/2>0?h:-h),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(l,i),n.point(s,i),o=0):e!==l&&a>=f&&(r(u-e)<t&&(u-=e*t),r(s-l)<t&&(s-=l*t),i=tg(u,i,s,c),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(l,i),o=0);n.point(u=s,i=c);e=l},lineEnd:function(){n.lineEnd();u=i=NaN},clean:function(){return 2-o}}}function tg(n,i,u,f){var e,o,s=Math.sin(n-u);return r(s)>t?Math.atan((Math.sin(i)*(o=Math.cos(f))*Math.sin(u)-Math.sin(f)*(e=Math.cos(i))*Math.sin(n))/(e*o*s)):(i+f)/2}function ig(n,i,u,e){var o,s;null==n?(o=u*h,e.point(-f,o),e.point(0,o),e.point(f,o),e.point(f,0),e.point(f,-o),e.point(0,-o),e.point(-f,-o),e.point(-f,0),e.point(-f,o)):r(n[0]-i[0])>t?(s=n[0]<i[0]?f:-f,o=u*s/2,e.point(-s,o),e.point(0,o),e.point(s,o)):e.point(i[0],i[1])}function rg(n,i){var e=n[0],nt=n[1],ct=[Math.sin(e),-Math.cos(e),0],a=0,tt=0,o,it,s,v,u,k,g;for(ti.reset(),o=0,it=i.length;it>o;++o)if(s=i[o],v=s.length,v)for(var h=s[0],y=h[0],rt=h[1]/2+f/4,ut=Math.sin(rt),ft=Math.cos(rt),c=1;;){c===v&&(c=0);n=s[c];var p=n[0],et=n[1]/2+f/4,ot=Math.sin(et),st=Math.cos(et),r=p-y,w=r>=0?1:-1,b=w*r,l=b>f,ht=ut*ot;if((ti.add(Math.atan2(ht*w*Math.sin(b),ft*st+ht*Math.cos(b))),a+=l?r+w*d:r,l^y>=e^p>=e)&&(u=tr(ci(h),ci(n)),ff(u),k=tr(ct,u),ff(k),g=(l^r>=0?-1:1)*gt(k[2]),(nt>g||nt===g&&(u[0]||u[1]))&&(tt+=l^r>=0?1:-1)),!c++)break;y=p;ut=ot;ft=st;h=n}return(-t>a||t>a&&0>ti)^1&tt}function ug(n){function s(n,t){return Math.cos(n)*Math.cos(t)>i}function c(n){var i,a,r,c,u;return{lineStart:function(){c=r=!1;u=1},point:function(v,y){var w,p=[v,y],b=s(v,y),d=e?b?0:h(v,y):b?h(v+(0>v?f:-f),y):0,k;(!i&&(c=r=b)&&n.lineStart(),b!==r&&(w=o(i,p),(of(i,w)||of(p,w))&&(p[0]+=t,p[1]+=t,b=s(p[0],p[1]))),b!==r)?(u=0,b?(n.lineStart(),w=o(p,i),n.point(w[0],w[1])):(w=o(i,p),n.point(w[0],w[1]),n.lineEnd()),i=w):l&&i&&e^b&&(d&a||!(k=o(p,i,!0))||(u=0,e?(n.lineStart(),n.point(k[0][0],k[0][1]),n.point(k[1][0],k[1][1]),n.lineEnd()):(n.point(k[1][0],k[1][1]),n.lineEnd(),n.lineStart(),n.point(k[0][0],k[0][1]))));!b||i&&of(i,p)||n.point(p[0],p[1]);i=p;r=b;a=d},lineEnd:function(){r&&n.lineEnd();i=null},clean:function(){return u|(c&&r)<<1}}}function o(n,u,e){var et=ci(n),ot=ci(u),rt=[1,0,0],a=tr(et,ot),ut=rf(a,a),b=a[0],k=ut-b*b,g,o,it;if(!k)return!e&&n;var st=i*ut/k,ht=-i*b/k,ct=tr(rt,a),s=uf(rt,st),lt=uf(a,ht);ss(s,lt);var v=ct,p=rf(s,v),d=rf(v,v),ft=p*p-d*(rf(s,s)-1);if(!(0>ft)){if(g=Math.sqrt(ft),o=uf(v,(-p-g)/d),ss(o,s),o=ef(o),!e)return o;var w,h=n[0],y=u[0],c=n[1],l=u[1];h>y&&(w=h,h=y,y=w);var nt=y-h,tt=r(nt-f)<t,at=tt||t>nt;if(!tt&&c>l&&(w=c,c=l,l=w),at?tt?c+l>0^o[1]<(r(o[0]-h)<t?c:l):c<=o[1]&&o[1]<=l:nt>f^(h<=o[0]&&o[0]<=y))return it=uf(v,(-p+g)/d),ss(it,s),[o,ef(it)]}}function h(t,i){var u=e?n:f-n,r=0;return-u>t?r|=1:t>u&&(r|=2),-u>i?r|=4:i>u&&(r|=8),r}var i=Math.cos(n),e=i>0,l=r(i)>t,a=vs(n,6*u);return vv(s,c,a,e?[0,-n]:[-f,n-f])}function pv(n,t,i,r){return function(u){var f,a=u.a,v=u.b,c=a.x,l=a.y,y=v.x,p=v.y,e=0,o=1,s=y-c,h=p-l;if(f=n-c,s||!(f>0)){if(f/=s,0>s){if(e>f)return;o>f&&(o=f)}else if(s>0){if(f>o)return;f>e&&(e=f)}if(f=i-c,s||!(0>f)){if(f/=s,0>s){if(f>o)return;f>e&&(e=f)}else if(s>0){if(e>f)return;o>f&&(o=f)}if(f=t-l,h||!(f>0)){if(f/=h,0>h){if(e>f)return;o>f&&(o=f)}else if(h>0){if(f>o)return;f>e&&(e=f)}if(f=r-l,h||!(0>f)){if(f/=h,0>h){if(f>o)return;f>e&&(e=f)}else if(h>0){if(e>f)return;o>f&&(o=f)}return e>0&&(u.a={x:c+e*s,y:l+e*h}),1>o&&(u.b={x:c+o*s,y:l+o*h}),u}}}}}}function wv(i,u,f,e){function o(n,e){return r(n[0]-i)<t?e>0?0:3:r(n[0]-f)<t?e>0?2:1:r(n[1]-u)<t?e>0?1:0:e>0?3:2}function h(n,t){return s(n.x,t.x)}function s(n,t){var i=o(n,1),r=o(t,1);return i!==r?i-r:0===i?t[1]-n[1]:1===i?n[0]-t[0]:2===i?n[1]-t[1]:t[0]-n[0]}return function(t){function ft(n){for(var r=0,s=c.length,u=n[1],f=0;s>f;++f)for(var t,e=1,o=c[f],h=o.length,i=o[0];h>e;++e)t=o[e],i[1]<=u?t[1]>u&&po(i,t,n)>0&&++r:t[1]<=u&&po(i,t,n)<0&&--r,i=t;return 0!==r}function d(n,t,r,h){var c=0,l=0;if(null==n||(c=o(n,r))!==(l=o(t,r))||s(n,t)<0^r>0){do h.point(0===c||3===c?i:f,c>1?e:u);while((c=(c+r+4)%4)!==l)}else h.point(t[0],t[1])}function g(n,t){return n>=i&&f>=n&&t>=u&&e>=t}function nt(n,i){g(n,i)&&t.point(n,i)}function et(){k.point=tt;c&&c.push(v=[]);w=!0;l=!1;y=p=NaN}function ot(){r&&(tt(it,rt),ut&&l&&b.rejoin(),r.push(b.buffer()));k.point=nt;l&&t.lineEnd()}function tt(n,i){var r,u;n=Math.max(-be,Math.min(be,n));i=Math.max(-be,Math.min(be,i));r=g(n,i);(c&&v.push([n,i]),w)?(it=n,rt=i,ut=r,w=!1,r&&(t.lineStart(),t.point(n,i))):r&&l?t.point(n,i):(u={a:{x:y,y:p},b:{x:n,y:i}},ht(u)?(l||(t.lineStart(),t.point(u.a.x,u.a.y)),t.point(u.b.x,u.b.y),r||t.lineEnd(),a=!1):r&&(t.lineStart(),t.point(n,i),a=!1));y=n;p=i;l=r}var r,c,v,it,rt,ut,y,p,l,w,a,st=t,b=yv(),ht=pv(i,u,f,e),k={point:nt,lineStart:et,lineEnd:ot,polygonStart:function(){t=b;r=[];c=[];a=!0},polygonEnd:function(){t=st;r=n.merge(r);var u=ft([i,e]),f=a&&u,o=r.length;(f||o)&&(t.polygonStart(),f&&(t.lineStart(),d(null,null,1,t),t.lineEnd()),o&&lv(r,h,u,d,t),t.polygonEnd());r=c=v=null}};return k}}function cs(n){var t=0,i=f/3,r=ls(n),u=r(t,i);return u.parallels=function(n){return arguments.length?r(t=n[0]*f/180,i=n[1]*f/180):[t/f*180,i/f*180]},u}function bv(n,t){function f(n,t){var r=Math.sqrt(u-2*i*Math.sin(t))/i;return[r*Math.sin(n*=i),e-r*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),e=Math.sqrt(u)/i;return f.invert=function(n,t){var r=e-t;return[Math.atan2(n,r)/i,gt((u-(n*n+r*r)*i*i)/(2*i))]},f}function fg(){function i(i,r){yc+=t*i-n*r;n=i;t=r}var r,u,n,t;fi.point=function(f,e){fi.point=i;r=n=f;u=t=e};fi.lineEnd=function(){i(r,u)}}function eg(n,t){ke>n&&(ke=n);n>ge&&(ge=n);de>t&&(de=t);t>no&&(no=t)}function og(){function i(n,i){t.push("M",n,",",i,u)}function f(i,r){t.push("M",i,",",r);n.point=e}function e(n,i){t.push("L",n,",",i)}function r(){n.point=i}function o(){t.push("Z")}var u=kv(4.5),t=[],n={point:i,lineStart:function(){n.point=f},lineEnd:r,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=r;n.point=i},pointRadius:function(t){return u=kv(t),n},result:function(){if(t.length){var n=t.join("");return t=[],n}}};return n}function kv(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function li(n,t){pi+=n;wi+=t;++wt}function dv(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ii+=u*(n+i)/2;ri+=u*(t+r)/2;ct+=u;li(n=i,t=r)}var n,t;ut.point=function(r,u){ut.point=i;li(n=r,t=u)}}function gv(){ut.point=li}function sg(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ii+=u*(n+i)/2;ri+=u*(t+r)/2;ct+=u;u=t*i-n*r;or+=u*(n+i);sr+=u*(t+r);ui+=3*u;li(n=i,t=r)}var r,u,n,t;ut.point=function(f,e){ut.point=i;li(r=n=f,u=t=e)};ut.lineEnd=function(){i(r,u)}}function hg(n){function i(t,i){n.moveTo(t+r,i);n.arc(t,i,r,0,d)}function f(i,r){n.moveTo(i,r);t.point=e}function e(t,i){n.lineTo(t,i)}function u(){t.point=i}function o(){n.closePath()}var r=4.5,t={point:i,lineStart:function(){t.point=f},lineEnd:u,polygonStart:function(){t.lineEnd=o},polygonEnd:function(){t.lineEnd=u;t.point=i},pointRadius:function(n){return r=n,t},result:l};return t}function ny(n){function o(n){return(e?h:s)(n)}function s(t){return iy(t,function(i,r){i=n(i,r);t.point(i[0],i[1])})}function h(t){function y(i,r){i=n(i,r);t.point(i[0],i[1])}function c(){u=NaN;r.point=l;t.lineStart()}function l(r,c){var l=ci([r,c]),a=n(r,c);i(u,f,v,o,s,h,u=a[0],f=a[1],v=r,o=l[0],s=l[1],h=l[2],e,t);t.point(u,f)}function a(){r.point=y;t.lineEnd()}function nt(){c();r.point=tt;r.lineEnd=it}function tt(n,t){l(p=n,rt=t);w=u;b=f;k=o;d=s;g=h;r.point=l}function it(){i(u,f,v,o,s,h,w,b,p,k,d,g,e,t);r.lineEnd=a;a()}var p,rt,w,b,k,d,g,v,u,f,o,s,h,r={point:y,lineStart:c,lineEnd:a,polygonStart:function(){t.polygonStart();r.lineStart=nt},polygonEnd:function(){t.polygonEnd();r.lineStart=c}};return r}function i(u,e,o,s,h,l,a,v,y,p,w,b,k,d){var it=a-u,rt=v-e,et=it*it+rt*rt;if(et>4*f&&k--){var nt=s+p,tt=h+w,g=l+b,ot=Math.sqrt(nt*nt+tt*tt+g*g),vt=Math.asin(g/=ot),st=r(r(g)-1)<t||r(o-y)<t?(o+y)/2:Math.atan2(tt,nt),ht=n(st,vt),ut=ht[0],ft=ht[1],ct=ut-u,lt=ft-e,at=rt*ct-it*lt;(at*at/et>f||r((it*ct+rt*lt)/et-.5)>.3||c>s*p+h*w+l*b)&&(i(u,e,o,s,h,l,ut,ft,st,nt/=ot,tt/=ot,g,k,d),d.point(ut,ft),i(ut,ft,st,nt,tt,g,a,v,y,p,w,b,k,d))}}var f=.5,c=Math.cos(30*u),e=16;return o.precision=function(n){return arguments.length?(e=(f=n*n)>0&&16,o):Math.sqrt(f)},o}function cg(n){var t=ny(function(t,i){return n([t*s,i*s])});return function(n){return ry(t(n))}}function ty(n){this.stream=n}function iy(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function ni(n){return ls(function(){return n})()}function ls(t){function i(n){return n=a(n[0]*u,n[1]*u),[n[0]*r+h,c-n[1]*r]}function et(n){return n=a.invert((n[0]-h)/r,(c-n[1])/r),n&&[n[0]*s,n[1]*s]}function e(){a=cv(tt=as(k,d,g),o);var n=o(w,b);return h=y-n[0]*r,c=p+n[1]*r,l()}function l(){return f&&(f.valid=!1,f=null),i}var o,tt,a,h,c,f,it=ny(function(n,t){return n=o(n,t),[n[0]*r+h,c-n[1]*r]}),r=150,y=480,p=250,w=0,b=0,k=0,d=0,g=0,rt=ab,ut=v,nt=null,ft=null;return i.stream=function(n){return f&&(f.valid=!1),f=ry(rt(tt,it(ut(n)))),f.valid=!0,f},i.clipAngle=function(n){return arguments.length?(rt=null==n?(nt=n,ab):ug((nt=+n)*u),l()):nt},i.clipExtent=function(n){return arguments.length?(ft=n,ut=n?wv(n[0][0],n[0][1],n[1][0],n[1][1]):v,l()):ft},i.scale=function(n){return arguments.length?(r=+n,e()):r},i.translate=function(n){return arguments.length?(y=+n[0],p=+n[1],e()):[y,p]},i.center=function(n){return arguments.length?(w=n[0]%360*u,b=n[1]%360*u,e()):[w*s,b*s]},i.rotate=function(n){return arguments.length?(k=n[0]%360*u,d=n[1]%360*u,g=n.length>2?n[2]%360*u:0,e()):[k*s,d*s,g*s]},n.rebind(i,it,"precision"),function(){return o=t.apply(this,arguments),i.invert=o.invert&&et,e()}}function ry(n){return iy(n,function(t,i){n.point(t*u,i*u)})}function yr(n,t){return[n,t]}function uy(n,t){return[n>f?n-d:-f>n?n+d:n,t]}function as(n,t,i){return n?t||i?cv(ey(n),oy(t,i)):ey(n):t||i?oy(t,i):uy}function fy(n){return function(t,i){return t+=n,[t>f?t-d:-f>t?t+d:t,i]}}function ey(n){var t=fy(n);return t.invert=fy(-n),t}function oy(n,t){function e(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*i+o*r;return[Math.atan2(s*u-c*f,o*i-h*r),gt(c*u+s*f)]}var i=Math.cos(n),r=Math.sin(n),u=Math.cos(t),f=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*u-s*f;return[Math.atan2(s*u+h*f,o*i+c*r),gt(c*i-o*r)]},e}function vs(n,t){var i=Math.cos(n),r=Math.sin(n);return function(u,f,e,o){var h=e*t,c,s;for(null!=u?(u=sy(i,u),f=sy(i,f),(e>0?f>u:u>f)&&(u+=e*d)):(u=n+e*d,f=n-.5*h),s=u;e>0?s>f:f>s;s-=h)o.point((c=ef([i,-r*Math.cos(s),-r*Math.sin(s)]))[0],c[1])}}function sy(n,i){var r=ci(i),u;return r[0]-=n,ff(r),u=ya(-r[1]),((-r[2]<0?-u:u)+2*Math.PI-t)%(2*Math.PI)}function hy(i,r,u){var f=n.range(i,r-t,u).concat(r);return function(n){return f.map(function(t){return[n,t]})}}function cy(i,r,u){var f=n.range(i,r-t,u).concat(r);return function(n){return f.map(function(t){return[t,n]})}}function ys(n){return n.source}function ps(n){return n.target}function lg(n,t,i,r){var f=Math.cos(t),c=Math.sin(t),e=Math.cos(r),l=Math.sin(r),a=f*Math.cos(n),v=f*Math.sin(n),y=e*Math.cos(i),p=e*Math.sin(i),u=2*Math.asin(Math.sqrt(wa(r-t)+f*e*wa(i-n))),o=1/Math.sin(u),h=u?function(n){var t=Math.sin(n*=u)*o,i=Math.sin(u-n)*o,r=i*a+t*y,f=i*v+t*p,e=i*c+t*l;return[Math.atan2(f,r)*s,Math.atan2(e,Math.sqrt(r*r+f*f))*s]}:function(){return[n*s,t*s]};return h.distance=u,h}function ag(){function f(f,e){var h=Math.sin(e*=u),s=Math.cos(e),o=r((f*=u)-i),c=Math.cos(o);pc+=Math.atan2(Math.sqrt((o=s*Math.sin(o))*o+(o=t*h-n*s*c)*o),n*h+t*s*c);i=f;n=h;t=s}var i,n,t;bi.point=function(r,e){i=r*u;n=Math.sin(e*=u);t=Math.cos(e);bi.point=f};bi.lineEnd=function(){bi.point=bi.lineEnd=l}}function pr(n,t){function i(t,i){var f=Math.cos(t),r=Math.cos(i),u=n(f*r);return[u*r*Math.sin(t),u*Math.sin(i)]}return i.invert=function(n,i){var r=Math.sqrt(n*n+i*i),u=t(r),f=Math.sin(u),e=Math.cos(u);return[Math.atan2(n*f,r*e),Math.asin(r&&i*f/r)]},i}function ly(n,i){function o(n,i){u>0?-h+t>i&&(i=-h+t):i>h-t&&(i=h-t);var f=u/Math.pow(e(i),r);return[f*Math.sin(r*n),u-f*Math.cos(r*n)]}var s=Math.cos(n),e=function(n){return Math.tan(f/4+n/2)},r=n===i?Math.sin(n):Math.log(s/Math.cos(i))/Math.log(e(i)/e(n)),u=s*Math.pow(e(n),r)/r;return r?(o.invert=function(n,t){var i=u-t,f=va(r)*Math.sqrt(n*n+i*i);return[Math.atan2(n,i)/r,2*Math.atan(Math.pow(u/f,1/r))-h]},o):hf}function ay(n,i){function e(n,t){var i=f-t;return[i*Math.sin(u*n),f-i*Math.cos(u*n)]}var o=Math.cos(n),u=n===i?Math.sin(n):(o-Math.cos(i))/(i-n),f=o/u+n;return r(u)<t?yr:(e.invert=function(n,t){var i=f-t;return[Math.atan2(n,i)/u,f-va(u)*Math.sqrt(n*n+i*i)]},e)}function hf(n,t){return[n,Math.log(Math.tan(f/4+t/2))]}function vy(n){var i,t=ni(n),r=t.scale,u=t.translate,e=t.clipExtent;return t.scale=function(){var n=r.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.translate=function(){var n=u.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.clipExtent=function(n){var h=e.apply(t,arguments),o,s;return h===t?(i=null==n)&&(o=f*r(),s=u(),e([[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]])):i&&(h=null),h},t.clipExtent(null)}function ws(n,t){return[Math.log(Math.tan(f/4+t/2)),-n]}function ir(n){return n[0]}function wr(n){return n[1]}function yy(n){for(var u=n.length,i=[0,1],t=2,r=2;u>r;r++){for(;t>1&&po(n[i[t-2]],n[i[t-1]],n[r])<=0;)--t;i[t++]=r}return i.slice(0,t)}function vg(n,t){return n[0]-t[0]||n[1]-t[1]}function bs(n,t,i){return(i[0]-t[0])*(n[1]-t[1])<(i[1]-t[1])*(n[0]-t[0])}function ks(n,t,i,r){var u=n[0],e=i[0],o=t[0]-u,s=r[0]-e,f=n[1],h=i[1],c=t[1]-f,l=r[1]-h,a=(s*(f-h)-l*(u-e))/(l*o-s*c);return[u+a*o,f+a*c]}function py(n){var t=n[0],i=n[n.length-1];return!(t[0]-i[0]||t[1]-i[1])}function yg(){af(this);this.edge=this.site=this.circle=null}function wy(n){var t=tl.pop()||new yg;return t.site=n,t}function ds(n){ur(n);cr.remove(n);tl.push(n);af(n)}function pg(n){var a=n.circle,o=a.x,s=a.cy,v={x:o,y:s},h=n.P,c=n.N,f=[n],u,i,e,l;for(ds(n),u=h;u.circle&&r(o-u.circle.x)<t&&r(s-u.circle.cy)<t;)h=u.P,f.unshift(u),ds(u),u=h;for(f.unshift(u),ur(u),i=c;i.circle&&r(o-i.circle.x)<t&&r(s-i.circle.cy)<t;)c=i.N,f.push(i),ds(i),i=c;for(f.push(i),ur(i),l=f.length,e=1;l>e;++e)i=f[e],u=f[e-1],cf(i.edge,u.site,i.site,v);u=f[0];i=f[l-1];i.edge=br(u.site,i.site,null,v);rr(u);rr(i)}function wg(n){for(var f,i,r,a,v,b=n.x,k=n.y,u=cr._;u;)if(a=by(u,k)-b,a>t)u=u.L;else{if(v=b-bg(u,k),!(v>t)){a>-t?(i=u.P,r=u):v>-t?(i=u,r=u.N):i=r=u;break}if(!u.R){i=u;break}u=u.R}if(f=wy(n),cr.insert(i,f),i||r){if(i===r)return ur(i),r=wy(i.site),cr.insert(f,r),f.edge=r.edge=br(i.site,f.site),rr(i),void rr(r);if(!r)return void(f.edge=br(i.site,f.site));ur(i);ur(r);var e=i.site,y=e.x,p=e.y,o=n.x-y,s=n.y-p,h=r.site,c=h.x-y,l=h.y-p,d=2*(o*l-s*c),g=o*o+s*s,nt=c*c+l*l,w={x:(l*g-s*nt)/d+y,y:(o*nt-c*g)/d+p};cf(r.edge,e,h,w);f.edge=br(e,n,null,w);r.edge=br(n,h,null,w);rr(i);rr(r)}}function by(n,t){var i=n.site,u=i.x,l=i.y,f=l-t,e;if(!f)return u;if(e=n.P,!e)return-(1/0);i=e.site;var o=i.x,a=i.y,r=a-t;if(!r)return o;var s=o-u,h=1/f-1/r,c=s/r;return h?(-c+Math.sqrt(c*c-2*h*(s*s/(-2*r)-a+r/2+l-f/2)))/h+u:(u+o)/2}function bg(n,t){var r=n.N,i;return r?by(r,t):(i=n.site,i.y===t?i.x:1/0)}function ky(n){this.site=n;this.edges=[]}function kg(n){for(var i,u,f,e,o,s,h,y,w,p,c=n[0][0],l=n[1][0],a=n[0][1],v=n[1][1],b=ki,k=b.length;k--;)if(o=b[k],o&&o.prepare())for(h=o.edges,y=h.length,s=0;y>s;)p=h[s].end(),f=p.x,e=p.y,w=h[++s%y].start(),i=w.x,u=w.y,(r(f-i)>t||r(e-u)>t)&&(h.splice(s,0,new lf(tn(o.site,p,r(f-c)<t&&v-e>t?{x:c,y:r(i-c)<t?u:v}:r(e-v)<t&&l-f>t?{x:r(u-v)<t?i:l,y:v}:r(f-l)<t&&e-a>t?{x:l,y:r(i-l)<t?u:a}:r(e-a)<t&&f-c>t?{x:r(u-a)<t?i:c,y:a}:null),o.site,null)),++y)}function dy(n,t){return t.angle-n.angle}function dg(){af(this);this.x=this.y=this.arc=this.site=this.cy=null}function rr(n){var w=n.P,b=n.N,u,t;if(w&&b){var s=w.site,h=n.site,c=b.site;if(s!==c){var l=h.x,a=h.y,f=s.x-l,e=s.y-a,o=c.x-l,r=c.y-a,v=2*(f*r-e*o);if(!(v>=-ee)){var k=f*f+e*e,d=o*o+r*r,y=(r*k-e*d)/v,p=(f*d-o*k)/v,r=p+a,i=il.pop()||new dg;for(i.arc=n,i.site=h,i.x=y+l,i.y=r+Math.sqrt(y*y+p*p),i.cy=r,n.circle=i,u=null,t=cu._;t;)if(i.y<t.y||i.y===t.y&&i.x<=t.x){if(!t.L){u=t.P;break}t=t.L}else{if(!t.R){u=t;break}t=t.R}cu.insert(u,i);u||(nl=i)}}}}function ur(n){var t=n.circle;t&&(t.P||(nl=t.N),cu.remove(t),il.push(t),af(t),n.circle=null)}function gg(n){for(var i,u=hr,e=pv(n[0][0],n[0][1],n[1][0],n[1][1]),f=u.length;f--;)i=u[f],(!nn(i,n)||!e(i)||r(i.a.x-i.b.x)<t&&r(i.a.y-i.b.y)<t)&&(i.a=i.b=null,u.splice(f,1))}function nn(n,t){var f=n.b;if(f)return!0;var r,u,i=n.a,h=t[0][0],c=t[1][0],e=t[0][1],o=t[1][1],p=n.l,w=n.r,l=p.x,a=p.y,v=w.x,y=w.y,s=(l+v)/2,b=(a+y)/2;if(y===a){if(h>s||s>=c)return;if(l>v){if(i){if(i.y>=o)return}else i={x:s,y:e};f={x:s,y:o}}else{if(i){if(i.y<e)return}else i={x:s,y:o};f={x:s,y:e}}}else if(r=(l-v)/(y-a),u=b-r*s,-1>r||r>1)if(l>v){if(i){if(i.y>=o)return}else i={x:(e-u)/r,y:e};f={x:(o-u)/r,y:o}}else{if(i){if(i.y<e)return}else i={x:(o-u)/r,y:o};f={x:(e-u)/r,y:e}}else if(y>a){if(i){if(i.x>=c)return}else i={x:h,y:r*h+u};f={x:c,y:r*c+u}}else{if(i){if(i.x<h)return}else i={x:c,y:r*c+u};f={x:h,y:r*h+u}}return n.a=i,n.b=f,!0}function gy(n,t){this.l=n;this.r=t;this.a=this.b=null}function br(n,t,i,r){var u=new gy(n,t);return hr.push(u),i&&cf(u,n,t,i),r&&cf(u,t,n,r),ki[n.i].edges.push(new lf(u,n,t)),ki[t.i].edges.push(new lf(u,t,n)),u}function tn(n,t,i){var r=new gy(n,null);return r.a=t,r.b=i,hr.push(r),r}function cf(n,t,i,r){n.a||n.b?n.l===i?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=i)}function lf(n,t,i){var r=n.a,u=n.b;this.edge=n;this.site=t;this.angle=i?Math.atan2(i.y-t.y,i.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function gs(){this._=null}function af(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function kr(n,t){var i=t,r=t.R,u=i.U;u?u.L===i?u.L=r:u.R=r:n._=r;r.U=u;i.U=r;i.R=r.L;i.R&&(i.R.U=i);r.L=i}function dr(n,t){var i=t,r=t.L,u=i.U;u?u.L===i?u.L=r:u.R=r:n._=r;r.U=u;i.U=r;i.L=r.R;i.L&&(i.L.U=i);r.R=i}function np(n){for(;n.L;)n=n.L;return n}function nh(n,t){var u,f,r,i=n.sort(rn).pop(),e;for(hr=[],ki=new Array(n.length),cr=new gs,cu=new gs;;)if(r=nl,i&&(!r||i.y<r.y||i.y===r.y&&i.x<r.x))(i.x!==u||i.y!==f)&&(ki[i.i]=new ky(i),wg(i),u=i.x,f=i.y),i=n.pop();else{if(!r)break;pg(r.arc)}return t&&(gg(t),kg(t)),e={cells:ki,edges:hr},cr=cu=hr=ki=null,e}function rn(n,t){return t.y-n.y||t.x-n.x}function un(n,t,i){return(n.x-i.x)*(t.y-n.y)-(n.x-t.x)*(i.y-n.y)}function fn(n){return n.x}function en(n){return n.y}function tp(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function gr(n,t,i,r,u,f){if(!n(t,i,r,u,f)){var o=.5*(i+u),s=.5*(r+f),e=t.nodes;e[0]&&gr(n,e[0],i,r,o,s);e[1]&&gr(n,e[1],o,r,u,s);e[2]&&gr(n,e[2],i,s,o,f);e[3]&&gr(n,e[3],o,s,u,f)}}function on(n,t,i,r,u,f,e){var s,h=1/0;return function o(n,c,l,a,v){var y;if(!(c>f||l>e||r>a||u>v)){if(k=n.point){var k,d=t-n.x,g=i-n.y,nt=d*d+g*g;h>nt&&(y=Math.sqrt(h=nt),r=t-y,u=i-y,f=t+y,e=i+y,s=k)}for(var tt=n.nodes,p=.5*(c+a),w=.5*(l+v),it=t>=p,rt=i>=w,b=rt<<1|it,ut=b+4;ut>b;++b)if(n=tt[3&b])switch(3&b){case 0:o(n,c,l,p,w);break;case 1:o(n,p,l,a,w);break;case 2:o(n,c,w,p,v);break;case 3:o(n,p,w,a,v)}}}(n,r,u,f,e),s}function th(t,i){t=n.rgb(t);i=n.rgb(i);var r=t.r,u=t.g,f=t.b,e=i.r-r,o=i.g-u,s=i.b-f;return function(n){return"#"+nr(Math.round(r+e*n))+nr(Math.round(u+o*n))+nr(Math.round(f+s*n))}}function ip(n,t){var i,u={},r={};for(i in n)i in t?u[i]=ai(n[i],t[i]):r[i]=n[i];for(i in t)i in n||(r[i]=t[i]);return function(n){for(i in u)r[i]=u[i](n);return r}}function pt(n,t){return n=+n,t=+t,function(i){return n*(1-i)+t*i}}function rp(n,t){var s,f,u,e=to.lastIndex=io.lastIndex=0,r=-1,i=[],o=[];for(n+="",t+="";(s=to.exec(n))&&(f=io.exec(t));)(u=f.index)>e&&(u=t.slice(e,u),i[r]?i[r]+=u:i[++r]=u),(s=s[0])===(f=f[0])?i[r]?i[r]+=f:i[++r]=f:(i[++r]=null,o.push({i:r,x:pt(s,f)})),e=io.lastIndex;return e<t.length&&(u=t.slice(e),i[r]?i[r]+=u:i[++r]=u),i.length<2?o[0]?(t=o[0].x,function(n){return t(n)+""}):function(){return t}:(t=o.length,function(n){for(var u,r=0;t>r;++r)i[(u=o[r]).i]=u.x(n);return i.join("")})}function ai(t,i){for(var r,u=n.interpolators.length;--u>=0&&!(r=n.interpolators[u](t,i)););return r}function vf(n,t){for(var u=[],r=[],e=n.length,o=t.length,f=Math.min(n.length,t.length),i=0;f>i;++i)u.push(ai(n[i],t[i]));for(;e>i;++i)r[i]=n[i];for(;o>i;++i)r[i]=t[i];return function(n){for(i=0;f>i;++i)r[i]=u[i](n);return r}}function sn(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function up(n){return function(t){return 1-n(1-t)}}function fp(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function hn(n){return n*n}function cn(n){return n*n*n}function ln(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,i=t*n;return 4*(.5>n?i:3*(n-t)+i-.75)}function an(n){return function(t){return Math.pow(t,n)}}function vn(n){return 1-Math.cos(n*h)}function yn(n){return Math.pow(2,10*(n-1))}function pn(n){return 1-Math.sqrt(1-n*n)}function wn(n,t){var i;return arguments.length<2&&(t=.45),arguments.length?i=t/d*Math.asin(1/n):(n=1,i=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-i)*d/t)}}function bn(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function kn(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function dn(t,i){t=n.hcl(t);i=n.hcl(i);var u=t.h,f=t.c,o=t.l,r=i.h-u,e=i.c-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.c:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return bo(u+r*n,f+e*n,o+s*n)+""}}function gn(t,i){t=n.hsl(t);i=n.hsl(i);var u=t.h,f=t.s,o=t.l,r=i.h-u,e=i.s-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.s:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return wo(u+r*n,f+e*n,o+s*n)+""}}function ntt(t,i){t=n.lab(t);i=n.lab(i);var r=t.l,u=t.a,f=t.b,e=i.l-r,o=i.a-u,s=i.b-f;return function(n){return ba(r+e*n,u+o*n,f+s*n)+""}}function ep(n,t){return t-=n,function(i){return Math.round(n+t*i)}}function op(n){var t=[n.a,n.b],i=[n.c,n.d],r=hp(t),u=sp(t,i),f=hp(ttt(i,t,-u))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1);this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*s;this.translate=[n.e,n.f];this.scale=[r,f];this.skew=f?Math.atan2(u,f)*s:0}function sp(n,t){return n[0]*t[0]+n[1]*t[1]}function hp(n){var t=Math.sqrt(sp(n,n));return t&&(n[0]/=t,n[1]/=t),t}function ttt(n,t,i){return n[0]+=i*t[0],n[1]+=i*t[1],n}function fr(n){return n.length?n.pop()+",":""}function itt(n,t,i,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=i.push("translate(",null,",",null,")");r.push({i:u-4,x:pt(n[0],t[0])},{i:u-2,x:pt(n[1],t[1])})}else(t[0]||t[1])&&i.push("translate("+t+")")}function rtt(n,t,i,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:i.push(fr(i)+"rotate(",null,")")-2,x:pt(n,t)})):t&&i.push(fr(i)+"rotate("+t+")")}function utt(n,t,i,r){n!==t?r.push({i:i.push(fr(i)+"skewX(",null,")")-2,x:pt(n,t)}):t&&i.push(fr(i)+"skewX("+t+")")}function ftt(n,t,i,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=i.push(fr(i)+"scale(",null,",",null,")");r.push({i:u-4,x:pt(n[0],t[0])},{i:u-2,x:pt(n[1],t[1])})}else(1!==t[0]||1!==t[1])&&i.push(fr(i)+"scale("+t+")")}function cp(t,i){var r=[],u=[];return t=n.transform(t),i=n.transform(i),itt(t.translate,i.translate,r,u),rtt(t.rotate,i.rotate,r,u),utt(t.skew,i.skew,r,u),ftt(t.scale,i.scale,r,u),t=i=null,function(n){for(var t,i=-1,f=u.length;++i<f;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function ett(n,t){return t=(t-=n=+n)||1/t,function(i){return(i-n)/t}}function ott(n,t){return t=(t-=n=+n)||1/t,function(i){return Math.max(0,Math.min(1,(i-n)/t))}}function stt(n){for(var f,t=n.source,i=n.target,u=htt(t,i),r=[t];t!==u;)t=t.parent,r.push(t);for(f=r.length;i!==u;)r.splice(f,0,i),i=i.parent;return r}function lp(n){for(var i=[],t=n.parent;null!=t;)i.push(n),n=t,t=t.parent;return i.push(n),i}function htt(n,t){if(n===t)return n;for(var r=lp(n),u=lp(t),i=r.pop(),f=u.pop(),e=null;i===f;)e=i,i=r.pop(),f=u.pop();return e}function ctt(n){n.fixed|=2}function ltt(n){n.fixed&=-7}function att(n){n.fixed|=4;n.px=n.x;n.py=n.y}function vtt(n){n.fixed&=-5}function ap(n,t,i){var f=0,e=0,u;if(n.charge=0,!n.leaf)for(var r,o=n.nodes,h=o.length,s=-1;++s<h;)r=o[s],null!=r&&(ap(r,t,i),n.charge+=r.charge,f+=r.charge*r.cx,e+=r.charge*r.cy);n.point&&(n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5),u=t*i[n.point.index],n.charge+=n.pointCharge=u,f+=u*n.point.x,e+=u*n.point.y);n.cx=f/n.charge;n.cy=e/n.charge}function nu(t,i){return n.rebind(t,i,"sort","children","value"),t.nodes=t,t.links=btt,t}function tu(n,t){for(var r,u,i=[n];null!=(n=i.pop());)if(t(n),(u=n.children)&&(r=u.length))for(;--r>=0;)i.push(u[r])}function et(n,t){for(var e,u,f,i=[n],r=[];null!=(n=i.pop());)if(r.push(n),(u=n.children)&&(e=u.length))for(f=-1;++f<e;)i.push(u[f]);for(;null!=(n=r.pop());)t(n)}function ytt(n){return n.children}function ptt(n){return n.value}function wtt(n,t){return t.value-n.value}function btt(t){return n.merge(t.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function ktt(n){return n.x}function dtt(n){return n.y}function gtt(n,t,i){n.y0=t;n.y=i}function ih(t){return n.range(t.length)}function rh(n){for(var t=-1,r=n[0].length,i=[];++t<r;)i[t]=0;return i}function nit(n){for(var i,t=1,r=0,u=n[0][1],f=n.length;f>t;++t)(i=n[t][1])>u&&(r=t,u=i);return r}function tit(n){return n.reduce(iit,0)}function iit(n,t){return n+t[1]}function rit(n,t){return vp(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function vp(n,t){for(var i=-1,r=+n[0],f=(n[1]-r)/t,u=[];++i<=t;)u[i]=f*i+r;return u}function uit(t){return[n.min(t),n.max(t)]}function fit(n,t){return n.value-t.value}function uh(n,t){var i=n._pack_next;n._pack_next=t;t._pack_prev=n;t._pack_next=i;i._pack_prev=t}function yp(n,t){n._pack_next=t;t._pack_prev=n}function pp(n,t){var i=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>i*i+r*r}function wp(n){function h(n){c=Math.min(n.x-n.r,c);l=Math.max(n.x+n.r,l);a=Math.min(n.y-n.r,a);v=Math.max(n.y+n.r,v)}if((u=n.children)&&(s=u.length)){var u,i,r,t,f,e,o,s,c=1/0,l=-(1/0),a=1/0,v=-(1/0);if(u.forEach(eit),i=u[0],i.x=-i.r,i.y=0,h(i),s>1&&(r=u[1],r.x=r.r,r.y=0,h(r),s>2))for(t=u[2],kp(i,r,t),h(t),uh(i,t),i._pack_prev=t,uh(t,r),r=i._pack_next,f=3;s>f;f++){kp(i,r,t=u[f]);var y=0,p=1,w=1;for(e=r._pack_next;e!==r;e=e._pack_next,p++)if(pp(e,t)){y=1;break}if(1==y)for(o=i._pack_prev;o!==e._pack_prev&&!pp(o,t);o=o._pack_prev,w++);y?(w>p||p==w&&r.r<i.r?yp(i,r=e):yp(i=o,r),f--):(uh(i,t),r=t,h(t))}var k=(c+l)/2,d=(a+v)/2,b=0;for(f=0;s>f;f++)t=u[f],t.x-=k,t.y-=d,b=Math.max(b,t.r+Math.sqrt(t.x*t.x+t.y*t.y));n.r=b;u.forEach(oit)}}function eit(n){n._pack_next=n._pack_prev=n}function oit(n){delete n._pack_next;delete n._pack_prev}function bp(n,t,i,r){var u=n.children,f,e;if(n.x=t+=r*n.x,n.y=i+=r*n.y,n.r*=r,u)for(f=-1,e=u.length;++f<e;)bp(u[f],t,i,r)}function kp(n,t,i){var r=n.r+i.r,f=t.x-n.x,e=t.y-n.y,u,o,s,h;r&&(f||e)?(u=t.r+i.r,o=f*f+e*e,u*=u,r*=r,s=.5+(r-u)/(2*o),h=Math.sqrt(Math.max(0,2*u*(r+o)-(r-=o)*r-u*u))/(2*o),i.x=n.x+s*f+h*e,i.y=n.y+s*e-h*f):(i.x=n.x+r,i.y=n.y)}function dp(n,t){return n.parent==t.parent?1:2}function fh(n){var t=n.children;return t.length?t[0]:n.t}function eh(n){var t,i=n.children;return(t=i.length)?i[t-1]:n.t}function sit(n,t,i){var r=i/(t.i-n.i);t.c-=r;t.s+=i;n.c+=r;t.z+=i;t.m+=i}function hit(n){for(var t,i=0,f=0,r=n.children,u=r.length;--u>=0;)t=r[u],t.z+=i,t.m+=i,i+=t.s+(f+=t.c)}function cit(n,t,i){return n.a.parent===t.parent?n.a:i}function lit(t){return 1+n.max(t,function(n){return n.y})}function ait(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function gp(n){var t=n.children;return t&&t.length?gp(t[0]):n}function nw(n){var i,t=n.children;return t&&(i=t.length)?nw(t[i-1]):n}function oh(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function tw(n,t){var u=n.x+t[3],f=n.y+t[0],i=n.dx-t[1]-t[3],r=n.dy-t[0]-t[2];return 0>i&&(u+=i/2,i=0),0>r&&(f+=r/2,r=0),{x:u,y:f,dx:i,dy:r}}function er(n){var t=n[0],i=n[n.length-1];return i>t?[t,i]:[i,t]}function yf(n){return n.rangeExtent?n.rangeExtent():er(n.range())}function vit(n,t,i,r){var u=i(n[0],n[1]),f=r(t[0],t[1]);return function(n){return f(u(n))}}function sh(n,t){var i,r=0,u=n.length-1,f=n[r],e=n[u];return f>e&&(i=r,r=u,u=i,i=f,f=e,e=i),n[r]=t.floor(f),n[u]=t.ceil(e),n}function yit(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:bb}function pit(t,i,r,u){var o=[],s=[],f=0,e=Math.min(t.length,i.length)-1;for(t[e]<t[0]&&(t=t.slice().reverse(),i=i.slice().reverse());++f<=e;)o.push(r(t[f-1],t[f])),s.push(u(i[f-1],i[f]));return function(i){var r=n.bisect(t,i,1,e)-1;return s[r](o[r](i))}}function iw(n,t,i,r){function f(){var f=Math.min(n.length,t.length)>2?pit:vit,s=r?ott:ett;return e=f(n,t,s,i),o=f(t,n,s,ai),u}function u(n){return e(n)}var e,o;return u.invert=function(n){return o(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),f()):n},u.range=function(n){return arguments.length?(t=n,f()):t},u.rangeRound=function(n){return u.range(n).interpolate(ep)},u.clamp=function(n){return arguments.length?(r=n,f()):r},u.interpolate=function(n){return arguments.length?(i=n,f()):i},u.ticks=function(t){return ch(n,t)},u.tickFormat=function(t,i){return lh(n,t,i)},u.nice=function(t){return rw(n,t),f()},u.copy=function(){return iw(n,t,i,r)},f()}function hh(t,i){return n.rebind(t,i,"range","rangeRound","interpolate","clamp")}function rw(n,t){return sh(n,yit(iu(n,t)[2]))}function iu(n,t){null==t&&(t=10);var r=er(n),f=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(f/t)/Math.LN10)),u=t/f*i;return.15>=u?i*=10:.35>=u?i*=5:.75>=u&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+.5*i,r[2]=i,r}function ch(t,i){return n.range.apply(n,iu(t,i))}function lh(t,i,u){var e=iu(t,i),f,o;if(u){if(f=hb.exec(u),f.shift(),"s"===f[8])return o=n.formatPrefix(Math.max(r(e[0]),r(e[1]))),f[7]||(f[7]="."+pf(o.scale(e[2]))),f[8]="f",u=n.format(f.join("")),function(n){return u(o.scale(n))+o.symbol};f[7]||(f[7]="."+wit(f[8],e));u=f.join("")}else u=",."+pf(e[2])+"f";return n.format(u)}function pf(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function wit(n,t){var i=pf(t[2]);return n in kb?Math.abs(i-pf(Math.max(r(t[0]),r(t[1]))))+ +("e"!==n):i-2*("%"===n)}function uw(t,i,r,u){function e(n){return(r?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(i)}function o(n){return r?Math.pow(i,n):-Math.pow(i,-n)}function f(n){return t(e(n))}return f.invert=function(n){return o(t.invert(n))},f.domain=function(n){return arguments.length?(r=n[0]>=0,t.domain((u=n.map(Number)).map(e)),f):u},f.base=function(n){return arguments.length?(i=+n,t.domain(u.map(e)),f):i},f.nice=function(){var n=sh(u.map(e),r?Math:db);return t.domain(n),u=n.map(o),f},f.ticks=function(){var h=er(u),t=[],c=h[0],l=h[1],n=Math.floor(e(c)),s=Math.ceil(e(l)),a=i%1?2:i,f;if(isFinite(s-n)){if(r){for(;s>n;n++)for(f=1;a>f;f++)t.push(o(n)*f);t.push(o(n))}else for(t.push(o(n));n++<s;)for(f=a-1;f>0;f--)t.push(o(n)*f);for(n=0;t[n]<c;n++);for(s=t.length;t[s-1]>l;s--);t=t.slice(n,s)}return t},f.tickFormat=function(t,i){if(!arguments.length)return ul;arguments.length<2?i=ul:"function"!=typeof i&&(i=n.format(i));var u,s=Math.max(.1,t/f.ticks().length),h=r?(u=1e-12,Math.ceil):(u=-1e-12,Math.floor);return function(n){return n/o(h(e(n)+u))<=s?i(n):""}},f.copy=function(){return uw(t.copy(),i,r,u)},hh(f,t)}function fw(n,t,i){function r(t){return n(u(t))}var u=wf(t),f=wf(1/t);return r.invert=function(t){return f(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((i=t.map(Number)).map(u)),r):i},r.ticks=function(n){return ch(i,n)},r.tickFormat=function(n,t){return lh(i,n,t)},r.nice=function(n){return r.domain(rw(i,n))},r.exponent=function(e){return arguments.length?(u=wf(t=e),f=wf(1/t),n.domain(i.map(u)),r):t},r.copy=function(){return fw(n.copy(),t,i)},hh(r,n)}function wf(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function ew(t,i){function r(n){return u[((e.get(n)||("range"===i.t?e.set(n,t.push(n)):NaN))-1)%u.length]}function o(i,r){return n.range(t.length).map(function(n){return i+r*n})}var e,u,f;return r.domain=function(n){if(!arguments.length)return t;t=[];e=new at;for(var u,f=-1,o=n.length;++f<o;)e.has(u=n[f])||e.set(u,t.push(u));return r[i.t].apply(r,i.a)},r.range=function(n){return arguments.length?(u=n,f=0,i={t:"range",a:arguments},r):u},r.rangePoints=function(n,e){arguments.length<2&&(e=0);var s=n[0],h=n[1],c=t.length<2?(s=(s+h)/2,0):(h-s)/(t.length-1+e);return u=o(s+c*e/2,c),f=0,i={t:"rangePoints",a:arguments},r},r.rangeRoundPoints=function(n,e){arguments.length<2&&(e=0);var s=n[0],h=n[1],c=t.length<2?(s=h=Math.round((s+h)/2),0):(h-s)/(t.length-1+e)|0;return u=o(s+Math.round(c*e/2+(h-s-(t.length-1+e)*c)/2),c),f=0,i={t:"rangeRoundPoints",a:arguments},r},r.rangeBands=function(n,e,s){arguments.length<2&&(e=0);arguments.length<3&&(s=e);var h=n[1]<n[0],l=n[+h],a=n[1-h],c=(a-l)/(t.length-e+2*s);return u=o(l+c*s,c),h&&u.reverse(),f=c*(1-e),i={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,e,s){arguments.length<2&&(e=0);arguments.length<3&&(s=e);var h=n[1]<n[0],c=n[+h],a=n[1-h],l=Math.floor((a-c)/(t.length-e+2*s));return u=o(c+Math.round((a-c-(t.length-e)*l)/2),l),h&&u.reverse(),f=Math.round(l*(1-e)),i={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return f},r.rangeExtent=function(){return er(i.a[0])},r.copy=function(){return ew(t,i)},r.domain(t)}function ow(t,i){function f(){var f=0,e=i.length;for(r=[];++f<e;)r[f-1]=n.quantile(t,f/e);return u}function u(t){if(!isNaN(t=+t))return i[n.bisect(r,t)]}var r;return u.domain=function(n){return arguments.length?(t=n.map(oi).filter(lt).sort(gi),f()):t},u.range=function(n){return arguments.length?(i=n,f()):i},u.quantiles=function(){return r},u.invertExtent=function(n){return n=i.indexOf(n),0>n?[NaN,NaN]:[n>0?r[n-1]:t[0],n<r.length?r[n]:t[t.length-1]]},u.copy=function(){return ow(t,i)},f()}function sw(n,t,i){function r(t){return i[Math.max(0,Math.min(e,Math.floor(u*(t-n))))]}function f(){return u=i.length/(t-n),e=i.length-1,r}var u,e;return r.domain=function(i){return arguments.length?(n=+i[0],t=+i[i.length-1],f()):[n,t]},r.range=function(n){return arguments.length?(i=n,f()):i},r.invertExtent=function(t){return t=i.indexOf(t),t=0>t?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return sw(n,t,i)},f()}function hw(t,i){function r(r){if(r>=r)return i[n.bisect(t,r)]}return r.domain=function(n){return arguments.length?(t=n,r):t},r.range=function(n){return arguments.length?(i=n,r):i},r.invertExtent=function(n){return n=i.indexOf(n),[t[n-1],t[n]]},r.copy=function(){return hw(t,i)},r}function cw(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=i.map(t),t):n},t.ticks=function(t){return ch(n,t)},t.tickFormat=function(t,i){return lh(n,t,i)},t.copy=function(){return cw(n)},t}function bit(){return 0}function kit(n){return n.innerRadius}function dit(n){return n.outerRadius}function lw(n){return n.startAngle}function aw(n){return n.endAngle}function git(n){return n&&n.padAngle}function bf(n,t,i,r){return(n-i)*t-(t-r)*n>0?0:1}function kf(n,t,i,r,u){var v=n[0]-t[0],y=n[1]-t[1],nt=(u?r:-r)/Math.sqrt(v*v+y*y),p=nt*y,w=-nt*v,b=n[0]+p,k=n[1]+w,d=t[0]+p,g=t[1]+w,tt=(b+d)/2,it=(k+g)/2,e=d-b,f=g-k,s=e*e+f*f,h=i-r,o=b*g-d*k,c=(0>f?-1:1)*Math.sqrt(Math.max(0,h*h*s-o*o)),l=(o*f-e*c)/s,a=(-o*e-f*c)/s,rt=(o*f+e*c)/s,ut=(-o*e+f*c)/s,ft=l-tt,et=a-it,ot=rt-tt,st=ut-it;return ft*ft+et*et>ot*ot+st*st&&(l=rt,a=ut),[[l-p,a-w],[l*i/h,a*i/h]]}function vw(n){function t(t){function a(){l.push("M",i(n(s),e))}for(var c,l=[],s=[],h=-1,v=t.length,y=o(r),p=o(u);++h<v;)f.call(this,c=t[h],h)?s.push([+y.call(this,c,h),+p.call(this,c,h)]):s.length&&(a(),s=[]);return s.length&&a(),l.length?l.join(""):null}var r=ir,u=wr,f=vr,i=it,s=i.key,e=.7;return t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(f=n,t):f},t.interpolate=function(n){return arguments.length?(s="function"==typeof n?i=n:(i=ro.get(n)||it).key,t):s},t.tension=function(n){return arguments.length?(e=n,t):e},t}function it(n){return n.length>1?n.join("L"):n+"Z"}function yw(n){return n.join("L")+"Z"}function nrt(n){for(var r=0,u=n.length,t=n[0],i=[t[0],",",t[1]];++r<u;)i.push("H",(t[0]+(t=n[r])[0])/2,"V",t[1]);return u>1&&i.push("H",t[0]),i.join("")}function ah(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("V",(t=n[i])[1],"H",t[0]);return r.join("")}function vh(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("H",(t=n[i])[0],"V",t[1]);return r.join("")}function trt(n,t){return n.length<4?it(n):n[1]+df(n.slice(1,-1),yh(n,t))}function irt(n,t){return n.length<3?yw(n):n[0]+df((n.push(n[0]),n),yh([n[n.length-2]].concat(n,[n[1]]),t))}function rrt(n,t){return n.length<3?it(n):n[0]+df(n,yh(n,t))}function df(n,t){var o,h;if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return it(n);var c=n.length!=t.length,f="",s=n[0],i=n[1],e=t[0],r=e,u=1;if(c&&(f+="Q"+(i[0]-2*e[0]/3)+","+(i[1]-2*e[1]/3)+","+i[0]+","+i[1],s=n[1],u=2),t.length>1)for(r=t[1],i=n[u],u++,f+="C"+(s[0]+e[0])+","+(s[1]+e[1])+","+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1],o=2;o<t.length;o++,u++)i=n[u],r=t[o],f+="S"+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1];return c&&(h=n[u],f+="Q"+(i[0]+2*r[0]/3)+","+(i[1]+2*r[1]/3)+","+h[0]+","+h[1]),f}function yh(n,t){for(var r,u=[],f=(1-t)/2,e=n[0],i=n[1],o=1,s=n.length;++o<s;)r=e,e=i,i=n[o],u.push([f*(i[0]-r[0]),f*(i[1]-r[1])]);return u}function pw(n){if(n.length<3)return it(n);var o=1,s=n.length,t=n[0],i=t[0],r=t[1],u=[i,i,i,(t=n[1])[0]],f=[r,r,r,t[1]],e=[i,",",r,"L",g(ei,u),",",g(ei,f)];for(n.push(n[s-1]);++o<=s;)t=n[o],u.shift(),u.push(t[0]),f.shift(),f.push(t[1]),ph(e,u,f);return n.pop(),e.push("L",t),e.join("")}function urt(n){if(n.length<4)return it(n);for(var t,f=[],i=-1,e=n.length,r=[0],u=[0];++i<3;)t=n[i],r.push(t[0]),u.push(t[1]);for(f.push(g(ei,r)+","+g(ei,u)),--i;++i<e;)t=n[i],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),ph(f,r,u);return f.join("")}function frt(n){for(var f,t,i=-1,e=n.length,o=e+4,r=[],u=[];++i<4;)t=n[i%e],r.push(t[0]),u.push(t[1]);for(f=[g(ei,r),",",g(ei,u)],--i;++i<o;)t=n[i%e],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),ph(f,r,u);return f.join("")}function ert(n,t){var i=n.length-1;if(i)for(var r,u,e=n[0][0],o=n[0][1],s=n[i][0]-e,h=n[i][1]-o,f=-1;++f<=i;)r=n[f],u=f/i,r[0]=t*r[0]+(1-t)*(e+u*s),r[1]=t*r[1]+(1-t)*(o+u*h);return pw(n)}function g(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function ph(n,t,i){n.push("C",g(gb,t),",",g(gb,i),",",g(nk,t),",",g(nk,i),",",g(ei,t),",",g(ei,i))}function wh(n,t){return(t[1]-n[1])/(t[0]-n[0])}function ort(n){for(var t=0,e=n.length-1,i=[],f=n[0],r=n[1],u=i[0]=wh(f,r);++t<e;)i[t]=(u+(u=wh(f=r,r=n[t+1])))/2;return i[t]=u,i}function srt(n){for(var e,o,s,u,c=[],f=ort(n),i=-1,h=n.length-1;++i<h;)e=wh(n[i],n[i+1]),r(e)<t?f[i]=f[i+1]=0:(o=f[i]/e,s=f[i+1]/e,u=o*o+s*s,u>9&&(u=3*e/Math.sqrt(u),f[i]=u*o,f[i+1]=u*s));for(i=-1;++i<=h;)u=(n[Math.min(h,i+1)][0]-n[Math.max(0,i-1)][0])/(6*(1+f[i]*f[i])),c.push([u||0,f[i]*u||0]);return c}function hrt(n){return n.length<3?it(n):n[0]+df(n,srt(n))}function ww(n){for(var t,i,r,u=-1,f=n.length;++u<f;)t=n[u],i=t[0],r=t[1]-h,t[0]=i*Math.cos(r),t[1]=i*Math.sin(r);return n}function bw(n){function t(t){function b(){p.push("M",i(n(w),s),a,l(n(y.reverse()),s),"Z")}for(var v,k,d,p=[],y=[],w=[],c=-1,g=t.length,nt=o(f),tt=o(e),it=f===r?function(){return k}:o(r),rt=e===u?function(){return d}:o(u);++c<g;)h.call(this,v=t[c],c)?(y.push([k=+nt.call(this,v,c),d=+tt.call(this,v,c)]),w.push([+it.call(this,v,c),+rt.call(this,v,c)])):y.length&&(b(),y=[],w=[]);return y.length&&b(),p.length?p.join(""):null}var f=ir,r=ir,e=0,u=wr,h=vr,i=it,c=i.key,l=i,a="L",s=.7;return t.x=function(n){return arguments.length?(f=r=n,t):r},t.x0=function(n){return arguments.length?(f=n,t):f},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(e=u=n,t):u},t.y0=function(n){return arguments.length?(e=n,t):e},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(h=n,t):h},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?i=n:(i=ro.get(n)||it).key,l=i.reverse||i,a=i.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(s=n,t):s},t}function crt(n){return n.radius}function kw(n){return[n.x,n.y]}function lrt(n){return function(){var t=n.apply(this,arguments),i=t[0],r=t[1]-h;return[i*Math.cos(r),i*Math.sin(r)]}}function art(){return 64}function vrt(){return"circle"}function dw(n){var t=Math.sqrt(n/f);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function gw(n){return function(){var t,r,i;(t=this[n])&&(i=t[r=t.active])&&(i.timer.c=null,i.timer.t=NaN,--t.count?delete t[r]:delete this[n],t.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ru(n,t,i){return ie(n,a),n.namespace=t,n.id=i,n}function bh(n,t,i,r){var u=n.id,f=n.namespace;return vt(n,"function"==typeof i?function(n,e,o){n[f][u].tween.set(t,r(i.call(n,n.__data__,e,o)))}:(i=r(i),function(n){n[f][u].tween.set(t,i)}))}function yrt(n){return null==n&&(n=""),function(){this.textContent=n}}function kh(n){return null==n?"__transition__":"__transition_"+n+"__"}function gf(n,t,i,r,u){function y(n){var t=e.delay;return o.t=t+s,n>=t?c(n-t):void(o.c=c)}function c(i){var p=f.active,u=f[p],c,y;u&&(u.timer.c=null,u.timer.t=NaN,--f.count,delete f[p],u.event&&u.event.interrupt.call(n,n.__data__,u.index));for(c in f)r>+c&&(y=f[c],y.timer.c=null,y.timer.t=NaN,--f.count,delete f[c]);o.c=l;ku(function(){return o.c&&l(i||1)&&(o.c=null,o.t=NaN),1},0,s);f.active=r;e.event&&e.event.start.call(n,n.__data__,t);h=[];e.tween.forEach(function(i,r){(r=r.call(n,n.__data__,t))&&h.push(r)});v=e.ease;a=e.duration}function l(u){for(var o=u/a,c=v(o),s=h.length;s>0;)h[--s].call(n,c);if(o>=1)return(e.event&&e.event.end.call(n,n.__data__,t),--f.count?delete f[r]:delete n[i],1)}var s,o,a,v,h,f=n[i]||(n[i]={active:0,count:0}),e=f[r];e||(s=u.time,o=ku(y,0,s),e=f[r]={tween:new at,time:s,timer:o,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++f.count)}function prt(n,t,i){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:i(n))+",0)"})}function wrt(n,t,i){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:i(n))+")"})}function dh(n){return n.toISOString()}function gh(t,i,r){function u(n){return t(n)}function f(t,r){var e=t[1]-t[0],f=e/r,u=n.bisect(eo,f);return u==eo.length?[i.year,iu(t.map(function(n){return n/31536e6}),r)[2]]:u?i[f/eo[u-1]<eo[u]/f?u-1:u]:[wut,iu(t,r)[2]]}return u.invert=function(n){return vi(t.invert(n))},u.domain=function(n){return arguments.length?(t.domain(n),u):t.domain().map(vi)},u.nice=function(n,t){function r(i){return!isNaN(i)&&!n.range(i,vi(+i+1),t).length}var e=u.domain(),o=er(e),i=null==n?f(o,10):"number"==typeof n&&f(o,n);return i&&(n=i[0],t=i[1]),u.domain(sh(e,t>1?{floor:function(t){for(;r(t=n.floor(t));)t=vi(t-1);return t},ceil:function(t){for(;r(t=n.ceil(t));)t=vi(+t+1);return t}}:n))},u.ticks=function(n,t){var i=er(u.domain()),r=null==n?f(i,10):"number"==typeof n?f(i,n):!n.range&&[{range:n},t];return r&&(n=r[0],t=r[1]),n.range(i[0],vi(+i[1]+1),1>t?1:t)},u.tickFormat=function(){return r},u.copy=function(){return gh(t.copy(),i,r)},hh(u,t)}function vi(n){return new Date(n)}function brt(n){return JSON.parse(n.responseText)}function krt(n){var t=p.createRange();return t.selectNode(p.body),t.createContextualFragment(n.responseText)}var n={version:"3.5.9"},nb=[].slice,ot=function(n){return nb.call(n)},p=this.document,nc,r,ib,te,tc,e,re,st,ue,yi,rb,fe,oe,ec,oc,se,he,fu,eu,le,ae,ve,ye,hc,sb,ht,cc,ou,lc,ac,pe,ti,k,pc,bi,wc,bc,kc,dc,gc,hu,hr,ki,cr,nl,cu,tl,il,lu,to,io,yb,rl,pb,wb,bb,kb,ul,db,au,ro,fl,vu,el,ol,ik,ll,fk;if(p)try{ot(p.documentElement.childNodes)[0].nodeType}catch(but){ot=function(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i}}if(Date.now||(Date.now=function(){return+new Date}),p)try{p.createElement("DIV").style.setProperty("opacity",0,"")}catch(kut){var ne=this.Element.prototype,drt=ne.setAttribute,grt=ne.setAttributeNS,tb=this.CSSStyleDeclaration.prototype,nut=tb.setProperty;ne.setAttribute=function(n,t){drt.call(this,n,t+"")};ne.setAttributeNS=function(n,t,i){grt.call(this,n,t,i+"")};tb.setProperty=function(n,t,i){nut.call(this,n,t+"",i)}}n.ascending=gi;n.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN};n.min=function(n,t){var u,i,r=-1,f=n.length;if(1===arguments.length){for(;++r<f;)if(null!=(i=n[r])&&i>=i){u=i;break}for(;++r<f;)null!=(i=n[r])&&u>i&&(u=i)}else{for(;++r<f;)if(null!=(i=t.call(n,n[r],r))&&i>=i){u=i;break}for(;++r<f;)null!=(i=t.call(n,n[r],r))&&u>i&&(u=i)}return u};n.max=function(n,t){var u,i,r=-1,f=n.length;if(1===arguments.length){for(;++r<f;)if(null!=(i=n[r])&&i>=i){u=i;break}for(;++r<f;)null!=(i=n[r])&&i>u&&(u=i)}else{for(;++r<f;)if(null!=(i=t.call(n,n[r],r))&&i>=i){u=i;break}for(;++r<f;)null!=(i=t.call(n,n[r],r))&&i>u&&(u=i)}return u};n.extent=function(n,t){var u,i,f,r=-1,e=n.length;if(1===arguments.length){for(;++r<e;)if(null!=(i=n[r])&&i>=i){u=f=i;break}for(;++r<e;)null!=(i=n[r])&&(u>i&&(u=i),i>f&&(f=i))}else{for(;++r<e;)if(null!=(i=t.call(n,n[r],r))&&i>=i){u=f=i;break}for(;++r<e;)null!=(i=t.call(n,n[r],r))&&(u>i&&(u=i),i>f&&(f=i))}return[u,f]};n.sum=function(n,t){var r,u=0,f=n.length,i=-1;if(1===arguments.length)for(;++i<f;)lt(r=+n[i])&&(u+=r);else for(;++i<f;)lt(r=+t.call(n,n[i],i))&&(u+=r);return u};n.mean=function(n,t){var r,f=0,e=n.length,i=-1,u=e;if(1===arguments.length)for(;++i<e;)lt(r=oi(n[i]))?f+=r:--u;else for(;++i<e;)lt(r=oi(t.call(n,n[i],i)))?f+=r:--u;if(u)return f/u};n.quantile=function(n,t){var u=(n.length-1)*t+1,i=Math.floor(u),r=+n[i-1],f=u-i;return f?r+f*(n[i]-r):r};n.median=function(t,i){var u,f=[],e=t.length,r=-1;if(1===arguments.length)for(;++r<e;)lt(u=oi(t[r]))&&f.push(u);else for(;++r<e;)lt(u=oi(i.call(t,t[r],r)))&&f.push(u);if(f.length)return n.quantile(f.sort(gi),.5)};n.variance=function(n,t){var i,r,s=n.length,u=0,o=0,f=-1,e=0;if(1===arguments.length)for(;++f<s;)lt(i=oi(n[f]))&&(r=i-u,u+=r/++e,o+=r*(i-u));else for(;++f<s;)lt(i=oi(t.call(n,n[f],f)))&&(r=i-u,u+=r/++e,o+=r*(i-u));if(e>1)return o/(e-1)};n.deviation=function(){var t=n.variance.apply(this,arguments);return t?Math.sqrt(t):t};nc=vl(gi);n.bisectLeft=nc.left;n.bisect=n.bisectRight=nc.right;n.bisector=function(n){return vl(1===n.length?function(t,i){return gi(n(t),i)}:n)};n.shuffle=function(n,t,i){(r=arguments.length)<3&&(i=n.length,2>r&&(t=0));for(var f,u,r=i-t;r;)u=Math.random()*r--|0,f=n[r+t],n[r+t]=n[u+t],n[u+t]=f;return n};n.permute=function(n,t){for(var i=t.length,r=new Array(i);i--;)r[i]=n[t[i]];return r};n.pairs=function(n){for(var f,t=0,i=n.length-1,r=n[0],u=new Array(0>i?0:i);i>t;)u[t]=[f=r,r=n[++t]];return u};n.zip=function(){var r,t,e;if(!(r=arguments.length))return[];for(var i=-1,u=n.min(arguments,ek),f=new Array(u);++i<u;)for(t=-1,e=f[i]=new Array(r);++t<r;)e[t]=arguments[t][i];return f};n.transpose=function(t){return n.zip.apply(n,t)};n.keys=function(n){var t=[];for(var i in n)t.push(i);return t};n.values=function(n){var t=[];for(var i in n)t.push(n[i]);return t};n.entries=function(n){var t=[];for(var i in n)t.push({key:i,value:n[i]});return t};n.merge=function(n){for(var t,i,r,u=n.length,e=-1,f=0;++e<u;)f+=n[e].length;for(i=new Array(f);--u>=0;)for(r=n[u],t=r.length;--t>=0;)i[--f]=r[t];return i};r=Math.abs;n.range=function(n,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=n,n=0)),(t-n)/i==1/0)throw new Error("infinite range");var f,e=[],u=ok(r(i)),o=-1;if(n*=u,t*=u,i*=u,0>i)for(;(f=n+i*++o)>t;)e.push(f/u);else for(;(f=n+i*++o)<t;)e.push(f/u);return e};n.map=function(n,t){var r=new at,e,i,u,f;if(n instanceof at)n.forEach(function(n,t){r.set(n,t)});else if(Array.isArray(n))if(i=-1,u=n.length,1===arguments.length)for(;++i<u;)r.set(i,n[i]);else for(;++i<u;)r.set(t.call(n,e=n[i],i),e);else for(f in n)r.set(f,n[f]);return r};ib="__proto__";te="\x00";yl(at,{has:pl,get:function(n){return this._[lr(n)]},set:function(n,t){return this._[lr(n)]=t},remove:wl,keys:bl,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:yu(t),value:this._[t]});return n},size:kl,empty:dl,forEach:function(n){for(var t in this._)n.call(this,yu(t),this._[t])}});n.nest=function(){function r(n,e,o){if(o>=i.length)return f?f.call(t,e):u?e.sort(u):e;for(var l,s,h,a,v=-1,y=e.length,p=i[o++],c=new at;++v<y;)(a=c.get(l=p(s=e[v])))?a.push(s):c.set(l,[s]);return n?(s=n(),h=function(t,i){s.set(t,r(n,i,o))}):(s={},h=function(t,i){s[t]=r(n,i,o)}),c.forEach(h),s}function e(n,t){if(t>=i.length)return n;var r=[],u=o[t++];return n.forEach(function(n,i){r.push({key:n,values:e(i,t)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var u,f,t={},i=[],o=[];return t.map=function(n,t){return r(t,n,0)},t.entries=function(t){return e(r(n.map,t,0),0)},t.key=function(n){return i.push(n),t},t.sortKeys=function(n){return o[i.length-1]=n,t},t.sortValues=function(n){return u=n,t},t.rollup=function(n){return f=n,t},t};n.set=function(n){var i=new oo,t,r;if(n)for(t=0,r=n.length;r>t;++t)i.add(n[t]);return i};yl(oo,{has:pl,add:function(n){return this._[lr(n+="")]=!0,n},remove:wl,values:bl,size:kl,empty:dl,forEach:function(n){for(var t in this._)n.call(this,yu(t))}});n.behavior={};n.rebind=function(n,t){for(var i,r=1,u=arguments.length;++r<u;)n[i=arguments[r]]=sk(n,t,t[i]);return n};tc=["webkit","ms","moz","Moz","o","O"];n.dispatch=function(){for(var n=new ho,t=-1,i=arguments.length;++t<i;)n[arguments[t]]=gl(n);return n};ho.prototype.on=function(n,t){var r=n.indexOf("."),i="";if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n)return arguments.length<2?this[n].on(i):this[n].on(i,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(i,null);return this}};n.event=null;n.requote=function(n){return n.replace(tut,"\\$&")};var tut=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ie={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)n[i]=t[i]},ic=function(n,t){return t.querySelector(n)},rc=function(n,t){return t.querySelectorAll(n)},uc=function(n,t){var i=n.matches||n[so(n,"matchesSelector")];return(uc=function(n,t){return i.call(n,t)})(n,t)};"function"==typeof Sizzle&&(ic=function(n,t){return Sizzle(n,t)[0]||null},rc=Sizzle,uc=Sizzle.matchesSelector);n.selection=function(){return n.select(p.documentElement)};e=n.selection.prototype=[];e.select=function(n){var i,f,e,t,o=[],r,s,u,h;for(n=ao(n),r=-1,s=this.length;++r<s;)for(o.push(i=[]),i.parentNode=(e=this[r]).parentNode,u=-1,h=e.length;++u<h;)(t=e[u])?(i.push(f=n.call(t,t.__data__,u,r)),f&&"__data__"in t&&(f.__data__=t.__data__)):i.push(null);return dt(o)};e.selectAll=function(n){var u,t,f=[],i,e;for(n=na(n),i=-1,e=this.length;++i<e;)for(var o=this[i],r=-1,s=o.length;++r<s;)(t=o[r])&&(f.push(u=ot(n.call(t,t.__data__,r,i))),u.parentNode=t);return dt(f)};re={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};n.ns={prefix:re,qualify:function(n){var t=n.indexOf(":"),i=n;return t>=0&&"xmlns"!==(i=n.slice(0,t))&&(n=n.slice(t+1)),re.hasOwnProperty(i)?{space:re[i],local:n}:n}};e.attr=function(t,i){if(arguments.length<2){if("string"==typeof t){var r=this.node();return t=n.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(i in t)this.each(ta(i,t[i]));return this}return this.each(ta(t,i))};e.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var r=this.node(),u=(n=ua(n)).length,i=-1;if(t=r.classList){for(;++i<u;)if(!t.contains(n[i]))return!1}else for(t=r.getAttribute("class");++i<u;)if(!ra(n[i]).test(t))return!1;return!0}for(t in n)this.each(fa(t,n[t]));return this}return this.each(fa(n,t))};e.style=function(n,t,i){var r=arguments.length,u;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.each(ea(i,n[i],t));return this}if(2>r)return u=this.node(),bt(u).getComputedStyle(u,null).getPropertyValue(n);i=""}return this.each(ea(n,t,i))};e.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(oa(t,n[t]));return this}return this.each(oa(n,t))};e.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent};e.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML};e.append=function(n){return n=sa(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})};e.insert=function(n,t){return n=sa(n),t=ao(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})};e.remove=function(){return this.each(ck)};e.data=function(n,t){function e(n,i){var r,u,e,o=n.length,a=i.length,b=Math.min(o,a),v=new Array(a),c=new Array(a),y=new Array(o),p,l,w;if(t){for(l=new at,w=new Array(o),r=-1;++r<o;)(u=n[r])&&(l.has(p=t.call(u,u.__data__,r))?y[r]=u:l.set(p,u),w[r]=p);for(r=-1;++r<a;)(u=l.get(p=t.call(i,e=i[r],r)))?u!==!0&&(v[r]=u,u.__data__=e):c[r]=vo(e),l.set(p,!0);for(r=-1;++r<o;)r in w&&l.get(w[r])!==!0&&(y[r]=n[r])}else{for(r=-1;++r<b;)u=n[r],e=i[r],u?(u.__data__=e,v[r]=u):c[r]=vo(e);for(;a>r;++r)c[r]=vo(i[r]);for(;o>r;++r)y[r]=n[r]}c.update=v;c.parentNode=v.parentNode=y.parentNode=n.parentNode;s.push(c);f.push(v);h.push(y)}var r,o,i=-1,u=this.length;if(!arguments.length){for(n=new Array(u=(r=this[0]).length);++i<u;)(o=r[i])&&(n[i]=o.__data__);return n}var s=ca([]),f=dt([]),h=dt([]);if("function"==typeof n)for(;++i<u;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<u;)e(r=this[i],n);return f.enter=function(){return s},f.exit=function(){return h},f};e.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")};e.filter=function(n){var u,f,r,e=[],t,o,i,s;for("function"!=typeof n&&(n=ha(n)),t=0,o=this.length;o>t;t++)for(e.push(u=[]),u.parentNode=(f=this[t]).parentNode,i=0,s=f.length;s>i;i++)(r=f[i])&&n.call(r,r.__data__,i,t)&&u.push(r);return dt(e)};e.order=function(){for(var i=-1,f=this.length;++i<f;)for(var t,r=this[i],u=r.length-1,n=r[u];--u>=0;)(t=r[u])&&(n&&n!==t.nextSibling&&n.parentNode.insertBefore(t,n),n=t);return this};e.sort=function(n){n=lk.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(n);return this.order()};e.each=function(n){return vt(this,function(t,i,r){n.call(t,t.__data__,i,r)})};e.call=function(n){var t=ot(arguments);return n.apply(t[0]=this,t),this};e.empty=function(){return!this.node()};e.node=function(){for(var i,n=0,r=this.length;r>n;n++)for(var u=this[n],t=0,f=u.length;f>t;t++)if(i=u[t],i)return i;return null};e.size=function(){var n=0;return vt(this,function(){++n}),n};st=[];n.selection.enter=ca;n.selection.enter.prototype=st;st.append=e.append;st.empty=e.empty;st.node=e.node;st.call=e.call;st.size=e.size;st.select=function(n){for(var i,h,r,e,o,t,u,s=[],f=-1,c=this.length;++f<c;)for(o=(t=this[f]).update,s.push(r=[]),r.parentNode=t.parentNode,i=-1,h=t.length;++i<h;)(u=t[i])?(r.push(o[i]=e=n.call(t.parentNode,u.__data__,i,f)),e.__data__=u.__data__):r.push(null);return dt(s)};st.insert=function(n,t){return arguments.length<2&&(t=ak(this)),e.insert.call(this,n,t)};n.select=function(n){var t;return"string"==typeof n?(t=[ic(n,p)],t.parentNode=p.documentElement):(t=[n],t.parentNode=al(n)),dt([t])};n.selectAll=function(n){var t;return"string"==typeof n?(t=ot(rc(n,p)),t.parentNode=p.documentElement):(t=ot(n),t.parentNode=null),dt([t])};e.on=function(n,t,i){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(i in n)this.each(la(i,n[i],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;i=!1}return this.each(la(n,t,i))};ue=n.map({mouseenter:"mouseover",mouseleave:"mouseout"});p&&ue.forEach(function(n){"on"+n in p&&ue.remove(n)});rb=0;n.mouse=function(n){return yo(n,co())};fe=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;n.touch=function(n,t,i){if(arguments.length<3&&(i=t,t=co().changedTouches),t)for(var u,r=0,f=t.length;f>r;++r)if((u=t[r]).identifier===i)return yo(n,u)};n.behavior.drag=function(){function t(){this.on("mousedown.drag",f).on("touchstart.drag",e)}function r(t,r,f,e,o){return function(){function b(){var t,i,n=r(v,h);n&&(t=n[0]-c[0],i=n[1]-c[1],w|=t|i,c=n,y({type:"drag",x:n[0]+s[0],y:n[1]+s[1],dx:t,dy:i}))}function k(){r(v,h)&&(d.on(e+l,null).on(o+l,null),g(w),y({type:"dragend"}))}var s,a=this,p=n.event.target,v=a.parentNode,y=u.of(a,arguments),w=0,h=t(),l=".drag"+(null==h?"":"-"+h),d=n.select(f(p)).on(e+l,b).on(o+l,k),g=pu(p),c=r(v,h);i?(s=i.apply(a,arguments),s=[s.x-c[0],s.y-c[1]]):s=[0,0];y({type:"dragstart"})}}var u=lo(t,"drag","dragstart","dragend"),i=null,f=r(l,n.mouse,bt,"mousemove","mouseup"),e=r(yk,n.touch,v,"touchmove","touchend");return t.origin=function(n){return arguments.length?(i=n,t):i},n.rebind(t,u,"on")};n.touches=function(n,t){return arguments.length<2&&(t=co().touches),t?ot(t).map(function(t){var i=yo(n,t);return i.identifier=t.identifier,i}):[]};var t=1e-6,ee=t*t,f=Math.PI,d=2*f,iut=d-t,h=f/2,u=f/180,s=180/f,uu=Math.SQRT2,fc=2,ub=4;n.interpolateZoom=function(n,t){var e,u,c=n[0],l=n[1],i=n[2],p=t[0],w=t[1],r=t[2],o=p-c,s=w-l,h=o*o+s*s;if(ee>h)u=Math.log(r/i)/uu,e=function(n){return[c+n*o,l+n*s,i*Math.exp(uu*n*u)]};else{var a=Math.sqrt(h),v=(r*r-i*i+ub*h)/(2*i*fc*a),y=(r*r-i*i-ub*h)/(2*r*fc*a),f=Math.log(Math.sqrt(v*v+1)-v),b=Math.log(Math.sqrt(y*y+1)-y);u=(b-f)/uu;e=function(n){var t=n*u,r=pa(f),e=i/(fc*a)*(r*wk(uu*t+f)-pk(f));return[c+e*o,l+e*s,i*r/pa(uu*t+f)]}}return e.duration=1e3*u,e};n.behavior.zoom=function(){function i(n){n.on(it,ft).on(ec+".zoom",at).on("dblclick.zoom",vt).on(rt,et)}function s(n){return[(n[0]-t.x)/t.k,(n[1]-t.y)/t.k]}function lt(n){return[n[0]*t.k+t.x,n[1]*t.k+t.y]}function h(n){t.k=Math.max(w[0],Math.min(w[1],n))}function c(n,i){i=lt(i);t.x+=n[0]-i[0];t.y+=n[1]-i[1]}function ut(u,f,e,o){u.__chart__={x:t.x,y:t.y,k:t.k};h(Math.pow(2,o));c(r=f,e);u=n.select(u);b>0&&(u=u.transition().duration(b));u.call(i.event)}function k(){a&&a.domain(nt.range().map(function(n){return(n-t.x)/t.k}).map(nt.invert));v&&v.domain(tt.range().map(function(n){return(n-t.y)/t.k}).map(tt.invert))}function f(n){st++||n({type:"zoomstart"})}function e(n){k();n({type:"zoom",scale:t.k,translate:[t.x,t.y]})}function u(n){--st||(n({type:"zoomend"}),r=null)}function ft(){function h(){r=1;c(n.mouse(t),v);e(i)}function l(){a.on(ht,null).on(ct,null);y(r);u(i)}var t=this,i=o.of(t,arguments),r=0,a=n.select(bt(t)).on(ht,h).on(ct,l),v=s(n.mouse(t)),y=pu(t);fo.call(t);f(i)}function et(){function y(){var u=n.touches(i);return w=t.k,u.forEach(function(n){n.identifier in r&&(r[n.identifier]=s(n))}),u}function p(){var s=n.event.target,u,o,f;n.select(s).on(tt,d).on(ot,nt);b.push(s);for(var h=n.event.changedTouches,e=0,p=h.length;p>e;++e)r[h[e].identifier]=null;if(u=y(),o=Date.now(),1===u.length)500>o-g&&(f=u[0],ut(i,f,r[f.identifier],Math.floor(Math.log(t.k)/Math.LN2)+1),kt()),g=o;else if(u.length>1){var f=u[0],c=u[1],l=f[0]-c[0],v=f[1]-c[1];a=l*l+v*v}}function d(){var t,f,u,o,y=n.touches(i),v,p,s,b;for(fo.call(i),v=0,p=y.length;p>v;++v,o=null)if(u=y[v],o=r[u.identifier]){if(f)break;t=u;f=o}o&&(s=(s=u[0]-t[0])*s+(s=u[1]-t[1])*s,b=a&&Math.sqrt(s/a),t=[(t[0]+u[0])/2,(t[1]+u[1])/2],f=[(f[0]+o[0])/2,(f[1]+o[1])/2],h(b*w));g=null;c(t,f);e(l)}function nt(){var e;if(n.event.touches.length){for(var i=n.event.changedTouches,t=0,f=i.length;f>t;++t)delete r[i[t].identifier];for(e in r)return void y()}n.selectAll(b).on(v,null);k.on(it,ft).on(rt,et);st();u(l)}var w,i=this,l=o.of(i,arguments),r={},a=0,v=".zoom-"+n.event.changedTouches[0].identifier,tt="touchmove"+v,ot="touchend"+v,b=[],k=n.select(i),st=pu(i);p();f(l);k.on(it,null).on(rt,p)}function at(){var i=o.of(this,arguments);l?clearTimeout(l):(fo.call(this),ot=s(r=d||n.mouse(this)),f(i));l=setTimeout(function(){l=null;u(i)},50);kt();h(Math.pow(2,.002*oe())*t.k);c(r,ot);e(i)}function vt(){var i=n.mouse(this),r=Math.log(t.k)/Math.LN2;ut(this,i,s(i),n.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)}var ot,r,d,l,g,nt,a,tt,v,t={x:0,y:0,k:1},y=[960,500],w=oc,b=250,st=0,it="mousedown.zoom",ht="mousemove.zoom",ct="mouseup.zoom",rt="touchstart.zoom",o=lo(i,"zoomstart","zoom","zoomend");return ec||(ec="onwheel"in p?(oe=function(){return-n.event.deltaY*(n.event.deltaMode?120:1)},"wheel"):"onmousewheel"in p?(oe=function(){return n.event.wheelDelta},"mousewheel"):(oe=function(){return-n.event.detail},"MozMousePixelScroll")),i.event=function(i){i.each(function(){var i=o.of(this,arguments),s=t;di?n.select(this).transition().each("start.zoom",function(){t=this.__chart__||{x:0,y:0,k:1};f(i)}).tween("zoom:zoom",function(){var u=y[0],h=y[1],f=r?r[0]:u/2,o=r?r[1]:h/2,c=n.interpolateZoom([(f-t.x)/t.k,(o-t.y)/t.k,u/t.k],[(f-s.x)/s.k,(o-s.y)/s.k,u/s.k]);return function(n){var r=c(n),s=u/r[2];this.__chart__=t={x:f-r[0]*s,y:o-r[1]*s,k:s};e(i)}}).each("interrupt.zoom",function(){u(i)}).each("end.zoom",function(){u(i)}):(this.__chart__=t,f(i),e(i),u(i))})},i.translate=function(n){return arguments.length?(t={x:+n[0],y:+n[1],k:t.k},k(),i):[t.x,t.y]},i.scale=function(n){return arguments.length?(t={x:t.x,y:t.y,k:null},h(+n),k(),i):t.k},i.scaleExtent=function(n){return arguments.length?(w=null==n?oc:[+n[0],+n[1]],i):w},i.center=function(n){return arguments.length?(d=n&&[+n[0],+n[1]],i):d},i.size=function(n){return arguments.length?(y=n&&[+n[0],+n[1]],i):y},i.duration=function(n){return arguments.length?(b=+n,i):b},i.x=function(n){return arguments.length?(a=n,nt=n.copy(),t={x:0,y:0,k:1},i):a},i.y=function(n){return arguments.length?(v=n,tt=n.copy(),t={x:0,y:0,k:1},i):v},n.rebind(i,o,"on")};oc=[0,1/0];n.color=si;si.prototype.toString=function(){return this.rgb()+""};n.hsl=ft;se=ft.prototype=new si;se.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ft(this.h,this.s,this.l/n)};se.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ft(this.h,this.s,n*this.l)};se.rgb=function(){return wo(this.h,this.s,this.l)};n.hcl=nt;he=nt.prototype=new si;he.brighter=function(n){return new nt(this.h,this.c,Math.min(100,this.l+ce*(arguments.length?n:1)))};he.darker=function(n){return new nt(this.h,this.c,Math.max(0,this.l-ce*(arguments.length?n:1)))};he.rgb=function(){return bo(this.h,this.c,this.l).rgb()};n.lab=tt;var ce=18,fb=.95047,eb=1,ob=1.08883,sc=tt.prototype=new si;sc.brighter=function(n){return new tt(Math.min(100,this.l+ce*(arguments.length?n:1)),this.a,this.b)};sc.darker=function(n){return new tt(Math.max(0,this.l-ce*(arguments.length?n:1)),this.a,this.b)};sc.rgb=function(){return ba(this.l,this.a,this.b)};n.rgb=b;fu=b.prototype=new si;fu.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var i=this.r,r=this.g,u=this.b,t=30;return i||r||u?(i&&t>i&&(i=t),r&&t>r&&(r=t),u&&t>u&&(u=t),new b(Math.min(255,i/n),Math.min(255,r/n),Math.min(255,u/n))):new b(t,t,t)};fu.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new b(n*this.r,n*this.g,n*this.b)};fu.hsl=function(){return nv(this.r,this.g,this.b)};fu.toString=function(){return"#"+nr(this.r)+nr(this.g)+nr(this.b)};eu=n.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});eu.forEach(function(n,t){eu.set(n,da(t))});n.functor=o;n.xhr=rs(v);n.dsv=function(n,t){function i(n,i,r){arguments.length<3&&(r=i,i=null);var e=bu(n,t,null==i?u:f(i),r);return e.row=function(n){return arguments.length?e.response(null==(i=n)?u:f(n)):i},e}function u(n){return i.parse(n.responseText)}function f(n){return function(t){return i.parse(t.responseText,n)}}function e(t){return t.map(r).join(n)}function r(n){return o.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var o=new RegExp('["'+n+"\n]"),s=n.charCodeAt(0);return i.parse=function(n,t){var r;return i.parseRows(n,function(n,i){if(r)return r(n,i-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,i){return t(u(n),i)}:u})},i.parseRows=function(n,t){function h(){var f,t,u,h;if(i>=o)return e;if(r)return r=!1,c;if(f=i,34===n.charCodeAt(f)){for(t=f;t++<o;)if(34===n.charCodeAt(t)){if(34!==n.charCodeAt(t+1))break;++t}return i=t+2,u=n.charCodeAt(t+1),13===u?(r=!0,10===n.charCodeAt(t+2)&&++i):10===u&&(r=!0),n.slice(f+1,t).replace(/""/g,'"')}for(;o>i;){if(u=n.charCodeAt(i++),h=1,10===u)r=!0;else if(13===u)r=!0,10===n.charCodeAt(i)&&(++i,++h);else if(u!==s)continue;return n.slice(f,i-h)}return n.slice(f)}for(var f,u,r,c={},e={},l=[],o=n.length,i=0,a=0;(u=h())!==e;){for(f=[];u!==c&&u!==e;)f.push(u),u=h();t&&null==(f=t(f,a++))||l.push(f)}return l},i.format=function(t){if(Array.isArray(t[0]))return i.formatRows(t);var f=new oo,u=[];return t.forEach(function(n){for(var t in n)f.has(t)||u.push(f.add(t))}),[u.map(r).join(n)].concat(t.map(function(t){return u.map(function(n){return r(t[n])}).join(n)})).join("\n")},i.formatRows=function(n){return n.map(e).join("\n")},i};n.csv=n.dsv(",","text/csv");n.tsv=n.dsv("\t","text/tab-separated-values");hc=this[so(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};n.timer=function(){ku.apply(this,arguments)};n.timer.flush=function(){iv();rv()};n.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};sb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(dk);n.formatPrefix=function(t,i){var r=0;return(t=+t)&&(0>t&&(t*=-1),i&&(t=n.round(t,fs(t,i))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r-1)/3)))),sb[8+r/3]};var hb=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,rut=n.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(t,i){return(t=n.round(t,fs(t,i))).toFixed(Math.max(0,Math.min(20,fs(t*(1+1e-15),i))))}}),i=n.time={},y=Date;yt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ht.setUTCDate.apply(this._,arguments)},setDay:function(){ht.setUTCDay.apply(this._,arguments)},setFullYear:function(){ht.setUTCFullYear.apply(this._,arguments)},setHours:function(){ht.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ht.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ht.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ht.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ht.setUTCSeconds.apply(this._,arguments)},setTime:function(){ht.setTime.apply(this._,arguments)}};ht=Date.prototype;i.year=hi(function(n){return n=i.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()});i.years=i.year.range;i.years.utc=i.year.utc.range;i.day=hi(function(n){var t=new y(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1});i.days=i.day.range;i.days.utc=i.day.utc.range;i.dayOfYear=function(n){var t=i.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var r=i[n]=hi(function(n){return(n=i.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var r=i.year(n).getDay();return Math.floor((i.dayOfYear(n)+(r+t)%7)/7)-(r!==t)});i[n+"s"]=r.range;i[n+"s"].utc=r.utc.range;i[n+"OfYear"]=function(n){var r=i.year(n).getDay();return Math.floor((i.dayOfYear(n)+(r+t)%7)/7)}});i.week=i.sunday;i.weeks=i.sunday.range;i.weeks.utc=i.sunday.utc.range;i.weekOfYear=i.sundayOfYear;var cb={"-":"",_:" ",0:"0"},c=/^\s*\d+/,lb=/^%/;n.locale=function(n){return{numberFormat:gk(n),timeFormat:td(n)}};cc=n.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});n.format=cc.numberFormat;n.geo={};es.prototype={s:0,t:0,add:function(n){ev(n,this.t,ou);ev(ou.s,this.s,this);this.s?this.t+=ou.t:this.s=ou.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};ou=new es;n.geo.stream=function(n,t){n&&lc.hasOwnProperty(n.type)?lc[n.type](n,t):tf(n,t)};lc={Feature:function(n,t){tf(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,r=-1,u=i.length;++r<u;)tf(i[r].geometry,t)}};ac={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates;t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)n=i[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){os(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)os(i[r],t,0)},Polygon:function(n,t){ov(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)ov(i[r],t)},GeometryCollection:function(n,t){for(var i=n.geometries,r=-1,u=i.length;++r<u;)tf(i[r],t)}};n.geo.area=function(t){return pe=0,n.geo.stream(t,k),pe};ti=new es;k={sphere:function(){pe+=4*f},point:l,lineStart:l,lineEnd:l,polygonStart:function(){ti.reset();k.lineStart=bd},polygonEnd:function(){var n=2*ti;pe+=0>n?4*f+n:n;k.lineStart=k.lineEnd=k.point=l}};n.geo.bounds=function(){function w(n,t){v.push(l=[i=n,f=n]);o>t&&(o=t);t>h&&(h=t)}function b(n,t){var d=ci([n*u,t*u]),v;if(y){var b=tr(y,d),nt=[b[1],-b[0],0],c=tr(nt,b);ff(c);c=ef(c);var g=n-a,p=g>0?1:-1,l=c[0]*s*p,k=r(g)>180;k^(l>p*a&&p*n>l)?(v=c[1]*s,v>h&&(h=v)):(l=(l+360)%360-180,k^(l>p*a&&p*n>l))?(v=-c[1]*s,o>v&&(o=v)):(o>t&&(o=t),t>h&&(h=t));k?a>n?e(i,n)>e(i,f)&&(f=n):e(n,f)>e(i,f)&&(i=n):f>=i?(i>n&&(i=n),n>f&&(f=n)):n>a?e(i,n)>e(i,f)&&(f=n):e(n,f)>e(i,f)&&(i=n)}else w(n,t);y=d;a=n}function d(){c.point=b}function g(){l[0]=i;l[1]=f;c.point=w;y=null}function nt(n,t){if(y){var i=n-a;p+=r(i)>180?i+(i>0?360:-360):i}else it=n,rt=t;k.point(n,t);b(n,t)}function ut(){k.lineStart()}function ft(){nt(it,rt);k.lineEnd();r(p)>t&&(i=-(f=180));l[0]=i;l[1]=f;y=null}function e(n,t){return(t-=n)<0?t+360:t}function et(n,t){return n[0]-t[0]}function tt(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var i,o,f,h,a,it,rt,y,p,v,l,c={point:w,lineStart:d,lineEnd:g,polygonStart:function(){c.point=nt;c.lineStart=ut;c.lineEnd=ft;p=0;k.polygonStart()},polygonEnd:function(){k.polygonEnd();c.point=w;c.lineStart=d;c.lineEnd=g;0>ti?(i=-(f=180),o=-(h=90)):p>t?h=90:-t>p&&(o=-90);l[0]=i;l[1]=f}};return function(t){var a;if(h=f=-(i=o=1/0),v=[],n.geo.stream(t,c),a=v.length,a){v.sort(et);for(var u,s=1,r=v[0],y=[r];a>s;++s)u=v[s],tt(u[0],r)||tt(u[1],r)?(e(r[0],u[1])>e(r[0],r[1])&&(r[1]=u[1]),e(u[0],r[1])>e(r[0],r[1])&&(r[0]=u[0])):y.push(r=u);for(var p,u,w=-(1/0),a=y.length-1,s=0,r=y[a];a>=s;r=u,++s)u=y[s],(p=e(r[1],u[0]))>w&&(w=p,i=u[0],f=r[1])}return v=l=null,i===1/0||o===1/0?[[NaN,NaN],[NaN,NaN]]:[[i,o],[f,h]]}}();n.geo.centroid=function(i){su=we=pi=wi=wt=ii=ri=ct=or=sr=ui=0;n.geo.stream(i,rt);var r=or,u=sr,f=ui,e=r*r+u*u+f*f;return ee>e&&(r=ii,u=ri,f=ct,t>we&&(r=pi,u=wi,f=wt),e=r*r+u*u+f*f,ee>e)?[NaN,NaN]:[Math.atan2(u,r)*s,gt(f/Math.sqrt(e))*s]};var su,we,pi,wi,wt,ii,ri,ct,or,sr,ui,rt={sphere:l,point:hs,lineStart:sv,lineEnd:hv,polygonStart:function(){rt.lineStart=kd},polygonEnd:function(){rt.lineStart=sv}},ab=vv(vr,ng,ig,[-f,-f/2]),be=1e9;n.geo.clipExtent=function(){var t,i,r,u,n,f,e={stream:function(t){return n&&(n.valid=!1),n=f(t),n.valid=!0,n},extent:function(o){return arguments.length?(f=wv(t=+o[0][0],i=+o[0][1],r=+o[1][0],u=+o[1][1]),n&&(n.valid=!1,n=null),e):[[t,i],[r,u]]}};return e.extent([[0,0],[960,500]])};(n.geo.conicEqualArea=function(){return cs(bv)}).raw=bv;n.geo.albers=function(){return n.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};n.geo.albersUsa=function(){function r(n){var t=n[0],i=n[1];return u=null,s(t,i),u||(h(t,i),u)||c(t,i),u}var u,s,h,c,i=n.geo.albers(),f=n.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),e=n.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o={point:function(n,t){u=[n,t]}};return r.invert=function(n){var u=i.scale(),o=i.translate(),t=(n[0]-o[0])/u,r=(n[1]-o[1])/u;return(r>=.12&&.234>r&&t>=-.425&&-.214>t?f:r>=.166&&.234>r&&t>=-.214&&-.115>t?e:i).invert(n)},r.stream=function(n){var t=i.stream(n),r=f.stream(n),u=e.stream(n);return{point:function(n,i){t.point(n,i);r.point(n,i);u.point(n,i)},sphere:function(){t.sphere();r.sphere();u.sphere()},lineStart:function(){t.lineStart();r.lineStart();u.lineStart()},lineEnd:function(){t.lineEnd();r.lineEnd();u.lineEnd()},polygonStart:function(){t.polygonStart();r.polygonStart();u.polygonStart()},polygonEnd:function(){t.polygonEnd();r.polygonEnd();u.polygonEnd()}}},r.precision=function(n){return arguments.length?(i.precision(n),f.precision(n),e.precision(n),r):i.precision()},r.scale=function(n){return arguments.length?(i.scale(n),f.scale(.35*n),e.scale(n),r.translate(i.translate())):i.scale()},r.translate=function(n){if(!arguments.length)return i.translate();var u=i.scale(),l=+n[0],a=+n[1];return s=i.translate(n).clipExtent([[l-.455*u,a-.238*u],[l+.455*u,a+.238*u]]).stream(o).point,h=f.translate([l-.307*u,a+.201*u]).clipExtent([[l-.425*u+t,a+.12*u+t],[l-.214*u-t,a+.234*u-t]]).stream(o).point,c=e.translate([l-.205*u,a+.212*u]).clipExtent([[l-.214*u+t,a+.166*u+t],[l-.115*u-t,a+.234*u-t]]).stream(o).point,r},r.scale(1070)};var vc,yc,ke,de,ge,no,fi={point:l,lineStart:l,lineEnd:l,polygonStart:function(){yc=0;fi.lineStart=fg},polygonEnd:function(){fi.lineStart=fi.lineEnd=fi.point=l;vc+=r(yc/2)}},uut={point:eg,lineStart:l,lineEnd:l,polygonStart:l,polygonEnd:l},ut={point:li,lineStart:dv,lineEnd:gv,polygonStart:function(){ut.lineStart=sg},polygonEnd:function(){ut.point=li;ut.lineStart=dv;ut.lineEnd=gv}};n.geo.path=function(){function t(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),f&&f.valid||(f=u(i)),n.geo.stream(t,f)),i.result()}function e(){return f=null,t}var o,s,u,i,f,r=4.5;return t.area=function(t){return vc=0,n.geo.stream(t,u(fi)),vc},t.centroid=function(t){return pi=wi=wt=ii=ri=ct=or=sr=ui=0,n.geo.stream(t,u(ut)),ui?[or/ui,sr/ui]:ct?[ii/ct,ri/ct]:wt?[pi/wt,wi/wt]:[NaN,NaN]},t.bounds=function(t){return ge=no=-(ke=de=1/0),n.geo.stream(t,u(uut)),[[ke,de],[ge,no]]},t.projection=function(n){return arguments.length?(u=(o=n)?n.stream||cg(n):v,e()):o},t.context=function(n){return arguments.length?(i=null==(s=n)?new og:new hg(n),"function"!=typeof r&&i.pointRadius(r),e()):s},t.pointRadius=function(n){return arguments.length?(r="function"==typeof n?n:(i.pointRadius(+n),+n),t):r},t.projection(n.geo.albersUsa()).context(null)};n.geo.transform=function(n){return{stream:function(t){var i=new ty(t);for(var r in n)i[r]=n[r];return i}}};ty.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};n.geo.projection=ni;n.geo.projectionMutator=ls;(n.geo.equirectangular=function(){return ni(yr)}).raw=yr.invert=yr;n.geo.rotation=function(n){function t(t){return t=n(t[0]*u,t[1]*u),t[0]*=s,t[1]*=s,t}return n=as(n[0]%360*u,n[1]*u,n.length>2?n[2]*u:0),t.invert=function(t){return t=n.invert(t[0]*u,t[1]*u),t[0]*=s,t[1]*=s,t},t};uy.invert=yr;n.geo.circle=function(){function n(){var n="function"==typeof t?t.apply(this,arguments):t,f=as(-n[0]*u,-n[1]*u,0).invert,i=[];return r(null,null,1,{point:function(n,t){i.push(n=f(n,t));n[0]*=s;n[1]*=s}}),{type:"Polygon",coordinates:[i]}}var i,r,t=[0,0],f=6;return n.origin=function(i){return arguments.length?(t=i,n):t},n.angle=function(t){return arguments.length?(r=vs((i=+t)*u,f*u),n):i},n.precision=function(t){return arguments.length?(r=vs(i*u,(f=+t)*u),n):f},n.angle(90)};n.geo.distance=function(n,t){var i,f=(t[0]-n[0])*u,e=n[1]*u,o=t[1]*u,a=Math.sin(f),s=Math.cos(f),h=Math.sin(e),c=Math.cos(e),l=Math.sin(o),r=Math.cos(o);return Math.atan2(Math.sqrt((i=r*a)*i+(i=c*l-h*r*s)*i),h*l+c*r*s)};n.geo.graticule=function(){function i(){return{type:"MultiLineString",coordinates:d()}}function d(){return n.range(Math.ceil(f/v)*v,u,v).map(b).concat(n.range(Math.ceil(o/y)*y,e,y).map(k)).concat(n.range(Math.ceil(h/a)*a,s,a).filter(function(n){return r(n%v)>t}).map(g)).concat(n.range(Math.ceil(l/w)*w,c,w).filter(function(n){return r(n%y)>t}).map(nt))}var s,h,u,f,c,l,e,o,g,nt,b,k,a=10,w=a,v=90,y=360,p=2.5;return i.lines=function(){return d().map(function(n){return{type:"LineString",coordinates:n}})},i.outline=function(){return{type:"Polygon",coordinates:[b(f).concat(k(e).slice(1),b(u).reverse().slice(1),k(o).reverse().slice(1))]}},i.extent=function(n){return arguments.length?i.majorExtent(n).minorExtent(n):i.minorExtent()},i.majorExtent=function(n){return arguments.length?(f=+n[0][0],u=+n[1][0],o=+n[0][1],e=+n[1][1],f>u&&(n=f,f=u,u=n),o>e&&(n=o,o=e,e=n),i.precision(p)):[[f,o],[u,e]]},i.minorExtent=function(n){return arguments.length?(h=+n[0][0],s=+n[1][0],l=+n[0][1],c=+n[1][1],h>s&&(n=h,h=s,s=n),l>c&&(n=l,l=c,c=n),i.precision(p)):[[h,l],[s,c]]},i.step=function(n){return arguments.length?i.majorStep(n).minorStep(n):i.minorStep()},i.majorStep=function(n){return arguments.length?(v=+n[0],y=+n[1],i):[v,y]},i.minorStep=function(n){return arguments.length?(a=+n[0],w=+n[1],i):[a,w]},i.precision=function(n){return arguments.length?(p=+n,g=hy(l,c,90),nt=cy(h,s,p),b=hy(o,e,90),k=cy(f,u,p),i):p},i.majorExtent([[-180,-90+t],[180,90-t]]).minorExtent([[-180,-80-t],[180,80+t]])};n.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[u||i.apply(this,arguments),f||r.apply(this,arguments)]}}var u,f,i=ys,r=ps;return t.distance=function(){return n.geo.distance(u||i.apply(this,arguments),f||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,u="function"==typeof n?null:n,t):i},t.target=function(n){return arguments.length?(r=n,f="function"==typeof n?null:n,t):r},t.precision=function(){return arguments.length?t:0},t};n.geo.interpolate=function(n,t){return lg(n[0]*u,n[1]*u,t[0]*u,t[1]*u)};n.geo.length=function(t){return pc=0,n.geo.stream(t,bi),pc};bi={sphere:l,point:l,lineStart:ag,lineEnd:l,polygonStart:l,polygonEnd:l};wc=pr(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(n.geo.azimuthalEqualArea=function(){return ni(wc)}).raw=wc;bc=pr(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},v);(n.geo.azimuthalEquidistant=function(){return ni(bc)}).raw=bc;(n.geo.conicConformal=function(){return cs(ly)}).raw=ly;(n.geo.conicEquidistant=function(){return cs(ay)}).raw=ay;kc=pr(function(n){return 1/n},Math.atan);(n.geo.gnomonic=function(){return ni(kc)}).raw=kc;hf.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-h]};(n.geo.mercator=function(){return vy(hf)}).raw=hf;dc=pr(function(){return 1},Math.asin);(n.geo.orthographic=function(){return ni(dc)}).raw=dc;gc=pr(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(n.geo.stereographic=function(){return ni(gc)}).raw=gc;ws.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-h]};(n.geo.transverseMercator=function(){var n=vy(ws),i=n.center,t=n.rotate;return n.center=function(n){return n?i([-n[1],n[0]]):(n=i(),[n[1],-n[0]])},n.rotate=function(n){return n?t([n[0],n[1],n.length>2?n[2]+90:90]):(n=t(),[n[0],n[1],n[2]-90])},t([0,0,90])}).raw=ws;n.geom={};n.geom.hull=function(n){function t(n){if(n.length<3)return[];for(var l=o(i),a=o(r),h=n.length,u=[],c=[],t=0;h>t;t++)u.push([+l.call(this,n[t],t),+a.call(this,n[t],t),t]);for(u.sort(vg),t=0;h>t;t++)c.push([u[t][0],-u[t][1]]);var f=yy(u),e=yy(c),v=e[0]===f[0],y=e[e.length-1]===f[f.length-1],s=[];for(t=f.length-1;t>=0;--t)s.push(n[u[f[t]][2]]);for(t=+v;t<e.length-y;++t)s.push(n[u[e[t]][2]]);return s}var i=ir,r=wr;return arguments.length?t(n):(t.x=function(n){return arguments.length?(i=n,t):i},t.y=function(n){return arguments.length?(r=n,t):r},t)};n.geom.polygon=function(n){return ie(n,hu),n};hu=n.geom.polygon.prototype=[];hu.area=function(){for(var t,i=-1,r=this.length,n=this[r-1],u=0;++i<r;)t=n,n=this[i],u+=t[1]*n[0]-t[0]*n[1];return.5*u};hu.centroid=function(n){var i,r,u=-1,f=this.length,e=0,o=0,t=this[f-1];for(arguments.length||(n=-1/(6*this.area()));++u<f;)i=t,t=this[u],r=i[0]*t[1]-t[0]*i[1],e+=(i[0]+t[0])*r,o+=(i[1]+t[1])*r;return[e*n,o*n]};hu.clip=function(n){for(var f,e,o,t,i,r,s=py(n),h=-1,c=this.length-py(this),u=this[c-1];++h<c;){for(f=n.slice(),n.length=0,t=this[h],i=f[(o=f.length-s)-1],e=-1;++e<o;)r=f[e],bs(r,u,t)?(bs(i,u,t)||n.push(ks(i,r,u,t)),n.push(r)):bs(i,u,t)&&n.push(ks(i,r,u,t)),i=r;s&&n.push(n[0]);u=t}return n};tl=[];il=[];ky.prototype.prepare=function(){for(var t,n=this.edges,i=n.length;i--;)t=n[i].edge,t.b&&t.a||n.splice(i,1);return n.sort(dy),n.length};lf.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};gs.prototype={insert:function(n,t){var i,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;i=n}else this._?(n=np(this._),t.P=null,t.N=n,n.P=n.L=t,i=n):(t.P=t.N=null,this._=t,i=null);for(t.L=t.R=null,t.U=i,t.C=!0,n=t;i&&i.C;)r=i.U,i===r.L?(u=r.R,u&&u.C?(i.C=u.C=!1,r.C=!0,n=r):(n===i.R&&(kr(this,i),n=i,i=n.U),i.C=!1,r.C=!0,dr(this,r))):(u=r.L,u&&u.C?(i.C=u.C=!1,r.C=!0,n=r):(n===i.L&&(dr(this,i),n=i,i=n.U),i.C=!1,r.C=!0,kr(this,r))),i=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P);n.P&&(n.P.N=n.N);n.N=n.P=null;var t,r,e,i=n.U,f=n.L,u=n.R;if(r=f?u?np(u):f:u,i?i.L===n?i.L=r:i.R=r:this._=r,f&&u?(e=r.C,r.C=n.C,r.L=f,f.U=r,r!==u?(i=r.U,r.U=n.U,n=r.R,i.L=n,r.R=u,u.U=r):(r.U=i,i=r,n=r.R)):(e=n.C,n=r),n&&(n.U=i),!e){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===i.L){if(t=i.R,t.C&&(t.C=!1,i.C=!0,kr(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,dr(this,t),t=i.R);t.C=i.C;i.C=t.R.C=!1;kr(this,i);n=this._;break}}else if(t=i.L,t.C&&(t.C=!1,i.C=!0,dr(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,kr(this,t),t=i.L);t.C=i.C;i.C=t.L.C=!1;dr(this,i);n=this._;break}t.C=!0;n=i;i=i.U}while(!n.C);n&&(n.C=!1)}}};n.geom.voronoi=function(n){function i(n){var o=new Array(n.length),t=r[0][0],i=r[0][1],f=r[1][0],e=r[1][1];return nh(u(n),r).cells.forEach(function(r,u){var h=r.edges,s=r.site,c=o[u]=h.length?h.map(function(n){var t=n.start();return[t.x,t.y]}):s.x>=t&&s.x<=f&&s.y>=i&&s.y<=e?[[t,e],[f,e],[f,i],[t,i]]:[];c.point=n[u]}),o}function u(n){return n.map(function(n,i){return{x:Math.round(s(n,i)/t)*t,y:Math.round(h(n,i)/t)*t,i:i}})}var f=ir,e=wr,s=f,h=e,r=lu;return n?i(n):(i.links=function(n){return nh(u(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},i.triangles=function(n){var t=[];return nh(u(n)).cells.forEach(function(i,r){for(var l,e,o=i.site,s=i.edges.sort(dy),h=-1,c=s.length,u=s[c-1].edge,f=u.l===o?u.r:u.l;++h<c;)l=u,e=f,u=s[h].edge,f=u.l===o?u.r:u.l,r<e.i&&r<f.i&&un(o,e,f)<0&&t.push([n[r],n[e.i],n[f.i]])}),t},i.x=function(n){return arguments.length?(s=o(f=n),i):f},i.y=function(n){return arguments.length?(h=o(e=n),i):e},i.clipExtent=function(n){return arguments.length?(r=null==n?lu:n,i):r===lu?null:r},i.size=function(n){return arguments.length?i.clipExtent(n&&[[0,0],n]):r===lu?null:r&&r[1]},i)};lu=[[-1e6,-1e6],[1e6,1e6]];n.geom.delaunay=function(t){return n.geom.voronoi().triangles(t)};n.geom.quadtree=function(n,t,i,u,f){function e(n){function it(n,t,i,u,f,e,o,s){var h,c,l;isNaN(i)||isNaN(u)||(n.leaf?(h=n.x,c=n.y,null!=h?r(h-i)+r(c-u)<.01?nt(n,t,i,u,f,e,o,s):(l=n.point,n.x=n.y=n.point=null,nt(n,l,h,c,f,e,o,s),nt(n,t,i,u,f,e,o,s)):(n.x=i,n.y=u,n.point=t)):nt(n,t,i,u,f,e,o,s))}function nt(n,t,i,r,u,f,e,o){var s=.5*(u+e),h=.5*(f+o),c=i>=s,l=r>=h,a=l<<1|c;n.leaf=!1;n=n.nodes[a]||(n.nodes[a]=tp());c?u=s:e=s;l?f=h:o=h;it(n,t,i,r,u,f,e,o)}var l,d,g,e,tt,a,v,y,p,ft=o(s),et=o(h),b,k,rt,ut,w;if(null!=t)a=t,v=i,y=u,p=f;else if(y=p=-(a=v=1/0),d=[],g=[],tt=n.length,c)for(e=0;tt>e;++e)l=n[e],l.x<a&&(a=l.x),l.y<v&&(v=l.y),l.x>y&&(y=l.x),l.y>p&&(p=l.y),d.push(l.x),g.push(l.y);else for(e=0;tt>e;++e)b=+ft(l=n[e],e),k=+et(l,e),a>b&&(a=b),v>k&&(v=k),b>y&&(y=b),k>p&&(p=k),d.push(b),g.push(k);if(rt=y-a,ut=p-v,rt>ut?p=v+rt:y=a+ut,w=tp(),w.add=function(n){it(w,n,+ft(n,++e),+et(n,e),a,v,y,p)},w.visit=function(n){gr(n,w,a,v,y,p)},w.find=function(n){return on(w,n[0],n[1],a,v,y,p)},e=-1,null==t){for(;++e<tt;)it(w,n[e],d[e],g[e],a,v,y,p);--e}else n.forEach(w.add);return d=g=n=l=null,w}var c,s=ir,h=wr;return(c=arguments.length)?(s=fn,h=en,3===c&&(f=i,u=t,i=t=0),e(n)):(e.x=function(n){return arguments.length?(s=n,e):s},e.y=function(n){return arguments.length?(h=n,e):h},e.extent=function(n){return arguments.length?(null==n?t=i=u=f=null:(t=+n[0][0],i=+n[0][1],u=+n[1][0],f=+n[1][1]),e):null==t?null:[[t,i],[u,f]]},e.size=function(n){return arguments.length?(null==n?t=i=u=f=null:(t=i=0,u=+n[0],f=+n[1]),e):null==t?null:[u-t,f-i]},e)};n.interpolateRgb=th;n.interpolateObject=ip;n.interpolateNumber=pt;n.interpolateString=rp;to=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;io=new RegExp(to.source,"g");n.interpolate=ai;n.interpolators=[function(n,t){var i=typeof t;return("string"===i?eu.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?th:rp:t instanceof si?th:Array.isArray(t)?vf:"object"===i&&isNaN(t)?ip:pt)(n,t)}];n.interpolateArray=vf;var vb=function(){return v},fut=n.map({linear:vb,poly:an,quad:function(){return hn},cubic:function(){return cn},sin:function(){return vn},exp:function(){return yn},circle:function(){return pn},elastic:wn,back:bn,bounce:function(){return kn}}),eut=n.map({"in":v,out:up,"in-out":fp,"out-in":function(n){return fp(up(n))}});n.ease=function(n){var t=n.indexOf("-"),i=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return i=fut.get(i)||vb,r=eut.get(r)||v,sn(r(i.apply(null,nb.call(arguments,1))))};n.interpolateHcl=dn;n.interpolateHsl=gn;n.interpolateLab=ntt;n.interpolateRound=ep;n.transform=function(t){var i=p.createElementNS(n.ns.prefix.svg,"g");return(n.transform=function(n){if(null!=n){i.setAttribute("transform",n);var t=i.transform.baseVal.consolidate()}return new op(t?t.matrix:yb)})(t)};op.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};yb={a:1,b:0,c:0,d:1,e:0,f:0};n.interpolateTransform=cp;n.layout={};n.layout.bundle=function(){return function(n){for(var t=[],i=-1,r=n.length;++i<r;)t.push(stt(n[i]));return t}};n.layout.chord=function(){function c(){var v,t,b,c,a,k={},g=[],it=n.range(r),nt=[],p,w;for(i=[],u=[],v=0,c=-1;++c<r;){for(t=0,a=-1;++a<r;)t+=f[c][a];g.push(t);nt.push(n.range(r));v+=t}for(e&&it.sort(function(n,t){return e(g[n],g[t])}),o&&nt.forEach(function(n,t){n.sort(function(n,i){return o(f[t][n],f[t][i])})}),v=(d-h*r)/v,t=0,c=-1;++c<r;){for(b=t,a=-1;++a<r;){var y=it[c],tt=nt[y][a],rt=f[y][tt],ut=t,ft=t+=rt*v;k[y+"-"+tt]={index:y,subindex:tt,startAngle:ut,endAngle:ft,value:rt}}u[y]={index:y,startAngle:b,endAngle:t,value:(t-b)/v};t+=h}for(c=-1;++c<r;)for(a=c-1;++a<r;)p=k[c+"-"+a],w=k[a+"-"+c],(p.value||w.value)&&i.push(p.value<w.value?{source:w,target:p}:{source:p,target:w});s&&l()}function l(){i.sort(function(n,t){return s((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var i,u,f,r,e,o,s,t={},h=0;return t.matrix=function(n){return arguments.length?(r=(f=n)&&f.length,i=u=null,t):f},t.padding=function(n){return arguments.length?(h=n,i=u=null,t):h},t.sortGroups=function(n){return arguments.length?(e=n,i=u=null,t):e},t.sortSubgroups=function(n){return arguments.length?(o=n,i=null,t):o},t.sortChords=function(n){return arguments.length?(s=n,i&&l(),t):s},t.chords=function(){return i||c(),i},t.groups=function(){return u||c(),u},t};n.layout.force=function(){function g(n){return function(t,i,r,u){var e;if(t.point!==n){var o=t.cx-n.x,s=t.cy-n.y,h=u-i,f=o*o+s*s;if(f>h*h/d)return b>f&&(e=t.charge/f,n.px-=o*e,n.py-=s*e),!0;t.point&&f&&b>f&&(e=t.pointCharge/f,n.px-=o*e,n.py-=s*e)}return!t.charge}}function nt(i){i.px=n.event.x;i.py=n.event.y;t.resume()}var o,l,r,a,y,p,t={},s=n.dispatch("start","tick","end"),f=[1,1],w=.9,h=out,c=sut,e=-30,b=hut,k=.1,d=.64,i=[],u=[];return t.tick=function(){if((r*=.99)<.005)return o=null,s.end({type:"end",alpha:r=0}),!0;for(var it,t,l,d,nt,c,v,b,tt=i.length,rt=u.length,h=0;rt>h;++h)t=u[h],l=t.source,d=t.target,v=d.x-l.x,b=d.y-l.y,(nt=v*v+b*b)&&(nt=r*y[h]*((nt=Math.sqrt(nt))-a[h])/nt,v*=nt,b*=nt,d.x-=v*(c=l.weight+d.weight?l.weight/(l.weight+d.weight):.5),d.y-=b*c,l.x+=v*(c=1-c),l.y+=b*c);if((c=r*k)&&(v=f[0]/2,b=f[1]/2,h=-1,c))for(;++h<tt;)t=i[h],t.x+=(v-t.x)*c,t.y+=(b-t.y)*c;if(e)for(ap(it=n.geom.quadtree(i),r,p),h=-1;++h<tt;)(t=i[h]).fixed||it.visit(g(t));for(h=-1;++h<tt;)t=i[h],t.fixed?(t.x=t.px,t.y=t.py):(t.x-=(t.px-(t.px=t.x))*w,t.y-=(t.py-(t.py=t.y))*w);s.tick({type:"tick",alpha:r})},t.nodes=function(n){return arguments.length?(i=n,t):i},t.links=function(n){return arguments.length?(u=n,t):u},t.size=function(n){return arguments.length?(f=n,t):f},t.linkDistance=function(n){return arguments.length?(h="function"==typeof n?n:+n,t):h},t.distance=t.linkDistance,t.linkStrength=function(n){return arguments.length?(c="function"==typeof n?n:+n,t):c},t.friction=function(n){return arguments.length?(w=+n,t):w},t.charge=function(n){return arguments.length?(e="function"==typeof n?n:+n,t):e},t.chargeDistance=function(n){return arguments.length?(b=n*n,t):Math.sqrt(b)},t.gravity=function(n){return arguments.length?(k=+n,t):k},t.theta=function(n){return arguments.length?(d=n*n,t):Math.sqrt(d)},t.alpha=function(n){return arguments.length?(n=+n,r?n>0?r=n:(o.c=null,o.t=NaN,o=null,s.start({type:"end",alpha:r=0})):n>0&&(s.start({type:"start",alpha:r=n}),o=ku(t.tick)),t):r},t.start=function(){function v(t,i){var f;if(!o){for(o=new Array(s),r=0;s>r;++r)o[r]=[];for(r=0;l>r;++r)f=u[r],o[f.source.index].push(f.target),o[f.target.index].push(f.source)}for(var e,h=o[n],r=-1,c=h.length;++r<c;)if(!isNaN(e=h[r][t]))return e;return Math.random()*i}for(var o,r,s=i.length,l=u.length,w=f[0],b=f[1],n=0;s>n;++n)(r=i[n]).index=n,r.weight=0;for(n=0;l>n;++n)r=u[n],"number"==typeof r.source&&(r.source=i[r.source]),"number"==typeof r.target&&(r.target=i[r.target]),++r.source.weight,++r.target.weight;for(n=0;s>n;++n)r=i[n],isNaN(r.x)&&(r.x=v("x",w)),isNaN(r.y)&&(r.y=v("y",b)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof h)for(n=0;l>n;++n)a[n]=+h.call(this,u[n],n);else for(n=0;l>n;++n)a[n]=h;if(y=[],"function"==typeof c)for(n=0;l>n;++n)y[n]=+c.call(this,u[n],n);else for(n=0;l>n;++n)y[n]=c;if(p=[],"function"==typeof e)for(n=0;s>n;++n)p[n]=+e.call(this,i[n],n);else for(n=0;s>n;++n)p[n]=e;return t.resume()},t.resume=function(){return t.alpha(.1)},t.stop=function(){return t.alpha(0)},t.drag=function(){return l||(l=n.behavior.drag().origin(v).on("dragstart.force",ctt).on("drag.force",nt).on("dragend.force",ltt)),arguments.length?void this.on("mouseover.force",att).on("mouseout.force",vtt).call(l):l},n.rebind(t,s,"on")};var out=20,sut=1,hut=1/0;n.layout.hierarchy=function(){function n(u){var f,h=[u],c=[],o,e,s;for(u.depth=0;null!=(f=h.pop());)if(c.push(f),(e=r.call(n,f,f.depth))&&(o=e.length)){for(;--o>=0;)h.push(s=e[o]),s.parent=f,s.depth=f.depth+1;t&&(f.value=0);f.children=e}else t&&(f.value=+t.call(n,f,f.depth)||0),delete f.children;return et(u,function(n){var r,u;i&&(r=n.children)&&r.sort(i);t&&(u=n.parent)&&(u.value+=n.value)}),c}var i=wtt,r=ytt,t=ptt;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(i){return arguments.length?(t=i,n):t},n.revalue=function(i){return t&&(tu(i,function(n){n.children&&(n.value=0)}),et(i,function(i){var r;i.children||(i.value=+t.call(n,i,i.depth)||0);(r=i.parent)&&(r.value+=i.value)})),i},n};n.layout.partition=function(){function r(n,t,i,u){var f=n.children,o,s,h,e;if(n.x=t,n.y=n.depth*u,n.dx=i,n.dy=u,f&&(o=f.length))for(e=-1,i=n.value?i/n.value:0;++e<o;)r(s=f[e],t,h=s.value*i,u),t+=h}function u(n){var t=n.children,i=0,f,r;if(t&&(f=t.length))for(r=-1;++r<f;)i=Math.max(i,u(t[r]));return 1+i}function i(n,i){var e=f.call(this,n,i);return r(e[0],0,t[0],t[1]/u(e[0])),e}var f=n.layout.hierarchy(),t=[1,1];return i.size=function(n){return arguments.length?(t=n,i):t},nu(i,f)};n.layout.pie=function(){function t(o){var a,h=o.length,s=o.map(function(n,i){return+e.call(t,n,i)}),c=+("function"==typeof r?r.apply(this,arguments):r),l=("function"==typeof u?u.apply(this,arguments):u)-c,v=Math.min(Math.abs(l)/h,+("function"==typeof f?f.apply(this,arguments):f)),y=v*(0>l?-1:1),p=n.sum(s),k=p?(l-h*y)/p:0,w=n.range(h),b=[];return null!=i&&w.sort(i===rl?function(n,t){return s[t]-s[n]}:function(n,t){return i(o[n],o[t])}),w.forEach(function(n){b[n]={data:o[n],value:a=s[n],startAngle:c,endAngle:c+=a*k+y,padAngle:v}}),b}var e=Number,i=rl,r=0,u=d,f=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(n){return arguments.length?(i=n,t):i},t.startAngle=function(n){return arguments.length?(r=n,t):r},t.endAngle=function(n){return arguments.length?(u=n,t):u},t.padAngle=function(n){return arguments.length?(f=n,t):f},t};rl={};n.layout.stack=function(){function t(s,h){var p,v,c,w,b,k;if(!(p=s.length))return s;var a=s.map(function(n,i){return r.call(t,n,i)}),l=a.map(function(n){return n.map(function(n,i){return[e.call(t,n,i),o.call(t,n,i)]})}),y=u.call(t,l,h);for(a=n.permute(a,y),l=n.permute(l,y),b=f.call(t,l,h),k=a[0].length,c=0;k>c;++c)for(i.call(t,a[0][c],w=b[c],l[0][c][1]),v=1;p>v;++v)i.call(t,a[v][c],w+=l[v-1][c][1],l[v][c][1]);return s}var r=v,u=ih,f=rh,i=gtt,e=ktt,o=dtt;return t.values=function(n){return arguments.length?(r=n,t):r},t.order=function(n){return arguments.length?(u="function"==typeof n?n:pb.get(n)||ih,t):u},t.offset=function(n){return arguments.length?(f="function"==typeof n?n:wb.get(n)||rh,t):f},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(o=n,t):o},t.out=function(n){return arguments.length?(i=n,t):i},t};pb=n.map({"inside-out":function(t){for(var i,u=t.length,f=t.map(nit),e=t.map(tit),l=n.range(u).sort(function(n,t){return f[n]-f[t]}),o=0,s=0,h=[],c=[],r=0;u>r;++r)i=l[r],s>o?(o+=e[i],h.push(i)):(s+=e[i],c.push(i));return c.reverse().concat(h)},reverse:function(t){return n.range(t.length).reverse()},"default":ih});wb=n.map({silhouette:function(n){for(var r,i,s=n.length,f=n[0].length,e=[],u=0,o=[],t=0;f>t;++t){for(r=0,i=0;s>r;r++)i+=n[r][t][1];i>u&&(u=i);e.push(i)}for(t=0;f>t;++t)o[t]=(u-e[t])/2;return o},wiggle:function(n){var i,t,r,u,h,c,f,e,o,a=n.length,l=n[0],v=l.length,s=[];for(s[0]=e=o=0,t=1;v>t;++t){for(i=0,u=0;a>i;++i)u+=n[i][t][1];for(i=0,h=0,f=l[t][0]-l[t-1][0];a>i;++i){for(r=0,c=(n[i][t][1]-n[i][t-1][1])/(2*f);i>r;++r)c+=(n[r][t][1]-n[r][t-1][1])/f;h+=c*n[i][t][1]}s[t]=e-=u?h/u*f:0;o>e&&(o=e)}for(t=0;v>t;++t)s[t]-=o;return s},expand:function(n){for(var t,r,u=n.length,f=n[0].length,o=1/u,e=[],i=0;f>i;++i){for(t=0,r=0;u>t;t++)r+=n[t][i][1];if(r)for(t=0;u>t;t++)n[t][i][1]/=r;else for(t=0;u>t;t++)n[t][i][1]=o}for(i=0;f>i;++i)e[i]=0;return e},zero:rh});n.layout.histogram=function(){function t(t,e){for(var o,s,l=[],h=t.map(r,this),a=u.call(this,h,e),c=f.call(this,a,h,e),e=-1,y=h.length,v=c.length-1,p=i?1:1/y;++e<v;)o=l[e]=[],o.dx=c[e+1]-(o.x=c[e]),o.y=0;if(v>0)for(e=-1;++e<y;)s=h[e],s>=a[0]&&s<=a[1]&&(o=l[n.bisect(c,s,1,v)-1],o.y+=p,o.push(t[e]));return l}var i=!0,r=Number,u=uit,f=rit;return t.value=function(n){return arguments.length?(r=n,t):r},t.range=function(n){return arguments.length?(u=o(n),t):u},t.bins=function(n){return arguments.length?(f="number"==typeof n?function(t){return vp(t,n)}:o(n),t):f},t.frequency=function(n){return arguments.length?(i=!!n,t):i},t};n.layout.pack=function(){function i(n,i){var c=f.call(this,n,i),e=c[0],o=u[0],s=u[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t},h;return(e.x=e.y=0,et(e,function(n){n.r=+l(n.value)}),et(e,wp),r)&&(h=r*(t?1:Math.max(2*e.r/o,2*e.r/s))/2,et(e,function(n){n.r+=h}),et(e,wp),et(e,function(n){n.r-=h})),bp(e,o/2,s/2,t?1:1/Math.max(2*e.r/o,2*e.r/s)),c}var t,f=n.layout.hierarchy().sort(fit),r=0,u=[1,1];return i.size=function(n){return arguments.length?(u=n,i):u},i.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,i):t},i.padding=function(n){return arguments.length?(r=+n,i):r},nu(i,f)};n.layout.tree=function(){function i(n,i){var p=e.call(this,n,i),c=p[0],v=o(c);if(et(v,s),v.parent.m=-v.z,tu(v,h),u)tu(c,f);else{var l=c,a=c,y=c;tu(c,function(n){n.x<l.x&&(l=n);n.x>a.x&&(a=n);n.depth>y.depth&&(y=n)});var w=r(l,a)/2-l.x,b=t[0]/(a.x+r(a,l)/2+w),k=t[1]/(y.depth||1);tu(c,function(n){n.x=(n.x+w)*b;n.y=n.depth*k})}return p}function o(n){for(var u,f={A:null,children:[n]},e=[f];null!=(u=e.pop());)for(var i,r=u.children,t=0,o=r.length;o>t;++t)e.push((r[t]=i={_:r[t],parent:u,children:(i=r[t].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:t}).a=i);return f.children[0]}function s(n){var i=n.children,f=n.parent.children,t=n.i?f[n.i-1]:null,u;i.length?(hit(n),u=(i[0].z+i[i.length-1].z)/2,t?(n.z=t.z+r(n._,t._),n.m=n.z-u):n.z=u):t&&(n.z=t.z+r(n._,t._));n.parent.A=c(n,t,n.parent.A||f[0])}function h(n){n._.x=n.z+n.parent.m;n.m+=n.parent.m}function c(n,t,i){if(t){for(var s,u=n,e=n,f=t,o=u.parent.children[0],h=u.m,c=e.m,l=f.m,a=o.m;f=eh(f),u=fh(u),f&&u;)o=fh(o),e=eh(e),e.a=n,s=f.z+l-u.z-h+r(f._,u._),s>0&&(sit(cit(f,n,i),n,s),h+=s,c+=s),l+=f.m,h+=u.m,a+=o.m,c+=e.m;f&&!eh(e)&&(e.t=f,e.m+=l-c);u&&!fh(o)&&(o.t=u,o.m+=h-a,i=n)}return i}function f(n){n.x*=t[0];n.y=n.depth*t[1]}var e=n.layout.hierarchy().sort(null).value(null),r=dp,t=[1,1],u=null;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n)?f:null,i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null==(t=n)?null:f,i):u?t:null},nu(i,e)};n.layout.cluster=function(){function i(n,i){var o,c=f.call(this,n,i),e=c[0],a=0;et(e,function(n){var t=n.children;t&&t.length?(n.x=ait(t),n.y=lit(t)):(n.x=o?a+=r(n,o):0,n.y=0,o=n)});var s=gp(e),h=nw(e),l=s.x-r(s,h)/2,v=h.x+r(h,s)/2;return et(e,u?function(n){n.x=(n.x-e.x)*t[0];n.y=(e.y-n.y)*t[1]}:function(n){n.x=(n.x-l)/(v-l)*t[0];n.y=(1-(e.y?n.y/e.y:1))*t[1]}),c}var f=n.layout.hierarchy().sort(null).value(null),r=dp,t=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n),i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null!=(t=n),i):u?t:null},nu(i,f)};n.layout.treemap=function(){function o(n,t){for(var r,i,u=-1,f=n.length;++u<f;)i=(r=n[u]).value*(0>t?0:t),r.area=isNaN(i)||0>=i?0:i}function a(n){var u=n.children;if(u&&u.length){var l,v,y,r=c(n),t=[],f=u.slice(),h=1/0,e="slice"===i?r.dx:"dice"===i?r.dy:"slice-dice"===i?1&n.depth?r.dy:r.dx:Math.min(r.dx,r.dy);for(o(f,r.dx*r.dy/n.value),t.area=0;(y=f.length)>0;)t.push(l=f[y-1]),t.area+=l.area,"squarify"!==i||(v=p(t,e))<=h?(f.pop(),h=v):(t.area-=t.pop().area,s(t,e,r,!1),e=Math.min(r.dx,r.dy),t.length=t.area=0,h=1/0);t.length&&(s(t,e,r,!0),t.length=t.area=0);u.forEach(a)}}function v(n){var u=n.children;if(u&&u.length){var i,r=c(n),f=u.slice(),t=[];for(o(f,r.dx*r.dy/n.value),t.area=0;i=f.pop();)t.push(i),t.area+=i.area,null!=i.z&&(s(t,i.z?r.dx:r.dy,r,!f.length),t.length=t.area=0);u.forEach(v)}}function p(n,t){for(var i,r=n.area,u=0,f=1/0,o=-1,s=n.length;++o<s;)(i=n[o].area)&&(f>i&&(f=i),i>u&&(u=i));return r*=r,t*=t,r?Math.max(t*u*e/r,r/(t*f*e)):1/0}function s(n,t,i,r){var f,h=-1,c=n.length,o=i.x,s=i.y,e=t?u(n.area/t):0;if(t==i.dx){for((r||e>i.dy)&&(e=i.dy);++h<c;)f=n[h],f.x=o,f.y=s,f.dy=e,o+=f.dx=Math.min(i.x+i.dx-o,e?u(f.area/e):0);f.z=!0;f.dx+=i.x+i.dx-o;i.y+=e;i.dy-=e}else{for((r||e>i.dx)&&(e=i.dx);++h<c;)f=n[h],f.x=o,f.y=s,f.dx=e,s+=f.dy=Math.min(i.y+i.dy-s,e?u(f.area/e):0);f.z=!1;f.dy+=i.y+i.dy-s;i.x+=e;i.dx-=e}}function t(n){var i=r||h(n),t=i[0];return t.x=t.y=0,t.value?(t.dx=f[0],t.dy=f[1]):t.dx=t.dy=0,r&&h.revalue(t),o([t],t.dx*t.dy/t.value),(r?v:a)(t),l&&(r=i),i}var r,h=n.layout.hierarchy(),u=Math.round,f=[1,1],y=null,c=oh,l=!1,i="squarify",e=.5*(1+Math.sqrt(5));return t.size=function(n){return arguments.length?(f=n,t):f},t.padding=function(n){function u(i){var r=n.call(t,i,i.depth);return null==r?oh(i):tw(i,"number"==typeof r?[r,r,r,r]:r)}function i(t){return tw(t,n)}if(!arguments.length)return y;var r;return c=null==(y=n)?oh:"function"==(r=typeof n)?u:"number"===r?(n=[n,n,n,n],i):i,t},t.round=function(n){return arguments.length?(u=n?Math.round:Number,t):u!=Number},t.sticky=function(n){return arguments.length?(l=n,r=null,t):l},t.ratio=function(n){return arguments.length?(e=n,t):e},t.mode=function(n){return arguments.length?(i=n+"",t):i},nu(t,h)};n.random={normal:function(n,t){var i=arguments.length;return 2>i&&(t=1),1>i&&(n=0),function(){var r,u,i;do r=2*Math.random()-1,u=2*Math.random()-1,i=r*r+u*u;while(!i||i>1);return n+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=n.random.normal.apply(n,arguments);return function(){return Math.exp(t())}},bates:function(t){var i=n.random.irwinHall(t);return function(){return i()/t}},irwinHall:function(n){return function(){for(var t=0,i=0;n>i;i++)t+=Math.random();return t}}};n.scale={};bb={floor:v,ceil:v};n.scale.linear=function(){return iw([0,1],[0,1],ai,!1)};kb={s:1,g:1,p:1,r:1,e:1};n.scale.log=function(){return uw(n.scale.linear().domain([0,1]),10,!0,[1,10])};ul=n.format(".0e");db={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};n.scale.pow=function(){return fw(n.scale.linear(),1,[0,1])};n.scale.sqrt=function(){return n.scale.pow().exponent(.5)};n.scale.ordinal=function(){return ew([],{t:"range",a:[[]]})};n.scale.category10=function(){return n.scale.ordinal().range(cut)};n.scale.category20=function(){return n.scale.ordinal().range(lut)};n.scale.category20b=function(){return n.scale.ordinal().range(aut)};n.scale.category20c=function(){return n.scale.ordinal().range(vut)};var cut=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(wu),lut=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(wu),aut=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(wu),vut=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(wu);n.scale.quantile=function(){return ow([],[])};n.scale.quantize=function(){return sw(0,1,[0,1])};n.scale.threshold=function(){return hw([.5],[0,1])};n.scale.identity=function(){return cw([0,1])};n.svg={};n.svg.arc=function(){function n(){var n=Math.max(0,+i.apply(this,arguments)),o=Math.max(0,+r.apply(this,arguments)),it=e.apply(this,arguments)-h,rt=s.apply(this,arguments)-h,pt=Math.abs(rt-it),v=it>rt?0:1,kt,dt,ni,ti,nt,tt,lt,at,vt,yt;if(n>o&&(ut=o,o=n,n=ut),pt>=iut)return a(o,v)+(n?a(n,1-v):"")+"Z";var ut,st,wt,bt,y,p,w,ft,k,d,g,ht,ct=0,et=0,b=[];if(((bt=(+l.apply(this,arguments)||0)/2)&&(wt=u===au?Math.sqrt(n*n+o*o):+u.apply(this,arguments),v||(et*=-1),o&&(et=gt(wt/o*Math.sin(bt))),n&&(ct=gt(wt/n*Math.sin(bt)))),o)?(y=o*Math.cos(it+et),p=o*Math.sin(it+et),w=o*Math.cos(rt-et),ft=o*Math.sin(rt-et),kt=Math.abs(rt-it-2*et)<=f?0:1,et&&bf(y,p,w,ft)===v^kt&&(dt=(it+rt)/2,y=o*Math.cos(dt),p=o*Math.sin(dt),w=ft=null)):y=p=0,n?(k=n*Math.cos(rt-ct),d=n*Math.sin(rt-ct),g=n*Math.cos(it+ct),ht=n*Math.sin(it+ct),ni=Math.abs(it-rt+2*ct)<=f?0:1,ct&&bf(k,d,g,ht)===1-v^ni&&(ti=(it+rt)/2,k=n*Math.cos(ti),d=n*Math.sin(ti),g=ht=null)):k=d=0,pt>t&&(ut=Math.min(Math.abs(o-n)/2,+c.apply(this,arguments)))>.001){if(st=o>n^v?0:1,nt=ut,tt=ut,f>pt){var ot=null==g?[k,d]:null==w?[y,p]:ks([y,p],[g,ht],[w,ft],[k,d]),ii=y-ot[0],ri=p-ot[1],ui=w-ot[0],fi=ft-ot[1],ei=1/Math.sin(Math.acos((ii*ui+ri*fi)/(Math.sqrt(ii*ii+ri*ri)*Math.sqrt(ui*ui+fi*fi)))/2),oi=Math.sqrt(ot[0]*ot[0]+ot[1]*ot[1]);tt=Math.min(ut,(n-oi)/(ei-1));nt=Math.min(ut,(o-oi)/(ei+1))}null!=w?(lt=kf(null==g?[k,d]:[g,ht],[y,p],o,nt,v),at=kf([w,ft],[k,d],o,nt,v),ut===nt?b.push("M",lt[0],"A",nt,",",nt," 0 0,",st," ",lt[1],"A",o,",",o," 0 ",1-v^bf(lt[1][0],lt[1][1],at[1][0],at[1][1]),",",v," ",at[1],"A",nt,",",nt," 0 0,",st," ",at[0]):b.push("M",lt[0],"A",nt,",",nt," 0 1,",st," ",at[0])):b.push("M",y,",",p);null!=g?(vt=kf([y,p],[g,ht],n,-tt,v),yt=kf([k,d],null==w?[y,p]:[w,ft],n,-tt,v),ut===tt?b.push("L",yt[0],"A",tt,",",tt," 0 0,",st," ",yt[1],"A",n,",",n," 0 ",v^bf(yt[1][0],yt[1][1],vt[1][0],vt[1][1]),",",1-v," ",vt[1],"A",tt,",",tt," 0 0,",st," ",vt[0]):b.push("L",yt[0],"A",tt,",",tt," 0 0,",st," ",vt[0])):b.push("L",k,",",d)}else b.push("M",y,",",p),null!=w&&b.push("A",o,",",o," 0 ",kt,",",v," ",w,",",ft),b.push("L",k,",",d),null!=g&&b.push("A",n,",",n," 0 ",ni,",",1-v," ",g,",",ht);return b.push("Z"),b.join("")}function a(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var i=kit,r=dit,c=bit,u=au,e=lw,s=aw,l=git;return n.innerRadius=function(t){return arguments.length?(i=o(t),n):i},n.outerRadius=function(t){return arguments.length?(r=o(t),n):r},n.cornerRadius=function(t){return arguments.length?(c=o(t),n):c},n.padRadius=function(t){return arguments.length?(u=t==au?au:o(t),n):u},n.startAngle=function(t){return arguments.length?(e=o(t),n):e},n.endAngle=function(t){return arguments.length?(s=o(t),n):s},n.padAngle=function(t){return arguments.length?(l=o(t),n):l},n.centroid=function(){var n=(+i.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2-h;return[Math.cos(t)*n,Math.sin(t)*n]},n};au="auto";n.svg.line=function(){return vw(v)};ro=n.map({linear:it,"linear-closed":yw,step:nrt,"step-before":ah,"step-after":vh,basis:pw,"basis-open":urt,"basis-closed":frt,bundle:ert,cardinal:rrt,"cardinal-open":trt,"cardinal-closed":irt,monotone:hrt});ro.forEach(function(n,t){t.key=n;t.closed=/-closed$/.test(n)});var gb=[0,2/3,1/3,0],nk=[0,1/3,2/3,0],ei=[0,1/6,2/3,1/6];n.svg.line.radial=function(){var n=vw(ww);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n};ah.reverse=vh;vh.reverse=ah;n.svg.area=function(){return bw(v)};n.svg.area.radial=function(){var n=bw(ww);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n};n.svg.chord=function(){function n(n,u){var f=c(this,i,n,u),e=c(this,r,n,u);return"M"+f.p0+l(f.r,f.p1,f.a1-f.a0)+(a(f,e)?t(f.r,f.p1,f.r,f.p0):t(f.r,f.p1,e.r,e.p0)+l(e.r,e.p1,e.a1-e.a0)+t(e.r,e.p1,f.r,f.p0))+"Z"}function c(n,t,i,r){var o=t.call(n,i,r),f=u.call(n,o,r),c=e.call(n,o,r)-h,l=s.call(n,o,r)-h;return{r:f,a0:c,a1:l,p0:[f*Math.cos(c),f*Math.sin(c)],p1:[f*Math.cos(l),f*Math.sin(l)]}}function a(n,t){return n.a0==t.a0&&n.a1==t.a1}function l(n,t,i){return"A"+n+","+n+" 0 "+ +(i>f)+",1 "+t}function t(n,t,i,r){return"Q 0,0 "+r}var i=ys,r=ps,u=crt,e=lw,s=aw;return n.radius=function(t){return arguments.length?(u=o(t),n):u},n.source=function(t){return arguments.length?(i=o(t),n):i},n.target=function(t){return arguments.length?(r=o(t),n):r},n.startAngle=function(t){return arguments.length?(e=o(t),n):e},n.endAngle=function(t){return arguments.length?(s=o(t),n):s},n};n.svg.diagonal=function(){function n(n,u){var e=t.call(this,n,u),o=i.call(this,n,u),s=(e.y+o.y)/2,f=[e,{x:e.x,y:s},{x:o.x,y:s},o];return f=f.map(r),"M"+f[0]+"C"+f[1]+" "+f[2]+" "+f[3]}var t=ys,i=ps,r=kw;return n.source=function(i){return arguments.length?(t=o(i),n):t},n.target=function(t){return arguments.length?(i=o(t),n):i},n.projection=function(t){return arguments.length?(r=t,n):r},n};n.svg.diagonal.radial=function(){var t=n.svg.diagonal(),i=kw,r=t.projection;return t.projection=function(n){return arguments.length?r(lrt(i=n)):i},t};n.svg.symbol=function(){function n(n,r){return(fl.get(t.call(this,n,r))||dw)(i.call(this,n,r))}var t=vrt,i=art;return n.type=function(i){return arguments.length?(t=o(i),n):t},n.size=function(t){return arguments.length?(i=o(t),n):i},n};fl=n.map({circle:dw,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*el)),i=t*el;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/vu),i=t*vu/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/vu),i=t*vu/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});n.svg.symbolTypes=fl.keys();vu=Math.sqrt(3);el=Math.tan(30*u);e.transition=function(n){for(var r,t,u=di||++tk,f=kh(n),e=[],h=uo||{time:Date.now(),ease:ln,delay:0,duration:250},o=-1,c=this.length;++o<c;){e.push(r=[]);for(var s=this[o],i=-1,l=s.length;++i<l;)(t=s[i])&&gf(t,i,f,u,h),r.push(t)}return ru(e,f,u)};e.interrupt=function(n){return this.each(null==n?fo:gw(kh(n)))};var di,uo,fo=gw(kh()),a=[],tk=0;a.call=e.call;a.empty=e.empty;a.node=e.node;a.size=e.size;n.transition=function(t,i){return t&&t.transition?di?t.transition(i):t:n.selection().transition(t)};n.transition.prototype=a;a.select=function(n){var f,i,t,e=this.id,o=this.namespace,s=[],r,h;for(n=ao(n),r=-1,h=this.length;++r<h;){s.push(f=[]);for(var c=this[r],u=-1,l=c.length;++u<l;)(t=c[u])&&(i=n.call(t,t.__data__,u,r))?("__data__"in t&&(i.__data__=t.__data__),gf(i,u,o,e,t[o][e]),f.push(i)):f.push(null)}return ru(s,o,e)};a.selectAll=function(n){var h,u,t,f,c,e=this.id,o=this.namespace,l=[],i,a,r,y;for(n=na(n),i=-1,a=this.length;++i<a;)for(var v=this[i],s=-1,p=v.length;++s<p;)if(t=v[s])for(c=t[o][e],u=n.call(t,t.__data__,s,i),l.push(h=[]),r=-1,y=u.length;++r<y;)(f=u[r])&&gf(f,r,o,e,c),h.push(f);return ru(l,o,e)};a.filter=function(n){var u,f,i,e=[],t,o;for("function"!=typeof n&&(n=ha(n)),t=0,o=this.length;o>t;t++){e.push(u=[]);for(var f=this[t],r=0,s=f.length;s>r;r++)(i=f[r])&&n.call(i,i.__data__,r,t)&&u.push(i)}return ru(e,this.namespace,this.id)};a.tween=function(n,t){var i=this.id,r=this.namespace;return arguments.length<2?this.node()[r][i].tween.get(n):vt(this,null==t?function(t){t[r][i].tween.remove(n)}:function(u){u[r][i].tween.set(n,t)})};a.attr=function(t,i){function f(){this.removeAttribute(r)}function e(){this.removeAttributeNS(r.space,r.local)}function o(n){return null==n?f:(n+="",function(){var t,i=this.getAttribute(r);return i!==n&&(t=u(i,n),function(n){this.setAttribute(r,t(n))})})}function s(n){return null==n?e:(n+="",function(){var t,i=this.getAttributeNS(r.space,r.local);return i!==n&&(t=u(i,n),function(n){this.setAttributeNS(r.space,r.local,t(n))})})}if(arguments.length<2){for(i in t)this.attr(i,t[i]);return this}var u="transform"==t?cp:ai,r=n.ns.qualify(t);return bh(this,"attr."+t,i,r.local?s:o)};a.attrTween=function(t,i){function u(n,t){var u=i.call(this,n,t,this.getAttribute(r));return u&&function(n){this.setAttribute(r,u(n))}}function f(n,t){var u=i.call(this,n,t,this.getAttributeNS(r.space,r.local));return u&&function(n){this.setAttributeNS(r.space,r.local,u(n))}}var r=n.ns.qualify(t);return this.tween("attr."+t,r.local?f:u)};a.style=function(n,t,i){function u(){this.style.removeProperty(n)}function f(t){return null==t?u:(t+="",function(){var r,u=bt(this).getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=ai(u,t),function(t){this.style.setProperty(n,r(t),i)})})}var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.style(i,n[i],t);return this}i=""}return bh(this,"style."+n,t,f)};a.styleTween=function(n,t,i){function r(r,u){var f=t.call(this,r,u,bt(this).getComputedStyle(this,null).getPropertyValue(n));return f&&function(t){this.style.setProperty(n,f(t),i)}}return arguments.length<3&&(i=""),this.tween("style."+n,r)};a.text=function(n){return bh(this,"text",n,yrt)};a.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})};a.ease=function(t){var i=this.id,r=this.namespace;return arguments.length<1?this.node()[r][i].ease:("function"!=typeof t&&(t=n.ease.apply(n,arguments)),vt(this,function(n){n[r][i].ease=t}))};a.delay=function(n){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].delay:vt(this,"function"==typeof n?function(r,u,f){r[i][t].delay=+n.call(r,r.__data__,u,f)}:(n=+n,function(r){r[i][t].delay=n}))};a.duration=function(n){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].duration:vt(this,"function"==typeof n?function(r,u,f){r[i][t].duration=Math.max(1,n.call(r,r.__data__,u,f))}:(n=Math.max(1,n),function(r){r[i][t].duration=n}))};a.each=function(t,i){var r=this.id,u=this.namespace,f,e;if(arguments.length<2){f=uo;e=di;try{di=r;vt(this,function(n,i,f){uo=n[u][r];t.call(n,n.__data__,i,f)})}finally{uo=f;di=e}}else vt(this,function(f){var e=f[u][r];(e.event||(e.event=n.dispatch("start","end","interrupt"))).on(t,i)});return this};a.transition=function(){for(var f,e,t,n,h=this.id,o=++tk,r=this.namespace,s=[],u=0,c=this.length;c>u;u++){s.push(f=[]);for(var e=this[u],i=0,l=e.length;l>i;i++)(t=e[i])&&(n=t[r][h],gf(t,i,r,o,{time:n.time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration})),f.push(t)}return ru(s,r,o)};n.svg.axis=function(){function i(i){i.each(function(){var a,rt=n.select(this),y=this.__chart__||o,i=this.__chart__=o.copy(),ht=null==h?i.ticks?i.ticks.apply(i,s):i.domain():h,ct=null==e?i.tickFormat?i.tickFormat.apply(i,s):v:e,w=rt.selectAll(".tick").data(ht,i),p=w.enter().insert("g",".domain").attr("class","tick").style("opacity",t),lt=n.transition(w.exit()).style("opacity",t).remove(),g=n.transition(w.order()).style("opacity",1),ut=Math.max(r,0)+c,b=yf(i),ft=rt.selectAll(".domain").data([0]),et=(ft.enter().append("path").attr("class","domain"),n.transition(ft)),it,st;p.append("line");p.append("text");var nt,tt,k,d,at=p.select("line"),vt=g.select("line"),ot=w.select("text").text(ct),yt=p.select("text"),pt=g.select("text"),l="top"===f||"left"===f?-1:1;("bottom"===f||"top"===f?(a=prt,nt="x",k="y",tt="x2",d="y2",ot.attr("dy",0>l?"0em":".71em").style("text-anchor","middle"),et.attr("d","M"+b[0]+","+l*u+"V0H"+b[1]+"V"+l*u)):(a=wrt,nt="y",k="x",tt="y2",d="x2",ot.attr("dy",".32em").style("text-anchor",0>l?"end":"start"),et.attr("d","M"+l*u+","+b[0]+"H0V"+b[1]+"H"+l*u)),at.attr(d,l*r),yt.attr(k,l*ut),vt.attr(tt,0).attr(d,l*r),pt.attr(nt,0).attr(k,l*ut),i.rangeBand)?(it=i,st=it.rangeBand()/2,y=i=function(n){return it(n)+st}):y.rangeBand?y=i:lt.call(a,i,y);p.call(a,y,i);g.call(a,i,i)})}var e,o=n.scale.linear(),f=ol,r=6,u=6,c=3,s=[10],h=null;return i.scale=function(n){return arguments.length?(o=n,i):o},i.orient=function(n){return arguments.length?(f=n in ik?n+"":ol,i):f},i.ticks=function(){return arguments.length?(s=ot(arguments),i):s},i.tickValues=function(n){return arguments.length?(h=n,i):h},i.tickFormat=function(n){return arguments.length?(e=n,i):e},i.tickSize=function(n){var t=arguments.length;return t?(r=+n,u=+arguments[t-1],i):r},i.innerTickSize=function(n){return arguments.length?(r=+n,i):r},i.outerTickSize=function(n){return arguments.length?(u=+n,i):u},i.tickPadding=function(n){return arguments.length?(c=+n,i):c},i.tickSubdivide=function(){return arguments.length&&i},i};ol="bottom";ik={top:1,right:1,bottom:1,left:1};n.svg.brush=function(){function f(t){t.each(function(){var i=n.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",w).on("touchstart.brush",w),h=i.selectAll(".background").data([0]),e,t,o,s;h.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");e=i.selectAll(".resize").data(l,v);e.exit().remove();e.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return yut[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");e.style("display",f.empty()?"none":null);o=n.transition(i);s=n.transition(h);r&&(t=yf(r),s.attr("x",t[0]).attr("width",t[1]-t[0]),y(o));u&&(t=yf(u),s.attr("y",t[0]).attr("height",t[1]-t[0]),p(o));a(o)})}function a(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+t[+/e$/.test(n)]+","+i[+/^s/.test(n)]+")"})}function y(n){n.select(".extent").attr("x",t[0]);n.selectAll(".extent,.n>rect,.s>rect").attr("width",t[1]-t[0])}function p(n){n.select(".extent").attr("y",i[0]);n.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function w(){function st(){32==n.event.keyCode&&(w||(v=null,l[0]-=t[1],l[1]-=i[1],w=2),kt())}function ht(){32==n.event.keyCode&&2==w&&(l[0]+=t[1],l[1]+=i[1],w=0,kt())}function g(){var f=n.mouse(b),e=!1;nt&&(f[0]+=nt[0],f[1]+=nt[1]);w||(n.event.altKey?(v||(v=[(t[0]+t[1])/2,(i[0]+i[1])/2]),l[0]=t[+(f[0]<v[0])],l[1]=i[+(f[1]<v[1])]):v=null);ct&&et(f,r,0)&&(y(k),e=!0);lt&&et(f,u,1)&&(p(k),e=!0);e&&(a(k),it({type:"brush",mode:w?"move":"resize"}))}function et(n,r,u){var f,y,k=yf(r),p=k[0],b=k[1],c=l[u],a=u?i:t,d=a[1]-a[0];return w&&(p-=c,b-=d+c),f=(u?h:s)?Math.max(p,Math.min(b,n[u])):n[u],w?y=(f+=c)+d:(v&&(c=Math.max(p,Math.min(b,2*v[u]-f))),f>c?(y=f,f=c):y=c),a[0]!=f||a[1]!=y?(u?o=null:e=null,a[0]=f,a[1]=y,!0):void 0}function ot(){g();k.style("pointer-events","all").selectAll(".resize").style("display",f.empty()?"none":null);n.select("body").style("cursor",null);rt.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);at();it({type:"brushend"})}var v,nt,b=this,tt=n.select(n.event.target),it=c.of(b,arguments),k=n.select(b),d=tt.datum(),ct=!/^(n|s)$/.test(d)&&r,lt=!/^(e|w)$/.test(d)&&u,w=tt.classed("extent"),at=pu(b),l=n.mouse(b),rt=n.select(bt(b)).on("keydown.brush",st).on("keyup.brush",ht),ut,ft;(n.event.changedTouches?rt.on("touchmove.brush",g).on("touchend.brush",ot):rt.on("mousemove.brush",g).on("mouseup.brush",ot),k.interrupt().selectAll("*").interrupt(),w)?(l[0]=t[0]-l[0],l[1]=i[0]-l[1]):d?(ut=+/w$/.test(d),ft=+/^n/.test(d),nt=[t[1-ut]-l[0],i[1-ft]-l[1]],l[0]=t[ut],l[1]=i[ft]):n.event.altKey&&(v=l.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null);n.select("body").style("cursor",tt.style("cursor"));it({type:"brushstart"});g()}var e,o,c=lo(f,"brushstart","brush","brushend"),r=null,u=null,t=[0,0],i=[0,0],s=!0,h=!0,l=sl[0];return f.event=function(r){r.each(function(){var u=c.of(this,arguments),r={x:t,y:i,i:e,j:o},f=this.__chart__||r;this.__chart__=r;di?n.select(this).transition().each("start.brush",function(){e=f.i;o=f.j;t=f.x;i=f.y;u({type:"brushstart"})}).tween("brush:brush",function(){var n=vf(t,r.x),f=vf(i,r.y);return e=o=null,function(e){t=r.x=n(e);i=r.y=f(e);u({type:"brush",mode:"resize"})}}).each("end.brush",function(){e=r.i;o=r.j;u({type:"brush",mode:"resize"});u({type:"brushend"})}):(u({type:"brushstart"}),u({type:"brush",mode:"resize"}),u({type:"brushend"}))})},f.x=function(n){return arguments.length?(r=n,l=sl[!r<<1|!u],f):r},f.y=function(n){return arguments.length?(u=n,l=sl[!r<<1|!u],f):u},f.clamp=function(n){return arguments.length?(r&&u?(s=!!n[0],h=!!n[1]):r?s=!!n:u&&(h=!!n),f):r&&u?[s,h]:r?s:u?h:null},f.extent=function(n){var s,h,c,l,a;return arguments.length?(r&&(s=n[0],h=n[1],u&&(s=s[0],h=h[0]),e=[s,h],r.invert&&(s=r(s),h=r(h)),s>h&&(a=s,s=h,h=a),(s!=t[0]||h!=t[1])&&(t=[s,h])),u&&(c=n[0],l=n[1],r&&(c=c[1],l=l[1]),o=[c,l],u.invert&&(c=u(c),l=u(l)),c>l&&(a=c,c=l,l=a),(c!=i[0]||l!=i[1])&&(i=[c,l])),f):(r&&(e?(s=e[0],h=e[1]):(s=t[0],h=t[1],r.invert&&(s=r.invert(s),h=r.invert(h)),s>h&&(a=s,s=h,h=a))),u&&(o?(c=o[0],l=o[1]):(c=i[0],l=i[1],u.invert&&(c=u.invert(c),l=u.invert(l)),c>l&&(a=c,c=l,l=a))),r&&u?[[s,c],[h,l]]:r?[s,h]:u&&[c,l])},f.clear=function(){return f.empty()||(t=[0,0],i=[0,0],e=o=null),f},f.empty=function(){return!!r&&t[0]==t[1]||!!u&&i[0]==i[1]},n.rebind(f,c,"on")};var yut={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},sl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],hl=i.format=cc.timeFormat,rk=hl.utc,uk=rk("%Y-%m-%dT%H:%M:%S.%LZ");hl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?dh:uk;dh.parse=function(n){var t=new Date(n);return isNaN(t)?null:t};dh.toString=uk.toString;i.second=hi(function(n){return new y(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()});i.seconds=i.second.range;i.seconds.utc=i.second.utc.range;i.minute=hi(function(n){return new y(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()});i.minutes=i.minute.range;i.minutes.utc=i.minute.utc.range;i.hour=hi(function(n){var t=n.getTimezoneOffset()/60;return new y(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()});i.hours=i.hour.range;i.hours.utc=i.hour.utc.range;i.month=hi(function(n){return n=i.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()});i.months=i.month.range;i.months.utc=i.month.utc.range;var eo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],cl=[[i.second,1],[i.second,5],[i.second,15],[i.second,30],[i.minute,1],[i.minute,5],[i.minute,15],[i.minute,30],[i.hour,1],[i.hour,3],[i.hour,6],[i.hour,12],[i.day,1],[i.day,2],[i.week,1],[i.month,1],[i.month,3],[i.year,1]],put=hl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",vr]]),wut={range:function(t,i,r){return n.range(Math.ceil(t/r)*r,+i,r).map(vi)},floor:v,ceil:v};cl.year=i.year;i.scale=function(){return gh(n.scale.linear(),cl,put)};ll=cl.map(function(n){return[n[0].utc,n[1]]});fk=rk.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",vr]]);ll.year=i.year.utc;i.scale.utc=function(){return gh(n.scale.linear(),ll,fk)};n.text=rs(function(n){return n.responseText});n.json=function(n,t){return bu(n,"application/json",brt,t)};n.html=function(n,t){return bu(n,"text/html",krt,t)};n.xml=rs(function(n){return n.responseXML});"function"==typeof define&&define.amd?(this.d3=n,define(n)):"object"==typeof module&&module.exports?module.exports=n:this.d3=n}();MemoryStats=function(){var o=100,s=0,r=document.createElement("div"),t,i,n,u,h,f,e;for(r.id="stats",r.style.cssText="width:80px;opacity:0.9;cursor:pointer",t=document.createElement("div"),t.id="ms",t.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;",r.appendChild(t),i=document.createElement("div"),i.id="msText",i.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",i.innerHTML="Memory",t.appendChild(i),n=document.createElement("div"),n.id="msGraph",n.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",t.appendChild(n);n.children.length<74;)u=document.createElement("span"),u.style.cssText="width:1px;height:30px;float:left;background-color:#131",n.appendChild(u);return h=function(n,t,i){var r=n.appendChild(n.firstChild);r.style.height=t+"px";i&&(r.style.backgroundColor=i)},window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome ."),f=Date.now(),e=performance.memory.usedJSHeapSize,{domElement:r,update:function(){function a(n,t){var i,r;return n==0?"n/a":(t=t!==undefined?t:0,i=Math.pow(10,t),r=Math.floor(Math.log(n)/Math.log(1024)),Math.round(n*i/Math.pow(1024,r))/i+" "+["Bytes","KB","MB","GB","TB"][r])}var r,u,t,c,l;Date.now()-f<1e3/30||(f=Date.now(),r=performance.memory.usedJSHeapSize-e,e=performance.memory.usedJSHeapSize,u=r<0?"#830":"#131",t=performance.memory.usedJSHeapSize,o=Math.min(o,t),s=Math.max(s,t),i.textContent="Mem: "+a(t,2),c=t/31457280,l=Math.min(30,30-c*30),h(n,l,u))}}};TridentMemoryAdapter.prototype.getAllKeys=function(n){var t=this.kvpColl.find();t||(t=[]);t=t.map(function(n){return{id:n.$loki,app:n.app,key:n.key,size:n.app.length+n.key.length+n.val.length}});typeof n=="function"&&n(t)};TridentMemoryAdapter.prototype.getAppKeys=function(n,t){var i=this.kvpColl.find({app:n});i||(i=[]);i=i.map(function(n){return{id:n.$loki,app:n.app,key:n.key,size:n.app.length+n.key.length+n.val.length}});typeof t=="function"&&t(i)};TridentMemoryAdapter.prototype.getAppKey=function(n,t,i){var r=this.kvpColl.findOne({$and:[{app:n},{key:t}]});if(typeof i=="function"){if(!r){i(r);return}i({id:r.$loki,app:r.app,key:r.key,val:r.val})}};TridentMemoryAdapter.prototype.getAppKeyById=function(n,t){var i=this.kvpColl.get(n);if(typeof t=="function"){if(!i){t(null);return}t({id:i.$loki,app:i.app,key:i.key,val:i.val})}};TridentMemoryAdapter.prototype.setAppKey=function(n,t,i,r){var u=this.kvpColl.findOne({$and:[{app:n},{key:t}]});u?(u.val=i,this.kvpColl.update(u)):this.kvpColl.insert({app:n,key:t,val:i});typeof r=="function"&&r({success:!0})};TridentMemoryAdapter.prototype.deleteAppKey=function(n,t){var i=this.kvpColl.get(n);if(!i){typeof t=="function"&&t({success:!1});return}this.kvpColl.remove(n);typeof t=="function"&&t({success:!0})};TridentIndexedAdapter.prototype.initializeDatabase=function(){var t=indexedDB.open("TridentSandboxDB",1),n=this;t.onupgradeneeded=function(t){if(n.db=t.target.result,n.db.objectStoreNames.contains("TridentSandboxKVP")&&n.db.deleteObjectStore("TridentSandboxKVP"),!n.db.objectStoreNames.contains("TridentSandboxKVP")){var i=n.db.createObjectStore("TridentSandboxKVP",{keyPath:"id",autoIncrement:!0});i.createIndex("app","app",{unique:!1});i.createIndex("key","key",{unique:!1});i.createIndex("appkey","appkey",{unique:!0})}n.upgradeCallback()};t.onsuccess=function(t){n.db=t.target.result;n.successCallback(n)};t.onerror=function(){n.errorCallback()}};TridentIndexedAdapter.prototype.getAllKeys=function(n){var i=this.db.transaction(["TridentSandboxKVP"],"readonly"),r=i.objectStore("TridentSandboxKVP"),t=r.openCursor();t.onsuccess=function(n,t){return function(i){var u=i.target.result,r,f;u?(r=u.value,f={id:r.id,app:r.app,key:r.key,size:r.app.length*2+r.key.length*2+r.val.length+1},n.push(f),u.continue()):typeof t=="function"&&t(n)}}([],n);t.onerror=function(n){return function(){typeof n=="function"&&n(null)}}(n)};TridentIndexedAdapter.prototype.getAppKeys=function(n,t){var r=this.db.transaction(["TridentSandboxKVP"],"readonly"),u=r.objectStore("TridentSandboxKVP"),f=u.index("app"),e=IDBKeyRange.only(n),i=f.openCursor(e);i.onsuccess=function(n,t){return function(i){var u=i.target.result,r,f;u?(r=u.value,f={id:r.id,app:r.app,key:r.key,size:r.app.length*2+r.key.length*2+r.val.length+1},n.push(f),u.continue()):typeof t=="function"&&t(n)}}([],t);i.onerror=function(n){return function(){typeof n=="function"&&n(null)}}(t)};TridentIndexedAdapter.prototype.getAppKey=function(n,t,i){var u=this.db.transaction(["TridentSandboxKVP"],"readonly"),f=u.objectStore("TridentSandboxKVP"),e=f.index("appkey"),o=n+","+t,r=e.get(o);r.onsuccess=function(n){return function(t){if(typeof n=="function"){var i=t.target.result;(i==null||typeof i=="undefined")&&(i={id:0,success:!1});n(i)}}}(i);r.onerror=function(n){return function(){typeof n=="function"&&n({id:0,success:!1})}}(i)};TridentIndexedAdapter.prototype.getAppKeyById=function(n,t){var i=this.db.transaction(["TridentSandboxKVP"],"readonly"),r=i.objectStore("TridentSandboxKVP"),u=r.get(n);u.onsuccess=function(n){return function(t){typeof n=="function"&&n(t.target.result)}}(t)};TridentIndexedAdapter.prototype.setAppKey=function(n,t,i,r){var e=this.db.transaction(["TridentSandboxKVP"],"readwrite"),u=e.objectStore("TridentSandboxKVP"),o=u.index("appkey"),s=n+","+t,f=o.get(s);f.onsuccess=function(f){var e=f.target.result,o;e?e.val=i:e={app:n,key:t,appkey:n+","+t,val:i};o=u.put(e);o.onerror=function(n){return function(){typeof n=="function"&&n({success:!1})}}(r);o.onsuccess=function(n){return function(){typeof n=="function"&&n({success:!0})}}(r)};f.onerror=function(n){return function(){typeof n=="function"&&n({success:!1})}}(r)};TridentIndexedAdapter.prototype.deleteAppKey=function(n,t){var r=this.db.transaction(["TridentSandboxKVP"],"readwrite"),u=r.objectStore("TridentSandboxKVP"),i=u.delete(n);i.onsuccess=function(n){return function(){typeof n=="function"&&n({success:!0})}}(t);i.onerror=function(n){return function(){typeof n=="function"&&n(!1)}}(t)};TridentServiceAdapter.prototype.getAllKeys=function(n){$.ajax({url:this.serviceLocation+"GetAllKeys",type:"POST",cache:!1,dataType:"json",usercallback:n,success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback(null)}})};TridentServiceAdapter.prototype.getAppKeys=function(n,t){var i={App:n};$.ajax({url:this.serviceLocation+"GetAppKeys",type:"POST",data:i,cache:!1,usercallback:t,dataType:"json",success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback(null)}})};TridentServiceAdapter.prototype.getAppKey=function(n,t,i){var r={App:n,Key:t};$.ajax({url:this.serviceLocation+"GetKey",type:"POST",data:r,cache:!1,dataType:"json",usercallback:i,success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback(null)}})};TridentServiceAdapter.prototype.getAppKeyById=function(n,t){var i={id:n};$.ajax({url:this.serviceLocation+"GetKeyById",type:"POST",data:i,cache:!1,dataType:"json",usercallback:t,success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback(null)}})};TridentServiceAdapter.prototype.setAppKey=function(n,t,i,r){var u={app:n,key:t,val:i};$.ajax({url:this.serviceLocation+"SetKey",type:"POST",data:u,cache:!1,dataType:"json",usercallback:r,success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback(null)}})};TridentServiceAdapter.prototype.deleteAppKey=function(n,t){var i={id:n};$.ajax({url:this.serviceLocation+"RemoveKey",type:"POST",data:i,cache:!1,dataType:"json",usercallback:t,success:function(n){typeof this.usercallback=="function"&&this.usercallback(n)},error:function(){typeof this.usercallback=="function"&&this.usercallback({success:!1})}})};TridentList.prototype.makeBright=function(){this.listSettings.bright=!0;$("#"+this.listSettings.listElementId).attr("class","tlist-bright");$("#"+this.listSettings.listElementId).find("div.tlistitem").attr("class","tlistitem-bright");$("#"+this.listSettings.listElementId).find("div.tlistitem-selected").attr("class","tlistitem-selected-bright");$("#"+this.listSettings.listElementId).find("span.tlistitem-caption").attr("class","tlistitem-caption-bright");$("#"+this.listSettings.listElementId).find("span.tlistitem-description").attr("class","tlistitem-description-bright")};TridentList.prototype.setCaptionColor=function(n){$("#"+this.listSettings.listElementId).find("span.tlistitem-caption").css("color",n);$("#"+this.listSettings.listElementId).find("span.tlistitem-caption-bright").css("color",n)};TridentList.prototype.clearList=function(){$("#"+this.listSettings.listElementId).empty()};TridentList.prototype.addListItem=function(n,t,i,r){var o=document.createElement("span"),f,u,e,s;o.className=this.listSettings.bright?"tlistitem-caption-bright":"tlistitem-caption";$(o).text(t);f=document.createElement("span");f.className=this.listSettings.bright?"tlistitem-description-bright":"tlistitem-description";typeof i!="undefined"&&(typeof r!="undefined"&&r?$(f).html(i):$(f).text(i));u=document.createElement("div");u.className=this.listSettings.bright?"tlistitem-bright":"tlistitem";$(u).attr("data-item-id",n);u.appendChild(o);u.appendChild(document.createElement("br"));u.appendChild(f);u.onclick=function(n,t){return function(){t.bright?($("#"+t.listElementId).find("div.tlistitem-selected-bright").attr("class","tlistitem-bright"),this.className="tlistitem-selected-bright"):($("#"+t.listElementId).find("div.tlistitem-selected").attr("class","tlistitem"),this.className="tlistitem-selected");t.selectedId=n;t.clickCallback&&t.clickCallback(t.listElementId,n)}}(n,this.listSettings);e=document.createElement("li");$(e).attr("data-item-id",n);e.appendChild(u);s=document.getElementById(this.listSettings.listElementId);s.appendChild(e)};TridentList.prototype.addListItemRaw=function(n,t){var i=document.createElement("div"),r,u;i.className=this.listSettings.bright?"tlistitem-bright":"tlistitem";$(i).attr("data-item-id",n);$(i).html(t);i.onclick=function(n,t){return function(){t.bright?($("#"+t.listElementId).find("div.tlistitem-selected-bright").attr("class","tlistitem-bright"),this.className="tlistitem-selected-bright"):($("#"+t.listElementId).find("div.tlistitem-selected").attr("class","tlistitem"),this.className="tlistitem-selected");t.selectedId=n;t.clickCallback&&t.clickCallback(t.listElementId,n)}}(n,this.listSettings);r=document.createElement("li");$(r).attr("data-item-id",n);r.appendChild(i);u=document.getElementById(this.listSettings.listElementId);u.appendChild(r)};TridentList.prototype.deleteListItem=function(n){n==null&&(n=this.listSettings.selectedId);$("#"+this.listSettings.listElementId).find("li[data-item-id="+n+"]").remove();this.listSettings.selectedId=null};TridentList.prototype.updateListItem=function(n,t,i){var r=$("#"+this.listSettings.listElementId).find("li[data-item-id="+n+"]");this.listSettings.bright?($(r).find("span.tlistitem-caption-bright").text(t),$(r).find("span.tlistitem-description-bright").text(i)):($(r).find("span.tlistitem-caption").text(t),$(r).find("span.tlistitem-description").text(i))};TridentList.prototype.setSelection=function(n){$("#"+this.listSettings.listElementId).find("div.tlistitem-selected").attr("class","tlistitem");$("#"+this.listSettings.listElementId).find("div.tlistitem-selected-bright").attr("class","tlistitem-bright");var t=$("#"+this.listSettings.listElementId).find("div[data-item-id="+n+"]");t&&t.length>0?(this.listSettings.bright?$(t).addClass("tlistitem-selected-bright"):$(t).addClass("tlistitem-selected"),this.listSettings.selectedId=n):this.listSettings.selectedId=null};